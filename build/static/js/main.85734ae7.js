/*! For license information please see main.85734ae7.js.LICENSE.txt */
(()=>{var e={19:(e,t,n)=>{"use strict";var i=n(565);var r="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},s=i.useSyncExternalStore,a=i.useRef,o=i.useEffect,l=i.useMemo,c=i.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,i,u){var d=a(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;d=l(function(){function e(e){if(!o){if(o=!0,s=e,e=i(e),void 0!==u&&h.hasValue){var t=h.value;if(u(t,e))return a=t}return a=e}if(t=a,r(s,e))return t;var n=i(e);return void 0!==u&&u(t,n)?(s=e,t):(s=e,a=n)}var s,a,o=!1,l=void 0===n?null:n;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]},[t,n,i,u]);var f=s(e,d[0],d[1]);return o(function(){h.hasValue=!0,h.value=f},[f]),c(f),f}},51:(e,t,n)=>{"use strict";e.exports=n(19)},69:(e,t,n)=>{"use strict";e.exports=n(970)},71:(e,t,n)=>{"use strict";e.exports=n(464)},350:(e,t,n)=>{"use strict";e.exports=n(920)},396:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(764)},464:(e,t)=>{"use strict";t.ConcurrentRoot=1,t.ContinuousEventPriority=4,t.DefaultEventPriority=16,t.DiscreteEventPriority=1},501:(e,t,n)=>{"use strict";var i=n(396);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},508:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,a=r>>>1;i<a;){var o=2*(i+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,n))c<r&&0>s(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[o]=n,i=o);else{if(!(c<r&&0>s(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function x(e){if(g=!1,b(e),!m)if(null!==i(c))m=!0,D(S);else{var t=i(u);null!==t&&k(x,t.startTime-e)}}function S(e,n){m=!1,g&&(g=!1,y(M),M=-1),p=!0;var s=f;try{for(b(n),h=i(c);null!==h&&(!(h.expirationTime>n)||e&&!R());){var a=h.callback;if("function"===typeof a){h.callback=null,f=h.priorityLevel;var o=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===i(c)&&r(c),b(n)}else r(c);h=i(c)}if(null!==h)var l=!0;else{var d=i(u);null!==d&&k(x,d.startTime-n),l=!1}return l}finally{h=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,w=!1,T=null,M=-1,A=5,C=-1;function R(){return!(t.unstable_now()-C<A)}function L(){if(null!==T){var e=t.unstable_now();C=e;var n=!0;try{n=T(!0,e)}finally{n?E():(w=!1,T=null)}}else w=!1}if("function"===typeof _)E=function(){_(L)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,I=P.port2;P.port1.onmessage=L,E=function(){I.postMessage(null)}}else E=function(){v(L,0)};function D(e){T=e,w||(w=!0,E())}function k(e,n){M=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,D(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,r,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,n(u,e),null===i(c)&&e===i(u)&&(g?(y(M),M=-1):g=!0,k(x,s-a))):(e.sortIndex=o,n(c,e),m||p||(m=!0,D(S))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},540:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function _(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var b=_.prototype=new y;b.constructor=_,m(b,v.prototype),b.isPureReactComponent=!0;var x=Array.isArray,S=Object.prototype.hasOwnProperty,E={current:null},w={key:!0,ref:!0,__self:!0,__source:!0};function T(e,t,i){var r,s={},a=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)S.call(t,r)&&!w.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:e,key:a,ref:o,props:s,_owner:E.current}}function M(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var A=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function R(e,t,r,s,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return a=a(l=e),e=""===s?"."+C(l,0):s,x(a)?(r="",null!=e&&(r=e.replace(A,"$&/")+"/"),R(a,t,r,"",function(e){return e})):null!=a&&(M(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(A,"$&/")+"/")+e)),t.push(a)),1;if(l=0,s=""===s?".":s+":",x(e))for(var c=0;c<e.length;c++){var u=s+C(o=e[c],c);l+=R(o,t,r,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=R(o=o.value,t,r,u=s+C(o,c++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function L(e,t,n){if(null==e)return e;var i=[],r=0;return R(e,i,"","",function(e){return t.call(n,e,r++)}),i}function P(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},D={transition:null},k={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:D,ReactCurrentOwner:E};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:L,forEach:function(e,t,n){L(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return L(e,function(){t++}),t},toArray:function(e){return L(e,function(e){return e})||[]},only:function(e){if(!M(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=a,t.PureComponent=_,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k,t.act=O,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=m({},e.props),s=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=E.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)S.call(t,c)&&!w.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:e.type,key:s,ref:a,props:r,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=T,t.createFactory=function(e){var t=T.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=M,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.3.1"},565:(e,t,n)=>{"use strict";e.exports=n(540)},611:(e,t,n)=>{"use strict";e.exports=n(508)},643:(e,t,n)=>{"use strict";var i=n(565),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,s={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,i)&&!l.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===s[i]&&(s[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:u,props:s,_owner:o.current}}t.jsx=c,t.jsxs=c},764:(e,t,n)=>{"use strict";var i=n(565),r=n(69);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,i,r,s,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function _(e,t,n,i){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),S=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),A=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var k=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=k&&e[k]||e["@@iterator"])?e:null}var N,F=Object.assign;function B(e){if(void 0===N)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);N=t&&t[1]||""}return"\n"+N+e}var U=!1;function H(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),s=i.stack.split("\n"),a=r.length-1,o=s.length-1;1<=a&&0<=o&&r[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||r[a]!==s[o]){var l="\n"+r[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function z(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=H(e.type,!1);case 11:return e=H(e.type.render,!1);case 1:return e=H(e.type,!0);default:return""}}function G(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case S:return"Portal";case T:return"Profiler";case w:return"StrictMode";case R:return"Suspense";case L:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case A:return(e.displayName||"Context")+".Consumer";case M:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:G(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return G(e(t))}catch(n){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return G(t);case 8:return t===w?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function j(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Y(e){e._valueTracker||(e._valueTracker=function(e){var t=j(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=j(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function q(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&_(e,"checked",t,!1)}function Z(e,t){Q(e,t);var n=W(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function se(e,t){var n=W(t.value),i=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=me(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ve=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function _e(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,Ee=null,we=null;function Te(e){if(e=_r(e)){if("function"!==typeof Se)throw Error(s(280));var t=e.stateNode;t&&(t=xr(t),Se(e.stateNode,e.type,t))}}function Me(e){Ee?we?we.push(e):we=[e]:Ee=e}function Ae(){if(Ee){var e=Ee,t=we;if(we=Ee=null,Te(e),t)for(e=0;e<t.length;e++)Te(t[e])}}function Ce(e,t){return e(t)}function Re(){}var Le=!1;function Pe(e,t,n){if(Le)return e(t,n);Le=!0;try{return Ce(e,t,n)}finally{Le=!1,(null!==Ee||null!==we)&&(Re(),Ae())}}function Ie(e,t){var n=e.stateNode;if(null===n)return null;var i=xr(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var De=!1;if(u)try{var ke={};Object.defineProperty(ke,"passive",{get:function(){De=!0}}),window.addEventListener("test",ke,ke),window.removeEventListener("test",ke,ke)}catch(ue){De=!1}function Oe(e,t,n,i,r,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Ne=!1,Fe=null,Be=!1,Ue=null,He={onError:function(e){Ne=!0,Fe=e}};function ze(e,t,n,i,r,s,a,o,l){Ne=!1,Fe=null,Oe.apply(He,arguments)}function Ge(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ge(e)!==e)throw Error(s(188))}function je(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ge(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(i=r.return)){n=i;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return We(r),e;if(a===i)return We(r),t;a=a.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=a;else{for(var o=!1,l=r.child;l;){if(l===n){o=!0,n=r,i=a;break}if(l===i){o=!0,i=r,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,i=r;break}if(l===i){o=!0,i=a,n=r;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?Ye(e):null}function Ye(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ye(e);if(null!==t)return t;e=e.sibling}return null}var Xe=r.unstable_scheduleCallback,Ke=r.unstable_cancelCallback,qe=r.unstable_shouldYield,Je=r.unstable_requestPaint,Qe=r.unstable_now,Ze=r.unstable_getCurrentPriorityLevel,$e=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,st=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~r;0!==o?i=dt(o):0!==(s&=a)&&(i=dt(s))}else 0!==(a=n&~r)?i=dt(a):0!==s&&(i=dt(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-at(t)),i|=e[n],t&=~r;return i}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-at(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var _t=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,St,Et,wt,Tt,Mt=!1,At=[],Ct=null,Rt=null,Lt=null,Pt=new Map,It=new Map,Dt=[],kt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":Rt=null;break;case"mouseover":case"mouseout":Lt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function Nt(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=_r(t))&&St(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Ft(e){var t=yr(e.target);if(null!==t){var n=Ge(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void Tt(e.priority,function(){Et(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=_r(n))&&St(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);be=i,n.target.dispatchEvent(i),be=null,t.shift()}return!0}function Ut(e,t,n){Bt(e)&&n.delete(t)}function Ht(){Mt=!1,null!==Ct&&Bt(Ct)&&(Ct=null),null!==Rt&&Bt(Rt)&&(Rt=null),null!==Lt&&Bt(Lt)&&(Lt=null),Pt.forEach(Ut),It.forEach(Ut)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,Mt||(Mt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ht)))}function Gt(e){function t(t){return zt(t,e)}if(0<At.length){zt(At[0],e);for(var n=1;n<At.length;n++){var i=At[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Ct&&zt(Ct,e),null!==Rt&&zt(Rt,e),null!==Lt&&zt(Lt,e),Pt.forEach(t),It.forEach(t),n=0;n<Dt.length;n++)(i=Dt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Dt.shift()}var Vt=b.ReactCurrentBatchConfig,Wt=!0;function jt(e,t,n,i){var r=_t,s=Vt.transition;Vt.transition=null;try{_t=1,Xt(e,t,n,i)}finally{_t=r,Vt.transition=s}}function Yt(e,t,n,i){var r=_t,s=Vt.transition;Vt.transition=null;try{_t=4,Xt(e,t,n,i)}finally{_t=r,Vt.transition=s}}function Xt(e,t,n,i){if(Wt){var r=qt(e,t,n,i);if(null===r)Wi(e,t,i,Kt,n),Ot(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Ct=Nt(Ct,e,t,n,i,r),!0;case"dragenter":return Rt=Nt(Rt,e,t,n,i,r),!0;case"mouseover":return Lt=Nt(Lt,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return Pt.set(s,Nt(Pt.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,It.set(s,Nt(It.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Ot(e,i),4&t&&-1<kt.indexOf(e)){for(;null!==r;){var s=_r(r);if(null!==s&&xt(s),null===(s=qt(e,t,n,i))&&Wi(e,t,i,Kt,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else Wi(e,t,i,null,n)}}var Kt=null;function qt(e,t,n,i){if(Kt=null,null!==(e=yr(e=xe(i))))if(null===(t=Ge(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Qt=null,Zt=null,$t=null;function en(){if($t)return $t;var e,t,n=Zt,i=n.length,r="value"in Qt?Qt.value:Qt.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var a=i-e;for(t=1;t<=a&&n[i-t]===r[s-t];t++);return $t=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,i,r,s){for(var a in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),dn=F({},cn,{view:0,detail:0}),hn=sn(dn),fn=F({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),pn=sn(fn),mn=sn(F({},fn,{dataTransfer:0})),gn=sn(F({},dn,{relatedTarget:0})),vn=sn(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_n=sn(yn),bn=sn(F({},cn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function Tn(){return wn}var Mn=F({},dn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),An=sn(Mn),Cn=sn(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Rn=sn(F({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tn})),Ln=sn(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=F({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),In=sn(Pn),Dn=[9,13,27,32],kn=u&&"CompositionEvent"in window,On=null;u&&"documentMode"in document&&(On=document.documentMode);var Nn=u&&"TextEvent"in window&&!On,Fn=u&&(!kn||On&&8<On&&11>=On),Bn=String.fromCharCode(32),Un=!1;function Hn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Gn=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function jn(e,t,n,i){Me(i),0<(t=Yi(t,"onChange")).length&&(n=new un("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Yn=null,Xn=null;function Kn(e){Bi(e,0)}function qn(e){if(X(br(e)))return e}function Jn(e,t){if("change"===e)return t}var Qn=!1;if(u){var Zn;if(u){var $n="oninput"in document;if(!$n){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),$n="function"===typeof ei.oninput}Zn=$n}else Zn=!1;Qn=Zn&&(!document.documentMode||9<document.documentMode)}function ti(){Yn&&(Yn.detachEvent("onpropertychange",ni),Xn=Yn=null)}function ni(e){if("value"===e.propertyName&&qn(Xn)){var t=[];jn(t,Xn,e,xe(e)),Pe(Kn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Xn=n,(Yn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return qn(Xn)}function si(e,t){if("click"===e)return qn(t)}function ai(e,t){if("input"===e||"change"===e)return qn(t)}var oi="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(oi(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!d.call(t,r)||!oi(e[r],t[r]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ui(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function di(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?di(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hi(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function fi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pi(e){var t=hi(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&di(n.ownerDocument.documentElement,n)){if(null!==i&&fi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=ui(n,s);var a=ui(n,i);r&&a&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mi=u&&"documentMode"in document&&11>=document.documentMode,gi=null,vi=null,yi=null,_i=!1;function bi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_i||null==gi||gi!==K(i)||("selectionStart"in(i=gi)&&fi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&li(yi,i)||(yi=i,0<(i=Yi(vi,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=gi)))}function xi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Si={animationend:xi("Animation","AnimationEnd"),animationiteration:xi("Animation","AnimationIteration"),animationstart:xi("Animation","AnimationStart"),transitionend:xi("Transition","TransitionEnd")},Ei={},wi={};function Ti(e){if(Ei[e])return Ei[e];if(!Si[e])return e;var t,n=Si[e];for(t in n)if(n.hasOwnProperty(t)&&t in wi)return Ei[e]=n[t];return e}u&&(wi=document.createElement("div").style,"AnimationEvent"in window||(delete Si.animationend.animation,delete Si.animationiteration.animation,delete Si.animationstart.animation),"TransitionEvent"in window||delete Si.transitionend.transition);var Mi=Ti("animationend"),Ai=Ti("animationiteration"),Ci=Ti("animationstart"),Ri=Ti("transitionend"),Li=new Map,Pi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ii(e,t){Li.set(e,t),l(t,[e])}for(var Di=0;Di<Pi.length;Di++){var ki=Pi[Di];Ii(ki.toLowerCase(),"on"+(ki[0].toUpperCase()+ki.slice(1)))}Ii(Mi,"onAnimationEnd"),Ii(Ai,"onAnimationIteration"),Ii(Ci,"onAnimationStart"),Ii("dblclick","onDoubleClick"),Ii("focusin","onFocus"),Ii("focusout","onBlur"),Ii(Ri,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ni=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oi));function Fi(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,a,o,l,c){if(ze.apply(this,arguments),Ne){if(!Ne)throw Error(s(198));var u=Fe;Ne=!1,Fe=null,Be||(Be=!0,Ue=u)}}(i,t,void 0,e),e.currentTarget=null}function Bi(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;Fi(r,o,c),s=l}else for(a=0;a<i.length;a++){if(l=(o=i[a]).instance,c=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;Fi(r,o,c),s=l}}}if(Be)throw e=Ue,Be=!1,Ue=null,e}function Ui(e,t){var n=t[mr];void 0===n&&(n=t[mr]=new Set);var i=e+"__bubble";n.has(i)||(Vi(t,e,2,!1),n.add(i))}function Hi(e,t,n){var i=0;t&&(i|=4),Vi(n,e,i,t)}var zi="_reactListening"+Math.random().toString(36).slice(2);function Gi(e){if(!e[zi]){e[zi]=!0,a.forEach(function(t){"selectionchange"!==t&&(Ni.has(t)||Hi(t,!1,e),Hi(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zi]||(t[zi]=!0,Hi("selectionchange",!1,t))}}function Vi(e,t,n,i){switch(Jt(t)){case 1:var r=jt;break;case 4:r=Yt;break;default:r=Xt}n=r.bind(null,t,n,e),r=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Wi(e,t,n,i,r){var s=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var o=i.stateNode.containerInfo;if(o===r||8===o.nodeType&&o.parentNode===r)break;if(4===a)for(a=i.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;a=a.return}for(;null!==o;){if(null===(a=yr(o)))return;if(5===(l=a.tag)||6===l){i=s=a;continue e}o=o.parentNode}}i=i.return}Pe(function(){var i=s,r=xe(n),a=[];e:{var o=Li.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=An;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Rn;break;case Mi:case Ai:case Ci:l=vn;break;case Ri:l=Ln;break;case"scroll":l=hn;break;case"wheel":l=In;break;case"copy":case"cut":case"paste":l=_n;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=i;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==h&&(null!=(m=Ie(p,h))&&u.push(ji(p,m,f)))),d)break;p=p.return}0<u.length&&(o=new l(o,c,null,n,r),a.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!yr(c)&&!c[pr])&&(l||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?yr(c):null)&&(c!==(d=Ge(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=pn,m="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Cn,m="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?o:br(l),f=null==c?o:br(c),(o=new u(m,p+"leave",l,n,r)).target=d,o.relatedTarget=f,m=null,yr(r)===i&&((u=new u(h,p+"enter",c,n,r)).target=f,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,p=0,f=u=l;f;f=Xi(f))p++;for(f=0,m=h;m;m=Xi(m))f++;for(;0<p-f;)u=Xi(u),p--;for(;0<f-p;)h=Xi(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Xi(u),h=Xi(h)}u=null}else u=null;null!==l&&Ki(a,o,l,u,!1),null!==c&&null!==d&&Ki(a,d,c,u,!0)}if("select"===(l=(o=i?br(i):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Jn;else if(Wn(o))if(Qn)g=ai;else{g=ri;var v=ii}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=si);switch(g&&(g=g(e,i))?jn(a,g,n,r):(v&&v(e,o,i),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=i?br(i):window,e){case"focusin":(Wn(v)||"true"===v.contentEditable)&&(gi=v,vi=i,yi=null);break;case"focusout":yi=vi=gi=null;break;case"mousedown":_i=!0;break;case"contextmenu":case"mouseup":case"dragend":_i=!1,bi(a,n,r);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":bi(a,n,r)}var y;if(kn)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Gn?Hn(e,n)&&(_="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(_="onCompositionStart");_&&(Fn&&"ko"!==n.locale&&(Gn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Gn&&(y=en()):(Zt="value"in(Qt=r)?Qt.value:Qt.textContent,Gn=!0)),0<(v=Yi(i,_)).length&&(_=new bn(_,e,null,n,r),a.push({event:_,listeners:v}),y?_.data=y:null!==(y=zn(n))&&(_.data=y))),(y=Nn?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Un=!0,Bn);case"textInput":return(e=t.data)===Bn&&Un?null:e;default:return null}}(e,n):function(e,t){if(Gn)return"compositionend"===e||!kn&&Hn(e,t)?(e=en(),$t=Zt=Qt=null,Gn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=Yi(i,"onBeforeInput")).length&&(r=new bn("onBeforeInput","beforeinput",null,n,r),a.push({event:r,listeners:i}),r.data=y))}Bi(a,t)})}function ji(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Yi(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Ie(e,n))&&i.unshift(ji(e,s,r)),null!=(s=Ie(e,t))&&i.push(ji(e,s,r))),e=e.return}return i}function Xi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Ki(e,t,n,i,r){for(var s=t._reactName,a=[];null!==n&&n!==i;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===i)break;5===o.tag&&null!==c&&(o=c,r?null!=(l=Ie(n,s))&&a.unshift(ji(n,l,o)):r||null!=(l=Ie(n,s))&&a.push(ji(n,l,o))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var qi=/\r\n?/g,Ji=/\u0000|\uFFFD/g;function Qi(e){return("string"===typeof e?e:""+e).replace(qi,"\n").replace(Ji,"")}function Zi(e,t,n){if(t=Qi(t),Qi(e)!==t&&n)throw Error(s(425))}function $i(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,ar="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(or)}:ir;function or(e){setTimeout(function(){throw e})}function lr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void Gt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Gt(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var dr=Math.random().toString(36).slice(2),hr="__reactFiber$"+dr,fr="__reactProps$"+dr,pr="__reactContainer$"+dr,mr="__reactEvents$"+dr,gr="__reactListeners$"+dr,vr="__reactHandles$"+dr;function yr(e){var t=e[hr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pr]||n[hr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ur(e);null!==e;){if(n=e[hr])return n;e=ur(e)}return t}n=(e=n).parentNode}return null}function _r(e){return!(e=e[hr]||e[pr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function br(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function xr(e){return e[fr]||null}var Sr=[],Er=-1;function wr(e){return{current:e}}function Tr(e){0>Er||(e.current=Sr[Er],Sr[Er]=null,Er--)}function Mr(e,t){Er++,Sr[Er]=e.current,e.current=t}var Ar={},Cr=wr(Ar),Rr=wr(!1),Lr=Ar;function Pr(e,t){var n=e.type.contextTypes;if(!n)return Ar;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ir(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Dr(){Tr(Rr),Tr(Cr)}function kr(e,t,n){if(Cr.current!==Ar)throw Error(s(168));Mr(Cr,t),Mr(Rr,n)}function Or(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(s(108,V(e)||"Unknown",r));return F({},n,i)}function Nr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ar,Lr=Cr.current,Mr(Cr,e),Mr(Rr,Rr.current),!0}function Fr(e,t,n){var i=e.stateNode;if(!i)throw Error(s(169));n?(e=Or(e,t,Lr),i.__reactInternalMemoizedMergedChildContext=e,Tr(Rr),Tr(Cr),Mr(Cr,e)):Tr(Rr),Mr(Rr,n)}var Br=null,Ur=!1,Hr=!1;function zr(e){null===Br?Br=[e]:Br.push(e)}function Gr(){if(!Hr&&null!==Br){Hr=!0;var e=0,t=_t;try{var n=Br;for(_t=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Br=null,Ur=!1}catch(r){throw null!==Br&&(Br=Br.slice(e+1)),Xe($e,Gr),r}finally{_t=t,Hr=!1}}return null}var Vr=[],Wr=0,jr=null,Yr=0,Xr=[],Kr=0,qr=null,Jr=1,Qr="";function Zr(e,t){Vr[Wr++]=Yr,Vr[Wr++]=jr,jr=e,Yr=t}function $r(e,t,n){Xr[Kr++]=Jr,Xr[Kr++]=Qr,Xr[Kr++]=qr,qr=e;var i=Jr;e=Qr;var r=32-at(i)-1;i&=~(1<<r),n+=1;var s=32-at(t)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Jr=1<<32-at(t)+r|n<<r|i,Qr=s+e}else Jr=1<<s|n<<r|i,Qr=e}function es(e){null!==e.return&&(Zr(e,1),$r(e,1,0))}function ts(e){for(;e===jr;)jr=Vr[--Wr],Vr[Wr]=null,Yr=Vr[--Wr],Vr[Wr]=null;for(;e===qr;)qr=Xr[--Kr],Xr[Kr]=null,Qr=Xr[--Kr],Xr[Kr]=null,Jr=Xr[--Kr],Xr[Kr]=null}var ns=null,is=null,rs=!1,ss=null;function as(e,t){var n=Pc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function os(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,is=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,is=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==qr?{id:Jr,overflow:Qr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Pc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,is=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(rs){var t=is;if(t){var n=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=cr(n.nextSibling);var i=ns;t&&os(e,t)?as(i,n):(e.flags=-4097&e.flags|2,rs=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function ds(e){if(e!==ns)return!1;if(!rs)return us(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=is)){if(ls(e))throw hs(),Error(s(418));for(;t;)as(e,t),t=cr(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){is=cr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}is=null}}else is=ns?cr(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=is;e;)e=cr(e.nextSibling)}function fs(){is=ns=null,rs=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var ms=b.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,e));var r=i,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=r.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function vs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ys(e){return(0,e._init)(e._payload)}function _s(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Dc(e,t)).index=0,e.sibling=null,e}function a(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Fc(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,i){var s=n.type;return s===E?d(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===I&&ys(s)===t.type)?((i=r(t,n.props)).ref=gs(e,t,n),i.return=e,i):((i=kc(n.type,n.key,n.props,null,e.mode,i)).ref=gs(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bc(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function d(e,t,n,i,s){return null===t||7!==t.tag?((t=Oc(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=kc(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case S:return(t=Bc(t,e.mode,n)).return=e,t;case I:return h(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=Oc(t,e.mode,n,null)).return=e,t;vs(e,t)}return null}function f(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===r?c(e,t,n,i):null;case S:return n.key===r?u(e,t,n,i):null;case I:return f(e,t,(r=n._init)(n._payload),i)}if(te(n)||O(n))return null!==r?null:d(e,t,n,i,null);vs(e,n)}return null}function p(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case x:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case S:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case I:return p(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||O(i))return d(t,e=e.get(n)||null,i,r,null);vs(t,i)}return null}function m(r,s,o,l){for(var c=null,u=null,d=s,m=s=0,g=null;null!==d&&m<o.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=f(r,d,o[m],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(r,d),s=a(v,s,m),null===u?c=v:u.sibling=v,u=v,d=g}if(m===o.length)return n(r,d),rs&&Zr(r,m),c;if(null===d){for(;m<o.length;m++)null!==(d=h(r,o[m],l))&&(s=a(d,s,m),null===u?c=d:u.sibling=d,u=d);return rs&&Zr(r,m),c}for(d=i(r,d);m<o.length;m++)null!==(g=p(d,r,m,o[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),s=a(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(r,e)}),rs&&Zr(r,m),c}function g(r,o,l,c){var u=O(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var d=u=null,m=o,g=o=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var _=f(r,m,y.value,c);if(null===_){null===m&&(m=v);break}e&&m&&null===_.alternate&&t(r,m),o=a(_,o,g),null===d?u=_:d.sibling=_,d=_,m=v}if(y.done)return n(r,m),rs&&Zr(r,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=h(r,y.value,c))&&(o=a(y,o,g),null===d?u=y:d.sibling=y,d=y);return rs&&Zr(r,g),u}for(m=i(r,m);!y.done;g++,y=l.next())null!==(y=p(m,r,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),o=a(y,o,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach(function(e){return t(r,e)}),rs&&Zr(r,g),u}return function e(i,s,a,l){if("object"===typeof a&&null!==a&&a.type===E&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case x:e:{for(var c=a.key,u=s;null!==u;){if(u.key===c){if((c=a.type)===E){if(7===u.tag){n(i,u.sibling),(s=r(u,a.props.children)).return=i,i=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===I&&ys(c)===u.type){n(i,u.sibling),(s=r(u,a.props)).ref=gs(i,u,a),s.return=i,i=s;break e}n(i,u);break}t(i,u),u=u.sibling}a.type===E?((s=Oc(a.props.children,i.mode,l,a.key)).return=i,i=s):((l=kc(a.type,a.key,a.props,null,i.mode,l)).ref=gs(i,s,a),l.return=i,i=l)}return o(i);case S:e:{for(u=a.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(i,s.sibling),(s=r(s,a.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=Bc(a,i.mode,l)).return=i,i=s}return o(i);case I:return e(i,s,(u=a._init)(a._payload),l)}if(te(a))return m(i,s,a,l);if(O(a))return g(i,s,a,l);vs(i,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,a)).return=i,i=s):(n(i,s),(s=Fc(a,i.mode,l)).return=i,i=s),o(i)):n(i,s)}}var bs=_s(!0),xs=_s(!1),Ss=wr(null),Es=null,ws=null,Ts=null;function Ms(){Ts=ws=Es=null}function As(e){var t=Ss.current;Tr(Ss),e._currentValue=t}function Cs(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Rs(e,t){Es=e,Ts=ws=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(_o=!0),e.firstContext=null)}function Ls(e){var t=e._currentValue;if(Ts!==e)if(e={context:e,memoizedValue:t,next:null},null===ws){if(null===Es)throw Error(s(308));ws=e,Es.dependencies={lanes:0,firstContext:e}}else ws=ws.next=e;return t}var Ps=null;function Is(e){null===Ps?Ps=[e]:Ps.push(e)}function Ds(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Is(t)):(n.next=r.next,r.next=n),t.interleaved=n,ks(e,i)}function ks(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Os=!1;function Ns(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Cl)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,ks(e,n)}return null===(r=i.interleaved)?(t.next=t,Is(i)):(t.next=r.next,r.next=t),i.interleaved=t,ks(e,n)}function Hs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}function zs(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Gs(e,t,n,i){var r=e.updateQueue;Os=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?s=c:a.next=c,a=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=r.baseState;for(a=0,u=c=l=null,o=s;;){var h=o.lane,f=o.eventTime;if((i&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(h=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=m.payload)?p.call(f,d,h):p)||void 0===h)break e;d=F({},d,h);break e;case 2:Os=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,a|=h;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(h=o).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===u&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{a|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Nl|=a,e.lanes=a,e.memoizedState=d}}function Vs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var Ws={},js=wr(Ws),Ys=wr(Ws),Xs=wr(Ws);function Ks(e){if(e===Ws)throw Error(s(174));return e}function qs(e,t){switch(Mr(Xs,t),Mr(Ys,e),Mr(js,Ws),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Tr(js),Mr(js,t)}function Js(){Tr(js),Tr(Ys),Tr(Xs)}function Qs(e){Ks(Xs.current);var t=Ks(js.current),n=le(t,e.type);t!==n&&(Mr(Ys,e),Mr(js,n))}function Zs(e){Ys.current===e&&(Tr(js),Tr(Ys))}var $s=wr(0);function ea(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ta=[];function na(){for(var e=0;e<ta.length;e++)ta[e]._workInProgressVersionPrimary=null;ta.length=0}var ia=b.ReactCurrentDispatcher,ra=b.ReactCurrentBatchConfig,sa=0,aa=null,oa=null,la=null,ca=!1,ua=!1,da=0,ha=0;function fa(){throw Error(s(321))}function pa(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!oi(e[n],t[n]))return!1;return!0}function ma(e,t,n,i,r,a){if(sa=a,aa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ia.current=null===e||null===e.memoizedState?Za:$a,e=n(i,r),ua){a=0;do{if(ua=!1,da=0,25<=a)throw Error(s(301));a+=1,la=oa=null,t.updateQueue=null,ia.current=eo,e=n(i,r)}while(ua)}if(ia.current=Qa,t=null!==oa&&null!==oa.next,sa=0,la=oa=aa=null,ca=!1,t)throw Error(s(300));return e}function ga(){var e=0!==da;return da=0,e}function va(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?aa.memoizedState=la=e:la=la.next=e,la}function ya(){if(null===oa){var e=aa.alternate;e=null!==e?e.memoizedState:null}else e=oa.next;var t=null===la?aa.memoizedState:la.next;if(null!==t)la=t,oa=e;else{if(null===e)throw Error(s(310));e={memoizedState:(oa=e).memoizedState,baseState:oa.baseState,baseQueue:oa.baseQueue,queue:oa.queue,next:null},null===la?aa.memoizedState=la=e:la=la.next=e}return la}function _a(e,t){return"function"===typeof t?t(e):t}function ba(e){var t=ya(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=oa,r=i.baseQueue,a=n.pending;if(null!==a){if(null!==r){var o=r.next;r.next=a.next,a.next=o}i.baseQueue=r=a,n.pending=null}if(null!==r){a=r.next,i=i.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((sa&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,o=i):c=c.next=h,aa.lanes|=d,Nl|=d}u=u.next}while(null!==u&&u!==a);null===c?o=i:c.next=l,oi(i,t.memoizedState)||(_o=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{a=r.lane,aa.lanes|=a,Nl|=a,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function xa(e){var t=ya(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,a=t.memoizedState;if(null!==r){n.pending=null;var o=r=r.next;do{a=e(a,o.action),o=o.next}while(o!==r);oi(a,t.memoizedState)||(_o=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,i]}function Sa(){}function Ea(e,t){var n=aa,i=ya(),r=t(),a=!oi(i.memoizedState,r);if(a&&(i.memoizedState=r,_o=!0),i=i.queue,Oa(Ma.bind(null,n,i,e),[e]),i.getSnapshot!==t||a||null!==la&&1&la.memoizedState.tag){if(n.flags|=2048,La(9,Ta.bind(null,n,i,r,t),void 0,null),null===Rl)throw Error(s(349));0!==(30&sa)||wa(n,t,r)}return r}function wa(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ta(e,t,n,i){t.value=n,t.getSnapshot=i,Aa(t)&&Ca(e)}function Ma(e,t,n){return n(function(){Aa(t)&&Ca(e)})}function Aa(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!oi(e,n)}catch(i){return!0}}function Ca(e){var t=ks(e,1);null!==t&&nc(t,e,1,-1)}function Ra(e){var t=va();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_a,lastRenderedState:e},t.queue=e,e=e.dispatch=Xa.bind(null,aa,e),[t.memoizedState,e]}function La(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Pa(){return ya().memoizedState}function Ia(e,t,n,i){var r=va();aa.flags|=e,r.memoizedState=La(1|t,n,void 0,void 0===i?null:i)}function Da(e,t,n,i){var r=ya();i=void 0===i?null:i;var s=void 0;if(null!==oa){var a=oa.memoizedState;if(s=a.destroy,null!==i&&pa(i,a.deps))return void(r.memoizedState=La(t,n,s,i))}aa.flags|=e,r.memoizedState=La(1|t,n,s,i)}function ka(e,t){return Ia(8390656,8,e,t)}function Oa(e,t){return Da(2048,8,e,t)}function Na(e,t){return Da(4,2,e,t)}function Fa(e,t){return Da(4,4,e,t)}function Ba(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ua(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Da(4,4,Ba.bind(null,t,e),n)}function Ha(){}function za(e,t){var n=ya();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&pa(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Ga(e,t){var n=ya();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&pa(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Va(e,t,n){return 0===(21&sa)?(e.baseState&&(e.baseState=!1,_o=!0),e.memoizedState=n):(oi(n,t)||(n=mt(),aa.lanes|=n,Nl|=n,e.baseState=!0),t)}function Wa(e,t){var n=_t;_t=0!==n&&4>n?n:4,e(!0);var i=ra.transition;ra.transition={};try{e(!1),t()}finally{_t=n,ra.transition=i}}function ja(){return ya().memoizedState}function Ya(e,t,n){var i=tc(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Ka(e))qa(t,n);else if(null!==(n=Ds(e,t,n,i))){nc(n,e,i,ec()),Ja(n,t,i)}}function Xa(e,t,n){var i=tc(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ka(e))qa(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,n);if(r.hasEagerState=!0,r.eagerState=o,oi(o,a)){var l=t.interleaved;return null===l?(r.next=r,Is(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=Ds(e,t,r,i))&&(nc(n,e,i,r=ec()),Ja(n,t,i))}}function Ka(e){var t=e.alternate;return e===aa||null!==t&&t===aa}function qa(e,t){ua=ca=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ja(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Qa={readContext:Ls,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},Za={readContext:Ls,useCallback:function(e,t){return va().memoizedState=[e,void 0===t?null:t],e},useContext:Ls,useEffect:ka,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ia(4194308,4,Ba.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ia(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ia(4,2,e,t)},useMemo:function(e,t){var n=va();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=va();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Ya.bind(null,aa,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},va().memoizedState=e},useState:Ra,useDebugValue:Ha,useDeferredValue:function(e){return va().memoizedState=e},useTransition:function(){var e=Ra(!1),t=e[0];return e=Wa.bind(null,e[1]),va().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=aa,r=va();if(rs){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Rl)throw Error(s(349));0!==(30&sa)||wa(i,t,n)}r.memoizedState=n;var a={value:n,getSnapshot:t};return r.queue=a,ka(Ma.bind(null,i,a,e),[e]),i.flags|=2048,La(9,Ta.bind(null,i,a,n,t),void 0,null),n},useId:function(){var e=va(),t=Rl.identifierPrefix;if(rs){var n=Qr;t=":"+t+"R"+(n=(Jr&~(1<<32-at(Jr)-1)).toString(32)+n),0<(n=da++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ha++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$a={readContext:Ls,useCallback:za,useContext:Ls,useEffect:Oa,useImperativeHandle:Ua,useInsertionEffect:Na,useLayoutEffect:Fa,useMemo:Ga,useReducer:ba,useRef:Pa,useState:function(){return ba(_a)},useDebugValue:Ha,useDeferredValue:function(e){return Va(ya(),oa.memoizedState,e)},useTransition:function(){return[ba(_a)[0],ya().memoizedState]},useMutableSource:Sa,useSyncExternalStore:Ea,useId:ja,unstable_isNewReconciler:!1},eo={readContext:Ls,useCallback:za,useContext:Ls,useEffect:Oa,useImperativeHandle:Ua,useInsertionEffect:Na,useLayoutEffect:Fa,useMemo:Ga,useReducer:xa,useRef:Pa,useState:function(){return xa(_a)},useDebugValue:Ha,useDeferredValue:function(e){var t=ya();return null===oa?t.memoizedState=e:Va(t,oa.memoizedState,e)},useTransition:function(){return[xa(_a)[0],ya().memoizedState]},useMutableSource:Sa,useSyncExternalStore:Ea,useId:ja,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var io={isMounted:function(e){return!!(e=e._reactInternals)&&Ge(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=ec(),r=tc(e),s=Bs(i,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,r))&&(nc(t,e,r,i),Hs(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=ec(),r=tc(e),s=Bs(i,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,r))&&(nc(t,e,r,i),Hs(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),i=tc(e),r=Bs(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Us(e,r,i))&&(nc(t,e,i,n),Hs(t,e,i))}};function ro(e,t,n,i,r,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(r,s))}function so(e,t,n){var i=!1,r=Ar,s=t.contextType;return"object"===typeof s&&null!==s?s=Ls(s):(r=Ir(t)?Lr:Cr.current,s=(i=null!==(i=t.contextTypes)&&void 0!==i)?Pr(e,r):Ar),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=io,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function ao(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&io.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Ns(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=Ls(s):(s=Ir(t)?Lr:Cr.current,r.context=Pr(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(no(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&io.enqueueReplaceState(r,r.state,null),Gs(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",i=t;do{n+=z(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ho="function"===typeof WeakMap?WeakMap:Map;function fo(e,t,n){(n=Bs(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Wl||(Wl=!0,jl=i),uo(0,t)},n}function po(e,t,n){(n=Bs(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){uo(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!==typeof i&&(null===Yl?Yl=new Set([this]):Yl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function mo(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new ho;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=Tc.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vo(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Bs(-1,1)).tag=2,Us(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var yo=b.ReactCurrentOwner,_o=!1;function bo(e,t,n,i){t.child=null===e?xs(t,null,n,i):bs(t,e.child,n,i)}function xo(e,t,n,i,r){n=n.render;var s=t.ref;return Rs(t,r),i=ma(e,t,n,i,s,r),n=ga(),null===e||_o?(rs&&n&&es(t),t.flags|=1,bo(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wo(e,t,r))}function So(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Ic(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=kc(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Eo(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:li)(a,i)&&e.ref===t.ref)return Wo(e,t,r)}return t.flags|=1,(e=Dc(s,i)).ref=t.ref,e.return=t,t.child=e}function Eo(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(li(s,i)&&e.ref===t.ref){if(_o=!1,t.pendingProps=i=s,0===(e.lanes&r))return t.lanes=e.lanes,Wo(e,t,r);0!==(131072&e.flags)&&(_o=!0)}}return Mo(e,t,n,i,r)}function wo(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mr(Dl,Il),Il|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Mr(Dl,Il),Il|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,Mr(Dl,Il),Il|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,Mr(Dl,Il),Il|=i;return bo(e,t,r,n),t.child}function To(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Mo(e,t,n,i,r){var s=Ir(n)?Lr:Cr.current;return s=Pr(t,s),Rs(t,r),n=ma(e,t,n,i,s,r),i=ga(),null===e||_o?(rs&&i&&es(t),t.flags|=1,bo(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wo(e,t,r))}function Ao(e,t,n,i,r){if(Ir(n)){var s=!0;Nr(t)}else s=!1;if(Rs(t,r),null===t.stateNode)Vo(e,t),so(t,n,i),oo(t,n,i,r),i=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ls(c):c=Pr(t,c=Ir(n)?Lr:Cr.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==i||l!==c)&&ao(t,a,i,c),Os=!1;var h=t.memoizedState;a.state=h,Gs(t,i,a,r),l=t.memoizedState,o!==i||h!==l||Rr.current||Os?("function"===typeof u&&(no(t,n,u,i),l=t.memoizedState),(o=Os||ro(t,n,o,i,h,l,c))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),a.props=i,a.state=l,a.context=c,i=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),i=!1)}else{a=t.stateNode,Fs(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),a.props=c,d=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ls(l):l=Pr(t,l=Ir(n)?Lr:Cr.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==d||h!==l)&&ao(t,a,i,l),Os=!1,h=t.memoizedState,a.state=h,Gs(t,i,a,r);var p=t.memoizedState;o!==d||h!==p||Rr.current||Os?("function"===typeof f&&(no(t,n,f,i),p=t.memoizedState),(c=Os||ro(t,n,c,i,h,p,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(i,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(i,p,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),a.props=i,a.state=p,a.context=l,i=c):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return Co(e,t,n,i,s,r)}function Co(e,t,n,i,r,s){To(e,t);var a=0!==(128&t.flags);if(!i&&!a)return r&&Fr(t,n,!1),Wo(e,t,s);i=t.stateNode,yo.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&a?(t.child=bs(t,e.child,null,s),t.child=bs(t,null,o,s)):bo(e,t,o,s),t.memoizedState=i.state,r&&Fr(t,n,!0),t.child}function Ro(e){var t=e.stateNode;t.pendingContext?kr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&kr(0,t.context,!1),qs(e,t.containerInfo)}function Lo(e,t,n,i,r){return fs(),ps(r),t.flags|=256,bo(e,t,n,i),t.child}var Po,Io,Do,ko,Oo={dehydrated:null,treeContext:null,retryLane:0};function No(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fo(e,t,n){var i,r=t.pendingProps,a=$s.current,o=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&a)),i?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Mr($s,1&a),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Nc(l,r,0,null),e=Oc(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=No(n),t.memoizedState=Oo,e):Bo(t,l));if(null!==(a=e.memoizedState)&&null!==(i=a.dehydrated))return function(e,t,n,i,r,a,o){if(n)return 256&t.flags?(t.flags&=-257,Uo(e,t,o,i=co(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=i.fallback,r=t.mode,i=Nc({mode:"visible",children:i.children},r,0,null),(a=Oc(a,r,o,null)).flags|=2,i.return=t,a.return=t,i.sibling=a,t.child=i,0!==(1&t.mode)&&bs(t,e.child,null,o),t.child.memoizedState=No(o),t.memoizedState=Oo,a);if(0===(1&t.mode))return Uo(e,t,o,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Uo(e,t,o,i=co(a=Error(s(419)),i,void 0))}if(l=0!==(o&e.childLanes),_o||l){if(null!==(i=Rl)){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|o))?0:r)&&r!==a.retryLane&&(a.retryLane=r,ks(e,r),nc(i,e,r,-1))}return mc(),Uo(e,t,o,i=co(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Ac.bind(null,e),r._reactRetry=t,null):(e=a.treeContext,is=cr(r.nextSibling),ns=t,rs=!0,ss=null,null!==e&&(Xr[Kr++]=Jr,Xr[Kr++]=Qr,Xr[Kr++]=qr,Jr=e.id,Qr=e.overflow,qr=t),t=Bo(t,i.children),t.flags|=4096,t)}(e,t,l,r,i,a,n);if(o){o=r.fallback,l=t.mode,i=(a=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==a?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Dc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==i?o=Dc(i,o):(o=Oc(o,l,n,null)).flags|=2,o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=null===(l=e.child.memoizedState)?No(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Oo,r}return e=(o=e.child).sibling,r=Dc(o,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Bo(e,t){return(t=Nc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Uo(e,t,n,i){return null!==i&&ps(i),bs(t,e.child,null,n),(e=Bo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ho(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Cs(e.return,t,n)}function zo(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function Go(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(bo(e,t,i.children,n),0!==(2&(i=$s.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ho(e,n,t);else if(19===e.tag)Ho(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Mr($s,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===ea(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),zo(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ea(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}zo(t,!0,n,null,s);break;case"together":zo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Nl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Dc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function jo(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Yo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Xo(e,t,n){var i=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yo(t),null;case 1:case 17:return Ir(t.type)&&Dr(),Yo(t),null;case 3:return i=t.stateNode,Js(),Tr(Rr),Tr(Cr),na(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(ds(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(ac(ss),ss=null))),Io(e,t),Yo(t),null;case 5:Zs(t);var r=Ks(Xs.current);if(n=t.type,null!==e&&null!=t.stateNode)Do(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(s(166));return Yo(t),null}if(e=Ks(js.current),ds(t)){i=t.stateNode,n=t.type;var a=t.memoizedProps;switch(i[hr]=t,i[fr]=a,e=0!==(1&t.mode),n){case"dialog":Ui("cancel",i),Ui("close",i);break;case"iframe":case"object":case"embed":Ui("load",i);break;case"video":case"audio":for(r=0;r<Oi.length;r++)Ui(Oi[r],i);break;case"source":Ui("error",i);break;case"img":case"image":case"link":Ui("error",i),Ui("load",i);break;case"details":Ui("toggle",i);break;case"input":J(i,a),Ui("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},Ui("invalid",i);break;case"textarea":re(i,a),Ui("invalid",i)}for(var l in ye(n,a),r=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==a.suppressHydrationWarning&&Zi(i.textContent,c,e),r=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Zi(i.textContent,c,e),r=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ui("scroll",i)}switch(n){case"input":Y(i),$(i,a,!0);break;case"textarea":Y(i),ae(i);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(i.onclick=$i)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[hr]=t,e[fr]=i,Po(e,t,!1,!1),t.stateNode=e;e:{switch(l=_e(n,i),n){case"dialog":Ui("cancel",e),Ui("close",e),r=i;break;case"iframe":case"object":case"embed":Ui("load",e),r=i;break;case"video":case"audio":for(r=0;r<Oi.length;r++)Ui(Oi[r],e);r=i;break;case"source":Ui("error",e),r=i;break;case"img":case"image":case"link":Ui("error",e),Ui("load",e),r=i;break;case"details":Ui("toggle",e),r=i;break;case"input":J(e,i),r=q(e,i),Ui("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=F({},i,{value:void 0}),Ui("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),Ui("invalid",e)}for(a in ye(n,r),c=r)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?ge(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Ui("scroll",e):null!=u&&_(e,a,u,l))}switch(n){case"input":Y(e),$(e,i,!1);break;case"textarea":Y(e),ae(e);break;case"option":null!=i.value&&e.setAttribute("value",""+W(i.value));break;case"select":e.multiple=!!i.multiple,null!=(a=i.value)?ne(e,!!i.multiple,a,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=$i)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Yo(t),null;case 6:if(e&&null!=t.stateNode)ko(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(s(166));if(n=Ks(Xs.current),Ks(js.current),ds(t)){if(i=t.stateNode,n=t.memoizedProps,i[hr]=t,(a=i.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Zi(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zi(i.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[hr]=t,t.stateNode=i}return Yo(t),null;case 13:if(Tr($s),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==is&&0!==(1&t.mode)&&0===(128&t.flags))hs(),fs(),t.flags|=98560,a=!1;else if(a=ds(t),null!==i&&null!==i.dehydrated){if(null===e){if(!a)throw Error(s(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(s(317));a[hr]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Yo(t),a=!1}else null!==ss&&(ac(ss),ss=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&$s.current)?0===kl&&(kl=3):mc())),null!==t.updateQueue&&(t.flags|=4),Yo(t),null);case 4:return Js(),Io(e,t),null===e&&Gi(t.stateNode.containerInfo),Yo(t),null;case 10:return As(t.type._context),Yo(t),null;case 19:if(Tr($s),null===(a=t.memoizedState))return Yo(t),null;if(i=0!==(128&t.flags),null===(l=a.rendering))if(i)jo(a,!1);else{if(0!==kl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ea(e))){for(t.flags|=128,jo(a,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Mr($s,1&$s.current|2),t.child}e=e.sibling}null!==a.tail&&Qe()>Gl&&(t.flags|=128,i=!0,jo(a,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=ea(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),jo(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!rs)return Yo(t),null}else 2*Qe()-a.renderingStartTime>Gl&&1073741824!==n&&(t.flags|=128,i=!0,jo(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Qe(),t.sibling=null,n=$s.current,Mr($s,i?1&n|2:1&n),t):(Yo(t),null);case 22:case 23:return dc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Il)&&(Yo(t),6&t.subtreeFlags&&(t.flags|=8192)):Yo(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ko(e,t){switch(ts(t),t.tag){case 1:return Ir(t.type)&&Dr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Js(),Tr(Rr),Tr(Cr),na(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zs(t),null;case 13:if(Tr($s),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Tr($s),null;case 4:return Js(),null;case 10:return As(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Po=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Io=function(){},Do=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,Ks(js.current);var s,a=null;switch(n){case"input":r=q(e,r),i=q(e,i),a=[];break;case"select":r=F({},r,{value:void 0}),i=F({},i,{value:void 0}),a=[];break;case"textarea":r=ie(e,r),i=ie(e,i),a=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=$i)}for(u in ye(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ui("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},ko=function(e,t,n,i){n!==i&&(t.flags|=4)};var qo=!1,Jo=!1,Qo="function"===typeof WeakSet?WeakSet:Set,Zo=null;function $o(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){wc(e,t,i)}else n.current=null}function el(e,t,n){try{n()}catch(i){wc(e,t,i)}}var tl=!1;function nl(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&el(t,n,s)}r=r.next}while(r!==i)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hr],delete t[fr],delete t[mr],delete t[gr],delete t[vr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$i));else if(4!==i&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,n)}catch(o){}switch(n.tag){case 5:Jo||$o(n,t);case 6:var i=ul,r=dl;ul=null,hl(e,t,n),dl=r,null!==(ul=i)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),Gt(e)):lr(ul,n.stateNode));break;case 4:i=ul,r=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=i,dl=r;break;case 0:case 11:case 14:case 15:if(!Jo&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var s=r,a=s.destroy;s=s.tag,void 0!==a&&(0!==(2&s)||0!==(4&s))&&el(n,t,a),r=r.next}while(r!==i)}hl(e,t,n);break;case 1:if(!Jo&&($o(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(o){wc(n,t,o)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Jo=(i=Jo)||null!==n.memoizedState,hl(e,t,n),Jo=i):hl(e,t,n);break;default:hl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qo),t.forEach(function(t){var i=Cc.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))})}}function ml(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));fl(a,o,r),ul=null,dl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(u){wc(r,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&i){try{nl(3,e,e.return),il(3,e)}catch(g){wc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){wc(e,e.return,g)}}break;case 1:ml(t,e),vl(e),512&i&&null!==n&&$o(n,n.return);break;case 5:if(ml(t,e),vl(e),512&i&&null!==n&&$o(n,n.return),32&e.flags){var r=e.stateNode;try{he(r,"")}catch(g){wc(e,e.return,g)}}if(4&i&&null!=(r=e.stateNode)){var a=e.memoizedProps,o=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&Q(r,a),_e(l,o);var u=_e(l,a);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];"style"===d?ge(r,h):"dangerouslySetInnerHTML"===d?de(r,h):"children"===d?he(r,h):_(r,d,h,u)}switch(l){case"input":Z(r,a);break;case"textarea":se(r,a);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?ne(r,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?ne(r,!!a.multiple,a.defaultValue,!0):ne(r,!!a.multiple,a.multiple?[]:"",!1))}r[fr]=a}catch(g){wc(e,e.return,g)}}break;case 6:if(ml(t,e),vl(e),4&i){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,a=e.memoizedProps;try{r.nodeValue=a}catch(g){wc(e,e.return,g)}}break;case 3:if(ml(t,e),vl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Gt(t.containerInfo)}catch(g){wc(e,e.return,g)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(r=e.child).flags&&(a=null!==r.memoizedState,r.stateNode.isHidden=a,!a||null!==r.alternate&&null!==r.alternate.memoizedState||(zl=Qe())),4&i&&pl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Jo=(u=Jo)||d,ml(t,e),Jo=u):ml(t,e),vl(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Zo=e,d=e.child;null!==d;){for(h=Zo=d;null!==Zo;){switch(p=(f=Zo).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:$o(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){i=f,n=f.return;try{t=i,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){wc(i,n,g)}}break;case 5:$o(f,f.return);break;case 22:if(null!==f.memoizedState){xl(h);continue}}null!==p?(p.return=f,Zo=p):xl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{r=h.stateNode,u?"function"===typeof(a=r.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(g){wc(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){wc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),vl(e),4&i&&pl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var i=n;break e}n=n.return}throw Error(s(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(he(r,""),i.flags&=-33),cl(e,ol(e),r);break;case 3:case 4:var a=i.stateNode.containerInfo;ll(e,ol(e),a);break;default:throw Error(s(161))}}catch(o){wc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Zo=e,_l(e,t,n)}function _l(e,t,n){for(var i=0!==(1&e.mode);null!==Zo;){var r=Zo,s=r.child;if(22===r.tag&&i){var a=null!==r.memoizedState||qo;if(!a){var o=r.alternate,l=null!==o&&null!==o.memoizedState||Jo;o=qo;var c=Jo;if(qo=a,(Jo=l)&&!c)for(Zo=r;null!==Zo;)l=(a=Zo).child,22===a.tag&&null!==a.memoizedState?Sl(r):null!==l?(l.return=a,Zo=l):Sl(r);for(;null!==s;)Zo=s,_l(s,t,n),s=s.sibling;Zo=r,qo=o,Jo=c}bl(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Zo=s):bl(e)}}function bl(e){for(;null!==Zo;){var t=Zo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Jo||il(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Jo)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Vs(t,a,i);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Vs(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Gt(h)}}}break;default:throw Error(s(163))}Jo||512&t.flags&&rl(t)}catch(f){wc(t,t.return,f)}}if(t===e){Zo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zo=n;break}Zo=t.return}}function xl(e){for(;null!==Zo;){var t=Zo;if(t===e){Zo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zo=n;break}Zo=t.return}}function Sl(e){for(;null!==Zo;){var t=Zo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){wc(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){wc(t,r,l)}}var s=t.return;try{rl(t)}catch(l){wc(t,s,l)}break;case 5:var a=t.return;try{rl(t)}catch(l){wc(t,a,l)}}}catch(l){wc(t,t.return,l)}if(t===e){Zo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Zo=o;break}Zo=t.return}}var El,wl=Math.ceil,Tl=b.ReactCurrentDispatcher,Ml=b.ReactCurrentOwner,Al=b.ReactCurrentBatchConfig,Cl=0,Rl=null,Ll=null,Pl=0,Il=0,Dl=wr(0),kl=0,Ol=null,Nl=0,Fl=0,Bl=0,Ul=null,Hl=null,zl=0,Gl=1/0,Vl=null,Wl=!1,jl=null,Yl=null,Xl=!1,Kl=null,ql=0,Jl=0,Ql=null,Zl=-1,$l=0;function ec(){return 0!==(6&Cl)?Qe():-1!==Zl?Zl:Zl=Qe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Pl?Pl&-Pl:null!==ms.transition?(0===$l&&($l=mt()),$l):0!==(e=_t)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function nc(e,t,n,i){if(50<Jl)throw Jl=0,Ql=null,Error(s(185));vt(e,n,i),0!==(2&Cl)&&e===Rl||(e===Rl&&(0===(2&Cl)&&(Fl|=n),4===kl&&oc(e,Pl)),ic(e,i),1===n&&0===Cl&&0===(1&t.mode)&&(Gl=Qe()+500,Ur&&Gr()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-at(s),o=1<<a,l=r[a];-1===l?0!==(o&n)&&0===(o&i)||(r[a]=ft(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var i=ht(e,e===Rl?Pl:0);if(0===i)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Ur=!0,zr(e)}(lc.bind(null,e)):zr(lc.bind(null,e)),ar(function(){0===(6&Cl)&&Gr()}),n=null;else{switch(bt(i)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Rc(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if(Zl=-1,$l=0,0!==(6&Cl))throw Error(s(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var i=ht(e,e===Rl?Pl:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=gc(e,i);else{t=i;var r=Cl;Cl|=2;var a=pc();for(Rl===e&&Pl===t||(Vl=null,Gl=Qe()+500,hc(e,t));;)try{yc();break}catch(l){fc(e,l)}Ms(),Tl.current=a,Cl=r,null!==Ll?t=0:(Rl=null,Pl=0,t=kl)}if(0!==t){if(2===t&&(0!==(r=pt(e))&&(i=r,t=sc(e,r))),1===t)throw n=Ol,hc(e,0),oc(e,i),ic(e,Qe()),n;if(6===t)oc(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!oi(s(),r))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=gc(e,i))&&(0!==(a=pt(e))&&(i=a,t=sc(e,a))),1===t))throw n=Ol,hc(e,0),oc(e,i),ic(e,Qe()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(s(345));case 2:case 5:xc(e,Hl,Vl);break;case 3:if(oc(e,i),(130023424&i)===i&&10<(t=zl+500-Qe())){if(0!==ht(e,0))break;if(((r=e.suspendedLanes)&i)!==i){ec(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(xc.bind(null,e,Hl,Vl),t);break}xc(e,Hl,Vl);break;case 4:if(oc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var o=31-at(i);a=1<<o,(o=t[o])>r&&(r=o),i&=~a}if(i=r,10<(i=(120>(i=Qe()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*wl(i/1960))-i)){e.timeoutHandle=ir(xc.bind(null,e,Hl,Vl),i);break}xc(e,Hl,Vl);break;default:throw Error(s(329))}}}return ic(e,Qe()),e.callbackNode===n?rc.bind(null,e):null}function sc(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Hl,Hl=n,null!==t&&ac(t)),e}function ac(e){null===Hl?Hl=e:Hl.push.apply(Hl,e)}function oc(e,t){for(t&=~Bl,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),i=1<<n;e[n]=-1,t&=~i}}function lc(e){if(0!==(6&Cl))throw Error(s(327));Sc();var t=ht(e,0);if(0===(1&t))return ic(e,Qe()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var i=pt(e);0!==i&&(t=i,n=sc(e,i))}if(1===n)throw n=Ol,hc(e,0),oc(e,t),ic(e,Qe()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,Hl,Vl),ic(e,Qe()),null}function cc(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&(Gl=Qe()+500,Ur&&Gr())}}function uc(e){null!==Kl&&0===Kl.tag&&0===(6&Cl)&&Sc();var t=Cl;Cl|=1;var n=Al.transition,i=_t;try{if(Al.transition=null,_t=1,e)return e()}finally{_t=i,Al.transition=n,0===(6&(Cl=t))&&Gr()}}function dc(){Il=Dl.current,Tr(Dl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==Ll)for(n=Ll.return;null!==n;){var i=n;switch(ts(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Dr();break;case 3:Js(),Tr(Rr),Tr(Cr),na();break;case 5:Zs(i);break;case 4:Js();break;case 13:case 19:Tr($s);break;case 10:As(i.type._context);break;case 22:case 23:dc()}n=n.return}if(Rl=e,Ll=e=Dc(e.current,null),Pl=Il=t,kl=0,Ol=null,Bl=Fl=Nl=0,Hl=Ul=null,null!==Ps){for(t=0;t<Ps.length;t++)if(null!==(i=(n=Ps[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var a=s.next;s.next=r,i.next=a}n.pending=i}Ps=null}return e}function fc(e,t){for(;;){var n=Ll;try{if(Ms(),ia.current=Qa,ca){for(var i=aa.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}ca=!1}if(sa=0,la=oa=aa=null,ua=!1,da=0,Ml.current=null,null===n||null===n.return){kl=1,Ol=t,Ll=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=Pl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=go(o);if(null!==p){p.flags&=-257,vo(p,o,l,0,t),1&p.mode&&mo(a,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){mo(a,u,t),mc();break e}c=Error(s(426))}else if(rs&&1&l.mode){var v=go(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vo(v,o,l,0,t),ps(lo(c,l));break e}}a=c=lo(c,l),4!==kl&&(kl=2),null===Ul?Ul=[a]:Ul.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,zs(a,fo(0,c,t));break e;case 1:l=c;var y=a.type,_=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===Yl||!Yl.has(_)))){a.flags|=65536,t&=-t,a.lanes|=t,zs(a,po(a,l,t));break e}}a=a.return}while(null!==a)}bc(n)}catch(b){t=b,Ll===n&&null!==n&&(Ll=n=n.return);continue}break}}function pc(){var e=Tl.current;return Tl.current=Qa,null===e?Qa:e}function mc(){0!==kl&&3!==kl&&2!==kl||(kl=4),null===Rl||0===(268435455&Nl)&&0===(268435455&Fl)||oc(Rl,Pl)}function gc(e,t){var n=Cl;Cl|=2;var i=pc();for(Rl===e&&Pl===t||(Vl=null,hc(e,t));;)try{vc();break}catch(r){fc(e,r)}if(Ms(),Cl=n,Tl.current=i,null!==Ll)throw Error(s(261));return Rl=null,Pl=0,kl}function vc(){for(;null!==Ll;)_c(Ll)}function yc(){for(;null!==Ll&&!qe();)_c(Ll)}function _c(e){var t=El(e.alternate,e,Il);e.memoizedProps=e.pendingProps,null===t?bc(e):Ll=t,Ml.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Xo(n,t,Il)))return void(Ll=n)}else{if(null!==(n=Ko(n,t)))return n.flags&=32767,void(Ll=n);if(null===e)return kl=6,void(Ll=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ll=t);Ll=t=e}while(null!==t);0===kl&&(kl=5)}function xc(e,t,n){var i=_t,r=Al.transition;try{Al.transition=null,_t=1,function(e,t,n,i){do{Sc()}while(null!==Kl);if(0!==(6&Cl))throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-at(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,a),e===Rl&&(Ll=Rl=null,Pl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xl||(Xl=!0,Rc(tt,function(){return Sc(),null})),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Al.transition,Al.transition=null;var o=_t;_t=1;var l=Cl;Cl|=4,Ml.current=null,function(e,t){if(er=Wt,fi(e=hi())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{n.nodeType,a.nodeType}catch(x){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==r&&3!==h.nodeType||(l=o+r),h!==a||0!==i&&3!==h.nodeType||(c=o+i),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===r&&(l=o),f===a&&++d===i&&(c=o),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Wt=!1,Zo=t;null!==Zo;)if(e=(t=Zo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zo=e;else for(;null!==Zo;){t=Zo;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,_=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(s(163))}}catch(x){wc(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Zo=e;break}Zo=t.return}m=tl,tl=!1}(e,n),gl(n,e),pi(tr),Wt=!!er,tr=er=null,e.current=n,yl(n,e,r),Je(),Cl=l,_t=o,Al.transition=a}else e.current=n;if(Xl&&(Xl=!1,Kl=e,ql=r),a=e.pendingLanes,0===a&&(Yl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,Qe()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Wl)throw Wl=!1,e=jl,jl=null,e;0!==(1&ql)&&0!==e.tag&&Sc(),a=e.pendingLanes,0!==(1&a)?e===Ql?Jl++:(Jl=0,Ql=e):Jl=0,Gr()}(e,t,n,i)}finally{Al.transition=r,_t=i}return null}function Sc(){if(null!==Kl){var e=bt(ql),t=Al.transition,n=_t;try{if(Al.transition=null,_t=16>e?16:e,null===Kl)var i=!1;else{if(e=Kl,Kl=null,ql=0,0!==(6&Cl))throw Error(s(331));var r=Cl;for(Cl|=4,Zo=e.current;null!==Zo;){var a=Zo,o=a.child;if(0!==(16&Zo.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Zo=u;null!==Zo;){var d=Zo;switch(d.tag){case 0:case 11:case 15:nl(8,d,a)}var h=d.child;if(null!==h)h.return=d,Zo=h;else for(;null!==Zo;){var f=(d=Zo).sibling,p=d.return;if(sl(d),d===u){Zo=null;break}if(null!==f){f.return=p,Zo=f;break}Zo=p}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Zo=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,Zo=o;else e:for(;null!==Zo;){if(0!==(2048&(a=Zo).flags))switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Zo=y;break e}Zo=a.return}}var _=e.current;for(Zo=_;null!==Zo;){var b=(o=Zo).child;if(0!==(2064&o.subtreeFlags)&&null!==b)b.return=o,Zo=b;else e:for(o=_;null!==Zo;){if(0!==(2048&(l=Zo).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(S){wc(l,l.return,S)}if(l===o){Zo=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,Zo=x;break e}Zo=l.return}}if(Cl=r,Gr(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(S){}i=!0}return i}finally{_t=n,Al.transition=t}}return!1}function Ec(e,t,n){e=Us(e,t=fo(0,t=lo(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),ic(e,t))}function wc(e,t,n){if(3===e.tag)Ec(e,e,n);else for(;null!==t;){if(3===t.tag){Ec(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Yl||!Yl.has(i))){t=Us(t,e=po(t,e=lo(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),ic(t,e));break}}t=t.return}}function Tc(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Rl===e&&(Pl&n)===n&&(4===kl||3===kl&&(130023424&Pl)===Pl&&500>Qe()-zl?hc(e,0):Bl|=n),ic(e,t)}function Mc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=ks(e,t))&&(vt(e,t,n),ic(e,n))}function Ac(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Mc(e,n)}function Cc(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(s(314))}null!==i&&i.delete(t),Mc(e,n)}function Rc(e,t){return Xe(e,t)}function Lc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pc(e,t,n,i){return new Lc(e,t,n,i)}function Ic(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dc(e,t){var n=e.alternate;return null===n?((n=Pc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function kc(e,t,n,i,r,a){var o=2;if(i=e,"function"===typeof e)Ic(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case E:return Oc(n.children,r,a,t);case w:o=8,r|=8;break;case T:return(e=Pc(12,n,t,2|r)).elementType=T,e.lanes=a,e;case R:return(e=Pc(13,n,t,r)).elementType=R,e.lanes=a,e;case L:return(e=Pc(19,n,t,r)).elementType=L,e.lanes=a,e;case D:return Nc(n,r,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case M:o=10;break e;case A:o=9;break e;case C:o=11;break e;case P:o=14;break e;case I:o=16,i=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Pc(o,n,t,r)).elementType=e,t.type=i,t.lanes=a,t}function Oc(e,t,n,i){return(e=Pc(7,e,i,t)).lanes=n,e}function Nc(e,t,n,i){return(e=Pc(22,e,i,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Fc(e,t,n){return(e=Pc(6,e,null,t)).lanes=n,e}function Bc(e,t,n){return(t=Pc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Hc(e,t,n,i,r,s,a,o,l){return e=new Uc(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Pc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ns(s),e}function zc(e){if(!e)return Ar;e:{if(Ge(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ir(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Ir(n))return Or(e,n,t)}return t}function Gc(e,t,n,i,r,s,a,o,l){return(e=Hc(n,i,!0,e,0,s,0,o,l)).context=zc(null),n=e.current,(s=Bs(i=ec(),r=tc(n))).callback=void 0!==t&&null!==t?t:null,Us(n,s,r),e.current.lanes=r,vt(e,r,i),ic(e,i),e}function Vc(e,t,n,i){var r=t.current,s=ec(),a=tc(r);return n=zc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Bs(s,a)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Us(r,t,a))&&(nc(e,r,a,s),Hs(e,r,a)),a}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function jc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Yc(e,t){jc(e,t),(e=e.alternate)&&jc(e,t)}El=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Rr.current)_o=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return _o=!1,function(e,t,n){switch(t.tag){case 3:Ro(t),fs();break;case 5:Qs(t);break;case 1:Ir(t.type)&&Nr(t);break;case 4:qs(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Mr(Ss,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Mr($s,1&$s.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fo(e,t,n):(Mr($s,1&$s.current),null!==(e=Wo(e,t,n))?e.sibling:null);Mr($s,1&$s.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return Go(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Mr($s,$s.current),i)break;return null;case 22:case 23:return t.lanes=0,wo(e,t,n)}return Wo(e,t,n)}(e,t,n);_o=0!==(131072&e.flags)}else _o=!1,rs&&0!==(1048576&t.flags)&&$r(t,Yr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Vo(e,t),e=t.pendingProps;var r=Pr(t,Cr.current);Rs(t,n),r=ma(null,t,i,e,r,n);var a=ga();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ir(i)?(a=!0,Nr(t)):a=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Ns(t),r.updater=io,t.stateNode=r,r._reactInternals=t,oo(t,i,e,n),t=Co(null,t,i,!0,a,n)):(t.tag=0,rs&&a&&es(t),bo(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Vo(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Ic(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===P)return 14}return 2}(i),e=to(i,e),r){case 0:t=Mo(null,t,i,e,n);break e;case 1:t=Ao(null,t,i,e,n);break e;case 11:t=xo(null,t,i,e,n);break e;case 14:t=So(null,t,i,to(i.type,e),n);break e}throw Error(s(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Mo(e,t,i,r=t.elementType===i?r:to(i,r),n);case 1:return i=t.type,r=t.pendingProps,Ao(e,t,i,r=t.elementType===i?r:to(i,r),n);case 3:e:{if(Ro(t),null===e)throw Error(s(387));i=t.pendingProps,r=(a=t.memoizedState).element,Fs(e,t),Gs(t,i,null,n);var o=t.memoizedState;if(i=o.element,a.isDehydrated){if(a={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Lo(e,t,i,n,r=lo(Error(s(423)),t));break e}if(i!==r){t=Lo(e,t,i,n,r=lo(Error(s(424)),t));break e}for(is=cr(t.stateNode.containerInfo.firstChild),ns=t,rs=!0,ss=null,n=xs(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),i===r){t=Wo(e,t,n);break e}bo(e,t,i,n)}t=t.child}return t;case 5:return Qs(t),null===e&&cs(t),i=t.type,r=t.pendingProps,a=null!==e?e.memoizedProps:null,o=r.children,nr(i,r)?o=null:null!==a&&nr(i,a)&&(t.flags|=32),To(e,t),bo(e,t,o,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Fo(e,t,n);case 4:return qs(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=bs(t,null,i,n):bo(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,xo(e,t,i,r=t.elementType===i?r:to(i,r),n);case 7:return bo(e,t,t.pendingProps,n),t.child;case 8:case 12:return bo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,a=t.memoizedProps,o=r.value,Mr(Ss,i._currentValue),i._currentValue=o,null!==a)if(oi(a.value,o)){if(a.children===r.children&&!Rr.current){t=Wo(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===a.tag){(c=Bs(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Cs(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Cs(o,n,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}bo(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Rs(t,n),i=i(r=Ls(r)),t.flags|=1,bo(e,t,i,n),t.child;case 14:return r=to(i=t.type,t.pendingProps),So(e,t,i,r=to(i.type,r),n);case 15:return Eo(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:to(i,r),Vo(e,t),t.tag=1,Ir(i)?(e=!0,Nr(t)):e=!1,Rs(t,n),so(t,i,r),oo(t,i,r,n),Co(null,t,i,!0,e,n);case 19:return Go(e,t,n);case 22:return wo(e,t,n)}throw Error(s(156,t.tag))};var Xc="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function qc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function $c(e,t,n,i,r){var s=n._reactRootContainer;if(s){var a=s;if("function"===typeof r){var o=r;r=function(){var e=Wc(a);o.call(e)}}Vc(t,a,e,r)}else a=function(e,t,n,i,r){if(r){if("function"===typeof i){var s=i;i=function(){var e=Wc(a);s.call(e)}}var a=Gc(t,i,e,0,null,!1,0,"",Zc);return e._reactRootContainer=a,e[pr]=a.current,Gi(8===e.nodeType?e.parentNode:e),uc(),a}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var o=i;i=function(){var e=Wc(l);o.call(e)}}var l=Hc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[pr]=l.current,Gi(8===e.nodeType?e.parentNode:e),uc(function(){Vc(t,l,n,i)}),l}(n,t,e,r,i);return Wc(a)}qc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Vc(e,t,null,null)},qc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){Vc(null,e,null,null)}),t[pr]=null}},qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=wt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ft(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),ic(t,Qe()),0===(6&Cl)&&(Gl=Qe()+500,Gr()))}break;case 13:uc(function(){var t=ks(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Yc(e,1)}},St=function(e){if(13===e.tag){var t=ks(e,134217728);if(null!==t)nc(t,e,134217728,ec());Yc(e,134217728)}},Et=function(e){if(13===e.tag){var t=tc(e),n=ks(e,t);if(null!==n)nc(n,e,t,ec());Yc(e,t)}},wt=function(){return _t},Tt=function(e,t){var n=_t;try{return _t=e,t()}finally{_t=n}},Se=function(e,t,n){switch(t){case"input":if(Z(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=xr(i);if(!r)throw Error(s(90));X(i),Z(i,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=cc,Re=uc;var eu={usingClientEntryPoint:!1,Events:[_r,br,xr,Me,Ae,cc]},tu={findFiberByHostInstance:yr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=je(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{rt=iu.inject(nu),st=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(s(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(s(299));var n=!1,i="",r=Xc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Hc(e,1,!1,null,0,n,0,i,r),e[pr]=t.current,Gi(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=je(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Qc(t))throw Error(s(200));return $c(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(s(405));var i=null!=n&&n.hydratedSources||null,r=!1,a="",o=Xc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Gc(t,null,e,1,null!=n?n:null,r,0,a,o),e[pr]=t.current,Gi(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new qc(t)},t.render=function(e,t,n){if(!Qc(t))throw Error(s(200));return $c(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Qc(e))throw Error(s(40));return!!e._reactRootContainer&&(uc(function(){$c(null,null,e,!1,function(){e._reactRootContainer=null,e[pr]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Qc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return $c(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},920:(e,t,n)=>{e.exports=function(e){var t={},i=n(565),r=n(611),s=Object.assign;function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),p=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),v=Symbol.for("react.suspense_list"),y=Symbol.for("react.memo"),_=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var b=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var x=Symbol.iterator;function S(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=x&&e[x]||e["@@iterator"])?e:null}function E(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case u:return"Fragment";case c:return"Portal";case h:return"Profiler";case d:return"StrictMode";case g:return"Suspense";case v:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case p:return(e.displayName||"Context")+".Consumer";case f:return(e._context.displayName||"Context")+".Provider";case m:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case y:return null!==(t=e.displayName||null)?t:E(e.type)||"Memo";case _:t=e._payload,e=e._init;try{return E(e(t))}catch(n){}}return null}function w(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return E(t);case 8:return t===d?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function T(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function M(e){if(T(e)!==e)throw Error(a(188))}function A(e){var t=e.alternate;if(!t){if(null===(t=T(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(i=r.return)){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return M(r),e;if(s===i)return M(r),t;s=s.sibling}throw Error(a(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,l=r.child;l;){if(l===n){o=!0,n=r,i=s;break}if(l===i){o=!0,i=r,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,i=r;break}if(l===i){o=!0,i=s,n=r;break}l=l.sibling}if(!o)throw Error(a(189))}}if(n.alternate!==i)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}function C(e){return null!==(e=A(e))?R(e):null}function R(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=R(e);if(null!==t)return t;e=e.sibling}return null}function L(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){if(4!==e.tag){var t=L(e);if(null!==t)return t}e=e.sibling}return null}var P,I=Array.isArray,D=e.getPublicInstance,k=e.getRootHostContext,O=e.getChildHostContext,N=e.prepareForCommit,F=e.resetAfterCommit,B=e.createInstance,U=e.appendInitialChild,H=e.finalizeInitialChildren,z=e.prepareUpdate,G=e.shouldSetTextContent,V=e.createTextInstance,W=e.scheduleTimeout,j=e.cancelTimeout,Y=e.noTimeout,X=e.isPrimaryRenderer,K=e.supportsMutation,q=e.supportsPersistence,J=e.supportsHydration,Q=e.getInstanceFromNode,Z=e.preparePortalMount,$=e.getCurrentEventPriority,ee=e.detachDeletedInstance,te=e.supportsMicrotasks,ne=e.scheduleMicrotask,ie=e.supportsTestSelectors,re=e.findFiberRoot,se=e.getBoundingRect,ae=e.getTextContent,oe=e.isHiddenSubtree,le=e.matchAccessibilityRole,ce=e.setFocusIfFocusable,ue=e.setupIntersectionObserver,de=e.appendChild,he=e.appendChildToContainer,fe=e.commitTextUpdate,pe=e.commitMount,me=e.commitUpdate,ge=e.insertBefore,ve=e.insertInContainerBefore,ye=e.removeChild,_e=e.removeChildFromContainer,be=e.resetTextContent,xe=e.hideInstance,Se=e.hideTextInstance,Ee=e.unhideInstance,we=e.unhideTextInstance,Te=e.clearContainer,Me=e.cloneInstance,Ae=e.createContainerChildSet,Ce=e.appendChildToContainerChildSet,Re=e.finalizeContainerChildren,Le=e.replaceContainerChildren,Pe=e.cloneHiddenInstance,Ie=e.cloneHiddenTextInstance,De=e.canHydrateInstance,ke=e.canHydrateTextInstance,Oe=e.canHydrateSuspenseInstance,Ne=e.isSuspenseInstancePending,Fe=e.isSuspenseInstanceFallback,Be=e.registerSuspenseInstanceRetry,Ue=e.getNextHydratableSibling,He=e.getFirstHydratableChild,ze=e.getFirstHydratableChildWithinContainer,Ge=e.getFirstHydratableChildWithinSuspenseInstance,Ve=e.hydrateInstance,We=e.hydrateTextInstance,je=e.hydrateSuspenseInstance,Ye=e.getNextHydratableInstanceAfterSuspenseInstance,Xe=e.commitHydratedContainer,Ke=e.commitHydratedSuspenseInstance,qe=e.clearSuspenseBoundary,Je=e.clearSuspenseBoundaryFromContainer,Qe=e.shouldDeleteUnhydratedTailInstances,Ze=e.didNotMatchHydratedContainerTextInstance,$e=e.didNotMatchHydratedTextInstance;function et(e){if(void 0===P)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);P=t&&t[1]||""}return"\n"+P+e}var tt=!1;function nt(e,t){if(!e||tt)return"";tt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),s=i.stack.split("\n"),a=r.length-1,o=s.length-1;1<=a&&0<=o&&r[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||r[a]!==s[o]){var l="\n"+r[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{tt=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?et(e):""}var it=Object.prototype.hasOwnProperty,rt=[],st=-1;function at(e){return{current:e}}function ot(e){0>st||(e.current=rt[st],rt[st]=null,st--)}function lt(e,t){st++,rt[st]=e.current,e.current=t}var ct={},ut=at(ct),dt=at(!1),ht=ct;function ft(e,t){var n=e.type.contextTypes;if(!n)return ct;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function pt(e){return null!==(e=e.childContextTypes)&&void 0!==e}function mt(){ot(dt),ot(ut)}function gt(e,t,n){if(ut.current!==ct)throw Error(a(168));lt(ut,t),lt(dt,n)}function vt(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(a(108,w(e)||"Unknown",r));return s({},n,i)}function yt(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ct,ht=ut.current,lt(ut,e),lt(dt,dt.current),!0}function _t(e,t,n){var i=e.stateNode;if(!i)throw Error(a(169));n?(e=vt(e,t,ht),i.__reactInternalMemoizedMergedChildContext=e,ot(dt),ot(ut),lt(ut,e)):ot(dt),lt(dt,n)}var bt=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(xt(e)/St|0)|0},xt=Math.log,St=Math.LN2;var Et=64,wt=4194304;function Tt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Mt(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~r;0!==o?i=Tt(o):0!==(s&=a)&&(i=Tt(s))}else 0!==(a=n&~r)?i=Tt(a):0!==s&&(i=Tt(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-bt(t)),i|=e[n],t&=~r;return i}function At(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ct(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Rt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Lt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-bt(t)]=n}function Pt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-bt(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var It=0;function Dt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var kt=r.unstable_scheduleCallback,Ot=r.unstable_cancelCallback,Nt=r.unstable_shouldYield,Ft=r.unstable_requestPaint,Bt=r.unstable_now,Ut=r.unstable_ImmediatePriority,Ht=r.unstable_UserBlockingPriority,zt=r.unstable_NormalPriority,Gt=r.unstable_IdlePriority,Vt=null,Wt=null;var jt="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},Yt=null,Xt=!1,Kt=!1;function qt(e){null===Yt?Yt=[e]:Yt.push(e)}function Jt(){if(!Kt&&null!==Yt){Kt=!0;var e=0,t=It;try{var n=Yt;for(It=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Yt=null,Xt=!1}catch(r){throw null!==Yt&&(Yt=Yt.slice(e+1)),kt(Ut,Jt),r}finally{It=t,Kt=!1}}return null}var Qt=o.ReactCurrentBatchConfig;function Zt(e,t){if(jt(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!it.call(t,r)||!jt(e[r],t[r]))return!1}return!0}function $t(e){switch(e.tag){case 5:return et(e.type);case 16:return et("Lazy");case 13:return et("Suspense");case 19:return et("SuspenseList");case 0:case 2:case 15:return e=nt(e.type,!1);case 11:return e=nt(e.type.render,!1);case 1:return e=nt(e.type,!0);default:return""}}function en(e,t){if(e&&e.defaultProps){for(var n in t=s({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var tn=at(null),nn=null,rn=null,sn=null;function an(){sn=rn=nn=null}function on(e,t,n){X?(lt(tn,t._currentValue),t._currentValue=n):(lt(tn,t._currentValue2),t._currentValue2=n)}function ln(e){var t=tn.current;ot(tn),X?e._currentValue=t:e._currentValue2=t}function cn(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function un(e,t){nn=e,sn=rn=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Nr=!0),e.firstContext=null)}function dn(e){var t=X?e._currentValue:e._currentValue2;if(sn!==e)if(e={context:e,memoizedValue:t,next:null},null===rn){if(null===nn)throw Error(a(308));rn=e,nn.dependencies={lanes:0,firstContext:e}}else rn=rn.next=e;return t}var hn=null,fn=!1;function pn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mn(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function gn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function vn(e,t){var n=e.updateQueue;null!==n&&(n=n.shared,null!==Ks&&0!==(1&e.mode)&&0===(2&Xs)?(null===(e=n.interleaved)?(t.next=t,null===hn?hn=[n]:hn.push(n)):(t.next=e.next,e.next=t),n.interleaved=t):(null===(e=n.pending)?t.next=t:(t.next=e.next,e.next=t),n.pending=t))}function yn(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Pt(e,n)}}function _n(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function bn(e,t,n,i){var r=e.updateQueue;fn=!1;var a=r.firstBaseUpdate,o=r.lastBaseUpdate,l=r.shared.pending;if(null!==l){r.shared.pending=null;var c=l,u=c.next;c.next=null,null===o?a=u:o.next=u,o=c;var d=e.alternate;null!==d&&((l=(d=d.updateQueue).lastBaseUpdate)!==o&&(null===l?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(null!==a){var h=r.baseState;for(o=0,d=u=c=null,l=a;;){var f=l.lane,p=l.eventTime;if((i&f)===f){null!==d&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,g=l;switch(f=t,p=n,g.tag){case 1:if("function"===typeof(m=g.payload)){h=m.call(p,h,f);break e}h=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(f="function"===typeof(m=g.payload)?m.call(p,h,f):m)||void 0===f)break e;h=s({},h,f);break e;case 2:fn=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(f=r.effects)?r.effects=[l]:f.push(l))}else p={eventTime:p,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===d?(u=d=p,c=h):d=d.next=p,o|=f;if(null===(l=l.next)){if(null===(l=r.shared.pending))break;l=(f=l).next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}if(null===d&&(c=h),r.baseState=c,r.firstBaseUpdate=u,r.lastBaseUpdate=d,null!==(t=r.shared.interleaved)){r=t;do{o|=r.lane,r=r.next}while(r!==t)}else null===a&&(r.shared.lanes=0);ta|=o,e.lanes=o,e.memoizedState=h}}function xn(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(a(191,r));r.call(i)}}}var Sn=(new i.Component).refs;function En(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:s({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var wn={isMounted:function(e){return!!(e=e._reactInternals)&&T(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=ba(),r=xa(e),s=gn(i,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),vn(e,s),null!==(t=Sa(e,r,i))&&yn(t,e,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=ba(),r=xa(e),s=gn(i,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),vn(e,s),null!==(t=Sa(e,r,i))&&yn(t,e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ba(),i=xa(e),r=gn(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),vn(e,r),null!==(t=Sa(e,i,n))&&yn(t,e,i)}};function Tn(e,t,n,i,r,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!Zt(n,i)||!Zt(r,s))}function Mn(e,t,n){var i=!1,r=ct,s=t.contextType;return"object"===typeof s&&null!==s?s=dn(s):(r=pt(t)?ht:ut.current,s=(i=null!==(i=t.contextTypes)&&void 0!==i)?ft(e,r):ct),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=wn,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function An(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&wn.enqueueReplaceState(t,t.state,null)}function Cn(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=Sn,pn(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=dn(s):(s=pt(t)?ht:ut.current,r.context=ft(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(En(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&wn.enqueueReplaceState(r,r.state,null),bn(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}var Rn=[],Ln=0,Pn=null,In=0,Dn=[],kn=0,On=null,Nn=1,Fn="";function Bn(e,t){Rn[Ln++]=In,Rn[Ln++]=Pn,Pn=e,In=t}function Un(e,t,n){Dn[kn++]=Nn,Dn[kn++]=Fn,Dn[kn++]=On,On=e;var i=Nn;e=Fn;var r=32-bt(i)-1;i&=~(1<<r),n+=1;var s=32-bt(t)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Nn=1<<32-bt(t)+r|n<<r|i,Fn=s+e}else Nn=1<<s|n<<r|i,Fn=e}function Hn(e){null!==e.return&&(Bn(e,1),Un(e,1,0))}function zn(e){for(;e===Pn;)Pn=Rn[--Ln],Rn[Ln]=null,In=Rn[--Ln],Rn[Ln]=null;for(;e===On;)On=Dn[--kn],Dn[kn]=null,Fn=Dn[--kn],Dn[kn]=null,Nn=Dn[--kn],Dn[kn]=null}var Gn=null,Vn=null,Wn=!1,jn=!1,Yn=null;function Xn(e,t){var n=Qa(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function Kn(e,t){switch(e.tag){case 5:return null!==(t=De(t,e.type,e.pendingProps))&&(e.stateNode=t,Gn=e,Vn=He(t),!0);case 6:return null!==(t=ke(t,e.pendingProps))&&(e.stateNode=t,Gn=e,Vn=null,!0);case 13:if(null!==(t=Oe(t))){var n=null!==On?{id:Nn,overflow:Fn}:null;return e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Qa(18,null,null,0)).stateNode=t,n.return=e,e.child=n,Gn=e,Vn=null,!0}return!1;default:return!1}}function qn(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function Jn(e){if(Wn){var t=Vn;if(t){var n=t;if(!Kn(e,t)){if(qn(e))throw Error(a(418));t=Ue(n);var i=Gn;t&&Kn(e,t)?Xn(i,n):(e.flags=-4097&e.flags|2,Wn=!1,Gn=e)}}else{if(qn(e))throw Error(a(418));e.flags=-4097&e.flags|2,Wn=!1,Gn=e}}}function Qn(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Gn=e}function Zn(e){if(!J||e!==Gn)return!1;if(!Wn)return Qn(e),Wn=!0,!1;if(3!==e.tag&&(5!==e.tag||Qe(e.type)&&!G(e.type,e.memoizedProps))){var t=Vn;if(t){if(qn(e)){for(e=Vn;e;)e=Ue(e);throw Error(a(418))}for(;t;)Xn(e,t),t=Ue(t)}}if(Qn(e),13===e.tag){if(!J)throw Error(a(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));Vn=Ye(e)}else Vn=Gn?Ue(e.stateNode):null;return!0}function $n(){J&&(Vn=Gn=null,jn=Wn=!1)}function ei(e){null===Yn?Yn=[e]:Yn.push(e)}function ti(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var i=n.stateNode}if(!i)throw Error(a(147,e));var r=i,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=r.refs;t===Sn&&(t=r.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function ni(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ii(e){return(0,e._init)(e._payload)}function ri(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=$a(e,t)).index=0,e.sibling=null,e}function s(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function d(e,t,n,i){return null===t||6!==t.tag?((t=io(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n,i){var s=n.type;return s===u?p(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===_&&ii(s)===t.type)?((i=r(t,n.props)).ref=ti(e,t,n),i.return=e,i):((i=eo(n.type,n.key,n.props,null,e.mode,i)).ref=ti(e,t,n),i.return=e,i)}function f(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=ro(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function p(e,t,n,i,s){return null===t||7!==t.tag?((t=to(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function m(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=io(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case l:return(n=eo(t.type,t.key,t.props,null,e.mode,n)).ref=ti(e,null,t),n.return=e,n;case c:return(t=ro(t,e.mode,n)).return=e,t;case _:return m(e,(0,t._init)(t._payload),n)}if(I(t)||S(t))return(t=to(t,e.mode,n,null)).return=e,t;ni(e,t)}return null}function g(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:d(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case l:return n.key===r?h(e,t,n,i):null;case c:return n.key===r?f(e,t,n,i):null;case _:return g(e,t,(r=n._init)(n._payload),i)}if(I(n)||S(n))return null!==r?null:p(e,t,n,i,null);ni(e,n)}return null}function v(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return d(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case l:return h(t,e=e.get(null===i.key?n:i.key)||null,i,r);case c:return f(t,e=e.get(null===i.key?n:i.key)||null,i,r);case _:return v(e,t,n,(0,i._init)(i._payload),r)}if(I(i)||S(i))return p(t,e=e.get(n)||null,i,r,null);ni(t,i)}return null}function y(r,a,o,l){for(var c=null,u=null,d=a,h=a=0,f=null;null!==d&&h<o.length;h++){d.index>h?(f=d,d=null):f=d.sibling;var p=g(r,d,o[h],l);if(null===p){null===d&&(d=f);break}e&&d&&null===p.alternate&&t(r,d),a=s(p,a,h),null===u?c=p:u.sibling=p,u=p,d=f}if(h===o.length)return n(r,d),Wn&&Bn(r,h),c;if(null===d){for(;h<o.length;h++)null!==(d=m(r,o[h],l))&&(a=s(d,a,h),null===u?c=d:u.sibling=d,u=d);return Wn&&Bn(r,h),c}for(d=i(r,d);h<o.length;h++)null!==(f=v(d,r,h,o[h],l))&&(e&&null!==f.alternate&&d.delete(null===f.key?h:f.key),a=s(f,a,h),null===u?c=f:u.sibling=f,u=f);return e&&d.forEach(function(e){return t(r,e)}),Wn&&Bn(r,h),c}function b(r,o,l,c){var u=S(l);if("function"!==typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var d=u=null,h=o,f=o=0,p=null,y=l.next();null!==h&&!y.done;f++,y=l.next()){h.index>f?(p=h,h=null):p=h.sibling;var _=g(r,h,y.value,c);if(null===_){null===h&&(h=p);break}e&&h&&null===_.alternate&&t(r,h),o=s(_,o,f),null===d?u=_:d.sibling=_,d=_,h=p}if(y.done)return n(r,h),Wn&&Bn(r,f),u;if(null===h){for(;!y.done;f++,y=l.next())null!==(y=m(r,y.value,c))&&(o=s(y,o,f),null===d?u=y:d.sibling=y,d=y);return Wn&&Bn(r,f),u}for(h=i(r,h);!y.done;f++,y=l.next())null!==(y=v(h,r,f,y.value,c))&&(e&&null!==y.alternate&&h.delete(null===y.key?f:y.key),o=s(y,o,f),null===d?u=y:d.sibling=y,d=y);return e&&h.forEach(function(e){return t(r,e)}),Wn&&Bn(r,f),u}return function e(i,s,a,d){if("object"===typeof a&&null!==a&&a.type===u&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case l:e:{for(var h=a.key,f=s;null!==f;){if(f.key===h){if((h=a.type)===u){if(7===f.tag){n(i,f.sibling),(s=r(f,a.props.children)).return=i,i=s;break e}}else if(f.elementType===h||"object"===typeof h&&null!==h&&h.$$typeof===_&&ii(h)===f.type){n(i,f.sibling),(s=r(f,a.props)).ref=ti(i,f,a),s.return=i,i=s;break e}n(i,f);break}t(i,f),f=f.sibling}a.type===u?((s=to(a.props.children,i.mode,d,a.key)).return=i,i=s):((d=eo(a.type,a.key,a.props,null,i.mode,d)).ref=ti(i,s,a),d.return=i,i=d)}return o(i);case c:e:{for(f=a.key;null!==s;){if(s.key===f){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(i,s.sibling),(s=r(s,a.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=ro(a,i.mode,d)).return=i,i=s}return o(i);case _:return e(i,s,(f=a._init)(a._payload),d)}if(I(a))return y(i,s,a,d);if(S(a))return b(i,s,a,d);ni(i,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,a)).return=i,i=s):(n(i,s),(s=io(a,i.mode,d)).return=i,i=s),o(i)):n(i,s)}}var si=ri(!0),ai=ri(!1),oi={},li=at(oi),ci=at(oi),ui=at(oi);function di(e){if(e===oi)throw Error(a(174));return e}function hi(e,t){lt(ui,t),lt(ci,e),lt(li,oi),e=k(t),ot(li),lt(li,e)}function fi(){ot(li),ot(ci),ot(ui)}function pi(e){var t=di(ui.current),n=di(li.current);n!==(t=O(n,e.type,t))&&(lt(ci,e),lt(li,t))}function mi(e){ci.current===e&&(ot(li),ot(ci))}var gi=at(0);function vi(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Ne(n)||Fe(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var yi=[];function _i(){for(var e=0;e<yi.length;e++){var t=yi[e];X?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}yi.length=0}var bi=o.ReactCurrentDispatcher,xi=o.ReactCurrentBatchConfig,Si=0,Ei=null,wi=null,Ti=null,Mi=!1,Ai=!1,Ci=0,Ri=0;function Li(){throw Error(a(321))}function Pi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!jt(e[n],t[n]))return!1;return!0}function Ii(e,t,n,i,r,s){if(Si=s,Ei=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,bi.current=null===e||null===e.memoizedState?pr:mr,e=n(i,r),Ai){s=0;do{if(Ai=!1,Ci=0,25<=s)throw Error(a(301));s+=1,Ti=wi=null,t.updateQueue=null,bi.current=gr,e=n(i,r)}while(Ai)}if(bi.current=fr,t=null!==wi&&null!==wi.next,Si=0,Ti=wi=Ei=null,Mi=!1,t)throw Error(a(300));return e}function Di(){var e=0!==Ci;return Ci=0,e}function ki(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ti?Ei.memoizedState=Ti=e:Ti=Ti.next=e,Ti}function Oi(){if(null===wi){var e=Ei.alternate;e=null!==e?e.memoizedState:null}else e=wi.next;var t=null===Ti?Ei.memoizedState:Ti.next;if(null!==t)Ti=t,wi=e;else{if(null===e)throw Error(a(310));e={memoizedState:(wi=e).memoizedState,baseState:wi.baseState,baseQueue:wi.baseQueue,queue:wi.queue,next:null},null===Ti?Ei.memoizedState=Ti=e:Ti=Ti.next=e}return Ti}function Ni(e,t){return"function"===typeof t?t(e):t}function Fi(e){var t=Oi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=wi,r=i.baseQueue,s=n.pending;if(null!==s){if(null!==r){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(null!==r){s=r.next,i=i.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((Si&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,o=i):c=c.next=h,Ei.lanes|=d,ta|=d}u=u.next}while(null!==u&&u!==s);null===c?o=i:c.next=l,jt(i,t.memoizedState)||(Nr=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{s=r.lane,Ei.lanes|=s,ta|=s,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Bi(e){var t=Oi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,s=t.memoizedState;if(null!==r){n.pending=null;var o=r=r.next;do{s=e(s,o.action),o=o.next}while(o!==r);jt(s,t.memoizedState)||(Nr=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,i]}function Ui(){}function Hi(e,t){var n=Ei,i=Oi(),r=t(),s=!jt(i.memoizedState,r);if(s&&(i.memoizedState=r,Nr=!0),i=i.queue,Qi(Vi.bind(null,n,i,e),[e]),i.getSnapshot!==t||s||null!==Ti&&1&Ti.memoizedState.tag){if(n.flags|=2048,Yi(9,Gi.bind(null,n,i,r,t),void 0,null),null===Ks)throw Error(a(349));0!==(30&Si)||zi(n,t,r)}return r}function zi(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Ei.updateQueue)?(t={lastEffect:null,stores:null},Ei.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Gi(e,t,n,i){t.value=n,t.getSnapshot=i,Wi(t)&&Sa(e,1,-1)}function Vi(e,t,n){return n(function(){Wi(t)&&Sa(e,1,-1)})}function Wi(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!jt(e,n)}catch(i){return!0}}function ji(e){var t=ki();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ni,lastRenderedState:e},t.queue=e,e=e.dispatch=lr.bind(null,Ei,e),[t.memoizedState,e]}function Yi(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=Ei.updateQueue)?(t={lastEffect:null,stores:null},Ei.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Xi(){return Oi().memoizedState}function Ki(e,t,n,i){var r=ki();Ei.flags|=e,r.memoizedState=Yi(1|t,n,void 0,void 0===i?null:i)}function qi(e,t,n,i){var r=Oi();i=void 0===i?null:i;var s=void 0;if(null!==wi){var a=wi.memoizedState;if(s=a.destroy,null!==i&&Pi(i,a.deps))return void(r.memoizedState=Yi(t,n,s,i))}Ei.flags|=e,r.memoizedState=Yi(1|t,n,s,i)}function Ji(e,t){return Ki(8390656,8,e,t)}function Qi(e,t){return qi(2048,8,e,t)}function Zi(e,t){return qi(4,2,e,t)}function $i(e,t){return qi(4,4,e,t)}function er(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function tr(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,qi(4,4,er.bind(null,t,e),n)}function nr(){}function ir(e,t){var n=Oi();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Pi(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function rr(e,t){var n=Oi();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Pi(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function sr(e,t){var n=It;It=0!==n&&4>n?n:4,e(!0);var i=xi.transition;xi.transition={};try{e(!1),t()}finally{It=n,xi.transition=i}}function ar(){return Oi().memoizedState}function or(e,t,n){var i=xa(e);n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},cr(e)?ur(t,n):(dr(e,t,n),null!==(e=Sa(e,i,n=ba()))&&hr(e,t,i))}function lr(e,t,n){var i=xa(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(cr(e))ur(t,r);else{dr(e,t,r);var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,n);if(r.hasEagerState=!0,r.eagerState=o,jt(o,a))return}catch(l){}null!==(e=Sa(e,i,n=ba()))&&hr(e,t,i)}}function cr(e){var t=e.alternate;return e===Ei||null!==t&&t===Ei}function ur(e,t){Ai=Mi=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function dr(e,t,n){null!==Ks&&0!==(1&e.mode)&&0===(2&Xs)?(null===(e=t.interleaved)?(n.next=n,null===hn?hn=[t]:hn.push(t)):(n.next=e.next,e.next=n),t.interleaved=n):(null===(e=t.pending)?n.next=n:(n.next=e.next,e.next=n),t.pending=n)}function hr(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Pt(e,n)}}var fr={readContext:dn,useCallback:Li,useContext:Li,useEffect:Li,useImperativeHandle:Li,useInsertionEffect:Li,useLayoutEffect:Li,useMemo:Li,useReducer:Li,useRef:Li,useState:Li,useDebugValue:Li,useDeferredValue:Li,useTransition:Li,useMutableSource:Li,useSyncExternalStore:Li,useId:Li,unstable_isNewReconciler:!1},pr={readContext:dn,useCallback:function(e,t){return ki().memoizedState=[e,void 0===t?null:t],e},useContext:dn,useEffect:Ji,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ki(4194308,4,er.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ki(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ki(4,2,e,t)},useMemo:function(e,t){var n=ki();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=ki();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=or.bind(null,Ei,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},ki().memoizedState=e},useState:ji,useDebugValue:nr,useDeferredValue:function(e){var t=ji(e),n=t[0],i=t[1];return Ji(function(){var t=xi.transition;xi.transition={};try{i(e)}finally{xi.transition=t}},[e]),n},useTransition:function(){var e=ji(!1),t=e[0];return e=sr.bind(null,e[1]),ki().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=Ei,r=ki();if(Wn){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Ks)throw Error(a(349));0!==(30&Si)||zi(i,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,Ji(Vi.bind(null,i,s,e),[e]),i.flags|=2048,Yi(9,Gi.bind(null,i,s,n,t),void 0,null),n},useId:function(){var e=ki(),t=Ks.identifierPrefix;if(Wn){var n=Fn;t=":"+t+"R"+(n=(Nn&~(1<<32-bt(Nn)-1)).toString(32)+n),0<(n=Ci++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Ri++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},mr={readContext:dn,useCallback:ir,useContext:dn,useEffect:Qi,useImperativeHandle:tr,useInsertionEffect:Zi,useLayoutEffect:$i,useMemo:rr,useReducer:Fi,useRef:Xi,useState:function(){return Fi(Ni)},useDebugValue:nr,useDeferredValue:function(e){var t=Fi(Ni),n=t[0],i=t[1];return Qi(function(){var t=xi.transition;xi.transition={};try{i(e)}finally{xi.transition=t}},[e]),n},useTransition:function(){return[Fi(Ni)[0],Oi().memoizedState]},useMutableSource:Ui,useSyncExternalStore:Hi,useId:ar,unstable_isNewReconciler:!1},gr={readContext:dn,useCallback:ir,useContext:dn,useEffect:Qi,useImperativeHandle:tr,useInsertionEffect:Zi,useLayoutEffect:$i,useMemo:rr,useReducer:Bi,useRef:Xi,useState:function(){return Bi(Ni)},useDebugValue:nr,useDeferredValue:function(e){var t=Bi(Ni),n=t[0],i=t[1];return Qi(function(){var t=xi.transition;xi.transition={};try{i(e)}finally{xi.transition=t}},[e]),n},useTransition:function(){return[Bi(Ni)[0],Oi().memoizedState]},useMutableSource:Ui,useSyncExternalStore:Hi,useId:ar,unstable_isNewReconciler:!1};function vr(e,t){try{var n="",i=t;do{n+=$t(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r}}function yr(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var _r,br,xr,Sr,Er="function"===typeof WeakMap?WeakMap:Map;function wr(e,t,n){(n=gn(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){ua||(ua=!0,da=i),yr(0,t)},n}function Tr(e,t,n){(n=gn(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){yr(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){yr(0,t),"function"!==typeof i&&(null===ha?ha=new Set([this]):ha.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function Mr(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new Er;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=ja.bind(null,e,t,n),t.then(e,e))}function Ar(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function Cr(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=gn(-1,1)).tag=2,vn(n,t))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}function Rr(e){e.flags|=4}function Lr(e,t){if(null!==e&&e.child===t.child)return!0;if(0!==(16&t.flags))return!1;for(e=t.child;null!==e;){if(0!==(12854&e.flags)||0!==(12854&e.subtreeFlags))return!1;e=e.sibling}return!0}if(K)_r=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)U(e,n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},br=function(){},xr=function(e,t,n,i,r){if((e=e.memoizedProps)!==i){var s=t.stateNode,a=di(li.current);n=z(s,n,e,i,r,a),(t.updateQueue=n)&&Rr(t)}},Sr=function(e,t,n,i){n!==i&&Rr(t)};else if(q){_r=function(e,t,n,i){for(var r=t.child;null!==r;){if(5===r.tag){var s=r.stateNode;n&&i&&(s=Pe(s,r.type,r.memoizedProps,r)),U(e,s)}else if(6===r.tag)s=r.stateNode,n&&i&&(s=Ie(s,r.memoizedProps,r)),U(e,s);else if(4!==r.tag)if(22===r.tag&&null!==r.memoizedState)null!==(s=r.child)&&(s.return=r),_r(e,r,!0,!0);else if(null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};var Pr=function(e,t,n,i){for(var r=t.child;null!==r;){if(5===r.tag){var s=r.stateNode;n&&i&&(s=Pe(s,r.type,r.memoizedProps,r)),Ce(e,s)}else if(6===r.tag)s=r.stateNode,n&&i&&(s=Ie(s,r.memoizedProps,r)),Ce(e,s);else if(4!==r.tag)if(22===r.tag&&null!==r.memoizedState)null!==(s=r.child)&&(s.return=r),Pr(e,r,!0,!0);else if(null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};br=function(e,t){var n=t.stateNode;if(!Lr(e,t)){e=n.containerInfo;var i=Ae(e);Pr(i,t,!1,!1),n.pendingChildren=i,Rr(t),Re(e,i)}},xr=function(e,t,n,i,r){var s=e.stateNode,a=e.memoizedProps;if((e=Lr(e,t))&&a===i)t.stateNode=s;else{var o=t.stateNode,l=di(li.current),c=null;a!==i&&(c=z(o,n,a,i,r,l)),e&&null===c?t.stateNode=s:(s=Me(s,c,n,a,i,t,e,o),H(s,n,i,r,l)&&Rr(t),t.stateNode=s,e?Rr(t):_r(s,t,!1,!1))}},Sr=function(e,t,n,i){n!==i?(e=di(ui.current),n=di(li.current),t.stateNode=V(i,e,n,t),Rr(t)):t.stateNode=e.stateNode}}else br=function(){},xr=function(){},Sr=function(){};function Ir(e,t){if(!Wn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Dr(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function kr(e,t,n){var i=t.pendingProps;switch(zn(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dr(t),null;case 1:case 17:return pt(t.type)&&mt(),Dr(t),null;case 3:return i=t.stateNode,fi(),ot(dt),ot(ut),_i(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(Zn(t)?Rr(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==Yn&&(Aa(Yn),Yn=null))),br(e,t),Dr(t),null;case 5:mi(t),n=di(ui.current);var r=t.type;if(null!==e&&null!=t.stateNode)xr(e,t,r,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(a(166));return Dr(t),null}if(e=di(li.current),Zn(t)){if(!J)throw Error(a(175));e=Ve(t.stateNode,t.type,t.memoizedProps,n,e,t,!jn),t.updateQueue=e,null!==e&&Rr(t)}else{var s=B(r,i,n,e,t);_r(s,t,!1,!1),t.stateNode=s,H(s,r,i,n,e)&&Rr(t)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Dr(t),null;case 6:if(e&&null!=t.stateNode)Sr(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(a(166));if(e=di(ui.current),n=di(li.current),Zn(t)){if(!J)throw Error(a(176));if(e=t.stateNode,i=t.memoizedProps,(n=We(e,i,t,!jn))&&null!==(r=Gn))switch(s=0!==(1&r.mode),r.tag){case 3:Ze(r.stateNode.containerInfo,e,i,s);break;case 5:$e(r.type,r.memoizedProps,r.stateNode,e,i,s)}n&&Rr(t)}else t.stateNode=V(i,e,n,t)}return Dr(t),null;case 13:if(ot(gi),i=t.memoizedState,Wn&&null!==Vn&&0!==(1&t.mode)&&0===(128&t.flags)){for(e=Vn;e;)e=Ue(e);return $n(),t.flags|=98560,t}if(null!==i&&null!==i.dehydrated){if(i=Zn(t),null===e){if(!i)throw Error(a(318));if(!J)throw Error(a(344));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(a(317));je(e,t)}else $n(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;return Dr(t),null}return null!==Yn&&(Aa(Yn),Yn=null),0!==(128&t.flags)?(t.lanes=n,t):(i=null!==i,n=!1,null===e?Zn(t):n=null!==e.memoizedState,i&&!n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&gi.current)?0===$s&&($s=3):Oa())),null!==t.updateQueue&&(t.flags|=4),Dr(t),null);case 4:return fi(),br(e,t),null===e&&Z(t.stateNode.containerInfo),Dr(t),null;case 10:return ln(t.type._context),Dr(t),null;case 19:if(ot(gi),null===(r=t.memoizedState))return Dr(t),null;if(i=0!==(128&t.flags),null===(s=r.rendering))if(i)Ir(r,!1);else{if(0!==$s||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=vi(e))){for(t.flags|=128,Ir(r,!1),null!==(e=s.updateQueue)&&(t.updateQueue=e,t.flags|=4),t.subtreeFlags=0,e=n,i=t.child;null!==i;)r=e,(n=i).flags&=14680066,null===(s=n.alternate)?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=s.childLanes,n.lanes=s.lanes,n.child=s.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=s.memoizedProps,n.memoizedState=s.memoizedState,n.updateQueue=s.updateQueue,n.type=s.type,r=s.dependencies,n.dependencies=null===r?null:{lanes:r.lanes,firstContext:r.firstContext}),i=i.sibling;return lt(gi,1&gi.current|2),t.child}e=e.sibling}null!==r.tail&&Bt()>oa&&(t.flags|=128,i=!0,Ir(r,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=vi(s))){if(t.flags|=128,i=!0,null!==(e=e.updateQueue)&&(t.updateQueue=e,t.flags|=4),Ir(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate&&!Wn)return Dr(t),null}else 2*Bt()-r.renderingStartTime>oa&&1073741824!==n&&(t.flags|=128,i=!0,Ir(r,!1),t.lanes=4194304);r.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=r.last)?e.sibling=s:t.child=s,r.last=s)}return null!==r.tail?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=Bt(),t.sibling=null,e=gi.current,lt(gi,i?1&e|2:1&e),t):(Dr(t),null);case 22:case 23:return Pa(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Qs)&&(Dr(t),K&&6&t.subtreeFlags&&(t.flags|=8192)):Dr(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}var Or=o.ReactCurrentOwner,Nr=!1;function Fr(e,t,n,i){t.child=null===e?ai(t,null,n,i):si(t,e.child,n,i)}function Br(e,t,n,i,r){n=n.render;var s=t.ref;return un(t,r),i=Ii(e,t,n,i,s,r),n=Di(),null===e||Nr?(Wn&&n&&Hn(t),t.flags|=1,Fr(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,rs(e,t,r))}function Ur(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Za(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=eo(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Hr(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:Zt)(a,i)&&e.ref===t.ref)return rs(e,t,r)}return t.flags|=1,(e=$a(s,i)).ref=t.ref,e.return=t,t.child=e}function Hr(e,t,n,i,r){if(null!==e&&Zt(e.memoizedProps,i)&&e.ref===t.ref){if(Nr=!1,0===(e.lanes&r))return t.lanes=e.lanes,rs(e,t,r);0!==(131072&e.flags)&&(Nr=!0)}return Vr(e,t,n,i,r)}function zr(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null},lt(Zs,Qs),Qs|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null},t.updateQueue=null,lt(Zs,Qs),Qs|=e,null;t.memoizedState={baseLanes:0,cachePool:null},i=null!==s?s.baseLanes:n,lt(Zs,Qs),Qs|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,lt(Zs,Qs),Qs|=i;return Fr(e,t,r,n),t.child}function Gr(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Vr(e,t,n,i,r){var s=pt(n)?ht:ut.current;return s=ft(t,s),un(t,r),n=Ii(e,t,n,i,s,r),i=Di(),null===e||Nr?(Wn&&i&&Hn(t),t.flags|=1,Fr(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,rs(e,t,r))}function Wr(e,t,n,i,r){if(pt(n)){var s=!0;yt(t)}else s=!1;if(un(t,r),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),Mn(t,n,i),Cn(t,n,i,r),i=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=dn(c):c=ft(t,c=pt(n)?ht:ut.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==i||l!==c)&&An(t,a,i,c),fn=!1;var h=t.memoizedState;a.state=h,bn(t,i,a,r),l=t.memoizedState,o!==i||h!==l||dt.current||fn?("function"===typeof u&&(En(t,n,u,i),l=t.memoizedState),(o=fn||Tn(t,n,o,i,h,l,c))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),a.props=i,a.state=l,a.context=c,i=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),i=!1)}else{a=t.stateNode,mn(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:en(t.type,o),a.props=c,d=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=dn(l):l=ft(t,l=pt(n)?ht:ut.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==d||h!==l)&&An(t,a,i,l),fn=!1,h=t.memoizedState,a.state=h,bn(t,i,a,r);var p=t.memoizedState;o!==d||h!==p||dt.current||fn?("function"===typeof f&&(En(t,n,f,i),p=t.memoizedState),(c=fn||Tn(t,n,c,i,h,p,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(i,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(i,p,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),a.props=i,a.state=p,a.context=l,i=c):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return jr(e,t,n,i,s,r)}function jr(e,t,n,i,r,s){Gr(e,t);var a=0!==(128&t.flags);if(!i&&!a)return r&&_t(t,n,!1),rs(e,t,s);i=t.stateNode,Or.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&a?(t.child=si(t,e.child,null,s),t.child=si(t,null,o,s)):Fr(e,t,o,s),t.memoizedState=i.state,r&&_t(t,n,!0),t.child}function Yr(e){var t=e.stateNode;t.pendingContext?gt(0,t.pendingContext,t.pendingContext!==t.context):t.context&&gt(0,t.context,!1),hi(e,t.containerInfo)}function Xr(e,t,n,i,r){return $n(),ei(r),t.flags|=256,Fr(e,t,n,i),t.child}var Kr={dehydrated:null,treeContext:null,retryLane:0};function qr(e){return{baseLanes:e,cachePool:null}}function Jr(e,t,n){var i,r=t.pendingProps,s=gi.current,o=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&s)),i?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),lt(gi,1&s),null===e)return Jn(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:Fe(e)?t.lanes=8:t.lanes=1073741824,null):(s=r.children,e=r.fallback,o?(r=t.mode,o=t.child,s={mode:"hidden",children:s},0===(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=s):o=no(s,r,0,null),e=to(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=qr(n),t.memoizedState=Kr,e):Qr(t,s));if(null!==(s=e.memoizedState)){if(null!==(i=s.dehydrated)){if(l)return 256&t.flags?(t.flags&=-257,es(e,t,n,Error(a(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,s=t.mode,r=no({mode:"visible",children:r.children},s,0,null),(o=to(o,s,n,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&si(t,e.child,null,n),t.child.memoizedState=qr(n),t.memoizedState=Kr,o);if(0===(1&t.mode))t=es(e,t,n,null);else if(Fe(i))t=es(e,t,n,Error(a(419)));else if(r=0!==(n&e.childLanes),Nr||r){if(null!==(r=Ks)){switch(n&-n){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(r=0!==(o&(r.suspendedLanes|n))?0:o)&&r!==s.retryLane&&(s.retryLane=r,Sa(e,r,-1))}Oa(),t=es(e,t,n,Error(a(421)))}else Ne(i)?(t.flags|=128,t.child=e.child,t=Xa.bind(null,e),Be(i,t),t=null):(n=s.treeContext,J&&(Vn=Ge(i),Gn=t,Wn=!0,Yn=null,jn=!1,null!==n&&(Dn[kn++]=Nn,Dn[kn++]=Fn,Dn[kn++]=On,Nn=n.id,Fn=n.overflow,On=t)),(t=Qr(t,t.pendingProps.children)).flags|=4096);return t}return o?(r=$r(e,t,r.children,r.fallback,n),o=t.child,s=e.child.memoizedState,o.memoizedState=null===s?qr(n):{baseLanes:s.baseLanes|n,cachePool:null},o.childLanes=e.childLanes&~n,t.memoizedState=Kr,r):(n=Zr(e,t,r.children,n),t.memoizedState=null,n)}return o?(r=$r(e,t,r.children,r.fallback,n),o=t.child,s=e.child.memoizedState,o.memoizedState=null===s?qr(n):{baseLanes:s.baseLanes|n,cachePool:null},o.childLanes=e.childLanes&~n,t.memoizedState=Kr,r):(n=Zr(e,t,r.children,n),t.memoizedState=null,n)}function Qr(e,t){return(t=no({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Zr(e,t,n,i){var r=e.child;return e=r.sibling,n=$a(r,{mode:"visible",children:n}),0===(1&t.mode)&&(n.lanes=i),n.return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n}function $r(e,t,n,i,r){var s=t.mode,a=(e=e.child).sibling,o={mode:"hidden",children:n};return 0===(1&s)&&t.child!==e?((n=t.child).childLanes=0,n.pendingProps=o,t.deletions=null):(n=$a(e,o)).subtreeFlags=14680064&e.subtreeFlags,null!==a?i=$a(a,i):(i=to(i,s,r,null)).flags|=2,i.return=t,n.return=t,n.sibling=i,t.child=n,i}function es(e,t,n,i){return null!==i&&ei(i),si(t,e.child,null,n),(e=Qr(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ts(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),cn(e.return,t,n)}function ns(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function is(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(Fr(e,t,i.children,n),0!==(2&(i=gi.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ts(e,n,t);else if(19===e.tag)ts(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(lt(gi,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===vi(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),ns(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===vi(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}ns(t,!0,n,null,s);break;case"together":ns(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function rs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),ta|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=$a(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=$a(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function ss(e,t){switch(zn(t),t.tag){case 1:return pt(t.type)&&mt(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return fi(),ot(dt),ot(ut),_i(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return mi(t),null;case 13:if(ot(gi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));$n()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ot(gi),null;case 4:return fi(),null;case 10:return ln(t.type._context),null;case 22:case 23:return Pa(),null;default:return null}}var as=!1,os=!1,ls="function"===typeof WeakSet?WeakSet:Set,cs=null;function us(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Wa(e,t,i)}else n.current=null}function ds(e,t,n){try{n()}catch(i){Wa(e,t,i)}}var hs=!1;function fs(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&ds(t,n,s)}r=r.next}while(r!==i)}}function ps(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function ms(e){var t=e.ref;if(null!==t){var n=e.stateNode;if(5===e.tag)e=D(n);else e=n;"function"===typeof t?t(e):t.current=e}}function gs(e,t,n){if(Wt&&"function"===typeof Wt.onCommitFiberUnmount)try{Wt.onCommitFiberUnmount(Vt,t)}catch(a){}switch(t.tag){case 0:case 11:case 14:case 15:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var i=e=e.next;do{var r=i,s=r.destroy;r=r.tag,void 0!==s&&(0!==(2&r)||0!==(4&r))&&ds(t,n,s),i=i.next}while(i!==e)}break;case 1:if(us(t,n),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(a){Wa(t,n,a)}break;case 5:us(t,n);break;case 4:K?ws(e,t,n):q&&q&&(t=t.stateNode.containerInfo,n=Ae(t),Le(t,n))}}function vs(e,t,n){for(var i=t;;)if(gs(e,i,n),null===i.child||K&&4===i.tag){if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}else i.child.return=i,i=i.child}function ys(e){var t=e.alternate;null!==t&&(e.alternate=null,ys(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&ee(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function _s(e){return 5===e.tag||3===e.tag||4===e.tag}function bs(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||_s(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function xs(e){if(K){e:{for(var t=e.return;null!==t;){if(_s(t))break e;t=t.return}throw Error(a(160))}var n=t;switch(n.tag){case 5:t=n.stateNode,32&n.flags&&(be(t),n.flags&=-33),Es(e,n=bs(e),t);break;case 3:case 4:t=n.stateNode.containerInfo,Ss(e,n=bs(e),t);break;default:throw Error(a(161))}}}function Ss(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?ve(n,e,t):he(n,e);else if(4!==i&&null!==(e=e.child))for(Ss(e,t,n),e=e.sibling;null!==e;)Ss(e,t,n),e=e.sibling}function Es(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?ge(n,e,t):de(n,e);else if(4!==i&&null!==(e=e.child))for(Es(e,t,n),e=e.sibling;null!==e;)Es(e,t,n),e=e.sibling}function ws(e,t,n){for(var i,r,s=t,o=!1;;){if(!o){o=s.return;e:for(;;){if(null===o)throw Error(a(160));switch(i=o.stateNode,o.tag){case 5:r=!1;break e;case 3:case 4:i=i.containerInfo,r=!0;break e}o=o.return}o=!0}if(5===s.tag||6===s.tag)vs(e,s,n),r?_e(i,s.stateNode):ye(i,s.stateNode);else if(18===s.tag)r?Je(i,s.stateNode):qe(i,s.stateNode);else if(4===s.tag){if(null!==s.child){i=s.stateNode.containerInfo,r=!0,s.child.return=s,s=s.child;continue}}else if(gs(e,s,n),null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;4===(s=s.return).tag&&(o=!1)}s.sibling.return=s.return,s=s.sibling}}function Ts(e,t){if(K){switch(t.tag){case 0:case 11:case 14:case 15:return fs(3,t,t.return),ps(3,t),void fs(5,t,t.return);case 1:case 12:case 17:return;case 5:var n=t.stateNode;if(null!=n){var i=t.memoizedProps;e=null!==e?e.memoizedProps:i;var r=t.type,s=t.updateQueue;t.updateQueue=null,null!==s&&me(n,s,r,e,i,t)}return;case 6:if(null===t.stateNode)throw Error(a(162));return n=t.memoizedProps,void fe(t.stateNode,null!==e?e.memoizedProps:n,n);case 3:return void(J&&null!==e&&e.memoizedState.isDehydrated&&Xe(t.stateNode.containerInfo));case 13:case 19:return void Ms(t)}throw Error(a(163))}switch(t.tag){case 0:case 11:case 14:case 15:return fs(3,t,t.return),ps(3,t),void fs(5,t,t.return);case 12:case 22:case 23:return;case 13:case 19:return void Ms(t);case 3:J&&null!==e&&e.memoizedState.isDehydrated&&Xe(t.stateNode.containerInfo)}e:if(q){switch(t.tag){case 1:case 5:case 6:break e;case 3:case 4:t=t.stateNode,Le(t.containerInfo,t.pendingChildren);break e}throw Error(a(163))}}function Ms(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ls),t.forEach(function(t){var i=Ka.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))})}}function As(e,t,n){cs=e,Cs(e,t,n)}function Cs(e,t,n){for(var i=0!==(1&e.mode);null!==cs;){var r=cs,s=r.child;if(22===r.tag&&i){var a=null!==r.memoizedState||as;if(!a){var o=r.alternate,l=null!==o&&null!==o.memoizedState||os;o=as;var c=os;if(as=a,(os=l)&&!c)for(cs=r;null!==cs;)l=(a=cs).child,22===a.tag&&null!==a.memoizedState?Ps(r):null!==l?(l.return=a,cs=l):Ps(r);for(;null!==s;)cs=s,Cs(s,t,n),s=s.sibling;cs=r,as=o,os=c}Rs(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,cs=s):Rs(e)}}function Rs(e){for(;null!==cs;){var t=cs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:os||ps(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!os)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:en(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&xn(t,s,i);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:n=D(t.child.stateNode);break;case 1:n=t.child.stateNode}xn(t,o,n)}break;case 5:var l=t.stateNode;null===n&&4&t.flags&&pe(l,t.type,t.memoizedProps,t);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(J&&null===t.memoizedState){var c=t.alternate;if(null!==c){var u=c.memoizedState;if(null!==u){var d=u.dehydrated;null!==d&&Ke(d)}}}break;default:throw Error(a(163))}os||512&t.flags&&ms(t)}catch(h){Wa(t,t.return,h)}}if(t===e){cs=null;break}if(null!==(n=t.sibling)){n.return=t.return,cs=n;break}cs=t.return}}function Ls(e){for(;null!==cs;){var t=cs;if(t===e){cs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,cs=n;break}cs=t.return}}function Ps(e){for(;null!==cs;){var t=cs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ps(4,t)}catch(l){Wa(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){Wa(t,r,l)}}var s=t.return;try{ms(t)}catch(l){Wa(t,s,l)}break;case 5:var a=t.return;try{ms(t)}catch(l){Wa(t,a,l)}}}catch(l){Wa(t,t.return,l)}if(t===e){cs=null;break}var o=t.sibling;if(null!==o){o.return=t.return,cs=o;break}cs=t.return}}var Is=0,Ds=1,ks=2,Os=3,Ns=4;if("function"===typeof Symbol&&Symbol.for){var Fs=Symbol.for;Is=Fs("selector.component"),Ds=Fs("selector.has_pseudo_class"),ks=Fs("selector.role"),Os=Fs("selector.test_id"),Ns=Fs("selector.text")}function Bs(e){var t=Q(e);if(null!=t){if("string"!==typeof t.memoizedProps["data-testname"])throw Error(a(364));return t}if(null===(e=re(e)))throw Error(a(362));return e.stateNode.current}function Us(e,t){switch(t.$$typeof){case Is:if(e.type===t.value)return!0;break;case Ds:e:{t=t.value,e=[e,0];for(var n=0;n<e.length;){var i=e[n++],r=e[n++],s=t[r];if(5!==i.tag||!oe(i)){for(;null!=s&&Us(i,s);)s=t[++r];if(r===t.length){t=!0;break e}for(i=i.child;null!==i;)e.push(i,r),i=i.sibling}}t=!1}return t;case ks:if(5===e.tag&&le(e.stateNode,t.value))return!0;break;case Ns:if((5===e.tag||6===e.tag)&&(null!==(e=ae(e))&&0<=e.indexOf(t.value)))return!0;break;case Os:if(5===e.tag&&("string"===typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase()))return!0;break;default:throw Error(a(365))}return!1}function Hs(e){switch(e.$$typeof){case Is:return"<"+(E(e.value)||"Unknown")+">";case Ds:return":has("+(Hs(e)||"")+")";case ks:return'[role="'+e.value+'"]';case Ns:return'"'+e.value+'"';case Os:return'[data-testname="'+e.value+'"]';default:throw Error(a(365))}}function zs(e,t){var n=[];e=[e,0];for(var i=0;i<e.length;){var r=e[i++],s=e[i++],a=t[s];if(5!==r.tag||!oe(r)){for(;null!=a&&Us(r,a);)a=t[++s];if(s===t.length)n.push(r);else for(r=r.child;null!==r;)e.push(r,s),r=r.sibling}}return n}function Gs(e,t){if(!ie)throw Error(a(363));e=zs(e=Bs(e),t),t=[],e=Array.from(e);for(var n=0;n<e.length;){var i=e[n++];if(5===i.tag)oe(i)||t.push(i.stateNode);else for(i=i.child;null!==i;)e.push(i),i=i.sibling}return t}var Vs=Math.ceil,Ws=o.ReactCurrentDispatcher,js=o.ReactCurrentOwner,Ys=o.ReactCurrentBatchConfig,Xs=0,Ks=null,qs=null,Js=0,Qs=0,Zs=at(0),$s=0,ea=null,ta=0,na=0,ia=0,ra=null,sa=null,aa=0,oa=1/0;function la(){oa=Bt()+500}var ca,ua=!1,da=null,ha=null,fa=!1,pa=null,ma=0,ga=0,va=null,ya=-1,_a=0;function ba(){return 0!==(6&Xs)?Bt():-1!==ya?ya:ya=Bt()}function xa(e){return 0===(1&e.mode)?1:0!==(2&Xs)&&0!==Js?Js&-Js:null!==Qt.transition?(0===_a&&(e=Et,0===(4194240&(Et<<=1))&&(Et=64),_a=e),_a):0!==(e=It)?e:$()}function Sa(e,t,n){if(50<ga)throw ga=0,va=null,Error(a(185));var i=Ea(e,t);return null===i?null:(Lt(i,t,n),0!==(2&Xs)&&i===Ks||(i===Ks&&(0===(2&Xs)&&(na|=t),4===$s&&Ca(i,Js)),wa(i,n),1===t&&0===Xs&&0===(1&e.mode)&&(la(),Xt&&Jt())),i)}function Ea(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function wa(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-bt(s),o=1<<a,l=r[a];-1===l?0!==(o&n)&&0===(o&i)||(r[a]=At(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var i=Mt(e,e===Ks?Js:0);if(0===i)null!==n&&Ot(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Ot(n),1===t)0===e.tag?function(e){Xt=!0,qt(e)}(Ra.bind(null,e)):qt(Ra.bind(null,e)),te?ne(function(){0===Xs&&Jt()}):kt(Ut,Jt),n=null;else{switch(Dt(i)){case 1:n=Ut;break;case 4:n=Ht;break;case 16:default:n=zt;break;case 536870912:n=Gt}n=qa(n,Ta.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Ta(e,t){if(ya=-1,_a=0,0!==(6&Xs))throw Error(a(327));var n=e.callbackNode;if(Ga()&&e.callbackNode!==n)return null;var i=Mt(e,e===Ks?Js:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=Na(e,i);else{t=i;var r=Xs;Xs|=2;var s=ka();for(Ks===e&&Js===t||(la(),Ia(e,t));;)try{Ba();break}catch(l){Da(e,l)}an(),Ws.current=s,Xs=r,null!==qs?t=0:(Ks=null,Js=0,t=$s)}if(0!==t){if(2===t&&(0!==(r=Ct(e))&&(i=r,t=Ma(e,r))),1===t)throw n=ea,Ia(e,0),Ca(e,i),wa(e,Bt()),n;if(6===t)Ca(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!jt(s(),r))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=Na(e,i))&&(0!==(s=Ct(e))&&(i=s,t=Ma(e,s))),1===t))throw n=ea,Ia(e,0),Ca(e,i),wa(e,Bt()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(a(345));case 2:case 5:za(e,sa);break;case 3:if(Ca(e,i),(130023424&i)===i&&10<(t=aa+500-Bt())){if(0!==Mt(e,0))break;if(((r=e.suspendedLanes)&i)!==i){ba(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=W(za.bind(null,e,sa),t);break}za(e,sa);break;case 4:if(Ca(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var o=31-bt(i);s=1<<o,(o=t[o])>r&&(r=o),i&=~s}if(i=r,10<(i=(120>(i=Bt()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Vs(i/1960))-i)){e.timeoutHandle=W(za.bind(null,e,sa),i);break}za(e,sa);break;default:throw Error(a(329))}}}return wa(e,Bt()),e.callbackNode===n?Ta.bind(null,e):null}function Ma(e,t){var n=ra;return e.current.memoizedState.isDehydrated&&(Ia(e,t).flags|=256),2!==(e=Na(e,t))&&(t=sa,sa=n,null!==t&&Aa(t)),e}function Aa(e){null===sa?sa=e:sa.push.apply(sa,e)}function Ca(e,t){for(t&=~ia,t&=~na,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-bt(t),i=1<<n;e[n]=-1,t&=~i}}function Ra(e){if(0!==(6&Xs))throw Error(a(327));Ga();var t=Mt(e,0);if(0===(1&t))return wa(e,Bt()),null;var n=Na(e,t);if(0!==e.tag&&2===n){var i=Ct(e);0!==i&&(t=i,n=Ma(e,i))}if(1===n)throw n=ea,Ia(e,0),Ca(e,t),wa(e,Bt()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,za(e,sa),wa(e,Bt()),null}function La(e){null!==pa&&0===pa.tag&&0===(6&Xs)&&Ga();var t=Xs;Xs|=1;var n=Ys.transition,i=It;try{if(Ys.transition=null,It=1,e)return e()}finally{It=i,Ys.transition=n,0===(6&(Xs=t))&&Jt()}}function Pa(){Qs=Zs.current,ot(Zs)}function Ia(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==Y&&(e.timeoutHandle=Y,j(n)),null!==qs)for(n=qs.return;null!==n;){var i=n;switch(zn(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&mt();break;case 3:fi(),ot(dt),ot(ut),_i();break;case 5:mi(i);break;case 4:fi();break;case 13:case 19:ot(gi);break;case 10:ln(i.type._context);break;case 22:case 23:Pa()}n=n.return}if(Ks=e,qs=e=$a(e.current,null),Js=Qs=t,$s=0,ea=null,ia=na=ta=0,sa=ra=null,null!==hn){for(t=0;t<hn.length;t++)if(null!==(i=(n=hn[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var a=s.next;s.next=r,i.next=a}n.pending=i}hn=null}return e}function Da(e,t){for(;;){var n=qs;try{if(an(),bi.current=fr,Mi){for(var i=Ei.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}Mi=!1}if(Si=0,Ti=wi=Ei=null,Ai=!1,Ci=0,js.current=null,null===n||null===n.return){$s=1,ea=t,qs=null;break}e:{var s=e,o=n.return,l=n,c=t;if(t=Js,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=Ar(o);if(null!==p){p.flags&=-257,Cr(p,o,l,0,t),1&p.mode&&Mr(s,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){Mr(s,u,t),Oa();break e}c=Error(a(426))}else if(Wn&&1&l.mode){var v=Ar(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),Cr(v,o,l,0,t),ei(c);break e}}s=c,4!==$s&&($s=2),null===ra?ra=[s]:ra.push(s),c=vr(c,l),l=o;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t,_n(l,wr(0,c,t));break e;case 1:s=c;var y=l.type,_=l.stateNode;if(0===(128&l.flags)&&("function"===typeof y.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===ha||!ha.has(_)))){l.flags|=65536,t&=-t,l.lanes|=t,_n(l,Tr(l,s,t));break e}}l=l.return}while(null!==l)}Ha(n)}catch(b){t=b,qs===n&&null!==n&&(qs=n=n.return);continue}break}}function ka(){var e=Ws.current;return Ws.current=fr,null===e?fr:e}function Oa(){0!==$s&&3!==$s&&2!==$s||($s=4),null===Ks||0===(268435455&ta)&&0===(268435455&na)||Ca(Ks,Js)}function Na(e,t){var n=Xs;Xs|=2;var i=ka();for(Ks===e&&Js===t||Ia(e,t);;)try{Fa();break}catch(r){Da(e,r)}if(an(),Xs=n,Ws.current=i,null!==qs)throw Error(a(261));return Ks=null,Js=0,$s}function Fa(){for(;null!==qs;)Ua(qs)}function Ba(){for(;null!==qs&&!Nt();)Ua(qs)}function Ua(e){var t=ca(e.alternate,e,Qs);e.memoizedProps=e.pendingProps,null===t?Ha(e):qs=t,js.current=null}function Ha(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=kr(n,t,Qs)))return void(qs=n)}else{if(null!==(n=ss(n,t)))return n.flags&=32767,void(qs=n);if(null===e)return $s=6,void(qs=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(qs=t);qs=t=e}while(null!==t);0===$s&&($s=5)}function za(e,t){var n=It,i=Ys.transition;try{Ys.transition=null,It=1,function(e,t,n){do{Ga()}while(null!==pa);if(0!==(6&Xs))throw Error(a(327));var i=e.finishedWork,r=e.finishedLanes;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var s=i.lanes|i.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-bt(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,s),e===Ks&&(qs=Ks=null,Js=0),0===(2064&i.subtreeFlags)&&0===(2064&i.flags)||fa||(fa=!0,qa(zt,function(){return Ga(),null})),s=0!==(15990&i.flags),0!==(15990&i.subtreeFlags)||s){s=Ys.transition,Ys.transition=null;var o=It;It=1;var l=Xs;Xs|=4,js.current=null,function(e,t){for(N(e.containerInfo),cs=t;null!==cs;)if(t=(e=cs).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,cs=t;else for(;null!==cs;){e=cs;try{var n=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==n){var i=n.memoizedProps,r=n.memoizedState,s=e.stateNode,o=s.getSnapshotBeforeUpdate(e.elementType===e.type?i:en(e.type,i),r);s.__reactInternalSnapshotBeforeUpdate=o}break;case 3:K&&Te(e.stateNode.containerInfo);break;default:throw Error(a(163))}}catch(l){Wa(e,e.return,l)}if(null!==(t=e.sibling)){t.return=e.return,cs=t;break}cs=e.return}n=hs,hs=!1}(e,i),function(e,t){for(cs=t;null!==cs;){var n=(t=cs).deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var s=e;K?ws(s,r,t):vs(s,r,t);var a=r.alternate;null!==a&&(a.return=null),r.return=null}catch(x){Wa(r,t,x)}}if(n=t.child,0!==(12854&t.subtreeFlags)&&null!==n)n.return=t,cs=n;else for(;null!==cs;){t=cs;try{var o=t.flags;if(32&o&&K&&be(t.stateNode),512&o){var l=t.alternate;if(null!==l){var c=l.ref;null!==c&&("function"===typeof c?c(null):c.current=null)}}if(8192&o)switch(t.tag){case 13:if(null!==t.memoizedState){var u=t.alternate;null!==u&&null!==u.memoizedState||(aa=Bt())}break;case 22:var d=null!==t.memoizedState,h=t.alternate,f=null!==h&&null!==h.memoizedState;if(n=t,K)e:if(i=n,r=d,s=null,K)for(var p=i;;){if(5===p.tag){if(null===s){s=p;var m=p.stateNode;r?xe(m):Ee(p.stateNode,p.memoizedProps)}}else if(6===p.tag){if(null===s){var g=p.stateNode;r?Se(g):we(g,p.memoizedProps)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===i)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===i)break;for(;null===p.sibling;){if(null===p.return||p.return===i)break e;s===p&&(s=null),p=p.return}s===p&&(s=null),p.sibling.return=p.return,p=p.sibling}if(d&&!f&&0!==(1&n.mode)){cs=n;for(var v=n.child;null!==v;){for(n=cs=v;null!==cs;){var y=(i=cs).child;switch(i.tag){case 0:case 11:case 14:case 15:fs(4,i,i.return);break;case 1:us(i,i.return);var _=i.stateNode;if("function"===typeof _.componentWillUnmount){var b=i.return;try{_.props=i.memoizedProps,_.state=i.memoizedState,_.componentWillUnmount()}catch(x){Wa(i,b,x)}}break;case 5:us(i,i.return);break;case 22:if(null!==i.memoizedState){Ls(n);continue}}null!==y?(y.return=i,cs=y):Ls(n)}v=v.sibling}}}switch(4102&o){case 2:xs(t),t.flags&=-3;break;case 6:xs(t),t.flags&=-3,Ts(t.alternate,t);break;case 4096:t.flags&=-4097;break;case 4100:t.flags&=-4097,Ts(t.alternate,t);break;case 4:Ts(t.alternate,t)}}catch(x){Wa(t,t.return,x)}if(null!==(n=t.sibling)){n.return=t.return,cs=n;break}cs=t.return}}}(e,i),F(e.containerInfo),e.current=i,As(i,e,r),Ft(),Xs=l,It=o,Ys.transition=s}else e.current=i;if(fa&&(fa=!1,pa=e,ma=r),s=e.pendingLanes,0===s&&(ha=null),function(e){if(Wt&&"function"===typeof Wt.onCommitFiberRoot)try{Wt.onCommitFiberRoot(Vt,e,void 0,128===(128&e.current.flags))}catch(t){}}(i.stateNode),wa(e,Bt()),null!==t)for(n=e.onRecoverableError,i=0;i<t.length;i++)n(t[i]);if(ua)throw ua=!1,e=da,da=null,e;0!==(1&ma)&&0!==e.tag&&Ga(),s=e.pendingLanes,0!==(1&s)?e===va?ga++:(ga=0,va=e):ga=0,Jt()}(e,t,n)}finally{Ys.transition=i,It=n}return null}function Ga(){if(null!==pa){var e=Dt(ma),t=Ys.transition,n=It;try{if(Ys.transition=null,It=16>e?16:e,null===pa)var i=!1;else{if(e=pa,pa=null,ma=0,0!==(6&Xs))throw Error(a(331));var r=Xs;for(Xs|=4,cs=e.current;null!==cs;){var s=cs,o=s.child;if(0!==(16&cs.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(cs=u;null!==cs;){var d=cs;switch(d.tag){case 0:case 11:case 15:fs(8,d,s)}var h=d.child;if(null!==h)h.return=d,cs=h;else for(;null!==cs;){var f=(d=cs).sibling,p=d.return;if(ys(d),d===u){cs=null;break}if(null!==f){f.return=p,cs=f;break}cs=p}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}cs=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,cs=o;else e:for(;null!==cs;){if(0!==(2048&(s=cs).flags))switch(s.tag){case 0:case 11:case 15:fs(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,cs=y;break e}cs=s.return}}var _=e.current;for(cs=_;null!==cs;){var b=(o=cs).child;if(0!==(2064&o.subtreeFlags)&&null!==b)b.return=o,cs=b;else e:for(o=_;null!==cs;){if(0!==(2048&(l=cs).flags))try{switch(l.tag){case 0:case 11:case 15:ps(9,l)}}catch(S){Wa(l,l.return,S)}if(l===o){cs=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,cs=x;break e}cs=l.return}}if(Xs=r,Jt(),Wt&&"function"===typeof Wt.onPostCommitFiberRoot)try{Wt.onPostCommitFiberRoot(Vt,e)}catch(S){}i=!0}return i}finally{It=n,Ys.transition=t}}return!1}function Va(e,t,n){vn(e,t=wr(0,t=vr(n,t),1)),t=ba(),null!==(e=Ea(e,1))&&(Lt(e,1,t),wa(e,t))}function Wa(e,t,n){if(3===e.tag)Va(e,e,n);else for(;null!==t;){if(3===t.tag){Va(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===ha||!ha.has(i))){vn(t,e=Tr(t,e=vr(n,e),1)),e=ba(),null!==(t=Ea(t,1))&&(Lt(t,1,e),wa(t,e));break}}t=t.return}}function ja(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=ba(),e.pingedLanes|=e.suspendedLanes&n,Ks===e&&(Js&n)===n&&(4===$s||3===$s&&(130023424&Js)===Js&&500>Bt()-aa?Ia(e,0):ia|=n),wa(e,t)}function Ya(e,t){0===t&&(0===(1&e.mode)?t=1:(t=wt,0===(130023424&(wt<<=1))&&(wt=4194304)));var n=ba();null!==(e=Ea(e,t))&&(Lt(e,t,n),wa(e,n))}function Xa(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ya(e,n)}function Ka(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(a(314))}null!==i&&i.delete(t),Ya(e,n)}function qa(e,t){return kt(e,t)}function Ja(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qa(e,t,n,i){return new Ja(e,t,n,i)}function Za(e){return!(!(e=e.prototype)||!e.isReactComponent)}function $a(e,t){var n=e.alternate;return null===n?((n=Qa(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function eo(e,t,n,i,r,s){var o=2;if(i=e,"function"===typeof e)Za(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case u:return to(n.children,r,s,t);case d:o=8,r|=8;break;case h:return(e=Qa(12,n,t,2|r)).elementType=h,e.lanes=s,e;case g:return(e=Qa(13,n,t,r)).elementType=g,e.lanes=s,e;case v:return(e=Qa(19,n,t,r)).elementType=v,e.lanes=s,e;case b:return no(n,r,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case f:o=10;break e;case p:o=9;break e;case m:o=11;break e;case y:o=14;break e;case _:o=16,i=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Qa(o,n,t,r)).elementType=e,t.type=i,t.lanes=s,t}function to(e,t,n,i){return(e=Qa(7,e,i,t)).lanes=n,e}function no(e,t,n,i){return(e=Qa(22,e,i,t)).elementType=b,e.lanes=n,e.stateNode={},e}function io(e,t,n){return(e=Qa(6,e,null,t)).lanes=n,e}function ro(e,t,n){return(t=Qa(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function so(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Y,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rt(0),this.expirationTimes=Rt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rt(0),this.identifierPrefix=i,this.onRecoverableError=r,J&&(this.mutableSourceEagerHydrationData=null)}function ao(e,t,n,i,r,s,a,o,l){return e=new so(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Qa(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null},pn(s),e}function oo(e){if(!e)return ct;e:{if(T(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(pt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(pt(n))return vt(e,n,t)}return t}function lo(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return null===(e=C(t))?null:e.stateNode}function co(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function uo(e,t){co(e,t),(e=e.alternate)&&co(e,t)}function ho(e){return null===(e=C(e))?null:e.stateNode}function fo(){return null}return ca=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||dt.current)Nr=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return Nr=!1,function(e,t,n){switch(t.tag){case 3:Yr(t),$n();break;case 5:pi(t);break;case 1:pt(t.type)&&yt(t);break;case 4:hi(t,t.stateNode.containerInfo);break;case 10:on(0,t.type._context,t.memoizedProps.value);break;case 13:var i=t.memoizedState;if(null!==i)return null!==i.dehydrated?(lt(gi,1&gi.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Jr(e,t,n):(lt(gi,1&gi.current),null!==(e=rs(e,t,n))?e.sibling:null);lt(gi,1&gi.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return is(e,t,n);t.flags|=128}var r=t.memoizedState;if(null!==r&&(r.rendering=null,r.tail=null,r.lastEffect=null),lt(gi,gi.current),i)break;return null;case 22:case 23:return t.lanes=0,zr(e,t,n)}return rs(e,t,n)}(e,t,n);Nr=0!==(131072&e.flags)}else Nr=!1,Wn&&0!==(1048576&t.flags)&&Un(t,In,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var r=ft(t,ut.current);un(t,n),r=Ii(null,t,i,e,r,n);var s=Di();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,pt(i)?(s=!0,yt(t)):s=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,pn(t),r.updater=wn,t.stateNode=r,r._reactInternals=t,Cn(t,i,e,n),t=jr(null,t,i,!0,s,n)):(t.tag=0,Wn&&s&&Hn(t),Fr(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Za(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===m)return 11;if(e===y)return 14}return 2}(i),e=en(i,e),r){case 0:t=Vr(null,t,i,e,n);break e;case 1:t=Wr(null,t,i,e,n);break e;case 11:t=Br(null,t,i,e,n);break e;case 14:t=Ur(null,t,i,en(i.type,e),n);break e}throw Error(a(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Vr(e,t,i,r=t.elementType===i?r:en(i,r),n);case 1:return i=t.type,r=t.pendingProps,Wr(e,t,i,r=t.elementType===i?r:en(i,r),n);case 3:e:{if(Yr(t),null===e)throw Error(a(387));i=t.pendingProps,r=(s=t.memoizedState).element,mn(e,t),bn(t,i,null,n);var o=t.memoizedState;if(i=o.element,J&&s.isDehydrated){if(s={element:i,isDehydrated:!1,cache:o.cache,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Xr(e,t,i,n,r=Error(a(423)));break e}if(i!==r){t=Xr(e,t,i,n,r=Error(a(424)));break e}for(J&&(Vn=ze(t.stateNode.containerInfo),Gn=t,Wn=!0,Yn=null,jn=!1),n=ai(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if($n(),i===r){t=rs(e,t,n);break e}Fr(e,t,i,n)}t=t.child}return t;case 5:return pi(t),null===e&&Jn(t),i=t.type,r=t.pendingProps,s=null!==e?e.memoizedProps:null,o=r.children,G(i,r)?o=null:null!==s&&G(i,s)&&(t.flags|=32),Gr(e,t),Fr(e,t,o,n),t.child;case 6:return null===e&&Jn(t),null;case 13:return Jr(e,t,n);case 4:return hi(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=si(t,null,i,n):Fr(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,Br(e,t,i,r=t.elementType===i?r:en(i,r),n);case 7:return Fr(e,t,t.pendingProps,n),t.child;case 8:case 12:return Fr(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,s=t.memoizedProps,on(0,i,o=r.value),null!==s)if(jt(s.value,o)){if(s.children===r.children&&!dt.current){t=rs(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===s.tag){(c=gn(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),cn(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(a(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),cn(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}Fr(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,un(t,n),i=i(r=dn(r)),t.flags|=1,Fr(e,t,i,n),t.child;case 14:return r=en(i=t.type,t.pendingProps),Ur(e,t,i,r=en(i.type,r),n);case 15:return Hr(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:en(i,r),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,pt(i)?(e=!0,yt(t)):e=!1,un(t,n),Mn(t,i,r),Cn(t,i,r,n),jr(null,t,i,!0,e,n);case 19:return is(e,t,n);case 22:return zr(e,t,n)}throw Error(a(156,t.tag))},t.attemptContinuousHydration=function(e){13===e.tag&&(Sa(e,134217728,ba()),uo(e,134217728))},t.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=ba(),n=xa(e);Sa(e,n,t),uo(e,n)}},t.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Tt(t.pendingLanes);0!==n&&(Pt(t,1|n),wa(t,Bt()),0===(6&Xs)&&(la(),Jt()))}break;case 13:var i=ba();La(function(){return Sa(e,1,i)}),uo(e,1)}},t.batchedUpdates=function(e,t){var n=Xs;Xs|=1;try{return e(t)}finally{0===(Xs=n)&&(la(),Xt&&Jt())}},t.createComponentSelector=function(e){return{$$typeof:Is,value:e}},t.createContainer=function(e,t,n,i,r,s,a){return ao(e,t,!1,null,0,i,0,s,a)},t.createHasPseudoClassSelector=function(e){return{$$typeof:Ds,value:e}},t.createHydrationContainer=function(e,t,n,i,r,s,a,o,l){return(e=ao(n,i,!0,e,0,s,0,o,l)).context=oo(null),n=e.current,(s=gn(i=ba(),r=xa(n))).callback=void 0!==t&&null!==t?t:null,vn(n,s),e.current.lanes=r,Lt(e,r,i),wa(e,i),e},t.createPortal=function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:c,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}},t.createRoleSelector=function(e){return{$$typeof:ks,value:e}},t.createTestNameSelector=function(e){return{$$typeof:Os,value:e}},t.createTextSelector=function(e){return{$$typeof:Ns,value:e}},t.deferredUpdates=function(e){var t=It,n=Ys.transition;try{return Ys.transition=null,It=16,e()}finally{It=t,Ys.transition=n}},t.discreteUpdates=function(e,t,n,i,r){var s=It,a=Ys.transition;try{return Ys.transition=null,It=1,e(t,n,i,r)}finally{It=s,Ys.transition=a,0===Xs&&la()}},t.findAllNodes=Gs,t.findBoundingRects=function(e,t){if(!ie)throw Error(a(363));t=Gs(e,t),e=[];for(var n=0;n<t.length;n++)e.push(se(t[n]));for(t=e.length-1;0<t;t--)for(var i=(n=e[t]).x,r=i+n.width,s=n.y,o=s+n.height,l=t-1;0<=l;l--)if(t!==l){var c=e[l],u=c.x,d=u+c.width,h=c.y,f=h+c.height;if(i>=u&&s>=h&&r<=d&&o<=f){e.splice(t,1);break}if(!(i!==u||n.width!==c.width||f<s||h>o)){h>s&&(c.height+=h-s,c.y=s),f<o&&(c.height=o-h),e.splice(t,1);break}if(!(s!==h||n.height!==c.height||d<i||u>r)){u>i&&(c.width+=u-i,c.x=i),d<r&&(c.width=r-u),e.splice(t,1);break}}return e},t.findHostInstance=lo,t.findHostInstanceWithNoPortals=function(e){return null===(e=null!==(e=A(e))?L(e):null)?null:e.stateNode},t.findHostInstanceWithWarning=function(e){return lo(e)},t.flushControlled=function(e){var t=Xs;Xs|=1;var n=Ys.transition,i=It;try{Ys.transition=null,It=1,e()}finally{It=i,Ys.transition=n,0===(Xs=t)&&(la(),Jt())}},t.flushPassiveEffects=Ga,t.flushSync=La,t.focusWithin=function(e,t){if(!ie)throw Error(a(363));for(t=zs(e=Bs(e),t),t=Array.from(t),e=0;e<t.length;){var n=t[e++];if(!oe(n)){if(5===n.tag&&ce(n.stateNode))return!0;for(n=n.child;null!==n;)t.push(n),n=n.sibling}}return!1},t.getCurrentUpdatePriority=function(){return It},t.getFindAllNodesFailureDescription=function(e,t){if(!ie)throw Error(a(363));var n=0,i=[];e=[Bs(e),0];for(var r=0;r<e.length;){var s=e[r++],o=e[r++],l=t[o];if((5!==s.tag||!oe(s))&&(Us(s,l)&&(i.push(Hs(l)),++o>n&&(n=o)),o<t.length))for(s=s.child;null!==s;)e.push(s,o),s=s.sibling}if(n<t.length){for(e=[];n<t.length;n++)e.push(Hs(t[n]));return"findAllNodes was able to match part of the selector:\n  "+i.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},t.getPublicRootInstance=function(e){return(e=e.current).child?5===e.child.tag?D(e.child.stateNode):e.child.stateNode:null},t.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:ho,findFiberByHostInstance:e.findFiberByHostInstance||fo,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},"undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)e=!0;else{try{Vt=t.inject(e),Wt=t}catch(n){}e=!!t.checkDCE}}return e},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(e,t,n,i){if(!ie)throw Error(a(363));e=Gs(e,t);var r=ue(e,n,i).disconnect;return{disconnect:function(){r()}}},t.registerMutableSourceForHydration=function(e,t){var n=t._getVersion;n=n(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n)},t.runWithPriority=function(e,t){var n=It;try{return It=e,t()}finally{It=n}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(e,t,n,i){var r=t.current,s=ba(),a=xa(r);return n=oo(n),null===t.context?t.context=n:t.pendingContext=n,(t=gn(s,a)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),vn(r,t),null!==(e=Sa(r,a,s))&&yn(e,r,a),a},t}},929:(e,t,n)=>{"use strict";e.exports=n(643)},970:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,a=r>>>1;i<a;){var o=2*(i+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,n))c<r&&0>s(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[o]=n,i=o);else{if(!(c<r&&0>s(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function x(e){if(g=!1,b(e),!m)if(null!==i(c))m=!0,D(S);else{var t=i(u);null!==t&&k(x,t.startTime-e)}}function S(e,n){m=!1,g&&(g=!1,y(M),M=-1),p=!0;var s=f;try{for(b(n),h=i(c);null!==h&&(!(h.expirationTime>n)||e&&!R());){var a=h.callback;if("function"===typeof a){h.callback=null,f=h.priorityLevel;var o=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===i(c)&&r(c),b(n)}else r(c);h=i(c)}if(null!==h)var l=!0;else{var d=i(u);null!==d&&k(x,d.startTime-n),l=!1}return l}finally{h=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,w=!1,T=null,M=-1,A=5,C=-1;function R(){return!(t.unstable_now()-C<A)}function L(){if(null!==T){var e=t.unstable_now();C=e;var n=!0;try{n=T(!0,e)}finally{n?E():(w=!1,T=null)}}else w=!1}if("function"===typeof _)E=function(){_(L)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,I=P.port2;P.port1.onmessage=L,E=function(){I.postMessage(null)}}else E=function(){v(L,0)};function D(e){T=e,w||(w=!0,E())}function k(e,n){M=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,D(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,r,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,n(u,e),null===i(c)&&e===i(u)&&(g?(y(M),M=-1):g=!0,k(x,s-a))):(e.sortIndex=o,n(c,e),m||p||(m=!0,D(S))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(i,r){if(1&r&&(i=this(i)),8&r)return i;if("object"===typeof i&&i){if(4&r&&i.__esModule)return i;if(16&r&&"function"===typeof i.then)return i}var s=Object.create(null);n.r(s);var a={};e=e||[null,t({}),t([]),t(t)];for(var o=2&r&&i;("object"==typeof o||"function"==typeof o)&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach(e=>a[e]=()=>i[e]);return a.default=()=>i,n.d(s,a),s}})(),n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,i)=>(n.f[i](e,t),t),[])),n.u=e=>"static/js/"+e+".02b9464e.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="neimark-hostel:";n.l=(i,r,s,a)=>{if(e[i])e[i].push(r);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==i||d.getAttribute("data-webpack")==t+s){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=i),e[i]=[r];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(f);var r=e[i];if(delete e[i],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach(e=>e(n)),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,i)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var s=new Promise((n,i)=>r=e[t]=[n,i]);i.push(r[2]=s);var a=n.p+n.u(t),o=new Error;n.l(a,i=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",o.name="ChunkLoadError",o.type=s,o.request=a,r[1](o)}},"chunk-"+t,t)}};var t=(t,i)=>{var r,s,[a,o,l]=i,c=0;if(a.some(t=>0!==e[t])){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(l)l(n)}for(t&&t(i);c<a.length;c++)s=a[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},i=self.webpackChunkneimark_hostel=self.webpackChunkneimark_hostel||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{ACESFilmicToneMapping:()=>SI,AddEquation:()=>zP,AddOperation:()=>vI,AdditiveAnimationBlendMode:()=>sk,AdditiveBlending:()=>FP,AgXToneMapping:()=>wI,AlphaFormat:()=>aD,AlwaysCompare:()=>Vk,AlwaysDepth:()=>lI,AlwaysStencilFunc:()=>Ok,AmbientLight:()=>fV,AnimationAction:()=>rW,AnimationClip:()=>OG,AnimationLoader:()=>WG,AnimationMixer:()=>aW,AnimationObjectGroup:()=>iW,AnimationUtils:()=>SG,ArcCurve:()=>YH,ArrayCamera:()=>kV,ArrowHelper:()=>oj,AttachedBindMode:()=>MI,Audio:()=>GV,AudioAnalyser:()=>KV,AudioContext:()=>CV,AudioListener:()=>zV,AudioLoader:()=>RV,AxesHelper:()=>lj,BackSide:()=>DP,BasicDepthPacking:()=>ck,BasicShadowMap:()=>CP,BatchedMesh:()=>nH,Bone:()=>fU,BooleanKeyframeTrack:()=>CG,Box2:()=>EW,Box3:()=>sN,Box3Helper:()=>nj,BoxGeometry:()=>pB,BoxHelper:()=>tj,BufferAttribute:()=>FF,BufferGeometry:()=>eB,BufferGeometryLoader:()=>bV,ByteType:()=>KI,Cache:()=>FG,Camera:()=>bB,CameraHelper:()=>ZW,CanvasTexture:()=>LH,CapsuleGeometry:()=>DH,CatmullRomCurve3:()=>ZH,CineonToneMapping:()=>xI,CircleGeometry:()=>kH,ClampToEdgeWrapping:()=>OI,Clock:()=>OV,Color:()=>wF,ColorKeyframeTrack:()=>RG,ColorManagement:()=>zO,CompressedArrayTexture:()=>CH,CompressedCubeTexture:()=>RH,CompressedTexture:()=>AH,CompressedTextureLoader:()=>jG,ConeGeometry:()=>NH,ConstantAlphaFactor:()=>sI,ConstantColorFactor:()=>iI,Controls:()=>uj,CubeCamera:()=>MB,CubeReflectionMapping:()=>RI,CubeRefractionMapping:()=>LI,CubeTexture:()=>AB,CubeTextureLoader:()=>KG,CubeUVReflectionMapping:()=>DI,CubicBezierCurve:()=>nz,CubicBezierCurve3:()=>iz,CubicInterpolant:()=>wG,CullFaceBack:()=>TP,CullFaceFront:()=>MP,CullFaceFrontBack:()=>AP,CullFaceNone:()=>wP,Curve:()=>WH,CurvePath:()=>uz,CustomBlending:()=>HP,CustomToneMapping:()=>EI,CylinderGeometry:()=>OH,Cylindrical:()=>bW,Data3DTexture:()=>iN,DataArrayTexture:()=>tN,DataTexture:()=>pU,DataTextureLoader:()=>qG,DataUtils:()=>DF,DecrementStencilOp:()=>wk,DecrementWrapStencilOp:()=>Mk,DefaultLoadingManager:()=>UG,DepthFormat:()=>cD,DepthStencilFormat:()=>uD,DepthTexture:()=>PH,DetachedBindMode:()=>AI,DirectionalLight:()=>hV,DirectionalLightHelper:()=>qW,DiscreteInterpolant:()=>MG,DodecahedronGeometry:()=>BH,DoubleSide:()=>kP,DstAlphaFactor:()=>ZP,DstColorFactor:()=>eI,DynamicCopyUsage:()=>Qk,DynamicDrawUsage:()=>jk,DynamicReadUsage:()=>Kk,EdgesGeometry:()=>VH,EllipseCurve:()=>jH,EqualCompare:()=>Bk,EqualDepth:()=>dI,EqualStencilFunc:()=>Lk,EquirectangularReflectionMapping:()=>PI,EquirectangularRefractionMapping:()=>II,Euler:()=>GN,EventDispatcher:()=>_O,ExternalTexture:()=>IH,ExtrudeGeometry:()=>Vz,FileLoader:()=>VG,Float16BufferAttribute:()=>jF,Float32BufferAttribute:()=>YF,FloatType:()=>$I,Fog:()=>DB,FogExp2:()=>IB,FramebufferTexture:()=>MH,FrontSide:()=>IP,Frustum:()=>kU,FrustumArray:()=>FU,GLBufferAttribute:()=>hW,GLSL1:()=>$k,GLSL3:()=>eO,GreaterCompare:()=>Hk,GreaterDepth:()=>fI,GreaterEqualCompare:()=>Gk,GreaterEqualDepth:()=>hI,GreaterEqualStencilFunc:()=>kk,GreaterStencilFunc:()=>Ik,GridHelper:()=>WW,Group:()=>RB,HalfFloatType:()=>eD,HemisphereLight:()=>ZG,HemisphereLightHelper:()=>VW,IcosahedronGeometry:()=>jz,ImageBitmapLoader:()=>MV,ImageLoader:()=>XG,ImageUtils:()=>jO,IncrementStencilOp:()=>Ek,IncrementWrapStencilOp:()=>Tk,InstancedBufferAttribute:()=>yU,InstancedBufferGeometry:()=>_V,InstancedInterleavedBuffer:()=>dW,InstancedMesh:()=>MU,Int16BufferAttribute:()=>zF,Int32BufferAttribute:()=>VF,Int8BufferAttribute:()=>BF,IntType:()=>QI,InterleavedBuffer:()=>OB,InterleavedBufferAttribute:()=>FB,Interpolant:()=>EG,InterpolateDiscrete:()=>ZD,InterpolateLinear:()=>$D,InterpolateSmooth:()=>ek,InterpolationSamplingMode:()=>sO,InterpolationSamplingType:()=>rO,InvertStencilOp:()=>Ak,KeepStencilOp:()=>xk,KeyframeTrack:()=>AG,LOD:()=>nU,LatheGeometry:()=>Yz,Layers:()=>VN,LessCompare:()=>Fk,LessDepth:()=>cI,LessEqualCompare:()=>Uk,LessEqualDepth:()=>uI,LessEqualStencilFunc:()=>Pk,LessStencilFunc:()=>Rk,Light:()=>QG,LightProbe:()=>gV,Line:()=>dH,Line3:()=>PW,LineBasicMaterial:()=>iH,LineCurve:()=>rz,LineCurve3:()=>sz,LineDashedMaterial:()=>gG,LineLoop:()=>gH,LineSegments:()=>mH,LinearFilter:()=>GI,LinearInterpolant:()=>TG,LinearMipMapLinearFilter:()=>YI,LinearMipMapNearestFilter:()=>WI,LinearMipmapLinearFilter:()=>jI,LinearMipmapNearestFilter:()=>VI,LinearSRGBColorSpace:()=>vk,LinearToneMapping:()=>_I,LinearTransfer:()=>yk,Loader:()=>HG,LoaderUtils:()=>yV,LoadingManager:()=>BG,LoopOnce:()=>qD,LoopPingPong:()=>QD,LoopRepeat:()=>JD,MOUSE:()=>SP,Material:()=>AF,MaterialLoader:()=>vV,MathUtils:()=>LO,Matrix2:()=>xW,Matrix3:()=>NO,Matrix4:()=>IN,MaxEquation:()=>jP,Mesh:()=>hB,MeshBasicMaterial:()=>CF,MeshDepthMaterial:()=>fG,MeshDistanceMaterial:()=>pG,MeshLambertMaterial:()=>hG,MeshMatcapMaterial:()=>mG,MeshNormalMaterial:()=>dG,MeshPhongMaterial:()=>cG,MeshPhysicalMaterial:()=>lG,MeshStandardMaterial:()=>oG,MeshToonMaterial:()=>uG,MinEquation:()=>WP,MirroredRepeatWrapping:()=>NI,MixOperation:()=>gI,MultiplyBlending:()=>UP,MultiplyOperation:()=>mI,NearestFilter:()=>FI,NearestMipMapLinearFilter:()=>zI,NearestMipMapNearestFilter:()=>UI,NearestMipmapLinearFilter:()=>HI,NearestMipmapNearestFilter:()=>BI,NeutralToneMapping:()=>TI,NeverCompare:()=>Nk,NeverDepth:()=>oI,NeverStencilFunc:()=>Ck,NoBlending:()=>OP,NoColorSpace:()=>mk,NoToneMapping:()=>yI,NormalAnimationBlendMode:()=>rk,NormalBlending:()=>NP,NotEqualCompare:()=>zk,NotEqualDepth:()=>pI,NotEqualStencilFunc:()=>Dk,NumberKeyframeTrack:()=>LG,Object3D:()=>sF,ObjectLoader:()=>xV,ObjectSpaceNormalMap:()=>pk,OctahedronGeometry:()=>Xz,OneFactor:()=>XP,OneMinusConstantAlphaFactor:()=>aI,OneMinusConstantColorFactor:()=>rI,OneMinusDstAlphaFactor:()=>$P,OneMinusDstColorFactor:()=>tI,OneMinusSrcAlphaFactor:()=>QP,OneMinusSrcColorFactor:()=>qP,OrthographicCamera:()=>uV,PCFShadowMap:()=>RP,PCFSoftShadowMap:()=>LP,PMREMGenerator:()=>Nj,Path:()=>dz,PerspectiveCamera:()=>wB,Plane:()=>LU,PlaneGeometry:()=>Kz,PlaneHelper:()=>ij,PointLight:()=>cV,PointLightHelper:()=>UW,Points:()=>SH,PointsMaterial:()=>vH,PolarGridHelper:()=>jW,PolyhedronGeometry:()=>FH,PositionalAudio:()=>XV,PropertyBinding:()=>nW,PropertyMixer:()=>qV,QuadraticBezierCurve:()=>az,QuadraticBezierCurve3:()=>oz,Quaternion:()=>IO,QuaternionKeyframeTrack:()=>IG,QuaternionLinearInterpolant:()=>PG,RED_GREEN_RGTC2_Format:()=>XD,RED_RGTC1_Format:()=>jD,REVISION:()=>xP,RGBADepthPacking:()=>uk,RGBAFormat:()=>lD,RGBAIntegerFormat:()=>gD,RGBA_ASTC_10x10_Format:()=>UD,RGBA_ASTC_10x5_Format:()=>ND,RGBA_ASTC_10x6_Format:()=>FD,RGBA_ASTC_10x8_Format:()=>BD,RGBA_ASTC_12x10_Format:()=>HD,RGBA_ASTC_12x12_Format:()=>zD,RGBA_ASTC_4x4_Format:()=>CD,RGBA_ASTC_5x4_Format:()=>RD,RGBA_ASTC_5x5_Format:()=>LD,RGBA_ASTC_6x5_Format:()=>PD,RGBA_ASTC_6x6_Format:()=>ID,RGBA_ASTC_8x5_Format:()=>DD,RGBA_ASTC_8x6_Format:()=>kD,RGBA_ASTC_8x8_Format:()=>OD,RGBA_BPTC_Format:()=>GD,RGBA_ETC2_EAC_Format:()=>AD,RGBA_PVRTC_2BPPV1_Format:()=>wD,RGBA_PVRTC_4BPPV1_Format:()=>ED,RGBA_S3TC_DXT1_Format:()=>yD,RGBA_S3TC_DXT3_Format:()=>_D,RGBA_S3TC_DXT5_Format:()=>bD,RGBDepthPacking:()=>dk,RGBFormat:()=>oD,RGBIntegerFormat:()=>mD,RGB_BPTC_SIGNED_Format:()=>VD,RGB_BPTC_UNSIGNED_Format:()=>WD,RGB_ETC1_Format:()=>TD,RGB_ETC2_Format:()=>MD,RGB_PVRTC_2BPPV1_Format:()=>SD,RGB_PVRTC_4BPPV1_Format:()=>xD,RGB_S3TC_DXT1_Format:()=>vD,RGDepthPacking:()=>hk,RGFormat:()=>fD,RGIntegerFormat:()=>pD,RawShaderMaterial:()=>aG,Ray:()=>PN,Raycaster:()=>pW,RectAreaLight:()=>pV,RedFormat:()=>dD,RedIntegerFormat:()=>hD,ReinhardToneMapping:()=>bI,RenderTarget:()=>$O,RenderTarget3D:()=>oW,RepeatWrapping:()=>kI,ReplaceStencilOp:()=>Sk,ReverseSubtractEquation:()=>VP,RingGeometry:()=>qz,SIGNED_RED_GREEN_RGTC2_Format:()=>KD,SIGNED_RED_RGTC1_Format:()=>YD,SRGBColorSpace:()=>gk,SRGBTransfer:()=>_k,Scene:()=>kB,ShaderChunk:()=>mj,ShaderLib:()=>vj,ShaderMaterial:()=>_B,ShadowMaterial:()=>sG,Shape:()=>hz,ShapeGeometry:()=>Jz,ShapePath:()=>cj,ShapeUtils:()=>Hz,ShortType:()=>qI,Skeleton:()=>vU,SkeletonHelper:()=>FW,SkinnedMesh:()=>hU,Source:()=>XO,Sphere:()=>EN,SphereGeometry:()=>Qz,Spherical:()=>_W,SphericalHarmonics3:()=>mV,SplineCurve:()=>lz,SpotLight:()=>rV,SpotLightHelper:()=>DW,Sprite:()=>ZB,SpriteMaterial:()=>BB,SrcAlphaFactor:()=>JP,SrcAlphaSaturateFactor:()=>nI,SrcColorFactor:()=>KP,StaticCopyUsage:()=>Jk,StaticDrawUsage:()=>Wk,StaticReadUsage:()=>Xk,StereoCamera:()=>DV,StreamCopyUsage:()=>Zk,StreamDrawUsage:()=>Yk,StreamReadUsage:()=>qk,StringKeyframeTrack:()=>DG,SubtractEquation:()=>GP,SubtractiveBlending:()=>BP,TOUCH:()=>EP,TangentSpaceNormalMap:()=>fk,TetrahedronGeometry:()=>Zz,Texture:()=>QO,TextureLoader:()=>JG,TextureUtils:()=>hj,Timer:()=>vW,TimestampQuery:()=>iO,TorusGeometry:()=>$z,TorusKnotGeometry:()=>eG,Triangle:()=>_F,TriangleFanDrawMode:()=>lk,TriangleStripDrawMode:()=>ok,TrianglesDrawMode:()=>ak,TubeGeometry:()=>tG,UVMapping:()=>CI,Uint16BufferAttribute:()=>GF,Uint32BufferAttribute:()=>WF,Uint8BufferAttribute:()=>UF,Uint8ClampedBufferAttribute:()=>HF,Uniform:()=>lW,UniformsGroup:()=>uW,UniformsLib:()=>gj,UniformsUtils:()=>yB,UnsignedByteType:()=>XI,UnsignedInt101111Type:()=>sD,UnsignedInt248Type:()=>iD,UnsignedInt5999Type:()=>rD,UnsignedIntType:()=>ZI,UnsignedShort4444Type:()=>tD,UnsignedShort5551Type:()=>nD,UnsignedShortType:()=>JI,VSMShadowMap:()=>PP,Vector2:()=>PO,Vector3:()=>DO,Vector4:()=>ZO,VectorKeyframeTrack:()=>kG,VideoFrameTexture:()=>TH,VideoTexture:()=>wH,WebGL3DRenderTarget:()=>rN,WebGLArrayRenderTarget:()=>nN,WebGLCoordinateSystem:()=>tO,WebGLCubeRenderTarget:()=>CB,WebGLRenderTarget:()=>eN,WebGLRenderer:()=>XX,WebGLUtils:()=>BX,WebGPUCoordinateSystem:()=>nO,WebXRController:()=>PB,WireframeGeometry:()=>nG,WrapAroundEnding:()=>ik,ZeroCurvatureEnding:()=>tk,ZeroFactor:()=>YP,ZeroSlopeEnding:()=>nk,ZeroStencilOp:()=>bk,createCanvasElement:()=>uO,error:()=>vO,getConsoleFunction:()=>pO,log:()=>mO,setConsoleFunction:()=>fO,warn:()=>gO,warnOnce:()=>yO});var t=n(565),i=n.t(t,2),r=n(501);const s="AppHeader_header__nHHDe",a="AppHeader_logo__gSfYP",o="AppHeader_header_left__BYgit",l="AppHeader_header_right__aJ3xu",c="AppHeader_header_button__QY66c",u="AppHeader_navigation__-DuP-";function d(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const h="Tab_tab__FudpZ",f="Tab_tab_active__jQzHr";var p=n(929);const m=["active","title","onClick"],g=e=>{let{active:t,title:n,onClick:i}=e;d(e,m);return(0,p.jsx)("div",{className:"".concat(h," ").concat(t&&f),onClick:i,children:n})},v="Button_button__wiIYs",y="Button_button_element__highlight__O7et+",_=["active","className","type","title","onClick","defaultClassName"],b=(0,t.forwardRef)((e,t)=>{let{active:n,className:i,type:r,title:s,onClick:a,defaultClassName:o=!0}=e;d(e,_);return(0,p.jsx)("button",{ref:t,className:"".concat(o&&v," ").concat(i),type:null!==r&&void 0!==r?r:"button",onClick:e=>a(e),children:(0,p.jsx)("span",{className:"".concat(n&&y),children:s})})}),x=(0,t.createContext)(["hidden",()=>{}]),S=(0,t.createContext)(["home",()=>{}]),E=(0,t.createContext)(["home",()=>{}]);var w,T,M,A,C,R,L,P,I;const D=["title","titleId"];function k(){return k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},k.apply(null,arguments)}function O(e,n){let{title:i,titleId:r}=e,s=function(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,D);return t.createElement("svg",k({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 238 36",fill:"none",ref:n,"aria-labelledby":r},s),i?t.createElement("title",{id:r},i):null,w||(w=t.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M225.38925 20.277975H220.018V32.4H216.47225V6H220.018V17.066H225.474L233.05325 6H237.19325L228.51 18.473975L238 32.4H233.64775L225.38925 20.277975Z",fill:"#FEFEFE"})),T||(T=t.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M197.2205 9.234V19.640025H203.6885C205.7345 19.640025 207.22225 19.200025 208.11075 18.320025C208.9995 17.440025 209.454 16.14205 209.454 14.42605C209.454 12.71005 209.02 11.39005 208.1315 10.532075C207.243 9.67405 205.755 9.234 203.6885 9.234H197.2205ZM193.74875 6H205.321C210.136 6 212.8845 9.41005 212.8845 14.44805C212.8845 19.48605 210.012 22.89605 205.321 22.89605H197.2205V32.4H193.74875V6Z",fill:"#FEFEFE"})),M||(M=t.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M174.401 21.818H184.4145L180.089 7.407975H178.705L174.401 21.818ZM175.35275 6L167.43725 32.4H171.222L173.42775 25.052H185.4525L187.572 32.4H191.35675L183.44125 6H175.331H175.35275Z",fill:"#FEFEFE"})),A||(A=t.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M136.34175 6V32.4H139.98125V7.429975H140.566L147.43325 32.4H153.99725L160.821 7.429975H161.40575V32.4H165.04525V6H157.8315L151.00775 30.97H150.48775L143.64225 6H136.34175Z",fill:"#FEFEFE"})),C||(C=t.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M110.03025 6V32.4H116.99375L127.4815 7.429975H127.991V32.4H131.55775V6H124.55175L114.08525 30.97H113.597V6H110.03025Z",fill:"#FEFEFE"})),R||(R=t.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M105.24625 6H87.3065V32.4H105.24625V29.166H90.762V20.32195H102.8875V17.08795H90.762V9.211975H105.24625V6Z",fill:"#FEFEFE"})),L||(L=t.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M63.341 6H59.799V32.4H63.341V20.277975H77.78475V32.4H81.32675V6H77.78475V17.066H63.341V6Z",fill:"#FEFEFE"})),P||(P=t.createElement("path",{d:"M125.578 0H114.814V3.6H125.578V0Z",fill:"#FEFEFE"})),I||(I=t.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.150425 26.8305V11.569525H13.6692V26.8305H12.150425ZM25.8195 26.8305V11.569525H27.33825V26.8305H25.8195ZM14.69595 18.435875H24.792725V19.964125H14.69595V18.435875ZM36.42975 5.456525V8.513H39.46725V32.9435H36.42975V36H15.187975V32.9435H6.075175C2.7381 32.9435 0 30.18825 0 26.8305V8.513C0 5.15515 2.7381 2.4 6.075175 2.4H27.317V5.456525H6.075175C5.2409 5.456525 4.4922 5.800875 3.936025 6.360525C3.37985 6.920175 3.037625 7.673525 3.037625 8.513V26.8305C3.037625 27.67 3.37985 28.42325 3.936025 28.983C4.4922 29.5425 5.2409 29.887 6.075175 29.887H15.187975V32.9435H36.42975V8.513H27.317V5.456525H36.42975Z",fill:"#FD9968"})))}const N=t.forwardRef(O);n.p;function F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var U,H,z,G,V,W,j,Y,X,K,q,J={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Q={duration:.5,overwrite:!1,delay:0},Z=1e8,$=1e-8,ee=2*Math.PI,te=ee/4,ne=0,ie=Math.sqrt,re=Math.cos,se=Math.sin,ae=function(e){return"string"===typeof e},oe=function(e){return"function"===typeof e},le=function(e){return"number"===typeof e},ce=function(e){return"undefined"===typeof e},ue=function(e){return"object"===typeof e},de=function(e){return!1!==e},he=function(){return"undefined"!==typeof window},fe=function(e){return oe(e)||ae(e)},pe="function"===typeof ArrayBuffer&&ArrayBuffer.isView||function(){},me=Array.isArray,ge=/(?:-?\.?\d|\.)+/gi,ve=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,ye=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,_e=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,be=/[+-]=-?[.\d]+/,xe=/[^,'"\[\]\s]+/gi,Se=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Ee={},we={},Te=function(e){return(we=tt(e,Ee))&&ii},Me=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},Ae=function(e,t){return!t&&console.warn(e)},Ce=function(e,t){return e&&(Ee[e]=t)&&we&&(we[e]=t)||Ee},Re=function(){return 0},Le={suppressEvents:!0,isStart:!0,kill:!1},Pe={suppressEvents:!0,kill:!1},Ie={suppressEvents:!0},De={},ke=[],Oe={},Ne={},Fe={},Be=30,Ue=[],He="",ze=function(e){var t,n,i=e[0];if(ue(i)||oe(i)||(e=[e]),!(t=(i._gsap||{}).harness)){for(n=Ue.length;n--&&!Ue[n].targetTest(i););t=Ue[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new vn(e[n],t)))||e.splice(n,1);return e},Ge=function(e){return e._gsap||ze(Dt(e))[0]._gsap},Ve=function(e,t,n){return(n=e[t])&&oe(n)?e[t]():ce(n)&&e.getAttribute&&e.getAttribute(t)||n},We=function(e,t){return(e=e.split(",")).forEach(t)||e},je=function(e){return Math.round(1e5*e)/1e5||0},Ye=function(e){return Math.round(1e7*e)/1e7||0},Xe=function(e,t){var n=t.charAt(0),i=parseFloat(t.substr(2));return e=parseFloat(e),"+"===n?e+i:"-"===n?e-i:"*"===n?e*i:e/i},Ke=function(e,t){for(var n=t.length,i=0;e.indexOf(t[i])<0&&++i<n;);return i<n},qe=function(){var e,t,n=ke.length,i=ke.slice(0);for(Oe={},ke.length=0,e=0;e<n;e++)(t=i[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},Je=function(e){return!!(e._initted||e._startAt||e.add)},Qe=function(e,t,n,i){ke.length&&!H&&qe(),e.render(t,n,i||!!(H&&t<0&&Je(e))),ke.length&&!H&&qe()},Ze=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(xe).length<2?t:ae(e)?e.trim():e},$e=function(e){return e},et=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},tt=function(e,t){for(var n in t)e[n]=t[n];return e},nt=function e(t,n){for(var i in n)"__proto__"!==i&&"constructor"!==i&&"prototype"!==i&&(t[i]=ue(n[i])?e(t[i]||(t[i]={}),n[i]):n[i]);return t},it=function(e,t){var n,i={};for(n in e)n in t||(i[n]=e[n]);return i},rt=function(e){var t,n=e.parent||G,i=e.keyframes?(t=me(e.keyframes),function(e,n){for(var i in n)i in e||"duration"===i&&t||"ease"===i||(e[i]=n[i])}):et;if(de(e.inherit))for(;n;)i(e,n.vars.defaults),n=n.parent||n._dp;return e},st=function(e,t,n,i,r){void 0===n&&(n="_first"),void 0===i&&(i="_last");var s,a=e[i];if(r)for(s=t[r];a&&a[r]>s;)a=a._prev;return a?(t._next=a._next,a._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[i]=t,t._prev=a,t.parent=t._dp=e,t},at=function(e,t,n,i){void 0===n&&(n="_first"),void 0===i&&(i="_last");var r=t._prev,s=t._next;r?r._next=s:e[n]===t&&(e[n]=s),s?s._prev=r:e[i]===t&&(e[i]=r),t._next=t._prev=t.parent=null},ot=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},lt=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},ct=function(e,t,n,i){return e._startAt&&(H?e._startAt.revert(Pe):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,i))},ut=function e(t){return!t||t._ts&&e(t.parent)},dt=function(e){return e._repeat?ht(e._tTime,e=e.duration()+e._rDelay)*e:0},ht=function(e,t){var n=Math.floor(e=Ye(e/t));return e&&n===e?n-1:n},ft=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},pt=function(e){return e._end=Ye(e._start+(e._tDur/Math.abs(e._ts||e._rts||$)||0))},mt=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=Ye(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),pt(e),n._dirty||lt(n,e)),e},gt=function(e,t){var n;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(n=ft(e.rawTime(),t),(!t._dur||Ct(0,t.totalDuration(),n)-t._tTime>$)&&t.render(n,!0)),lt(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-1e-8}},vt=function(e,t,n,i){return t.parent&&ot(t),t._start=Ye((le(n)?n:n||e!==G?Tt(e,n,t):e._time)+t._delay),t._end=Ye(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),st(e,t,"_first","_last",e._sort?"_start":0),xt(t)||(e._recent=t),i||gt(e,t),e._ts<0&&mt(e,e._tTime),e},yt=function(e,t){return(Ee.ScrollTrigger||Me("scrollTrigger",t))&&Ee.ScrollTrigger.create(t,e)},_t=function(e,t,n,i,r){return Tn(e,t,r),e._initted?!n&&e._pt&&!H&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&X!==rn.frame?(ke.push(e),e._lazy=[r,i],1):void 0:1},bt=function e(t){var n=t.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||e(n))},xt=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},St=function(e,t,n,i){var r=e._repeat,s=Ye(t)||0,a=e._tTime/e._tDur;return a&&!i&&(e._time*=s/e._dur),e._dur=s,e._tDur=r?r<0?1e10:Ye(s*(r+1)+e._rDelay*r):s,a>0&&!i&&mt(e,e._tTime=e._tDur*a),e.parent&&pt(e),n||lt(e.parent,e),e},Et=function(e){return e instanceof _n?lt(e):St(e,e._dur)},wt={_start:0,endTime:Re,totalDuration:Re},Tt=function e(t,n,i){var r,s,a,o=t.labels,l=t._recent||wt,c=t.duration()>=Z?l.endTime(!1):t._dur;return ae(n)&&(isNaN(n)||n in o)?(s=n.charAt(0),a="%"===n.substr(-1),r=n.indexOf("="),"<"===s||">"===s?(r>=0&&(n=n.replace(/=/,"")),("<"===s?l._start:l.endTime(l._repeat>=0))+(parseFloat(n.substr(1))||0)*(a?(r<0?l:i).totalDuration()/100:1)):r<0?(n in o||(o[n]=c),o[n]):(s=parseFloat(n.charAt(r-1)+n.substr(r+1)),a&&i&&(s=s/100*(me(i)?i[0]:i).totalDuration()),r>1?e(t,n.substr(0,r-1),i)+s:c+s)):null==n?c:+n},Mt=function(e,t,n){var i,r,s=le(t[1]),a=(s?2:1)+(e<2?0:1),o=t[a];if(s&&(o.duration=t[1]),o.parent=n,e){for(i=o,r=n;r&&!("immediateRender"in i);)i=r.vars.defaults||{},r=de(r.vars.inherit)&&r.parent;o.immediateRender=de(i.immediateRender),e<2?o.runBackwards=1:o.startAt=t[a-1]}return new Ln(t[0],o,t[a+1])},At=function(e,t){return e||0===e?t(e):t},Ct=function(e,t,n){return n<e?e:n>t?t:n},Rt=function(e,t){return ae(e)&&(t=Se.exec(e))?t[1]:""},Lt=[].slice,Pt=function(e,t){return e&&ue(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&ue(e[0]))&&!e.nodeType&&e!==V},It=function(e,t,n){return void 0===n&&(n=[]),e.forEach(function(e){var i;return ae(e)&&!t||Pt(e,1)?(i=n).push.apply(i,Dt(e)):n.push(e)})||n},Dt=function(e,t,n){return z&&!t&&z.selector?z.selector(e):!ae(e)||n||!W&&sn()?me(e)?It(e,n):Pt(e)?Lt.call(e,0):e?[e]:[]:Lt.call((t||j).querySelectorAll(e),0)},kt=function(e){return e=Dt(e)[0]||Ae("Invalid scope")||{},function(t){var n=e.current||e.nativeElement||e;return Dt(t,n.querySelectorAll?n:n===e?Ae("Invalid scope")||j.createElement("div"):e)}},Ot=function(e){return e.sort(function(){return.5-Math.random()})},Nt=function(e){if(oe(e))return e;var t=ue(e)?e:{each:e},n=hn(t.ease),i=t.from||0,r=parseFloat(t.base)||0,s={},a=i>0&&i<1,o=isNaN(i)||a,l=t.axis,c=i,u=i;return ae(i)?c=u={center:.5,edges:.5,end:1}[i]||0:!a&&o&&(c=i[0],u=i[1]),function(e,a,d){var h,f,p,m,g,v,y,_,b,x=(d||t).length,S=s[x];if(!S){if(!(b="auto"===t.grid?0:(t.grid||[1,Z])[1])){for(y=-Z;y<(y=d[b++].getBoundingClientRect().left)&&b<x;);b<x&&b--}for(S=s[x]=[],h=o?Math.min(b,x)*c-.5:i%b,f=b===Z?0:o?x*u/b-.5:i/b|0,y=0,_=Z,v=0;v<x;v++)p=v%b-h,m=f-(v/b|0),S[v]=g=l?Math.abs("y"===l?m:p):ie(p*p+m*m),g>y&&(y=g),g<_&&(_=g);"random"===i&&Ot(S),S.max=y-_,S.min=_,S.v=x=(parseFloat(t.amount)||parseFloat(t.each)*(b>x?x-1:l?"y"===l?x/b:b:Math.max(b,x/b))||0)*("edges"===i?-1:1),S.b=x<0?r-x:r,S.u=Rt(t.amount||t.each)||0,n=n&&x<0?un(n):n}return x=(S[e]-S.min)/S.max||0,Ye(S.b+(n?n(x):x)*S.v)+S.u}},Ft=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var i=Ye(Math.round(parseFloat(n)/e)*e*t);return(i-i%1)/t+(le(n)?0:Rt(n))}},Bt=function(e,t){var n,i,r=me(e);return!r&&ue(e)&&(n=r=e.radius||Z,e.values?(e=Dt(e.values),(i=!le(e[0]))&&(n*=n)):e=Ft(e.increment)),At(t,r?oe(e)?function(t){return i=e(t),Math.abs(i-t)<=n?i:t}:function(t){for(var r,s,a=parseFloat(i?t.x:t),o=parseFloat(i?t.y:0),l=Z,c=0,u=e.length;u--;)(r=i?(r=e[u].x-a)*r+(s=e[u].y-o)*s:Math.abs(e[u]-a))<l&&(l=r,c=u);return c=!n||l<=n?e[c]:t,i||c===t||le(t)?c:c+Rt(t)}:Ft(e))},Ut=function(e,t,n,i){return At(me(e)?!t:!0===n?!!(n=0):!i,function(){return me(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(i=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+.99*n))/n)*n*i)/i})},Ht=function(e,t,n){return At(n,function(n){return e[~~t(n)]})},zt=function(e){for(var t,n,i,r,s=0,a="";~(t=e.indexOf("random(",s));)i=e.indexOf(")",t),r="["===e.charAt(t+7),n=e.substr(t+7,i-t-7).match(r?xe:ge),a+=e.substr(s,t-s)+Ut(r?n:+n[0],r?0:+n[1],+n[2]||1e-5),s=i+1;return a+e.substr(s,e.length-s)},Gt=function(e,t,n,i,r){var s=t-e,a=i-n;return At(r,function(t){return n+((t-e)/s*a||0)})},Vt=function(e,t,n){var i,r,s,a=e.labels,o=Z;for(i in a)(r=a[i]-t)<0===!!n&&r&&o>(r=Math.abs(r))&&(s=i,o=r);return s},Wt=function(e,t,n){var i,r,s,a=e.vars,o=a[t],l=z,c=e._ctx;if(o)return i=a[t+"Params"],r=a.callbackScope||e,n&&ke.length&&qe(),c&&(z=c),s=i?o.apply(r,i):o.call(r),z=l,s},jt=function(e){return ot(e),e.scrollTrigger&&e.scrollTrigger.kill(!!H),e.progress()<1&&Wt(e,"onInterrupt"),e},Yt=[],Xt=function(e){if(e)if(e=!e.name&&e.default||e,he()||e.headless){var t=e.name,n=oe(e),i=t&&!n&&e.init?function(){this._props=[]}:e,r={init:Re,render:Un,add:En,kill:zn,modifier:Hn,rawVars:0},s={targetTest:0,get:0,getSetter:On,aliases:{},register:0};if(sn(),e!==i){if(Ne[t])return;et(i,et(it(e,r),s)),tt(i.prototype,tt(r,it(e,s))),Ne[i.prop=t]=i,e.targetTest&&(Ue.push(i),De[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}Ce(t,i),e.register&&e.register(ii,i,Wn)}else Yt.push(e)},Kt=255,qt={aqua:[0,Kt,Kt],lime:[0,Kt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Kt],navy:[0,0,128],white:[Kt,Kt,Kt],olive:[128,128,0],yellow:[Kt,Kt,0],orange:[Kt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Kt,0,0],pink:[Kt,192,203],cyan:[0,Kt,Kt],transparent:[Kt,Kt,Kt,0]},Jt=function(e,t,n){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(n-t)*e*6:e<.5?n:3*e<2?t+(n-t)*(2/3-e)*6:t)*Kt+.5|0},Qt=function(e,t,n){var i,r,s,a,o,l,c,u,d,h,f=e?le(e)?[e>>16,e>>8&Kt,e&Kt]:0:qt.black;if(!f){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),qt[e])f=qt[e];else if("#"===e.charAt(0)){if(e.length<6&&(i=e.charAt(1),r=e.charAt(2),s=e.charAt(3),e="#"+i+i+r+r+s+s+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(f=parseInt(e.substr(1,6),16))>>16,f>>8&Kt,f&Kt,parseInt(e.substr(7),16)/255];f=[(e=parseInt(e.substr(1),16))>>16,e>>8&Kt,e&Kt]}else if("hsl"===e.substr(0,3))if(f=h=e.match(ge),t){if(~e.indexOf("="))return f=e.match(ve),n&&f.length<4&&(f[3]=1),f}else a=+f[0]%360/360,o=+f[1]/100,i=2*(l=+f[2]/100)-(r=l<=.5?l*(o+1):l+o-l*o),f.length>3&&(f[3]*=1),f[0]=Jt(a+1/3,i,r),f[1]=Jt(a,i,r),f[2]=Jt(a-1/3,i,r);else f=e.match(ge)||qt.transparent;f=f.map(Number)}return t&&!h&&(i=f[0]/Kt,r=f[1]/Kt,s=f[2]/Kt,l=((c=Math.max(i,r,s))+(u=Math.min(i,r,s)))/2,c===u?a=o=0:(d=c-u,o=l>.5?d/(2-c-u):d/(c+u),a=c===i?(r-s)/d+(r<s?6:0):c===r?(s-i)/d+2:(i-r)/d+4,a*=60),f[0]=~~(a+.5),f[1]=~~(100*o+.5),f[2]=~~(100*l+.5)),n&&f.length<4&&(f[3]=1),f},Zt=function(e){var t=[],n=[],i=-1;return e.split(en).forEach(function(e){var r=e.match(ye)||[];t.push.apply(t,r),n.push(i+=r.length+1)}),t.c=n,t},$t=function(e,t,n){var i,r,s,a,o="",l=(e+o).match(en),c=t?"hsla(":"rgba(",u=0;if(!l)return e;if(l=l.map(function(e){return(e=Qt(e,t,1))&&c+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"}),n&&(s=Zt(e),(i=n.c).join(o)!==s.c.join(o)))for(a=(r=e.replace(en,"1").split(ye)).length-1;u<a;u++)o+=r[u]+(~i.indexOf(u)?l.shift()||c+"0,0,0,0)":(s.length?s:l.length?l:n).shift());if(!r)for(a=(r=e.split(en)).length-1;u<a;u++)o+=r[u]+l[u];return o+r[a]},en=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in qt)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),tn=/hsl[a]?\(/,nn=function(e){var t,n=e.join(" ");if(en.lastIndex=0,en.test(n))return t=tn.test(n),e[1]=$t(e[1],t),e[0]=$t(e[0],t,Zt(e[1])),!0},rn=function(){var e,t,n,i,r,s,a=Date.now,o=500,l=33,c=a(),u=c,d=1e3/240,h=d,f=[],p=function n(p){var m,g,v,y,_=a()-u,b=!0===p;if((_>o||_<0)&&(c+=_-l),((m=(v=(u+=_)-c)-h)>0||b)&&(y=++i.frame,r=v-1e3*i.time,i.time=v/=1e3,h+=m+(m>=d?4:d-m),g=1),b||(e=t(n)),g)for(s=0;s<f.length;s++)f[s](v,r,y,p)};return i={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(e){return r/(1e3/(e||60))},wake:function(){Y&&(!W&&he()&&(V=W=window,j=V.document||{},Ee.gsap=ii,(V.gsapVersions||(V.gsapVersions=[])).push(ii.version),Te(we||V.GreenSockGlobals||!V.gsap&&V||{}),Yt.forEach(Xt)),n="undefined"!==typeof requestAnimationFrame&&requestAnimationFrame,e&&i.sleep(),t=n||function(e){return setTimeout(e,h-1e3*i.time+1|0)},q=1,p(2))},sleep:function(){(n?cancelAnimationFrame:clearTimeout)(e),q=0,t=Re},lagSmoothing:function(e,t){o=e||1/0,l=Math.min(t||33,o)},fps:function(e){d=1e3/(e||240),h=1e3*i.time+d},add:function(e,t,n){var r=t?function(t,n,s,a){e(t,n,s,a),i.remove(r)}:e;return i.remove(e),f[n?"unshift":"push"](r),sn(),r},remove:function(e,t){~(t=f.indexOf(e))&&f.splice(t,1)&&s>=t&&s--},_listeners:f},i}(),sn=function(){return!q&&rn.wake()},an={},on=/^[\d.\-M][\d.\-,\s]/,ln=/["']/g,cn=function(e){for(var t,n,i,r={},s=e.substr(1,e.length-3).split(":"),a=s[0],o=1,l=s.length;o<l;o++)n=s[o],t=o!==l-1?n.lastIndexOf(","):n.length,i=n.substr(0,t),r[a]=isNaN(i)?i.replace(ln,"").trim():+i,a=n.substr(t+1).trim();return r},un=function(e){return function(t){return 1-e(1-t)}},dn=function e(t,n){for(var i,r=t._first;r;)r instanceof _n?e(r,n):!r.vars.yoyoEase||r._yoyo&&r._repeat||r._yoyo===n||(r.timeline?e(r.timeline,n):(i=r._ease,r._ease=r._yEase,r._yEase=i,r._yoyo=n)),r=r._next},hn=function(e,t){return e&&(oe(e)?e:an[e]||function(e){var t=(e+"").split("("),n=an[t[0]];return n&&t.length>1&&n.config?n.config.apply(null,~e.indexOf("{")?[cn(t[1])]:function(e){var t=e.indexOf("(")+1,n=e.indexOf(")"),i=e.indexOf("(",t);return e.substring(t,~i&&i<n?e.indexOf(")",n+1):n)}(e).split(",").map(Ze)):an._CE&&on.test(e)?an._CE("",e):n}(e))||t},fn=function(e,t,n,i){void 0===n&&(n=function(e){return 1-t(1-e)}),void 0===i&&(i=function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2});var r,s={easeIn:t,easeOut:n,easeInOut:i};return We(e,function(e){for(var t in an[e]=Ee[e]=s,an[r=e.toLowerCase()]=n,s)an[r+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=an[e+"."+t]=s[t]}),s},pn=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},mn=function e(t,n,i){var r=n>=1?n:1,s=(i||(t?.3:.45))/(n<1?n:1),a=s/ee*(Math.asin(1/r)||0),o=function(e){return 1===e?1:r*Math.pow(2,-10*e)*se((e-a)*s)+1},l="out"===t?o:"in"===t?function(e){return 1-o(1-e)}:pn(o);return s=ee/s,l.config=function(n,i){return e(t,n,i)},l},gn=function e(t,n){void 0===n&&(n=1.70158);var i=function(e){return e?--e*e*((n+1)*e+n)+1:0},r="out"===t?i:"in"===t?function(e){return 1-i(1-e)}:pn(i);return r.config=function(n){return e(t,n)},r};We("Linear,Quad,Cubic,Quart,Quint,Strong",function(e,t){var n=t<5?t+1:t;fn(e+",Power"+(n-1),t?function(e){return Math.pow(e,n)}:function(e){return e},function(e){return 1-Math.pow(1-e,n)},function(e){return e<.5?Math.pow(2*e,n)/2:1-Math.pow(2*(1-e),n)/2})}),an.Linear.easeNone=an.none=an.Linear.easeIn,fn("Elastic",mn("in"),mn("out"),mn()),function(e,t){var n=1/t,i=2*n,r=2.5*n,s=function(s){return s<n?e*s*s:s<i?e*Math.pow(s-1.5/t,2)+.75:s<r?e*(s-=2.25/t)*s+.9375:e*Math.pow(s-2.625/t,2)+.984375};fn("Bounce",function(e){return 1-s(1-e)},s)}(7.5625,2.75),fn("Expo",function(e){return Math.pow(2,10*(e-1))*e+e*e*e*e*e*e*(1-e)}),fn("Circ",function(e){return-(ie(1-e*e)-1)}),fn("Sine",function(e){return 1===e?1:1-re(e*te)}),fn("Back",gn("in"),gn("out"),gn()),an.SteppedEase=an.steps=Ee.SteppedEase={config:function(e,t){void 0===e&&(e=1);var n=1/e,i=e+(t?0:1),r=t?1:0;return function(e){return((i*Ct(0,.99999999,e)|0)+r)*n}}},Q.ease=an["quad.out"],We("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(e){return He+=e+","+e+"Params,"});var vn=function(e,t){this.id=ne++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:Ve,this.set=t?t.getSetter:On},yn=function(){function e(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,St(this,+e.duration,1,1),this.data=e.data,z&&(this._ctx=z,z.data.push(this)),q||rn.wake()}var t=e.prototype;return t.delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,St(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(sn(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(mt(this,e),!n._dp||n.parent||gt(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&vt(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===$||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),Qe(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+dt(this))%(this._dur+this._rDelay)||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+dt(this),t):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},t.iteration=function(e,t){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*n,t):this._repeat?ht(this._tTime,n)+1:1},t.timeScale=function(e,t){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===e)return this;var n=this.parent&&this._ts?ft(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||-1e-8===e?0:this._rts,this.totalTime(Ct(-Math.abs(this._delay),this.totalDuration(),n),!1!==t),pt(this),function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e}(this)},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(sn(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==$&&(this._tTime-=$)))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=e;var t=this.parent||this._dp;return t&&(t._sort||!this.parent)&&vt(t,this,e-this._delay),this}return this._start},t.endTime=function(e){return this._start+(de(e)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?ft(t.rawTime(e),this):this._tTime:this._tTime},t.revert=function(e){void 0===e&&(e=Ie);var t=H;return H=e,Je(this)&&(this.timeline&&this.timeline.revert(e),this.totalTime(-.01,e.suppressEvents)),"nested"!==this.data&&!1!==e.kill&&this.kill(),H=t,this},t.globalTime=function(e){for(var t=this,n=arguments.length?e:t.rawTime();t;)n=t._start+n/(Math.abs(t._ts)||1),t=t._dp;return!this.parent&&this._sat?this._sat.globalTime(e):n},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,Et(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){if(arguments.length){var t=this._time;return this._rDelay=e,Et(this),t?this.time(t):this}return this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(Tt(this,e),de(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,de(t)),this._dur||(this._zTime=-1e-8),this},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-1e-8:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},t.isActive=function(){var e,t=this.parent||this._dp,n=this._start;return!(t&&!(this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=n&&e<this.endTime(!0)-$))},t.eventCallback=function(e,t,n){var i=this.vars;return arguments.length>1?(t?(i[e]=t,n&&(i[e+"Params"]=n),"onUpdate"===e&&(this._onUpdate=t)):delete i[e],this):i[e]},t.then=function(e){var t=this;return new Promise(function(n){var i=oe(e)?e:$e,r=function(){var e=t.then;t.then=null,oe(i)&&(i=i(t))&&(i.then||i===t)&&(t.then=e),n(i),t.then=e};t._initted&&1===t.totalProgress()&&t._ts>=0||!t._tTime&&t._ts<0?r():t._prom=r})},t.kill=function(){jt(this)},e}();et(yn.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var _n=function(e){function t(t,n){var i;return void 0===t&&(t={}),(i=e.call(this,t)||this).labels={},i.smoothChildTiming=!!t.smoothChildTiming,i.autoRemoveChildren=!!t.autoRemoveChildren,i._sort=de(t.sortChildren),G&&vt(t.parent||G,F(i),n),t.reversed&&i.reverse(),t.paused&&i.paused(!0),t.scrollTrigger&&yt(F(i),t.scrollTrigger),i}B(t,e);var n=t.prototype;return n.to=function(e,t,n){return Mt(0,arguments,this),this},n.from=function(e,t,n){return Mt(1,arguments,this),this},n.fromTo=function(e,t,n,i){return Mt(2,arguments,this),this},n.set=function(e,t,n){return t.duration=0,t.parent=this,rt(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new Ln(e,t,Tt(this,n),1),this},n.call=function(e,t,n){return vt(this,Ln.delayedCall(0,e,t),n)},n.staggerTo=function(e,t,n,i,r,s,a){return n.duration=t,n.stagger=n.stagger||i,n.onComplete=s,n.onCompleteParams=a,n.parent=this,new Ln(e,n,Tt(this,r)),this},n.staggerFrom=function(e,t,n,i,r,s,a){return n.runBackwards=1,rt(n).immediateRender=de(n.immediateRender),this.staggerTo(e,t,n,i,r,s,a)},n.staggerFromTo=function(e,t,n,i,r,s,a,o){return i.startAt=n,rt(i).immediateRender=de(i.immediateRender),this.staggerTo(e,t,i,r,s,a,o)},n.render=function(e,t,n){var i,r,s,a,o,l,c,u,d,h,f,p,m=this._time,g=this._dirty?this.totalDuration():this._tDur,v=this._dur,y=e<=0?0:Ye(e),_=this._zTime<0!==e<0&&(this._initted||!v);if(this!==G&&y>g&&e>=0&&(y=g),y!==this._tTime||n||_){if(m!==this._time&&v&&(y+=this._time-m,e+=this._time-m),i=y,d=this._start,l=!(u=this._ts),_&&(v||(m=this._zTime),(e||!t)&&(this._zTime=e)),this._repeat){if(f=this._yoyo,o=v+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*o+e,t,n);if(i=Ye(y%o),y===g?(a=this._repeat,i=v):((a=~~(h=Ye(y/o)))&&a===h&&(i=v,a--),i>v&&(i=v)),h=ht(this._tTime,o),!m&&this._tTime&&h!==a&&this._tTime-h*o-this._dur<=0&&(h=a),f&&1&a&&(i=v-i,p=1),a!==h&&!this._lock){var b=f&&1&h,x=b===(f&&1&a);if(a<h&&(b=!b),m=b?0:y%v?v:y,this._lock=1,this.render(m||(p?0:Ye(a*o)),t,!v)._lock=0,this._tTime=y,!t&&this.parent&&Wt(this,"onRepeat"),this.vars.repeatRefresh&&!p&&(this.invalidate()._lock=1),m&&m!==this._time||l!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(v=this._dur,g=this._tDur,x&&(this._lock=2,m=b?v:-1e-4,this.render(m,!0),this.vars.repeatRefresh&&!p&&this.invalidate()),this._lock=0,!this._ts&&!l)return this;dn(this,p)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(c=function(e,t,n){var i;if(n>t)for(i=e._first;i&&i._start<=n;){if("isPause"===i.data&&i._start>t)return i;i=i._next}else for(i=e._last;i&&i._start>=n;){if("isPause"===i.data&&i._start<t)return i;i=i._prev}}(this,Ye(m),Ye(i)),c&&(y-=i-(i=c._start))),this._tTime=y,this._time=i,this._act=!u,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,m=0),!m&&y&&!t&&!h&&(Wt(this,"onStart"),this._tTime!==y))return this;if(i>=m&&e>=0)for(r=this._first;r;){if(s=r._next,(r._act||i>=r._start)&&r._ts&&c!==r){if(r.parent!==this)return this.render(e,t,n);if(r.render(r._ts>0?(i-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(i-r._start)*r._ts,t,n),i!==this._time||!this._ts&&!l){c=0,s&&(y+=this._zTime=-1e-8);break}}r=s}else{r=this._last;for(var S=e<0?e:i;r;){if(s=r._prev,(r._act||S<=r._end)&&r._ts&&c!==r){if(r.parent!==this)return this.render(e,t,n);if(r.render(r._ts>0?(S-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(S-r._start)*r._ts,t,n||H&&Je(r)),i!==this._time||!this._ts&&!l){c=0,s&&(y+=this._zTime=S?-1e-8:$);break}}r=s}}if(c&&!t&&(this.pause(),c.render(i>=m?0:-1e-8)._zTime=i>=m?1:-1,this._ts))return this._start=d,pt(this),this.render(e,t,n);this._onUpdate&&!t&&Wt(this,"onUpdate",!0),(y===g&&this._tTime>=this.totalDuration()||!y&&m)&&(d!==this._start&&Math.abs(u)===Math.abs(this._ts)||this._lock||((e||!v)&&(y===g&&this._ts>0||!y&&this._ts<0)&&ot(this,1),t||e<0&&!m||!y&&!m&&g||(Wt(this,y===g&&e>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(y<g&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(e,t){var n=this;if(le(t)||(t=Tt(this,t,e)),!(e instanceof yn)){if(me(e))return e.forEach(function(e){return n.add(e,t)}),this;if(ae(e))return this.addLabel(e,t);if(!oe(e))return this;e=Ln.delayedCall(0,e)}return this!==e?vt(this,e,t):this},n.getChildren=function(e,t,n,i){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===i&&(i=-Z);for(var r=[],s=this._first;s;)s._start>=i&&(s instanceof Ln?t&&r.push(s):(n&&r.push(s),e&&r.push.apply(r,s.getChildren(!0,t,n)))),s=s._next;return r},n.getById=function(e){for(var t=this.getChildren(1,1,1),n=t.length;n--;)if(t[n].vars.id===e)return t[n]},n.remove=function(e){return ae(e)?this.removeLabel(e):oe(e)?this.killTweensOf(e):(e.parent===this&&at(this,e),e===this._recent&&(this._recent=this._last),lt(this))},n.totalTime=function(t,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Ye(rn.time-(this._ts>0?t/this._ts:(this.totalDuration()-t)/-this._ts))),e.prototype.totalTime.call(this,t,n),this._forcing=0,this):this._tTime},n.addLabel=function(e,t){return this.labels[e]=Tt(this,t),this},n.removeLabel=function(e){return delete this.labels[e],this},n.addPause=function(e,t,n){var i=Ln.delayedCall(0,t||Re,n);return i.data="isPause",this._hasPause=1,vt(this,i,Tt(this,e))},n.removePause=function(e){var t=this._first;for(e=Tt(this,e);t;)t._start===e&&"isPause"===t.data&&ot(t),t=t._next},n.killTweensOf=function(e,t,n){for(var i=this.getTweensOf(e,n),r=i.length;r--;)bn!==i[r]&&i[r].kill(e,t);return this},n.getTweensOf=function(e,t){for(var n,i=[],r=Dt(e),s=this._first,a=le(t);s;)s instanceof Ln?Ke(s._targets,r)&&(a?(!bn||s._initted&&s._ts)&&s.globalTime(0)<=t&&s.globalTime(s.totalDuration())>t:!t||s.isActive())&&i.push(s):(n=s.getTweensOf(r,t)).length&&i.push.apply(i,n),s=s._next;return i},n.tweenTo=function(e,t){t=t||{};var n,i=this,r=Tt(i,e),s=t,a=s.startAt,o=s.onStart,l=s.onStartParams,c=s.immediateRender,u=Ln.to(i,et({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:t.duration||Math.abs((r-(a&&"time"in a?a.time:i._time))/i.timeScale())||$,onStart:function(){if(i.pause(),!n){var e=t.duration||Math.abs((r-(a&&"time"in a?a.time:i._time))/i.timeScale());u._dur!==e&&St(u,e,0,1).render(u._time,!0,!0),n=1}o&&o.apply(u,l||[])}},t));return c?u.render(0):u},n.tweenFromTo=function(e,t,n){return this.tweenTo(t,et({startAt:{time:Tt(this,e)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(e){return void 0===e&&(e=this._time),Vt(this,Tt(this,e))},n.previousLabel=function(e){return void 0===e&&(e=this._time),Vt(this,Tt(this,e),1)},n.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+$)},n.shiftChildren=function(e,t,n){void 0===n&&(n=0);for(var i,r=this._first,s=this.labels;r;)r._start>=n&&(r._start+=e,r._end+=e),r=r._next;if(t)for(i in s)s[i]>=n&&(s[i]+=e);return lt(this)},n.invalidate=function(t){var n=this._first;for(this._lock=0;n;)n.invalidate(t),n=n._next;return e.prototype.invalidate.call(this,t)},n.clear=function(e){void 0===e&&(e=!0);for(var t,n=this._first;n;)t=n._next,this.remove(n),n=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),lt(this)},n.totalDuration=function(e){var t,n,i,r=0,s=this,a=s._last,o=Z;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-e:e));if(s._dirty){for(i=s.parent;a;)t=a._prev,a._dirty&&a.totalDuration(),(n=a._start)>o&&s._sort&&a._ts&&!s._lock?(s._lock=1,vt(s,a,n-a._delay,1)._lock=0):o=n,n<0&&a._ts&&(r-=n,(!i&&!s._dp||i&&i.smoothChildTiming)&&(s._start+=n/s._ts,s._time-=n,s._tTime-=n),s.shiftChildren(-n,!1,-Infinity),o=0),a._end>r&&a._ts&&(r=a._end),a=t;St(s,s===G&&s._time>r?s._time:r,1,1),s._dirty=0}return s._tDur},t.updateRoot=function(e){if(G._ts&&(Qe(G,ft(e,G)),X=rn.frame),rn.frame>=Be){Be+=J.autoSleep||120;var t=G._first;if((!t||!t._ts)&&J.autoSleep&&rn._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||rn.sleep()}}},t}(yn);et(_n.prototype,{_lock:0,_hasPause:0,_forcing:0});var bn,xn,Sn=function(e,t,n,i,r,s,a){var o,l,c,u,d,h,f,p,m=new Wn(this._pt,e,t,0,1,Bn,null,r),g=0,v=0;for(m.b=n,m.e=i,n+="",(f=~(i+="").indexOf("random("))&&(i=zt(i)),s&&(s(p=[n,i],e,t),n=p[0],i=p[1]),l=n.match(_e)||[];o=_e.exec(i);)u=o[0],d=i.substring(g,o.index),c?c=(c+1)%5:"rgba("===d.substr(-5)&&(c=1),u!==l[v++]&&(h=parseFloat(l[v-1])||0,m._pt={_next:m._pt,p:d||1===v?d:",",s:h,c:"="===u.charAt(1)?Xe(h,u)-h:parseFloat(u)-h,m:c&&c<4?Math.round:0},g=_e.lastIndex);return m.c=g<i.length?i.substring(g,i.length):"",m.fp=a,(be.test(i)||f)&&(m.e=0),this._pt=m,m},En=function(e,t,n,i,r,s,a,o,l,c){oe(i)&&(i=i(r||0,e,s));var u,d=e[t],h="get"!==n?n:oe(d)?l?e[t.indexOf("set")||!oe(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():d,f=oe(d)?l?Dn:In:Pn;if(ae(i)&&(~i.indexOf("random(")&&(i=zt(i)),"="===i.charAt(1)&&((u=Xe(h,i)+(Rt(h)||0))||0===u)&&(i=u)),!c||h!==i||xn)return isNaN(h*i)||""===i?(!d&&!(t in e)&&Me(t,i),Sn.call(this,e,t,h,i,f,o||J.stringFilter,l)):(u=new Wn(this._pt,e,t,+h||0,i-(h||0),"boolean"===typeof d?Fn:Nn,0,f),l&&(u.fp=l),a&&u.modifier(a,this,e),this._pt=u)},wn=function(e,t,n,i,r,s){var a,o,l,c;if(Ne[e]&&!1!==(a=new Ne[e]).init(r,a.rawVars?t[e]:function(e,t,n,i,r){if(oe(e)&&(e=An(e,r,t,n,i)),!ue(e)||e.style&&e.nodeType||me(e)||pe(e))return ae(e)?An(e,r,t,n,i):e;var s,a={};for(s in e)a[s]=An(e[s],r,t,n,i);return a}(t[e],i,r,s,n),n,i,s)&&(n._pt=o=new Wn(n._pt,r,e,0,1,a.render,a,0,a.priority),n!==K))for(l=n._ptLookup[n._targets.indexOf(r)],c=a._props.length;c--;)l[a._props[c]]=o;return a},Tn=function e(t,n,i){var r,s,a,o,l,c,u,d,h,f,p,m,g,v=t.vars,y=v.ease,_=v.startAt,b=v.immediateRender,x=v.lazy,S=v.onUpdate,E=v.runBackwards,w=v.yoyoEase,T=v.keyframes,M=v.autoRevert,A=t._dur,C=t._startAt,R=t._targets,L=t.parent,P=L&&"nested"===L.data?L.vars.targets:R,I="auto"===t._overwrite&&!U,D=t.timeline;if(D&&(!T||!y)&&(y="none"),t._ease=hn(y,Q.ease),t._yEase=w?un(hn(!0===w?y:w,Q.ease)):0,w&&t._yoyo&&!t._repeat&&(w=t._yEase,t._yEase=t._ease,t._ease=w),t._from=!D&&!!v.runBackwards,!D||T&&!v.stagger){if(m=(d=R[0]?Ge(R[0]).harness:0)&&v[d.prop],r=it(v,De),C&&(C._zTime<0&&C.progress(1),n<0&&E&&b&&!M?C.render(-1,!0):C.revert(E&&A?Pe:Le),C._lazy=0),_){if(ot(t._startAt=Ln.set(R,et({data:"isStart",overwrite:!1,parent:L,immediateRender:!0,lazy:!C&&de(x),startAt:null,delay:0,onUpdate:S&&function(){return Wt(t,"onUpdate")},stagger:0},_))),t._startAt._dp=0,t._startAt._sat=t,n<0&&(H||!b&&!M)&&t._startAt.revert(Pe),b&&A&&n<=0&&i<=0)return void(n&&(t._zTime=n))}else if(E&&A&&!C)if(n&&(b=!1),a=et({overwrite:!1,data:"isFromStart",lazy:b&&!C&&de(x),immediateRender:b,stagger:0,parent:L},r),m&&(a[d.prop]=m),ot(t._startAt=Ln.set(R,a)),t._startAt._dp=0,t._startAt._sat=t,n<0&&(H?t._startAt.revert(Pe):t._startAt.render(-1,!0)),t._zTime=n,b){if(!n)return}else e(t._startAt,$,$);for(t._pt=t._ptCache=0,x=A&&de(x)||x&&!A,s=0;s<R.length;s++){if(u=(l=R[s])._gsap||ze(R)[s]._gsap,t._ptLookup[s]=f={},Oe[u.id]&&ke.length&&qe(),p=P===R?s:P.indexOf(l),d&&!1!==(h=new d).init(l,m||r,t,p,P)&&(t._pt=o=new Wn(t._pt,l,h.name,0,1,h.render,h,0,h.priority),h._props.forEach(function(e){f[e]=o}),h.priority&&(c=1)),!d||m)for(a in r)Ne[a]&&(h=wn(a,r,t,p,l,P))?h.priority&&(c=1):f[a]=o=En.call(t,l,a,"get",r[a],p,P,0,v.stringFilter);t._op&&t._op[s]&&t.kill(l,t._op[s]),I&&t._pt&&(bn=t,G.killTweensOf(l,f,t.globalTime(n)),g=!t.parent,bn=0),t._pt&&x&&(Oe[u.id]=1)}c&&Vn(t),t._onInit&&t._onInit(t)}t._onUpdate=S,t._initted=(!t._op||t._pt)&&!g,T&&n<=0&&D.render(Z,!0,!0)},Mn=function(e,t,n,i){var r,s,a=t.ease||i||"power1.inOut";if(me(t))s=n[e]||(n[e]=[]),t.forEach(function(e,n){return s.push({t:n/(t.length-1)*100,v:e,e:a})});else for(r in t)s=n[r]||(n[r]=[]),"ease"===r||s.push({t:parseFloat(e),v:t[r],e:a})},An=function(e,t,n,i,r){return oe(e)?e.call(t,n,i,r):ae(e)&&~e.indexOf("random(")?zt(e):e},Cn=He+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Rn={};We(Cn+",id,stagger,delay,duration,paused,scrollTrigger",function(e){return Rn[e]=1});var Ln=function(e){function t(t,n,i,r){var s;"number"===typeof n&&(i.duration=n,n=i,i=null);var a,o,l,c,u,d,h,f,p=(s=e.call(this,r?n:rt(n))||this).vars,m=p.duration,g=p.delay,v=p.immediateRender,y=p.stagger,_=p.overwrite,b=p.keyframes,x=p.defaults,S=p.scrollTrigger,E=p.yoyoEase,w=n.parent||G,T=(me(t)||pe(t)?le(t[0]):"length"in n)?[t]:Dt(t);if(s._targets=T.length?ze(T):Ae("GSAP target "+t+" not found. https://gsap.com",!J.nullTargetWarn)||[],s._ptLookup=[],s._overwrite=_,b||y||fe(m)||fe(g)){if(n=s.vars,(a=s.timeline=new _n({data:"nested",defaults:x||{},targets:w&&"nested"===w.data?w.vars.targets:T})).kill(),a.parent=a._dp=F(s),a._start=0,y||fe(m)||fe(g)){if(c=T.length,h=y&&Nt(y),ue(y))for(u in y)~Cn.indexOf(u)&&(f||(f={}),f[u]=y[u]);for(o=0;o<c;o++)(l=it(n,Rn)).stagger=0,E&&(l.yoyoEase=E),f&&tt(l,f),d=T[o],l.duration=+An(m,F(s),o,d,T),l.delay=(+An(g,F(s),o,d,T)||0)-s._delay,!y&&1===c&&l.delay&&(s._delay=g=l.delay,s._start+=g,l.delay=0),a.to(d,l,h?h(o,d,T):0),a._ease=an.none;a.duration()?m=g=0:s.timeline=0}else if(b){rt(et(a.vars.defaults,{ease:"none"})),a._ease=hn(b.ease||n.ease||"none");var M,A,C,R=0;if(me(b))b.forEach(function(e){return a.to(T,e,">")}),a.duration();else{for(u in l={},b)"ease"===u||"easeEach"===u||Mn(u,b[u],l,b.easeEach);for(u in l)for(M=l[u].sort(function(e,t){return e.t-t.t}),R=0,o=0;o<M.length;o++)(C={ease:(A=M[o]).e,duration:(A.t-(o?M[o-1].t:0))/100*m})[u]=A.v,a.to(T,C,R),R+=C.duration;a.duration()<m&&a.to({},{duration:m-a.duration()})}}m||s.duration(m=a.duration())}else s.timeline=0;return!0!==_||U||(bn=F(s),G.killTweensOf(T),bn=0),vt(w,F(s),i),n.reversed&&s.reverse(),n.paused&&s.paused(!0),(v||!m&&!b&&s._start===Ye(w._time)&&de(v)&&ut(F(s))&&"nested"!==w.data)&&(s._tTime=-1e-8,s.render(Math.max(0,-g)||0)),S&&yt(F(s),S),s}B(t,e);var n=t.prototype;return n.render=function(e,t,n){var i,r,s,a,o,l,c,u,d,h=this._time,f=this._tDur,p=this._dur,m=e<0,g=e>f-$&&!m?f:e<$?0:e;if(p){if(g!==this._tTime||!e||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==m||this._lazy){if(i=g,u=this.timeline,this._repeat){if(a=p+this._rDelay,this._repeat<-1&&m)return this.totalTime(100*a+e,t,n);if(i=Ye(g%a),g===f?(s=this._repeat,i=p):(s=~~(o=Ye(g/a)))&&s===o?(i=p,s--):i>p&&(i=p),(l=this._yoyo&&1&s)&&(d=this._yEase,i=p-i),o=ht(this._tTime,a),i===h&&!n&&this._initted&&s===o)return this._tTime=g,this;s!==o&&(u&&this._yEase&&dn(u,l),this.vars.repeatRefresh&&!l&&!this._lock&&i!==a&&this._initted&&(this._lock=n=1,this.render(Ye(a*s),!0).invalidate()._lock=0))}if(!this._initted){if(_t(this,m?e:i,n,t,g))return this._tTime=0,this;if(h!==this._time&&(!n||!this.vars.repeatRefresh||s===o))return this;if(p!==this._dur)return this.render(e,t,n)}if(this._tTime=g,this._time=i,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=c=(d||this._ease)(i/p),this._from&&(this.ratio=c=1-c),!h&&g&&!t&&!o&&(Wt(this,"onStart"),this._tTime!==g))return this;for(r=this._pt;r;)r.r(c,r.d),r=r._next;u&&u.render(e<0?e:u._dur*u._ease(i/this._dur),t,n)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(m&&ct(this,e,0,n),Wt(this,"onUpdate")),this._repeat&&s!==o&&this.vars.onRepeat&&!t&&this.parent&&Wt(this,"onRepeat"),g!==this._tDur&&g||this._tTime!==g||(m&&!this._onUpdate&&ct(this,e,0,!0),(e||!p)&&(g===this._tDur&&this._ts>0||!g&&this._ts<0)&&ot(this,1),t||m&&!h||!(g||h||l)||(Wt(this,g===f?"onComplete":"onReverseComplete",!0),this._prom&&!(g<f&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,n,i){var r,s,a,o=e.ratio,l=t<0||!t&&(!e._start&&bt(e)&&(e._initted||!xt(e))||(e._ts<0||e._dp._ts<0)&&!xt(e))?0:1,c=e._rDelay,u=0;if(c&&e._repeat&&(u=Ct(0,e._tDur,t),s=ht(u,c),e._yoyo&&1&s&&(l=1-l),s!==ht(e._tTime,c)&&(o=1-l,e.vars.repeatRefresh&&e._initted&&e.invalidate())),l!==o||H||i||e._zTime===$||!t&&e._zTime){if(!e._initted&&_t(e,t,i,n,u))return;for(a=e._zTime,e._zTime=t||(n?$:0),n||(n=t&&!a),e.ratio=l,e._from&&(l=1-l),e._time=0,e._tTime=u,r=e._pt;r;)r.r(l,r.d),r=r._next;t<0&&ct(e,t,0,!0),e._onUpdate&&!n&&Wt(e,"onUpdate"),u&&e._repeat&&!n&&e.parent&&Wt(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===l&&(l&&ot(e,1),n||H||(Wt(e,l?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,e,t,n);return this},n.targets=function(){return this._targets},n.invalidate=function(t){return(!t||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(t),e.prototype.invalidate.call(this,t)},n.resetTo=function(e,t,n,i,r){q||rn.wake(),this._ts||this.play();var s=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||Tn(this,s),function(e,t,n,i,r,s,a,o){var l,c,u,d,h=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!h)for(h=e._ptCache[t]=[],u=e._ptLookup,d=e._targets.length;d--;){if((l=u[d][t])&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==t&&l.fp!==t;)l=l._next;if(!l)return xn=1,e.vars[t]="+=0",Tn(e,a),xn=0,o?Ae(t+" not eligible for reset"):1;h.push(l)}for(d=h.length;d--;)(l=(c=h[d])._pt||c).s=!i&&0!==i||r?l.s+(i||0)+s*l.c:i,l.c=n-l.s,c.e&&(c.e=je(n)+Rt(c.e)),c.b&&(c.b=l.s+Rt(c.b))}(this,e,t,n,i,this._ease(s/this._dur),s,r)?this.resetTo(e,t,n,i,1):(mt(this,0),this.parent||st(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},n.kill=function(e,t){if(void 0===t&&(t="all"),!e&&(!t||"all"===t))return this._lazy=this._pt=0,this.parent?jt(this):this.scrollTrigger&&this.scrollTrigger.kill(!!H),this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,bn&&!0!==bn.vars.overwrite)._first||jt(this),this.parent&&n!==this.timeline.totalDuration()&&St(this,this._dur*this.timeline._tDur/n,0,1),this}var i,r,s,a,o,l,c,u=this._targets,d=e?Dt(e):u,h=this._ptLookup,f=this._pt;if((!t||"all"===t)&&function(e,t){for(var n=e.length,i=n===t.length;i&&n--&&e[n]===t[n];);return n<0}(u,d))return"all"===t&&(this._pt=0),jt(this);for(i=this._op=this._op||[],"all"!==t&&(ae(t)&&(o={},We(t,function(e){return o[e]=1}),t=o),t=function(e,t){var n,i,r,s,a=e[0]?Ge(e[0]).harness:0,o=a&&a.aliases;if(!o)return t;for(i in n=tt({},t),o)if(i in n)for(r=(s=o[i].split(",")).length;r--;)n[s[r]]=n[i];return n}(u,t)),c=u.length;c--;)if(~d.indexOf(u[c]))for(o in r=h[c],"all"===t?(i[c]=t,a=r,s={}):(s=i[c]=i[c]||{},a=t),a)(l=r&&r[o])&&("kill"in l.d&&!0!==l.d.kill(o)||at(this,l,"_pt"),delete r[o]),"all"!==s&&(s[o]=1);return this._initted&&!this._pt&&f&&jt(this),this},t.to=function(e,n){return new t(e,n,arguments[2])},t.from=function(e,t){return Mt(1,arguments)},t.delayedCall=function(e,n,i,r){return new t(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:n,onReverseComplete:n,onCompleteParams:i,onReverseCompleteParams:i,callbackScope:r})},t.fromTo=function(e,t,n){return Mt(2,arguments)},t.set=function(e,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new t(e,n)},t.killTweensOf=function(e,t,n){return G.killTweensOf(e,t,n)},t}(yn);et(Ln.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),We("staggerTo,staggerFrom,staggerFromTo",function(e){Ln[e]=function(){var t=new _n,n=Lt.call(arguments,0);return n.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,n)}});var Pn=function(e,t,n){return e[t]=n},In=function(e,t,n){return e[t](n)},Dn=function(e,t,n,i){return e[t](i.fp,n)},kn=function(e,t,n){return e.setAttribute(t,n)},On=function(e,t){return oe(e[t])?In:ce(e[t])&&e.setAttribute?kn:Pn},Nn=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},Fn=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},Bn=function(e,t){var n=t._pt,i="";if(!e&&t.b)i=t.b;else if(1===e&&t.e)i=t.e;else{for(;n;)i=n.p+(n.m?n.m(n.s+n.c*e):Math.round(1e4*(n.s+n.c*e))/1e4)+i,n=n._next;i+=t.c}t.set(t.t,t.p,i,t)},Un=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},Hn=function(e,t,n,i){for(var r,s=this._pt;s;)r=s._next,s.p===i&&s.modifier(e,t,n),s=r},zn=function(e){for(var t,n,i=this._pt;i;)n=i._next,i.p===e&&!i.op||i.op===e?at(this,i,"_pt"):i.dep||(t=1),i=n;return!t},Gn=function(e,t,n,i){i.mSet(e,t,i.m.call(i.tween,n,i.mt),i)},Vn=function(e){for(var t,n,i,r,s=e._pt;s;){for(t=s._next,n=i;n&&n.pr>s.pr;)n=n._next;(s._prev=n?n._prev:r)?s._prev._next=s:i=s,(s._next=n)?n._prev=s:r=s,s=t}e._pt=i},Wn=function(){function e(e,t,n,i,r,s,a,o,l){this.t=t,this.s=i,this.c=r,this.p=n,this.r=s||Nn,this.d=a||this,this.set=o||Pn,this.pr=l||0,this._next=e,e&&(e._prev=this)}return e.prototype.modifier=function(e,t,n){this.mSet=this.mSet||this.set,this.set=Gn,this.m=e,this.mt=n,this.tween=t},e}();We(He+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(e){return De[e]=1}),Ee.TweenMax=Ee.TweenLite=Ln,Ee.TimelineLite=Ee.TimelineMax=_n,G=new _n({sortChildren:!1,defaults:Q,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),J.stringFilter=nn;var jn=[],Yn={},Xn=[],Kn=0,qn=0,Jn=function(e){return(Yn[e]||Xn).map(function(e){return e()})},Qn=function(){var e=Date.now(),t=[];e-Kn>2&&(Jn("matchMediaInit"),jn.forEach(function(e){var n,i,r,s,a=e.queries,o=e.conditions;for(i in a)(n=V.matchMedia(a[i]).matches)&&(r=1),n!==o[i]&&(o[i]=n,s=1);s&&(e.revert(),r&&t.push(e))}),Jn("matchMediaRevert"),t.forEach(function(e){return e.onMatch(e,function(t){return e.add(null,t)})}),Kn=e,Jn("matchMedia"))},Zn=function(){function e(e,t){this.selector=t&&kt(t),this.data=[],this._r=[],this.isReverted=!1,this.id=qn++,e&&this.add(e)}var t=e.prototype;return t.add=function(e,t,n){oe(e)&&(n=t,t=e,e=oe);var i=this,r=function(){var e,r=z,s=i.selector;return r&&r!==i&&r.data.push(i),n&&(i.selector=kt(n)),z=i,e=t.apply(i,arguments),oe(e)&&i._r.push(e),z=r,i.selector=s,i.isReverted=!1,e};return i.last=r,e===oe?r(i,function(e){return i.add(null,e)}):e?i[e]=r:r},t.ignore=function(e){var t=z;z=null,e(this),z=t},t.getTweens=function(){var t=[];return this.data.forEach(function(n){return n instanceof e?t.push.apply(t,n.getTweens()):n instanceof Ln&&!(n.parent&&"nested"===n.parent.data)&&t.push(n)}),t},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(e,t){var n=this;if(e?function(){for(var t,i=n.getTweens(),r=n.data.length;r--;)"isFlip"===(t=n.data[r]).data&&(t.revert(),t.getChildren(!0,!0,!1).forEach(function(e){return i.splice(i.indexOf(e),1)}));for(i.map(function(e){return{g:e._dur||e._delay||e._sat&&!e._sat.vars.immediateRender?e.globalTime(0):-1/0,t:e}}).sort(function(e,t){return t.g-e.g||-1/0}).forEach(function(t){return t.t.revert(e)}),r=n.data.length;r--;)(t=n.data[r])instanceof _n?"nested"!==t.data&&(t.scrollTrigger&&t.scrollTrigger.revert(),t.kill()):!(t instanceof Ln)&&t.revert&&t.revert(e);n._r.forEach(function(t){return t(e,n)}),n.isReverted=!0}():this.data.forEach(function(e){return e.kill&&e.kill()}),this.clear(),t)for(var i=jn.length;i--;)jn[i].id===this.id&&jn.splice(i,1)},t.revert=function(e){this.kill(e||{})},e}(),$n=function(){function e(e){this.contexts=[],this.scope=e,z&&z.data.push(this)}var t=e.prototype;return t.add=function(e,t,n){ue(e)||(e={matches:e});var i,r,s,a=new Zn(0,n||this.scope),o=a.conditions={};for(r in z&&!a.selector&&(a.selector=z.selector),this.contexts.push(a),t=a.add("onMatch",t),a.queries=e,e)"all"===r?s=1:(i=V.matchMedia(e[r]))&&(jn.indexOf(a)<0&&jn.push(a),(o[r]=i.matches)&&(s=1),i.addListener?i.addListener(Qn):i.addEventListener("change",Qn));return s&&t(a,function(e){return a.add(null,e)}),this},t.revert=function(e){this.kill(e||{})},t.kill=function(e){this.contexts.forEach(function(t){return t.kill(e,!0)})},e}(),ei={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(e){return Xt(e)})},timeline:function(e){return new _n(e)},getTweensOf:function(e,t){return G.getTweensOf(e,t)},getProperty:function(e,t,n,i){ae(e)&&(e=Dt(e)[0]);var r=Ge(e||{}).get,s=n?$e:Ze;return"native"===n&&(n=""),e?t?s((Ne[t]&&Ne[t].get||r)(e,t,n,i)):function(t,n,i){return s((Ne[t]&&Ne[t].get||r)(e,t,n,i))}:e},quickSetter:function(e,t,n){if((e=Dt(e)).length>1){var i=e.map(function(e){return ii.quickSetter(e,t,n)}),r=i.length;return function(e){for(var t=r;t--;)i[t](e)}}e=e[0]||{};var s=Ne[t],a=Ge(e),o=a.harness&&(a.harness.aliases||{})[t]||t,l=s?function(t){var i=new s;K._pt=0,i.init(e,n?t+n:t,K,0,[e]),i.render(1,i),K._pt&&Un(1,K)}:a.set(e,o);return s?l:function(t){return l(e,o,n?t+n:t,a,1)}},quickTo:function(e,t,n){var i,r=ii.to(e,et(((i={})[t]="+=0.1",i.paused=!0,i.stagger=0,i),n||{})),s=function(e,n,i){return r.resetTo(t,e,n,i)};return s.tween=r,s},isTweening:function(e){return G.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=hn(e.ease,Q.ease)),nt(Q,e||{})},config:function(e){return nt(J,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,i=e.plugins,r=e.defaults,s=e.extendTimeline;(i||"").split(",").forEach(function(e){return e&&!Ne[e]&&!Ee[e]&&Ae(t+" effect requires "+e+" plugin.")}),Fe[t]=function(e,t,i){return n(Dt(e),et(t||{},r),i)},s&&(_n.prototype[t]=function(e,n,i){return this.add(Fe[t](e,ue(n)?n:(i=n)&&{},this),i)})},registerEase:function(e,t){an[e]=hn(t)},parseEase:function(e,t){return arguments.length?hn(e,t):an},getById:function(e){return G.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var n,i,r=new _n(e);for(r.smoothChildTiming=de(e.smoothChildTiming),G.remove(r),r._dp=0,r._time=r._tTime=G._time,n=G._first;n;)i=n._next,!t&&!n._dur&&n instanceof Ln&&n.vars.onComplete===n._targets[0]||vt(r,n,n._start-n._delay),n=i;return vt(G,r,0),r},context:function(e,t){return e?new Zn(e,t):z},matchMedia:function(e){return new $n(e)},matchMediaRefresh:function(){return jn.forEach(function(e){var t,n,i=e.conditions;for(n in i)i[n]&&(i[n]=!1,t=1);t&&e.revert()})||Qn()},addEventListener:function(e,t){var n=Yn[e]||(Yn[e]=[]);~n.indexOf(t)||n.push(t)},removeEventListener:function(e,t){var n=Yn[e],i=n&&n.indexOf(t);i>=0&&n.splice(i,1)},utils:{wrap:function e(t,n,i){var r=n-t;return me(t)?Ht(t,e(0,t.length),n):At(i,function(e){return(r+(e-t)%r)%r+t})},wrapYoyo:function e(t,n,i){var r=n-t,s=2*r;return me(t)?Ht(t,e(0,t.length-1),n):At(i,function(e){return t+((e=(s+(e-t)%s)%s||0)>r?s-e:e)})},distribute:Nt,random:Ut,snap:Bt,normalize:function(e,t,n){return Gt(e,t,0,1,n)},getUnit:Rt,clamp:function(e,t,n){return At(n,function(n){return Ct(e,t,n)})},splitColor:Qt,toArray:Dt,selector:kt,mapRange:Gt,pipe:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce(function(e,t){return t(e)},e)}},unitize:function(e,t){return function(n){return e(parseFloat(n))+(t||Rt(n))}},interpolate:function e(t,n,i,r){var s=isNaN(t+n)?0:function(e){return(1-e)*t+e*n};if(!s){var a,o,l,c,u,d=ae(t),h={};if(!0===i&&(r=1)&&(i=null),d)t={p:t},n={p:n};else if(me(t)&&!me(n)){for(l=[],c=t.length,u=c-2,o=1;o<c;o++)l.push(e(t[o-1],t[o]));c--,s=function(e){e*=c;var t=Math.min(u,~~e);return l[t](e-t)},i=n}else r||(t=tt(me(t)?[]:{},t));if(!l){for(a in n)En.call(h,t,a,"get",n[a]);s=function(e){return Un(e,h)||(d?t.p:t)}}}return At(i,s)},shuffle:Ot},install:Te,effects:Fe,ticker:rn,updateRoot:_n.updateRoot,plugins:Ne,globalTimeline:G,core:{PropTween:Wn,globals:Ce,Tween:Ln,Timeline:_n,Animation:yn,getCache:Ge,_removeLinkedListItem:at,reverting:function(){return H},context:function(e){return e&&z&&(z.data.push(e),e._ctx=z),z},suppressOverwrites:function(e){return U=e}}};We("to,from,fromTo,delayedCall,set,killTweensOf",function(e){return ei[e]=Ln[e]}),rn.add(_n.updateRoot),K=ei.to({},{duration:0});var ti=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},ni=function(e,t){return{name:e,headless:1,rawVars:1,init:function(e,n,i){i._onInit=function(e){var i,r;if(ae(n)&&(i={},We(n,function(e){return i[e]=1}),n=i),t){for(r in i={},n)i[r]=t(n[r]);n=i}!function(e,t){var n,i,r,s=e._targets;for(n in t)for(i=s.length;i--;)(r=e._ptLookup[i][n])&&(r=r.d)&&(r._pt&&(r=ti(r,n)),r&&r.modifier&&r.modifier(t[n],e,s[i],n))}(e,n)}}}},ii=ei.registerPlugin({name:"attr",init:function(e,t,n,i,r){var s,a,o;for(s in this.tween=n,t)o=e.getAttribute(s)||"",(a=this.add(e,"setAttribute",(o||0)+"",t[s],i,r,0,0,s)).op=s,a.b=o,this._props.push(s)},render:function(e,t){for(var n=t._pt;n;)H?n.set(n.t,n.p,n.b,n):n.r(e,n.d),n=n._next}},{name:"endArray",headless:1,init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n],0,0,0,0,0,1)}},ni("roundProps",Ft),ni("modifiers"),ni("snap",Bt))||ei;Ln.version=_n.version=ii.version="3.13.0",Y=1,he()&&sn();an.Power0,an.Power1,an.Power2,an.Power3,an.Power4,an.Linear,an.Quad,an.Cubic,an.Quart,an.Quint,an.Strong,an.Elastic,an.Back,an.SteppedEase,an.Bounce,an.Sine,an.Expo,an.Circ;var ri,si,ai,oi,li,ci,ui,di,hi={},fi=180/Math.PI,pi=Math.PI/180,mi=Math.atan2,gi=/([A-Z])/g,vi=/(left|right|width|margin|padding|x)/i,yi=/[\s,\(]\S/,_i={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},bi=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},xi=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},Si=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},Ei=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},wi=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},Ti=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},Mi=function(e,t,n){return e.style[t]=n},Ai=function(e,t,n){return e.style.setProperty(t,n)},Ci=function(e,t,n){return e._gsap[t]=n},Ri=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},Li=function(e,t,n,i,r){var s=e._gsap;s.scaleX=s.scaleY=n,s.renderTransform(r,s)},Pi=function(e,t,n,i,r){var s=e._gsap;s[t]=n,s.renderTransform(r,s)},Ii="transform",Di=Ii+"Origin",ki=function e(t,n){var i=this,r=this.target,s=r.style,a=r._gsap;if(t in hi&&s){if(this.tfm=this.tfm||{},"transform"===t)return _i.transform.split(",").forEach(function(t){return e.call(i,t,n)});if(~(t=_i[t]||t).indexOf(",")?t.split(",").forEach(function(e){return i.tfm[e]=Zi(r,e)}):this.tfm[t]=a.x?a[t]:Zi(r,t),t===Di&&(this.tfm.zOrigin=a.zOrigin),this.props.indexOf(Ii)>=0)return;a.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(Di,n,"")),t=Ii}(s||n)&&this.props.push(t,n,s[t])},Oi=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},Ni=function(){var e,t,n=this.props,i=this.target,r=i.style,s=i._gsap;for(e=0;e<n.length;e+=3)n[e+1]?2===n[e+1]?i[n[e]](n[e+2]):i[n[e]]=n[e+2]:n[e+2]?r[n[e]]=n[e+2]:r.removeProperty("--"===n[e].substr(0,2)?n[e]:n[e].replace(gi,"-$1").toLowerCase());if(this.tfm){for(t in this.tfm)s[t]=this.tfm[t];s.svg&&(s.renderTransform(),i.setAttribute("data-svg-origin",this.svgo||"")),(e=ui())&&e.isStart||r[Ii]||(Oi(r),s.zOrigin&&r[Di]&&(r[Di]+=" "+s.zOrigin+"px",s.zOrigin=0,s.renderTransform()),s.uncache=1)}},Fi=function(e,t){var n={target:e,props:[],revert:Ni,save:ki};return e._gsap||ii.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach(function(e){return n.save(e)}),n},Bi=function(e,t){var n=si.createElementNS?si.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):si.createElement(e);return n&&n.style?n:si.createElement(e)},Ui=function e(t,n,i){var r=getComputedStyle(t);return r[n]||r.getPropertyValue(n.replace(gi,"-$1").toLowerCase())||r.getPropertyValue(n)||!i&&e(t,zi(n)||n,1)||""},Hi="O,Moz,ms,Ms,Webkit".split(","),zi=function(e,t,n){var i=(t||li).style,r=5;if(e in i&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);r--&&!(Hi[r]+e in i););return r<0?null:(3===r?"ms":r>=0?Hi[r]:"")+e},Gi=function(){"undefined"!==typeof window&&window.document&&(ri=window,si=ri.document,ai=si.documentElement,li=Bi("div")||{style:{}},Bi("div"),Ii=zi(Ii),Di=Ii+"Origin",li.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",di=!!zi("perspective"),ui=ii.core.reverting,oi=1)},Vi=function(e){var t,n=e.ownerSVGElement,i=Bi("svg",n&&n.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=e.cloneNode(!0);r.style.display="block",i.appendChild(r),ai.appendChild(i);try{t=r.getBBox()}catch(s){}return i.removeChild(r),ai.removeChild(i),t},Wi=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},ji=function(e){var t,n;try{t=e.getBBox()}catch(i){t=Vi(e),n=1}return t&&(t.width||t.height)||n||(t=Vi(e)),!t||t.width||t.x||t.y?t:{x:+Wi(e,["x","cx","x1"])||0,y:+Wi(e,["y","cy","y1"])||0,width:0,height:0}},Yi=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!ji(e))},Xi=function(e,t){if(t){var n,i=e.style;t in hi&&t!==Di&&(t=Ii),i.removeProperty?("ms"!==(n=t.substr(0,2))&&"webkit"!==t.substr(0,6)||(t="-"+t),i.removeProperty("--"===n?t:t.replace(gi,"-$1").toLowerCase())):i.removeAttribute(t)}},Ki=function(e,t,n,i,r,s){var a=new Wn(e._pt,t,n,0,1,s?Ti:wi);return e._pt=a,a.b=i,a.e=r,e._props.push(n),a},qi={deg:1,rad:1,turn:1},Ji={grid:1,flex:1},Qi=function e(t,n,i,r){var s,a,o,l,c=parseFloat(i)||0,u=(i+"").trim().substr((c+"").length)||"px",d=li.style,h=vi.test(n),f="svg"===t.tagName.toLowerCase(),p=(f?"client":"offset")+(h?"Width":"Height"),m=100,g="px"===r,v="%"===r;if(r===u||!c||qi[r]||qi[u])return c;if("px"!==u&&!g&&(c=e(t,n,i,"px")),l=t.getCTM&&Yi(t),(v||"%"===u)&&(hi[n]||~n.indexOf("adius")))return s=l?t.getBBox()[h?"width":"height"]:t[p],je(v?c/s*m:c/100*s);if(d[h?"width":"height"]=m+(g?u:r),a="rem"!==r&&~n.indexOf("adius")||"em"===r&&t.appendChild&&!f?t:t.parentNode,l&&(a=(t.ownerSVGElement||{}).parentNode),a&&a!==si&&a.appendChild||(a=si.body),(o=a._gsap)&&v&&o.width&&h&&o.time===rn.time&&!o.uncache)return je(c/o.width*m);if(!v||"height"!==n&&"width"!==n)(v||"%"===u)&&!Ji[Ui(a,"display")]&&(d.position=Ui(t,"position")),a===t&&(d.position="static"),a.appendChild(li),s=li[p],a.removeChild(li),d.position="absolute";else{var y=t.style[n];t.style[n]=m+r,s=t[p],y?t.style[n]=y:Xi(t,n)}return h&&v&&((o=Ge(a)).time=rn.time,o.width=a[p]),je(g?s*c/m:s&&c?m/s*c:0)},Zi=function(e,t,n,i){var r;return oi||Gi(),t in _i&&"transform"!==t&&~(t=_i[t]).indexOf(",")&&(t=t.split(",")[0]),hi[t]&&"transform"!==t?(r=ur(e,i),r="transformOrigin"!==t?r[t]:r.svg?r.origin:dr(Ui(e,Di))+" "+r.zOrigin+"px"):(!(r=e.style[t])||"auto"===r||i||~(r+"").indexOf("calc("))&&(r=ir[t]&&ir[t](e,t,n)||Ui(e,t)||Ve(e,t)||("opacity"===t?1:0)),n&&!~(r+"").trim().indexOf(" ")?Qi(e,t,r,n)+n:r},$i=function(e,t,n,i){if(!n||"none"===n){var r=zi(t,e,1),s=r&&Ui(e,r,1);s&&s!==n?(t=r,n=s):"borderColor"===t&&(n=Ui(e,"borderTopColor"))}var a,o,l,c,u,d,h,f,p,m,g,v=new Wn(this._pt,e.style,t,0,1,Bn),y=0,_=0;if(v.b=n,v.e=i,n+="","var(--"===(i+="").substring(0,6)&&(i=Ui(e,i.substring(4,i.indexOf(")")))),"auto"===i&&(d=e.style[t],e.style[t]=i,i=Ui(e,t)||i,d?e.style[t]=d:Xi(e,t)),nn(a=[n,i]),i=a[1],l=(n=a[0]).match(ye)||[],(i.match(ye)||[]).length){for(;o=ye.exec(i);)h=o[0],p=i.substring(y,o.index),u?u=(u+1)%5:"rgba("!==p.substr(-5)&&"hsla("!==p.substr(-5)||(u=1),h!==(d=l[_++]||"")&&(c=parseFloat(d)||0,g=d.substr((c+"").length),"="===h.charAt(1)&&(h=Xe(c,h)+g),f=parseFloat(h),m=h.substr((f+"").length),y=ye.lastIndex-m.length,m||(m=m||J.units[t]||g,y===i.length&&(i+=m,v.e+=m)),g!==m&&(c=Qi(e,t,d,m)||0),v._pt={_next:v._pt,p:p||1===_?p:",",s:c,c:f-c,m:u&&u<4||"zIndex"===t?Math.round:0});v.c=y<i.length?i.substring(y,i.length):""}else v.r="display"===t&&"none"===i?Ti:wi;return be.test(i)&&(v.e=0),this._pt=v,v},er={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},tr=function(e){var t=e.split(" "),n=t[0],i=t[1]||"50%";return"top"!==n&&"bottom"!==n&&"left"!==i&&"right"!==i||(e=n,n=i,i=e),t[0]=er[n]||n,t[1]=er[i]||i,t.join(" ")},nr=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var n,i,r,s=t.t,a=s.style,o=t.u,l=s._gsap;if("all"===o||!0===o)a.cssText="",i=1;else for(r=(o=o.split(",")).length;--r>-1;)n=o[r],hi[n]&&(i=1,n="transformOrigin"===n?Di:Ii),Xi(s,n);i&&(Xi(s,Ii),l&&(l.svg&&s.removeAttribute("transform"),a.scale=a.rotate=a.translate="none",ur(s,1),l.uncache=1,Oi(a)))}},ir={clearProps:function(e,t,n,i,r){if("isFromStart"!==r.data){var s=e._pt=new Wn(e._pt,t,n,0,0,nr);return s.u=i,s.pr=-10,s.tween=r,e._props.push(n),1}}},rr=[1,0,0,1,0,0],sr={},ar=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},or=function(e){var t=Ui(e,Ii);return ar(t)?rr:t.substr(7).match(ve).map(je)},lr=function(e,t){var n,i,r,s,a=e._gsap||Ge(e),o=e.style,l=or(e);return a.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(r=e.transform.baseVal.consolidate().matrix).a,r.b,r.c,r.d,r.e,r.f]).join(",")?rr:l:(l!==rr||e.offsetParent||e===ai||a.svg||(r=o.display,o.display="block",(n=e.parentNode)&&(e.offsetParent||e.getBoundingClientRect().width)||(s=1,i=e.nextElementSibling,ai.appendChild(e)),l=or(e),r?o.display=r:Xi(e,"display"),s&&(i?n.insertBefore(e,i):n?n.appendChild(e):ai.removeChild(e))),t&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},cr=function(e,t,n,i,r,s){var a,o,l,c=e._gsap,u=r||lr(e,!0),d=c.xOrigin||0,h=c.yOrigin||0,f=c.xOffset||0,p=c.yOffset||0,m=u[0],g=u[1],v=u[2],y=u[3],_=u[4],b=u[5],x=t.split(" "),S=parseFloat(x[0])||0,E=parseFloat(x[1])||0;n?u!==rr&&(o=m*y-g*v)&&(l=S*(-g/o)+E*(m/o)-(m*b-g*_)/o,S=S*(y/o)+E*(-v/o)+(v*b-y*_)/o,E=l):(S=(a=ji(e)).x+(~x[0].indexOf("%")?S/100*a.width:S),E=a.y+(~(x[1]||x[0]).indexOf("%")?E/100*a.height:E)),i||!1!==i&&c.smooth?(_=S-d,b=E-h,c.xOffset=f+(_*m+b*v)-_,c.yOffset=p+(_*g+b*y)-b):c.xOffset=c.yOffset=0,c.xOrigin=S,c.yOrigin=E,c.smooth=!!i,c.origin=t,c.originIsAbsolute=!!n,e.style[Di]="0px 0px",s&&(Ki(s,c,"xOrigin",d,S),Ki(s,c,"yOrigin",h,E),Ki(s,c,"xOffset",f,c.xOffset),Ki(s,c,"yOffset",p,c.yOffset)),e.setAttribute("data-svg-origin",S+" "+E)},ur=function(e,t){var n=e._gsap||new vn(e);if("x"in n&&!t&&!n.uncache)return n;var i,r,s,a,o,l,c,u,d,h,f,p,m,g,v,y,_,b,x,S,E,w,T,M,A,C,R,L,P,I,D,k,O=e.style,N=n.scaleX<0,F="px",B="deg",U=getComputedStyle(e),H=Ui(e,Di)||"0";return i=r=s=l=c=u=d=h=f=0,a=o=1,n.svg=!(!e.getCTM||!Yi(e)),U.translate&&("none"===U.translate&&"none"===U.scale&&"none"===U.rotate||(O[Ii]=("none"!==U.translate?"translate3d("+(U.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==U.rotate?"rotate("+U.rotate+") ":"")+("none"!==U.scale?"scale("+U.scale.split(" ").join(",")+") ":"")+("none"!==U[Ii]?U[Ii]:"")),O.scale=O.rotate=O.translate="none"),g=lr(e,n.svg),n.svg&&(n.uncache?(A=e.getBBox(),H=n.xOrigin-A.x+"px "+(n.yOrigin-A.y)+"px",M=""):M=!t&&e.getAttribute("data-svg-origin"),cr(e,M||H,!!M||n.originIsAbsolute,!1!==n.smooth,g)),p=n.xOrigin||0,m=n.yOrigin||0,g!==rr&&(b=g[0],x=g[1],S=g[2],E=g[3],i=w=g[4],r=T=g[5],6===g.length?(a=Math.sqrt(b*b+x*x),o=Math.sqrt(E*E+S*S),l=b||x?mi(x,b)*fi:0,(d=S||E?mi(S,E)*fi+l:0)&&(o*=Math.abs(Math.cos(d*pi))),n.svg&&(i-=p-(p*b+m*S),r-=m-(p*x+m*E))):(k=g[6],I=g[7],R=g[8],L=g[9],P=g[10],D=g[11],i=g[12],r=g[13],s=g[14],c=(v=mi(k,P))*fi,v&&(M=w*(y=Math.cos(-v))+R*(_=Math.sin(-v)),A=T*y+L*_,C=k*y+P*_,R=w*-_+R*y,L=T*-_+L*y,P=k*-_+P*y,D=I*-_+D*y,w=M,T=A,k=C),u=(v=mi(-S,P))*fi,v&&(y=Math.cos(-v),D=E*(_=Math.sin(-v))+D*y,b=M=b*y-R*_,x=A=x*y-L*_,S=C=S*y-P*_),l=(v=mi(x,b))*fi,v&&(M=b*(y=Math.cos(v))+x*(_=Math.sin(v)),A=w*y+T*_,x=x*y-b*_,T=T*y-w*_,b=M,w=A),c&&Math.abs(c)+Math.abs(l)>359.9&&(c=l=0,u=180-u),a=je(Math.sqrt(b*b+x*x+S*S)),o=je(Math.sqrt(T*T+k*k)),v=mi(w,T),d=Math.abs(v)>2e-4?v*fi:0,f=D?1/(D<0?-D:D):0),n.svg&&(M=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!ar(Ui(e,Ii)),M&&e.setAttribute("transform",M))),Math.abs(d)>90&&Math.abs(d)<270&&(N?(a*=-1,d+=l<=0?180:-180,l+=l<=0?180:-180):(o*=-1,d+=d<=0?180:-180)),t=t||n.uncache,n.x=i-((n.xPercent=i&&(!t&&n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-i)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+F,n.y=r-((n.yPercent=r&&(!t&&n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-r)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+F,n.z=s+F,n.scaleX=je(a),n.scaleY=je(o),n.rotation=je(l)+B,n.rotationX=je(c)+B,n.rotationY=je(u)+B,n.skewX=d+B,n.skewY=h+B,n.transformPerspective=f+F,(n.zOrigin=parseFloat(H.split(" ")[2])||!t&&n.zOrigin||0)&&(O[Di]=dr(H)),n.xOffset=n.yOffset=0,n.force3D=J.force3D,n.renderTransform=n.svg?yr:di?vr:fr,n.uncache=0,n},dr=function(e){return(e=e.split(" "))[0]+" "+e[1]},hr=function(e,t,n){var i=Rt(t);return je(parseFloat(t)+parseFloat(Qi(e,"x",n+"px",i)))+i},fr=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,vr(e,t)},pr="0deg",mr="0px",gr=") ",vr=function(e,t){var n=t||this,i=n.xPercent,r=n.yPercent,s=n.x,a=n.y,o=n.z,l=n.rotation,c=n.rotationY,u=n.rotationX,d=n.skewX,h=n.skewY,f=n.scaleX,p=n.scaleY,m=n.transformPerspective,g=n.force3D,v=n.target,y=n.zOrigin,_="",b="auto"===g&&e&&1!==e||!0===g;if(y&&(u!==pr||c!==pr)){var x,S=parseFloat(c)*pi,E=Math.sin(S),w=Math.cos(S);S=parseFloat(u)*pi,x=Math.cos(S),s=hr(v,s,E*x*-y),a=hr(v,a,-Math.sin(S)*-y),o=hr(v,o,w*x*-y+y)}m!==mr&&(_+="perspective("+m+gr),(i||r)&&(_+="translate("+i+"%, "+r+"%) "),(b||s!==mr||a!==mr||o!==mr)&&(_+=o!==mr||b?"translate3d("+s+", "+a+", "+o+") ":"translate("+s+", "+a+gr),l!==pr&&(_+="rotate("+l+gr),c!==pr&&(_+="rotateY("+c+gr),u!==pr&&(_+="rotateX("+u+gr),d===pr&&h===pr||(_+="skew("+d+", "+h+gr),1===f&&1===p||(_+="scale("+f+", "+p+gr),v.style[Ii]=_||"translate(0, 0)"},yr=function(e,t){var n,i,r,s,a,o=t||this,l=o.xPercent,c=o.yPercent,u=o.x,d=o.y,h=o.rotation,f=o.skewX,p=o.skewY,m=o.scaleX,g=o.scaleY,v=o.target,y=o.xOrigin,_=o.yOrigin,b=o.xOffset,x=o.yOffset,S=o.forceCSS,E=parseFloat(u),w=parseFloat(d);h=parseFloat(h),f=parseFloat(f),(p=parseFloat(p))&&(f+=p=parseFloat(p),h+=p),h||f?(h*=pi,f*=pi,n=Math.cos(h)*m,i=Math.sin(h)*m,r=Math.sin(h-f)*-g,s=Math.cos(h-f)*g,f&&(p*=pi,a=Math.tan(f-p),r*=a=Math.sqrt(1+a*a),s*=a,p&&(a=Math.tan(p),n*=a=Math.sqrt(1+a*a),i*=a)),n=je(n),i=je(i),r=je(r),s=je(s)):(n=m,s=g,i=r=0),(E&&!~(u+"").indexOf("px")||w&&!~(d+"").indexOf("px"))&&(E=Qi(v,"x",u,"px"),w=Qi(v,"y",d,"px")),(y||_||b||x)&&(E=je(E+y-(y*n+_*r)+b),w=je(w+_-(y*i+_*s)+x)),(l||c)&&(a=v.getBBox(),E=je(E+l/100*a.width),w=je(w+c/100*a.height)),a="matrix("+n+","+i+","+r+","+s+","+E+","+w+")",v.setAttribute("transform",a),S&&(v.style[Ii]=a)},_r=function(e,t,n,i,r){var s,a,o=360,l=ae(r),c=parseFloat(r)*(l&&~r.indexOf("rad")?fi:1)-i,u=i+c+"deg";return l&&("short"===(s=r.split("_")[1])&&(c%=o)!==c%180&&(c+=c<0?o:-360),"cw"===s&&c<0?c=(c+36e9)%o-~~(c/o)*o:"ccw"===s&&c>0&&(c=(c-36e9)%o-~~(c/o)*o)),e._pt=a=new Wn(e._pt,t,n,i,c,xi),a.e=u,a.u="deg",e._props.push(n),a},br=function(e,t){for(var n in t)e[n]=t[n];return e},xr=function(e,t,n){var i,r,s,a,o,l,c,u=br({},n._gsap),d=n.style;for(r in u.svg?(s=n.getAttribute("transform"),n.setAttribute("transform",""),d[Ii]=t,i=ur(n,1),Xi(n,Ii),n.setAttribute("transform",s)):(s=getComputedStyle(n)[Ii],d[Ii]=t,i=ur(n,1),d[Ii]=s),hi)(s=u[r])!==(a=i[r])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(r)<0&&(o=Rt(s)!==(c=Rt(a))?Qi(n,r,s,c):parseFloat(s),l=parseFloat(a),e._pt=new Wn(e._pt,i,r,o,l-o,bi),e._pt.u=c||0,e._props.push(r));br(i,u)};We("padding,margin,Width,Radius",function(e,t){var n="Top",i="Right",r="Bottom",s="Left",a=(t<3?[n,i,r,s]:[n+s,n+i,r+i,r+s]).map(function(n){return t<2?e+n:"border"+n+e});ir[t>1?"border"+e:e]=function(e,t,n,i,r){var s,o;if(arguments.length<4)return s=a.map(function(t){return Zi(e,t,n)}),5===(o=s.join(" ")).split(s[0]).length?s[0]:o;s=(i+"").split(" "),o={},a.forEach(function(e,t){return o[e]=s[t]=s[t]||s[(t-1)/2|0]}),e.init(t,o,r)}});var Sr={name:"css",register:Gi,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,i,r){var s,a,o,l,c,u,d,h,f,p,m,g,v,y,_,b,x=this._props,S=e.style,E=n.vars.startAt;for(d in oi||Gi(),this.styles=this.styles||Fi(e),b=this.styles.props,this.tween=n,t)if("autoRound"!==d&&(a=t[d],!Ne[d]||!wn(d,t,n,i,e,r)))if(c=typeof a,u=ir[d],"function"===c&&(c=typeof(a=a.call(n,i,e,r))),"string"===c&&~a.indexOf("random(")&&(a=zt(a)),u)u(this,e,d,a,n)&&(_=1);else if("--"===d.substr(0,2))s=(getComputedStyle(e).getPropertyValue(d)+"").trim(),a+="",en.lastIndex=0,en.test(s)||(h=Rt(s),f=Rt(a)),f?h!==f&&(s=Qi(e,d,s,f)+f):h&&(a+=h),this.add(S,"setProperty",s,a,i,r,0,0,d),x.push(d),b.push(d,0,S[d]);else if("undefined"!==c){if(E&&d in E?(s="function"===typeof E[d]?E[d].call(n,i,e,r):E[d],ae(s)&&~s.indexOf("random(")&&(s=zt(s)),Rt(s+"")||"auto"===s||(s+=J.units[d]||Rt(Zi(e,d))||""),"="===(s+"").charAt(1)&&(s=Zi(e,d))):s=Zi(e,d),l=parseFloat(s),(p="string"===c&&"="===a.charAt(1)&&a.substr(0,2))&&(a=a.substr(2)),o=parseFloat(a),d in _i&&("autoAlpha"===d&&(1===l&&"hidden"===Zi(e,"visibility")&&o&&(l=0),b.push("visibility",0,S.visibility),Ki(this,S,"visibility",l?"inherit":"hidden",o?"inherit":"hidden",!o)),"scale"!==d&&"transform"!==d&&~(d=_i[d]).indexOf(",")&&(d=d.split(",")[0])),m=d in hi)if(this.styles.save(d),"string"===c&&"var(--"===a.substring(0,6)&&(a=Ui(e,a.substring(4,a.indexOf(")"))),o=parseFloat(a)),g||((v=e._gsap).renderTransform&&!t.parseTransform||ur(e,t.parseTransform),y=!1!==t.smoothOrigin&&v.smooth,(g=this._pt=new Wn(this._pt,S,Ii,0,1,v.renderTransform,v,0,-1)).dep=1),"scale"===d)this._pt=new Wn(this._pt,v,"scaleY",v.scaleY,(p?Xe(v.scaleY,p+o):o)-v.scaleY||0,bi),this._pt.u=0,x.push("scaleY",d),d+="X";else{if("transformOrigin"===d){b.push(Di,0,S[Di]),a=tr(a),v.svg?cr(e,a,0,y,0,this):((f=parseFloat(a.split(" ")[2])||0)!==v.zOrigin&&Ki(this,v,"zOrigin",v.zOrigin,f),Ki(this,S,d,dr(s),dr(a)));continue}if("svgOrigin"===d){cr(e,a,1,y,0,this);continue}if(d in sr){_r(this,v,d,l,p?Xe(l,p+a):a);continue}if("smoothOrigin"===d){Ki(this,v,"smooth",v.smooth,a);continue}if("force3D"===d){v[d]=a;continue}if("transform"===d){xr(this,a,e);continue}}else d in S||(d=zi(d)||d);if(m||(o||0===o)&&(l||0===l)&&!yi.test(a)&&d in S)o||(o=0),(h=(s+"").substr((l+"").length))!==(f=Rt(a)||(d in J.units?J.units[d]:h))&&(l=Qi(e,d,s,f)),this._pt=new Wn(this._pt,m?v:S,d,l,(p?Xe(l,p+o):o)-l,m||"px"!==f&&"zIndex"!==d||!1===t.autoRound?bi:Ei),this._pt.u=f||0,h!==f&&"%"!==f&&(this._pt.b=s,this._pt.r=Si);else if(d in S)$i.call(this,e,d,s,p?p+a:a);else if(d in e)this.add(e,d,s||e[d],p?p+a:a,i,r);else if("parseTransform"!==d){Me(d,a);continue}m||(d in S?b.push(d,0,S[d]):"function"===typeof e[d]?b.push(d,2,e[d]()):b.push(d,1,s||e[d])),x.push(d)}_&&Vn(this)},render:function(e,t){if(t.tween._time||!ui())for(var n=t._pt;n;)n.r(e,n.d),n=n._next;else t.styles.revert()},get:Zi,aliases:_i,getSetter:function(e,t,n){var i=_i[t];return i&&i.indexOf(",")<0&&(t=i),t in hi&&t!==Di&&(e._gsap.x||Zi(e,"x"))?n&&ci===n?"scale"===t?Ri:Ci:(ci=n||{})&&("scale"===t?Li:Pi):e.style&&!ce(e.style[t])?Mi:~t.indexOf("-")?Ai:On(e,t)},core:{_removeProperty:Xi,_getMatrix:lr}};ii.utils.checkPrefix=zi,ii.core.getStyleSaver=Fi,function(e,t){var n=We(e+","+t+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(e){hi[e]=1});We(t,function(e){J.units[e]="deg",sr[e]=1}),_i[n[13]]=e+","+t,We("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(e){var t=e.split(":");_i[t[1]]=n[t[0]]})}("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY"),We("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(e){J.units[e]="px"}),ii.registerPlugin(Sr);var Er=ii.registerPlugin(Sr)||ii;Er.core.Tween;function wr(e){return wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wr(e)}function Tr(e){var t=function(e,t){if("object"!=wr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=wr(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==wr(t)?t:t+""}function Mr(e,t,n){return(t=Tr(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ar(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function Cr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ar(Object(n),!0).forEach(function(t){Mr(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ar(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const Rr=["sri"],Lr=["page"],Pr=["page","matches"],Ir=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Dr=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],kr=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var Or="popstate";function Nr(){return Vr(function(e,t){let{pathname:n,search:i,hash:r}=e.location;return Hr("",{pathname:n,search:i,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:zr(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function Fr(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function Br(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function Ur(e,t){return{usr:e.state,key:e.key,idx:t}}function Hr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Cr(Cr({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?Gr(t):t),{},{state:n,key:t&&t.key||i||Math.random().toString(36).substring(2,10)})}function zr(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function Gr(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substring(i),e=e.substring(0,i)),e&&(t.pathname=e)}return t}function Vr(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:r=document.defaultView,v5Compat:s=!1}=i,a=r.history,o="POP",l=null,c=u();function u(){return(a.state||{idx:null}).idx}function d(){o="POP";let e=u(),t=null==e?null:e-c;c=e,l&&l({action:o,location:f.location,delta:t})}function h(e){return Wr(e)}null==c&&(c=0,a.replaceState(Cr(Cr({},a.state),{},{idx:c}),""));let f={get action(){return o},get location(){return e(r,a)},listen(e){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(Or,d),l=e,()=>{r.removeEventListener(Or,d),l=null}},createHref:e=>t(r,e),createURL:h,encodeLocation(e){let t=h(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o="PUSH";let i=Hr(f.location,e,t);n&&n(i,e),c=u()+1;let d=Ur(i,c),h=f.createHref(i);try{a.pushState(d,"",h)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;r.location.assign(h)}s&&l&&l({action:o,location:f.location,delta:1})},replace:function(e,t){o="REPLACE";let i=Hr(f.location,e,t);n&&n(i,e),c=u();let r=Ur(i,c),d=f.createHref(i);a.replaceState(r,"",d),s&&l&&l({action:o,location:f.location,delta:0})},go:e=>a.go(e)};return f}function Wr(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),Fr(n,"No window.location.(origin|href) available to create URL");let i="string"===typeof e?e:zr(e);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=n+i),new URL(i,n)}new WeakMap;function jr(e,t){return Yr(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function Yr(e,t,n,i){let r=os(("string"===typeof t?Gr(t):t).pathname||"/",n);if(null==r)return null;let s=Xr(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let a=null;for(let o=0;null==a&&o<s.length;++o){let e=as(r);a=is(s[o],e,i)}return a}function Xr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=function(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,o=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:s,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(i)&&a)return;Fr(l.relativePath.startsWith(i),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(i,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(i.length)}let c=ms([i,l.relativePath]),u=n.concat(l);e.children&&e.children.length>0&&(Fr(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),Xr(e.children,t,u,c,a)),(null!=e.path||e.index)&&t.push({path:c,score:ns(c,e.index),routesMeta:u})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let i of Kr(e.path))s(e,t,!0,i);else s(e,t)}),t}function Kr(e){let t=e.split("/");if(0===t.length)return[];let[n,...i]=t,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===i.length)return r?[s,""]:[s];let a=Kr(i.join("/")),o=[];return o.push(...a.map(e=>""===e?s:[s,e].join("/"))),r&&o.push(...a),o.map(t=>e.startsWith("/")&&""===t?"/":t)}var qr=/^:[\w-]+$/,Jr=3,Qr=2,Zr=1,$r=10,es=-2,ts=e=>"*"===e;function ns(e,t){let n=e.split("/"),i=n.length;return n.some(ts)&&(i+=es),t&&(i+=Qr),n.filter(e=>!ts(e)).reduce((e,t)=>e+(qr.test(t)?Jr:""===t?Zr:$r),i)}function is(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:i}=e,r={},s="/",a=[];for(let o=0;o<i.length;++o){let e=i[o],l=o===i.length-1,c="/"===s?t:t.slice(s.length)||"/",u=rs({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!i[i.length-1].route.index&&(u=rs({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(r,u.params),a.push({params:r,pathname:ms([s,u.pathname]),pathnameBase:gs(ms([s,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(s=ms([s,u.pathnameBase]))}return a}function rs(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=ss(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let s=r[0],a=s.replace(/(.)\/+$/,"$1"),o=r.slice(1),l=i.reduce((e,t,n)=>{let{paramName:i,isOptional:r}=t;if("*"===i){let e=o[n]||"";a=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[i]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{});return{params:l,pathname:s,pathnameBase:a,pattern:e}}function ss(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Br("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let i=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(i.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(i.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),i]}function as(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return Br(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function os(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&"/"!==i?null:e.slice(n)||"/"}var ls=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,cs=e=>ls.test(e);function us(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}function ds(e,t,n,i){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(i),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function hs(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function fs(e){let t=hs(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function ps(e,t,n){let i,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?i=Gr(e):(i=Cr({},e),Fr(!i.pathname||!i.pathname.includes("?"),ds("?","pathname","search",i)),Fr(!i.pathname||!i.pathname.includes("#"),ds("#","pathname","hash",i)),Fr(!i.search||!i.search.includes("#"),ds("#","search","hash",i)));let s,a=""===e||""===i.pathname,o=a?"/":i.pathname;if(null==o)s=n;else{let e=t.length-1;if(!r&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:i,search:r="",hash:s=""}="string"===typeof e?Gr(e):e;if(i)if(cs(i))t=i;else{if(i.includes("//")){let e=i;i=i.replace(/\/\/+/g,"/"),Br(!1,"Pathnames cannot have embedded double slashes - normalizing ".concat(e," -> ").concat(i))}t=i.startsWith("/")?us(i.substring(1),"/"):us(i,n)}else t=n;return{pathname:t,search:vs(r),hash:ys(s)}}(i,s),c=o&&"/"!==o&&o.endsWith("/"),u=(a||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}var ms=e=>e.join("/").replace(/\/\/+/g,"/"),gs=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),vs=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",ys=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function _s(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}Symbol("Uninstrumented");Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var bs=["POST","PUT","PATCH","DELETE"],xs=(new Set(bs),["GET",...bs]);new Set(xs),Symbol("ResetLoaderData");var Ss=t.createContext(null);Ss.displayName="DataRouter";var Es=t.createContext(null);Es.displayName="DataRouterState";var ws=t.createContext(!1);var Ts=t.createContext({isTransitioning:!1});Ts.displayName="ViewTransition";var Ms=t.createContext(new Map);Ms.displayName="Fetchers";var As=t.createContext(null);As.displayName="Await";var Cs=t.createContext(null);Cs.displayName="Navigation";var Rs=t.createContext(null);Rs.displayName="Location";var Ls=t.createContext({outlet:null,matches:[],isDataRoute:!1});Ls.displayName="Route";var Ps=t.createContext(null);Ps.displayName="RouteError";function Is(){return null!=t.useContext(Rs)}function Ds(){return Fr(Is(),"useLocation() may be used only in the context of a <Router> component."),t.useContext(Rs).location}var ks="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Os(e){t.useContext(Cs).static||t.useLayoutEffect(e)}function Ns(){let{isDataRoute:e}=t.useContext(Ls);return e?function(){let{router:e}=js("useNavigate"),n=Xs("useNavigate"),i=t.useRef(!1);Os(()=>{i.current=!0});let r=t.useCallback(async function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Br(i.current,ks),i.current&&("number"===typeof t?e.navigate(t):await e.navigate(t,Cr({fromRouteId:n},r)))},[e,n]);return r}():function(){Fr(Is(),"useNavigate() may be used only in the context of a <Router> component.");let e=t.useContext(Ss),{basename:n,navigator:i}=t.useContext(Cs),{matches:r}=t.useContext(Ls),{pathname:s}=Ds(),a=JSON.stringify(fs(r)),o=t.useRef(!1);Os(()=>{o.current=!0});let l=t.useCallback(function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Br(o.current,ks),!o.current)return;if("number"===typeof t)return void i.go(t);let l=ps(t,JSON.parse(a),s,"path"===r.relative);null==e&&"/"!==n&&(l.pathname="/"===l.pathname?n:ms([n,l.pathname])),(r.replace?i.replace:i.push)(l,r.state,r)},[n,i,a,s,e]);return l}()}t.createContext(null);function Fs(e){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:i}=t.useContext(Ls),{pathname:r}=Ds(),s=JSON.stringify(fs(i));return t.useMemo(()=>ps(e,JSON.parse(s),r,"path"===n),[e,s,r,n])}function Bs(e,n,i,r,s){Fr(Is(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=t.useContext(Cs),{matches:o}=t.useContext(Ls),l=o[o.length-1],c=l?l.params:{},u=l?l.pathname:"/",d=l?l.pathnameBase:"/",h=l&&l.route;{let e=h&&h.path||"";Js(u,!h||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(u,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let f,p=Ds();if(n){var m;let e="string"===typeof n?Gr(n):n;Fr("/"===d||(null===(m=e.pathname)||void 0===m?void 0:m.startsWith(d)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(d,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),f=e}else f=p;let g=f.pathname||"/",v=g;if("/"!==d){let e=d.replace(/^\//,"").split("/");v="/"+g.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=jr(e,{pathname:v});Br(h||null!=y,'No routes matched location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" ')),Br(null==y||void 0!==y[y.length-1].route.element||void 0!==y[y.length-1].route.Component||void 0!==y[y.length-1].route.lazy,'Matched leaf route at location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let _=Vs(y&&y.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:ms([d,a.encodeLocation?a.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:ms([d,a.encodeLocation?a.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),o,i,r,s);return n&&_?t.createElement(Rs.Provider,{value:{location:Cr({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:"POP"}},_):_}function Us(){let e=Ks(),n=_s(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),i=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=t.createElement(t.Fragment,null,t.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),t.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",t.createElement("code",{style:a},"ErrorBoundary")," or"," ",t.createElement("code",{style:a},"errorElement")," prop on your route.")),t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},n),i?t.createElement("pre",{style:s},i):null,o)}var Hs=t.createElement(Us,null),zs=class extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?t.createElement(Ls.Provider,{value:this.props.routeContext},t.createElement(Ps.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Gs(e){let{routeContext:n,match:i,children:r}=e,s=t.useContext(Ss);return s&&s.static&&s.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=i.route.id),t.createElement(Ls.Provider,{value:n},r)}function Vs(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!i)return null;if(i.errors)e=i.matches;else{if(0!==n.length||i.initialized||!(i.matches.length>0))return null;e=i.matches}}let s=e,a=null===i||void 0===i?void 0:i.errors;if(null!=a){let e=s.findIndex(e=>e.route.id&&void 0!==(null===a||void 0===a?void 0:a[e.route.id]));Fr(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(a).join(","))),s=s.slice(0,Math.min(s.length,e+1))}let o=!1,l=-1;if(i)for(let t=0;t<s.length;t++){let e=s[t];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(l=t),e.route.id){let{loaderData:t,errors:n}=i,r=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!n||void 0===n[e.route.id]);if(e.route.lazy||r){o=!0,s=l>=0?s.slice(0,l+1):[s[0]];break}}}let c=i&&r?(e,t)=>{var n,s;r(e,{location:i.location,params:null!==(n=null===(s=i.matches)||void 0===s||null===(s=s[0])||void 0===s?void 0:s.params)&&void 0!==n?n:{},errorInfo:t})}:void 0;return s.reduceRight((e,r,u)=>{let d,h=!1,f=null,p=null;i&&(d=a&&r.route.id?a[r.route.id]:void 0,f=r.route.errorElement||Hs,o&&(l<0&&0===u?(Js("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,p=null):l===u&&(h=!0,p=r.route.hydrateFallbackElement||null)));let m=n.concat(s.slice(0,u+1)),g=()=>{let n;return n=d?f:h?p:r.route.Component?t.createElement(r.route.Component,null):r.route.element?r.route.element:e,t.createElement(Gs,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=i},children:n})};return i&&(r.route.ErrorBoundary||r.route.errorElement||0===u)?t.createElement(zs,{location:i.location,revalidation:i.revalidation,component:f,error:d,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0},onError:c}):g()},null)}function Ws(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function js(e){let n=t.useContext(Ss);return Fr(n,Ws(e)),n}function Ys(e){let n=t.useContext(Es);return Fr(n,Ws(e)),n}function Xs(e){let n=function(e){let n=t.useContext(Ls);return Fr(n,Ws(e)),n}(e),i=n.matches[n.matches.length-1];return Fr(i.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),i.route.id}function Ks(){var e;let n=t.useContext(Ps),i=Ys("useRouteError"),r=Xs("useRouteError");return void 0!==n?n:null===(e=i.errors)||void 0===e?void 0:e[r]}var qs={};function Js(e,t,n){t||qs[e]||(qs[e]=!0,Br(!1,n))}var Qs={};function Zs(e,t){e||Qs[t]||(Qs[t]=!0,console.warn(t))}t.memo(function(e){let{routes:t,future:n,state:i,unstable_onError:r}=e;return Bs(t,void 0,i,r,n)});function $s(e){Fr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ea(e){let{basename:n="/",children:i=null,location:r,navigationType:s="POP",navigator:a,static:o=!1}=e;Fr(!Is(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),c=t.useMemo(()=>({basename:l,navigator:a,static:o,future:{}}),[l,a,o]);"string"===typeof r&&(r=Gr(r));let{pathname:u="/",search:d="",hash:h="",state:f=null,key:p="default"}=r,m=t.useMemo(()=>{let e=os(u,l);return null==e?null:{location:{pathname:e,search:d,hash:h,state:f,key:p},navigationType:s}},[l,u,d,h,f,p,s]);return Br(null!=m,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(u).concat(d).concat(h,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==m?null:t.createElement(Cs.Provider,{value:c},t.createElement(Rs.Provider,{children:i,value:m}))}function ta(e){let{children:t,location:n}=e;return Bs(na(t),n)}t.Component;function na(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];return t.Children.forEach(e,(e,r)=>{if(!t.isValidElement(e))return;let s=[...n,r];if(e.type===t.Fragment)return void i.push.apply(i,na(e.props.children,s));Fr(e.type===$s,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),Fr(!e.props.index||!e.props.children,"An index route cannot have child routes.");let a={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=na(e.props.children,s)),i.push(a)}),i}var ia="get",ra="application/x-www-form-urlencoded";function sa(e){return null!=e&&"string"===typeof e.tagName}var aa=null;var oa=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function la(e){return null==e||oa.has(e)?e:(Br(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(ra,'"')),null)}function ca(e,t){let n,i,r,s,a;if(sa(o=e)&&"form"===o.tagName.toLowerCase()){let a=e.getAttribute("action");i=a?os(a,t):null,n=e.getAttribute("method")||ia,r=la(e.getAttribute("enctype"))||ra,s=new FormData(e)}else if(function(e){return sa(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return sa(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||a.getAttribute("action");if(i=o?os(o,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||ia,r=la(e.getAttribute("formenctype"))||la(a.getAttribute("enctype"))||ra,s=new FormData(a,e),!function(){if(null===aa)try{new FormData(document.createElement("form"),0),aa=!1}catch(e){aa=!0}return aa}()){let{name:t,type:n,value:i}=e;if("image"===n){let e=t?"".concat(t,"."):"";s.append("".concat(e,"x"),"0"),s.append("".concat(e,"y"),"0")}else t&&s.append(t,i)}}else{if(sa(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=ia,i=null,r=ra,a=e}var o;return s&&"text/plain"===r&&(a=s,s=void 0),{action:i,method:n.toLowerCase(),encType:r,formData:s,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function ua(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function da(e,t,n){let i="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===i.pathname?i.pathname="_root.".concat(n):t&&"/"===os(i.pathname,t)?i.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):i.pathname="".concat(i.pathname.replace(/\/$/,""),".").concat(n),i}async function ha(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function fa(e){return null!=e&&"string"===typeof e.page}function pa(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function ma(e,t,n,i,r,s){let a=(e,t)=>!n[t]||e.route.id!==n[t].route.id,o=(e,t)=>{var i;return n[t].pathname!==e.pathname||(null===(i=n[t].route.path)||void 0===i?void 0:i.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===s?t.filter((e,t)=>a(e,t)||o(e,t)):"data"===s?t.filter((t,s)=>{let l=i.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(a(t,s)||o(t,s))return!0;if(t.route.shouldRevalidate){var c;let i=t.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof i)return i}return!0}):[]}function ga(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i=e.map(e=>{let i=t.routes[e.route.id];if(!i)return[];let r=[i.module];return i.clientActionModule&&(r=r.concat(i.clientActionModule)),i.clientLoaderModule&&(r=r.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(r=r.concat(i.hydrateFallbackModule)),i.imports&&(r=r.concat(i.imports)),r}).flat(1),[...new Set(i)];var i}function va(e,t){let n=new Set,i=new Set(t);return e.reduce((e,r)=>{if(t&&!fa(r)&&"script"===r.as&&r.href&&i.has(r.href))return e;let s=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let i of n)t[i]=e[i];return t}(r));return n.has(s)||(n.add(s),e.push({key:s,link:r})),e},[])}function ya(e,t){return"lazy"===e.mode&&!0===t}function _a(){let e=t.useContext(Ss);return ua(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function ba(){let e=t.useContext(Es);return ua(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var xa=t.createContext(void 0);function Sa(){let e=t.useContext(xa);return ua(e,"You must render this element inside a <HydratedRouter> element"),e}function Ea(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function wa(e,t,n){if(n&&!Ca)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}xa.displayName="FrameworkContext";function Ta(e){let{page:n}=e,i=d(e,Lr),{router:r}=_a(),s=t.useMemo(()=>jr(r.routes,n,r.basename),[r.routes,n,r.basename]);return s?t.createElement(Aa,Cr({page:n,matches:s},i)):null}function Ma(e){let{manifest:n,routeModules:i}=Sa(),[r,s]=t.useState([]);return t.useEffect(()=>{let t=!1;return async function(e,t,n){let i=await Promise.all(e.map(async e=>{let i=t.routes[e.route.id];if(i){let e=await ha(i,n);return e.links?e.links():[]}return[]}));return va(i.flat(1).filter(pa).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?Cr(Cr({},e),{},{rel:"prefetch",as:"style"}):Cr(Cr({},e),{},{rel:"prefetch"})))}(e,n,i).then(e=>{t||s(e)}),()=>{t=!0}},[e,n,i]),r}function Aa(e){let{page:n,matches:i}=e,r=d(e,Pr),s=Ds(),{manifest:a,routeModules:o}=Sa(),{basename:l}=_a(),{loaderData:c,matches:u}=ba(),h=t.useMemo(()=>ma(n,i,u,a,s,"data"),[n,i,u,a,s]),f=t.useMemo(()=>ma(n,i,u,a,s,"assets"),[n,i,u,a,s]),p=t.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let e=new Set,t=!1;if(i.forEach(n=>{var i;let r=a.routes[n.route.id];r&&r.hasLoader&&(!h.some(e=>e.route.id===n.route.id)&&n.route.id in c&&null!==(i=o[n.route.id])&&void 0!==i&&i.shouldRevalidate||r.hasClientLoader?t=!0:e.add(n.route.id))}),0===e.size)return[];let r=da(n,l,"data");return t&&e.size>0&&r.searchParams.set("_routes",i.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[r.pathname+r.search]},[l,c,s,a,h,i,n,o]),m=t.useMemo(()=>ga(f,a),[f,a]),g=Ma(f);return t.createElement(t.Fragment,null,p.map(e=>t.createElement("link",Cr({key:e,rel:"prefetch",as:"fetch",href:e},r))),m.map(e=>t.createElement("link",Cr({key:e,rel:"modulepreload",href:e},r))),g.map(e=>{let{key:n,link:i}=e;return t.createElement("link",Cr({key:n,nonce:r.nonce},i))}))}var Ca=!1;function Ra(e){let{manifest:n,serverHandoffString:i,isSpaMode:r,renderMeta:s,routeDiscovery:a,ssr:o}=Sa(),{router:l,static:c,staticContext:u}=_a(),{matches:h}=ba(),f=t.useContext(ws),p=ya(a,o);s&&(s.didRenderScripts=!0);let m=wa(h,null,r);t.useEffect(()=>{0},[]);let g=t.useMemo(()=>{var r;if(f)return null;let s=u?"window.__reactRouterContext = ".concat(i,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",a=c?"".concat(null!==n.hmr&&void 0!==r&&r.runtime?"import ".concat(JSON.stringify(n.hmr.runtime),";"):"").concat(p?"":"import ".concat(JSON.stringify(n.url)),";\n").concat(m.map((e,t)=>{let i="route".concat(t),r=n.routes[e.route.id];ua(r,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:s,clientLoaderModule:a,clientMiddlewareModule:o,hydrateFallbackModule:l,module:c}=r,u=[...s?[{module:s,varName:"".concat(i,"_clientAction")}]:[],...a?[{module:a,varName:"".concat(i,"_clientLoader")}]:[],...o?[{module:o,varName:"".concat(i,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(i,"_HydrateFallback")}]:[],{module:c,varName:"".concat(i,"_main")}];return 1===u.length?"import * as ".concat(i," from ").concat(JSON.stringify(c),";"):[u.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(i," = {").concat(u.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(p?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,i=d(e,Rr),r=new Set(t.state.matches.map(e=>e.route.id)),s=t.state.location.pathname.split("/").filter(Boolean),a=["/"];for(s.pop();s.length>0;)a.push("/".concat(s.join("/"))),s.pop();a.forEach(e=>{let n=jr(t.routes,e,t.basename);n&&n.forEach(e=>r.add(e.route.id))});let o=[...r].reduce((e,t)=>Object.assign(e,{[t]:i.routes[t]}),{});return Cr(Cr({},i),{},{routes:o,sri:!!n||void 0})}(n,l),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(m.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(n.entry.module),");"):" ";return t.createElement(t.Fragment,null,t.createElement("script",Cr(Cr({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:s},type:void 0})),t.createElement("script",Cr(Cr({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:a},type:"module",async:!0})))},[]),v=Ca||f?[]:(n.entry.imports.concat(ga(m,n,{includeHydrateFallback:!0})),[...new Set(y)]);var y;let _="object"===typeof n.sri?n.sri:{};return Zs(!f,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),Ca||f?null:t.createElement(t.Fragment,null,"object"===typeof n.sri?t.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:_})}}):null,p?null:t.createElement("link",{rel:"modulepreload",href:n.url,crossOrigin:e.crossOrigin,integrity:_[n.url],suppressHydrationWarning:!0}),t.createElement("link",{rel:"modulepreload",href:n.entry.module,crossOrigin:e.crossOrigin,integrity:_[n.entry.module],suppressHydrationWarning:!0}),v.map(n=>t.createElement("link",{key:n,rel:"modulepreload",href:n,crossOrigin:e.crossOrigin,integrity:_[n],suppressHydrationWarning:!0})),g)}function La(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}t.Component;function Pa(e){let{error:n,isOutsideRemixApp:i}=e;console.error(n);let r,s=t.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(_s(n))return t.createElement(Ia,{title:"Unhandled Thrown Response!"},t.createElement("h1",{style:{fontSize:"24px"}},n.status," ",n.statusText),s);if(n instanceof Error)0;else{let e=null==n?"Unknown Error":"object"===typeof n&&"toString"in n?n.toString():JSON.stringify(n);new Error(e)}return t.createElement(Ia,{title:"Application Error!",isOutsideRemixApp:i},t.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),t.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},r.stack),s)}function Ia(e){var n;let{title:i,renderScripts:r,isOutsideRemixApp:s,children:a}=e,{routeModules:o}=Sa();return null!==o.root&&void 0!==n&&n.Layout&&!s?a:t.createElement("html",{lang:"en"},t.createElement("head",null,t.createElement("meta",{charSet:"utf-8"}),t.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),t.createElement("title",null,i)),t.createElement("body",null,t.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},a,r?t.createElement(Ra,null):null)))}var Da="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{Da&&(window.__reactRouterVersion="7.9.6")}catch(kne){}function ka(e){let{basename:n,children:i,window:r}=e,s=t.useRef();null==s.current&&(s.current=Nr({window:r,v5Compat:!0}));let a=s.current,[o,l]=t.useState({action:a.action,location:a.location}),c=t.useCallback(e=>{t.startTransition(()=>l(e))},[l]);return t.useLayoutEffect(()=>a.listen(c),[a,c]),t.createElement(ea,{basename:n,children:i,location:o.location,navigationType:o.action,navigator:a})}var Oa=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Na=t.forwardRef(function(e,n){let i,{onClick:r,discover:s="render",prefetch:a="none",relative:o,reloadDocument:l,replace:c,state:u,target:h,to:f,preventScrollReset:p,viewTransition:m}=e,g=d(e,Ir),{basename:v}=t.useContext(Cs),y="string"===typeof f&&Oa.test(f),_=!1;if("string"===typeof f&&y&&(i=f,Da))try{let e=new URL(window.location.href),t=f.startsWith("//")?new URL(e.protocol+f):new URL(f),n=os(t.pathname,v);t.origin===e.origin&&null!=n?f=n+t.search+t.hash:_=!0}catch(kne){Br(!1,'<Link to="'.concat(f,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let b=function(e){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Fr(Is(),"useHref() may be used only in the context of a <Router> component.");let{basename:i,navigator:r}=t.useContext(Cs),{hash:s,pathname:a,search:o}=Fs(e,{relative:n}),l=a;return"/"!==i&&(l="/"===a?i:ms([i,a])),r.createHref({pathname:l,search:o,hash:s})}(f,{relative:o}),[x,S,E]=function(e,n){let i=t.useContext(xa),[r,s]=t.useState(!1),[a,o]=t.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=n,f=t.useRef(null);t.useEffect(()=>{if("render"===e&&o(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{o(e.isIntersecting)})},{threshold:.5});return f.current&&e.observe(f.current),()=>{e.disconnect()}}},[e]),t.useEffect(()=>{if(r){let e=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(e)}}},[r]);let p=()=>{s(!0)},m=()=>{s(!1),o(!1)};return i?"intent"!==e?[a,f,{}]:[a,f,{onFocus:Ea(l,p),onBlur:Ea(c,m),onMouseEnter:Ea(u,p),onMouseLeave:Ea(d,m),onTouchStart:Ea(h,p)}]:[!1,f,{}]}(a,g),w=function(e){let{target:n,replace:i,state:r,preventScrollReset:s,relative:a,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=Ns(),c=Ds(),u=Fs(e,{relative:a});return t.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==i?i:zr(c)===zr(u);l(e,{replace:n,state:r,preventScrollReset:s,relative:a,viewTransition:o})}},[c,l,u,i,r,n,e,s,a,o])}(f,{replace:c,state:u,target:h,preventScrollReset:p,relative:o,viewTransition:m});let T=t.createElement("a",Cr(Cr(Cr({},g),E),{},{href:i||b,onClick:_||l?r:function(e){r&&r(e),e.defaultPrevented||w(e)},ref:La(n,S),target:h,"data-discover":y||"render"!==s?void 0:"true"}));return x&&!y?t.createElement(t.Fragment,null,T,t.createElement(Ta,{page:b})):T});Na.displayName="Link";var Fa=t.forwardRef(function(e,n){let{"aria-current":i="page",caseSensitive:r=!1,className:s="",end:a=!1,style:o,to:l,viewTransition:c,children:u}=e,h=d(e,Dr),f=Fs(l,{relative:h.relative}),p=Ds(),m=t.useContext(Es),{navigator:g,basename:v}=t.useContext(Cs),y=null!=m&&function(e){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.useContext(Ts);Fr(null!=i,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Ha("useViewTransitionState"),s=Fs(e,{relative:n});if(!i.isTransitioning)return!1;let a=os(i.currentLocation.pathname,r)||i.currentLocation.pathname,o=os(i.nextLocation.pathname,r)||i.nextLocation.pathname;return null!=rs(s.pathname,o)||null!=rs(s.pathname,a)}(f)&&!0===c,_=g.encodeLocation?g.encodeLocation(f).pathname:f.pathname,b=p.pathname,x=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;r||(b=b.toLowerCase(),x=x?x.toLowerCase():null,_=_.toLowerCase()),x&&v&&(x=os(x,v)||x);const S="/"!==_&&_.endsWith("/")?_.length-1:_.length;let E,w=b===_||!a&&b.startsWith(_)&&"/"===b.charAt(S),T=null!=x&&(x===_||!a&&x.startsWith(_)&&"/"===x.charAt(_.length)),M={isActive:w,isPending:T,isTransitioning:y},A=w?i:void 0;E="function"===typeof s?s(M):[s,w?"active":null,T?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let C="function"===typeof o?o(M):o;return t.createElement(Na,Cr(Cr({},h),{},{"aria-current":A,className:E,ref:n,style:C,to:l,viewTransition:c}),"function"===typeof u?u(M):u)});Fa.displayName="NavLink";var Ba=t.forwardRef((e,n)=>{let{discover:i="render",fetcherKey:r,navigate:s,reloadDocument:a,replace:o,state:l,method:c=ia,action:u,onSubmit:h,relative:f,preventScrollReset:p,viewTransition:m}=e,g=d(e,kr),v=Va(),y=function(e){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:i}=t.useContext(Cs),r=t.useContext(Ls);Fr(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),a=Cr({},Fs(e||".",{relative:n})),o=Ds();if(null==e){a.search=o.search;let e=new URLSearchParams(a.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();a.search=n?"?".concat(n):""}}e&&"."!==e||!s.route.index||(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index");"/"!==i&&(a.pathname="/"===a.pathname?i:ms([i,a.pathname]));return zr(a)}(u,{relative:f}),_="get"===c.toLowerCase()?"get":"post",b="string"===typeof u&&Oa.test(u);return t.createElement("form",Cr(Cr({ref:n,method:_,action:y,onSubmit:a?h:e=>{if(h&&h(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||c;v(t||e.currentTarget,{fetcherKey:r,method:n,navigate:s,replace:o,state:l,relative:f,preventScrollReset:p,viewTransition:m})}},g),{},{"data-discover":b||"render"!==i?void 0:"true"}))});function Ua(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Ha(e){let n=t.useContext(Ss);return Fr(n,Ua(e)),n}Ba.displayName="Form";var za=0,Ga=()=>"__".concat(String(++za),"__");function Va(){let{router:e}=Ha("useSubmit"),{basename:n}=t.useContext(Cs),i=Xs("useRouteId");return t.useCallback(async function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:s,method:a,encType:o,formData:l,body:c}=ca(t,n);if(!1===r.navigate){let t=r.fetcherKey||Ga();await e.fetch(t,i,r.action||s,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||a,formEncType:r.encType||o,flushSync:r.flushSync})}else await e.navigate(r.action||s,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||a,formEncType:r.encType||o,replace:r.replace,state:r.state,fromRouteId:i,flushSync:r.flushSync,viewTransition:r.viewTransition})},[e,n,i])}const Wa=()=>{const e=(0,t.useContext)(x),n=(0,t.useContext)(S),i=(0,t.useContext)(E),r=Ns(),d=(0,t.useRef)(null);(0,t.useEffect)(()=>{"hidden"===e[0]?Er.to(d.current,{y:"-100%",duration:.5,ease:"power1.inOut"}):Er.to(d.current,{y:0,duration:.5,ease:"power1.inOut"})},[e[0],d]);const h=e=>{i[1](e),r("/")};return(0,p.jsxs)("header",{ref:d,className:"".concat(s),children:[(0,p.jsxs)("div",{className:o,children:[(0,p.jsx)(N,{className:a}),"home"===e[0]&&(0,p.jsxs)("nav",{className:u,children:[(0,p.jsx)(g,{active:"home"===n[0],title:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f",onClick:()=>h("home")}),(0,p.jsx)(g,{active:"about"===n[0],title:"\u041e \u043d\u0430\u0441",onClick:()=>h("about")}),(0,p.jsx)(g,{active:"acco"===n[0],title:"\u041f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u0435",onClick:()=>h("acco")}),(0,p.jsx)(g,{active:"price"===n[0],title:"\u0426\u0435\u043d\u044b",onClick:()=>h("price")}),(0,p.jsx)(g,{active:"news"===n[0],title:"\u041d\u043e\u0432\u043e\u0441\u0442\u0438",onClick:()=>h("news")})]}),"room"===e[0]&&(0,p.jsxs)("nav",{className:u,children:[(0,p.jsx)(g,{active:!1,title:"< \u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f",onClick:()=>r(-1)}),(0,p.jsx)(g,{active:!1,title:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f",onClick:()=>r("/")}),(0,p.jsx)(g,{active:!0,title:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u043a\u043e\u043c\u043d\u0430\u0442"})]}),"search"===e[0]&&(0,p.jsxs)("nav",{className:u,children:[(0,p.jsx)(g,{active:!1,title:"< \u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f",onClick:()=>r(-1)}),(0,p.jsx)(g,{active:!1,title:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f",onClick:()=>r("/")}),(0,p.jsx)(g,{active:!0,title:"\u041f\u043e\u0438\u0441\u043a \u043d\u043e\u043c\u0435\u0440\u043e\u0432"})]})]}),(0,p.jsx)("div",{className:l,children:(0,p.jsx)(b,{className:c,defaultClassName:!1,title:"\u041f\u043e\u0434\u0430\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443",onClick:()=>{}})})]})};function ja(e){if(null==e)throw new TypeError("Cannot destructure "+e)}const Ya="BuilderSections_main_section__WFjwE",Xa="BuilderSections_container__84DXN",Ka="BuilderSections_ref_navigation__93Gzc",qa="HomeComponent_main__au3F7",Ja="HomeComponent_navigation__aZIt4",Qa="HomeComponent_logo__uIiHq",Za="HomeComponent_header__32Yj+",$a="HomeComponent_header_left__SDO3Q",eo="HomeComponent_header_right__xlLyl",to="HomeComponent_gradient_overlay__DVz7T",no="HomeComponent_description_section__XaNqu",io="HomeComponent_video_background__BY2iN",ro="HomeComponent_content__yC2+Q",so="HomeComponent_description_container__Wy3DL",ao="HomeComponent_paragraph_text__AK9Nw",oo="HomeComponent_description_text__yQdod";function lo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var co,uo,ho,fo,po,mo,go,vo,yo,_o,bo,xo,So,Eo=function(){return co||"undefined"!==typeof window&&(co=window.gsap)&&co.registerPlugin&&co},wo=1,To=[],Mo=[],Ao=[],Co=Date.now,Ro=function(e,t){return t},Lo=function(e,t){return~Ao.indexOf(e)&&Ao[Ao.indexOf(e)+1][t]},Po=function(e){return!!~_o.indexOf(e)},Io=function(e,t,n,i,r){return e.addEventListener(t,n,{passive:!1!==i,capture:!!r})},Do=function(e,t,n,i){return e.removeEventListener(t,n,!!i)},ko="scrollLeft",Oo="scrollTop",No=function(){return bo&&bo.isPressed||Mo.cache++},Fo=function(e,t){var n=function n(i){if(i||0===i){wo&&(ho.history.scrollRestoration="manual");var r=bo&&bo.isPressed;i=n.v=Math.round(i)||(bo&&bo.iOS?1:0),e(i),n.cacheID=Mo.cache,r&&Ro("ss",i)}else(t||Mo.cache!==n.cacheID||Ro("ref"))&&(n.cacheID=Mo.cache,n.v=e());return n.v+n.offset};return n.offset=0,e&&n},Bo={s:ko,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:Fo(function(e){return arguments.length?ho.scrollTo(e,Uo.sc()):ho.pageXOffset||fo[ko]||po[ko]||mo[ko]||0})},Uo={s:Oo,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:Bo,sc:Fo(function(e){return arguments.length?ho.scrollTo(Bo.sc(),e):ho.pageYOffset||fo[Oo]||po[Oo]||mo[Oo]||0})},Ho=function(e,t){return(t&&t._ctx&&t._ctx.selector||co.utils.toArray)(e)[0]||("string"===typeof e&&!1!==co.config().nullTargetWarn?console.warn("Element not found:",e):null)},zo=function(e,t){var n=t.s,i=t.sc;Po(e)&&(e=fo.scrollingElement||po);var r=Mo.indexOf(e),s=i===Uo.sc?1:2;!~r&&(r=Mo.push(e)-1),Mo[r+s]||Io(e,"scroll",No);var a=Mo[r+s],o=a||(Mo[r+s]=Fo(Lo(e,n),!0)||(Po(e)?i:Fo(function(t){return arguments.length?e[n]=t:e[n]})));return o.target=e,a||(o.smooth="smooth"===co.getProperty(e,"scrollBehavior")),o},Go=function(e,t,n){var i=e,r=e,s=Co(),a=s,o=t||50,l=Math.max(500,3*o),c=function(e,t){var l=Co();t||l-s>o?(r=i,i=e,a=s,s=l):n?i+=e:i=r+(e-r)/(l-a)*(s-a)};return{update:c,reset:function(){r=i=n?0:i,a=s=0},getVelocity:function(e){var t=a,o=r,u=Co();return(e||0===e)&&e!==i&&c(e),s===a||u-a>l?0:(i+(n?o:-o))/((n?u:s)-t)*1e3}}},Vo=function(e,t){return t&&!e._gsapAllow&&e.preventDefault(),e.changedTouches?e.changedTouches[0]:e},Wo=function(e){var t=Math.max.apply(Math,e),n=Math.min.apply(Math,e);return Math.abs(t)>=Math.abs(n)?t:n},jo=function(){(yo=co.core.globals().ScrollTrigger)&&yo.core&&function(){var e=yo.core,t=e.bridge||{},n=e._scrollers,i=e._proxies;n.push.apply(n,Mo),i.push.apply(i,Ao),Mo=n,Ao=i,Ro=function(e,n){return t[e](n)}}()},Yo=function(e){return co=e||Eo(),!uo&&co&&"undefined"!==typeof document&&document.body&&(ho=window,fo=document,po=fo.documentElement,mo=fo.body,_o=[ho,fo,po,mo],co.utils.clamp,So=co.core.context||function(){},vo="onpointerenter"in mo?"pointer":"mouse",go=Xo.isTouch=ho.matchMedia&&ho.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in ho||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,xo=Xo.eventTypes=("ontouchstart"in po?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in po?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return wo=0},500),jo(),uo=1),uo};Bo.op=Uo,Mo.cache=0;var Xo=function(){function e(e){this.init(e)}var t,n,i;return e.prototype.init=function(e){uo||Yo(co)||console.warn("Please gsap.registerPlugin(Observer)"),yo||jo();var t=e.tolerance,n=e.dragMinimum,i=e.type,r=e.target,s=e.lineHeight,a=e.debounce,o=e.preventDefault,l=e.onStop,c=e.onStopDelay,u=e.ignore,d=e.wheelSpeed,h=e.event,f=e.onDragStart,p=e.onDragEnd,m=e.onDrag,g=e.onPress,v=e.onRelease,y=e.onRight,_=e.onLeft,b=e.onUp,x=e.onDown,S=e.onChangeX,E=e.onChangeY,w=e.onChange,T=e.onToggleX,M=e.onToggleY,A=e.onHover,C=e.onHoverEnd,R=e.onMove,L=e.ignoreCheck,P=e.isNormalizer,I=e.onGestureStart,D=e.onGestureEnd,k=e.onWheel,O=e.onEnable,N=e.onDisable,F=e.onClick,B=e.scrollSpeed,U=e.capture,H=e.allowClicks,z=e.lockAxis,G=e.onLockAxis;this.target=r=Ho(r)||po,this.vars=e,u&&(u=co.utils.toArray(u)),t=t||1e-9,n=n||0,d=d||1,B=B||1,i=i||"wheel,touch,pointer",a=!1!==a,s||(s=parseFloat(ho.getComputedStyle(mo).lineHeight)||22);var V,W,j,Y,X,K,q,J=this,Q=0,Z=0,$=e.passive||!o&&!1!==e.passive,ee=zo(r,Bo),te=zo(r,Uo),ne=ee(),ie=te(),re=~i.indexOf("touch")&&!~i.indexOf("pointer")&&"pointerdown"===xo[0],se=Po(r),ae=r.ownerDocument||fo,oe=[0,0,0],le=[0,0,0],ce=0,ue=function(){return ce=Co()},de=function(e,t){return(J.event=e)&&u&&function(e,t){for(var n=t.length;n--;)if(t[n]===e||t[n].contains(e))return!0;return!1}(e.target,u)||t&&re&&"touch"!==e.pointerType||L&&L(e,t)},he=function(){var e=J.deltaX=Wo(oe),n=J.deltaY=Wo(le),i=Math.abs(e)>=t,r=Math.abs(n)>=t;w&&(i||r)&&w(J,e,n,oe,le),i&&(y&&J.deltaX>0&&y(J),_&&J.deltaX<0&&_(J),S&&S(J),T&&J.deltaX<0!==Q<0&&T(J),Q=J.deltaX,oe[0]=oe[1]=oe[2]=0),r&&(x&&J.deltaY>0&&x(J),b&&J.deltaY<0&&b(J),E&&E(J),M&&J.deltaY<0!==Z<0&&M(J),Z=J.deltaY,le[0]=le[1]=le[2]=0),(Y||j)&&(R&&R(J),j&&(f&&1===j&&f(J),m&&m(J),j=0),Y=!1),K&&!(K=!1)&&G&&G(J),X&&(k(J),X=!1),V=0},fe=function(e,t,n){oe[n]+=e,le[n]+=t,J._vx.update(e),J._vy.update(t),a?V||(V=requestAnimationFrame(he)):he()},pe=function(e,t){z&&!q&&(J.axis=q=Math.abs(e)>Math.abs(t)?"x":"y",K=!0),"y"!==q&&(oe[2]+=e,J._vx.update(e,!0)),"x"!==q&&(le[2]+=t,J._vy.update(t,!0)),a?V||(V=requestAnimationFrame(he)):he()},me=function(e){if(!de(e,1)){var t=(e=Vo(e,o)).clientX,i=e.clientY,r=t-J.x,s=i-J.y,a=J.isDragging;J.x=t,J.y=i,(a||(r||s)&&(Math.abs(J.startX-t)>=n||Math.abs(J.startY-i)>=n))&&(j=a?2:1,a||(J.isDragging=!0),pe(r,s))}},ge=J.onPress=function(e){de(e,1)||e&&e.button||(J.axis=q=null,W.pause(),J.isPressed=!0,e=Vo(e),Q=Z=0,J.startX=J.x=e.clientX,J.startY=J.y=e.clientY,J._vx.reset(),J._vy.reset(),Io(P?r:ae,xo[1],me,$,!0),J.deltaX=J.deltaY=0,g&&g(J))},ve=J.onRelease=function(e){if(!de(e,1)){Do(P?r:ae,xo[1],me,!0);var t=!isNaN(J.y-J.startY),n=J.isDragging,i=n&&(Math.abs(J.x-J.startX)>3||Math.abs(J.y-J.startY)>3),s=Vo(e);!i&&t&&(J._vx.reset(),J._vy.reset(),o&&H&&co.delayedCall(.08,function(){if(Co()-ce>300&&!e.defaultPrevented)if(e.target.click)e.target.click();else if(ae.createEvent){var t=ae.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,ho,1,s.screenX,s.screenY,s.clientX,s.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(t)}})),J.isDragging=J.isGesturing=J.isPressed=!1,l&&n&&!P&&W.restart(!0),j&&he(),p&&n&&p(J),v&&v(J,i)}},ye=function(e){return e.touches&&e.touches.length>1&&(J.isGesturing=!0)&&I(e,J.isDragging)},_e=function(){return(J.isGesturing=!1)||D(J)},be=function(e){if(!de(e)){var t=ee(),n=te();fe((t-ne)*B,(n-ie)*B,1),ne=t,ie=n,l&&W.restart(!0)}},xe=function(e){if(!de(e)){e=Vo(e,o),k&&(X=!0);var t=(1===e.deltaMode?s:2===e.deltaMode?ho.innerHeight:1)*d;fe(e.deltaX*t,e.deltaY*t,0),l&&!P&&W.restart(!0)}},Se=function(e){if(!de(e)){var t=e.clientX,n=e.clientY,i=t-J.x,r=n-J.y;J.x=t,J.y=n,Y=!0,l&&W.restart(!0),(i||r)&&pe(i,r)}},Ee=function(e){J.event=e,A(J)},we=function(e){J.event=e,C(J)},Te=function(e){return de(e)||Vo(e,o)&&F(J)};W=J._dc=co.delayedCall(c||.25,function(){J._vx.reset(),J._vy.reset(),W.pause(),l&&l(J)}).pause(),J.deltaX=J.deltaY=0,J._vx=Go(0,50,!0),J._vy=Go(0,50,!0),J.scrollX=ee,J.scrollY=te,J.isDragging=J.isGesturing=J.isPressed=!1,So(this),J.enable=function(e){return J.isEnabled||(Io(se?ae:r,"scroll",No),i.indexOf("scroll")>=0&&Io(se?ae:r,"scroll",be,$,U),i.indexOf("wheel")>=0&&Io(r,"wheel",xe,$,U),(i.indexOf("touch")>=0&&go||i.indexOf("pointer")>=0)&&(Io(r,xo[0],ge,$,U),Io(ae,xo[2],ve),Io(ae,xo[3],ve),H&&Io(r,"click",ue,!0,!0),F&&Io(r,"click",Te),I&&Io(ae,"gesturestart",ye),D&&Io(ae,"gestureend",_e),A&&Io(r,vo+"enter",Ee),C&&Io(r,vo+"leave",we),R&&Io(r,vo+"move",Se)),J.isEnabled=!0,J.isDragging=J.isGesturing=J.isPressed=Y=j=!1,J._vx.reset(),J._vy.reset(),ne=ee(),ie=te(),e&&e.type&&ge(e),O&&O(J)),J},J.disable=function(){J.isEnabled&&(To.filter(function(e){return e!==J&&Po(e.target)}).length||Do(se?ae:r,"scroll",No),J.isPressed&&(J._vx.reset(),J._vy.reset(),Do(P?r:ae,xo[1],me,!0)),Do(se?ae:r,"scroll",be,U),Do(r,"wheel",xe,U),Do(r,xo[0],ge,U),Do(ae,xo[2],ve),Do(ae,xo[3],ve),Do(r,"click",ue,!0),Do(r,"click",Te),Do(ae,"gesturestart",ye),Do(ae,"gestureend",_e),Do(r,vo+"enter",Ee),Do(r,vo+"leave",we),Do(r,vo+"move",Se),J.isEnabled=J.isPressed=J.isDragging=!1,N&&N(J))},J.kill=J.revert=function(){J.disable();var e=To.indexOf(J);e>=0&&To.splice(e,1),bo===J&&(bo=0)},To.push(J),P&&Po(r)&&(bo=J),J.enable(h)},t=e,(n=[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}])&&lo(t.prototype,n),i&&lo(t,i),e}();Xo.version="3.13.0",Xo.create=function(e){return new Xo(e)},Xo.register=Yo,Xo.getAll=function(){return To.slice()},Xo.getById=function(e){return To.filter(function(t){return t.vars.id===e})[0]},Eo()&&co.registerPlugin(Xo);var Ko,qo,Jo,Qo,Zo,$o,el,tl,nl,il,rl,sl,al,ol,ll,cl,ul,dl,hl,fl,pl,ml,gl,vl,yl,_l,bl,xl,Sl,El,wl,Tl,Ml,Al,Cl,Rl,Ll,Pl,Il=1,Dl=Date.now,kl=Dl(),Ol=0,Nl=0,Fl=function(e,t,n){var i=Ql(e)&&("clamp("===e.substr(0,6)||e.indexOf("max")>-1);return n["_"+t+"Clamp"]=i,i?e.substr(6,e.length-7):e},Bl=function(e,t){return!t||Ql(e)&&"clamp("===e.substr(0,6)?e:"clamp("+e+")"},Ul=function e(){return Nl&&requestAnimationFrame(e)},Hl=function(){return ol=1},zl=function(){return ol=0},Gl=function(e){return e},Vl=function(e){return Math.round(1e5*e)/1e5||0},Wl=function(){return"undefined"!==typeof window},jl=function(){return Ko||Wl()&&(Ko=window.gsap)&&Ko.registerPlugin&&Ko},Yl=function(e){return!!~el.indexOf(e)},Xl=function(e){return("Height"===e?wl:Jo["inner"+e])||Zo["client"+e]||$o["client"+e]},Kl=function(e){return Lo(e,"getBoundingClientRect")||(Yl(e)?function(){return ou.width=Jo.innerWidth,ou.height=wl,ou}:function(){return bc(e)})},ql=function(e,t){var n=t.s,i=t.d2,r=t.d,s=t.a;return Math.max(0,(n="scroll"+i)&&(s=Lo(e,n))?s()-Kl(e)()[r]:Yl(e)?(Zo[n]||$o[n])-Xl(i):e[n]-e["offset"+i])},Jl=function(e,t){for(var n=0;n<hl.length;n+=3)(!t||~t.indexOf(hl[n+1]))&&e(hl[n],hl[n+1],hl[n+2])},Ql=function(e){return"string"===typeof e},Zl=function(e){return"function"===typeof e},$l=function(e){return"number"===typeof e},ec=function(e){return"object"===typeof e},tc=function(e,t,n){return e&&e.progress(t?0:1)&&n&&e.pause()},nc=function(e,t){if(e.enabled){var n=e._ctx?e._ctx.add(function(){return t(e)}):t(e);n&&n.totalTime&&(e.callbackAnimation=n)}},ic=Math.abs,rc="left",sc="right",ac="bottom",oc="width",lc="height",cc="Right",uc="Left",dc="Top",hc="Bottom",fc="padding",pc="margin",mc="Width",gc="Height",vc="px",yc=function(e){return Jo.getComputedStyle(e)},_c=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},bc=function(e,t){var n=t&&"matrix(1, 0, 0, 1, 0, 0)"!==yc(e)[ll]&&Ko.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),i=e.getBoundingClientRect();return n&&n.progress(0).kill(),i},xc=function(e,t){var n=t.d2;return e["offset"+n]||e["client"+n]||0},Sc=function(e){var t,n=[],i=e.labels,r=e.duration();for(t in i)n.push(i[t]/r);return n},Ec=function(e){var t=Ko.utils.snap(e),n=Array.isArray(e)&&e.slice(0).sort(function(e,t){return e-t});return n?function(e,i,r){var s;if(void 0===r&&(r=.001),!i)return t(e);if(i>0){for(e-=r,s=0;s<n.length;s++)if(n[s]>=e)return n[s];return n[s-1]}for(s=n.length,e+=r;s--;)if(n[s]<=e)return n[s];return n[0]}:function(n,i,r){void 0===r&&(r=.001);var s=t(n);return!i||Math.abs(s-n)<r||s-n<0===i<0?s:t(i<0?n-e:n+e)}},wc=function(e,t,n,i){return n.split(",").forEach(function(n){return e(t,n,i)})},Tc=function(e,t,n,i,r){return e.addEventListener(t,n,{passive:!i,capture:!!r})},Mc=function(e,t,n,i){return e.removeEventListener(t,n,!!i)},Ac=function(e,t,n){(n=n&&n.wheelHandler)&&(e(t,"wheel",n),e(t,"touchmove",n))},Cc={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},Rc={toggleActions:"play",anticipatePin:0},Lc={top:0,left:0,center:.5,bottom:1,right:1},Pc=function(e,t){if(Ql(e)){var n=e.indexOf("="),i=~n?+(e.charAt(n-1)+1)*parseFloat(e.substr(n+1)):0;~n&&(e.indexOf("%")>n&&(i*=t/100),e=e.substr(0,n-1)),e=i+(e in Lc?Lc[e]*t:~e.indexOf("%")?parseFloat(e)*t/100:parseFloat(e)||0)}return e},Ic=function(e,t,n,i,r,s,a,o){var l=r.startColor,c=r.endColor,u=r.fontSize,d=r.indent,h=r.fontWeight,f=Qo.createElement("div"),p=Yl(n)||"fixed"===Lo(n,"pinType"),m=-1!==e.indexOf("scroller"),g=p?$o:n,v=-1!==e.indexOf("start"),y=v?l:c,_="border-color:"+y+";font-size:"+u+";color:"+y+";font-weight:"+h+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return _+="position:"+((m||o)&&p?"fixed;":"absolute;"),(m||o||!p)&&(_+=(i===Uo?sc:ac)+":"+(s+parseFloat(d))+"px;"),a&&(_+="box-sizing:border-box;text-align:left;width:"+a.offsetWidth+"px;"),f._isStart=v,f.setAttribute("class","gsap-marker-"+e+(t?" marker-"+t:"")),f.style.cssText=_,f.innerText=t||0===t?e+"-"+t:e,g.children[0]?g.insertBefore(f,g.children[0]):g.appendChild(f),f._offset=f["offset"+i.op.d2],Dc(f,0,i,v),f},Dc=function(e,t,n,i){var r={display:"block"},s=n[i?"os2":"p2"],a=n[i?"p2":"os2"];e._isFlipped=i,r[n.a+"Percent"]=i?-100:0,r[n.a]=i?"1px":0,r["border"+s+mc]=1,r["border"+a+mc]=0,r[n.p]=t+"px",Ko.set(e,r)},kc=[],Oc={},Nc=function(){return Dl()-Ol>34&&(Cl||(Cl=requestAnimationFrame(eu)))},Fc=function(){(!gl||!gl.isPressed||gl.startX>$o.clientWidth)&&(Mo.cache++,gl?Cl||(Cl=requestAnimationFrame(eu)):eu(),Ol||Vc("scrollStart"),Ol=Dl())},Bc=function(){_l=Jo.innerWidth,yl=Jo.innerHeight},Uc=function(e){Mo.cache++,(!0===e||!al&&!ml&&!Qo.fullscreenElement&&!Qo.webkitFullscreenElement&&(!vl||_l!==Jo.innerWidth||Math.abs(Jo.innerHeight-yl)>.25*Jo.innerHeight))&&tl.restart(!0)},Hc={},zc=[],Gc=function e(){return Mc(pu,"scrollEnd",e)||Qc(!0)},Vc=function(e){return Hc[e]&&Hc[e].map(function(e){return e()})||zc},Wc=[],jc=function(e){for(var t=0;t<Wc.length;t+=5)(!e||Wc[t+4]&&Wc[t+4].query===e)&&(Wc[t].style.cssText=Wc[t+1],Wc[t].getBBox&&Wc[t].setAttribute("transform",Wc[t+2]||""),Wc[t+3].uncache=1)},Yc=function(e,t){var n;for(cl=0;cl<kc.length;cl++)!(n=kc[cl])||t&&n._ctx!==t||(e?n.kill(1):n.revert(!0,!0));Tl=!0,t&&jc(t),t||Vc("revert")},Xc=function(e,t){Mo.cache++,(t||!Rl)&&Mo.forEach(function(e){return Zl(e)&&e.cacheID++&&(e.rec=0)}),Ql(e)&&(Jo.history.scrollRestoration=Sl=e)},Kc=0,qc=function(){$o.appendChild(El),wl=!gl&&El.offsetHeight||Jo.innerHeight,$o.removeChild(El)},Jc=function(e){return nl(".gsap-marker-start, .gsap-marker-end, .gsap-marker-scroller-start, .gsap-marker-scroller-end").forEach(function(t){return t.style.display=e?"none":"block"})},Qc=function(e,t){if(Zo=Qo.documentElement,$o=Qo.body,el=[Jo,Qo,Zo,$o],!Ol||e||Tl){qc(),Rl=pu.isRefreshing=!0,Mo.forEach(function(e){return Zl(e)&&++e.cacheID&&(e.rec=e())});var n=Vc("refreshInit");fl&&pu.sort(),t||Yc(),Mo.forEach(function(e){Zl(e)&&(e.smooth&&(e.target.style.scrollBehavior="auto"),e(0))}),kc.slice(0).forEach(function(e){return e.refresh()}),Tl=!1,kc.forEach(function(e){if(e._subPinOffset&&e.pin){var t=e.vars.horizontal?"offsetWidth":"offsetHeight",n=e.pin[t];e.revert(!0,1),e.adjustPinSpacing(e.pin[t]-n),e.refresh()}}),Ml=1,Jc(!0),kc.forEach(function(e){var t=ql(e.scroller,e._dir),n="max"===e.vars.end||e._endClamp&&e.end>t,i=e._startClamp&&e.start>=t;(n||i)&&e.setPositions(i?t-1:e.start,n?Math.max(i?t:e.start+1,t):e.end,!0)}),Jc(!1),Ml=0,n.forEach(function(e){return e&&e.render&&e.render(-1)}),Mo.forEach(function(e){Zl(e)&&(e.smooth&&requestAnimationFrame(function(){return e.target.style.scrollBehavior="smooth"}),e.rec&&e(e.rec))}),Xc(Sl,1),tl.pause(),Kc++,Rl=2,eu(2),kc.forEach(function(e){return Zl(e.vars.onRefresh)&&e.vars.onRefresh(e)}),Rl=pu.isRefreshing=!1,Vc("refresh")}else Tc(pu,"scrollEnd",Gc)},Zc=0,$c=1,eu=function(e){if(2===e||!Rl&&!Tl){pu.isUpdating=!0,Pl&&Pl.update(0);var t=kc.length,n=Dl(),i=n-kl>=50,r=t&&kc[0].scroll();if($c=Zc>r?-1:1,Rl||(Zc=r),i&&(Ol&&!ol&&n-Ol>200&&(Ol=0,Vc("scrollEnd")),rl=kl,kl=n),$c<0){for(cl=t;cl-- >0;)kc[cl]&&kc[cl].update(0,i);$c=1}else for(cl=0;cl<t;cl++)kc[cl]&&kc[cl].update(0,i);pu.isUpdating=!1}Cl=0},tu=[rc,"top",ac,sc,pc+hc,pc+cc,pc+dc,pc+uc,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],nu=tu.concat([oc,lc,"boxSizing","max"+mc,"max"+gc,"position",pc,fc,fc+dc,fc+cc,fc+hc,fc+uc]),iu=function(e,t,n,i){if(!e._gsap.swappedIn){for(var r,s=tu.length,a=t.style,o=e.style;s--;)a[r=tu[s]]=n[r];a.position="absolute"===n.position?"absolute":"relative","inline"===n.display&&(a.display="inline-block"),o[ac]=o[sc]="auto",a.flexBasis=n.flexBasis||"auto",a.overflow="visible",a.boxSizing="border-box",a[oc]=xc(e,Bo)+vc,a[lc]=xc(e,Uo)+vc,a[fc]=o[pc]=o.top=o[rc]="0",su(i),o[oc]=o["max"+mc]=n[oc],o[lc]=o["max"+gc]=n[lc],o[fc]=n[fc],e.parentNode!==t&&(e.parentNode.insertBefore(t,e),t.appendChild(e)),e._gsap.swappedIn=!0}},ru=/([A-Z])/g,su=function(e){if(e){var t,n,i=e.t.style,r=e.length,s=0;for((e.t._gsap||Ko.core.getCache(e.t)).uncache=1;s<r;s+=2)n=e[s+1],t=e[s],n?i[t]=n:i[t]&&i.removeProperty(t.replace(ru,"-$1").toLowerCase())}},au=function(e){for(var t=nu.length,n=e.style,i=[],r=0;r<t;r++)i.push(nu[r],n[nu[r]]);return i.t=e,i},ou={left:0,top:0},lu=function(e,t,n,i,r,s,a,o,l,c,u,d,h,f){Zl(e)&&(e=e(o)),Ql(e)&&"max"===e.substr(0,3)&&(e=d+("="===e.charAt(4)?Pc("0"+e.substr(3),n):0));var p,m,g,v=h?h.time():0;if(h&&h.seek(0),isNaN(e)||(e=+e),$l(e))h&&(e=Ko.utils.mapRange(h.scrollTrigger.start,h.scrollTrigger.end,0,d,e)),a&&Dc(a,n,i,!0);else{Zl(t)&&(t=t(o));var y,_,b,x,S=(e||"0").split(" ");g=Ho(t,o)||$o,(y=bc(g)||{})&&(y.left||y.top)||"none"!==yc(g).display||(x=g.style.display,g.style.display="block",y=bc(g),x?g.style.display=x:g.style.removeProperty("display")),_=Pc(S[0],y[i.d]),b=Pc(S[1]||"0",n),e=y[i.p]-l[i.p]-c+_+r-b,a&&Dc(a,b,i,n-b<20||a._isStart&&b>20),n-=n-b}if(f&&(o[f]=e||-.001,e<0&&(e=0)),s){var E=e+n,w=s._isStart;p="scroll"+i.d2,Dc(s,E,i,w&&E>20||!w&&(u?Math.max($o[p],Zo[p]):s.parentNode[p])<=E+1),u&&(l=bc(a),u&&(s.style[i.op.p]=l[i.op.p]-i.op.m-s._offset+vc))}return h&&g&&(p=bc(g),h.seek(d),m=bc(g),h._caScrollDist=p[i.p]-m[i.p],e=e/h._caScrollDist*d),h&&h.seek(v),h?e:Math.round(e)},cu=/(webkit|moz|length|cssText|inset)/i,uu=function(e,t,n,i){if(e.parentNode!==t){var r,s,a=e.style;if(t===$o){for(r in e._stOrig=a.cssText,s=yc(e))+r||cu.test(r)||!s[r]||"string"!==typeof a[r]||"0"===r||(a[r]=s[r]);a.top=n,a.left=i}else a.cssText=e._stOrig;Ko.core.getCache(e).uncache=1,t.appendChild(e)}},du=function(e,t,n){var i=t,r=i;return function(t){var s=Math.round(e());return s!==i&&s!==r&&Math.abs(s-i)>3&&Math.abs(s-r)>3&&(t=s,n&&n()),r=i,i=Math.round(t)}},hu=function(e,t,n){var i={};i[t.p]="+="+n,Ko.set(e,i)},fu=function(e,t){var n=zo(e,t),i="_scroll"+t.p2,r=function t(r,s,a,o,l){var c=t.tween,u=s.onComplete,d={};a=a||n();var h=du(n,a,function(){c.kill(),t.tween=0});return l=o&&l||0,o=o||r-a,c&&c.kill(),s[i]=r,s.inherit=!1,s.modifiers=d,d[i]=function(){return h(a+o*c.ratio+l*c.ratio*c.ratio)},s.onUpdate=function(){Mo.cache++,t.tween&&eu()},s.onComplete=function(){t.tween=0,u&&u.call(c)},c=t.tween=Ko.to(e,s)};return e[i]=n,n.wheelHandler=function(){return r.tween&&r.tween.kill()&&(r.tween=0)},Tc(e,"wheel",n.wheelHandler),pu.isTouch&&Tc(e,"touchmove",n.wheelHandler),r},pu=function(){function e(t,n){qo||e.register(Ko)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),xl(this),this.init(t,n)}return e.prototype.init=function(t,n){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),Nl){var i,r,s,a,o,l,c,u,d,h,f,p,m,g,v,y,_,b,x,S,E,w,T,M,A,C,R,L,P,I,D,k,O,N,F,B,U,H,z,G,V=t=_c(Ql(t)||$l(t)||t.nodeType?{trigger:t}:t,Rc),W=V.onUpdate,j=V.toggleClass,Y=V.id,X=V.onToggle,K=V.onRefresh,q=V.scrub,J=V.trigger,Q=V.pin,Z=V.pinSpacing,$=V.invalidateOnRefresh,ee=V.anticipatePin,te=V.onScrubComplete,ne=V.onSnapComplete,ie=V.once,re=V.snap,se=V.pinReparent,ae=V.pinSpacer,oe=V.containerAnimation,le=V.fastScrollEnd,ce=V.preventOverlaps,ue=t.horizontal||t.containerAnimation&&!1!==t.horizontal?Bo:Uo,de=!q&&0!==q,he=Ho(t.scroller||Jo),fe=Ko.core.getCache(he),pe=Yl(he),me="fixed"===("pinType"in t?t.pinType:Lo(he,"pinType")||pe&&"fixed"),ge=[t.onEnter,t.onLeave,t.onEnterBack,t.onLeaveBack],ve=de&&t.toggleActions.split(" "),ye="markers"in t?t.markers:Rc.markers,_e=pe?0:parseFloat(yc(he)["border"+ue.p2+mc])||0,be=this,xe=t.onRefreshInit&&function(){return t.onRefreshInit(be)},Se=function(e,t,n){var i=n.d,r=n.d2,s=n.a;return(s=Lo(e,"getBoundingClientRect"))?function(){return s()[i]}:function(){return(t?Xl(r):e["client"+r])||0}}(he,pe,ue),Ee=function(e,t){return!t||~Ao.indexOf(e)?Kl(e):function(){return ou}}(he,pe),we=0,Te=0,Me=0,Ae=zo(he,ue);if(be._startClamp=be._endClamp=!1,be._dir=ue,ee*=45,be.scroller=he,be.scroll=oe?oe.time.bind(oe):Ae,a=Ae(),be.vars=t,n=n||t.animation,"refreshPriority"in t&&(fl=1,-9999===t.refreshPriority&&(Pl=be)),fe.tweenScroll=fe.tweenScroll||{top:fu(he,Uo),left:fu(he,Bo)},be.tweenTo=i=fe.tweenScroll[ue.p],be.scrubDuration=function(e){(O=$l(e)&&e)?k?k.duration(e):k=Ko.to(n,{ease:"expo",totalProgress:"+=0",inherit:!1,duration:O,paused:!0,onComplete:function(){return te&&te(be)}}):(k&&k.progress(1).kill(),k=0)},n&&(n.vars.lazy=!1,n._initted&&!be.isReverted||!1!==n.vars.immediateRender&&!1!==t.immediateRender&&n.duration()&&n.render(0,!0,!0),be.animation=n.pause(),n.scrollTrigger=be,be.scrubDuration(q),I=0,Y||(Y=n.vars.id)),re&&(ec(re)&&!re.push||(re={snapTo:re}),"scrollBehavior"in $o.style&&Ko.set(pe?[$o,Zo]:he,{scrollBehavior:"auto"}),Mo.forEach(function(e){return Zl(e)&&e.target===(pe?Qo.scrollingElement||Zo:he)&&(e.smooth=!1)}),s=Zl(re.snapTo)?re.snapTo:"labels"===re.snapTo?function(e){return function(t){return Ko.utils.snap(Sc(e),t)}}(n):"labelsDirectional"===re.snapTo?(G=n,function(e,t){return Ec(Sc(G))(e,t.direction)}):!1!==re.directional?function(e,t){return Ec(re.snapTo)(e,Dl()-Te<500?0:t.direction)}:Ko.utils.snap(re.snapTo),N=re.duration||{min:.1,max:2},N=ec(N)?il(N.min,N.max):il(N,N),F=Ko.delayedCall(re.delay||O/2||.1,function(){var e=Ae(),t=Dl()-Te<500,r=i.tween;if(!(t||Math.abs(be.getVelocity())<10)||r||ol||we===e)be.isActive&&we!==e&&F.restart(!0);else{var a,o,u=(e-l)/g,d=n&&!de?n.totalProgress():u,h=t?0:(d-D)/(Dl()-rl)*1e3||0,f=Ko.utils.clamp(-u,1-u,ic(h/2)*h/.185),p=u+(!1===re.inertia?0:f),m=re,v=m.onStart,y=m.onInterrupt,_=m.onComplete;if(a=s(p,be),$l(a)||(a=p),o=Math.max(0,Math.round(l+a*g)),e<=c&&e>=l&&o!==e){if(r&&!r._initted&&r.data<=ic(o-e))return;!1===re.inertia&&(f=a-u),i(o,{duration:N(ic(.185*Math.max(ic(p-d),ic(a-d))/h/.05||0)),ease:re.ease||"power3",data:ic(o-e),onInterrupt:function(){return F.restart(!0)&&y&&y(be)},onComplete:function(){be.update(),we=Ae(),n&&!de&&(k?k.resetTo("totalProgress",a,n._tTime/n._tDur):n.progress(a)),I=D=n&&!de?n.totalProgress():be.progress,ne&&ne(be),_&&_(be)}},e,f*g,o-e-f*g),v&&v(be,i.tween)}}}).pause()),Y&&(Oc[Y]=be),(z=(J=be.trigger=Ho(J||!0!==Q&&Q))&&J._gsap&&J._gsap.stRevert)&&(z=z(be)),Q=!0===Q?J:Ho(Q),Ql(j)&&(j={targets:J,className:j}),Q&&(!1===Z||Z===pc||(Z=!(!Z&&Q.parentNode&&Q.parentNode.style&&"flex"===yc(Q.parentNode).display)&&fc),be.pin=Q,(r=Ko.core.getCache(Q)).spacer?v=r.pinState:(ae&&((ae=Ho(ae))&&!ae.nodeType&&(ae=ae.current||ae.nativeElement),r.spacerIsNative=!!ae,ae&&(r.spacerState=au(ae))),r.spacer=b=ae||Qo.createElement("div"),b.classList.add("pin-spacer"),Y&&b.classList.add("pin-spacer-"+Y),r.pinState=v=au(Q)),!1!==t.force3D&&Ko.set(Q,{force3D:!0}),be.spacer=b=r.spacer,P=yc(Q),M=P[Z+ue.os2],S=Ko.getProperty(Q),E=Ko.quickSetter(Q,ue.a,vc),iu(Q,b,P),_=au(Q)),ye){p=ec(ye)?_c(ye,Cc):Cc,h=Ic("scroller-start",Y,he,ue,p,0),f=Ic("scroller-end",Y,he,ue,p,0,h),x=h["offset"+ue.op.d2];var Ce=Ho(Lo(he,"content")||he);u=this.markerStart=Ic("start",Y,Ce,ue,p,x,0,oe),d=this.markerEnd=Ic("end",Y,Ce,ue,p,x,0,oe),oe&&(H=Ko.quickSetter([u,d],ue.a,vc)),me||Ao.length&&!0===Lo(he,"fixedMarkers")||(!function(e){var t=yc(e).position;e.style.position="absolute"===t||"fixed"===t?t:"relative"}(pe?$o:he),Ko.set([h,f],{force3D:!0}),C=Ko.quickSetter(h,ue.a,vc),L=Ko.quickSetter(f,ue.a,vc))}if(oe){var Re=oe.vars.onUpdate,Le=oe.vars.onUpdateParams;oe.eventCallback("onUpdate",function(){be.update(0,0,1),Re&&Re.apply(oe,Le||[])})}if(be.previous=function(){return kc[kc.indexOf(be)-1]},be.next=function(){return kc[kc.indexOf(be)+1]},be.revert=function(e,t){if(!t)return be.kill(!0);var i=!1!==e||!be.enabled,r=al;i!==be.isReverted&&(i&&(B=Math.max(Ae(),be.scroll.rec||0),Me=be.progress,U=n&&n.progress()),u&&[u,d,h,f].forEach(function(e){return e.style.display=i?"none":"block"}),i&&(al=be,be.update(i)),!Q||se&&be.isActive||(i?function(e,t,n){su(n);var i=e._gsap;if(i.spacerIsNative)su(i.spacerState);else if(e._gsap.swappedIn){var r=t.parentNode;r&&(r.insertBefore(e,t),r.removeChild(t))}e._gsap.swappedIn=!1}(Q,b,v):iu(Q,b,yc(Q),A)),i||be.update(i),al=r,be.isReverted=i)},be.refresh=function(r,s,p,x){if(!al&&be.enabled||s)if(Q&&r&&Ol)Tc(e,"scrollEnd",Gc);else{!Rl&&xe&&xe(be),al=be,i.tween&&!p&&(i.tween.kill(),i.tween=0),k&&k.pause(),$&&n&&(n.revert({kill:!1}).invalidate(),n.getChildren&&n.getChildren(!0,!0,!1).forEach(function(e){return e.vars.immediateRender&&e.render(0,!0,!0)})),be.isReverted||be.revert(!0,!0),be._subPinOffset=!1;var E,M,C,L,P,I,D,O,N,H,z,G,V,W=Se(),j=Ee(),Y=oe?oe.duration():ql(he,ue),X=g<=.01||!g,q=0,ee=x||0,te=ec(p)?p.end:t.end,ne=t.endTrigger||J,ie=ec(p)?p.start:t.start||(0!==t.start&&J?Q?"0 0":"0 100%":0),re=be.pinnedContainer=t.pinnedContainer&&Ho(t.pinnedContainer,be),ae=J&&Math.max(0,kc.indexOf(be))||0,le=ae;for(ye&&ec(p)&&(G=Ko.getProperty(h,ue.p),V=Ko.getProperty(f,ue.p));le-- >0;)(I=kc[le]).end||I.refresh(0,1)||(al=be),!(D=I.pin)||D!==J&&D!==Q&&D!==re||I.isReverted||(H||(H=[]),H.unshift(I),I.revert(!0,!0)),I!==kc[le]&&(ae--,le--);for(Zl(ie)&&(ie=ie(be)),ie=Fl(ie,"start",be),l=lu(ie,J,W,ue,Ae(),u,h,be,j,_e,me,Y,oe,be._startClamp&&"_startClamp")||(Q?-.001:0),Zl(te)&&(te=te(be)),Ql(te)&&!te.indexOf("+=")&&(~te.indexOf(" ")?te=(Ql(ie)?ie.split(" ")[0]:"")+te:(q=Pc(te.substr(2),W),te=Ql(ie)?ie:(oe?Ko.utils.mapRange(0,oe.duration(),oe.scrollTrigger.start,oe.scrollTrigger.end,l):l)+q,ne=J)),te=Fl(te,"end",be),c=Math.max(l,lu(te||(ne?"100% 0":Y),ne,W,ue,Ae()+q,d,f,be,j,_e,me,Y,oe,be._endClamp&&"_endClamp"))||-.001,q=0,le=ae;le--;)(D=(I=kc[le]).pin)&&I.start-I._pinPush<=l&&!oe&&I.end>0&&(E=I.end-(be._startClamp?Math.max(0,I.start):I.start),(D===J&&I.start-I._pinPush<l||D===re)&&isNaN(ie)&&(q+=E*(1-I.progress)),D===Q&&(ee+=E));if(l+=q,c+=q,be._startClamp&&(be._startClamp+=q),be._endClamp&&!Rl&&(be._endClamp=c||-.001,c=Math.min(c,ql(he,ue))),g=c-l||(l-=.01)&&.001,X&&(Me=Ko.utils.clamp(0,1,Ko.utils.normalize(l,c,B))),be._pinPush=ee,u&&q&&((E={})[ue.a]="+="+q,re&&(E[ue.p]="-="+Ae()),Ko.set([u,d],E)),!Q||Ml&&be.end>=ql(he,ue)){if(J&&Ae()&&!oe)for(M=J.parentNode;M&&M!==$o;)M._pinOffset&&(l-=M._pinOffset,c-=M._pinOffset),M=M.parentNode}else E=yc(Q),L=ue===Uo,C=Ae(),w=parseFloat(S(ue.a))+ee,!Y&&c>1&&(z={style:z=(pe?Qo.scrollingElement||Zo:he).style,value:z["overflow"+ue.a.toUpperCase()]},pe&&"scroll"!==yc($o)["overflow"+ue.a.toUpperCase()]&&(z.style["overflow"+ue.a.toUpperCase()]="scroll")),iu(Q,b,E),_=au(Q),M=bc(Q,!0),O=me&&zo(he,L?Bo:Uo)(),Z?((A=[Z+ue.os2,g+ee+vc]).t=b,(le=Z===fc?xc(Q,ue)+g+ee:0)&&(A.push(ue.d,le+vc),"auto"!==b.style.flexBasis&&(b.style.flexBasis=le+vc)),su(A),re&&kc.forEach(function(e){e.pin===re&&!1!==e.vars.pinSpacing&&(e._subPinOffset=!0)}),me&&Ae(B)):(le=xc(Q,ue))&&"auto"!==b.style.flexBasis&&(b.style.flexBasis=le+vc),me&&((P={top:M.top+(L?C-l:O)+vc,left:M.left+(L?O:C-l)+vc,boxSizing:"border-box",position:"fixed"})[oc]=P["max"+mc]=Math.ceil(M.width)+vc,P[lc]=P["max"+gc]=Math.ceil(M.height)+vc,P[pc]=P[pc+dc]=P[pc+cc]=P[pc+hc]=P[pc+uc]="0",P[fc]=E[fc],P[fc+dc]=E[fc+dc],P[fc+cc]=E[fc+cc],P[fc+hc]=E[fc+hc],P[fc+uc]=E[fc+uc],y=function(e,t,n){for(var i,r=[],s=e.length,a=n?8:0;a<s;a+=2)i=e[a],r.push(i,i in t?t[i]:e[a+1]);return r.t=e.t,r}(v,P,se),Rl&&Ae(0)),n?(N=n._initted,pl(1),n.render(n.duration(),!0,!0),T=S(ue.a)-w+g+ee,R=Math.abs(g-T)>1,me&&R&&y.splice(y.length-2,2),n.render(0,!0,!0),N||n.invalidate(!0),n.parent||n.totalTime(n.totalTime()),pl(0)):T=g,z&&(z.value?z.style["overflow"+ue.a.toUpperCase()]=z.value:z.style.removeProperty("overflow-"+ue.a));H&&H.forEach(function(e){return e.revert(!1,!0)}),be.start=l,be.end=c,a=o=Rl?B:Ae(),oe||Rl||(a<B&&Ae(B),be.scroll.rec=0),be.revert(!1,!0),Te=Dl(),F&&(we=-1,F.restart(!0)),al=0,n&&de&&(n._initted||U)&&n.progress()!==U&&n.progress(U||0,!0).render(n.time(),!0,!0),(X||Me!==be.progress||oe||$||n&&!n._initted)&&(n&&!de&&(n._initted||Me||!1!==n.vars.immediateRender)&&n.totalProgress(oe&&l<-.001&&!Me?Ko.utils.normalize(l,c,0):Me,!0),be.progress=X||(a-l)/g===Me?0:Me),Q&&Z&&(b._pinOffset=Math.round(be.progress*T)),k&&k.invalidate(),isNaN(G)||(G-=Ko.getProperty(h,ue.p),V-=Ko.getProperty(f,ue.p),hu(h,ue,G),hu(u,ue,G-(x||0)),hu(f,ue,V),hu(d,ue,V-(x||0))),X&&!Rl&&be.update(),!K||Rl||m||(m=!0,K(be),m=!1)}},be.getVelocity=function(){return(Ae()-o)/(Dl()-rl)*1e3||0},be.endAnimation=function(){tc(be.callbackAnimation),n&&(k?k.progress(1):n.paused()?de||tc(n,be.direction<0,1):tc(n,n.reversed()))},be.labelToScroll=function(e){return n&&n.labels&&(l||be.refresh()||l)+n.labels[e]/n.duration()*g||0},be.getTrailing=function(e){var t=kc.indexOf(be),n=be.direction>0?kc.slice(0,t).reverse():kc.slice(t+1);return(Ql(e)?n.filter(function(t){return t.vars.preventOverlaps===e}):n).filter(function(e){return be.direction>0?e.end<=l:e.start>=c})},be.update=function(e,t,r){if(!oe||r||e){var s,u,d,f,p,m,v,x=!0===Rl?B:be.scroll(),S=e?0:(x-l)/g,A=S<0?0:S>1?1:S||0,P=be.progress;if(t&&(o=a,a=oe?Ae():x,re&&(D=I,I=n&&!de?n.totalProgress():A)),ee&&Q&&!al&&!Il&&Ol&&(!A&&l<x+(x-o)/(Dl()-rl)*ee?A=1e-4:1===A&&c>x+(x-o)/(Dl()-rl)*ee&&(A=.9999)),A!==P&&be.enabled){if(f=(p=(s=be.isActive=!!A&&A<1)!==(!!P&&P<1))||!!A!==!!P,be.direction=A>P?1:-1,be.progress=A,f&&!al&&(u=A&&!P?0:1===A?1:1===P?2:3,de&&(d=!p&&"none"!==ve[u+1]&&ve[u+1]||ve[u],v=n&&("complete"===d||"reset"===d||d in n))),ce&&(p||v)&&(v||q||!n)&&(Zl(ce)?ce(be):be.getTrailing(ce).forEach(function(e){return e.endAnimation()})),de||(!k||al||Il?n&&n.totalProgress(A,!(!al||!Te&&!e)):(k._dp._time-k._start!==k._time&&k.render(k._dp._time-k._start),k.resetTo?k.resetTo("totalProgress",A,n._tTime/n._tDur):(k.vars.totalProgress=A,k.invalidate().restart()))),Q)if(e&&Z&&(b.style[Z+ue.os2]=M),me){if(f){if(m=!e&&A>P&&c+1>x&&x+1>=ql(he,ue),se)if(e||!s&&!m)uu(Q,b);else{var O=bc(Q,!0),N=x-l;uu(Q,$o,O.top+(ue===Uo?N:0)+vc,O.left+(ue===Uo?0:N)+vc)}su(s||m?y:_),R&&A<1&&s||E(w+(1!==A||m?0:T))}}else E(Vl(w+T*A));re&&!i.tween&&!al&&!Il&&F.restart(!0),j&&(p||ie&&A&&(A<1||!Al))&&nl(j.targets).forEach(function(e){return e.classList[s||ie?"add":"remove"](j.className)}),W&&!de&&!e&&W(be),f&&!al?(de&&(v&&("complete"===d?n.pause().totalProgress(1):"reset"===d?n.restart(!0).pause():"restart"===d?n.restart(!0):n[d]()),W&&W(be)),!p&&Al||(X&&p&&nc(be,X),ge[u]&&nc(be,ge[u]),ie&&(1===A?be.kill(!1,1):ge[u]=0),p||ge[u=1===A?1:3]&&nc(be,ge[u])),le&&!s&&Math.abs(be.getVelocity())>($l(le)?le:2500)&&(tc(be.callbackAnimation),k?k.progress(1):tc(n,"reverse"===d?1:!A,1))):de&&W&&!al&&W(be)}if(L){var U=oe?x/oe.duration()*(oe._caScrollDist||0):x;C(U+(h._isFlipped?1:0)),L(U)}H&&H(-x/oe.duration()*(oe._caScrollDist||0))}},be.enable=function(t,n){be.enabled||(be.enabled=!0,Tc(he,"resize",Uc),pe||Tc(he,"scroll",Fc),xe&&Tc(e,"refreshInit",xe),!1!==t&&(be.progress=Me=0,a=o=we=Ae()),!1!==n&&be.refresh())},be.getTween=function(e){return e&&i?i.tween:k},be.setPositions=function(e,t,n,i){if(oe){var r=oe.scrollTrigger,s=oe.duration(),a=r.end-r.start;e=r.start+a*e/s,t=r.start+a*t/s}be.refresh(!1,!1,{start:Bl(e,n&&!!be._startClamp),end:Bl(t,n&&!!be._endClamp)},i),be.update()},be.adjustPinSpacing=function(e){if(A&&e){var t=A.indexOf(ue.d)+1;A[t]=parseFloat(A[t])+e+vc,A[1]=parseFloat(A[1])+e+vc,su(A)}},be.disable=function(t,n){if(be.enabled&&(!1!==t&&be.revert(!0,!0),be.enabled=be.isActive=!1,n||k&&k.pause(),B=0,r&&(r.uncache=1),xe&&Mc(e,"refreshInit",xe),F&&(F.pause(),i.tween&&i.tween.kill()&&(i.tween=0)),!pe)){for(var s=kc.length;s--;)if(kc[s].scroller===he&&kc[s]!==be)return;Mc(he,"resize",Uc),pe||Mc(he,"scroll",Fc)}},be.kill=function(e,i){be.disable(e,i),k&&!i&&k.kill(),Y&&delete Oc[Y];var s=kc.indexOf(be);s>=0&&kc.splice(s,1),s===cl&&$c>0&&cl--,s=0,kc.forEach(function(e){return e.scroller===be.scroller&&(s=1)}),s||Rl||(be.scroll.rec=0),n&&(n.scrollTrigger=null,e&&n.revert({kill:!1}),i||n.kill()),u&&[u,d,h,f].forEach(function(e){return e.parentNode&&e.parentNode.removeChild(e)}),Pl===be&&(Pl=0),Q&&(r&&(r.uncache=1),s=0,kc.forEach(function(e){return e.pin===Q&&s++}),s||(r.spacer=0)),t.onKill&&t.onKill(be)},kc.push(be),be.enable(!1,!1),z&&z(be),n&&n.add&&!g){var Pe=be.update;be.update=function(){be.update=Pe,Mo.cache++,l||c||be.refresh()},Ko.delayedCall(.01,be.update),g=.01,l=c=0}else be.refresh();Q&&function(){if(Ll!==Kc){var e=Ll=Kc;requestAnimationFrame(function(){return e===Kc&&Qc(!0)})}}()}else this.update=this.refresh=this.kill=Gl},e.register=function(t){return qo||(Ko=t||jl(),Wl()&&window.document&&e.enable(),qo=Nl),qo},e.defaults=function(e){if(e)for(var t in e)Rc[t]=e[t];return Rc},e.disable=function(e,t){Nl=0,kc.forEach(function(n){return n[t?"kill":"disable"](e)}),Mc(Jo,"wheel",Fc),Mc(Qo,"scroll",Fc),clearInterval(sl),Mc(Qo,"touchcancel",Gl),Mc($o,"touchstart",Gl),wc(Mc,Qo,"pointerdown,touchstart,mousedown",Hl),wc(Mc,Qo,"pointerup,touchend,mouseup",zl),tl.kill(),Jl(Mc);for(var n=0;n<Mo.length;n+=3)Ac(Mc,Mo[n],Mo[n+1]),Ac(Mc,Mo[n],Mo[n+2])},e.enable=function(){if(Jo=window,Qo=document,Zo=Qo.documentElement,$o=Qo.body,Ko&&(nl=Ko.utils.toArray,il=Ko.utils.clamp,xl=Ko.core.context||Gl,pl=Ko.core.suppressOverwrites||Gl,Sl=Jo.history.scrollRestoration||"auto",Zc=Jo.pageYOffset||0,Ko.core.globals("ScrollTrigger",e),$o)){Nl=1,(El=document.createElement("div")).style.height="100vh",El.style.position="absolute",qc(),Ul(),Xo.register(Ko),e.isTouch=Xo.isTouch,bl=Xo.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),vl=1===Xo.isTouch,Tc(Jo,"wheel",Fc),el=[Jo,Qo,Zo,$o],Ko.matchMedia?(e.matchMedia=function(e){var t,n=Ko.matchMedia();for(t in e)n.add(t,e[t]);return n},Ko.addEventListener("matchMediaInit",function(){return Yc()}),Ko.addEventListener("matchMediaRevert",function(){return jc()}),Ko.addEventListener("matchMedia",function(){Qc(0,1),Vc("matchMedia")}),Ko.matchMedia().add("(orientation: portrait)",function(){return Bc(),Bc})):console.warn("Requires GSAP 3.11.0 or later"),Bc(),Tc(Qo,"scroll",Fc);var t,n,i=$o.hasAttribute("style"),r=$o.style,s=r.borderTopStyle,a=Ko.core.Animation.prototype;for(a.revert||Object.defineProperty(a,"revert",{value:function(){return this.time(-.01,!0)}}),r.borderTopStyle="solid",t=bc($o),Uo.m=Math.round(t.top+Uo.sc())||0,Bo.m=Math.round(t.left+Bo.sc())||0,s?r.borderTopStyle=s:r.removeProperty("border-top-style"),i||($o.setAttribute("style",""),$o.removeAttribute("style")),sl=setInterval(Nc,250),Ko.delayedCall(.5,function(){return Il=0}),Tc(Qo,"touchcancel",Gl),Tc($o,"touchstart",Gl),wc(Tc,Qo,"pointerdown,touchstart,mousedown",Hl),wc(Tc,Qo,"pointerup,touchend,mouseup",zl),ll=Ko.utils.checkPrefix("transform"),nu.push(ll),qo=Dl(),tl=Ko.delayedCall(.2,Qc).pause(),hl=[Qo,"visibilitychange",function(){var e=Jo.innerWidth,t=Jo.innerHeight;Qo.hidden?(ul=e,dl=t):ul===e&&dl===t||Uc()},Qo,"DOMContentLoaded",Qc,Jo,"load",Qc,Jo,"resize",Uc],Jl(Tc),kc.forEach(function(e){return e.enable(0,1)}),n=0;n<Mo.length;n+=3)Ac(Mc,Mo[n],Mo[n+1]),Ac(Mc,Mo[n],Mo[n+2])}},e.config=function(t){"limitCallbacks"in t&&(Al=!!t.limitCallbacks);var n=t.syncInterval;n&&clearInterval(sl)||(sl=n)&&setInterval(Nc,n),"ignoreMobileResize"in t&&(vl=1===e.isTouch&&t.ignoreMobileResize),"autoRefreshEvents"in t&&(Jl(Mc)||Jl(Tc,t.autoRefreshEvents||"none"),ml=-1===(t.autoRefreshEvents+"").indexOf("resize"))},e.scrollerProxy=function(e,t){var n=Ho(e),i=Mo.indexOf(n),r=Yl(n);~i&&Mo.splice(i,r?6:2),t&&(r?Ao.unshift(Jo,t,$o,t,Zo,t):Ao.unshift(n,t))},e.clearMatchMedia=function(e){kc.forEach(function(t){return t._ctx&&t._ctx.query===e&&t._ctx.kill(!0,!0)})},e.isInViewport=function(e,t,n){var i=(Ql(e)?Ho(e):e).getBoundingClientRect(),r=i[n?oc:lc]*t||0;return n?i.right-r>0&&i.left+r<Jo.innerWidth:i.bottom-r>0&&i.top+r<Jo.innerHeight},e.positionInViewport=function(e,t,n){Ql(e)&&(e=Ho(e));var i=e.getBoundingClientRect(),r=i[n?oc:lc],s=null==t?r/2:t in Lc?Lc[t]*r:~t.indexOf("%")?parseFloat(t)*r/100:parseFloat(t)||0;return n?(i.left+s)/Jo.innerWidth:(i.top+s)/Jo.innerHeight},e.killAll=function(e){if(kc.slice(0).forEach(function(e){return"ScrollSmoother"!==e.vars.id&&e.kill()}),!0!==e){var t=Hc.killAll||[];Hc={},t.forEach(function(e){return e()})}},e}();pu.version="3.13.0",pu.saveStyles=function(e){return e?nl(e).forEach(function(e){if(e&&e.style){var t=Wc.indexOf(e);t>=0&&Wc.splice(t,5),Wc.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),Ko.core.getCache(e),xl())}}):Wc},pu.revert=function(e,t){return Yc(!e,t)},pu.create=function(e,t){return new pu(e,t)},pu.refresh=function(e){return e?Uc(!0):(qo||pu.register())&&Qc(!0)},pu.update=function(e){return++Mo.cache&&eu(!0===e?2:0)},pu.clearScrollMemory=Xc,pu.maxScroll=function(e,t){return ql(e,t?Bo:Uo)},pu.getScrollFunc=function(e,t){return zo(Ho(e),t?Bo:Uo)},pu.getById=function(e){return Oc[e]},pu.getAll=function(){return kc.filter(function(e){return"ScrollSmoother"!==e.vars.id})},pu.isScrolling=function(){return!!Ol},pu.snapDirectional=Ec,pu.addEventListener=function(e,t){var n=Hc[e]||(Hc[e]=[]);~n.indexOf(t)||n.push(t)},pu.removeEventListener=function(e,t){var n=Hc[e],i=n&&n.indexOf(t);i>=0&&n.splice(i,1)},pu.batch=function(e,t){var n,i=[],r={},s=t.interval||.016,a=t.batchMax||1e9,o=function(e,t){var n=[],i=[],r=Ko.delayedCall(s,function(){t(n,i),n=[],i=[]}).pause();return function(e){n.length||r.restart(!0),n.push(e.trigger),i.push(e),a<=n.length&&r.progress(1)}};for(n in t)r[n]="on"===n.substr(0,2)&&Zl(t[n])&&"onRefreshInit"!==n?o(0,t[n]):t[n];return Zl(a)&&(a=a(),Tc(pu,"refresh",function(){return a=t.batchMax()})),nl(e).forEach(function(e){var t={};for(n in r)t[n]=r[n];t.trigger=e,i.push(pu.create(t))}),i};var mu,gu=function(e,t,n,i){return t>i?e(i):t<0&&e(0),n>i?(i-t)/(n-t):n<0?t/(t-n):1},vu=function e(t,n){!0===n?t.style.removeProperty("touch-action"):t.style.touchAction=!0===n?"auto":n?"pan-"+n+(Xo.isTouch?" pinch-zoom":""):"none",t===Zo&&e($o,n)},yu={auto:1,scroll:1},_u=function(e){var t,n=e.event,i=e.target,r=e.axis,s=(n.changedTouches?n.changedTouches[0]:n).target,a=s._gsap||Ko.core.getCache(s),o=Dl();if(!a._isScrollT||o-a._isScrollT>2e3){for(;s&&s!==$o&&(s.scrollHeight<=s.clientHeight&&s.scrollWidth<=s.clientWidth||!yu[(t=yc(s)).overflowY]&&!yu[t.overflowX]);)s=s.parentNode;a._isScroll=s&&s!==i&&!Yl(s)&&(yu[(t=yc(s)).overflowY]||yu[t.overflowX]),a._isScrollT=o}(a._isScroll||"x"===r)&&(n.stopPropagation(),n._gsapAllow=!0)},bu=function(e,t,n,i){return Xo.create({target:e,capture:!0,debounce:!1,lockAxis:!0,type:t,onWheel:i=i&&_u,onPress:i,onDrag:i,onScroll:i,onEnable:function(){return n&&Tc(Qo,Xo.eventTypes[0],Su,!1,!0)},onDisable:function(){return Mc(Qo,Xo.eventTypes[0],Su,!0)}})},xu=/(input|label|select|textarea)/i,Su=function(e){var t=xu.test(e.target.tagName);(t||mu)&&(e._gsapAllow=!0,mu=t)},Eu=function(e){ec(e)||(e={}),e.preventDefault=e.isNormalizer=e.allowClicks=!0,e.type||(e.type="wheel,touch"),e.debounce=!!e.debounce,e.id=e.id||"normalizer";var t,n,i,r,s,a,o,l,c=e,u=c.normalizeScrollX,d=c.momentum,h=c.allowNestedScroll,f=c.onRelease,p=Ho(e.target)||Zo,m=Ko.core.globals().ScrollSmoother,g=m&&m.get(),v=bl&&(e.content&&Ho(e.content)||g&&!1!==e.content&&!g.smooth()&&g.content()),y=zo(p,Uo),_=zo(p,Bo),b=1,x=(Xo.isTouch&&Jo.visualViewport?Jo.visualViewport.scale*Jo.visualViewport.width:Jo.outerWidth)/Jo.innerWidth,S=0,E=Zl(d)?function(){return d(t)}:function(){return d||2.8},w=bu(p,e.type,!0,h),T=function(){return r=!1},M=Gl,A=Gl,C=function(){n=ql(p,Uo),A=il(bl?1:0,n),u&&(M=il(0,ql(p,Bo))),i=Kc},R=function(){v._gsap.y=Vl(parseFloat(v._gsap.y)+y.offset)+"px",v.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(v._gsap.y)+", 0, 1)",y.offset=y.cacheID=0},L=function(){C(),s.isActive()&&s.vars.scrollY>n&&(y()>n?s.progress(1)&&y(n):s.resetTo("scrollY",n))};return v&&Ko.set(v,{y:"+=0"}),e.ignoreCheck=function(e){return bl&&"touchmove"===e.type&&function(){if(r){requestAnimationFrame(T);var e=Vl(t.deltaY/2),n=A(y.v-e);if(v&&n!==y.v+y.offset){y.offset=n-y.v;var i=Vl((parseFloat(v&&v._gsap.y)||0)-y.offset);v.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+i+", 0, 1)",v._gsap.y=i+"px",y.cacheID=Mo.cache,eu()}return!0}y.offset&&R(),r=!0}()||b>1.05&&"touchstart"!==e.type||t.isGesturing||e.touches&&e.touches.length>1},e.onPress=function(){r=!1;var e=b;b=Vl((Jo.visualViewport&&Jo.visualViewport.scale||1)/x),s.pause(),e!==b&&vu(p,b>1.01||!u&&"x"),a=_(),o=y(),C(),i=Kc},e.onRelease=e.onGestureStart=function(e,t){if(y.offset&&R(),t){Mo.cache++;var i,r,a=E();u&&(r=(i=_())+.05*a*-e.velocityX/.227,a*=gu(_,i,r,ql(p,Bo)),s.vars.scrollX=M(r)),r=(i=y())+.05*a*-e.velocityY/.227,a*=gu(y,i,r,ql(p,Uo)),s.vars.scrollY=A(r),s.invalidate().duration(a).play(.01),(bl&&s.vars.scrollY>=n||i>=n-1)&&Ko.to({},{onUpdate:L,duration:a})}else l.restart(!0);f&&f(e)},e.onWheel=function(){s._ts&&s.pause(),Dl()-S>1e3&&(i=0,S=Dl())},e.onChange=function(e,t,n,r,s){if(Kc!==i&&C(),t&&u&&_(M(r[2]===t?a+(e.startX-e.x):_()+t-r[1])),n){y.offset&&R();var l=s[2]===n,c=l?o+e.startY-e.y:y()+n-s[1],d=A(c);l&&c!==d&&(o+=d-c),y(d)}(n||t)&&eu()},e.onEnable=function(){vu(p,!u&&"x"),pu.addEventListener("refresh",L),Tc(Jo,"resize",L),y.smooth&&(y.target.style.scrollBehavior="auto",y.smooth=_.smooth=!1),w.enable()},e.onDisable=function(){vu(p,!0),Mc(Jo,"resize",L),pu.removeEventListener("refresh",L),w.kill()},e.lockAxis=!1!==e.lockAxis,(t=new Xo(e)).iOS=bl,bl&&!y()&&y(1),bl&&Ko.ticker.add(Gl),l=t._dc,s=Ko.to(t,{ease:"power4",paused:!0,inherit:!1,scrollX:u?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:du(y,y(),function(){return s.pause()})},onUpdate:eu,onComplete:l.vars.onComplete}),t};pu.sort=function(e){if(Zl(e))return kc.sort(e);var t=Jo.pageYOffset||0;return pu.getAll().forEach(function(e){return e._sortY=e.trigger?t+e.trigger.getBoundingClientRect().top:e.start+Jo.innerHeight}),kc.sort(e||function(e,t){return-1e6*(e.vars.refreshPriority||0)+(e.vars.containerAnimation?1e6:e._sortY)-((t.vars.containerAnimation?1e6:t._sortY)+-1e6*(t.vars.refreshPriority||0))})},pu.observe=function(e){return new Xo(e)},pu.normalizeScroll=function(e){if("undefined"===typeof e)return gl;if(!0===e&&gl)return gl.enable();if(!1===e)return gl&&gl.kill(),void(gl=e);var t=e instanceof Xo?e:Eu(e);return gl&&gl.target===t.target&&gl.kill(),Yl(t.target)&&(gl=t),t},pu.core={_getVelocityProp:Go,_inputObserver:bu,_scrollers:Mo,_proxies:Ao,bridge:{ss:function(){Ol||Vc("scrollStart"),Ol=Dl()},ref:function(){return al}}},jl()&&Ko.registerPlugin(pu);const wu=Number.isFinite||function(e){return"number"===typeof e&&isFinite(e)},Tu=Number.isSafeInteger||function(e){return"number"===typeof e&&Math.abs(e)<=Mu},Mu=Number.MAX_SAFE_INTEGER||9007199254740991;let Au=function(e){return e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError",e}({}),Cu=function(e){return e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",e.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",e.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_PARSING_ERROR="levelParsingError",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.FRAG_GAP="fragGap",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.ASSET_LIST_LOAD_ERROR="assetListLoadError",e.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",e.ASSET_LIST_PARSING_ERROR="assetListParsingError",e.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.ATTACH_MEDIA_ERROR="attachMediaError",e.UNKNOWN="unknown",e}({}),Ru=function(e){return e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.MEDIA_ENDED="hlsMediaEnded",e.STALL_RESOLVED="hlsStallResolved",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFERED_TO_END="hlsBufferedToEnd",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached",e.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",e.ASSET_LIST_LOADING="hlsAssetListLoading",e.ASSET_LIST_LOADED="hlsAssetListLoaded",e.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",e.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",e.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",e.INTERSTITIAL_STARTED="hlsInterstitialStarted",e.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",e.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",e.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",e.INTERSTITIAL_ENDED="hlsInterstitialEnded",e.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",e.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",e.EVENT_CUE_ENTER="hlsEventCueEnter",e}({});var Lu="manifest",Pu="level",Iu="audioTrack",Du="subtitleTrack",ku="main",Ou="audio",Nu="subtitle";class Fu{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class Bu{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Fu(e),this.fast_=new Fu(t),this.defaultTTFB_=i,this.ttfb_=new Fu(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:r}=this;n.halfLife!==e&&(this.slow_=new Fu(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new Fu(t,i.getEstimate(),i.getTotalWeight())),r.halfLife!==e&&(this.ttfb_=new Fu(e,r.getEstimate(),r.getTotalWeight()))}sample(e,t){const n=(e=Math.max(e,this.minDelayMs_))/1e3,i=8*t/n;this.fast_.sample(n,i),this.slow_.sample(n,i)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function Uu(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hu(){return Hu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Hu.apply(null,arguments)}function zu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function Gu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zu(Object(n),!0).forEach(function(t){Uu(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zu(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}class Vu{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const n="[".concat(e,"]:");this.trace=Wu,this.debug=t.debug.bind(null,n),this.log=t.log.bind(null,n),this.warn=t.warn.bind(null,n),this.info=t.info.bind(null,n),this.error=t.error.bind(null,n)}}const Wu=function(){},ju={trace:Wu,debug:Wu,log:Wu,warn:Wu,info:Wu,error:Wu};function Yu(){return Hu({},ju)}function Xu(e,t,n){return t[e]?t[e].bind(t):function(e,t){const n=self.console[e];return n?n.bind(self.console,"".concat(t?"["+t+"] ":"","[").concat(e,"] >")):Wu}(e,n)}const Ku=Yu();const qu=Ku;function Ju(){if("undefined"===typeof self)return;return(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function Qu(e,t){const n=Object.keys(e),i=Object.keys(t),r=n.length,s=i.length;return!r||!s||r===s&&!n.some(e=>-1===i.indexOf(e))}function Zu(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("undefined"!==typeof TextDecoder){const n=new TextDecoder("utf-8").decode(e);if(t){const e=n.indexOf("\0");return-1!==e?n.substring(0,e):n}return n.replace(/\0/g,"")}const n=e.length;let i,r,s,a="",o=0;for(;o<n;){if(i=e[o++],0===i&&t)return a;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(i);break;case 12:case 13:r=e[o++],a+=String.fromCharCode((31&i)<<6|63&r);break;case 14:r=e[o++],s=e[o++],a+=String.fromCharCode((15&i)<<12|(63&r)<<6|63&s)}}return a}function $u(e){let t="";for(let n=0;n<e.length;n++){let i=e[n].toString(16);i.length<2&&(i="0"+i),t+=i}return t}function ed(e){return Uint8Array.from(e.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function td(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var nd,id={exports:{}};var rd=function(){return nd||(nd=1,e=id,function(){var t=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,r=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var r=s.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=s.normalizePath(r.path),s.buildURLFromParts(r)}var a=s.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):t;var o=s.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=n.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var c={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(c.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var u=o.path,d=u.substring(0,u.lastIndexOf("/")+1)+a.path;c.path=s.normalizePath(d)}else c.path=o.path,a.params||(c.params=o.params,a.query||(c.query=o.query));return null===c.path&&(c.path=i.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(c)},parseURL:function(e){var n=t.exec(e);return n?{scheme:n[1]||"",netLoc:n[2]||"",path:n[3]||"",params:n[4]||"",query:n[5]||"",fragment:n[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(i,"");e.length!==(e=e.replace(r,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=s}()),id.exports;var e}();class sd{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var ad="audio",od="video",ld="audiovideo";class cd{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,"string"===typeof e&&(e={url:e}),this.base=e,function(e,t){const n=fd(e,t);n&&(n.enumerable=!0,Object.defineProperty(e,t,n))}(this,"stats")}setByteRange(e,t){const n=e.split("@",2);let i;i=1===n.length?(null==t?void 0:t.byteRangeEndOffset)||0:parseInt(n[1]),this._byteRange=[i,parseInt(n[0])+i]}get baseurl(){return this.base.url}get byteRange(){return null===this._byteRange?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return null===this._streams&&(this._streams={[ad]:null,[od]:null,[ld]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return null!==this._stats}get hasStreams(){return null!==this._streams}get stats(){return null===this._stats&&(this._stats=new sd),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=rd.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[ad]=null,e[od]=null,e[ld]=null}}function ud(e){return"initSegment"!==e.sn}class dd extends cd{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],t=this.byteRange[1];if(wu(e)&&wu(t))return t-e}return null}get bitrate(){return this.byteLength?8*this.byteLength/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){var e;const{levelkeys:t}=this;if(!t||t.NONE)return null;if(t.identity)this._decryptdata||(this._decryptdata=t.identity.getDecryptData(this.sn));else if(null==(e=this._decryptdata)||!e.keyId){const e=Object.keys(t);if(1===e.length){const n=this._decryptdata=t[e[0]]||null;n&&(this._decryptdata=n.getDecryptData(this.sn,t))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;const e=wu(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){var t;const e=Object.keys(this.levelkeys),n=e.length;if(n>1||1===n&&null!=(t=this.levelkeys[e[0]])&&t.encrypted)return!0}return!1}get programDateTime(){return null===this._programDateTime&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){wu(e)?this._programDateTime=e:this._programDateTime=this.rawProgramDateTime=null}get ref(){return ud(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){const t=this.levelkeys;if(t){var n;const i=t[e];!i||null!=(n=this._decryptdata)&&n.keyId||(this._decryptdata=i.getDecryptData(this.sn,t))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const{elementaryStreams:a}=this,o=a[e];o?(o.startPTS=Math.min(o.startPTS,t),o.endPTS=Math.max(o.endPTS,n),o.startDTS=Math.min(o.startDTS,i),o.endDTS=Math.max(o.endDTS,r)):a[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:r,partial:s}}}class hd extends cd{constructor(e,t,n,i,r){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const s=e.enumeratedString("BYTERANGE");s&&this.setByteRange(s,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function fd(e,t){const n=Object.getPrototypeOf(e);if(n){const e=Object.getOwnPropertyDescriptor(n,t);return e||fd(n,t)}}const pd=Math.pow(2,32)-1,md=[].push,gd={video:1,audio:2,id3:3,text:4};function vd(e){return String.fromCharCode.apply(null,e)}function yd(e,t){const n=e[t]<<8|e[t+1];return n<0?65536+n:n}function _d(e,t){const n=xd(e,t);return n<0?4294967296+n:n}function bd(e,t){let n=_d(e,t);return n*=Math.pow(2,32),n+=_d(e,t+4),n}function xd(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function Sd(e,t){const n=[];if(!t.length)return n;const i=e.byteLength;for(let r=0;r<i;){const s=_d(e,r),a=s>1?r+s:i;if(vd(e.subarray(r+4,r+8))===t[0])if(1===t.length)n.push(e.subarray(r+8,a));else{const i=Sd(e.subarray(r+8,a),t.slice(1));i.length&&md.apply(n,i)}r=a}return n}function Ed(e){const t=[],n=e[0];let i=8;const r=_d(e,i);i+=4;let s=0,a=0;0===n?(s=_d(e,i),a=_d(e,i+4),i+=8):(s=bd(e,i),a=bd(e,i+8),i+=16),i+=2;let o=e.length+a;const l=yd(e,i);i+=2;for(let c=0;c<l;c++){let n=i;const s=_d(e,n);n+=4;const a=2147483647&s;if(1===(2147483648&s)>>>31)return qu.warn("SIDX has hierarchical references (not supported)"),null;const l=_d(e,n);n+=4,t.push({referenceSize:a,subsegmentDuration:l,info:{duration:l/r,start:o,end:o+a-1}}),o+=a,n+=4,i=n}return{earliestPresentationTime:s,timescale:r,version:n,referencesCount:l,references:t}}function wd(e){const t=[],n=Sd(e,["moov","trak"]);for(let i=0;i<n.length;i++){const e=n[i],r=Sd(e,["tkhd"])[0];if(r){let n=r[0];const i=_d(r,0===n?12:20),s=Sd(e,["mdia","mdhd"])[0];if(s){n=s[0];const r=_d(s,0===n?12:20),a=Sd(e,["mdia","hdlr"])[0];if(a){const n=vd(a.subarray(8,12)),s={soun:ad,vide:od}[n],o=Td(Sd(e,["mdia","minf","stbl","stsd"])[0]);s?(t[i]={timescale:r,type:s,stsd:o},t[s]=Gu({timescale:r,id:i},o)):t[i]={timescale:r,type:n,stsd:o}}}}}return Sd(e,["moov","mvex","trex"]).forEach(e=>{const n=_d(e,4),i=t[n];i&&(i.default={duration:_d(e,12),flags:_d(e,20)})}),t}function Td(e){const t=e.subarray(8),n=t.subarray(86),i=vd(t.subarray(4,8));let r,s=i;const a="enca"===i||"encv"===i;if(a){const e=Sd(t,[i])[0];Sd(e.subarray("enca"===i?28:78),["sinf"]).forEach(e=>{const t=Sd(e,["schm"])[0];if(t){const n=vd(t.subarray(4,8));if("cbcs"===n||"cenc"===n){const t=Sd(e,["frma"])[0];t&&(s=vd(t))}}})}const o=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const e=Sd(n,["avcC"])[0];e&&e.length>3&&(s+="."+Cd(e[1])+Cd(e[2])+Cd(e[3]),r=Md("avc1"===o?"dva1":"dvav",n));break}case"mp4a":{const e=Sd(t,[i])[0],n=Sd(e.subarray(28),["esds"])[0];if(n&&n.length>7){let e=4;if(3!==n[e++])break;e=Ad(n,e),e+=2;const t=n[e++];if(128&t&&(e+=2),64&t&&(e+=n[e++]),4!==n[e++])break;e=Ad(n,e);const i=n[e++];if(64!==i)break;if(s+="."+Cd(i),e+=12,5!==n[e++])break;e=Ad(n,e);const r=n[e++];let a=(248&r)>>3;31===a&&(a+=1+((7&r)<<3)+((224&n[e])>>5)),s+="."+a}break}case"hvc1":case"hev1":{const e=Sd(n,["hvcC"])[0];if(e&&e.length>12){const t=e[1],n=["","A","B","C"][t>>6],i=31&t,r=_d(e,2),a=(32&t)>>5?"H":"L",o=e[12],l=e.subarray(6,12);s+="."+n+i,s+="."+function(e){let t=0;for(let n=0;n<32;n++)t|=(e>>n&1)<<31-n;return t>>>0}(r).toString(16).toUpperCase(),s+="."+a+o;let c="";for(let e=l.length;e--;){const t=l[e];if(t||c){c="."+t.toString(16).toUpperCase()+c}}s+=c}r=Md("hev1"==o?"dvhe":"dvh1",n);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":s=Md(s,n)||s;break;case"vp09":{const e=Sd(n,["vpcC"])[0];if(e&&e.length>6){const t=e[4],n=e[5],i=e[6]>>4&15;s+="."+Rd(t)+"."+Rd(n)+"."+Rd(i)}break}case"av01":{const e=Sd(n,["av1C"])[0];if(e&&e.length>2){const t=e[1]>>>5,i=31&e[1],a=e[2]>>>7?"H":"M",o=(64&e[2])>>6,l=(32&e[2])>>5,c=2===t&&o?l?12:10:o?10:8,u=(16&e[2])>>4,d=(8&e[2])>>3,h=(4&e[2])>>2,f=3&e[2],p=1,m=1,g=1,v=0;s+="."+t+"."+Rd(i)+a+"."+Rd(c)+"."+u+"."+d+h+f+"."+Rd(p)+"."+Rd(m)+"."+Rd(g)+"."+v,r=Md("dav1",n)}break}}return{codec:s,encrypted:a,supplemental:r}}function Md(e,t){const n=Sd(t,["dvvC"]),i=n.length?n[0]:Sd(t,["dvcC"])[0];if(i){const t=i[2]>>1&127,n=i[2]<<5&32|i[3]>>3&31;return e+"."+Rd(t)+"."+Rd(n)}}function Ad(e,t){const n=t+5;for(;128&e[t++]&&t<n;);return t}function Cd(e){return("0"+e.toString(16).toUpperCase()).slice(-2)}function Rd(e){return(e<10?"0":"")+e}function Ld(e,t){Sd(e,["moov","trak"]).forEach(e=>{const n=Sd(e,["mdia","minf","stbl","stsd"])[0];if(!n)return;const i=n.subarray(8);let r=Sd(i,["enca"]);const s=r.length>0;s||(r=Sd(i,["encv"])),r.forEach(e=>{Sd(s?e.subarray(28):e.subarray(78),["sinf"]).forEach(e=>{const n=Pd(e);n&&t(n,s)})})})}function Pd(e){const t=Sd(e,["schm"])[0];if(t){const n=vd(t.subarray(4,8));if("cbcs"===n||"cenc"===n){const t=Sd(e,["schi","tenc"])[0];if(t)return t}}}function Id(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function Dd(e,t){const n=[],i=t.samples,r=t.timescale,s=t.id;let a=!1;return Sd(i,["moof"]).map(o=>{const l=o.byteOffset-8;Sd(o,["traf"]).map(o=>{const c=Sd(o,["tfdt"]).map(e=>{const t=e[0];let n=_d(e,4);return 1===t&&(n*=Math.pow(2,32),n+=_d(e,8)),n/r})[0];return void 0!==c&&(e=c),Sd(o,["tfhd"]).map(c=>{const u=_d(c,4),d=16777215&_d(c,0);let h=0;const f=0!==(16&d);let p=0;const m=0!==(32&d);let g=8;u===s&&(0!==(1&d)&&(g+=8),0!==(2&d)&&(g+=4),0!==(8&d)&&(h=_d(c,g),g+=4),f&&(p=_d(c,g),g+=4),m&&(g+=4),"video"===t.type&&(a=kd(t.codec)),Sd(o,["trun"]).map(s=>{const o=s[0],c=16777215&_d(s,0),u=0!==(1&c);let d=0;const f=0!==(4&c),m=0!==(256&c);let g=0;const v=0!==(512&c);let y=0;const _=0!==(1024&c),b=0!==(2048&c);let x=0;const S=_d(s,4);let E=8;u&&(d=_d(s,E),E+=4),f&&(E+=4);let w=d+l;for(let l=0;l<S;l++){if(m?(g=_d(s,E),E+=4):g=h,v?(y=_d(s,E),E+=4):y=p,_&&(E+=4),b&&(x=0===o?_d(s,E):xd(s,E),E+=4),t.type===od){let t=0;for(;t<y;){const s=_d(i,w);if(w+=4,Od(a,i[w])){Nd(i.subarray(w,w+s),a?2:1,e+x/r,n)}w+=s,t+=s+4}}e+=g/r}}))})})}),n}function kd(e){if(!e)return!1;const t=e.substring(0,4);return"hvc1"===t||"hev1"===t||"dvh1"===t||"dvhe"===t}function Od(e,t){if(e){const e=t>>1&63;return 39===e||40===e}return 6===(31&t)}function Nd(e,t,n,i){const r=Fd(e);let s=0;s+=t;let a=0,o=0,l=0;for(;s<r.length;){a=0;do{if(s>=r.length)break;l=r[s++],a+=l}while(255===l);o=0;do{if(s>=r.length)break;l=r[s++],o+=l}while(255===l);const e=r.length-s;let t=s;if(o<e)s+=o;else if(o>e){qu.error("Malformed SEI payload. ".concat(o," is too small, only ").concat(e," bytes left to parse."));break}if(4===a){if(181===r[t++]){const e=yd(r,t);if(t+=2,49===e){const e=_d(r,t);if(t+=4,1195456820===e){const e=r[t++];if(3===e){const s=r[t++],o=64&s,l=o?2+3*(31&s):0,c=new Uint8Array(l);if(o){c[0]=s;for(let e=1;e<l;e++)c[e]=r[t++]}i.push({type:e,payloadType:a,pts:n,bytes:c})}}}}}else if(5===a&&o>16){const e=[];for(let n=0;n<16;n++){const i=r[t++].toString(16);e.push(1==i.length?"0"+i:i),3!==n&&5!==n&&7!==n&&9!==n||e.push("-")}const s=o-16,l=new Uint8Array(s);for(let n=0;n<s;n++)l[n]=r[t++];i.push({payloadType:a,pts:n,uuid:e.join(""),userData:Zu(l),userDataBytes:l})}}}function Fd(e){const t=e.byteLength,n=[];let i=1;for(;i<t-2;)0===e[i]&&0===e[i+1]&&3===e[i+2]?(n.push(i+2),i+=2):i++;if(0===n.length)return e;const r=t-n.length,s=new Uint8Array(r);let a=0;for(i=0;i<r;a++,i++)a===n[0]&&(a++,n.shift()),s[i]=e[a];return s}function Bd(e,t,n){if(16!==e.byteLength)throw new RangeError("Invalid system id");let i,r,s;i=0,r=new Uint8Array,s=new Uint8Array;const a=new Uint8Array(4);return n.byteLength>0&&new DataView(a.buffer).setUint32(0,n.byteLength,!1),function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=n.length;let s=8,a=r;for(;a--;)s+=n[a].byteLength;const o=new Uint8Array(s);for(o[0]=s>>24&255,o[1]=s>>16&255,o[2]=s>>8&255,o[3]=255&s,o.set(e,4),a=0,s=8;a<r;a++)o.set(n[a],s),s+=n[a].byteLength;return o}([112,115,115,104],new Uint8Array([0,0,0,0]),e,s,r,a,n)}function Ud(e){const t=e.getUint32(0),n=e.byteOffset,i=e.byteLength;if(i<t)return{offset:n,size:i};if(1886614376!==e.getUint32(4))return{offset:n,size:t};const r=e.getUint32(8)>>>24;if(0!==r&&1!==r)return{offset:n,size:t};const s=e.buffer,a=$u(new Uint8Array(s,n+12,16));let o=null,l=null,c=0;if(0===r)c=28;else{const r=e.getUint32(28);if(!r||i<32+16*r)return{offset:n,size:t};o=[];for(let e=0;e<r;e++)o.push(new Uint8Array(s,n+32+16*e,16));c=32+16*r}if(!c)return{offset:n,size:t};const u=e.getUint32(c);return t-32<u?{offset:n,size:t}:(l=new Uint8Array(s,n+c+4,u),{version:r,systemId:a,kids:o,data:l,offset:n,size:t})}const Hd=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),zd={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Gd(e,t){const n=zd[t];return!!n&&!!n[e.slice(0,4)]}function Vd(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!e.split(",").some(e=>!Wd(e,t,n))}function Wd(e,t){var n;const i=Ju(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]);return null!=(n=null==i?void 0:i.isTypeSupported(jd(e,t)))&&n}function jd(e,t){return"".concat(t,"/mp4;codecs=").concat(e)}function Yd(e){if(e){const t=e.substring(0,4);return zd.video[t]}return 2}function Xd(e){const t=Hd();return e.split(",").reduce((e,n)=>{const i=t&&kd(n)?9:zd.video[n];return i?(2*i+e)/(e?3:2):(zd.audio[n]+e)/(e?2:1)},0)}const Kd={};const qd=/flac|opus|mp4a\.40\.34/i;function Jd(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.replace(qd,e=>function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(Kd[e])return Kd[e];const n={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[e];for(let r=0;r<n.length;r++){var i;if(Wd(n[r],"audio",t))return Kd[e]=n[r],n[r];if("mp3"===n[r]&&null!=(i=Ju(t))&&i.isTypeSupported("audio/mpeg"))return""}return e}(e.toLowerCase(),t))}function Qd(e,t){if(e&&(e.length>4||-1!==["ac-3","ec-3","alac","fLaC","Opus"].indexOf(e))&&(Zd(e,"audio")||Zd(e,"video")))return e;if(t){const n=t.split(",");if(n.length>1){if(e)for(let t=n.length;t--;)if(n[t].substring(0,4)===e.substring(0,4))return n[t];return n[0]}}return t||e}function Zd(e,t){return Gd(e,t)&&Wd(e,t)}function $d(e){if(e.startsWith("av01.")){const t=e.split("."),n=["0","111","01","01","01","0"];for(let e=t.length;e>4&&e<10;e++)t[e]=n[e-4];return t.join(".")}return e}function eh(e){const t=Ju(e)||{isTypeSupported:()=>!1};return{mpeg:t.isTypeSupported("audio/mpeg"),mp3:t.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:t.isTypeSupported('audio/mp4; codecs="ac-3"')}}function th(e){return e.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const nh={supported:!1,smooth:!1,powerEfficient:!1},ih={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function rh(e,t){return{supported:!1,configurations:t,decodingInfoResults:[nh],error:e}}function sh(e,t,n,i,r,s){const a=e.videoCodec,o=e.audioCodec?e.audioGroups:null,l=null==s?void 0:s.audioCodec,c=null==s?void 0:s.channels,u=c?parseInt(c):l?1/0:2;let d=null;if(null!=o&&o.length)try{d=1===o.length&&o[0]?t.groups[o[0]].channels:o.reduce((e,n)=>{if(n){const i=t.groups[n];if(!i)throw new Error("Audio track group ".concat(n," not found"));Object.keys(i.channels).forEach(t=>{e[t]=(e[t]||0)+i.channels[t]})}return e},{2:0})}catch(h){return!0}return void 0!==a&&(a.split(",").some(e=>kd(e))||e.width>1920&&e.height>1088||e.height>1920&&e.width>1088||e.frameRate>Math.max(i,30)||"SDR"!==e.videoRange&&e.videoRange!==n||e.bitrate>Math.max(r,8e6))||!!d&&wu(u)&&Object.keys(d).some(e=>parseInt(e)>u)}function ah(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const r=e.videoCodec;if(!r&&!e.audioCodec||!n)return Promise.resolve(ih);const s=[],a=function(e){var t;const n=null==(t=e.videoCodec)?void 0:t.split(","),i=lh(e),r=e.width||640,s=e.height||480,a=e.frameRate||30,o=e.videoRange.toLowerCase();return n?n.map(e=>{const t={contentType:jd($d(e),"video"),width:r,height:s,bitrate:i,framerate:a};return"sdr"!==o&&(t.transferFunction=o),t}):[]}(e),o=a.length,l=function(e,t,n){var i;const r=null==(i=e.audioCodec)?void 0:i.split(","),s=lh(e);if(r&&e.audioGroups)return e.audioGroups.reduce((e,i)=>{var a;const o=i?null==(a=t.groups[i])?void 0:a.tracks:null;return o?o.reduce((e,t)=>{if(t.groupId===i){const i=parseFloat(t.channels||"");r.forEach(t=>{const r={contentType:jd(t,"audio"),bitrate:n?oh(t,s):s};i&&(r.channels=""+i),e.push(r)})}return e},e):e},[]);return[]}(e,t,o>0),c=l.length;for(let u=o||1*c||1;u--;){const e={type:"media-source"};if(o&&(e.video=a[u%o]),c){e.audio=l[u%c];const t=e.audio.bitrate;e.video&&t&&(e.video.bitrate-=t)}s.push(e)}if(r){const e=navigator.userAgent;if(r.split(",").some(e=>kd(e))&&Hd())return Promise.resolve(rh(new Error("Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (".concat(e,")")),s))}return Promise.all(s.map(e=>{const t=function(e){let t="";const{audio:n,video:i}=e;if(i){const e=th(i.contentType);t+="".concat(e,"_r").concat(i.height,"x").concat(i.width,"f").concat(Math.ceil(i.framerate)).concat(i.transferFunction||"sd","_").concat(Math.ceil(i.bitrate/1e5))}if(n){const e=th(n.contentType);t+="".concat(i?"_":"").concat(e,"_c").concat(n.channels)}return t}(e);return i[t]||(i[t]=n.decodingInfo(e))})).then(e=>({supported:!e.some(e=>!e.supported),configurations:s,decodingInfoResults:e})).catch(e=>({supported:!1,configurations:s,decodingInfoResults:[],error:e}))}function oh(e,t){if(t<=1)return 1;let n=128e3;return"ec-3"===e?n=768e3:"ac-3"===e&&(n=64e4),Math.min(t/2,n)}function lh(e){return 1e3*Math.ceil(Math.max(.9*e.bitrate,e.averageBitrate)/1e3)||1}const ch=["NONE","TYPE-0","TYPE-1",null];const uh=["SDR","PQ","HLG"];var dh="",hh="YES",fh="v2";function ph(e){const{canSkipUntil:t,canSkipDateRanges:n,age:i}=e;return t&&i<t/2?n?fh:hh:dh}class mh{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class gh{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(e=>!!e).map(e=>e.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const n=null==(t=e.supplemental)?void 0:t.videoCodec;n&&n!==e.videoCodec&&(this.codecSet+=",".concat(n.substring(0,4)))}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return vh(this._audioGroups,e)}hasSubtitleGroup(e){return vh(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t)if("audio"===e){let e=this._audioGroups;e||(e=this._audioGroups=[]),-1===e.indexOf(t)&&e.push(t)}else if("text"===e){let e=this._subtitleGroups;e||(e=this._subtitleGroups=[]),-1===e.indexOf(t)&&e.push(t)}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return null==(e=this.audioGroups)?void 0:e[0]}get textGroupId(){var e;return null==(e=this.subtitleGroups)?void 0:e[0]}addFallback(){}}function vh(e,t){return!(!t||!e)&&-1!==e.indexOf(t)}function yh(e,t){let n=!1,i=[];if(e&&(n="SDR"!==e,i=[e]),t){i=t.allowedVideoRanges||uh.slice(0);const e="SDR"!==i.join("")&&!t.videoCodec;n=void 0!==t.preferHDR?t.preferHDR:e&&function(){if("function"===typeof matchMedia){const e=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(e.media!==t.media)return!0===e.matches}return!1}(),n||(i=["SDR"])}return{preferHDR:n,allowedVideoRanges:i}}const _h=(e,t)=>JSON.stringify(e,(e=>{const t=new WeakSet;return(n,i)=>{if(e&&(i=e(n,i)),"object"===typeof i&&null!==i){if(t.has(i))return;t.add(i)}return i}})(t));function bh(e,t){qu.log('[abr] start candidates with "'.concat(e,'" ignored because ').concat(t))}function xh(e){return e.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const i=t.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function Sh(e){if(!e)return e;const{lang:t,assocLang:n,characteristics:i,channels:r,audioCodec:s}=e;return{lang:t,assocLang:n,characteristics:i,channels:r,audioCodec:s}}function Eh(e,t,n){if("attrs"in e){const n=t.indexOf(e);if(-1!==n)return n}for(let i=0;i<t.length;i++){if(wh(e,t[i],n))return i}return-1}function wh(e,t,n){const{groupId:i,name:r,lang:s,assocLang:a,default:o}=e,l=e.forced;return(void 0===i||t.groupId===i)&&(void 0===r||t.name===r)&&(void 0===s||function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"--";if(e.length===t.length)return e===t;return e.startsWith(t)||t.startsWith(e)}(s,t.lang))&&(void 0===s||t.assocLang===a)&&(void 0===o||t.default===o)&&(void 0===l||t.forced===l)&&(!("characteristics"in e)||function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e.split(","),i=t.split(",");return n.length===i.length&&!n.some(e=>-1===i.indexOf(e))}(e.characteristics||"",t.characteristics))&&(void 0===n||n(e,t))}function Th(e,t){const{audioCodec:n,channels:i}=e;return(void 0===n||(t.audioCodec||"").substring(0,4)===n.substring(0,4))&&(void 0===i||i===(t.channels||"2"))}function Mh(e,t,n){for(let i=t;i>-1;i--)if(n(e[i]))return i;for(let i=t+1;i<e.length;i++)if(n(e[i]))return i;return-1}function Ah(e,t){var n;return!!e&&e!==(null==(n=t.loadLevelObj)?void 0:n.uri)}const Ch=function(e,t){let n=0,i=e.length-1,r=null,s=null;for(;n<=i;){r=(n+i)/2|0,s=e[r];const a=t(s);if(a>0)n=r+1;else{if(!(a<0))return s;i=r-1}}return null};function Rh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.005,s=null;if(e){s=t[1+e.sn-t[0].sn]||null;const i=e.endDTS-n;i>0&&i<15e-7&&(n+=15e-7),s&&e.level!==s.level&&s.end<=e.end&&(s=t[2+e.sn-t[0].sn]||null)}else 0===n&&0===t[0].start&&(s=t[0]);if(s&&((!e||e.level===s.level)&&0===Lh(n,i,s)||function(e,t,n){if(t&&0===t.start&&t.level<e.level&&(t.endPTS||0)>0){const i=t.tagList.reduce((e,t)=>("INF"===t[0]&&(e+=parseFloat(t[1])),e),n);return e.start<=i}return!1}(s,e,Math.min(r,i))))return s;const a=Ch(t,Lh.bind(null,n,i));return!a||a===e&&s?s:a}function Lh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(n.start<=e&&n.start+n.duration>e)return 0;const i=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-i<=e?1:n.start-i>e&&n.start?-1:0}function Ph(e,t,n){const i=1e3*Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return(n.endProgramDateTime||0)-i>e}function Ih(e,t,n){if(e&&e.startCC<=t&&e.endCC>=t){let i=e.fragments;const{fragmentHint:r}=e;let s;return r&&(i=i.concat(r)),Ch(i,e=>e.cc<t?1:e.cc>t?-1:(s=e,e.end<=n?1:e.start>n?-1:0)),s||null}return null}function Dh(e){switch(e.details){case Cu.FRAG_LOAD_TIMEOUT:case Cu.KEY_LOAD_TIMEOUT:case Cu.LEVEL_LOAD_TIMEOUT:case Cu.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function kh(e){return e.details.startsWith("key")}function Oh(e){return kh(e)&&!!e.frag&&!e.frag.decryptdata}function Nh(e,t){const n=Dh(t);return e.default["".concat(n?"timeout":"error","Retry")]}function Fh(e,t){const n="linear"===e.backoff?1:Math.pow(2,t);return Math.min(n*e.retryDelayMs,e.maxRetryDelayMs)}function Bh(e){return Gu(Gu({},e),{errorRetry:null,timeoutRetry:null})}function Uh(e,t,n,i){if(!e)return!1;const r=null==i?void 0:i.code,s=t<e.maxNumRetry&&(function(e){return Hh(e)||!!e&&(e<400||e>499)}(r)||!!n);return e.shouldRetry?e.shouldRetry(e,t,n,i,s):s}function Hh(e){return 0===e&&!1===navigator.onLine}var zh=0,Gh=2,Vh=3,Wh=5,jh=0,Yh=1,Xh=2,Kh=4;function qh(e){const t={action:zh,flags:jh};return e&&(t.resolved=!0),t}var Jh="NOT_LOADED",Qh="APPENDING",Zh="PARTIAL",$h="OK";class ef{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Ru.BUFFER_APPENDED,this.onBufferAppended,this),e.on(Ru.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Ru.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Ru.BUFFER_APPENDED,this.onBufferAppended,this),e.off(Ru.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Ru.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let i=n.length;i--;){const t=n[i];if(!t)break;if(t.start<=e&&e<=t.end&&t.loaded)return t}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,n){const{fragments:i}=this,r=Object.keys(i);for(let s=r.length;s--;){const a=i[r[s]];if((null==a?void 0:a.body.type)===t&&(!n||a.buffered)){const t=a.body;if(t.start<=e&&e<=t.end)return t}}return null}detectEvictedFragments(e,t,n,i,r){this.timeRanges&&(this.timeRanges[e]=t);const s=(null==i?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach(i=>{const a=this.fragments[i];if(!a)return;if(s>=a.body.sn)return;if(!a.buffered&&(!a.loaded||r))return void(a.body.type===n&&this.removeFragment(a.body));const o=a.range[e];o&&(0!==o.time.length?o.time.some(e=>{const n=!this.isTimeBuffered(e.startPTS,e.endPTS,t);return n&&this.removeFragment(a.body),n}):this.removeFragment(a.body))})}detectPartialFragments(e){const t=this.timeRanges;if(!t||"initSegment"===e.frag.sn)return;const n=e.frag,i=nf(n),r=this.fragments[i];if(!r||r.buffered&&n.gap)return;const s=!n.relurl;Object.keys(t).forEach(i=>{const a=n.elementaryStreams[i];if(!a)return;const o=t[i],l=s||!0===a.partial;r.range[i]=this.getBufferedTimes(n,e.part,l,o)}),r.loaded=null,Object.keys(r.range).length?(this.bufferedEnd(r,n),tf(r)||this.removeParts(n.sn-1,n.type)):this.removeFragment(r.body)}bufferedEnd(e,t){e.buffered=!0;(e.body.endList=t.endList||e.body.endList)&&(this.endListFragments[e.body.type]=e)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=rf(n,t=>t.fragment.sn>=e))}fragBuffered(e,t){const n=nf(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,this.bufferedEnd(i,e))}getBufferedTimes(e,t,n,i){const r={time:[],partial:n},s=e.start,a=e.end,o=e.minEndPTS||a,l=e.maxStartPTS||s;for(let c=0;c<i.length;c++){const e=i.start(c)-this.bufferPadding,t=i.end(c)+this.bufferPadding;if(l>=e&&o<=t){r.time.push({startPTS:Math.max(s,i.start(c)),endPTS:Math.min(a,i.end(c))});break}if(s<t&&a>e){const e=Math.max(s,i.start(c)),t=Math.min(a,i.end(c));t>e&&(r.partial=!0,r.time.push({startPTS:e,endPTS:t}))}else if(a<=e)break}return r}getPartialFragment(e){let t,n,i,r=null,s=0;const{bufferPadding:a,fragments:o}=this;return Object.keys(o).forEach(l=>{const c=o[l];c&&tf(c)&&(n=c.body.start-a,i=c.body.end+a,e>=n&&e<=i&&(t=Math.min(e-n,i-e),s<=t&&(r=c.body,s=t)))}),r}isEndListAppended(e){const t=this.endListFragments[e];return void 0!==t&&(t.buffered||tf(t))}getState(e){const t=nf(e),n=this.fragments[t];return n?n.buffered?tf(n)?Zh:$h:Qh:Jh}isTimeBuffered(e,t,n){let i,r;for(let s=0;s<n.length;s++){if(i=n.start(s)-this.bufferPadding,r=n.end(s)+this.bufferPadding,e>=i&&t<=r)return!0;if(t<=i)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if("initSegment"===t.frag.sn||t.frag.bitrateTest)return;const n=t.frag,i=t.part?null:t,r=nf(n);this.fragments[r]={body:n,appendedPTS:null,loaded:i,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:r,type:s}=t;if("initSegment"===n.sn)return;const a=n.type;if(i){let e=this.activePartLists[a];e||(this.activePartLists[a]=e=[]),e.push(i)}this.timeRanges=r;const o=r[s];this.detectEvictedFragments(s,o,a,i)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=nf(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,n=Object.keys(t);if(!e)return n.length>0;for(let i=n.length;i--;){const r=t[n[i]];if((null==r?void 0:r.body.type)===e)return!0}return!1}hasParts(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}removeFragmentsInRange(e,t,n,i,r){i&&!this.hasGaps||Object.keys(this.fragments).forEach(s=>{const a=this.fragments[s];if(!a)return;const o=a.body;o.type!==n||i&&!o.gap||o.start<t&&o.end>e&&(a.buffered||r)&&this.removeFragment(o)})}removeFragment(e){const t=nf(e);e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const t=e.sn;this.activePartLists[e.type]=rf(n,e=>e.fragment.sn!==t)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const t=null==(e=this.hls)||null==(e=e.latestLevelDetails)?void 0:e.partList;t&&t.forEach(e=>e.clearElementaryStreamInfo())}}function tf(e){var t,n,i;return e.buffered&&!!(e.body.gap||null!=(t=e.range.video)&&t.partial||null!=(n=e.range.audio)&&n.partial||null!=(i=e.range.audiovideo)&&i.partial)}function nf(e){return"".concat(e.type,"_").concat(e.level,"_").concat(e.sn)}function rf(e,t){return e.filter(e=>{const n=t(e);return n||e.clearElementaryStreamInfo(),n})}var sf=0,af=1;class of{constructor(e,t,n){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=n}decrypt(e,t){switch(this.aesMode){case sf:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case af:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error("[AESCrypto] invalid aes mode ".concat(this.aesMode))}}}class lf{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=t.getUint32(4*i);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],r=n[1],s=n[2],a=n[3],o=this.invSubMix,l=o[0],c=o[1],u=o[2],d=o[3],h=new Uint32Array(256);let f=0,p=0,m=0;for(m=0;m<256;m++)h[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){let n=p^p<<1^p<<2^p<<3^p<<4;n=n>>>8^255&n^99,e[f]=n,t[n]=f;const o=h[f],m=h[o],g=h[m];let v=257*h[n]^16843008*n;i[f]=v<<24|v>>>8,r[f]=v<<16|v>>>16,s[f]=v<<8|v>>>24,a[f]=v,v=16843009*g^65537*m^257*o^16843008*f,l[n]=v<<24|v>>>8,c[n]=v<<16|v>>>16,u[n]=v<<8|v>>>24,d[n]=v,f?(f=o^h[h[h[g^o]]],p^=h[h[p]]):f=p=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;for(;i<t.length&&n;)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const r=this.keySize=t.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);const s=this.ksRows=4*(r+6+1);let a,o;const l=this.keySchedule=new Uint32Array(s),c=this.invKeySchedule=new Uint32Array(s),u=this.sBox,d=this.rcon,h=this.invSubMix,f=h[0],p=h[1],m=h[2],g=h[3];let v,y;for(a=0;a<s;a++)a<r?v=l[a]=t[a]:(y=v,a%r===0?(y=y<<8|y>>>24,y=u[y>>>24]<<24|u[y>>>16&255]<<16|u[y>>>8&255]<<8|u[255&y],y^=d[a/r|0]<<24):r>6&&a%r===4&&(y=u[y>>>24]<<24|u[y>>>16&255]<<16|u[y>>>8&255]<<8|u[255&y]),l[a]=v=(l[a-r]^y)>>>0);for(o=0;o<s;o++)a=s-o,y=3&o?l[a]:l[a-4],c[o]=o<4||a<=4?y:f[u[y>>>24]]^p[u[y>>>16&255]]^m[u[y>>>8&255]]^g[u[255&y]],c[o]=c[o]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,r=this.invKeySchedule,s=this.invSBox,a=this.invSubMix,o=a[0],l=a[1],c=a[2],u=a[3],d=this.uint8ArrayToUint32Array_(n);let h=d[0],f=d[1],p=d[2],m=d[3];const g=new Int32Array(e),v=new Int32Array(g.length);let y,_,b,x,S,E,w,T,M,A,C,R,L,P;const I=this.networkToHostOrderSwap;for(;t<g.length;){for(M=I(g[t]),A=I(g[t+1]),C=I(g[t+2]),R=I(g[t+3]),S=M^r[0],E=R^r[1],w=C^r[2],T=A^r[3],L=4,P=1;P<i;P++)y=o[S>>>24]^l[E>>16&255]^c[w>>8&255]^u[255&T]^r[L],_=o[E>>>24]^l[w>>16&255]^c[T>>8&255]^u[255&S]^r[L+1],b=o[w>>>24]^l[T>>16&255]^c[S>>8&255]^u[255&E]^r[L+2],x=o[T>>>24]^l[S>>16&255]^c[E>>8&255]^u[255&w]^r[L+3],S=y,E=_,w=b,T=x,L+=4;y=s[S>>>24]<<24^s[E>>16&255]<<16^s[w>>8&255]<<8^s[255&T]^r[L],_=s[E>>>24]<<24^s[w>>16&255]<<16^s[T>>8&255]<<8^s[255&S]^r[L+1],b=s[w>>>24]<<24^s[T>>16&255]<<16^s[S>>8&255]<<8^s[255&E]^r[L+2],x=s[T>>>24]<<24^s[S>>16&255]<<16^s[E>>8&255]<<8^s[255&w]^r[L+3],v[t]=I(y^h),v[t+1]=I(x^f),v[t+2]=I(b^p),v[t+3]=I(_^m),h=M,f=A,p=C,m=R,t+=4}return v.buffer}}class cf{constructor(e,t,n){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=n}expandKey(){const e=function(e){switch(e){case sf:return"AES-CBC";case af:return"AES-CTR";default:throw new Error("[FastAESKey] invalid aes mode ".concat(e))}}(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}class uf{constructor(e){let{removePKCS7Padding:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(kne){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?function(e){const t=e.byteLength,n=t&&new DataView(e.buffer).getUint8(t-1);return n?e.slice(0,t-n):e}(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n,i){return this.useSoftware?new Promise((r,s)=>{const a=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(a,t,n,i);const o=this.flush();o?r(o.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n,i)}softwareDecrypt(e,t,n,i){const{currentIV:r,currentResult:s,remainderData:a}=this;if(i!==sf||16!==t.byteLength)return qu.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),a&&(e=Id(a,e),this.remainderData=null);const o=this.getValidChunk(e);if(!o.length)return null;r&&(n=r);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new lf),l.expandKey(t);const c=s;return this.currentResult=l.decrypt(o.buffer,0,n),this.currentIV=o.slice(-16).buffer,c||null}webCryptoDecrypt(e,t,n,i){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n,i));this.key=t,this.fastAesKey=new cf(this.subtle,t,i)}return this.fastAesKey.expandKey().then(t=>{if(!this.subtle)return Promise.reject(new Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");return new of(this.subtle,new Uint8Array(n),i).decrypt(e.buffer,t)}).catch(r=>(qu.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, ".concat(r.name,": ").concat(r.message)),this.onWebCryptoError(e,t,n,i)))}onWebCryptoError(e,t,n,i){const r=this.enableSoftwareAES;if(r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n,i);const r=this.flush();if(r)return r.buffer}throw new Error("WebCrypto"+(r?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%16;return n!==e.length&&(t=e.slice(0,n),this.remainderData=e.slice(n)),t}logOnce(e){this.logEnabled&&(qu.log("[decrypter]: ".concat(e)),this.logEnabled=!1)}}const df=Math.pow(2,17);class hf{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new mf({type:Au.NETWORK_ERROR,details:Cu.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a ".concat(n?"part list":"url")),networkDetails:null}));this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise((a,o)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some(e=>"GAP"===e[0]))return void o(pf(e));e.gap=!1}const l=this.loader=r?new r(i):new s(i),c=ff(e);e.loader=l;const u=Bh(i.fragLoadPolicy.default),d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:df};e.stats=l.stats;const h={onSuccess:(t,n,i,r)=>{this.resetLoader(e,l);let s=t.data;i.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(s.slice(0,16)),s=s.slice(16)),a({frag:e,part:null,payload:s,networkDetails:r})},onError:(t,i,r,s)=>{this.resetLoader(e,l),o(new mf({type:Au.NETWORK_ERROR,details:Cu.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Gu({url:n,data:void 0},t),error:new Error("HTTP Error ".concat(t.code," ").concat(t.text)),networkDetails:r,stats:s}))},onAbort:(t,n,i)=>{this.resetLoader(e,l),o(new mf({type:Au.NETWORK_ERROR,details:Cu.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:i,stats:t}))},onTimeout:(t,n,i)=>{this.resetLoader(e,l),o(new mf({type:Au.NETWORK_ERROR,details:Cu.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error("Timeout after ".concat(d.timeout,"ms")),networkDetails:i,stats:t}))}};t&&(h.onProgress=(n,i,r,s)=>t({frag:e,part:null,payload:r,networkDetails:s})),l.load(c,d,h)})}loadPart(e,t,n){this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise((a,o)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap)return void o(pf(e,t));const l=this.loader=r?new r(i):new s(i),c=ff(e,t);e.loader=l;const u=Bh(i.fragLoadPolicy.default),d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:df};t.stats=l.stats,l.load(c,d,{onSuccess:(i,r,s,o)=>{this.resetLoader(e,l),this.updateStatsFromPart(e,t);const c={frag:e,part:t,payload:i.data,networkDetails:o};n(c),a(c)},onError:(n,i,r,s)=>{this.resetLoader(e,l),o(new mf({type:Au.NETWORK_ERROR,details:Cu.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Gu({url:c.url,data:void 0},n),error:new Error("HTTP Error ".concat(n.code," ").concat(n.text)),networkDetails:r,stats:s}))},onAbort:(n,i,r)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,l),o(new mf({type:Au.NETWORK_ERROR,details:Cu.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:r,stats:n}))},onTimeout:(n,i,r)=>{this.resetLoader(e,l),o(new mf({type:Au.NETWORK_ERROR,details:Cu.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error("Timeout after ".concat(d.timeout,"ms")),networkDetails:r,stats:n}))}})})}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,r=i.total;if(n.loaded+=i.loaded,r){const i=Math.round(e.duration/t.duration),s=Math.min(Math.round(n.loaded/r),i),a=(i-s)*Math.round(n.loaded/s);n.total=n.loaded+a}else n.total=Math.max(n.loaded,n.total);const s=n.loading,a=i.loading;s.start?s.first+=a.first-a.start:(s.start=a.start,s.first=a.first),s.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function ff(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=t||e,i={frag:e,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},r=n.byteRangeStartOffset,s=n.byteRangeEndOffset;if(wu(r)&&wu(s)){var a;let t=r,n=s;if("initSegment"===e.sn&&("AES-128"===(o=null==(a=e.decryptdata)?void 0:a.method)||"AES-256"===o)){const e=s-r;e%16&&(n=s+(16-e%16)),0!==r&&(i.resetIV=!0,t=r-16)}i.rangeStart=t,i.rangeEnd=n}var o;return i}function pf(e,t){const n=new Error("GAP ".concat(e.gap?"tag":"attribute"," found")),i={type:Au.MEDIA_ERROR,details:Cu.FRAG_GAP,fatal:!1,frag:e,error:n,networkDetails:null};return t&&(i.part=t),(t||e).stats.aborted=!0,new mf(i)}class mf extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class gf extends Vu{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class vf{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=r,this.partial=s}}const yf={length:0,start:()=>0,end:()=>0};class _f{static isBuffered(e,t){if(e){const n=_f.getBuffered(e);for(let e=n.length;e--;)if(t>=n.start(e)&&t<=n.end(e))return!0}return!1}static bufferedRanges(e){if(e){const t=_f.getBuffered(e);return _f.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}static bufferInfo(e,t,n){if(e){const i=_f.bufferedRanges(e);if(i.length)return _f.bufferedInfo(i,t,n)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.length>1&&e.sort((e,t)=>e.start-t.start||t.end-e.end);let i=-1,r=[];if(n)for(let c=0;c<e.length;c++){t>=e[c].start&&t<=e[c].end&&(i=c);const s=r.length;if(s){const t=r[s-1].end;e[c].start-t<n?e[c].end>t&&(r[s-1].end=e[c].end):r.push(e[c])}else r.push(e[c])}else r=e;let s,a=0,o=t,l=t;for(let c=0;c<r.length;c++){const e=r[c].start,u=r[c].end;if(-1===i&&t>=e&&t<=u&&(i=c),t+n>=e&&t<u)o=e,l=u,a=l-t;else if(t+n<e){s=e;break}}return{len:a,start:o||0,end:l||0,nextStart:s,buffered:e,bufferedIndex:i}}static getBuffered(e){try{return e.buffered||yf}catch(kne){return qu.log("failed to get media.buffered",kne),yf}}}const bf=/\{\$([a-zA-Z0-9-_]+)\}/g;function xf(e){return bf.test(e)}function Sf(e,t){if(null!==e.variableList||e.hasVariableRefs){const n=e.variableList;return t.replace(bf,t=>{const i=t.substring(2,t.length-1),r=null==n?void 0:n[i];return void 0===r?(e.playlistParsingError||(e.playlistParsingError=new Error('Missing preceding EXT-X-DEFINE tag for Variable Reference: "'.concat(i,'"'))),t):r})}return t}function Ef(e,t,n){let i,r,s=e.variableList;if(s||(e.variableList=s={}),"QUERYPARAM"in t){i=t.QUERYPARAM;try{const e=new self.URL(n).searchParams;if(!e.has(i))throw new Error('"'.concat(i,'" does not match any query parameter in URI: "').concat(n,'"'));r=e.get(i)}catch(a){e.playlistParsingError||(e.playlistParsingError=new Error("EXT-X-DEFINE QUERYPARAM: ".concat(a.message)))}}else i=t.NAME,r=t.VALUE;i in s?e.playlistParsingError||(e.playlistParsingError=new Error('EXT-X-DEFINE duplicate Variable Name declarations: "'.concat(i,'"'))):s[i]=r||""}function wf(e,t,n){const i=t.IMPORT;if(n&&i in n){let t=e.variableList;t||(e.variableList=t={}),t[i]=n[i]}else e.playlistParsingError||(e.playlistParsingError=new Error('EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "'.concat(i,'"')))}const Tf=/^(\d+)x(\d+)$/,Mf=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Af{constructor(e,t){"string"===typeof e&&(e=Af.parseAttrList(e,t)),Hu(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>"X-"===e.substring(0,2))}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;const n=new Uint8Array(t.length/2);for(let e=0;e<t.length/2;e++)n[e]=parseInt(t.slice(2*e,2*e+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const n=this[e];return(n?n.split(/[ ,]+/):[]).reduce((e,t)=>(e[t.toLowerCase()]=!0,e),t)}bool(e){return"YES"===this[e]}decimalResolution(e){const t=Tf.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let n;const i={};for(Mf.lastIndex=0;null!==(n=Mf.exec(e));){const r=n[1].trim();let s=n[2];const a=0===s.indexOf('"')&&s.lastIndexOf('"')===s.length-1;let o=!1;if(a)s=s.slice(1,-1);else switch(r){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":o=!0}if(t&&(a||o))s=Sf(t,s);else if(!o&&!a)switch(r){case"CLOSED-CAPTIONS":if("NONE"===s)break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":qu.warn("".concat(e,": attribute ").concat(r," is missing quotes"))}i[r]=s}return i}}function Cf(e){return"ID"!==e&&"CLASS"!==e&&"CUE"!==e&&"START-DATE"!==e&&"DURATION"!==e&&"END-DATE"!==e&&"END-ON-NEXT"!==e}function Rf(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e||"SCTE35-CMD"===e}class Lf{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;var i;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(null==t?void 0:t.tagAnchor)||null,this.tagOrder=null!=(i=null==t?void 0:t.tagOrder)?i:n,t){const n=t.attr;for(const t in n)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==n[t]){qu.warn('DATERANGE tag attribute: "'.concat(t,'" does not match for tags with ID: "').concat(e.ID,'"')),this._badValueForSameId=t;break}e=Hu(new Af({}),n,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const e=(null==t?void 0:t.endDate)||new Date(this.attr["END-DATE"]);wu(e.getTime())&&(this._endDate=e)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return void 0===e?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return null===e||null===e.programDateTime?(qu.warn('Expected tagAnchor Fragment with PDT set for DateRange "'.concat(this.id,'": ').concat(e)),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return null!==t?this._dateAtEnd=new Date(this._startDate.getTime()+1e3*t):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(wu(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return"com.apple.hls.interstitial"===this.class}get isValid(){return!!this.id&&!this._badValueForSameId&&wu(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}class Pf{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(t=>{let n=t.decryptdata;return n||(t.setKeyFormat(e.keyFormat),n=t.decryptdata),!!n&&e.matches(n)})}get hasProgramDateTime(){return!!this.fragments.length&&wu(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const e=this.driftEndTime-this.driftStartTime;if(e>0){return 1e3*(this.driftEnd-this.driftStart)/e}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(-1!==t){for(let n=e.length;n--;)if(e[n].index>t)return e[n].index;return t}}return 0}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function If(e,t){return e.length===t.length&&!e.some((e,n)=>e!==t[n])}function Df(e,t){return!e&&!t||!(!e||!t)&&If(e,t)}function kf(e){return"AES-128"===e||"AES-256"===e||"AES-256-CTR"===e}function Of(e){switch(e){case"AES-128":case"AES-256":return sf;case"AES-256-CTR":return af;default:throw new Error("invalid full segment method ".concat(e))}}function Nf(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0))}function Ff(e){return Uint8Array.from(unescape(encodeURIComponent(e)),e=>e.charCodeAt(0))}function Bf(e){const t=function(e,t,n){const i=e[t];e[t]=e[n],e[n]=i};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}function Uf(e){const t=e.split(":");let n=null;if("data"===t[0]&&2===t.length){const e=t[1].split(";"),i=e[e.length-1].split(",");if(2===i.length){const t="base64"===i[0],r=i[1];t?(e.splice(-1,1),n=Nf(r)):n=function(e){const t=Ff(e).subarray(0,16),n=new Uint8Array(16);return n.set(t,16-t.length),n}(r)}}return n}const Hf="undefined"!==typeof self?self:void 0;var zf={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Gf="org.w3.clearkey",Vf="com.apple.streamingkeydelivery",Wf="com.microsoft.playready",jf="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function Yf(e){switch(e){case Vf:return zf.FAIRPLAY;case Wf:return zf.PLAYREADY;case jf:return zf.WIDEVINE;case Gf:return zf.CLEARKEY}}function Xf(e){switch(e){case zf.FAIRPLAY:return Vf;case zf.PLAYREADY:return Wf;case zf.WIDEVINE:return jf;case zf.CLEARKEY:return Gf}}function Kf(e){const{drmSystems:t,widevineLicenseUrl:n}=e,i=t?[zf.FAIRPLAY,zf.WIDEVINE,zf.PLAYREADY,zf.CLEARKEY].filter(e=>!!t[e]):[];return!i[zf.WIDEVINE]&&n&&i.push(zf.WIDEVINE),i}const qf=null!=Hf&&null!=(Jf=Hf.navigator)&&Jf.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;var Jf;function Qf(e){const t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),n=String.fromCharCode.apply(null,Array.from(t)),i=n.substring(n.indexOf("<"),n.length),r=(new DOMParser).parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(r){const e=r.childNodes[0]?r.childNodes[0].nodeValue:r.getAttribute("VALUE");if(e){const t=Nf(e).subarray(0,16);return Bf(t),t}}return null}let Zf={};class $f{static clearKeyUriToKeyIdMap(){Zf={}}static setKeyIdForUri(e,t){Zf[e]=t}static addKeyIdForUri(e){const t=Object.keys(Zf).length%Number.MAX_SAFE_INTEGER,n=new Uint8Array(16);return new DataView(n.buffer,12,4).setUint32(0,t),Zf[e]=n,n}constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5?arguments[5]:void 0;this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=r,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&!kf(e),null!=s&&s.startsWith("0x")&&(this.keyId=new Uint8Array(ed(s)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&If(e.keyFormatVersions,this.keyFormatVersions)&&Df(e.iv,this.iv)&&Df(e.keyId,this.keyId)}isSupported(){if(this.method){if(kf(this.method)||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case Vf:case jf:case Wf:case Gf:return-1!==["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e,t){if(!this.encrypted||!this.uri)return null;if(kf(this.method)){let t=this.iv;t||("number"!==typeof e&&(qu.warn('missing IV for initialization segment with method="'.concat(this.method,'" - compliance issue')),e=0),t=function(e){const t=new Uint8Array(16);for(let n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t}(e));return new $f(this.method,this.uri,"identity",this.keyFormatVersions,t)}if(this.keyId){const e=Zf[this.uri];if(e&&!If(this.keyId,e)&&$f.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const n=Uf(this.uri);if(n)switch(this.keyFormat){case jf:if(this.pssh=n,!this.keyId){const e=function(e){const t=[];if(e instanceof ArrayBuffer){const n=e.byteLength;let i=0;for(;i+32<n;){const n=Ud(new DataView(e,i));t.push(n),i+=n.size}}return t}(n.buffer);if(e.length){var i;const t=e[0];this.keyId=null!=(i=t.kids)&&i.length?t.kids[0]:null}}this.keyId||(this.keyId=ep(t));break;case Wf:{const e=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=Bd(e,0,n),this.keyId=Qf(n);break}default:{let e=n.subarray(0,16);if(16!==e.length){const t=new Uint8Array(16);t.set(e,16-e.length),e=t}this.keyId=e;break}}if(!this.keyId||16!==this.keyId.byteLength){let e;e=function(e){const t=null==e?void 0:e[jf];if(t)return t.keyId;return null}(t),e||(e=ep(t),e||(e=Zf[this.uri])),e&&(this.keyId=e,$f.setKeyIdForUri(this.uri,e))}return this}}function ep(e){const t=null==e?void 0:e[Wf];if(t){const e=Uf(t.uri);if(e)return Qf(e)}return null}const tp=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,np=/#EXT-X-MEDIA:(.*)/g,ip=/^#EXT(?:INF|-X-TARGETDURATION):/m,rp=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),sp=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class ap{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static resolve(e,t){return rd.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return ip.test(e)}static parseMasterPlaylist(e,t){const n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:xf(e)},i=[];if(tp.lastIndex=0,!e.startsWith("#EXTM3U"))return n.playlistParsingError=new Error("no EXTM3U delimiter"),n;let r;for(;null!=(r=tp.exec(e));)if(r[1]){var s;const e=new Af(r[1],n),a=Sf(n,r[2]),o={attrs:e,bitrate:e.decimalInteger("BANDWIDTH")||e.decimalInteger("AVERAGE-BANDWIDTH"),name:e.NAME,url:ap.resolve(a,t)},l=e.decimalResolution("RESOLUTION");l&&(o.width=l.width,o.height=l.height),dp(e.CODECS,o);const c=e["SUPPLEMENTAL-CODECS"];c&&(o.supplemental={},dp(c,o.supplemental)),null!=(s=o.unknownCodecs)&&s.length||i.push(o),n.levels.push(o)}else if(r[3]){const e=r[3],i=r[4];switch(e){case"SESSION-DATA":{const e=new Af(i,n),t=e["DATA-ID"];t&&(null===n.sessionData&&(n.sessionData={}),n.sessionData[t]=e);break}case"SESSION-KEY":{const e=cp(i,t,n);e.encrypted&&e.isSupported()?(null===n.sessionKeys&&(n.sessionKeys=[]),n.sessionKeys.push(e)):qu.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'.concat(i,'"'));break}case"DEFINE":Ef(n,new Af(i,n),t);break;case"CONTENT-STEERING":{const e=new Af(i,n);n.contentSteering={uri:ap.resolve(e["SERVER-URI"],t),pathwayId:e["PATHWAY-ID"]||"."};break}case"START":n.startTimeOffset=up(i)}}const a=i.length>0&&i.length<n.levels.length;return n.levels=a?i:n.levels,0===n.levels.length&&(n.playlistParsingError=new Error("no levels found in manifest")),n}static parseMasterPlaylistMedia(e,t,n){let i;const r={},s=n.levels,a={AUDIO:s.map(e=>({id:e.attrs.AUDIO,audioCodec:e.audioCodec})),SUBTITLES:s.map(e=>({id:e.attrs.SUBTITLES,textCodec:e.textCodec})),"CLOSED-CAPTIONS":[]};let o=0;for(np.lastIndex=0;null!==(i=np.exec(e));){const e=new Af(i[1],n),s=e.TYPE;if(s){const n=a[s],i=r[s]||[];r[s]=i;const l=e.LANGUAGE,c=e["ASSOC-LANGUAGE"],u=e.CHANNELS,d=e.CHARACTERISTICS,h=e["INSTREAM-ID"],f={attrs:e,bitrate:0,id:o++,groupId:e["GROUP-ID"]||"",name:e.NAME||l||"",type:s,default:e.bool("DEFAULT"),autoselect:e.bool("AUTOSELECT"),forced:e.bool("FORCED"),lang:l,url:e.URI?ap.resolve(e.URI,t):""};if(c&&(f.assocLang=c),u&&(f.channels=u),d&&(f.characteristics=d),h&&(f.instreamId=h),null!=n&&n.length){const e=ap.findGroup(n,f.groupId)||n[0];hp(f,e,"audioCodec"),hp(f,e,"textCodec")}i.push(f)}}return r}static parseLevelPlaylist(e,t,n,i,r,s){var a;const o={url:t},l=new Pf(t),c=l.fragments,u=[];let d,h,f,p,m=null,g=0,v=0,y=0,_=0,b=0,x=null,S=new dd(i,o),E=-1,w=!1,T=null;if(rp.lastIndex=0,l.m3u8=e,l.hasVariableRefs=xf(e),"#EXTM3U"!==(null==(a=rp.exec(e))?void 0:a[0]))return l.playlistParsingError=new Error("Missing format identifier #EXTM3U"),l;for(;null!==(d=rp.exec(e));){w&&(w=!1,S=new dd(i,o),S.playlistOffset=y,S.setStart(y),S.sn=g,S.cc=_,b&&(S.bitrate=b),S.level=n,m&&(S.initSegment=m,m.rawProgramDateTime&&(S.rawProgramDateTime=m.rawProgramDateTime,m.rawProgramDateTime=null),T&&(S.setByteRange(T),T=null)));const e=d[1];if(e){S.duration=parseFloat(e);const t=(" "+d[2]).slice(1);S.title=t||null,S.tagList.push(t?["INF",e,t]:["INF",e])}else if(d[3]){if(wu(S.duration)){S.playlistOffset=y,S.setStart(y),f&&mp(S,f,l),S.sn=g,S.level=n,S.cc=_,c.push(S);const e=(" "+d[3]).slice(1);S.relurl=Sf(l,e),fp(S,x,u),x=S,y+=S.duration,g++,v=0,w=!0}}else{if(d=d[0].match(sp),!d){qu.warn("No matches on slow regex match for level playlist!");continue}for(h=1;h<d.length&&void 0===d[h];h++);const e=(" "+d[h]).slice(1),r=(" "+d[h+1]).slice(1),a=d[h+2]?(" "+d[h+2]).slice(1):null;switch(e){case"BYTERANGE":x?S.setByteRange(r,x):S.setByteRange(r);break;case"PROGRAM-DATE-TIME":S.rawProgramDateTime=r,S.tagList.push(["PROGRAM-DATE-TIME",r]),-1===E&&(E=c.length);break;case"PLAYLIST-TYPE":l.type&&gp(l,e,d),l.type=r.toUpperCase();break;case"MEDIA-SEQUENCE":0!==l.startSN?gp(l,e,d):c.length>0&&vp(l,e,d),g=l.startSN=parseInt(r);break;case"SKIP":{l.skippedSegments&&gp(l,e,d);const t=new Af(r,l),n=t.decimalInteger("SKIPPED-SEGMENTS");if(wu(n)){l.skippedSegments+=n;for(let e=n;e--;)c.push(null);g+=n}const i=t.enumeratedString("RECENTLY-REMOVED-DATERANGES");i&&(l.recentlyRemovedDateranges=(l.recentlyRemovedDateranges||[]).concat(i.split("\t")));break}case"TARGETDURATION":0!==l.targetduration&&gp(l,e,d),l.targetduration=Math.max(parseInt(r),1);break;case"VERSION":null!==l.version&&gp(l,e,d),l.version=parseInt(r);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":l.live||gp(l,e,d),l.live=!1;break;case"#":(r||a)&&S.tagList.push(a?[r,a]:[r]);break;case"DISCONTINUITY":_++,S.tagList.push(["DIS"]);break;case"GAP":S.gap=!0,S.tagList.push([e]);break;case"BITRATE":S.tagList.push([e,r]),b=1e3*parseInt(r),wu(b)?S.bitrate=b:b=0;break;case"DATERANGE":{const e=new Af(r,l),t=new Lf(e,l.dateRanges[e.ID],l.dateRangeTagCount);l.dateRangeTagCount++,t.isValid||l.skippedSegments?l.dateRanges[t.id]=t:qu.warn('Ignoring invalid DATERANGE tag: "'.concat(r,'"')),S.tagList.push(["EXT-X-DATERANGE",r]);break}case"DEFINE":{const e=new Af(r,l);"IMPORT"in e?wf(l,e,s):Ef(l,e,t)}break;case"DISCONTINUITY-SEQUENCE":0!==l.startCC?gp(l,e,d):c.length>0&&vp(l,e,d),l.startCC=_=parseInt(r);break;case"KEY":{const e=cp(r,t,l);if(e.isSupported()){if("NONE"===e.method){f=void 0;break}f||(f={});const t=f[e.keyFormat];null!=t&&t.matches(e)||(t&&(f=Hu({},f)),f[e.keyFormat]=e)}else qu.warn('[Keys] Ignoring unsupported EXT-X-KEY tag: "'.concat(r,'"'));break}case"START":l.startTimeOffset=up(r);break;case"MAP":{const e=new Af(r,l);if(S.duration){const t=new dd(i,o);pp(t,e,n,f),m=t,S.initSegment=m,m.rawProgramDateTime&&!S.rawProgramDateTime&&(S.rawProgramDateTime=m.rawProgramDateTime)}else{const t=S.byteRangeEndOffset;if(t){const e=S.byteRangeStartOffset;T="".concat(t-e,"@").concat(e)}else T=null;pp(S,e,n,f),m=S,w=!0}m.cc=_;break}case"SERVER-CONTROL":p&&gp(l,e,d),p=new Af(r),l.canBlockReload=p.bool("CAN-BLOCK-RELOAD"),l.canSkipUntil=p.optionalFloat("CAN-SKIP-UNTIL",0),l.canSkipDateRanges=l.canSkipUntil>0&&p.bool("CAN-SKIP-DATERANGES"),l.partHoldBack=p.optionalFloat("PART-HOLD-BACK",0),l.holdBack=p.optionalFloat("HOLD-BACK",0);break;case"PART-INF":{l.partTarget&&gp(l,e,d);const t=new Af(r);l.partTarget=t.decimalFloatingPoint("PART-TARGET");break}case"PART":{let e=l.partList;e||(e=l.partList=[]);const t=v>0?e[e.length-1]:void 0,n=v++,i=new Af(r,l),s=new hd(i,S,o,n,t);e.push(s),S.duration+=s.duration;break}case"PRELOAD-HINT":{const e=new Af(r,l);l.preloadHint=e;break}case"RENDITION-REPORT":{const e=new Af(r,l);l.renditionReports=l.renditionReports||[],l.renditionReports.push(e);break}default:qu.warn("line parsed but not handled: ".concat(d))}}}x&&!x.relurl?(c.pop(),y-=x.duration,l.partList&&(l.fragmentHint=x)):l.partList&&(fp(S,x,u),S.cc=_,l.fragmentHint=S,f&&mp(S,f,l)),l.targetduration||(l.playlistParsingError=new Error("Missing Target Duration"));const M=c.length,A=c[0],C=c[M-1];if(y+=l.skippedSegments*l.targetduration,y>0&&M&&C){l.averagetargetduration=y/M;const e=C.sn;l.endSN="initSegment"!==e?e:0,l.live||(C.endList=!0),E>0&&(!function(e,t){let n=e[t];for(let i=t;i--;){const t=e[i];if(!t)return;t.programDateTime=n.programDateTime-1e3*t.duration,n=t}}(c,E),A&&u.unshift(A))}return l.fragmentHint&&(y+=l.fragmentHint.duration),l.totalduration=y,u.length&&l.dateRangeTagCount&&A&&op(u,l),l.endCC=_,l}}function op(e,t){let n=e.length;if(!n){if(!t.hasProgramDateTime)return;{const i=t.fragments[t.fragments.length-1];e.push(i),n++}}const i=e[n-1],r=t.live?1/0:t.totalduration,s=Object.keys(t.dateRanges);for(let o=s.length;o--;){const l=t.dateRanges[s[o]],c=l.startDate.getTime();l.tagAnchor=i.ref;for(let i=n;i--;){var a;if((null==(a=e[i])?void 0:a.sn)<t.startSN)break;const n=lp(t,c,e,i,r);if(-1!==n){l.tagAnchor=t.fragments[n].ref;break}}}}function lp(e,t,n,i,r){const s=n[i];if(s){const o=s.programDateTime;if(t>=o||0===i){var a;if(t<=o+1e3*(((null==(a=n[i+1])?void 0:a.start)||r)-s.start)){const r=n[i].sn-e.startSN;if(r<0)return-1;const s=e.fragments;if(s.length>n.length){for(let a=(n[i+1]||s[s.length-1]).sn-e.startSN;a>r;a--){const e=s[a].programDateTime;if(t>=e&&t<e+1e3*s[a].duration)return a}}return r}}}return-1}function cp(e,t,n){var i,r;const s=new Af(e,n),a=null!=(i=s.METHOD)?i:"",o=s.URI,l=s.hexadecimalInteger("IV"),c=s.KEYFORMATVERSIONS,u=null!=(r=s.KEYFORMAT)?r:"identity";o&&s.IV&&!l&&qu.error("Invalid IV: ".concat(s.IV));const d=o?ap.resolve(o,t):"",h=(c||"1").split("/").map(Number).filter(Number.isFinite);return new $f(a,d,u,h,l,s.KEYID)}function up(e){const t=new Af(e).decimalFloatingPoint("TIME-OFFSET");return wu(t)?t:null}function dp(e,t){let n=(e||"").split(/[ ,]+/).filter(e=>e);["video","audio","text"].forEach(e=>{const i=n.filter(t=>Gd(t,e));i.length&&(t["".concat(e,"Codec")]=i.map(e=>e.split("/")[0]).join(","),n=n.filter(e=>-1===i.indexOf(e)))}),t.unknownCodecs=n}function hp(e,t,n){const i=t[n];i&&(e[n]=i)}function fp(e,t,n){e.rawProgramDateTime?n.push(e):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime)}function pp(e,t,n,i){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=n,e.sn="initSegment",i&&(e.levelkeys=i),e.initSegment=null}function mp(e,t,n){e.levelkeys=t;const{encryptedFragments:i}=n;i.length&&i[i.length-1].levelkeys===t||!Object.keys(t).some(e=>t[e].isCommonEncryption)||i.push(e)}function gp(e,t,n){e.playlistParsingError=new Error("#EXT-X-".concat(t," must not appear more than once (").concat(n[0],")"))}function vp(e,t,n){e.playlistParsingError=new Error("#EXT-X-".concat(t," must appear before the first Media Segment (").concat(n[0],")"))}function yp(e,t){const n=t.startPTS;if(wu(n)){let i,r=0;t.sn>e.sn?(r=n-e.start,i=e):(r=e.start-n,i=t),i.duration!==r&&i.setDuration(r)}else if(t.sn>e.sn){e.cc===t.cc&&e.minEndPTS?t.setStart(e.start+(e.minEndPTS-e.start)):t.setStart(e.start+e.duration)}else t.setStart(Math.max(e.start-t.duration,0))}function _p(e,t,n,i,r,s,a){i-n<=0&&(a.warn("Fragment should have a positive duration",t),i=n+t.duration,s=r+t.duration);let o=n,l=i;const c=t.startPTS,u=t.endPTS;if(wu(c)){const d=Math.abs(c-n);e&&d>e.totalduration?a.warn("media timestamps and playlist times differ by ".concat(d,"s for level ").concat(t.level," ").concat(e.url)):wu(t.deltaPTS)?t.deltaPTS=Math.max(d,t.deltaPTS):t.deltaPTS=d,o=Math.max(n,c),n=Math.min(n,c),r=void 0!==t.startDTS?Math.min(r,t.startDTS):r,l=Math.min(i,u),i=Math.max(i,u),s=void 0!==t.endDTS?Math.max(s,t.endDTS):s}const d=n-t.start;0!==t.start&&t.setStart(n),t.setDuration(i-t.start),t.startPTS=n,t.maxStartPTS=o,t.startDTS=r,t.endPTS=i,t.minEndPTS=l,t.endDTS=s;const h=t.sn;if(!e||h<e.startSN||h>e.endSN)return 0;let f;const p=h-e.startSN,m=e.fragments;for(m[p]=t,f=p;f>0;f--)yp(m[f],m[f-1]);for(f=p;f<m.length-1;f++)yp(m[f],m[f+1]);return e.fragmentHint&&yp(m[m.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,d}function bp(e,t,n){if(e===t)return;let i=null;const r=e.fragments;for(let u=r.length-1;u>=0;u--){const e=r[u].initSegment;if(e){i=e;break}}let s;e.fragmentHint&&delete e.fragmentHint.endPTS,function(e,t,n){const i=t.skippedSegments,r=Math.max(e.startSN,t.startSN)-t.startSN,s=(e.fragmentHint?1:0)+(i?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,a=t.startSN-e.startSN,o=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;for(let c=r;c<=s;c++){const r=l[a+c];let s=o[c];if(i&&!s&&r&&(s=t.fragments[c]=r),r&&s){n(r,s,c,o);const i=r.relurl,a=s.relurl;if(i&&Rp(i,a))return void(t.playlistParsingError=xp("media sequence mismatch ".concat(s.sn,":"),e,t,r,s));if(r.cc!==s.cc)return void(t.playlistParsingError=xp("discontinuity sequence mismatch (".concat(r.cc,"!=").concat(s.cc,")"),e,t,r,s))}}}(e,t,(e,n,r,a)=>{if((!t.startCC||t.skippedSegments)&&n.cc!==e.cc){const i=e.cc-n.cc;for(let e=r;e<a.length;e++)a[e].cc+=i;t.endCC=a[a.length-1].cc}wu(e.startPTS)&&wu(e.endPTS)&&(n.setStart(n.startPTS=e.startPTS),n.startDTS=e.startDTS,n.maxStartPTS=e.maxStartPTS,n.endPTS=e.endPTS,n.endDTS=e.endDTS,n.minEndPTS=e.minEndPTS,n.setDuration(e.endPTS-e.startPTS),n.duration&&(s=n),t.PTSKnown=t.alignedSliding=!0),e.hasStreams&&(n.elementaryStreams=e.elementaryStreams),n.loader=e.loader,e.hasStats&&(n.stats=e.stats),e.initSegment&&(n.initSegment=e.initSegment,i=e.initSegment)});const a=t.fragments,o=t.fragmentHint?a.concat(t.fragmentHint):a;if(i&&o.forEach(e=>{var t;!e||e.initSegment&&e.initSegment.relurl!==(null==(t=i)?void 0:t.relurl)||(e.initSegment=i)}),t.skippedSegments){if(t.deltaUpdateFailed=a.some(e=>!e),t.deltaUpdateFailed){n.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let e=t.skippedSegments;e--;)a.shift();t.startSN=a[0].sn}else{t.canSkipDateRanges&&(t.dateRanges=function(e,t,n){const{dateRanges:i,recentlyRemovedDateranges:r}=t,s=Hu({},e);r&&r.forEach(e=>{delete s[e]});const a=Object.keys(s).length;if(!a)return i;return Object.keys(i).forEach(e=>{const t=s[e],r=new Lf(i[e].attr,t);r.isValid?(s[e]=r,t||(r.tagOrder+=a)):n.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'.concat(_h(i[e].attr),'"'))}),s}(e.dateRanges,t,n));const i=e.fragments.filter(e=>e.rawProgramDateTime);if(e.hasProgramDateTime&&!t.hasProgramDateTime)for(let e=1;e<o.length;e++)null===o[e].programDateTime&&fp(o[e],o[e-1],i);op(i,t)}t.endCC=a[a.length-1].cc}if(!t.startCC){var l;const n=Tp(e,t.startSN-1);t.startCC=null!=(l=null==n?void 0:n.cc)?l:a[0].cc}!function(e,t,n){if(e&&t){let i=0;for(let r=0,s=e.length;r<=s;r++){const s=e[r],a=t[r+i];s&&a&&s.index===a.index&&s.fragment.sn===a.fragment.sn?n(s,a):i--}}}(e.partList,t.partList,(e,t)=>{t.elementaryStreams=e.elementaryStreams,t.stats=e.stats}),s?_p(t,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS,n):Sp(e,t),a.length&&(t.totalduration=t.edge-a[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;const c=t.advancedDateTime;if(t.advanced&&c){const e=t.edge;t.driftStart||(t.driftStartTime=c,t.driftStart=e),t.driftEndTime=c,t.driftEnd=e}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime;-1===t.requestScheduled&&(t.requestScheduled=e.requestScheduled)}function xp(e,t,n,i,r){return new Error("".concat(e," ").concat(r.url,"\nPlaylist starting @").concat(t.startSN,"\n").concat(t.m3u8,"\n\nPlaylist starting @").concat(n.startSN,"\n").concat(n.m3u8))}function Sp(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=t.startSN+t.skippedSegments-e.startSN,r=e.fragments,s=i>=0;let a=0;if(s&&i<r.length)a=r[i].start;else if(s&&t.startSN===e.endSN+1)a=e.fragmentEnd;else if(s&&n)a=e.fragmentStart+i*t.levelTargetDuration;else{if(t.skippedSegments||0!==t.fragmentStart)return;a=e.fragmentStart}Ep(t,a)}function Ep(e,t){if(t){const n=e.fragments;for(let i=e.skippedSegments;i<n.length;i++)n[i].addStart(t);e.fragmentHint&&e.fragmentHint.addStart(t)}}function wp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=1e3*e.targetduration;if(e.updated){const i=e.fragments,r=4;if(i.length&&n*r>t){const e=1e3*i[i.length-1].duration;e<n&&(n=e)}}else n/=2;return Math.round(n)}function Tp(e,t,n){if(!e)return null;let i=e.fragments[t-e.startSN];return i||(i=e.fragmentHint,i&&i.sn===t?i:t<e.startSN&&n&&n.sn===t?n:null)}function Mp(e,t,n){return e?Ap(e.partList,t,n):null}function Ap(e,t,n){if(e)for(let i=e.length;i--;){const r=e[i];if(r.index===n&&r.fragment.sn===t)return r}return null}function Cp(e){e.forEach((e,t)=>{var n;null==(n=e.details)||n.fragments.forEach(e=>{e.level=t,e.initSegment&&(e.initSegment.level=t)})})}function Rp(e,t){return!(e===t||!t)&&Lp(e)!==Lp(t)}function Lp(e){return e.replace(/\?[^?]*$/,"")}function Pp(e,t){for(let i=0,r=e.length;i<r;i++){var n;if((null==(n=e[i])?void 0:n.cc)===t)return e[i]}return null}function Ip(e,t){const n=e.start+t;e.startPTS=n,e.setStart(n),e.endPTS=n+e.duration}function Dp(e,t){const n=t.fragments;for(let i=0,r=n.length;i<r;i++)Ip(n[i],e);t.fragmentHint&&Ip(t.fragmentHint,e),t.alignedSliding=!0}function kp(e,t){if(!function(e,t){return!!(e&&t.startCC<e.endCC&&t.endCC>e.startCC)}(t,e))return;const n=Math.min(t.endCC,e.endCC),i=Pp(t.fragments,n),r=Pp(e.fragments,n);if(!i||!r)return;qu.log("Aligning playlist at start of dicontinuity sequence ".concat(n));Dp(i.start-r.start,e)}function Op(e,t){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;const n=e.fragments,i=t.fragments;if(!n.length||!i.length)return;let r,s;const a=Math.min(t.endCC,e.endCC);t.startCC<a&&e.startCC<a&&(r=Pp(i,a),s=Pp(n,a)),r&&s||(r=i[Math.floor(i.length/2)],s=Pp(n,r.cc)||n[Math.floor(n.length/2)]);const o=r.programDateTime,l=s.programDateTime;if(!o||!l)return;Dp((l-o)/1e3-(s.start-r.start),e)}function Np(e,t,n){Fp(e,t,n),e.addEventListener(t,n)}function Fp(e,t,n){e.removeEventListener(t,n)}const Bp=function(e){let t="";const n=e.length;for(let i=0;i<n;i++)t+="[".concat(e.start(i).toFixed(3),"-").concat(e.end(i).toFixed(3),"]");return t},Up="STOPPED",Hp="IDLE",zp="KEY_LOADING",Gp="FRAG_LOADING",Vp="FRAG_LOADING_WAITING_RETRY",Wp="WAITING_TRACK",jp="PARSING",Yp="PARSED",Xp="ENDED",Kp="ERROR",qp="WAITING_INIT_PTS",Jp="WAITING_LEVEL";class Qp extends gf{constructor(e,t,n,i,r){super(i,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Up,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:e,fragCurrent:t,media:n,mediaBuffer:i,state:r}=this,s=n?n.currentTime:0,a=_f.bufferInfo(i||n,s,e.maxBufferHole),o=!a.len;if(this.log("Media seeking to ".concat(wu(s)?s.toFixed(3):s,", state: ").concat(r,", ").concat(o?"out of":"in"," buffer")),this.state===Xp)this.resetLoadingState();else if(t){const n=e.maxFragLookUpTolerance,i=t.start-n,r=t.start+t.duration+n;if(o||r<a.start||i>a.end){const e=s>r;(s<i||e)&&(e&&t.loader&&(this.log("Cancelling fragment load for seek (sn: ".concat(t.sn,")")),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(n){this.fragmentTracker.removeFragmentsInRange(s,1/0,this.playlistType,!0);if(s>this.lastCurrentTime&&(this.lastCurrentTime=s),!this.loadingParts){const e=Math.max(a.end,s),t=this.shouldLoadParts(this.getLevelDetails(),e);t&&(this.log("LL-Part loading ON after seeking to ".concat(s.toFixed(2)," with buffer @").concat(e.toFixed(2))),this.loadingParts=t)}}this.hls.hasEnoughToStart||(this.log("Setting ".concat(o?"startPosition":"nextLoadPosition"," to ").concat(s," for seek without enough to start")),this.nextLoadPosition=s,o&&(this.startPosition=s)),o&&this.state===Hp&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=r,this.hls=e,this.fragmentLoader=new hf(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new uf(e.config)}registerListeners(){const{hls:e}=this;e.on(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Ru.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Ru.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Ru.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Ru.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===Up)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Up}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return-1===t&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const n=e.end||0,i=this.config.timelineOffset||0;if(n<=i)return!1;const r=e.buffered;this.config.maxBufferHole&&r&&r.length>1&&(e=_f.bufferedInfo(r,e.start,0));const s=e.nextStart;if(s&&s>i&&s<t.edge)return!1;if(this.media.currentTime<e.start)return!1;const a=t.partList;if(null!=a&&a.length){const e=a[a.length-1];return _f.isBuffered(this.media,e.start+e.duration/2)}const o=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(o)}getLevelDetails(){if(this.levels&&null!==this.levelLastLoaded)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;var t;return e?(null==(t=this.getLevelDetails())?void 0:t.appliedTimelineOffset)||e:0}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;Np(n,"seeking",this.onMediaSeeking),Np(n,"ended",this.onMediaEnded);const i=this.config;this.levels&&i.autoStartLoad&&this.state===Up&&this.startLoad(i.startPosition)}onMediaDetaching(e,t){const n=!!t.transferMedia,i=this.media;if(null!==i){if(i.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),Fp(i,"seeking",this.onMediaSeeking),Fp(i,"ended",this.onMediaEnded),this.keyLoader&&!n&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,n)return this.resetLoadingState(),void this.resetTransmuxer();this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=Up,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this.startFragRequested=!0,this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){this._doFragLoad(e,t,n,e=>{const t=e.frag;if(this.fragContextChanged(t))return this.warn("".concat(t.type," sn: ").concat(t.sn).concat(e.part?" part: "+e.part.index:""," of ").concat(this.fragInfo(t,!1,e.part),") was dropped during download.")),void this.fragmentTracker.removeFragment(t);t.stats.chunkCount++,this._handleFragmentLoadProgress(e)}).then(e=>{if(!e)return;const t=this.state,n=e.frag;this.fragContextChanged(n)?(t===Gp||!this.fragCurrent&&t===jp)&&(this.fragmentTracker.removeFragment(n),this.state=Hp):("payload"in e&&(this.log("Loaded ".concat(n.type," sn: ").concat(n.sn," of ").concat(this.playlistLabel()," ").concat(n.level)),this.hls.trigger(Ru.FRAG_LOADED,e)),this._handleFragmentLoadComplete(e))}).catch(t=>{this.state!==Up&&this.state!==Kp&&(this.warn("Frag error: ".concat((null==t?void 0:t.message)||t)),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===Qh){const t=e.type,i=this.getFwdBufferInfo(this.mediaBuffer,t),r=Math.max(e.duration,i?i.len:this.config.maxBufferLength),s=this.backtrackFragment;(1===(s?e.sn-s.sn:0)||this.reduceMaxBufferLength(r,e.duration))&&n.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Zh&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(null==t?void 0:t.live)&&"EVENT"!==t.type&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t){if(!(e-t))return;const n={startOffset:e,endOffset:t,type:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null};this.hls.trigger(Ru.BUFFER_FLUSHING,n)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(e=>{const t=null==e?void 0:e.frag;if(!t||this.fragContextChanged(t)||!this.levels)throw new Error("init load aborted");return e}).then(e=>{const{hls:t}=this,{frag:n,payload:i}=e,r=n.decryptdata;if(i&&i.byteLength>0&&null!=r&&r.key&&r.iv&&kf(r.method)){const s=self.performance.now();return this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer,Of(r.method)).catch(e=>{throw t.trigger(Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:n}),e}).then(i=>{const r=self.performance.now();return t.trigger(Ru.FRAG_DECRYPTED,{frag:n,payload:i,stats:{tstart:s,tdecrypt:r}}),e.payload=i,this.completeInitSegmentLoad(e)})}return this.completeInitSegmentLoad(e)}).catch(t=>{this.state!==Up&&this.state!==Kp&&(this.warn(t),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state!==Up&&(this.state=Hp),e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,t){var n,i;const r=e.tracks;if(r&&!t.encrypted&&(null!=(n=r.audio)&&n.encrypted||null!=(i=r.video)&&i.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const e=this.media,n=new Error("Encrypted track with no key in ".concat(this.fragInfo(t)," (media ").concat(e?"attached mediaKeys: "+e.mediaKeys:"detached",")"));return this.warn(n.message),!e||e.mediaKeys?!1:(this.hls.trigger(Ru.ERROR,{type:Au.KEY_SYSTEM_ERROR,details:Cu.KEY_SYSTEM_NO_KEYS,fatal:!1,error:n,frag:t}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const n=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log("Buffered ".concat(e.type," sn: ").concat(e.sn).concat(t?" part: "+t.index:""," of ").concat(this.fragInfo(e,!1,t)," > buffer:").concat(n?Bp(_f.getBuffered(n)):"(detached)",")")),ud(e)){var i;if(e.type!==Nu){const t=e.elementaryStreams;if(!Object.keys(t).some(e=>!!t[e]))return void(this.state=Hp)}const t=null==(i=this.levels)?void 0:i[e.level];null!=t&&t.fragmentError&&(this.log("Resetting level fragment error count of ".concat(t.fragmentError," on frag buffered")),t.fragmentError=0)}this.state=Hp}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:r}=e,s=!r||0===r.length||r.some(e=>!e),a=new vf(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!s);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;var r;this.fragCurrent=e;const s=t.details;if(!this.levels||!s)throw new Error("frag load aborted, missing level".concat(s?"":" detail","s"));let a=null;if(!e.encrypted||null!=(r=e.decryptdata)&&r.key)e.encrypted||(a=this.keyLoader.loadClear(e,s.encryptedFragments,this.startFragRequested),a&&this.log("[eme] blocking frag load until media-keys acquired"));else if(this.log("Loading key for ".concat(e.sn," of [").concat(s.startSN,"-").concat(s.endSN,"], ").concat(this.playlistLabel()," ").concat(e.level)),this.state=zp,this.fragCurrent=e,a=this.keyLoader.load(e).then(e=>{if(!this.fragContextChanged(e.frag))return this.hls.trigger(Ru.KEY_LOADED,e),this.state===zp&&(this.state=Hp),e}),this.hls.trigger(Ru.KEY_LOADING,{frag:e}),null===this.fragCurrent)return this.log("context changed in KEY_LOADING"),Promise.resolve(null);const o=this.fragPrevious;if(ud(e)&&(!o||e.sn!==o.sn)){const n=this.shouldLoadParts(t.details,e.end);n!==this.loadingParts&&(this.log("LL-Part loading ".concat(n?"ON":"OFF"," loading sn ").concat(null==o?void 0:o.sn,"->").concat(e.sn)),this.loadingParts=n)}if(n=Math.max(e.start,n||0),this.loadingParts&&ud(e)){const r=s.partList;if(r&&i){n>s.fragmentEnd&&s.fragmentHint&&(e=s.fragmentHint);const o=this.getNextPart(r,e,n);if(o>-1){const l=r[o];let c;return e=this.fragCurrent=l.fragment,this.log("Loading ".concat(e.type," sn: ").concat(e.sn," part: ").concat(l.index," (").concat(o,"/").concat(r.length-1,") of ").concat(this.fragInfo(e,!1,l),") cc: ").concat(e.cc," [").concat(s.startSN,"-").concat(s.endSN,"], target: ").concat(parseFloat(n.toFixed(3)))),this.nextLoadPosition=l.start+l.duration,this.state=Gp,c=a?a.then(n=>!n||this.fragContextChanged(n.frag)?null:this.doFragPartsLoad(e,l,t,i)).catch(e=>this.handleFragLoadError(e)):this.doFragPartsLoad(e,l,t,i).catch(e=>this.handleFragLoadError(e)),this.hls.trigger(Ru.FRAG_LOADING,{frag:e,part:l,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):c}if(!e.url||this.loadedEndOfParts(r,n))return Promise.resolve(null)}}var l;if(ud(e)&&this.loadingParts)this.log("LL-Part loading OFF after next part miss @".concat(n.toFixed(2)," Check buffer at sn: ").concat(e.sn," loaded parts: ").concat(null==(l=s.partList)?void 0:l.filter(e=>e.loaded).map(e=>"[".concat(e.start,"-").concat(e.end,"]")))),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log("Loading ".concat(e.type," sn: ").concat(e.sn," of ").concat(this.fragInfo(e,!1),") cc: ").concat(e.cc," ").concat("["+s.startSN+"-"+s.endSN+"]",", target: ").concat(parseFloat(n.toFixed(3)))),wu(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Gp;const c=this.config.progressive&&e.type!==Nu;let u;return u=c&&a?a.then(t=>!t||this.fragContextChanged(t.frag)?null:this.fragmentLoader.load(e,i)).catch(e=>this.handleFragLoadError(e)):Promise.all([this.fragmentLoader.load(e,c?i:void 0),a]).then(e=>{let[t]=e;return!c&&i&&i(t),t}).catch(e=>this.handleFragLoadError(e)),this.hls.trigger(Ru.FRAG_LOADING,{frag:e,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):u}doFragPartsLoad(e,t,n,i){return new Promise((r,s)=>{var a;const o=[],l=null==(a=n.details)?void 0:a.partList,c=t=>{this.fragmentLoader.loadPart(e,t,i).then(i=>{o[t.index]=i;const s=i.part;this.hls.trigger(Ru.FRAG_LOADED,i);const a=Mp(n.details,e.sn,t.index+1)||Ap(l,e.sn,t.index+1);if(!a)return r({frag:e,part:s,partsLoaded:o});c(a)}).catch(s)};c(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;t.frag&&t.details===Cu.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===Au.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(t.frag)):this.hls.trigger(Ru.ERROR,t)}else this.hls.trigger(Ru.ERROR,{type:Au.OTHER_ERROR,details:Cu.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==jp)return void(this.fragCurrent||this.state===Up||this.state===Kp||(this.state=Hp));const{frag:n,part:i,level:r}=t,s=self.performance.now();n.stats.parsing.end=s,i&&(i.stats.parsing.end=s);const a=this.getLevelDetails(),o=a&&n.sn>a.endSN||this.shouldLoadParts(a,n.end);o!==this.loadingParts&&(this.log("LL-Part loading ".concat(o?"ON":"OFF"," after parsing segment ending @").concat(n.end.toFixed(2))),this.loadingParts=o),this.updateLevelTiming(n,i,r,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var n;const r=e.partList[0];if(r.fragment.type===Nu)return!1;if(t>=r.end+((null==(n=e.fragmentHint)?void 0:n.duration)||0)){var i;if((this.hls.hasEnoughToStart?(null==(i=this.media)?void 0:i.currentTime)||this.lastCurrentTime:this.getLoadPosition())>r.start-r.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:r,part:s}=e;if(null==t||!t[i])return this.warn("Levels object was unset while buffering fragment ".concat(r," of ").concat(this.playlistLabel()," ").concat(i,". The current chunk will not be buffered.")),null;const a=t[i],o=a.details,l=s>-1?Mp(o,r,s):null,c=l?l.fragment:Tp(o,r,n);return c?(n&&n!==c&&(c.stats=n.stats),{frag:c,part:l,level:a}):null}bufferFragmentData(e,t,n,i,r){if(this.state!==jp)return;const{data1:s,data2:a}=e;let o=s;if(a&&(o=Id(s,a)),!o.length)return;const l=this.initPTS[t.cc],c=l?-l.baseTime/l.timescale:void 0,u={type:e.type,frag:t,part:n,chunkMeta:i,offset:c,parent:t.type,data:o};if(this.hls.trigger(Ru.BUFFER_APPENDING,u),e.dropped&&e.independent&&!n){if(r)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!_f.isBuffered(t,t.currentTime))return void this.flushMainBuffer(0,e.start);const n=t.currentTime,i=_f.bufferInfo(t,n,0),r=e.duration,s=Math.min(2*this.config.maxFragLookUpTolerance,.25*r),a=Math.max(Math.min(e.start-s,i.end-s),n+s);e.start-a>s&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){var n;const i=this.getLoadPosition();if(!wu(i))return null;const r=this.lastCurrentTime>i||null!=(n=this.media)&&n.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,i,t,r)}getFwdBufferInfoAtPos(e,t,n,i){const r=_f.bufferInfo(e,t,i);if(0===r.len&&void 0!==r.nextStart){const s=this.fragmentTracker.getBufferedFrag(t,n);if(s&&(r.nextStart<=s.end||s.gap)){const n=Math.max(Math.min(r.nextStart,s.end)-t,i);return _f.bufferInfo(e,t,n)}}return r}getMaxBufferLength(e){const{config:t}=this;let n;return n=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,i=Math.max(Math.min(e-t,n.maxBufferLength),t),r=Math.max(e-3*t,n.maxMaxBufferLength/2,i);return r>=i&&(n.maxMaxBufferLength=r,this.warn("Reduce max buffer length to ".concat(r,"s")),!0)}getAppendedFrag(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ku;const n=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:r}=this,s=n[0].start,a=r.lowLatencyMode&&!!t.partList;let o=null;if(t.live){const n=r.initialLiveManifestSize;if(i<n)return this.warn("Not enough fragments to start playback (have: ".concat(i,", need: ").concat(n,")")),null;if(!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||e<s){var l;a&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),o=this.getInitialLiveFragment(t);const n=this.hls.startPosition,i=this.hls.liveSyncPosition,r=o?(-1!==n&&n>=s?n:i)||o.start:e;this.log("Setting startPosition to ".concat(r," to match start frag at live edge. mainStart: ").concat(n," liveSyncPosition: ").concat(i," frag.start: ").concat(null==(l=o)?void 0:l.start)),this.startPosition=this.nextLoadPosition=r}}else e<=s&&(o=n[0]);if(!o){const n=this.loadingParts?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,n,t)}let c=this.filterReplacedPrimary(o,t);if(!c&&o){const e=o.sn-t.startSN;c=this.filterReplacedPrimary(n[e+1]||null,t)}return this.mapToInitFragWhenRequired(c)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===$h||n===Zh&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,r){let s=null;if(e.gap&&(s=this.getNextFragment(this.nextLoadPosition,t),s&&!s.gap&&n.nextStart)){const e=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i,0);if(null!==e&&n.len+e.len>=r){const e=s.sn;return this.loopSn!==e&&(this.log('buffer full after gaps in "'.concat(i,'" playlist starting at sn: ').concat(e)),this.loopSn=e),null}}return this.loopSn=void 0,s}get primaryPrefetch(){if(Zp(this.config)){var e;if(null==(e=this.hls.interstitialsManager)||null==(e=e.playingItem)?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(Zp(this.config)&&e.type!==Nu){const n=this.hls.interstitialsManager,i=null==n?void 0:n.bufferingItem;if(i){const n=i.event;if(n){if(n.appendInPlace||Math.abs(e.start-i.start)>1||0===i.start)return null}else{if(e.end<=i.start&&!1===(null==t?void 0:t.live))return null;if(e.start>i.end&&i.nextEvent&&(i.nextEvent.appendInPlace||e.start-i.end>1))return null}}const r=null==n?void 0:n.playerQueue;if(r)for(let t=r.length;t--;){const n=r[t].interstitial;if(n.appendInPlace&&e.start>=n.startTime&&e.end<=n.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,n){let i=-1,r=!1,s=!0;for(let a=0,o=e.length;a<o;a++){const o=e[a];if(s=s&&!o.independent,i>-1&&n<o.start)break;const l=o.loaded;l?i=-1:(r||(o.independent||s)&&o.fragment===t)&&(o.fragment!==t&&this.warn("Need buffer at ".concat(n," but next unloaded part starts at ").concat(o.start)),i=a),r=l}return i}loadedEndOfParts(e,t){let n;for(let i=e.length;i--;){if(n=e[i],!n.loaded)return!1;if(t>n.start)return!0}return!1}getInitialLiveFragment(e){const t=e.fragments,n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: ".concat(n.programDateTime)),i=function(e,t,n){if(null===t||!Array.isArray(e)||!e.length||!wu(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;for(let i=0;i<e.length;++i){const r=e[i];if(Ph(t,n,r))return r}return null}(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const r=n.sn+1;if(r>=e.startSN&&r<=e.endSN){const s=t[r-e.startSN];n.cc===s.cc&&(i=s,this.log("Live playlist, switching playlist, load frag with next SN: ".concat(i.sn)))}i||(i=Ih(e,n.cc,n.end),i&&this.log("Live playlist, switching playlist, load frag with same CC: ".concat(i.sn)))}}else{const t=this.hls.liveSyncPosition;null!==t&&(i=this.getFragmentAtPosition(t,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:r}=this,{fragments:s,endSN:a}=n;const{fragmentHint:o}=n,{maxFragLookUpTolerance:l}=i,c=n.partList,u=!!(this.loadingParts&&null!=c&&c.length&&o);let d;if(u&&!this.bitrateTest&&c[c.length-1].fragment.sn===o.sn&&(s=s.concat(o),a=o.sn),e<t){var h;d=Rh(r,s,e,e<this.lastCurrentTime||e>t-l||null!=(h=this.media)&&h.paused||!this.startFragRequested?0:l)}else d=s[s.length-1];if(d){const e=d.sn-n.startSN,t=this.fragmentTracker.getState(d);if((t===$h||t===Zh&&d.gap)&&(r=d),r&&d.sn===r.sn&&(!u||c[0].fragment.sn>d.sn||!n.live)){if(d.level===r.level){const t=s[e+1];d=d.sn<a&&this.fragmentTracker.getState(t)!==$h?t:null}}}return d}alignPlaylists(e,t,n){const i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;const r=e.fragmentStart,s=!t,a=e.alignedSliding&&wu(r);if(s||!a&&!r){!function(e,t){e&&(kp(t,e),t.alignedSliding||Op(t,e),t.alignedSliding||t.skippedSegments||Sp(e,t,!1))}(n,e);const r=e.fragmentStart;return this.log("Live playlist sliding: ".concat(r.toFixed(2)," start-sn: ").concat(t?t.startSN:"na","->").concat(e.startSN," fragments: ").concat(i)),r}return r}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)}setStartPosition(e,t){let n=this.startPosition;n<t&&(n=-1);const i=this.timelineOffset;if(-1===n){const r=null!==this.startTimeOffset,s=r?this.startTimeOffset:e.startTimeOffset;null!==s&&wu(s)?(n=t+s,s<0&&(n+=e.edge),n=Math.min(Math.max(t,n),t+e.totalduration),this.log("Setting startPosition to ".concat(n," for start time offset ").concat(s," found in ").concat(r?"multivariant":"media"," playlist")),this.startPosition=n):e.live?(n=this.hls.liveSyncPosition||t,this.log("Setting startPosition to -1 to start at live edge ".concat(n)),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=n=0),this.lastCurrentTime=n+i}this.nextLoadPosition=n+i}getLoadPosition(){var e;const{media:t}=this;let n=0;return null!=(e=this.hls)&&e.hasEnoughToStart&&t?n=t.currentTime:this.nextLoadPosition>=0&&(n=this.nextLoadPosition),n}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&ud(e)&&e.stats.aborted&&(this.log("Fragment ".concat(e.sn).concat(t?" part "+t.index:""," of ").concat(this.playlistLabel()," ").concat(e.level," was aborted")),this.resetFragmentLoading(e))}resetFragmentLoading(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===Vp)||(this.state=Hp)}onFragmentOrKeyLoadError(e,t){var n;if(t.chunkMeta&&!t.frag){const e=this.getCurrentContext(t.chunkMeta);e&&(t.frag=e.frag)}const i=t.frag;if(!i||i.type!==e||!this.levels)return;var r;if(this.fragContextChanged(i))return void this.warn("Frag load error must match current frag to retry ".concat(i.url," > ").concat(null==(r=this.fragCurrent)?void 0:r.url));const s=t.details===Cu.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(i,!0);const a=t.errorAction;if(!a)return void(this.state=Kp);const{action:o,flags:l,retryCount:c=0,retryConfig:u}=a,d=!!u,h=d&&o===Wh,f=d&&!a.resolved&&l===Yh,p=null==(n=this.hls.latestLevelDetails)?void 0:n.live;if(!h&&f&&ud(i)&&!i.endList&&p&&!Oh(t))this.resetFragmentErrors(e),this.treatAsGap(i),a.resolved=!0;else if((h||f)&&c<u.maxNumRetry){var m;const n=Hh(null==(m=t.response)?void 0:m.code),r=Fh(u,c);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+r,this.state=Vp,a.resolved=!0,n)return this.log("Waiting for connection (offline)"),this.retryDate=1/0,void(t.reason="offline");this.warn("Fragment ".concat(i.sn," of ").concat(e," ").concat(i.level," errored with ").concat(t.details,", retrying loading ").concat(c+1,"/").concat(u.maxNumRetry," in ").concat(r,"ms"))}else if(u){if(this.resetFragmentErrors(e),!(c<u.maxNumRetry))return void this.warn("".concat(t.details," reached or exceeded max retry (").concat(c,")"));s||o===Vh||(a.resolved=!0)}else this.state=o===Gh?Jp:Kp;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),t=this.retryDate,n=t===1/0;(!t||e>=t||n&&!Hh(0))&&(n&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=Hp)}reduceLengthAndFlushBuffer(e){if(this.state===jp||this.state===Yp){const t=e.frag,n=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,n),r=i&&i.len>.5;r&&this.reduceMaxBufferLength(i.len,(null==t?void 0:t.duration)||10);const s=!r;return s&&this.warn("Buffer full error while media.currentTime (".concat(this.getLoadPosition(),") is not buffered, flush ").concat(n," buffer")),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(e){e===Ou&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==Up&&(this.state=Hp)}afterBufferFlushed(e,t,n){if(!e)return;const i=_f.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===Xp&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==Up&&(this.state=Hp)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,t=e?e.details:null;null!=t&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log("Loading context changed while buffering sn ".concat(e.sn," of ").concat(this.playlistLabel()," ").concat(-1===e.level?"<removed>":e.level,". This chunk will not be buffered.")),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){const r=n.details;if(!r)return void this.warn("level.details undefined");if(!Object.keys(e.elementaryStreams).reduce((t,s)=>{const a=e.elementaryStreams[s];if(a){const o=a.endPTS-a.startPTS;if(o<=0)return this.warn("Could not parse fragment ".concat(e.sn," ").concat(s," duration reliably (").concat(o,")")),t||!1;const l=i?0:_p(r,e,a.startPTS,a.endPTS,a.startDTS,a.endDTS,this);return this.hls.trigger(Ru.LEVEL_PTS_UPDATED,{details:r,level:n,drift:l,type:s,frag:e,start:a.startPTS,end:a.endPTS}),!0}return t},!1)){var s;const t=null===(null==(s=this.transmuxer)?void 0:s.error);if((0===n.fragmentError||t&&(n.fragmentError<2||e.endList))&&this.treatAsGap(e,n),t){const t=new Error("Found no media in fragment ".concat(e.sn," of ").concat(this.playlistLabel()," ").concat(e.level," resetting transmuxer to fallback to playlist timing"));if(this.warn(t.message),this.hls.trigger(Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.FRAG_PARSING_ERROR,fatal:!1,error:t,frag:e,reason:"Found no media in msn ".concat(e.sn," of ").concat(this.playlistLabel(),' "').concat(n.url,'"')}),!this.hls)return;this.resetTransmuxer()}}this.state=Yp,this.log("Parsed ".concat(e.type," sn: ").concat(e.sn).concat(t?" part: "+t.index:""," of ").concat(this.fragInfo(e,!1,t),")")),this.hls.trigger(Ru.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===ku?"level":"track"}fragInfo(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;var i,r;return"".concat(this.playlistLabel()," ").concat(e.level," (").concat(n?"part":"frag",":[").concat((null!=(i=t&&!n?e.startPTS:(n||e).start)?i:NaN).toFixed(3),"-").concat((null!=(r=t&&!n?e.endPTS:(n||e).end)?r:NaN).toFixed(3),"]").concat(n&&"main"===e.type?"INDEPENDENT="+(n.independent?"YES":"NO"):"")}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;null==(e=this.transmuxer)||e.reset()}recoverWorkerError(e){"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log("".concat(t,"->").concat(e)))}get state(){return this._state}}function Zp(e){return!!e.interstitialsController&&!1!==e.enableInterstitialPlayback}class $p{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;return e.length?(n=1===e.length?e[0]:function(e,t){const n=new Uint8Array(t);let i=0;for(let r=0;r<e.length;r++){const t=e[r];n.set(t,i),i+=t.length}return n}(e,t),this.reset(),n):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}var em,tm={exports:{}};var nm=(em||(em=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,i,s,a){if("function"!==typeof i)throw new TypeError("The listener must be a function");var o=new r(i,s||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new i:delete e._events[t]}function o(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},o.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,a=new Array(s);r<s;r++)a[r]=i[r].fn;return a},o.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},o.prototype.emit=function(e,t,i,r,s,a){var o=n?n+e:e;if(!this._events[o])return!1;var l,c,u=this._events[o],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,r),!0;case 5:return u.fn.call(u.context,t,i,r,s),!0;case 6:return u.fn.call(u.context,t,i,r,s,a),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,f=u.length;for(c=0;c<f;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,i);break;case 4:u[c].fn.call(u[c].context,t,i,r);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},o.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,i,r){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||r&&!o.once||i&&o.context!==i||a(this,s);else{for(var l=0,c=[],u=o.length;l<u;l++)(o[l].fn!==t||r&&!o[l].once||i&&o[l].context!==i)&&c.push(o[l]);c.length?this._events[s]=1===c.length?c[0]:c:a(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(tm)),tm.exports),im=td(nm);const rm="1.6.15",sm={};function am(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function om(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function lm(e,t){let n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|=127&e[t+3],n}function cm(e,t){const n=t;let i=0;for(;om(e,t);){i+=10;i+=lm(e,t+6),am(e,t+10)&&(i+=10),t+=i}if(i>0)return e.subarray(n,n+i)}function um(e,t){return 255===e[t]&&240===(246&e[t+1])}function dm(e,t){return 1&e[t+1]?7:9}function hm(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function fm(e,t){return t+1<e.length&&um(e,t)}function pm(e,t){if(fm(e,t)){const n=dm(e,t);if(t+n>=e.length)return!1;const i=hm(e,t);if(i<=n)return!1;const r=t+i;return r===e.length||fm(e,r)}return!1}function mm(e,t,n,i,r){if(!e.samplerate){const s=function(e,t,n,i){const r=t[n+2],s=r>>2&15;if(s>12){const t=new Error("invalid ADTS sampling index:".concat(s));return void e.emit(Ru.ERROR,Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.FRAG_PARSING_ERROR,fatal:!0,error:t,reason:t.message})}const a=1+(r>>6&3),o=t[n+3]>>6&3|(1&r)<<2,l="mp4a.40."+a,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][s];let u=s;5!==a&&29!==a||(u-=3);const d=[a<<3|(14&u)>>1,(1&u)<<7|o<<3];return qu.log("manifest codec:".concat(i,", parsed codec:").concat(l,", channels:").concat(o,", rate:").concat(c," (ADTS object type:").concat(a," sampling index:").concat(s,")")),{config:d,samplerate:c,channelCount:o,codec:l,parsedCodec:l,manifestCodec:i}}(t,n,i,r);if(!s)return;Hu(e,s)}}function gm(e){return 9216e4/e}function vm(e,t,n,i,r){const s=i+r*gm(e.samplerate),a=function(e,t){const n=dm(e,t);if(t+n<=e.length){const i=hm(e,t)-n;if(i>0)return{headerLength:n,frameLength:i}}}(t,n);let o;if(a){const{frameLength:i,headerLength:r}=a,l=r+i,c=Math.max(0,n+l-t.length);c?(o=new Uint8Array(l-r),o.set(t.subarray(n+r,t.length),0)):o=t.subarray(n+r,n+l);const u={unit:o,pts:s};return c||e.samples.push(u),{sample:u,length:l,missing:c}}const l=t.length-n;o=new Uint8Array(l),o.set(t.subarray(n,t.length),0);return{sample:{unit:o,pts:s},length:l,missing:-1}}function ym(e,t){return om(e,t)&&lm(e,t+6)+10<=e.length-t}function _m(e){return function(e,t,n,i){const r=function(e){return e instanceof ArrayBuffer?e:e.buffer}(e);let s=1;"BYTES_PER_ELEMENT"in i&&(s=i.BYTES_PER_ELEMENT);const a=(d=e,d&&d.buffer instanceof ArrayBuffer&&void 0!==d.byteLength&&void 0!==d.byteOffset?e.byteOffset:0),o=(a+e.byteLength)/s,l=(a+t)/s,c=Math.floor(Math.max(0,Math.min(l,o))),u=Math.floor(Math.min(c+Math.max(n,0),o));var d;return new i(r,c,u-c)}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,Uint8Array)}function bm(e){const t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if(e.size<2)return;if(3!==e.data[0])return void console.log("Ignore frame with unrecognized character encoding");const n=e.data.subarray(1).indexOf(0);if(-1===n)return;const i=Zu(_m(e.data,1,n)),r=e.data[2+n],s=e.data.subarray(3+n).indexOf(0);if(-1===s)return;const a=Zu(_m(e.data,3+n,s));let o;return o="--\x3e"===i?Zu(_m(e.data,4+n+s)):function(e){return e instanceof ArrayBuffer?e:0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer}(e.data.subarray(4+n+s)),t.mimeType=i,t.pictureType=r,t.description=a,t.data=o,t}function xm(e){return"PRIV"===e.type?function(e){if(e.size<2)return;const t=Zu(e.data,!0),n=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:n.buffer}}(e):"W"===e.type[0]?function(e){if("WXXX"===e.type){if(e.size<2)return;let t=1;const n=Zu(e.data.subarray(t),!0);t+=n.length+1;const i=Zu(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=Zu(e.data);return{key:e.type,info:"",data:t}}(e):"APIC"===e.type?bm(e):function(e){if(e.size<2)return;if("TXXX"===e.type){let t=1;const n=Zu(e.data.subarray(t),!0);t+=n.length+1;const i=Zu(e.data.subarray(t));return{key:e.type,info:n,data:i}}const t=Zu(e.data.subarray(1));return{key:e.type,info:"",data:t}}(e)}function Sm(e){const t=String.fromCharCode(e[0],e[1],e[2],e[3]),n=lm(e,4);return{type:t,size:n,data:e.subarray(10,10+n)}}function Em(e){let t=0;const n=[];for(;om(e,t);){const i=lm(e,t+6);e[t+5]>>6&1&&(t+=10),t+=10;const r=t+i;for(;t+10<r;){const i=Sm(e.subarray(t)),r=xm(i);r&&n.push(r),t+=i.size+10}am(e,t)&&(t+=10)}return n}function wm(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info}function Tm(e){if(8===e.data.byteLength){const t=new Uint8Array(e.data),n=1&t[3];let i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,n&&(i+=47721858.84),Math.round(i)}}function Mm(e){const t=Em(e);for(let n=0;n<t.length;n++){const e=t[n];if(wm(e))return Tm(e)}}let Am=function(e){return e.audioId3="org.id3",e.dateRange="com.apple.quicktime.HLS",e.emsg="https://aomedia.org/emsg/ID3",e.misbklv="urn:misb:KLV:bin:1910.1",e}({});function Cm(){return{type:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",id:-1,pid:-1,inputTimeScale:arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4,sequenceNumber:-1,samples:[],dropped:0}}class Rm{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=Id(this.cachedData,e),this.cachedData=null);let n,i=cm(e,0),r=i?i.length:0;const s=this._audioTrack,a=this._id3Track,o=i?Mm(i):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&wu(o))&&(this.basePTS=Lm(o,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),i&&i.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Am.audioId3,duration:Number.POSITIVE_INFINITY});r<l;){if(this.canParse(e,r)){const t=this.appendFrame(s,e,r);t?(this.frameIndex++,this.lastPTS=t.sample.pts,r+=t.length,n=r):r=l}else ym(e,r)?(i=cm(e,r),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Am.audioId3,duration:Number.POSITIVE_INFINITY}),r+=i.length,n=r):r++;if(r===l&&n!==l){const t=e.slice(n);this.cachedData?this.cachedData=Id(this.cachedData,t):this.cachedData=t}}return{audioTrack:s,videoTrack:Cm(),id3Track:a,textTrack:Cm()}}demuxSampleAes(e,t,n){return Promise.reject(new Error("[".concat(this,"] This demuxer does not support Sample-AES decryption")))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Cm(),id3Track:this._id3Track,textTrack:Cm()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const Lm=(e,t,n)=>{if(wu(e))return 90*e;return 9e4*t+(n?9e4*n.baseTime/n.timescale:0)};let Pm=null;const Im=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Dm=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],km=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Om=[0,1,1,4];function Nm(e,t,n,i,r){if(n+24>t.length)return;const s=Fm(t,n);if(s&&n+s.frameLength<=t.length){const a=i+r*(9e4*s.samplesPerFrame/s.sampleRate),o={unit:t.subarray(n,n+s.frameLength),pts:a,dts:a};return e.config=[],e.channelCount=s.channelCount,e.samplerate=s.sampleRate,e.samples.push(o),{sample:o,length:s.frameLength,missing:0}}}function Fm(e,t){const n=e[t+1]>>3&3,i=e[t+1]>>1&3,r=e[t+2]>>4&15,s=e[t+2]>>2&3;if(1!==n&&0!==r&&15!==r&&3!==s){const a=e[t+2]>>1&1,o=e[t+3]>>6,l=1e3*Im[14*(3===n?3-i:3===i?3:4)+r-1],c=Dm[3*(3===n?0:2===n?1:2)+s],u=3===o?1:2,d=km[n][i],h=Om[i],f=8*d*h,p=Math.floor(d*l/c+a)*h;if(null===Pm){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Pm=e?parseInt(e[1]):0}return!!Pm&&Pm<=87&&2===i&&l>=224e3&&0===o&&(e[t+3]=128|e[t+3]),{sampleRate:c,channelCount:u,frameLength:p,samplesPerFrame:f}}}function Bm(e,t){return 255===e[t]&&224===(224&e[t+1])&&0!==(6&e[t+1])}function Um(e,t){return t+1<e.length&&Bm(e,t)}function Hm(e,t){if(t+1<e.length&&Bm(e,t)){const n=4,i=Fm(e,t);let r=n;null!=i&&i.frameLength&&(r=i.frameLength);const s=t+r;return s===e.length||Um(e,s)}return!1}const zm=(e,t)=>{let n=0,i=5;t+=i;const r=new Uint32Array(1),s=new Uint32Array(1),a=new Uint8Array(1);for(;i>0;){a[0]=e[t];const o=Math.min(i,8),l=8-o;s[0]=4278190080>>>24+l<<l,r[0]=(a[0]&s[0])>>l,n=n?n<<o|r[0]:r[0],t+=1,i-=o}return n};class Gm extends Rm{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const i=Vm(e,t,n,this.basePTS,this.frameIndex);if(-1!==i){return{sample:e.samples[e.samples.length-1],length:i,missing:0}}}static probe(e){if(!e)return!1;const t=cm(e,0);if(!t)return!1;const n=t.length;return 11===e[n]&&119===e[n+1]&&void 0!==Mm(t)&&zm(e,n)<16}}function Vm(e,t,n,i,r){if(n+8>t.length)return-1;if(11!==t[n]||119!==t[n+1])return-1;const s=t[n+4]>>6;if(s>=3)return-1;const a=[48e3,44100,32e3][s],o=63&t[n+4],l=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*o+s];if(n+l>t.length)return-1;const c=t[n+6]>>5;let u=0;2===c?u+=2:(1&c&&1!==c&&(u+=2),4&c&&(u+=2));const d=(t[n+6]<<8|t[n+7])>>12-u&1,h=[2,1,2,3,3,4,4,5][c]+d,f=t[n+5]>>3,p=7&t[n+5],m=new Uint8Array([s<<6|f<<1|p>>2,(3&p)<<6|c<<3|d<<2|o>>4,o<<4&224]),g=i+r*(1536/a*9e4),v=t.subarray(n,n+l);return e.config=m,e.channelCount=h,e.samplerate=a,e.samples.push({unit:v,pts:g}),l}const Wm=/\/emsg[-/]ID3/i;function jm(e,t){return wu(e.presentationTime)?e.presentationTime/e.timeScale:t+e.presentationTimeDelta/e.timeScale}class Ym{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new uf(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,sf)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const r=i.subarray(16,i.length-i.length%16),s=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(s).then(r=>{const s=new Uint8Array(r);i.set(s,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)}).catch(n)}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)n.set(e.subarray(r,r+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)e.set(n.subarray(i,i+16),r);return e}decryptAvcSample(e,t,n,i,r){const s=Fd(r.data),a=this.getAvcEncryptedData(s);this.decryptBuffer(a.buffer).then(a=>{r.data=this.getAvcDecryptedUnit(s,a),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)}).catch(i)}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length)return void i();const r=e[t].units;for(;!(n>=r.length);n++){const s=r[n];if(!(s.data.length<=48||1!==s.type&&5!==s.type)&&(this.decryptAvcSample(e,t,n,i,s),!this.decrypter.isSync()))return}}}}class Xm{constructor(){this.VideoSample=null}createVideoSample(e,t,n){return{key:e,frame:!1,pts:t,dts:n,units:[],length:0}}getLastNalUnit(e){var t;let n,i=this.VideoSample;if(i&&0!==i.units.length||(i=e[e.length-1]),null!=(t=i)&&t.units){const e=i.units;n=e[e.length-1]}return n}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){const n=t.samples,i=n.length;if(!i)return void t.dropped++;{const t=n[i-1];e.pts=t.pts,e.dts=t.dts}}t.samples.push(e)}}parseNALu(e,t,n){const i=t.byteLength;let r=e.naluState||0;const s=r,a=[];let o,l,c,u=0,d=-1,h=0;for(-1===r&&(d=0,h=this.getNALuType(t,0),r=0,u=1);u<i;)if(o=t[u++],r)if(1!==r)if(o)if(1===o){if(l=u-r-1,d>=0){const e={data:t.subarray(d,l),type:h};a.push(e)}else{const n=this.getLastNalUnit(e.samples);n&&(s&&u<=4-s&&n.state&&(n.data=n.data.subarray(0,n.data.byteLength-s)),l>0&&(n.data=Id(n.data,t.subarray(0,l)),n.state=0))}u<i?(c=this.getNALuType(t,u),d=u,h=c,r=0):r=-1}else r=0;else r=3;else r=o?0:2;else r=o?0:1;if(d>=0&&r>=0){const e={data:t.subarray(d,i),type:h,state:r};a.push(e)}if(0===a.length){const n=this.getLastNalUnit(e.samples);n&&(n.data=Id(n.data,t))}return e.naluState=r,a}}class Km{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),r=Math.min(4,t);if(0===r)throw new Error("no bytes available");i.set(e.subarray(n,n+r)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(t=(e-=this.bitsAvailable)>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&qu.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(0!==(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class qm extends Xm{parsePES(e,t,n,i){const r=this.parseNALu(e,n.data,i);let s,a=this.VideoSample,o=!1;n.data=null,a&&r.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),r.forEach(i=>{var r,l;switch(i.type){case 1:{let t=!1;s=!0;const r=i.data;if(o&&r.length>4){const e=this.readSliceType(r);2!==e&&4!==e&&7!==e&&9!==e||(t=!0)}var c;if(t)null!=(c=a)&&c.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null);a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.frame=!0,a.key=t;break}case 5:s=!0,null!=(r=a)&&r.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 6:s=!0,Nd(i.data,1,n.pts,t.samples);break;case 7:{var u,d;s=!0,o=!0;const t=i.data,n=this.readSPS(t);if(!e.sps||e.width!==n.width||e.height!==n.height||(null==(u=e.pixelRatio)?void 0:u[0])!==n.pixelRatio[0]||(null==(d=e.pixelRatio)?void 0:d[1])!==n.pixelRatio[1]){e.width=n.width,e.height=n.height,e.pixelRatio=n.pixelRatio,e.sps=[t];const i=t.subarray(1,4);let r="avc1.";for(let e=0;e<3;e++){let t=i[e].toString(16);t.length<2&&(t="0"+t),r+=t}e.codec=r}break}case 8:s=!0,e.pps=[i.data];break;case 9:s=!0,e.audFound=!0,null!=(l=a)&&l.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;case 12:s=!0;break;default:s=!1}if(a&&s){a.units.push(i)}}),i&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}getNALuType(e,t){return 31&e[t]}readSliceType(e){const t=new Km(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let n,i=8,r=8;for(let s=0;s<e;s++)0!==r&&(n=t.readEG(),r=(i+n+256)%256),i=0===r?i:r}readSPS(e){const t=new Km(e);let n,i,r,s=0,a=0,o=0,l=0;const c=t.readUByte.bind(t),u=t.readBits.bind(t),d=t.readUEG.bind(t),h=t.readBoolean.bind(t),f=t.skipBits.bind(t),p=t.skipEG.bind(t),m=t.skipUEG.bind(t),g=this.skipScalingList.bind(this);c();const v=c();if(u(5),f(3),c(),m(),100===v||110===v||122===v||244===v||44===v||83===v||86===v||118===v||128===v){const e=d();if(3===e&&f(1),m(),m(),f(1),h())for(i=3!==e?8:12,r=0;r<i;r++)h()&&g(r<6?16:64,t)}m();const y=d();if(0===y)d();else if(1===y)for(f(1),p(),p(),n=d(),r=0;r<n;r++)p();m(),f(1);const _=d(),b=d(),x=u(1);0===x&&f(1),f(1),h()&&(s=d(),a=d(),o=d(),l=d());let S=[1,1];if(h()&&h()){switch(c()){case 1:S=[1,1];break;case 2:S=[12,11];break;case 3:S=[10,11];break;case 4:S=[16,11];break;case 5:S=[40,33];break;case 6:S=[24,11];break;case 7:S=[20,11];break;case 8:S=[32,11];break;case 9:S=[80,33];break;case 10:S=[18,11];break;case 11:S=[15,11];break;case 12:S=[64,33];break;case 13:S=[160,99];break;case 14:S=[4,3];break;case 15:S=[3,2];break;case 16:S=[2,1];break;case 255:S=[c()<<8|c(),c()<<8|c()]}}return{width:Math.ceil(16*(_+1)-2*s-2*a),height:(2-x)*(b+1)*16-(x?2:4)*(o+l),pixelRatio:S}}}class Jm extends Xm{constructor(){super(...arguments),this.initVPS=null}parsePES(e,t,n,i){const r=this.parseNALu(e,n.data,i);let s,a=this.VideoSample,o=!1;n.data=null,a&&r.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),r.forEach(i=>{var r,l;switch(i.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),a.frame=!0,s=!0;break;case 16:case 17:case 18:case 21:var c;if(s=!0,o)null!=(c=a)&&c.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null);a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:s=!0,null!=(r=a)&&r.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 39:s=!0,Nd(i.data,2,n.pts,t.samples);break;case 32:s=!0,e.vps||("object"!==typeof e.params&&(e.params={}),e.params=Hu(e.params,this.readVPS(i.data)),this.initVPS=i.data),e.vps=[i.data];break;case 33:if(s=!0,o=!0,void 0===e.vps||e.vps[0]===this.initVPS||void 0===e.sps||this.matchSPS(e.sps[0],i.data)||(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const t=this.readSPS(i.data);e.width=t.width,e.height=t.height,e.pixelRatio=t.pixelRatio,e.codec=t.codecString,e.sps=[],"object"!==typeof e.params&&(e.params={});for(const n in t.params)e.params[n]=t.params[n]}this.pushParameterSet(e.sps,i.data,e.vps),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0;break;case 34:if(s=!0,"object"===typeof e.params){if(!e.pps){e.pps=[];const t=this.readPPS(i.data);for(const n in t)e.params[n]=t[n]}this.pushParameterSet(e.pps,i.data,e.vps)}break;case 35:s=!0,e.audFound=!0,null!=(l=a)&&l.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;default:s=!1}if(a&&s){a.units.push(i)}}),i&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}pushParameterSet(e,t,n){(n&&n[0]===this.initVPS||!n&&!e.length)&&e.push(t)}getNALuType(e,t){return(126&e[t])>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let n=0;for(let i=0;i<e.byteLength;i++)i>=2&&3===e[i]&&0===e[i-1]&&0===e[i-2]||(t[n]=e[i],n++);return new Uint8Array(t.buffer,0,n)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new Km(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);return{numTemporalLayers:t.readBits(3)+1,temporalIdNested:t.readBoolean()}}readSPS(e){const t=new Km(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const n=t.readBits(3);t.readBoolean();const i=t.readBits(2),r=t.readBoolean(),s=t.readBits(5),a=t.readUByte(),o=t.readUByte(),l=t.readUByte(),c=t.readUByte(),u=t.readUByte(),d=t.readUByte(),h=t.readUByte(),f=t.readUByte(),p=t.readUByte(),m=t.readUByte(),g=t.readUByte(),v=[],y=[];for(let Y=0;Y<n;Y++)v.push(t.readBoolean()),y.push(t.readBoolean());if(n>0)for(let Y=n;Y<8;Y++)t.readBits(2);for(let Y=0;Y<n;Y++)v[Y]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),y[Y]&&t.readUByte();t.readUEG();const _=t.readUEG();3==_&&t.skipBits(1);const b=t.readUEG(),x=t.readUEG(),S=t.readBoolean();let E=0,w=0,T=0,M=0;S&&(E+=t.readUEG(),w+=t.readUEG(),T+=t.readUEG(),M+=t.readUEG());const A=t.readUEG(),C=t.readUEG(),R=t.readUEG();for(let Y=t.readBoolean()?0:n;Y<=n;Y++)t.skipUEG(),t.skipUEG(),t.skipUEG();t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.readBoolean()){if(t.readBoolean())for(let e=0;e<4;e++)for(let n=0;n<(3===e?2:6);n++){if(t.readBoolean()){const n=Math.min(64,1<<4+(e<<1));e>1&&t.readEG();for(let e=0;e<n;e++)t.readEG()}else t.readUEG()}}t.readBoolean(),t.readBoolean();t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const L=t.readUEG();let P=0;for(let Y=0;Y<L;Y++){let e=!1;if(0!==Y&&(e=t.readBoolean()),e){Y===L&&t.readUEG(),t.readBoolean(),t.readUEG();let e=0;for(let n=0;n<=P;n++){const n=t.readBoolean();let i=!1;n||(i=t.readBoolean()),(n||i)&&e++}P=e}else{const e=t.readUEG(),n=t.readUEG();P=e+n;for(let i=0;i<e;i++)t.readUEG(),t.readBoolean();for(let i=0;i<n;i++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const e=t.readUEG();for(let n=0;n<e;n++){for(let e=0;e<R+4;e++)t.readBits(1);t.readBits(1)}}let I=0,D=1,k=1,O=!0,N=1,F=0;t.readBoolean(),t.readBoolean();let B=!1;if(t.readBoolean()){if(t.readBoolean()){const e=t.readUByte();e>0&&e<16?(D=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][e-1],k=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][e-1]):255===e&&(D=t.readBits(16),k=t.readBits(16))}t.readBoolean()&&t.readBoolean();if(t.readBoolean()){t.readBits(3),t.readBoolean();t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())}t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),B=t.readBoolean(),B&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG());if(t.readBoolean()){N=t.readBits(32),F=t.readBits(32);t.readBoolean()&&t.readUEG();if(t.readBoolean()){const e=t.readBoolean(),i=t.readBoolean();let r=!1;(e||i)&&(r=t.readBoolean(),r&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),r&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let s=0;s<=n;s++){O=t.readBoolean();let n=!1;O||t.readBoolean()?t.readEG():n=t.readBoolean();const s=n?1:t.readUEG()+1;if(e)for(let e=0;e<s;e++)t.readUEG(),t.readUEG(),r&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(i)for(let e=0;e<s;e++)t.readUEG(),t.readUEG(),r&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),I=t.readUEG())}let U=b,H=x;if(S){let e=1,t=1;1===_?e=t=2:2==_&&(e=2),U=b-e*w-e*E,H=x-t*M-t*T}const z=i?["A","B","C"][i]:"",G=a<<24|o<<16|l<<8|c;let V=0;for(let Y=0;Y<32;Y++)V=(V|(G>>Y&1)<<31-Y)>>>0;let W=V.toString(16);1===s&&"2"===W&&(W="6");const j=r?"H":"L";return{codecString:"hvc1.".concat(z).concat(s,".").concat(W,".").concat(j).concat(g,".B0"),params:{general_tier_flag:r,general_profile_idc:s,general_profile_space:i,general_profile_compatibility_flags:[a,o,l,c],general_constraint_indicator_flags:[u,d,h,f,p,m],general_level_idc:g,bit_depth:A+8,bit_depth_luma_minus8:A,bit_depth_chroma_minus8:C,min_spatial_segmentation_idc:I,chroma_format_idc:_,frame_rate:{fixed:O,fps:F/N}},width:U,height:H,pixelRatio:[D,k]}}readPPS(e){const t=new Km(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2);t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const n=t.readBoolean(),i=t.readBoolean();let r=1;return i&&n?r=0:i?r=3:n&&(r=2),{parallelismType:r}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Qm=188;class Zm{constructor(e,t,n,i){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=i,this.videoParser=null}static probe(e,t){const n=Zm.syncOffset(e);return n>0&&t.warn("MPEG2-TS detected but first sync word found @ offset ".concat(n)),-1!==n}static syncOffset(e){const t=e.length;let n=Math.min(940,t-Qm)+1,i=0;for(;i<n;){let r=!1,s=-1,a=0;for(let o=i;o<t;o+=Qm){if(71!==e[o]||t-o!==Qm&&71!==e[o+Qm]){if(a)return-1;break}if(a++,-1===s&&(s=o,0!==s&&(n=Math.min(s+18612,e.length-Qm)+1)),r||(r=0===$m(e,o)),r&&a>1&&(0===s&&a>2||o+Qm>n))return s}i++}return-1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:gd[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Zm.createTrack("video"),this._videoTrack.duration=i,this._audioTrack=Zm.createTrack("audio",i),this._id3Track=Zm.createTrack("id3"),this._txtTrack=Zm.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];i||(this.sampleAes=null);const s=this._videoTrack,a=this._audioTrack,o=this._id3Track,l=this._txtTrack;let c=s.pid,u=s.pesData,d=a.pid,h=o.pid,f=a.pesData,p=o.pesData,m=null,g=this.pmtParsed,v=this._pmtId,y=e.length;if(this.remainderData&&(y=(e=Id(this.remainderData,e)).length,this.remainderData=null),y<Qm&&!r)return this.remainderData=e,{audioTrack:a,videoTrack:s,id3Track:o,textTrack:l};const _=Math.max(0,Zm.syncOffset(e));y-=(y-_)%Qm,y<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,y,e.buffer.byteLength-y));let b=0;for(let S=_;S<y;S+=Qm)if(71===e[S]){const t=!!(64&e[S+1]),r=$m(e,S);let y;if((48&e[S+3])>>4>1){if(y=S+5+e[S+4],y===S+Qm)continue}else y=S+4;switch(r){case c:t&&(u&&(n=rg(u,this.logger))&&(this.readyVideoParser(s.segmentCodec),null!==this.videoParser&&this.videoParser.parsePES(s,l,n,!1)),u={data:[],size:0}),u&&(u.data.push(e.subarray(y,S+Qm)),u.size+=S+Qm-y);break;case d:if(t){if(f&&(n=rg(f,this.logger)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,n);break;case"mp3":this.parseMPEGPES(a,n);break;case"ac3":this.parseAC3PES(a,n)}f={data:[],size:0}}f&&(f.data.push(e.subarray(y,S+Qm)),f.size+=S+Qm-y);break;case h:t&&(p&&(n=rg(p,this.logger))&&this.parseID3PES(o,n),p={data:[],size:0}),p&&(p.data.push(e.subarray(y,S+Qm)),p.size+=S+Qm-y);break;case 0:t&&(y+=e[y]+1),v=this._pmtId=eg(e,y);break;case v:{t&&(y+=e[y]+1);const n=tg(e,y,this.typeSupported,i,this.observer,this.logger);c=n.videoPid,c>0&&(s.pid=c,s.segmentCodec=n.segmentVideoCodec),d=n.audioPid,d>0&&(a.pid=d,a.segmentCodec=n.segmentAudioCodec),h=n.id3Pid,h>0&&(o.pid=h),null===m||g||(this.logger.warn("MPEG-TS PMT found at ".concat(S," after unknown PID '").concat(m,"'. Backtracking to sync byte @").concat(_," to parse all TS packets.")),m=null,S=_-188),g=this.pmtParsed=!0;break}case 17:case 8191:break;default:m=r}}else b++;b>0&&ng(this.observer,new Error("Found ".concat(b," TS packet/s that do not start with 0x47")),void 0,this.logger),s.pesData=u,a.pesData=f,o.pesData=p;const x={audioTrack:a,videoTrack:s,id3Track:o,textTrack:l};return r&&this.extractRemainingSamples(x),x}flush(){const{remainderData:e}=this;let t;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:r}=e,s=n.pesData,a=t.pesData,o=i.pesData;let l;if(s&&(l=rg(s,this.logger))?(this.readyVideoParser(n.segmentCodec),null!==this.videoParser&&(this.videoParser.parsePES(n,r,l,!0),n.pesData=null)):n.pesData=s,a&&(l=rg(a,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,l);break;case"mp3":this.parseMPEGPES(t,l);break;case"ac3":this.parseAC3PES(t,l)}t.pesData=null}else null!=a&&a.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;o&&(l=rg(o,this.logger))?(this.parseID3PES(i,l),i.pesData=null):i.pesData=o}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),r=this.sampleAes=new Ym(this.observer,this.config,t);return this.decrypt(i,r)}readyVideoParser(e){null===this.videoParser&&("avc"===e?this.videoParser=new qm:"hevc"===e&&(this.videoParser=new Jm))}decrypt(e,t){return new Promise(n=>{const{audioTrack:i,videoTrack:r}=e;i.samples&&"aac"===i.segmentCodec?t.decryptAacSamples(i.samples,0,()=>{r.samples?t.decryptAvcSamples(r.samples,0,0,()=>{n(e)}):n(e)}):r.samples&&t.decryptAvcSamples(r.samples,0,0,()=>{n(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let r,s,a,o=t.data;if(i){this.aacOverFlow=null;const t=i.missing,r=i.sample.unit.byteLength;if(-1===t)o=Id(i.sample.unit,o);else{const s=r-t;i.sample.unit.set(o.subarray(0,t),s),e.samples.push(i.sample),n=i.missing}}for(r=n,s=o.length;r<s-1&&!fm(o,r);r++);if(r!==n){let e;const t=r<s-1;if(e=t?"AAC PES did not start with ADTS header,offset:".concat(r):"No ADTS header found in AAC PES",ng(this.observer,new Error(e),t,this.logger),!t)return}if(mm(e,this.observer,o,r,this.audioCodec),void 0!==t.pts)a=t.pts;else{if(!i)return void this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");{const t=gm(e.samplerate);a=i.sample.pts+t}}let l,c=0;for(;r<s;){if(l=vm(e,o,r,a,c),r+=l.length,l.missing){this.aacOverFlow=l;break}for(c++;r<s-1&&!fm(o,r);r++);}}parseMPEGPES(e,t){const n=t.data,i=n.length;let r=0,s=0;const a=t.pts;if(void 0!==a)for(;s<i;)if(Um(n,s)){const t=Nm(e,n,s,a,r);if(!t)break;s+=t.length,r++}else s++;else this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(e,t){{const n=t.data,i=t.pts;if(void 0===i)return void this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");const r=n.length;let s,a=0,o=0;for(;o<r&&(s=Vm(e,n,o,i,a++))>0;)o+=s}}parseID3PES(e,t){if(void 0===t.pts)return void this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");const n=Hu({},t,{type:this._videoTrack?Am.emsg:Am.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function $m(e,t){return((31&e[t+1])<<8)+e[t+2]}function eg(e,t){return(31&e[t+10])<<8|e[t+11]}function tg(e,t,n,i,r,s){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<o;){const o=$m(e,t),l=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 207:if(!i){ig("ADTS AAC",s);break}case 15:-1===a.audioPid&&(a.audioPid=o);break;case 21:-1===a.id3Pid&&(a.id3Pid=o);break;case 219:if(!i){ig("H.264",s);break}case 27:-1===a.videoPid&&(a.videoPid=o);break;case 3:case 4:n.mpeg||n.mp3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="mp3"):s.log("MPEG audio found, not supported in this browser");break;case 193:if(!i){ig("AC-3",s);break}case 129:n.ac3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="ac3"):s.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===a.audioPid&&l>0){let i=t+5,r=l;for(;r>2;){if(106===e[i])!0!==n.ac3?s.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=o,a.segmentAudioCodec="ac3");const t=e[i+1]+2;i+=t,r-=t}}break;case 194:case 135:return ng(r,new Error("Unsupported EC-3 in M2TS found"),void 0,s),a;case 36:-1===a.videoPid&&(a.videoPid=o,a.segmentVideoCodec="hevc",s.log("HEVC in M2TS found"))}t+=l+5}return a}function ng(e,t,n,i){i.warn("parsing error: ".concat(t.message)),e.emit(Ru.ERROR,Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.FRAG_PARSING_ERROR,fatal:!1,levelRetry:n,error:t,reason:t.message})}function ig(e,t){t.log("".concat(e," with AES-128-CBC encryption found in unencrypted stream"))}function rg(e,t){let n,i,r,s,a,o=0;const l=e.data;if(!e||0===e.size)return null;for(;l[0].length<19&&l.length>1;)l[0]=Id(l[0],l[1]),l.splice(1,1);n=l[0];if(1===(n[0]<<16)+(n[1]<<8)+n[2]){if(i=(n[4]<<8)+n[5],i&&i>e.size-6)return null;const c=n[7];192&c&&(s=536870912*(14&n[9])+4194304*(255&n[10])+16384*(254&n[11])+128*(255&n[12])+(254&n[13])/2,64&c?(a=536870912*(14&n[14])+4194304*(255&n[15])+16384*(254&n[16])+128*(255&n[17])+(254&n[18])/2,s-a>54e5&&(t.warn("".concat(Math.round((s-a)/9e4),"s delta between PTS and DTS, align them")),s=a)):a=s),r=n[8];let u=r+9;if(e.size<=u)return null;e.size-=u;const d=new Uint8Array(e.size);for(let e=0,t=l.length;e<t;e++){n=l[e];let t=n.byteLength;if(u){if(u>t){u-=t;continue}n=n.subarray(u),t-=u,u=0}d.set(n,o),o+=t}return i&&(i-=r+3),{data:d,pts:s,dts:a,len:i}}return null}class sg{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const ag=Math.pow(2,32)-1;class og{static init(){let e;for(e in og.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},og.types)og.types.hasOwnProperty(e)&&(og.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);og.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);og.STTS=og.STSC=og.STCO=r,og.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),og.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),og.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),og.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const s=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);og.FTYP=og.box(og.types.ftyp,s,o,s,a),og.DINF=og.box(og.types.dinf,og.box(og.types.dref,i))}static box(e){let t=8;for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];let s=i.length;const a=s;for(;s--;)t+=i[s].byteLength;const o=new Uint8Array(t);for(o[0]=t>>24&255,o[1]=t>>16&255,o[2]=t>>8&255,o[3]=255&t,o.set(e,4),s=0,t=8;s<a;s++)o.set(i[s],t),t+=i[s].byteLength;return o}static hdlr(e){return og.box(og.types.hdlr,og.HDLR_TYPES[e])}static mdat(e){return og.box(og.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(ag+1)),i=Math.floor(t%(ag+1));return og.box(og.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}static mdia(e){return og.box(og.types.mdia,og.mdhd(e.timescale||0,e.duration||0),og.hdlr(e.type),og.minf(e))}static mfhd(e){return og.box(og.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return"audio"===e.type?og.box(og.types.minf,og.box(og.types.smhd,og.SMHD),og.DINF,og.stbl(e)):og.box(og.types.minf,og.box(og.types.vmhd,og.VMHD),og.DINF,og.stbl(e))}static moof(e,t,n){return og.box(og.types.moof,og.mfhd(e),og.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=og.trak(e[t]);return og.box.apply(null,[og.types.moov,og.mvhd(e[0].timescale||0,e[0].duration||0)].concat(n).concat(og.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=og.trex(e[t]);return og.box.apply(null,[og.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(ag+1)),i=Math.floor(t%(ag+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return og.box(og.types.mvhd,r)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,r;for(i=0;i<t.length;i++)r=t[i].flags,n[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return og.box(og.types.sdtp,n)}static stbl(e){return og.box(og.types.stbl,og.stsd(e),og.box(og.types.stts,og.STTS),og.box(og.types.stsc,og.STSC),og.box(og.types.stsz,og.STSZ),og.box(og.types.stco,og.STCO))}static avc1(e){let t,n,i,r=[],s=[];for(t=0;t<e.sps.length;t++)n=e.sps[t],i=n.byteLength,r.push(i>>>8&255),r.push(255&i),r=r.concat(Array.prototype.slice.call(n));for(t=0;t<e.pps.length;t++)n=e.pps[t],i=n.byteLength,s.push(i>>>8&255),s.push(255&i),s=s.concat(Array.prototype.slice.call(n));const a=og.box(og.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|e.sps.length].concat(r).concat([e.pps.length]).concat(s))),o=e.width,l=e.height,c=e.pixelRatio[0],u=e.pixelRatio[1];return og.box(og.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,og.box(og.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),og.box(og.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,u>>24,u>>16&255,u>>8&255,255&u])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,255&t,0,0])}static mp4a(e){return og.box(og.types.mp4a,og.audioStsd(e),og.box(og.types.esds,og.esds(e)))}static mp3(e){return og.box(og.types[".mp3"],og.audioStsd(e))}static ac3(e){return og.box(og.types["ac-3"],og.audioStsd(e),og.box(og.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if("audio"===e.type){if("aac"===t)return og.box(og.types.stsd,og.STSD,og.mp4a(e));if("ac3"===t&&e.config)return og.box(og.types.stsd,og.STSD,og.ac3(e));if("mp3"===t&&"mp3"===e.codec)return og.box(og.types.stsd,og.STSD,og.mp3(e))}else{if(!e.pps||!e.sps)throw new Error("video track missing pps or sps");if("avc"===t)return og.box(og.types.stsd,og.STSD,og.avc1(e));if("hevc"===t&&e.vps)return og.box(og.types.stsd,og.STSD,og.hvc1(e))}throw new Error("unsupported ".concat(e.type," segment codec (").concat(t,"/").concat(e.codec,")"))}static tkhd(e){const t=e.id,n=(e.duration||0)*(e.timescale||0),i=e.width||0,r=e.height||0,s=Math.floor(n/(ag+1)),a=Math.floor(n%(ag+1));return og.box(og.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,r>>8&255,255&r,0,0]))}static traf(e,t){const n=og.sdtp(e),i=e.id,r=Math.floor(t/(ag+1)),s=Math.floor(t%(ag+1));return og.box(og.types.traf,og.box(og.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),og.box(og.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s])),og.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,og.box(og.types.trak,og.tkhd(e),og.mdia(e))}static trex(e){const t=e.id;return og.box(og.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,r=12+16*i,s=new Uint8Array(r);let a,o,l,c,u,d;for(t+=8+r,s.set(["video"===e.type?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,255&i,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),a=0;a<i;a++)o=n[a],l=o.duration,c=o.size,u=o.flags,d=o.cts,s.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,c>>>24&255,c>>>16&255,c>>>8&255,255&c,u.isLeading<<2|u.dependsOn,u.isDependedOn<<6|u.hasRedundancy<<4|u.paddingValue<<1|u.isNonSync,61440&u.degradPrio,15&u.degradPrio,d>>>24&255,d>>>16&255,d>>>8&255,255&d],12+16*a);return og.box(og.types.trun,s)}static initSegment(e){og.types||og.init();const t=og.moov(e);return Id(og.FTYP,t)}static hvc1(e){const t=e.params,n=[e.vps,e.sps,e.pps],i=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),3|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),n.length]);let r=i.length;for(let h=0;h<n.length;h+=1){r+=3;for(let e=0;e<n[h].length;e+=1)r+=2+n[h][e].length}const s=new Uint8Array(r);s.set(i,0),r=i.length;const a=n.length-1;for(let h=0;h<n.length;h+=1){s.set(new Uint8Array([32+h|(h===a?128:0),0,n[h].length]),r),r+=3;for(let e=0;e<n[h].length;e+=1)s.set(new Uint8Array([n[h][e].length>>8,255&n[h][e].length]),r),r+=2,s.set(n[h][e],r),r+=n[h][e].length}const o=og.box(og.types.hvcC,s),l=e.width,c=e.height,u=e.pixelRatio[0],d=e.pixelRatio[1];return og.box(og.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,og.box(og.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),og.box(og.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,d>>24,d>>16&255,d>>8&255,255&d])))}}og.types=void 0,og.HDLR_TYPES=void 0,og.STTS=void 0,og.STSC=void 0,og.STCO=void 0,og.STSZ=void 0,og.VMHD=void 0,og.SMHD=void 0,og.STSD=void 0,og.FTYP=void 0,og.DINF=void 0;function lg(e,t){const n=e*t*(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1);return arguments.length>3&&void 0!==arguments[3]&&arguments[3]?Math.round(n):n}function cg(e){return lg(e,1e3,1/9e4,arguments.length>1&&void 0!==arguments[1]&&arguments[1])}function ug(e){const{baseTime:t,timescale:n,trackId:i}=e;return"".concat(t/n," (").concat(t,"/").concat(n,") trackId: ").concat(i)}let dg,hg=null,fg=null;function pg(e,t,n,i){return{duration:t,size:n,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class mg extends Vu{constructor(e,t,n,i){if(super("mp4-remuxer",i),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,null===hg){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);hg=e?parseInt(e[1]):0}if(null===fg){const e=navigator.userAgent.match(/Safari\/(\d+)/i);fg=e?parseInt(e[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){const t=this._initPTS;t&&e&&e.trackId===t.trackId&&e.baseTime===t.baseTime&&e.timescale===t.timescale||this.log("Reset initPTS: ".concat(t?ug(t):t," > ").concat(e?ug(e):e)),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,i=e.reduce((e,i)=>{let r=i.pts,s=r-e;return s<-4294967296&&(t=!0,r=gg(r,n),s=r-e),s>0?e:r},n);return t&&this.debug("PTS rollover detected"),i}remux(e,t,n,i,r,s,a,o){let l,c,u,d,h,f,p=r,m=r;const g=e.pid>-1,v=t.pid>-1,y=t.samples.length,_=e.samples.length>0,b=a&&y>0||y>1;if((!g||_)&&(!v||b)||this.ISGenerated||a){if(this.ISGenerated){var x,S,E,w;const e=this.videoTrackConfig;(e&&(t.width!==e.width||t.height!==e.height||(null==(x=t.pixelRatio)?void 0:x[0])!==(null==(S=e.pixelRatio)?void 0:S[0])||(null==(E=t.pixelRatio)?void 0:E[1])!==(null==(w=e.pixelRatio)?void 0:w[1]))||!e&&b||null===this.nextAudioTs&&_)&&this.resetInitSegment()}this.ISGenerated||(u=this.generateIS(e,t,r,s));const n=this.isVideoContiguous;let i,a=-1;if(b&&(a=function(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!n&&this.config.forceKeyFrameOnDiscontinuity))if(f=!0,a>0){this.warn("Dropped ".concat(a," out of ").concat(y," video samples due to a missing keyframe"));const e=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(a),t.dropped+=a,m+=(t.samples[0].pts-e)/t.inputTimeScale,i=m}else-1===a&&(this.warn("No keyframe found out of ".concat(y," video samples")),f=!1);if(this.ISGenerated){if(_&&b){const n=this.getVideoStartPts(t.samples),i=(gg(e.samples[0].pts,n)-n)/t.inputTimeScale;p+=Math.max(0,i),m+=Math.max(0,-i)}if(_){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),u=this.generateIS(e,t,r,s)),c=this.remuxAudio(e,p,this.isAudioContiguous,s,v||b||o===Ou?m:void 0),b){const i=c?c.endPTS-c.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),u=this.generateIS(e,t,r,s)),l=this.remuxVideo(t,m,n,i)}}else b&&(l=this.remuxVideo(t,m,n,0));l&&(l.firstKeyFrame=a,l.independent=-1!==a,l.firstKeyFramePTS=i)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(h=vg(n,r,this._initPTS,this._initDTS)),i.samples.length&&(d=yg(i,r,this._initPTS))),{audio:c,video:l,initSegment:u,independent:f,text:d,id3:h}}computeInitPts(e,t,n,i){const r=Math.round(n*t);let s=gg(e,r);if(s<r+t)for(this.log("Adjusting PTS for rollover in timeline near ".concat((r-s)/t," ").concat(i));s<r+t;)s+=8589934592;return s-r}generateIS(e,t,n,i){const r=e.samples,s=t.samples,a=this.typeSupported,o={},l=this._initPTS;let c,u,d,h=!l||i,f="audio/mp4",p=-1;if(h&&(c=u=1/0),e.config&&r.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(f="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3"}o.audio={id:"audio",container:f,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&a.mpeg?new Uint8Array(0):og.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(p=e.id,d=e.inputTimeScale,l&&d===l.timescale?h=!1:c=u=this.computeInitPts(r[0].pts,d,n,"audio"))}if(t.sps&&t.pps&&s.length){if(t.timescale=t.inputTimeScale,o.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:og.initSegment([t]),metadata:{width:t.width,height:t.height}},h)if(p=t.id,d=t.inputTimeScale,l&&d===l.timescale)h=!1;else{const e=this.getVideoStartPts(s),t=gg(s[0].dts,e),i=this.computeInitPts(t,d,n,"video"),r=this.computeInitPts(e,d,n,"video");u=Math.min(u,i),c=Math.min(c,r)}this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(o).length)return this.ISGenerated=!0,h?(l&&this.warn("Timestamps at playlist time: ".concat(i?"":"~").concat(n," ").concat(c/d," != initPTS: ").concat(l.baseTime/l.timescale," (").concat(l.baseTime,"/").concat(l.timescale,") trackId: ").concat(l.trackId)),this.log("Found initPTS at playlist time: ".concat(n," offset: ").concat(c/d," (").concat(c,"/").concat(d,") trackId: ").concat(p)),this._initPTS={baseTime:c,timescale:d,trackId:p},this._initDTS={baseTime:u,timescale:d,trackId:p}):c=d=void 0,{tracks:o,initPTS:c,timescale:d,trackId:p}}remuxVideo(e,t,n,i){const r=e.inputTimeScale,s=e.samples,a=[],o=s.length,l=this._initPTS,c=l.baseTime*r/l.timescale;let u,d,h=this.nextVideoTs,f=8,p=this.videoSampleDuration,m=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,v=!1;if(!n||null===h){const e=c+t*r,i=s[0].pts-gg(s[0].dts,s[0].pts);hg&&null!==h&&Math.abs(e-i-(h+c))<15e3?n=!0:h=e-i-c}const y=h+c;for(let O=0;O<o;O++){const e=s[O];e.pts=gg(e.pts,y),e.dts=gg(e.dts,y),e.dts<s[O>0?O-1:O].dts&&(v=!0)}v&&s.sort(function(e,t){const n=e.dts-t.dts,i=e.pts-t.pts;return n||i}),u=s[0].dts,d=s[s.length-1].dts;const _=d-u,b=_?Math.round(_/(o-1)):p||e.inputTimeScale/30;if(n){const n=u-y,i=n>b,r=n<-1;if((i||r)&&(i?this.warn("".concat((e.segmentCodec||"").toUpperCase(),": ").concat(cg(n,!0)," ms (").concat(n,"dts) hole between fragments detected at ").concat(t.toFixed(3))):this.warn("".concat((e.segmentCodec||"").toUpperCase(),": ").concat(cg(-n,!0)," ms (").concat(n,"dts) overlapping between fragments detected at ").concat(t.toFixed(3))),!r||y>=s[0].pts||hg)){u=y;const e=s[0].pts-n;if(i)s[0].dts=u,s[0].pts=e;else{let t=!0;for(let i=0;i<s.length&&!(s[i].dts>e&&t);i++){const e=s[i].pts;if(s[i].dts-=n,s[i].pts-=n,i<s.length-1){const n=s[i+1].pts;t=n<=s[i].pts==n<=e}}}this.log("Video: Initial PTS/DTS adjusted: ".concat(cg(e,!0),"/").concat(cg(u,!0),", delta: ").concat(cg(n,!0)," ms"))}}u=Math.max(0,u);let x=0,S=0,E=u;for(let O=0;O<o;O++){const e=s[O],t=e.units,n=t.length;let i=0;for(let r=0;r<n;r++)i+=t[r].data.length;S+=i,x+=n,e.length=i,e.dts<E?(e.dts=E,E+=b/4|0||1):E=e.dts,m=Math.min(e.pts,m),g=Math.max(e.pts,g)}d=s[o-1].dts;const w=S+4*x+8;let T;try{T=new Uint8Array(w)}catch(k){return void this.observer.emit(Ru.ERROR,Ru.ERROR,{type:Au.MUX_ERROR,details:Cu.REMUX_ALLOC_ERROR,fatal:!1,error:k,bytes:w,reason:"fail allocating video mdat ".concat(w)})}const M=new DataView(T.buffer);M.setUint32(0,w),T.set(og.types.mdat,4);let A=!1,C=Number.POSITIVE_INFINITY,R=Number.POSITIVE_INFINITY,L=Number.NEGATIVE_INFINITY,P=Number.NEGATIVE_INFINITY;for(let O=0;O<o;O++){const e=s[O],t=e.units;let n,l=0;for(let i=0,r=t.length;i<r;i++){const e=t[i],n=e.data,r=e.data.byteLength;M.setUint32(f,r),f+=4,T.set(n,f),f+=r,l+=4+r}if(O<o-1)p=s[O+1].dts-e.dts,n=s[O+1].pts-e.pts;else{const t=this.config,a=O>0?e.dts-s[O-1].dts:b;if(n=O>0?e.pts-s[O-1].pts:b,t.stretchShortVideoTrack&&null!==this.nextAudioTs){const n=Math.floor(t.maxBufferHole*r),s=(i?m+i*r:this.nextAudioTs+c)-e.pts;s>n?(p=s-a,p<0?p=a:A=!0,this.log("It is approximately ".concat(s/90," ms to the next segment; using duration ").concat(p/90," ms for the last video frame."))):p=a}else p=a}const u=Math.round(e.pts-e.dts);C=Math.min(C,p),L=Math.max(L,p),R=Math.min(R,n),P=Math.max(P,n),a.push(pg(e.key,p,l,u))}if(a.length)if(hg){if(hg<70){const e=a[0].flags;e.dependsOn=2,e.isNonSync=0}}else if(fg&&P-R<L-C&&b/L<.025&&0===a[0].cts){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let e=u;for(let t=0,n=a.length;t<n;t++){const i=e+a[t].duration,r=e+a[t].cts;if(t<n-1){const e=i+a[t+1].cts;a[t].duration=e-r}else a[t].duration=t?a[t-1].duration:b;a[t].cts=0,e=i}}p=A||!p?b:p;const I=d+p;this.nextVideoTs=h=I-c,this.videoSampleDuration=p,this.isVideoContiguous=!0;const D={data1:og.moof(e.sequenceNumber++,u,Hu(e,{samples:a})),data2:T,startPTS:(m-c)/r,endPTS:(g+p-c)/r,startDTS:(u-c)/r,endDTS:h/r,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,D}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}}remuxAudio(e,t,n,i,r){const s=e.inputTimeScale,a=s/(e.samplerate?e.samplerate:s),o=this.getSamplesPerFrame(e),l=o*a,c=this._initPTS,u="mp3"===e.segmentCodec&&this.typeSupported.mpeg,d=[],h=void 0!==r;let f=e.samples,p=u?0:8,m=this.nextAudioTs||-1;const g=c.baseTime*s/c.timescale,v=g+t*s;if(this.isAudioContiguous=n=n||f.length&&m>0&&(i&&Math.abs(v-(m+g))<9e3||Math.abs(gg(f[0].pts,v)-(m+g))<20*l),f.forEach(function(e){e.pts=gg(e.pts,v)}),!n||m<0){const e=f.length;if(f=f.filter(e=>e.pts>=0),e!==f.length&&this.warn("Removed ".concat(f.length-e," of ").concat(e," samples (initPTS ").concat(g," / ").concat(s,")")),!f.length)return;m=0===r?0:i&&!h?Math.max(0,v-g):f[0].pts-g}if("aac"===e.segmentCodec){const t=this.config.maxAudioFramesDrift;for(let n=0,i=m+g;n<f.length;n++){const r=f[n],a=r.pts,o=a-i,c=Math.abs(1e3*o/s);if(o<=-t*l&&h)0===n&&(this.warn("Audio frame @ ".concat((a/s).toFixed(3),"s overlaps marker by ").concat(Math.round(1e3*o/s)," ms.")),this.nextAudioTs=m=a-g,i=a);else if(o>=t*l&&c<1e4&&h){let t=Math.round(o/l);for(i=a-t*l;i<0&&t&&l;)t--,i+=l;0===n&&(this.nextAudioTs=m=i-g),this.warn("Injecting ".concat(t," audio frames @ ").concat(((i-g)/s).toFixed(3),"s due to ").concat(Math.round(1e3*o/s)," ms gap."));for(let s=0;s<t;s++){let t=sg.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);t||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),t=r.unit.subarray()),f.splice(n,0,{unit:t,pts:i}),i+=l,n++}}r.pts=i,i+=l}}let y,_=null,b=null,x=0,S=f.length;for(;S--;)x+=f[S].unit.byteLength;for(let L=0,P=f.length;L<P;L++){const t=f[L],i=t.unit;let r=t.pts;if(null!==b){d[L-1].duration=Math.round((r-b)/a)}else{if(n&&"aac"===e.segmentCodec&&(r=m+g),_=r,!(x>0))return;x+=p;try{y=new Uint8Array(x)}catch(R){return void this.observer.emit(Ru.ERROR,Ru.ERROR,{type:Au.MUX_ERROR,details:Cu.REMUX_ALLOC_ERROR,fatal:!1,error:R,bytes:x,reason:"fail allocating audio mdat ".concat(x)})}if(!u){new DataView(y.buffer).setUint32(0,x),y.set(og.types.mdat,4)}}y.set(i,p);const s=i.byteLength;p+=s,d.push(pg(!0,o,s,0)),b=r}const E=d.length;if(!E)return;const w=d[d.length-1];m=b-g,this.nextAudioTs=m+a*w.duration;const T=u?new Uint8Array(0):og.moof(e.sequenceNumber++,_/a,Hu({},e,{samples:d}));e.samples=[];const M=(_-g)/s,A=this.nextAudioTs/s,C={data1:T,data2:y,startPTS:M,endPTS:A,startDTS:M,endDTS:A,type:"audio",hasAudio:!0,hasVideo:!1,nb:E};return this.isAudioContiguous=!0,C}}function gg(e,t){let n;if(null===t)return e;for(n=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=n;return e}function vg(e,t,n,i){const r=e.samples.length;if(!r)return;const s=e.inputTimeScale;for(let o=0;o<r;o++){const r=e.samples[o];r.pts=gg(r.pts-n.baseTime*s/n.timescale,t*s)/s,r.dts=gg(r.dts-i.baseTime*s/i.timescale,t*s)/s}const a=e.samples;return e.samples=[],{samples:a}}function yg(e,t,n){const i=e.samples.length;if(!i)return;const r=e.inputTimeScale;for(let a=0;a<i;a++){const i=e.samples[a];i.pts=gg(i.pts-n.baseTime*r/n.timescale,t*r)/r}e.samples.sort((e,t)=>e.pts-t.pts);const s=e.samples;return e.samples=[],{samples:s}}function _g(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return void 0!==(null==e?void 0:e.start)?(e.start+(n?e.duration:0))/e.timescale:t}function bg(e,t,n){const i=e.codec;if(i&&i.length>4)return i;if(t===ad){if("ec-3"===i||"ac-3"===i||"alac"===i)return i;if("fLaC"===i||"Opus"===i){return Jd(i,!1)}return n.warn('Unhandled audio codec "'.concat(i,'" in mp4 MAP')),i||"mp4a"}return n.warn('Unhandled video codec "'.concat(i,'" in mp4 MAP')),i||"avc1"}try{dg=self.performance.now.bind(self.performance)}catch(One){dg=Date.now}const xg=[{demux:class{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const r=this.videoTrack=Cm("video",1),s=this.audioTrack=Cm("audio",1),a=this.txtTrack=Cm("text",1);if(this.id3Track=Cm("id3",1),this.timeOffset=0,null==e||!e.byteLength)return;const o=wd(e);if(o.video){const{id:e,timescale:t,codec:n,supplemental:i}=o.video;r.id=e,r.timescale=a.timescale=t,r.codec=n,r.supplemental=i}if(o.audio){const{id:e,timescale:t,codec:n}=o.audio;s.id=e,s.timescale=t,s.codec=n}a.id=gd.text,r.sampleDuration=0,r.duration=s.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return function(e){const t=e.byteLength;for(let n=0;n<t;){const i=_d(e,n);if(i>8&&109===e[n+4]&&111===e[n+5]&&111===e[n+6]&&102===e[n+7])return!0;n=i>1?n+i:t}return!1}(e)}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Id(this.remainderData,e));const t=function(e){const t={valid:null,remainder:null},n=Sd(e,["moof"]);if(n.length<2)return t.remainder=e,t;const i=n[n.length-1];return t.valid=e.slice(0,i.byteOffset-8),t.remainder=e.slice(i.byteOffset-8),t}(n);this.remainderData=t.remainder,i.samples=t.valid||new Uint8Array}else i.samples=n;const s=this.extractID3Track(i,t);return r.samples=Dd(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=Dd(e,t),{videoTrack:t,audioTrack:Cm(),id3Track:i,textTrack:Cm()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=Sd(e.samples,["emsg"]);i&&i.forEach(e=>{const i=function(e){const t=e[0];let n="",i="",r=0,s=0,a=0,o=0,l=0,c=0;if(0===t){for(;"\0"!==vd(e.subarray(c,c+1));)n+=vd(e.subarray(c,c+1)),c+=1;for(n+=vd(e.subarray(c,c+1)),c+=1;"\0"!==vd(e.subarray(c,c+1));)i+=vd(e.subarray(c,c+1)),c+=1;i+=vd(e.subarray(c,c+1)),c+=1,r=_d(e,12),s=_d(e,16),o=_d(e,20),l=_d(e,24),c=28}else if(1===t){c+=4,r=_d(e,c),c+=4;const t=_d(e,c);c+=4;const s=_d(e,c);for(c+=4,a=2**32*t+s,Tu(a)||(a=Number.MAX_SAFE_INTEGER,qu.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=_d(e,c),c+=4,l=_d(e,c),c+=4;"\0"!==vd(e.subarray(c,c+1));)n+=vd(e.subarray(c,c+1)),c+=1;for(n+=vd(e.subarray(c,c+1)),c+=1;"\0"!==vd(e.subarray(c,c+1));)i+=vd(e.subarray(c,c+1)),c+=1;i+=vd(e.subarray(c,c+1)),c+=1}return{schemeIdUri:n,value:i,timeScale:r,presentationTime:a,presentationTimeDelta:s,eventDuration:o,id:l,payload:e.subarray(c,e.byteLength)}}(e);if(Wm.test(i.schemeIdUri)){const e=jm(i,t);let r=4294967295===i.eventDuration?Number.POSITIVE_INFINITY:i.eventDuration/i.timeScale;r<=.001&&(r=Number.POSITIVE_INFINITY);const s=i.payload;n.samples.push({data:s,len:s.byteLength,dts:e,pts:e,type:Am.emsg,duration:r})}else if(this.config.enableEmsgKLVMetadata&&i.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const e=jm(i,t);n.samples.push({data:i.payload,len:i.payload.byteLength,dts:e,pts:e,type:Am.misbklv,duration:Number.POSITIVE_INFINITY})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}},remux:class extends Vu{constructor(e,t,n,i){super("passthrough-remuxer",i),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(e,i),this.emitInitSegment=!0}generateInitSegment(e,t){let{audioCodec:n,videoCodec:i}=this;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const{audio:r,video:s}=this.initData=wd(e);if(t)!function(e,t){if(!e||!t)return;const n=t.keyId;n&&t.isCommonEncryption&&Ld(e,(e,t)=>{const i=e.subarray(8,24);i.some(e=>0!==e)||(qu.log("[eme] Patching keyId in 'enc".concat(t?"a":"v",">sinf>>tenc' box: ").concat($u(i)," -> ").concat($u(n))),e.set(n,8))})}(e,t);else{const e=r||s;null!=e&&e.encrypted&&this.warn('Init segment with encrypted track with has no key ("'.concat(e.codec,'")!'))}r&&(n=bg(r,ad,this)),s&&(i=bg(s,od,this));const a={};r&&s?a.audiovideo={container:"video/mp4",codec:n+","+i,supplemental:s.supplemental,encrypted:s.encrypted,initSegment:e,id:"main"}:r?a.audio={container:"audio/mp4",codec:n,encrypted:r.encrypted,initSegment:e,id:"audio"}:s?a.video={container:"video/mp4",codec:i,supplemental:s.supplemental,encrypted:s.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=a}remux(e,t,n,i,r,s){var a,o;let{initPTS:l,lastEndTime:c}=this;const u={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};wu(c)||(c=this.lastEndTime=r||0);const d=t.samples;if(!d.length)return u;const h={initPTS:void 0,timescale:void 0,trackId:void 0};let f=this.initData;if(null!=(a=f)&&a.length||(this.generateInitSegment(d),f=this.initData),null==(o=f)||!o.length)return this.warn("Failed to generate initSegment."),u;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1);const p=function(e,t,n){const i={},r=Sd(e,["moof","traf"]);for(let s=0;s<r.length;s++){const e=r[s],a=Sd(e,["tfhd"])[0],o=_d(a,4),l=t[o];if(!l)continue;i[o]||(i[o]={start:NaN,duration:0,sampleCount:0,timescale:l.timescale,type:l.type});const c=i[o],u=Sd(e,["tfdt"])[0];if(u){const e=u[0];let t=_d(u,4);1===e&&(t===pd?n.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(t*=pd+1,t+=_d(u,8))),wu(t)&&(!wu(c.start)||t<c.start)&&(c.start=t)}const d=l.default,h=_d(a,0)|(null==d?void 0:d.flags);let f=(null==d?void 0:d.duration)||0;8&h&&(f=_d(a,2&h?12:8));const p=Sd(e,["trun"]);let m=c.start||0,g=0,v=f;for(let t=0;t<p.length;t++){const e=p[t],n=_d(e,4),i=c.sampleCount;c.sampleCount+=n;const r=1&e[3],s=4&e[3],a=1&e[2],o=2&e[2],l=4&e[2],u=8&e[2];let d=8,h=n;for(r&&(d+=4),s&&n&&(1&e[d+1]||void 0!==c.keyFrameIndex||(c.keyFrameIndex=i),d+=4,a?(v=_d(e,d),d+=4):v=f,o&&(d+=4),u&&(d+=4),m+=v,g+=v,h--);h--;)a?(v=_d(e,d),d+=4):v=f,o&&(d+=4),l&&(1&e[d+1]||void 0===c.keyFrameIndex&&(c.keyFrameIndex=c.sampleCount-(h+1),c.keyFrameStart=m),d+=4),u&&(d+=4),m+=v,g+=v;!g&&f&&(g+=f*n)}c.duration+=g}if(!Object.keys(i).some(e=>i[e].duration)){let t=1/0,n=0;const r=Sd(e,["sidx"]);for(let e=0;e<r.length;e++){const i=Ed(r[e]);if(null!=i&&i.references){t=Math.min(t,i.earliestPresentationTime/i.timescale);const e=i.references.reduce((e,t)=>e+t.info.duration||0,0);n=Math.max(n,e+i.earliestPresentationTime/i.timescale)}}n&&wu(n)&&Object.keys(i).forEach(e=>{i[e].duration||(i[e].duration=n*i[e].timescale-i[e].start)})}return i}(d,f,this),m=f.audio?p[f.audio.id]:null,g=f.video?p[f.video.id]:null,v=_g(g,1/0),y=_g(m,1/0),_=_g(g,0,!0),b=_g(m,0,!0);let x=r,S=0;const E=m&&(!g||!l&&y<v||l&&l.trackId===f.audio.id),w=E?m:g;if(w){const e=w.timescale,t=w.start-r*e,n=E?f.audio.id:f.video.id;x=w.start/e,S=E?b-y:_-v,!s&&l||!function(e,t,n,i){if(null===e)return!0;const r=Math.max(i,1),s=t-e.baseTime/e.timescale;return Math.abs(s-n)>r}(l,x,r,S)&&e===l.timescale||(l&&this.warn("Timestamps at playlist time: ".concat(s?"":"~").concat(r," ").concat(t/e," != initPTS: ").concat(l.baseTime/l.timescale," (").concat(l.baseTime,"/").concat(l.timescale,") trackId: ").concat(l.trackId)),this.log("Found initPTS at playlist time: ".concat(r," offset: ").concat(x-r," (").concat(t,"/").concat(e,") trackId: ").concat(n)),l=null,h.initPTS=t,h.timescale=e,h.trackId=n)}else this.warn("No audio or video samples found for initPTS at playlist time: ".concat(r));l?(h.initPTS=l.baseTime,h.timescale=l.timescale,h.trackId=l.trackId):(h.timescale&&void 0!==h.trackId&&void 0!==h.initPTS||(this.warn("Could not set initPTS"),h.initPTS=x,h.timescale=1,h.trackId=-1),this.initPTS=l={baseTime:h.initPTS,timescale:h.timescale,trackId:h.trackId});const T=x-l.baseTime/l.timescale,M=T+S;S>0?this.lastEndTime=M:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const A=!!f.audio,C=!!f.video;let R="";A&&(R+="audio"),C&&(R+="video");const L={data1:d,startPTS:T,startDTS:T,endPTS:M,endDTS:M,type:R,hasAudio:A,hasVideo:C,nb:1,dropped:0,encrypted:!!f.audio&&f.audio.encrypted||!!f.video&&f.video.encrypted};u.audio=A&&!C?L:void 0,u.video=C?L:void 0;const P=null==g?void 0:g.sampleCount;if(P){const e=g.keyFrameIndex,t=-1!==e;L.nb=P,L.dropped=0===e||this.isVideoContiguous?0:t?e:P,L.independent=t,L.firstKeyFrame=e,t&&g.keyFrameStart&&(L.firstKeyFramePTS=(g.keyFrameStart-l.baseTime)/l.timescale),this.isVideoContiguous||(u.independent=t),this.isVideoContiguous||(this.isVideoContiguous=t),L.dropped&&this.warn("fmp4 does not start with IDR: firstIDR ".concat(e,"/").concat(P," dropped: ").concat(L.dropped," start: ").concat(L.firstKeyFramePTS||"NA"))}return u.initSegment=h,u.id3=vg(n,r,l,l),i.samples.length&&(u.text=yg(i,r,l)),u}}},{demux:Zm,remux:mg},{demux:class extends Rm{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const n=cm(e,0);let i=(null==n?void 0:n.length)||0;if(Hm(e,i))return!1;for(let r=e.length;i<r;i++)if(pm(e,i))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return function(e,t){return t+5<e.length}(e,t)&&um(e,t)&&hm(e,t)<=e.length-t}(e,t)}appendFrame(e,t,n){mm(e,this.observer,t,n,e.manifestCodec);const i=vm(e,t,n,this.basePTS,this.frameIndex);if(i&&0===i.missing)return i}},remux:mg},{demux:class extends Rm{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=cm(e,0);let n=(null==t?void 0:t.length)||0;if(t&&11===e[n]&&119===e[n+1]&&void 0!==Mm(t)&&zm(e,n)<=16)return!1;for(let i=e.length;n<i;n++)if(Hm(e,n))return qu.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return Bm(e,t)&&4<=e.length-t}(e,t)}appendFrame(e,t,n){if(null!==this.basePTS)return Nm(e,t,n,this.basePTS,this.frameIndex)}},remux:mg}];xg.splice(2,0,{demux:Gm,remux:mg});class Sg{constructor(e,t,n,i,r,s){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.id=r,this.logger=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const r=n.transmuxing;r.executeStart=dg();let s=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:o}=this;i&&(this.currentTransmuxState=i);const{contiguous:l,discontinuity:c,trackSwitch:u,accurateTimeOffset:d,timeOffset:h,initSegmentChange:f}=i||a,{audioCodec:p,videoCodec:m,defaultInitPts:g,duration:v,initSegmentData:y}=o,_=function(e,t){let n=null;e.byteLength>0&&null!=(null==t?void 0:t.key)&&null!==t.iv&&null!=t.method&&(n=t);return n}(s,t);if(_&&kf(_.method)){const e=this.getDecrypter(),t=Of(_.method);if(!e.isSync())return this.asyncResult=!0,this.decryptionPromise=e.webCryptoDecrypt(s,_.key.buffer,_.iv.buffer,t).then(e=>{const t=this.push(e,null,n);return this.decryptionPromise=null,t}),this.decryptionPromise;{let i=e.softwareDecrypt(s,_.key.buffer,_.iv.buffer,t);if(n.part>-1){const t=e.flush();i=t?t.buffer:t}if(!i)return r.executeEnd=dg(),Eg(n);s=new Uint8Array(i)}}const b=this.needsProbing(c,u);if(b){const e=this.configureTransmuxer(s);if(e)return this.logger.warn("[transmuxer] ".concat(e.message)),this.observer.emit(Ru.ERROR,Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message}),r.executeEnd=dg(),Eg(n)}(c||u||f||b)&&this.resetInitSegment(y,p,m,v,t),(c||f||b)&&this.resetInitialTimestamp(g),l||this.resetContiguity();const x=this.transmux(s,_,h,d,n);this.asyncResult=wg(x);const S=this.currentTransmuxState;return S.contiguous=!0,S.discontinuity=!1,S.trackSwitch=!1,r.executeEnd=dg(),x}flush(e){const t=e.transmuxing;t.executeStart=dg();const{decrypter:n,currentTransmuxState:i,decryptionPromise:r}=this;if(r)return this.asyncResult=!0,r.then(()=>this.flush(e));const s=[],{timeOffset:a}=i;if(n){const t=n.flush();t&&s.push(this.push(t.buffer,null,e))}const{demuxer:o,remuxer:l}=this;if(!o||!l){t.executeEnd=dg();const n=[Eg(e)];return this.asyncResult?Promise.resolve(n):n}const c=o.flush(a);return wg(c)?(this.asyncResult=!0,c.then(t=>(this.flushRemux(s,t,e),s))):(this.flushRemux(s,c,e),this.asyncResult?Promise.resolve(s):s)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:r,id3Track:s,textTrack:a}=t,{accurateTimeOffset:o,timeOffset:l}=this.currentTransmuxState;this.logger.log("[transmuxer.ts]: Flushed ".concat(this.id," sn: ").concat(n.sn).concat(n.part>-1?" part: "+n.part:""," of ").concat(this.id===ku?"level":"track"," ").concat(n.level));const c=this.remuxer.remux(i,r,s,a,l,o,!0,this.id);e.push({remuxResult:c,chunkMeta:n}),n.transmuxing.executeEnd=dg()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;t&&n&&(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,r){const{demuxer:s,remuxer:a}=this;s&&a&&(s.resetInitSegment(e,t,n,i),a.resetInitSegment(e,t,n,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,r){let s;return s=t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,n,i,r):this.transmuxUnencrypted(e,n,i,r),s}transmuxUnencrypted(e,t,n,i){const{audioTrack:r,videoTrack:s,id3Track:a,textTrack:o}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,s,a,o,t,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,n,i,r){return this.demuxer.demuxSampleAes(e,t,n).then(e=>({remuxResult:this.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,n,i,!1,this.id),chunkMeta:r}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i}=this;let r;for(let u=0,d=xg.length;u<d;u++){var s;if(null!=(s=xg[u].demux)&&s.probe(e,this.logger)){r=xg[u];break}}if(!r)return new Error("Failed to find demuxer by probing fragment data");const a=this.demuxer,o=this.remuxer,l=r.remux,c=r.demux;o&&o instanceof l||(this.remuxer=new l(n,t,i,this.logger)),a&&a instanceof c||(this.demuxer=new c(n,t,i,this.logger),this.probe=c.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new uf(this.config)),e}}const Eg=e=>({remuxResult:{},chunkMeta:e});function wg(e){return"then"in e&&e.then instanceof Function}class Tg{constructor(e,t,n,i,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=r||null}}class Mg{constructor(e,t,n,i,r,s){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=r,this.initSegmentChange=s}}let Ag=0;class Cg{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=Ag++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=e=>{const t=e.data,n=this.hls;if(n&&null!=t&&t.event&&t.instanceNo===this.instanceNo)switch(t.event){case"init":{var i;const e=null==(i=this.workerContext)?void 0:i.objectURL;e&&self.URL.revokeObjectURL(e);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":n.logger[t.data.logType]&&n.logger[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.part=this.part,t.data.id=this.id,n.trigger(t.event,t.data)}},this.onWorkerError=e=>{if(!this.hls)return;const t=new Error("".concat(e.message,"  (").concat(e.filename,":").concat(e.lineno,")"));this.hls.config.enableWorker=!1,this.hls.logger.warn('Error in "'.concat(this.id,'" Web Worker, fallback to inline')),this.hls.trigger(Ru.ERROR,{type:Au.OTHER_ERROR,details:Cu.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:t})};const r=e.config;this.hls=e,this.id=t,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const s=(e,t)=>{(t=t||{}).frag=this.frag||void 0,e===Ru.ERROR&&(t.parent=this.id,t.part=this.part,this.error=t.error),this.hls.trigger(e,t)};this.observer=new im,this.observer.on(Ru.FRAG_DECRYPTED,s),this.observer.on(Ru.ERROR,s);const a=eh(r.preferManagedMediaSource);if(this.useWorker&&"undefined"!==typeof Worker){const n=this.hls.logger;if(r.workerPath||"function"===typeof __HLS_WORKER_BUNDLE__){try{r.workerPath?(n.log("loading Web Worker ".concat(r.workerPath,' for "').concat(t,'"')),this.workerContext=function(e){const t=sm[e];if(t)return t.clientCount++,t;const n=new self.URL(e,self.location.href).href,i={worker:new self.Worker(n),scriptURL:n,clientCount:1};return sm[e]=i,i}(r.workerPath)):(n.log('injecting Web Worker for "'.concat(t,'"')),this.workerContext=function(){const e=sm[rm];if(e)return e.clientCount++,e;const t=new self.Blob(["var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(".concat(__HLS_WORKER_BUNDLE__.toString(),")(true);")],{type:"text/javascript"}),n=self.URL.createObjectURL(t),i={worker:new self.Worker(n),objectURL:n,clientCount:1};return sm[rm]=i,i}());const{worker:e}=this.workerContext;e.addEventListener("message",this.onWorkerMessage),e.addEventListener("error",this.onWorkerError),e.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:a,id:t,config:_h(r)})}catch(One){n.warn('Error setting up "'.concat(t,'" Web Worker, fallback to inline'),One),this.terminateWorker(),this.error=null,this.transmuxer=new Sg(this.observer,a,r,"",t,e.logger)}return}}this.transmuxer=new Sg(this.observer,a,r,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=Ag++;const t=this.hls.config,n=eh(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:n,id:this.id,config:_h(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),function(e){const t=sm[e||rm];if(t&&1===t.clientCount--){const{worker:n,objectURL:i}=t;delete sm[e||rm],i&&self.URL.revokeObjectURL(i),n.terminate()}}(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,n,i,r,s,a,o,l,c){var u,d;l.transmuxing.start=self.performance.now();const{instanceNo:h,transmuxer:f}=this,p=s?s.start:r.start,m=r.decryptdata,g=this.frag,v=!(g&&r.cc===g.cc),y=!(g&&l.level===g.level),_=g?l.sn-g.sn:-1,b=this.part?l.part-this.part.index:-1,x=0===_&&l.id>1&&l.id===(null==g?void 0:g.stats.chunkCount),S=!y&&(1===_||0===_&&(1===b||x&&b<=0)),E=self.performance.now();(y||_||0===r.stats.parsing.start)&&(r.stats.parsing.start=E),!s||!b&&S||(s.stats.parsing.start=E);const w=!(g&&(null==(u=r.initSegment)?void 0:u.url)===(null==(d=g.initSegment)?void 0:d.url)),T=new Mg(v,S,o,y,p,w);if(!S||v||w){this.hls.logger.log("[transmuxer-interface]: Starting new transmux session for ".concat(r.type," sn: ").concat(l.sn).concat(l.part>-1?" part: "+l.part:""," ").concat(this.id===ku?"level":"track",": ").concat(l.level," id: ").concat(l.id,"\n        discontinuity: ").concat(v,"\n        trackSwitch: ").concat(y,"\n        contiguous: ").concat(S,"\n        accurateTimeOffset: ").concat(o,"\n        timeOffset: ").concat(p,"\n        initSegmentChange: ").concat(w));const e=new Tg(n,i,t,a,c);this.configureTransmuxer(e)}if(this.frag=r,this.part=s,this.workerContext)this.workerContext.worker.postMessage({instanceNo:h,cmd:"demux",data:e,decryptdata:m,chunkMeta:l,state:T},e instanceof ArrayBuffer?[e]:[]);else if(f){const t=f.push(e,m,l,T);wg(t)?t.then(e=>{this.handleTransmuxComplete(e)}).catch(e=>{this.transmuxerError(e,l,"transmuxer-interface push error")}):this.handleTransmuxComplete(t)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(n){const t=n.flush(e);wg(t)?t.then(t=>{this.handleFlushResult(t,e)}).catch(t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")}):this.handleFlushResult(t,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(e=>{this.handleTransmuxComplete(e)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):n&&n.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}class Rg extends Vu{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const i=null==t?void 0:t.renditionReports;if(i){let s=-1;for(let n=0;n<i.length;n++){const a=i[n];let o;try{o=new self.URL(a.URI,t.url).href}catch(r){this.warn("Could not construct new URL for Rendition Report: ".concat(r)),o=a.URI||""}if(o===e){s=n;break}o===e.substring(0,o.length)&&(s=n)}if(-1!==s){const e=i[s],r=parseInt(e["LAST-MSN"])||t.lastPartSn;let a=parseInt(e["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){const e=Math.min(t.age-t.partTarget,t.targetduration);a>=0&&e>t.partTarget&&(a+=1)}const o=n&&ph(n);return new mh(r,a>=0?a:void 0,o)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(n){this.warn("Could not construct new URL with HLS Delivery Directives: ".concat(n))}return e}playlistLoaded(e,t,n){const{details:i,stats:r}=t,s=self.performance.now(),a=r.loading.first?Math.max(0,s-r.loading.first):0;i.advancedDateTime=Date.now()-a;const o=this.hls.config.timelineOffset;if(o!==i.appliedTimelineOffset){const e=Math.max(o||0,0);i.appliedTimelineOffset=e,i.fragments.forEach(t=>{t.setStart(t.playlistOffset+e)})}if(i.live||null!=n&&n.live){const o="levelInfo"in t?t.levelInfo:t.track;if(i.reloaded(n),n&&i.fragments.length>0){bp(n,i,this);const e=i.playlistParsingError;if(e){this.warn(e);const n=this.hls;if(!n.config.ignorePlaylistParsingErrors){var l;const{networkDetails:s}=t;return void n.trigger(Ru.ERROR,{type:Au.NETWORK_ERROR,details:Cu.LEVEL_PARSING_ERROR,fatal:!1,url:i.url,error:e,reason:e.message,level:t.level||void 0,parent:null==(l=i.fragments[0])?void 0:l.type,networkDetails:s,stats:r})}i.playlistParsingError=null}}-1===i.requestScheduled&&(i.requestScheduled=r.loading.start);const c=this.hls.mainForwardBufferInfo,u=c?c.end-c.len:0,d=wp(i,1e3*(i.edge-u));if(i.requestScheduled+d<s?i.requestScheduled=s:i.requestScheduled+=d,this.log("live playlist ".concat(e," ").concat(i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED")),!this.canLoad||!i.live)return;let h,f,p;if(i.canBlockReload&&i.endSN&&i.advanced){const e=this.hls.config.lowLatencyMode,r=i.lastPartSn,a=i.endSN,l=i.lastPartIndex,c=r===a;-1!==l?c?(f=a+1,p=e?0:l):(f=r,p=e?l+1:i.maxPartIndex):f=a+1;const u=i.age,d=u+i.ageHeader;let m=Math.min(d-i.partTarget,1.5*i.targetduration);if(m>0){if(d>3*i.targetduration)this.log("Playlist last advanced ".concat(u.toFixed(2),"s ago. Omitting segment and part directives.")),f=void 0,p=void 0;else if(null!=n&&n.tuneInGoal&&d-i.partTarget>n.tuneInGoal)this.warn("CDN Tune-in goal increased from: ".concat(n.tuneInGoal," to: ").concat(m," with playlist age: ").concat(i.age)),m=0;else{const e=Math.floor(m/i.targetduration);if(f+=e,void 0!==p){p+=Math.round(m%i.targetduration/i.partTarget)}this.log("CDN Tune-in age: ".concat(i.ageHeader,"s last advanced ").concat(u.toFixed(2),"s goal: ").concat(m," skip sn ").concat(e," to part ").concat(p))}i.tuneInGoal=m}if(h=this.getDeliveryDirectives(i,t.deliveryDirectives,f,p),e||!c)return i.requestScheduled=s,void this.loadingPlaylist(o,h)}else(i.canBlockReload||i.canSkipUntil)&&(h=this.getDeliveryDirectives(i,t.deliveryDirectives,f,p));h&&void 0!==f&&i.canBlockReload&&(i.requestScheduled=r.loading.first+Math.max(d-2*a,d/2)),this.scheduleLoading(o,h,i)}else this.clearTimer()}scheduleLoading(e,t,n){const i=n||e.details;if(!i)return void this.loadingPlaylist(e,t);const r=self.performance.now(),s=i.requestScheduled;if(r>=s)return void this.loadingPlaylist(e,t);const a=s-r;this.log("reload live playlist ".concat(e.name||e.bitrate+"bps"," in ").concat(Math.round(a)," ms")),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),a)}getDeliveryDirectives(e,t,n,i){let r=ph(e);return null!=t&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,r=dh),new mh(n,i,r)}checkRetry(e){const t=e.details,n=Dh(e),i=e.errorAction,{action:r,retryCount:s=0,retryConfig:a}=i||{},o=!!i&&!!a&&(r===Wh||!i.resolved&&r===Gh);if(o){var l;if(s>=a.maxNumRetry)return!1;if(n&&null!=(l=e.context)&&l.deliveryDirectives)this.warn("Retrying playlist loading ".concat(s+1,"/").concat(a.maxNumRetry,' after "').concat(t,'" without delivery-directives')),this.loadPlaylist();else{const e=Fh(a,s);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),e),this.warn("Retrying playlist loading ".concat(s+1,"/").concat(a.maxNumRetry,' after "').concat(t,'" in ').concat(e,"ms"))}e.levelRetry=!0,i.resolved=!0}return o}}function Lg(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Pg(e[n].attrs,t[n].attrs))return!1;return!0}function Pg(e,t,n){const i=e["STABLE-RENDITION-ID"];return i&&!n?i===t["STABLE-RENDITION-ID"]:!(n||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(n=>e[n]!==t[n])}function Ig(e,t){return t.label.toLowerCase()===e.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(e.lang||"").toLowerCase())}class Dg{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,n){if(null===this.queues||null===this.tracks)return;const i=this.queues[t];i.push(e),1!==i.length||n||this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const n={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(n,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const n={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(n)}})}removeBlockers(){null!==this.queues&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const n=null==(t=e[0])?void 0:t.label;"async-blocker"!==n&&"async-blocker-prepend"!==n||(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(null===this.queues)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(null===this.queues||null===this.tracks)return;const t=this.queues[e];if(t.length){const r=t[0];try{r.execute()}catch(i){var n;if(r.onError(i),null===this.queues||null===this.tracks)return;const t=null==(n=this.tracks[e])?void 0:n.buffer;null!=t&&t.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){null!==this.queues&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return(null==(t=this.queues)?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return null===e||null===t?"<destroyed>":"\n".concat(this.list("video"),"\n").concat(this.list("audio"),"\n").concat(this.list("audiovideo"),"}")}list(e){var t,n;return null!=(t=this.queues)&&t[e]||null!=(n=this.tracks)&&n[e]?"".concat(e,": (").concat(this.listSbInfo(e),") ").concat(this.listOps(e)):""}listSbInfo(e){var t;const n=null==(t=this.tracks)?void 0:t[e],i=null==n?void 0:n.buffer;return i?"SourceBuffer".concat(i.updating?" updating":"").concat(n.ended?" ended":"").concat(n.ending?" ending":""):"none"}listOps(e){var t;return(null==(t=this.queues)?void 0:t[e].map(e=>e.label).join(", "))||""}}const kg=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,Og="HlsJsTrackRemovedError";class Ng extends Error{constructor(e){super(e),this.name=Og}}function Fg(e){const t=e.querySelectorAll("source");[].slice.call(t).forEach(t=>{e.removeChild(t)})}function Bg(e){return"audio"===e?1:0}class Ug{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(Ru.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(Ru.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Ru.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Ru.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Ru.BUFFER_CODECS,this.onBufferCodecs,this),e.on(Ru.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(Ru.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(Ru.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Ru.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Ru.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Ru.BUFFER_CODECS,this.onBufferCodecs,this),e.off(Ru.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&wu(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&t.logger.log("Setting autoLevelCapping to ".concat(n,": ").concat(e[n].height,"p@").concat(e[n].bitrate," for media ").concat(this.mediaWidth,"x").concat(this.mediaHeight)),t.autoLevelCapping=n,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((t,n)=>this.isLevelAllowed(t)&&n<=e);return this.clientRect=null,Ug.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,t.width||t.height||(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(kne){}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height)}static getMaxLevelByMediaSize(e,t,n){if(null==e||!e.length)return-1;const i=(e,t)=>!t||(e.width!==t.width||e.height!==t.height);let r=e.length-1;const s=Math.max(t,n);for(let a=0;a<e.length;a+=1){const t=e[a];if((t.width>=s||t.height>=s)&&i(t,e[a+1])){r=a;break}}return r}}const Hg={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},zg={HLS:"h"};class Gg{constructor(e,t){Array.isArray(e)&&(e=e.map(e=>e instanceof Gg?e:new Gg(e))),this.value=e,this.params=t}}function Vg(e,t,n,i){return new Error("failed to ".concat(e,' "').concat((r=t,Array.isArray(r)?JSON.stringify(r):r instanceof Map?"Map{}":r instanceof Set?"Set{}":"object"===typeof r?JSON.stringify(r):String(r)),'" as ').concat(n),{cause:i});var r}function Wg(e,t,n){return Vg("serialize",e,t,n)}class jg{constructor(e){this.description=e}}const Yg="Bare Item";function Xg(e){if(!1===ArrayBuffer.isView(e))throw Wg(e,"Byte Sequence");return":".concat((t=e,btoa(String.fromCharCode(...t))),":");var t}function Kg(e){if(function(e){return e<-999999999999999||999999999999999<e}(e))throw Wg(e,"Integer");return e.toString()}function qg(e,t){if(e<0)return-qg(-e,t);const n=Math.pow(10,t);if(Math.abs(e*n%1-.5)<Number.EPSILON){const t=Math.floor(e*n);return(t%2===0?t:t+1)/n}return Math.round(e*n)/n}function Jg(e){const t=qg(e,3);if(Math.floor(Math.abs(t)).toString().length>12)throw Wg(e,"Decimal");const n=t.toString();return n.includes(".")?n:"".concat(n,".0")}const Qg=/[\x00-\x1f\x7f]+/;function Zg(e){const t=(n=e).description||n.toString().slice(7,-1);var n;if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t))throw Wg(t,"Token");return t}function $g(e){switch(typeof e){case"number":if(!wu(e))throw Wg(e,Yg);return Number.isInteger(e)?Kg(e):Jg(e);case"string":return function(e){if(Qg.test(e))throw Wg(e,"String");return'"'.concat(e.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),'"')}(e);case"symbol":return Zg(e);case"boolean":return function(e){if("boolean"!==typeof e)throw Wg(e,"Boolean");return e?"?1":"?0"}(e);case"object":if(e instanceof Date)return function(e){return"@".concat(Kg(e.getTime()/1e3))}(e);if(e instanceof Uint8Array)return Xg(e);if(e instanceof jg)return Zg(e);default:throw Wg(e,Yg)}}function ev(e){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(e))throw Wg(e,"Key");return e}function tv(e){return null==e?"":Object.entries(e).map(e=>{let[t,n]=e;return!0===n?";".concat(ev(t)):";".concat(ev(t),"=").concat($g(n))}).join("")}function nv(e){return e instanceof Gg?"".concat($g(e.value)).concat(tv(e.params)):$g(e)}function iv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{whitespace:!0};if("object"!==typeof e||null==e)throw Wg(e,"Dict");const n=e instanceof Map?e.entries():Object.entries(e),i=(null===t||void 0===t?void 0:t.whitespace)?" ":"";return Array.from(n).map(e=>{let[t,n]=e;n instanceof Gg===!1&&(n=new Gg(n));let i=ev(t);var r;return!0===n.value?i+=tv(n.params):(i+="=",Array.isArray(n.value)?i+="(".concat((r=n).value.map(nv).join(" "),")").concat(tv(r.params)):i+=nv(n)),i}).join(",".concat(i))}function rv(e,t){return iv(e,t)}const sv="CMCD-Object",av="CMCD-Request",ov="CMCD-Session",lv="CMCD-Status",cv={br:sv,ab:sv,d:sv,ot:sv,tb:sv,tpb:sv,lb:sv,tab:sv,lab:sv,url:sv,pb:av,bl:av,tbl:av,dl:av,ltc:av,mtp:av,nor:av,nrr:av,rc:av,sn:av,sta:av,su:av,ttfb:av,ttfbb:av,ttlb:av,cmsdd:av,cmsds:av,smrt:av,df:av,cs:av,ts:av,cid:ov,pr:ov,sf:ov,sid:ov,st:ov,v:ov,msd:ov,bs:lv,bsd:lv,cdn:lv,rtp:lv,bg:lv,pt:lv,ec:lv,e:lv},uv=av;function dv(e,t){const n={};if(!e)return n;const i=Object.keys(e),r=t?(s=t,Object.keys(s).reduce((e,t)=>{var n;return null===(n=s[t])||void 0===n||n.forEach(n=>e[n]=t),e},{})):{};var s;return i.reduce((t,n)=>{var i;const s=cv[n]||r[n]||uv;return(null!==(i=t[s])&&void 0!==i?i:t[s]={})[n]=e[n],t},n)}const hv="event";const fv=e=>Math.round(e),pv=(e,t)=>Array.isArray(e)?e.map(e=>pv(e,t)):e instanceof Gg&&"string"===typeof e.value?new Gg(pv(e.value,t),e.params):(t.baseUrl&&(e=function(e,t){const n=new URL(e),i=new URL(t);if(n.origin!==i.origin)return e;const r=n.pathname.split("/").slice(1),s=i.pathname.split("/").slice(1,-1);for(;r[0]===s[0];)r.shift(),s.shift();for(;s.length;)s.shift(),r.unshift("..");return r.join("/")+n.search+n.hash}(e,t.baseUrl)),1===t.version?encodeURIComponent(e):e),mv=e=>100*fv(e/100),gv={br:fv,d:fv,bl:mv,dl:mv,mtp:mv,nor:(e,t)=>{let n=e;return t.version>=2&&(e instanceof Gg&&"string"===typeof e.value?n=new Gg([e]):"string"===typeof e&&(n=[e])),pv(n,t)},rtp:mv,tb:fv},vv="request",yv="response",_v=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],bv=["e"],xv=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Sv(e){return xv.test(e)}const Ev=["d","dl","nor","ot","rtp","su"];const wv=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];const Tv=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function Mv(e){return Tv.includes(e)||Sv(e)}const Av={[yv]:function(e){return _v.includes(e)||Ev.includes(e)||wv.includes(e)||Sv(e)},[hv]:function(e){return _v.includes(e)||bv.includes(e)||Sv(e)},[vv]:function(e){return _v.includes(e)||Ev.includes(e)||Sv(e)}};function Cv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={};if(null==e||"object"!==typeof e)return n;const i=t.version||e.v||1,r=t.reportingMode||vv,s=1===i?Mv:Av[r];let a=Object.keys(e).filter(s);const o=t.filter;"function"===typeof o&&(a=a.filter(o));const l=r===yv||r===hv;l&&!a.includes("ts")&&a.push("ts"),i>1&&!a.includes("v")&&a.push("v");const c=Hu({},gv,t.formatters),u={version:i,reportingMode:r,baseUrl:t.baseUrl};return a.sort().forEach(t=>{let r=e[t];const s=c[t];if("function"===typeof s&&(r=s(r,u)),"v"===t){if(1===i)return;r=i}"pr"==t&&1===r||(l&&"ts"===t&&!wu(r)&&(r=Date.now()),function(e){return"number"===typeof e?wu(e):null!=e&&""!==e&&!1!==e}(r)&&(function(e){return["ot","sf","st","e","sta"].includes(e)}(t)&&"string"===typeof r&&(r=new jg(r)),n[t]=r))}),n}function Rv(e,t,n){return Hu(e,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={};if(!e)return n;const i=dv(Cv(e,t),null===t||void 0===t?void 0:t.customHeaderMap);return Object.entries(i).reduce((e,t)=>{let[n,i]=t;const r=rv(i,{whitespace:!1});return r&&(e[n]=r),e},n)}(t,n))}function Lv(e){if(!e)return"";const t=function(e){return e?rv(Cv(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),{whitespace:!1}):""}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});return encodeURIComponent(t)}const Pv=/CMCD=[^&#]+/;function Iv(e,t,n){const i=function(e){if(!e)return"";const t=Lv(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});return"".concat("CMCD","=").concat(t)}(t,n);if(!i)return e;if(Pv.test(e))return e.replace(Pv,i);const r=e.includes("?")?"&":"?";return"".concat(e).concat(r).concat(i)}function Dv(e,t,n,i){e&&Object.keys(t).forEach(r=>{const s=e.filter(e=>e.groupId===r).map(e=>{const s=Hu({},e);return s.details=void 0,s.attrs=new Af(s.attrs),s.url=s.attrs.URI=kv(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),s.groupId=s.attrs["GROUP-ID"]=t[r],s.attrs["PATHWAY-ID"]=i,s});e.push(...s)})}function kv(e,t,n,i){const{HOST:r,PARAMS:s,[n]:a}=i;let o;t&&(o=null==a?void 0:a[t],o&&(e=o));const l=new self.URL(e);return r&&!o&&(l.host=r),s&&Object.keys(s).sort().forEach(e=>{e&&l.searchParams.set(e,s[e])}),l.href}class Ov extends Vu{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Ov.CDMCleanupPromise?[Ov.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=e=>{const{initDataType:t,initData:n}=e,i='"'.concat(e.type,'" event: init data type: "').concat(t,'"');if(this.debug(i),null!==n){if(!this.keyFormatPromise){let e=Object.keys(this.keySystemAccessPromises);e.length||(e=Kf(this.config));const t=e.map(Xf).filter(e=>!!e);this.keyFormatPromise=this.getKeyFormatPromise(t)}this.keyFormatPromise.then(r=>{const s=Yf(r);if("sinf"!==t||s!==zf.FAIRPLAY)return void this.log('Ignoring "'.concat(e.type,'" event with init data type: "').concat(t,'" for selected key-system ').concat(s));let a;try{const e=vd(new Uint8Array(n)),t=Pd(Nf(JSON.parse(e).sinf));if(!t)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");a=new Uint8Array(t.subarray(8,24))}catch(d){return void this.warn("".concat(i," Failed to parse sinf: ").concat(d))}const o=$u(a),{keyIdToKeySessionPromise:l,mediaKeySessions:c}=this;let u=l[o];for(let e=0;e<c.length;e++){const i=c[e],r=i.decryptdata;if(!r.keyId)continue;const s=$u(r.keyId);if(If(a,r.keyId)||-1!==r.uri.replace(/-/g,"").indexOf(o)){if(u=l[s],!u)continue;if(r.pssh)break;delete l[s],r.pssh=new Uint8Array(n),r.keyId=a,u=l[o]=u.then(()=>this.generateRequestWithPreferredKeySession(i,t,n,"encrypted-event-key-match")),u.catch(e=>this.handleError(e));break}}u||this.handleError(new Error("Key ID ".concat(o," not encountered in playlist. Key-system sessions ").concat(c.length,".")))}).catch(e=>this.handleError(e))}},this.onWaitingForKey=e=>{this.log('"'.concat(e.type,'" event'))},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Ru.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(Ru.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Ru.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(Ru.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Ru.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(Ru.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Ru.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(Ru.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=null==t?void 0:t[e];return i?i.licenseUrl:e===zf.WIDEVINE&&n?n:void 0}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(void 0===t)throw new Error('no license server URL configured for key-system "'.concat(e,'"'));return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=null==t?void 0:t[e];if(n)return n.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'.concat(e,'"]'))}attemptKeySystemAccess(e){const t=this.hls.levels,n=(e,t,n)=>!!e&&n.indexOf(e)===t,i=t.map(e=>e.audioCodec).filter(n),r=t.map(e=>e.videoCodec).filter(n);return i.length+r.length===0&&r.push("avc1.42e01e"),new Promise((t,n)=>{const s=e=>{const a=e.shift();this.getMediaKeysPromise(a,i,r).then(e=>t({keySystem:a,mediaKeys:e})).catch(t=>{e.length?s(e):n(t instanceof Bv?t:new Bv({type:Au.KEY_SYSTEM_ERROR,details:Cu.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))})};s(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if("function"!==typeof n){let e="Configured requestMediaKeySystemAccess is not a function ".concat(n);return null===qf&&"http:"===self.location.protocol&&(e="navigator.requestMediaKeySystemAccess is not available over insecure protocol ".concat(location.protocol)),Promise.reject(new Error(e))}return n(e,t)}getMediaKeysPromise(e,t,n){var i;const r=function(e,t,n,i){let r;switch(e){case zf.FAIRPLAY:r=["cenc","sinf"];break;case zf.WIDEVINE:case zf.PLAYREADY:r=["cenc"];break;case zf.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error("Unknown key-system: ".concat(e))}return function(e,t,n,i){return[{initDataTypes:e,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:t.map(e=>({contentType:"audio/mp4; codecs=".concat(e),robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:n.map(e=>({contentType:"video/mp4; codecs=".concat(e),robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}(r,t,n,i)}(e,t,n,this.config.drmSystemOptions||{});let s=this.keySystemAccessPromises[e],a=null==(i=s)?void 0:i.keySystemAccess;if(!a){this.log('Requesting encrypted media "'.concat(e,'" key-system access with config: ').concat(_h(r))),a=this.requestMediaKeySystemAccess(e,r);const t=s=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(t=>{this.log('Failed to obtain access to key-system "'.concat(e,'": ').concat(t))}),a.then(n=>{this.log('Access for key-system "'.concat(n.keySystem,'" obtained'));const i=this.fetchServerCertificate(e);this.log('Create media-keys for "'.concat(e,'"'));const r=t.mediaKeys=n.createMediaKeys().then(n=>(this.log('Media-keys created for "'.concat(e,'"')),t.hasMediaKeys=!0,i.then(t=>t?this.setMediaKeysServerCertificate(n,e,t):n)));return r.catch(t=>{this.error('Failed to create media-keys for "'.concat(e,'"}: ').concat(t))}),r})}return a.then(()=>s.mediaKeys)}createMediaKeySessionContext(e){let{decryptdata:t,keySystem:n,mediaKeys:i}=e;this.log('Creating key-system session "'.concat(n,'" keyId: ').concat($u(t.keyId||[])," keyUri: ").concat(t.uri));const r=i.createSession(),s={decryptdata:t,keySystem:n,mediaKeys:i,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=Nv(t),r="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,r,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,t){const n=e.mediaKeysSession;return this.log('Updating key-session "'.concat(n.sessionId,'" for keyId ').concat($u(e.decryptdata.keyId||[]),"\n      } (data length: ").concat(t.byteLength,")")),n.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(e=>{let{hasMediaKeys:t}=e;return!!t}).map(e=>{let{keySystem:t}=e;return Xf(t)}).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(e=>{let{keySystem:t,mediaKeys:n}=e;return this.attemptSetMediaKeys(t,n)})}selectKeySystem(e){return new Promise((t,n)=>{this.getKeySystemSelectionPromise(e).then(e=>{let{keySystem:i}=e;const r=Xf(i);r?t(r):n(new Error('Unable to find format for key-system "'.concat(i,'"')))}).catch(n)})}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: ".concat(e.sn," ").concat(e.type,": ").concat(e.level,") key formats ").concat(t.join(", "))),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=Kf(this.config),n=e.map(Yf).filter(e=>!!e&&-1!==t.indexOf(e));return this.selectKeySystem(n)}getKeyStatus(e){const{mediaKeySessions:t}=this;for(let n=0;n<t.length;n++){const i=Fv(e,t[n]);if(i)return i}}loadKey(e){const t=e.keyInfo.decryptdata,n=Nv(t),i=this.bannedKeyIds[n];if(i||"internal-error"===this.getKeyStatus(t)){const n=Uv(i||"internal-error",t);return this.handleError(n,e.frag),Promise.reject(n)}const r="(keyId: ".concat(n,' format: "').concat(t.keyFormat,'" method: ').concat(t.method," uri: ").concat(t.uri,")");this.log("Starting session for key ".concat(r));const s=this.keyIdToKeySessionPromise[n];if(!s){const i=this.getKeySystemForKeyPromise(t).then(n=>{let{keySystem:i,mediaKeys:s}=n;return this.throwIfDestroyed(),this.log("Handle encrypted media sn: ".concat(e.frag.sn," ").concat(e.frag.type,": ").concat(e.frag.level," using key ").concat(r)),this.attemptSetMediaKeys(i,s).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:i,mediaKeys:s,decryptdata:t})))}).then(e=>{const n=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(e,"cenc",n,"playlist-key")});return i.catch(t=>this.handleError(t,e.frag)),this.keyIdToKeySessionPromise[n]=i,i}return s.catch(n=>{if(n instanceof Bv){const i=Gu({},n.data);"internal-error"===this.getKeyStatus(t)&&(i.decryptdata=t);const r=new Bv(i,n.message);this.handleError(r,e.frag)}}),s}throwIfDestroyed(){if(!this.hls)throw new Error("invalid state")}handleError(e,t){if(this.hls)if(e instanceof Bv){t&&(e.data.frag=t);const n=e.data.decryptdata;this.error("".concat(e.message).concat(n?" (".concat($u(n.keyId||[]),")"):"")),this.hls.trigger(Ru.ERROR,e.data)}else this.error(e.message),this.hls.trigger(Ru.ERROR,{type:Au.KEY_SYSTEM_ERROR,details:Cu.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const t=Nv(e),n=this.keyIdToKeySessionPromise[t];if(!n){const t=Yf(e.keyFormat),n=t?[t]:Kf(this.config);return this.attemptKeySystemAccess(n)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=Kf(this.config)),0===e.length)throw new Bv({type:Au.KEY_SYSTEM_ERROR,details:Cu.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options ".concat(_h({drmSystems:this.config.drmSystems})));return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaResolved=void 0,this.mediaKeys===t)return Promise.resolve();const n=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'.concat(e,'"'));const i=Promise.all(n).then(()=>this.media?this.media.setMediaKeys(t):new Promise((e,n)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return n(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=t,this.media.setMediaKeys(t).then(e).catch(n)}}));return this.mediaKeys=t,this.setMediaKeysQueue.push(i),i.then(()=>{this.log('Media-keys set for "'.concat(e,'"')),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(e=>-1===n.indexOf(e))})}generateRequestWithPreferredKeySession(e,t,n,i){var r;const s=null==(r=this.config.drmSystems)||null==(r=r[e.keySystem])?void 0:r.generateRequest;if(s)try{const i=s.call(this.hls,t,n,e);if(!i)throw new Error("Invalid response from configured generateRequest filter");t=i.initDataType,n=i.initData?i.initData:null,e.decryptdata.pssh=n?new Uint8Array(n):null}catch(f){if(this.warn(f.message),this.hls&&this.hls.config.debug)throw f}if(null===n)return this.log('Skipping key-session request for "'.concat(i,'" (no initData)')),Promise.resolve(e);const a=Nv(e.decryptdata),o=e.decryptdata.uri;this.log('Generating key-session request for "'.concat(i,'" keyId: ').concat(a," URI: ").concat(o," (init data type: ").concat(t," length: ").concat(n.byteLength,")"));const l=new im,c=e._onmessage=t=>{const n=e.mediaKeysSession;if(!n)return void l.emit("error",new Error("invalid state"));const{messageType:i,message:r}=t;this.log('"'.concat(i,'" message event for session "').concat(n.sessionId,'" message size: ').concat(r.byteLength)),"license-request"===i||"license-renewal"===i?this.renewLicense(e,r).catch(e=>{l.eventNames().length?l.emit("error",e):this.handleError(e)}):"license-release"===i?e.keySystem===zf.FAIRPLAY&&this.updateKeySession(e,Ff("acknowledged")).then(()=>this.removeSession(e)).catch(e=>this.handleError(e)):this.warn('unhandled media key message type "'.concat(i,'"'))},u=(e,t)=>{let n;t.keyStatus=e,e.startsWith("usable")?l.emit("resolved"):"internal-error"===e||"output-restricted"===e||"output-downscaled"===e?n=Uv(e,t.decryptdata):"expired"===e?n=new Error("key expired (keyId: ".concat(a,")")):"released"===e?n=new Error("key released"):"status-pending"===e||this.warn('unhandled key status change "'.concat(e,'" (keyId: ').concat(a,")")),n&&(l.eventNames().length?l.emit("error",n):this.handleError(n))},d=e._onkeystatuseschange=t=>{if(!e.mediaKeysSession)return void l.emit("error",new Error("invalid state"));const n=this.getKeyStatuses(e);if(!Object.keys(n).some(e=>"status-pending"!==n[e]))return;if("expired"===n[a])return this.log("Expired key ".concat(_h(n),' in key-session "').concat(e.mediaKeysSession.sessionId,'"')),void this.renewKeySession(e);let i=n[a];if(i)u(i,e);else{var r;const t=1e3;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(r=e.keyStatusTimeouts)[a]||(r[a]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const n=this.getKeyStatus(e.decryptdata);if(n&&"status-pending"!==n)return this.log("No status for keyId ".concat(a,' in key-session "').concat(e.mediaKeysSession.sessionId,'". Using session key-status ').concat(n," from other session.")),u(n,e);this.log("key status for ".concat(a,' in key-session "').concat(e.mediaKeysSession.sessionId,'" timed out after ').concat(t,"ms")),i="internal-error",u(i,e)},t)),this.log("No status for keyId ".concat(a," (").concat(_h(n),")."))}};Np(e.mediaKeysSession,"message",c),Np(e.mediaKeysSession,"keystatuseschange",d);const h=new Promise((e,t)=>{l.on("error",t),l.on("resolved",e)});return e.mediaKeysSession.generateRequest(t,n).then(()=>{this.log('Request generated for key-session "'.concat(e.mediaKeysSession.sessionId,'" keyId: ').concat(a," URI: ").concat(o))}).catch(t=>{throw new Bv({type:Au.KEY_SYSTEM_ERROR,details:Cu.KEY_SYSTEM_NO_SESSION,error:t,decryptdata:e.decryptdata,fatal:!1},"Error generating key-session request: ".concat(t))}).then(()=>h).catch(t=>(l.removeAllListeners(),this.removeSession(e).then(()=>{throw t}))).then(()=>(l.removeAllListeners(),e))}getKeyStatuses(e){const t={};return e.mediaKeysSession.keyStatuses.forEach((n,i)=>{if("string"===typeof i&&"object"===typeof n){const e=i;i=n,n=e}const r="buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i);if(e.keySystem===zf.PLAYREADY&&16===r.length){const e=$u(r);t[e]=n,Bf(r)}const s=$u(r);"internal-error"===n&&(this.bannedKeyIds[s]=n),this.log('key status change "'.concat(n,'" for keyStatuses keyId: ').concat(s,' key-session "').concat(e.mediaKeysSession.sessionId,'"')),t[s]=n}),t}fetchServerCertificate(e){const t=this.config,n=new(0,t.loader)(t),i=this.getServerCertificateUrl(e);return i?(this.log('Fetching server certificate for "'.concat(e,'"')),new Promise((r,s)=>{const a={responseType:"arraybuffer",url:i},o=t.certLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(e,t,n,i)=>{r(e.data)},onError:(t,n,r,o)=>{s(new Bv({type:Au.KEY_SYSTEM_ERROR,details:Cu.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:Gu({url:a.url,data:void 0},t)},'"'.concat(e,'" certificate request failed (').concat(i,"). Status: ").concat(t.code," (").concat(t.text,")")))},onTimeout:(t,n,r)=>{s(new Bv({type:Au.KEY_SYSTEM_ERROR,details:Cu.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:{url:a.url,data:void 0}},'"'.concat(e,'" certificate request timed out (').concat(i,")")))},onAbort:(e,t,n)=>{s(new Error("aborted"))}};n.load(a,l,c)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((i,r)=>{e.setServerCertificate(n).then(r=>{this.log("setServerCertificate ".concat(r?"success":"not supported by CDM"," (").concat(n.byteLength,') on "').concat(t,'"')),i(e)}).catch(e=>{r(new Bv({type:Au.KEY_SYSTEM_ERROR,details:Cu.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(t=>this.updateKeySession(e,new Uint8Array(t)).catch(t=>{throw new Bv({type:Au.KEY_SYSTEM_ERROR,details:Cu.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:t,fatal:!1},t.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const i=(new DOMParser).parseFromString(n,"application/xml"),r=i.querySelectorAll("HttpHeader");if(r.length>0){let t;for(let n=0,i=r.length;n<i;n++){var s,a;t=r[n];const i=null==(s=t.querySelector("name"))?void 0:s.textContent,o=null==(a=t.querySelector("value"))?void 0:a.textContent;i&&o&&e.setRequestHeader(i,o)}}const o=i.querySelector("Challenge"),l=null==o?void 0:o.textContent;if(!l)throw new Error("Cannot find <Challenge> in key message");return Ff(atob(l))}setupLicenseXHR(e,t,n,i){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return r.call(this.hls,e,t,n,i)}).catch(s=>{if(!n.decryptdata)throw s;return e.open("POST",t,!0),r.call(this.hls,e,t,n,i)}).then(n=>{e.readyState||e.open("POST",t,!0);return{xhr:e,licenseChallenge:n||i}}):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((i,r)=>{const s=this.getLicenseServerUrlOrThrow(e.keySystem);this.log("Sending license request to URL: ".concat(s));const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(4===a.readyState)if(200===a.status){this._requestLicenseFailureCount=0;let t=a.response;this.log("License received ".concat(t instanceof ArrayBuffer?t.byteLength:t));const n=this.config.licenseResponseCallback;if(n)try{t=n.call(this.hls,a,s,e)}catch(o){this.error(o)}i(t)}else{const o=n.errorRetry,l=o?o.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||a.status>=400&&a.status<500)r(new Bv({type:Au.KEY_SYSTEM_ERROR,details:Cu.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:a,response:{url:s,data:void 0,code:a.status,text:a.statusText}},"License Request XHR failed (".concat(s,"). Status: ").concat(a.status," (").concat(a.statusText,")")));else{const n=l-this._requestLicenseFailureCount+1;this.warn("Retrying license request, ".concat(n," attempts left")),this.requestLicense(e,t).then(i,r)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,s,e,t).then(t=>{let{xhr:n,licenseChallenge:i}=t;e.keySystem==zf.PLAYREADY&&(i=this.unpackPlayReadyKeyMessage(n,i)),n.send(i)}).catch(r)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,Np(n,"encrypted",this.onMediaEncrypted),Np(n,"waitingforkey",this.onWaitingForKey);const i=this.mediaResolved;i?i():this.mediaKeys=n.mediaKeys}onMediaDetached(){const e=this.media;e&&(Fp(e,"encrypted",this.onMediaEncrypted),Fp(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const t=this.mediaResolved;if(t&&t(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const n=this.media,i=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,$f.clearKeyUriToKeyIdMap();const r=i.length;Ov.CDMCleanupPromise=Promise.all(i.map(e=>this.removeSession(e)).concat((null==n||null==(e=n.setMediaKeys(null))?void 0:e.catch(e=>{this.log("Could not clear media keys: ".concat(e)),this.hls&&this.hls.trigger(Ru.ERROR,{type:Au.OTHER_ERROR,details:Cu.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error("Could not clear media keys: ".concat(e))})}))||Promise.resolve())).catch(e=>{this.log("Could not close sessions and clear media keys: ".concat(e)),this.hls&&this.hls.trigger(Ru.ERROR,{type:Au.OTHER_ERROR,details:Cu.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error("Could not close sessions and clear media keys: ".concat(e))})}).then(()=>{r&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(e,t){let{sessionKeys:n}=t;if(n&&this.config.emeEnabled&&!this.keyFormatPromise){const e=n.reduce((e,t)=>(-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e),[]);this.log("Selecting key-system from session-keys ".concat(e.join(", "))),this.keyFormatPromise=this.getKeyFormatPromise(e)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n,decryptdata:i}=e;if(t){this.log('Remove licenses and keys and close session "'.concat(t.sessionId,'" keyId: ').concat($u((null==i?void 0:i.keyId)||[]))),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const r=this.mediaKeySessions.indexOf(e);r>-1&&this.mediaKeySessions.splice(r,1);const{keyStatusTimeouts:s}=e;s&&Object.keys(s).forEach(e=>self.clearTimeout(s[e]));const{drmSystemOptions:a}=this.config,o=function(e){var t;return!!e&&("persistent-license"===e.sessionType||!(null==(t=e.sessionTypes)||!t.some(e=>"persistent-license"===e)))}(a)?new Promise((e,n)=>{self.setTimeout(()=>n(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(e).catch(n)}):Promise.resolve();return o.catch(e=>{this.log("Could not remove session: ".concat(e)),this.hls&&this.hls.trigger(Ru.ERROR,{type:Au.OTHER_ERROR,details:Cu.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error("Could not remove session: ".concat(e))})}).then(()=>t.close()).catch(e=>{this.log("Could not close session: ".concat(e)),this.hls&&this.hls.trigger(Ru.ERROR,{type:Au.OTHER_ERROR,details:Cu.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error("Could not close session: ".concat(e))})})}return Promise.resolve()}}function Nv(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return $u(e.keyId)}function Fv(e,t){return e.keyId&&t.mediaKeysSession.keyStatuses.has(e.keyId)?t.mediaKeysSession.keyStatuses.get(e.keyId):e.matches(t.decryptdata)?t.keyStatus:void 0}Ov.CDMCleanupPromise=void 0;class Bv extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}function Uv(e,t){const n="output-restricted"===e,i=n?Cu.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:Cu.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new Bv({type:Au.KEY_SYSTEM_ERROR,details:i,fatal:!1,decryptdata:t},n?"HDCP level output restricted":'key status changed to "'.concat(e,'"'))}function Hv(e,t){let n;try{n=new Event("addtrack")}catch(One){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)}function zv(e,t){const n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error("addCue is failed for: ".concat(t))}catch(One){qu.debug("[texttrack-utils]: ".concat(One));try{const n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}catch(i){qu.debug("[texttrack-utils]: Legacy TextTrackCue fallback failed: ".concat(i))}}"disabled"===n&&(e.mode=n)}function Gv(e,t){const n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues)for(let i=e.cues.length;i--;)t&&e.cues[i].removeEventListener("enter",t),e.removeCue(e.cues[i]);"disabled"===n&&(e.mode=n)}function Vv(e,t,n,i){const r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&e.cues.length>0){const r=function(e,t,n){const i=[],r=function(e,t){if(t<=e[0].startTime)return 0;const n=e.length-1;if(t>e[n].endTime)return-1;let i,r=0,s=n;for(;r<=s;)if(i=Math.floor((s+r)/2),t<e[i].startTime)s=i-1;else{if(!(t>e[i].startTime&&r<n))return i;r=i+1}return e[r].startTime-t<t-e[s].startTime?r:s}(e,t);if(r>-1)for(let s=r,a=e.length;s<a;s++){const r=e[s];if(r.startTime>=t&&r.endTime<=n)i.push(r);else if(r.startTime>n)return i}return i}(e.cues,t,n);for(let t=0;t<r.length;t++)i&&!i(r[t])||e.removeCue(r[t])}"disabled"===r&&(e.mode=r)}function Wv(e){const t=[];for(let n=0;n<e.length;n++){const i=e[n];"subtitles"!==i.kind&&"captions"!==i.kind||!i.label||t.push(e[n])}return t}function jv(e){let t=5381,n=e.length;for(;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()}const Yv=.025;let Xv=function(e){return e[e.Point=0]="Point",e[e.Range=1]="Range",e}({});function Kv(e,t,n){return"".concat(e.identifier,"-").concat(n+1,"-").concat(jv(t))}class qv{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,null==(e=this.assetListLoader)||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const n=this.playoutLimit;if(e<=0||isNaN(n))return!1;if(0===n)return!0;return((null==(t=this.assetList[e])?void 0:t.startOffset)||0)>n}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return Jv(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(0===this.startTime||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime;return t-Jv(t,e)<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=wu(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return Jv(e,t)}return e}get appendInPlace(){return!!this.appendInPlaceStarted||!this.appendInPlaceDisabled&&!(this.cue.once||this.cue.pre||!this.startIsAligned||!(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Yv))}set appendInPlace(e){this.appendInPlaceStarted?this.resetOnResume=!e:this.appendInPlaceDisabled=!e}get timelineStart(){return null!==this._timelineStart?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return t=null!==this._duration?this._duration:this.dateRange.duration?this.dateRange.duration:this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return"RANGE"===this.dateRange.attr["X-TIMELINE-OCCUPIES"]?Xv.Range:Xv.Point}get supplementsPrimary(){return"PRIMARY"===this.dateRange.attr["X-TIMELINE-STYLE"]}get contentMayVary(){return"NO"!==this.dateRange.attr["X-CONTENT-MAY-VARY"]}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||null!==this.assetListResponse}toString(){return'["'.concat((e=this).identifier,'" ').concat(e.cue.pre?"<pre>":e.cue.post?"<post>":"").concat(e.timelineStart.toFixed(2),"-").concat(e.resumeTime.toFixed(2),"]");var e}}function Jv(e,t){return e-t.start<t.duration/2&&!(Math.abs(e-(t.start+t.duration))<Yv)?t.start:t.start+t.duration}function Qv(e,t,n){const i=new self.URL(e,n);return"data:"!==i.protocol&&i.searchParams.set("_HLS_primary_id",t),i}function Zv(e,t){for(;null!=(n=e.assetList[++t])&&n.error;)var n;return t}function $v(e){const t=e.timelineStart,n=e.duration||0;return'["'.concat(e.identifier,'" ').concat(t.toFixed(2),"-").concat((t+n).toFixed(2),"]")}class ey{constructor(e,t,n,i){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(Ru.PLAYOUT_LIMIT_REACHED,{})};const r=this.hls=new e(t);this.interstitial=n,this.assetItem=i;const s=()=>{this.hasDetails=!0};r.once(Ru.LEVEL_LOADED,s),r.once(Ru.AUDIO_TRACK_LOADED,s),r.once(Ru.SUBTITLE_TRACK_LOADED,s),r.on(Ru.MEDIA_ATTACHING,(e,t)=>{let{media:n}=t;this.removeMediaListeners(),this.mediaAttached=n;this.interstitial.playoutLimit&&(n.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&r.on(Ru.BUFFER_APPENDED,()=>{const e=this.bufferedEnd;this.reachedPlayout(e)&&(this._bufferedEosTime=e,r.trigger(Ru.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let n=this.assetItem.uri;try{n=Qv(n,e.config.primarySessionId||"").href}catch(t){}e.loadSource(n)}}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if(null!=(t=this.hls)&&t.bufferedToEnd)return!0;if(!e)return!1;const n=Math.min(this._bufferedEosTime||1/0,this.duration),i=this.timelineOffset,r=_f.bufferInfo(e,i,0);return this.getAssetTime(r.end)>=n-.02}reachedPlayout(e){const t=this.interstitial.playoutLimit;return this.startOffset+e>=t}get destroyed(){var e;return!(null!=(e=this.hls)&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return(null==(e=this.hls)?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=_f.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const t=this.interstitial.playoutLimit;if(t){const n=t-this.startOffset;if(n>0&&n<e)return n}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return(null==(e=this.hls)?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const n=e-t;if(Math.abs(n)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,n=this.duration;return Math.min(Math.max(0,e-t),n)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){var e;this.mediaAttached&&(null!=(e=this.hls)&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd))}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var t;this.loadSource(),null==(t=this.hls)||t.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,null==(e=this.hls)||e.detachMedia()}resumeBuffering(){var e;null==(e=this.hls)||e.resumeBuffering()}pauseBuffering(){var e;null==(e=this.hls)||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),(null==(e=this.hls)?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const t=e=>delete e.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,n){var i;null==(i=this.hls)||i.on(e,t)}once(e,t,n){var i;null==(i=this.hls)||i.once(e,t)}off(e,t,n){var i;null==(i=this.hls)||i.off(e,t)}toString(){var e;return"HlsAssetPlayer: ".concat($v(this.assetItem)," ").concat(null==(e=this.hls)?void 0:e.sessionId," ").concat(this.appendInPlace?"append-in-place":"")}}class ty extends Vu{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((n,i)=>e<=i.startOffset&&t>i.startOffset?(delete i.error,n+1):n,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let n=-1;e.nextEvent?n=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(n=this.findEventIndex(e.previousEvent.identifier)+1);const i=this.items;if(i)for(i[n]||(void 0===t&&(t=e.start),n=this.findItemIndexAtTime(t));n>=0&&null!=(r=i[n])&&r.event;){var r;n--}return n}findItemIndexAtTime(e,t){const n=this.items;if(n)for(let i=0;i<n.length;i++){let r=n[i];if(t&&"primary"!==t&&(r=r[t]),e===r.start||e>r.start&&e<r.end)return i}return-1}findJumpRestrictedIndex(e,t){const n=this.items;if(n)for(let i=e;i<=t&&n[i];i++){const e=n[i].event;if(null!=e&&e.restrictions.jump&&!e.appendInPlace)return i}return-1}findEventIndex(e){const t=this.items;if(t)for(let i=t.length;i--;){var n;if((null==(n=t[i].event)?void 0:n.identifier)===e)return i}return-1}findAssetIndex(e,t){const n=e.assetList,i=n.length;if(i>1)for(let r=0;r<i;r++){const e=n[r];if(!e.error){const n=e.timelineStart;if(t===n||t>n&&(t<n+(e.duration||0)||r===i-1))return r}}return 0}get assetIdAtEnd(){var e;const t=null==(e=this.items)||null==(e=e[this.length-1])?void 0:e.event;if(t){const e=t.assetList,n=e[e.length-1];if(n)return n.identifier}return null}parseInterstitialDateRanges(e,t){const n=e.main.details,{dateRanges:i}=n,r=this.events,s=this.parseDateRanges(i,{url:n.url},t),a=Object.keys(i),o=r?r.filter(e=>!a.includes(e.identifier)):[];s.length&&s.sort((e,t)=>{const n=e.cue.pre,i=e.cue.post,r=t.cue.pre,s=t.cue.post;if(n&&!r)return-1;if(r&&!n)return 1;if(i&&!s)return 1;if(s&&!i)return-1;if(!n&&!r&&!i&&!s){const n=e.startTime,i=t.startTime;if(n!==i)return n-i}return e.dateRange.tagOrder-t.dateRange.tagOrder}),this.events=s,o.forEach(e=>{this.removeEvent(e)}),this.updateSchedule(e,o)}updateSchedule(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.events||[];if(i.length||t.length||this.length<2){const r=this.items,s=this.parseSchedule(i,e),a=n||t.length||(null==r?void 0:r.length)!==s.length||s.some((e,t)=>Math.abs(e.playout.start-r[t].playout.start)>.005||Math.abs(e.playout.end-r[t].playout.end)>.005);a&&(this.items=s,this.onScheduleUpdate(t,r))}}parseDateRanges(e,t,n){const i=[],r=Object.keys(e);for(let s=0;s<r.length;s++){const a=r[s],o=e[a];if(o.isInterstitial){let e=this.eventMap[a];e?e.setDateRange(o):(e=new qv(o,t),this.eventMap[a]=e,!1===n&&(e.appendInPlace=n)),i.push(e)}}return i}parseSchedule(e,t){const n=[],i=t.main.details,r=i.live?1/0:i.edge;let s=0;if((e=e.filter(e=>!e.error&&!(e.cue.once&&e.hasPlayed))).length){this.resolveOffsets(e,t);let i=0,o=0;if(e.forEach((t,a)=>{const l=t.cue.pre,c=t.cue.post,u=e[a-1]||null,d=t.appendInPlace,h=c?r:t.startOffset,f=t.duration,p=t.timelineOccupancy===Xv.Range?f:0,m=t.resumptionOffset,g=(null==u?void 0:u.startTime)===h,v=h+t.cumulativeDuration;let y=d?v+f:h+m;if(l||!c&&h<=0){const e=o;o+=p,t.timelineStart=v;const i=s;s+=f,n.push({event:t,start:v,end:y,playout:{start:i,end:s},integrated:{start:e,end:o}})}else{if(!(h<=r))return;{if(!g){const r=h-i;if(r>.033){const l=i,c=o;o+=r;const u=s;s+=r;const d={previousEvent:e[a-1]||null,nextEvent:t,start:l,end:l+r,playout:{start:u,end:s},integrated:{start:c,end:o}};n.push(d)}else r>0&&u&&(u.cumulativeDuration+=r,n[n.length-1].end=h)}c&&(y=v),t.timelineStart=v;const r=o;o+=p;const l=s;s+=f,n.push({event:t,start:v,end:y,playout:{start:l,end:s},integrated:{start:r,end:o}})}}const _=t.resumeTime;i=c||_>r?r:_}),i<r){var a;const e=i,t=o,l=r-i;o+=l;const c=s;s+=l,n.push({previousEvent:(null==(a=n[n.length-1])?void 0:a.event)||null,nextEvent:null,start:i,end:e+l,playout:{start:c,end:s},integrated:{start:t,end:o}})}this.setDurations(r,s,o)}else{const e=0;n.push({previousEvent:null,nextEvent:null,start:e,end:r,playout:{start:e,end:r},integrated:{start:e,end:r}}),this.setDurations(r,r,r)}return n}setDurations(e,t,n){this.durations={primary:e,playout:t,integrated:n}}resolveOffsets(e,t){const n=t.main.details,i=n.live?1/0:n.edge;let r=0,s=-1;e.forEach((a,o)=>{const l=a.cue.pre,c=a.cue.post,u=l?0:c?i:a.startTime;this.updateAssetDurations(a);if(s===u?a.cumulativeDuration=r:(r=0,s=u),!c&&a.snapOptions.in&&(a.resumeAnchor=Rh(null,n.fragments,a.startOffset+a.resumptionOffset,0,0)||void 0),a.appendInPlace&&!a.appendInPlaceStarted){this.primaryCanResumeInPlaceAt(a,t)||(a.appendInPlace=!1)}if(!a.appendInPlace&&o+1<e.length){e[o+1].startTime-e[o].resumeTime<.033&&(e[o+1].appendInPlace=!1,e[o+1].appendInPlace&&this.warn("Could not change append strategy for abutting event ".concat(a)))}const d=wu(a.resumeOffset)?a.resumeOffset:a.duration;r+=d})}primaryCanResumeInPlaceAt(e,t){const n=e.resumeTime,i=e.startTime+e.resumptionOffset;if(Math.abs(n-i)>Yv)return this.log('"'.concat(e.identifier,'" resumption ').concat(n," not aligned with estimated timeline end ").concat(i)),!1;return!Object.keys(t).some(i=>{const r=t[i].details,s=r.edge;if(n>=s)return this.log('"'.concat(e.identifier,'" resumption ').concat(n," past ").concat(i," playlist end ").concat(s)),!1;const a=Rh(null,r.fragments,n);if(!a)return this.log('"'.concat(e.identifier,'" resumption ').concat(n," does not align with any fragments in ").concat(i," playlist (").concat(r.fragStart,"-").concat(r.fragmentEnd,")")),!0;const o="audio"===i?.175:0;return!(Math.abs(a.start-n)<Yv+o||Math.abs(a.end-n)<Yv+o)&&(this.log('"'.concat(e.identifier,'" resumption ').concat(n," not aligned with ").concat(i," fragment bounds (").concat(a.start,"-").concat(a.end," sn: ").concat(a.sn," cc: ").concat(a.cc,")")),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let n=0,i=!1,r=!1;for(let s=0;s<e.assetList.length;s++){const a=e.assetList[s],o=t+n;a.startOffset=n,a.timelineStart=o,i||(i=null===a.duration),r||(r=!!a.error);n+=a.error?0:a.duration||0}e.duration=i&&!r?Math.max(n,e.duration):n}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function ny(e){return"[".concat(e.event?'"'+e.event.identifier+'"':"primary",": ").concat(e.start.toFixed(2),"-").concat(e.end.toFixed(2),"]")}class iy{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const n=e.assetListUrl;let i;try{i=Qv(n,this.hls.sessionId,e.baseUrl)}catch(u){const t=this.assignAssetListError(e,Cu.ASSET_LIST_LOAD_ERROR,u,n);return void this.hls.trigger(Ru.ERROR,t)}t&&"data:"!==i.protocol&&i.searchParams.set("_HLS_start_offset",""+t);const r=this.hls.config,s=new(0,r.loader)(r),a={responseType:"json",url:i.href},o=r.interstitialAssetListLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(t,n,i,r)=>{const s=t.data,a=null==s?void 0:s.ASSETS;if(!Array.isArray(a)){const t=this.assignAssetListError(e,Cu.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),i.url,n,r);return void this.hls.trigger(Ru.ERROR,t)}e.assetListResponse=s,this.hls.trigger(Ru.ASSET_LIST_LOADED,{event:e,assetListResponse:s,networkDetails:r})},onError:(t,n,i,r)=>{const s=this.assignAssetListError(e,Cu.ASSET_LIST_LOAD_ERROR,new Error("Error loading X-ASSET-LIST: HTTP status ".concat(t.code," ").concat(t.text," (").concat(n.url,")")),n.url,r,i);this.hls.trigger(Ru.ERROR,s)},onTimeout:(t,n,i)=>{const r=this.assignAssetListError(e,Cu.ASSET_LIST_LOAD_TIMEOUT,new Error("Timeout loading X-ASSET-LIST (".concat(n.url,")")),n.url,t,i);this.hls.trigger(Ru.ERROR,r)}};return s.load(a,l,c),this.hls.trigger(Ru.ASSET_LIST_LOADING,{event:e}),s}assignAssetListError(e,t,n,i,r,s){return e.error=n,{type:Au.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:i,error:n,networkDetails:s,stats:r}}}function ry(e){var t;null==e||null==(t=e.play())||t.catch(()=>{})}function sy(e,t){return"[".concat(e,"] Advancing timeline position to ").concat(t)}class ay{constructor(e){this.buffered=void 0;const t=(t,n,i)=>{if((n>>>=0)>i-1)throw new DOMException("Failed to execute '".concat(t,"' on 'TimeRanges': The index provided (").concat(n,") is greater than the maximum bound (").concat(i,")"));return e[n][t]};this.buffered={get length(){return e.length},end:n=>t("end",n,e.length),start:n=>t("start",n,e.length)}}}const oy={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},ly=e=>String.fromCharCode(oy[e]||e),cy=15,uy=100,dy={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},hy={17:2,18:4,21:6,22:8,23:10,19:13,20:15},fy={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},py={25:2,26:4,29:6,30:8,31:10,27:13,28:15},my=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class gy{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n="function"===typeof t?t():t;qu.log("".concat(this.time," [").concat(e,"] ").concat(n))}}}const vy=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class yy{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class _y{constructor(){this.uchar=" ",this.penState=new yy}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class by{constructor(e){this.chars=[],this.pos=0,this.currPenState=new yy,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<uy;t++)this.chars.push(new _y);this.logger=e}equals(e){for(let t=0;t<uy;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<uy;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<uy;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>uy&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=uy)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=ly(e);this.pos>=uy?this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}clearFromPos(e){let t;for(t=e;t<uy;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<uy;n++){const i=this.chars[n].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e);this.chars[this.pos].setPenState(this.currPenState)}}class xy{constructor(e){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<cy;t++)this.rows.push(new by(e));this.logger=e}reset(){for(let e=0;e<cy;e++)this.rows[e].clear();this.currRow=14}equals(e){let t=!0;for(let n=0;n<cy;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<cy;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<cy;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e);this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+_h(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let t=0;t<cy;t++)this.rows[t].clear();const e=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){const i=n.rows[e].cueStartTime,r=this.logger.time;if(null!==i&&null!==r&&i<r)for(let s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(n.rows[e+s])}}this.currRow=t;const n=this.rows[this.currRow];if(null!==e.indent){const t=e.indent,i=Math.max(t-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+_h(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let r=0;r<cy;r++){const n=this.rows[r].getTextString();n&&(i=r+1,e?t.push("Row "+i+": '"+n+"'"):t.push(n.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n}getTextAndFormat(){return this.rows}}class Sy{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new xy(n),this.nonDisplayedMemory=new xy(n),this.lastOutputScreen=new xy(n),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+_h(t)),this.writeScreen.setPen(t)}outputDataUpdate(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Ey{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;const i=this.logger=new gy;this.channels=[null,new Sy(e,t,i),new Sy(e+1,n,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const e=127&t[n],i=127&t[n+1];let r=!1,s=null;if(0===e&&0===i)continue;this.logger.log(3,()=>"["+vy([t[n],t[n+1]])+"] -> ("+vy([e,i])+")");const a=this.cmdHistory;if(e>=16&&e<=31){if(Ty(e,i,a)){wy(null,null,a),this.logger.log(3,()=>"Repeated command ("+vy([e,i])+") is dropped");continue}wy(e,i,this.cmdHistory),r=this.parseCmd(e,i),r||(r=this.parseMidrow(e,i)),r||(r=this.parsePAC(e,i)),r||(r=this.parseBackgroundAttributes(e,i))}else wy(null,null,a);if(!r&&(s=this.parseChars(e,i),s)){const e=this.currentChannel;if(e&&e>0){this.channels[e].insertChars(s)}else this.logger.log(2,"No channel found yet. TEXT-MODE?")}r||s||this.logger.log(2,()=>"Couldn't parse cleaned data "+vy([e,i])+" orig: "+vy([t[n],t[n+1]]))}}parseCmd(e,t){if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=33&&t<=35))return!1;const n=20===e||21===e||23===e?1:2,i=this.channels[n];return 20===e||21===e||28===e||29===e?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),this.currentChannel=n,!0}parseMidrow(e,t){let n=0;if((17===e||25===e)&&t>=32&&t<=47){if(n=17===e?1:2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return!!i&&(i.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+vy([e,t])+")"),!0)}return!1}parsePAC(e,t){let n;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127)&&!((16===e||24===e)&&t>=64&&t<=95))return!1;const i=e<=23?1:2;n=t>=64&&t<=95?1===i?dy[e]:fy[e]:1===i?hy[e]:py[e];const r=this.channels[i];return!!r&&(r.setPAC(this.interpretPAC(n,t)),this.currentChannel=i,!0)}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,i.underline=1===(1&n),n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((n-16)/2),i}parseChars(e,t){let n,i=null,r=null;if(e>=25?(n=2,r=e-8):(n=1,r=e),r>=17&&r<=19){let e;e=17===r?t+80:18===r?t+112:t+144,this.logger.log(2,()=>"Special char '"+ly(e)+"' in channel "+n),i=[e]}else e>=32&&e<=127&&(i=0===t?[e]:[e,t]);return i&&this.logger.log(3,()=>"Char codes =  "+vy(i).join(",")),i}parseBackgroundAttributes(e,t){if(!((16===e||24===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=45&&t<=47))return!1;let n;const i={};16===e||24===e?(n=Math.floor((t-32)/2),i.background=my[n],t%2===1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0));const r=e<=23?1:2;return this.channels[r].setBkgData(i),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}wy(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function wy(e,t,n){n.a=e,n.b=t}function Ty(e,t,n){return n.a===e&&n.b===t}var My=function(){if(null!=Hf&&Hf.VTTCue)return self.VTTCue;const e=["","lr","rl"],t=["start","middle","end","left","right"];function n(e,t){if("string"!==typeof t)return!1;if(!Array.isArray(e))return!1;const n=t.toLowerCase();return!!~e.indexOf(n)&&n}function i(e){return n(t,e)}function r(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];let r=1;for(;r<arguments.length;r++){const t=arguments[r];for(const n in t)e[n]=t[n]}return e}function s(t,s,a){const o=this,l={enumerable:!0};o.hasBeenReset=!1;let c="",u=!1,d=t,h=s,f=a,p=null,m="",g=!0,v="auto",y="start",_=50,b="middle",x=50,S="middle";Object.defineProperty(o,"id",r({},l,{get:function(){return c},set:function(e){c=""+e}})),Object.defineProperty(o,"pauseOnExit",r({},l,{get:function(){return u},set:function(e){u=!!e}})),Object.defineProperty(o,"startTime",r({},l,{get:function(){return d},set:function(e){if("number"!==typeof e)throw new TypeError("Start time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",r({},l,{get:function(){return h},set:function(e){if("number"!==typeof e)throw new TypeError("End time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",r({},l,{get:function(){return f},set:function(e){f=""+e,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",r({},l,{get:function(){return p},set:function(e){p=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",r({},l,{get:function(){return m},set:function(t){const i=function(t){return n(e,t)}(t);if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");m=i,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",r({},l,{get:function(){return g},set:function(e){g=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",r({},l,{get:function(){return v},set:function(e){if("number"!==typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",r({},l,{get:function(){return y},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",r({},l,{get:function(){return _},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");_=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",r({},l,{get:function(){return b},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",r({},l,{get:function(){return x},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");x=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",r({},l,{get:function(){return S},set:function(e){const t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");S=t,this.hasBeenReset=!0}})),o.displayState=void 0}return s.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},s}();class Ay{decode(e,t){if(!e)return"";if("string"!==typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function Cy(e){function t(e,t,n,i){return 3600*(0|e)+60*(0|t)+(0|n)+parseFloat(i||0)}const n=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}class Ry{constructor(){this.values=Object.create(null)}set(e,t){this.get(e)||""===t||(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function Ly(e,t,n,i){const r=i?e.split(i):[e];for(const s in r){if("string"!==typeof r[s])continue;const e=r[s].split(n);if(2!==e.length)continue;t(e[0],e[1])}}const Py=new My(0,0,""),Iy="middle"===Py.align?"middle":"center";function Dy(e,t,n){const i=e;function r(){const t=Cy(e);if(null===t)throw new Error("Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function s(){e=e.replace(/^\s+/,"")}if(s(),t.startTime=r(),s(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.slice(3),s(),t.endTime=r(),s(),function(e,t){const i=new Ry;Ly(e,function(e,t){let r;switch(e){case"region":for(let r=n.length-1;r>=0;r--)if(n[r].id===t){i.set(e,n[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":r=t.split(","),i.integer(e,r[0]),i.percent(e,r[0])&&i.set("snapToLines",!1),i.alt(e,r[0],["auto"]),2===r.length&&i.alt("lineAlign",r[1],["start",Iy,"end"]);break;case"position":r=t.split(","),i.percent(e,r[0]),2===r.length&&i.alt("positionAlign",r[1],["start",Iy,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",Iy,"end","left","right"])}},/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");let r=i.get("line","auto");"auto"===r&&-1===Py.line&&(r=-1),t.line=r,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",Iy);let s=i.get("position","auto");"auto"===s&&50===Py.position&&(s="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=s}(e,t)}function ky(e){return e.replace(/<br(?: \/)?>/gi,"\n")}class Oy{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Ay,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;function n(){let e=t.buffer,n=0;for(e=ky(e);n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;const i=e.slice(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.slice(n),i}function i(e){Ly(e,function(e,t){},/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let e="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;e=n();const i=e.match(/^(\xef\xbb\xbf)?WEBVTT([ \t].*)?$/);if(null==i||!i[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let r=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(r?r=!1:e=n(),t.state){case"HEADER":/:/.test(e)?i(e):e||(t.state="ID");continue;case"NOTE":e||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){t.state="NOTE";break}if(!e)continue;if(t.cue=new My(0,0,""),t.state="CUE",-1===e.indexOf("--\x3e")){t.cue.id=e;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{Dy(e,t.cue,t.regionList)}catch(kne){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const n=-1!==e.indexOf("--\x3e");if(!e||n&&(r=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=e}continue;case"BADCUE":e||(t.state="ID")}}}catch(kne){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(kne){e.onparsingerror&&e.onparsingerror(kne)}return e.onflush&&e.onflush(),this}}const Ny=/\r\n|\n\r|\n|\r/g,Fy=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.slice(n,n+t.length)===t};function By(e,t,n){return jv(e.toString())+jv(t.toString())+jv(n)}function Uy(e,t,n,i,r,s,a){const o=new Oy,l=Zu(new Uint8Array(e)).trim().replace(Ny,"\n").split("\n"),c=[],u=t?function(e){return lg(e,9e4,1/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1))}(t.baseTime,t.timescale):0;let d,h="00:00.000",f=0,p=0,m=!0;o.oncue=function(e){const s=n[i];let a=n.ccOffset;const o=(f-u)/9e4;if(null!=s&&s.new&&(void 0!==p?a=n.ccOffset=s.start:function(e,t,n){let i=e[t],r=e[i.prevCC];if(!r||!r.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,void(i.new=!1);for(;null!=(s=r)&&s.new;){var s;e.ccOffset+=i.start-r.start,i.new=!1,i=r,r=e[i.prevCC]}e.presentationOffset=n}(n,i,o)),o){if(!t)return void(d=new Error("Missing initPTS for VTT MPEGTS"));a=o-n.presentationOffset}const l=e.endTime-e.startTime,h=gg(9e4*(e.startTime+a-p),9e4*r)/9e4;e.startTime=Math.max(h,0),e.endTime=Math.max(h+l,0);const m=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(m)),e.id||(e.id=By(e.startTime,e.endTime,m)),e.endTime>0&&c.push(e)},o.onparsingerror=function(e){d=e},o.onflush=function(){d?a(d):s(c)},l.forEach(e=>{if(m){if(Fy(e,"X-TIMESTAMP-MAP=")){m=!1,e.slice(16).split(",").forEach(e=>{Fy(e,"LOCAL:")?h=e.slice(6):Fy(e,"MPEGTS:")&&(f=parseInt(e.slice(7)))});try{p=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),r=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!wu(t)||!wu(n)||!wu(i)||!wu(r))throw Error("Malformed X-TIMESTAMP-MAP: Local:".concat(e));return t+=1e3*n,t+=6e4*i,t+=36e5*r,t}(h)/1e3}catch(t){d=t}return}""===e&&(m=!1)}o.parse(e+"\n")}),o.flush()}const Hy="stpp.ttml.im1t",zy=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Gy=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Vy={left:"start",center:"center",right:"end",start:"start",end:"end"};function Wy(e,t,n,i){const r=Sd(new Uint8Array(e),["mdat"]);if(0===r.length)return void i(new Error("Could not parse IMSC1 mdat"));const s=r.map(e=>Zu(e)),a=function(e,t){return lg(e,t,1/(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1),arguments.length>3&&void 0!==arguments[3]&&arguments[3])}(t.baseTime,1,t.timescale);try{s.forEach(e=>n(function(e,t){const n=(new DOMParser).parseFromString(e,"text/xml"),i=n.getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},s=Object.keys(r).reduce((e,t)=>(e[t]=i.getAttribute("ttp:".concat(t))||r[t],e),{}),a="preserve"!==i.getAttribute("xml:space"),o=Yy(jy(i,"styling","style")),l=Yy(jy(i,"layout","region")),c=jy(i,"body","[begin]");return[].map.call(c,e=>{const n=Xy(e,a);if(!n||!e.hasAttribute("begin"))return null;const i=Jy(e.getAttribute("begin"),s),r=Jy(e.getAttribute("dur"),s);let c=Jy(e.getAttribute("end"),s);if(null===i)throw qy(e);if(null===c){if(null===r)throw qy(e);c=i+r}const u=new My(i-t,c-t,n);u.id=By(u.startTime,u.endTime,u.text);const d=function(e,t,n){const i="http://www.w3.org/ns/ttml#styling";let r=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;a&&n.hasOwnProperty(a)&&(r=n[a]);return s.reduce((n,s)=>{const a=Ky(t,i,s)||Ky(e,i,s)||Ky(r,i,s);return a&&(n[s]=a),n},{})}(l[e.getAttribute("region")],o[e.getAttribute("style")],o),{textAlign:h}=d;if(h){const e=Vy[h];e&&(u.lineAlign=e),u.align=h}return Hu(u,d),u}).filter(e=>null!==e)}(e,a)))}catch(o){i(o)}}function jy(e,t,n){const i=e.getElementsByTagName(t)[0];return i?[].slice.call(i.querySelectorAll(n)):[]}function Yy(e){return e.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function Xy(e,t){return[].slice.call(e.childNodes).reduce((e,n,i)=>{var r;return"br"===n.nodeName&&i?e+"\n":null!=(r=n.childNodes)&&r.length?Xy(n,t):t?e+n.textContent.trim().replace(/\s+/g," "):e+n.textContent},"")}function Ky(e,t,n){return e&&e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function qy(e){return new Error("Could not parse ttml timestamp ".concat(e))}function Jy(e,t){if(!e)return null;let n=Cy(e);return null===n&&(zy.test(e)?n=function(e,t){const n=zy.exec(e),i=(0|n[4])+(0|n[5])/t.subFrameRate;return 3600*(0|n[1])+60*(0|n[2])+(0|n[3])+i/t.frameRate}(e,t):Gy.test(e)&&(n=function(e,t){const n=Gy.exec(e),i=Number(n[1]);switch(n[2]){case"h":return 3600*i;case"m":return 60*i;case"ms":return 1e3*i;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}(e,t))),n}class Qy{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}function Zy(e){return e.characteristics&&/transcribes-spoken-dialog/gi.test(e.characteristics)&&/describes-music-and-sound/gi.test(e.characteristics)?"captions":"subtitles"}function $y(e,t){return!!e&&e.kind===Zy(t)&&Ig(t,e)}function e_(e,t,n,i){return Math.min(t,i)-Math.max(e,n)}const t_=/\s/,n_={newCue(e,t,n,i){const r=[];let s,a,o,l,c;const u=self.VTTCue||self.TextTrackCue;for(let h=0;h<i.rows.length;h++)if(s=i.rows[h],o=!0,l=0,c="",!s.isEmpty()){var d;for(let e=0;e<s.chars.length;e++)t_.test(s.chars[e].uchar)&&o?l++:(c+=s.chars[e].uchar,o=!1);s.cueStartTime=t,t===n&&(n+=1e-4),l>=16?l--:l++;const i=ky(c.trim()),f=By(t,n,i);null!=e&&null!=(d=e.cues)&&d.getCueById(f)||(a=new u(t,n,i),a.id=f,a.line=h+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*l/32)),r.push(a))}return e&&r.length&&(r.sort((e,t)=>"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line),r.forEach(t=>zv(e,t))),r}};const i_=/(\d+)-(\d+)\/(\d+)/;class r_{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||s_,this.controller=new self.AbortController,this.stats=new sd}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const r=function(e,t){const n={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(Hu({},e.headers))};e.rangeEnd&&n.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1));return n}(e,this.controller.signal),s="arraybuffer"===e.responseType,a=s?"byteLength":"length",{maxTimeToFirstByteMs:o,maxLoadTimeMs:l}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,r),self.clearTimeout(this.requestTimeout),t.timeout=o&&wu(o)?o:l,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,e,this.response))},t.timeout);(wg(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(n=>{var r;this.response=this.loader=n;const a=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=l,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,e,this.response))},l-(a-i.loading.start)),!n.ok){const{status:e,statusText:t}=n;throw new a_(t||"fetch, bad network response",e,n)}i.loading.first=a,i.total=function(e){const t=e.get("Content-Range");if(t){const e=function(e){const t=i_.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if(wu(e))return e}const n=e.get("Content-Length");if(n)return parseInt(n)}(n.headers)||i.total;const o=null==(r=this.callbacks)?void 0:r.onProgress;return o&&wu(t.highWaterMark)?this.loadProgressively(n,i,e,t.highWaterMark,o):s?n.arrayBuffer():"json"===e.responseType?n.json():n.text()}).then(n=>{var r,s;const o=this.response;if(!o)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const l=n[a];l&&(i.loaded=i.total=l);const c={url:o.url,data:n,code:o.status},u=null==(r=this.callbacks)?void 0:r.onProgress;u&&!wu(t.highWaterMark)&&u(i,e,n,o),null==(s=this.callbacks)||s.onSuccess(c,i,e,o)}).catch(t=>{var n;if(self.clearTimeout(this.requestTimeout),i.aborted)return;const r=t&&t.code||0,s=t?t.message:null;null==(n=this.callbacks)||n.onError({code:r,text:s},e,t?t.details:null,i)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0;const s=new $p,a=e.body.getReader(),o=()=>a.read().then(a=>{if(a.done)return s.dataLength&&r(t,n,s.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const l=a.value,c=l.length;return t.loaded+=c,c<i||s.dataLength?(s.push(l),s.dataLength>=i&&r(t,n,s.flush().buffer,e)):r(t,n,l.buffer,e),o()}).catch(()=>Promise.reject());return o()}}function s_(e,t){return new self.Request(e.url,t)}class a_ extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const o_=/^age:\s*[\d.]+\s*$/im;class l_{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new sd,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then(()=>{if(this.loader===n&&!this.stats.aborted)return r(n,t.url)}).catch(e=>{if(this.loader===n&&!this.stats.aborted)return n.open("GET",t.url,!0),r(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(e=>{var r;null==(r=this.callbacks)||r.onError({code:n.status,text:e.message},t,n,i)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const i=t.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:s}=n.loadPolicy;if(i)for(const a in i)e.setRequestHeader(a,i[a]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=r&&wu(r)?r:s,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,r=this.config;if(!n.aborted&&i>=2&&(0===n.loading.first&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),4===i)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const i=t.status,l="text"===t.responseType?t.responseText:null;if(i>=200&&i<300){const r=null!=l?l:t.response;if(null!=r){var s,a;n.loading.end=Math.max(self.performance.now(),n.loading.first);const o="arraybuffer"===t.responseType?r.byteLength:r.length;n.loaded=n.total=o,n.bwEstimate=8e3*n.total/(n.loading.end-n.loading.first);const l=null==(s=this.callbacks)?void 0:s.onProgress;l&&l(n,e,r,t);const c={url:t.responseURL,data:r,code:i};return void(null==(a=this.callbacks)||a.onSuccess(c,n,e,t))}}const c=r.loadPolicy.errorRetry;var o;if(Uh(c,n.retry,!1,{url:e.url,data:void 0,code:i}))this.retry(c);else qu.error("".concat(i," while loading ").concat(e.url)),null==(o=this.callbacks)||o.onError({code:i,text:t.statusText},e,t,n)}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry;if(Uh(e,this.stats.retry,!0))this.retry(e);else{var t;qu.warn("timeout while loading ".concat(null==(t=this.context)?void 0:t.url));const e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Fh(e,n.retry),n.retry++,qu.warn("".concat(status?"HTTP Status "+status:"Timeout"," while loading ").concat(null==t?void 0:t.url,", retrying ").concat(n.retry,"/").concat(e.maxNumRetry," in ").concat(this.retryDelay,"ms")),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&o_.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp("^".concat(e,":\\s*[\\d.]+\\s*$"),"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const c_=Gu(Gu({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:6e7,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:l_,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class extends Vu{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=e=>{var t;const{fragCurrent:n,partCurrent:i,hls:r}=this,{autoLevelEnabled:s,media:a}=r;if(!n||!a)return;const o=performance.now(),l=i?i.stats:n.stats,c=i?i.duration:n.duration,u=o-l.loading.start,d=r.minAutoLevel,h=n.level,f=this._nextAutoLevel;if(l.aborted||l.loaded&&l.loaded===l.total||h<=d)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!s)return;const p=f>-1&&f!==h,m=!!e||p;if(!m&&(a.paused||!a.playbackRate||!a.readyState))return;const g=r.mainForwardBufferInfo;if(!m&&null===g)return;const v=this.bwEstimator.getEstimateTTFB(),y=Math.abs(a.playbackRate);if(u<=Math.max(v,c/(2*y)*1e3))return;const _=g?g.len/y:0,b=l.loading.first?l.loading.first-l.loading.start:-1,x=l.loaded&&b>-1,S=this.getBwEstimate(),E=r.levels,w=E[h],T=Math.max(l.loaded,Math.round(c*(n.bitrate||w.averageBitrate)/8));let M=x?u-b:u;M<1&&x&&(M=Math.min(u,8*l.loaded/S));const A=x?1e3*l.loaded/M:0,C=v/1e3,R=A?(T-l.loaded)/A:8*T/S+C;if(R<=_)return;const L=A?8*A:S,P=!0===(null==(t=(null==e?void 0:e.details)||this.hls.latestLevelDetails)?void 0:t.live),I=this.hls.config.abrBandWidthUpFactor;let D,k=Number.POSITIVE_INFINITY;for(D=h-1;D>d;D--){const e=E[D].maxBitrate,t=!E[D].details||P;if(k=this.getTimeToLoadFrag(C,L,c*e,t),k<Math.min(_,c+C))break}if(k>=R)return;if(k>10*c)return;x?this.bwEstimator.sample(u-Math.min(v,b),l.loaded):this.bwEstimator.sampleTTFB(u);const O=E[D].maxBitrate;this.getBwEstimate()*I>O&&this.resetEstimator(O);const N=this.findBestLevel(O,d,D,0,_,1,1);N>-1&&(D=N),this.warn("Fragment ".concat(n.sn).concat(i?" part "+i.index:""," of level ").concat(h," is loading too slowly;\n      Fragment duration: ").concat(n.duration.toFixed(3),"\n      Time to underbuffer: ").concat(_.toFixed(3)," s\n      Estimated load time for current fragment: ").concat(R.toFixed(3)," s\n      Estimated load time for down switch fragment: ").concat(k.toFixed(3)," s\n      TTFB estimate: ").concat(0|b," ms\n      Current BW estimate: ").concat(wu(S)?0|S:"Unknown"," bps\n      New BW estimate: ").concat(0|this.getBwEstimate()," bps\n      Switching to level ").concat(D," @ ").concat(0|O," bps")),r.nextLoadLevel=r.nextAutoLevel=D,this.clearTimer();const F=()=>{if(this.clearTimer(),this.fragCurrent===n&&this.hls.loadLevel===D&&D>0){const e=this.getStarvationDelay();if(this.warn("Aborting inflight request ".concat(D>0?"and switching down":"","\n      Fragment duration: ").concat(n.duration.toFixed(3)," s\n      Time to underbuffer: ").concat(e.toFixed(3)," s")),n.abortRequests(),this.fragCurrent=this.partCurrent=null,D>d){let t=this.findBestLevel(this.hls.levels[d].bitrate,d,D,0,e,1,1);-1===t&&(t=d),this.hls.nextLoadLevel=this.hls.nextAutoLevel=t,this.resetEstimator(this.hls.levels[t].bitrate)}}};p||R>2*k?F():this.timer=self.setInterval(F,1e3*k),r.trigger(Ru.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,part:i,stats:l})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log("setting initial bwe to ".concat(e)),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new Bu(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Ru.FRAG_LOADING,this.onFragLoading,this),e.on(Ru.FRAG_LOADED,this.onFragLoaded,this),e.on(Ru.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Ru.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Ru.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Ru.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Ru.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(Ru.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Ru.FRAG_LOADING,this.onFragLoading,this),e.off(Ru.FRAG_LOADED,this.onFragLoaded,this),e.off(Ru.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Ru.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Ru.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Ru.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Ru.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(Ru.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){var i;if(!n.bitrateTest)this.fragCurrent=n,this.partCurrent=null!=(i=t.part)?i:null;this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case Cu.BUFFER_ADD_CODEC_ERROR:case Cu.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Cu.FRAG_LOAD_TIMEOUT:{const e=t.frag,{fragCurrent:n,partCurrent:i}=this;if(e&&n&&e.sn===n.sn&&e.level===n.level){const t=performance.now(),n=i?i.stats:e.stats,r=t-n.loading.start,s=n.loading.first?n.loading.first-n.loading.start:-1;if(n.loaded&&s>-1){const e=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(r-Math.min(e,s),n.loaded)}else this.bwEstimator.sampleTTFB(r)}break}}}getTimeToLoadFrag(e,t,n,i){return e+n/t+(i?e+this.lastLevelLoadSec:0)}onLevelLoaded(e,t){const n=this.hls.config,{loading:i}=t.stats,r=i.end-i.first;wu(r)&&(this.lastLevelLoadSec=r/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,t){let{frag:n,part:i}=t;const r=i?i.stats:n.stats;if(n.type===ku&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(n)){if(this.clearTimer(),n.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const e=i?i.duration:n.duration,t=this.hls.levels[n.level],s=(t.loaded?t.loaded.bytes:0)+r.loaded,a=(t.loaded?t.loaded.duration:0)+e;t.loaded={bytes:s,duration:a},t.realBitrate=Math.round(8*s/a)}if(n.bitrateTest){const e={stats:r,frag:n,part:i,id:n.type};this.onFragBuffered(Ru.FRAG_BUFFERED,e),n.bitrateTest=!1}else this.lastLoadedFragLevel=n.level}}onFragBuffered(e,t){const{frag:n,part:i}=t,r=null!=i&&i.stats.loaded?i.stats:n.stats;if(r.aborted)return;if(this.ignoreFragment(n))return;const s=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(s,r.loaded),r.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=s/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==ku||"initSegment"===e.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,r=this.findBestLevel(n,t,e,0,i,1,1);if(r>-1)return r;const s=this.hls.firstLevel,a=Math.min(Math.max(s,t),e);return this.warn("Could not find best starting auto level. Defaulting to first in playlist ".concat(s," clamped to ").concat(a)),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,t=this.bwEstimator.canEstimate(),n=this.lastLoadedFragLevel>-1;if(-1!==e&&(!t||!n||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const i=t&&n?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==e){const t=this.hls.levels;if(t.length>Math.max(e,i)&&t[e].loadError<=t[i].loadError)return e}return this._nextAutoLevel=i,this.nextAutoLevelKey=this.getAutoLevelKey(),i}getAutoLevelKey(){return"".concat(this.getBwEstimate(),"_").concat(this.getStarvationDelay().toFixed(2))}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this;if(n.levels.length<=1)return n.loadLevel;const{maxAutoLevel:i,config:r,minAutoLevel:s}=n,a=t?t.duration:e?e.duration:0,o=this.getBwEstimate(),l=this.getStarvationDelay();let c=r.abrBandWidthFactor,u=r.abrBandWidthUpFactor;if(l){const e=this.findBestLevel(o,s,i,l,0,c,u);if(e>=0)return this.rebufferNotice=-1,e}let d=a?Math.min(a,r.maxStarvationDelay):r.maxStarvationDelay;if(!l){const e=this.bitrateTestDelay;if(e){d=(a?Math.min(a,r.maxLoadingDelay):r.maxLoadingDelay)-e,this.info("bitrate test took ".concat(Math.round(1e3*e),"ms, set first fragment max fetchDuration to ").concat(Math.round(1e3*d)," ms")),c=u=1}}const h=this.findBestLevel(o,s,i,l,d,c,u);if(this.rebufferNotice!==h&&(this.rebufferNotice=h,this.info("".concat(l?"rebuffering expected":"buffer is empty",", optimal quality level ").concat(h))),h>-1)return h;const f=n.levels[s],p=n.loadLevelObj;return p&&(null==f?void 0:f.bitrate)<p.bitrate?s:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,i,r,s,a){var o;const l=i+r,c=this.lastLoadedFragLevel,u=-1===c?this.hls.firstLevel:c,{fragCurrent:d,partCurrent:h}=this,{levels:f,allAudioTracks:p,loadLevel:m,config:g}=this.hls;if(1===f.length)return 0;const v=f[u],y=!(null==(o=this.hls.latestLevelDetails)||!o.live),_=-1===m||-1===c;let b,x="SDR",S=(null==v?void 0:v.frameRate)||0;const{audioPreference:E,videoPreference:w}=g,T=this.audioTracksByGroup||(this.audioTracksByGroup=xh(p));let M=-1;if(_){if(-1!==this.firstSelection)return this.firstSelection;const i=this.codecTiers||(this.codecTiers=function(e,t,n,i){return e.slice(n,i+1).reduce((e,n,i)=>{if(!n.codecSet)return e;const r=n.audioGroups;let s=e[n.codecSet];s||(e[n.codecSet]=s={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:i,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!r,fragmentError:0}),s.minBitrate=Math.min(s.minBitrate,n.bitrate);const a=Math.min(n.height,n.width);return s.minHeight=Math.min(s.minHeight,a),s.minFramerate=Math.min(s.minFramerate,n.frameRate),s.minIndex=Math.min(s.minIndex,i),s.maxScore=Math.max(s.maxScore,n.score),s.fragmentError+=n.fragmentError,s.videoRanges[n.videoRange]=(s.videoRanges[n.videoRange]||0)+1,r&&r.forEach(e=>{if(!e)return;const n=t.groups[e];n&&(s.hasDefaultAudio=s.hasDefaultAudio||t.hasDefaultAudio?n.hasDefault:n.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(n.channels).forEach(e=>{s.channels[e]=(s.channels[e]||0)+n.channels[e]}))}),e},{})}(f,T,t,n)),r=function(e,t,n,i,r){const s=Object.keys(e),a=null==i?void 0:i.channels,o=null==i?void 0:i.audioCodec,l=null==r?void 0:r.videoCodec,c=a&&2===parseInt(a);let u=!1,d=!1,h=1/0,f=1/0,p=1/0,m=1/0,g=0,v=[];const{preferHDR:y,allowedVideoRanges:_}=yh(t,r);for(let E=s.length;E--;){const t=e[s[E]];u||(u=t.channels[2]>0),h=Math.min(h,t.minHeight),f=Math.min(f,t.minFramerate),p=Math.min(p,t.minBitrate),_.filter(e=>t.videoRanges[e]>0).length>0&&(d=!0)}h=wu(h)?h:0,f=wu(f)?f:0;const b=Math.max(1080,h),x=Math.max(30,f);p=wu(p)?p:n,n=Math.max(p,n),d||(t=void 0);const S=s.length>1;return{codecSet:s.reduce((t,i)=>{const r=e[i];if(i===t)return t;if(v=d?_.filter(e=>r.videoRanges[e]>0):[],S){if(r.minBitrate>n)return bh(i,"min bitrate of ".concat(r.minBitrate," > current estimate of ").concat(n)),t;if(!r.hasDefaultAudio)return bh(i,"no renditions with default or auto-select sound found"),t;if(o&&i.indexOf(o.substring(0,4))%5!==0)return bh(i,'audio codec preference "'.concat(o,'" not found')),t;if(a&&!c){if(!r.channels[a])return bh(i,"no renditions with ".concat(a," channel sound found (channels options: ").concat(Object.keys(r.channels),")")),t}else if((!o||c)&&u&&0===r.channels[2])return bh(i,"no renditions with stereo sound found"),t;if(r.minHeight>b)return bh(i,"min resolution of ".concat(r.minHeight," > maximum of ").concat(b)),t;if(r.minFramerate>x)return bh(i,"min framerate of ".concat(r.minFramerate," > maximum of ").concat(x)),t;if(!v.some(e=>r.videoRanges[e]>0))return bh(i,"no variants with VIDEO-RANGE of ".concat(_h(v)," found")),t;if(l&&i.indexOf(l.substring(0,4))%5!==0)return bh(i,'video codec preference "'.concat(l,'" not found')),t;if(r.maxScore<g)return bh(i,"max score of ".concat(r.maxScore," < selected max of ").concat(g)),t}return t&&(Xd(i)>=Xd(t)||r.fragmentError>e[t].fragmentError)?t:(m=r.minIndex,g=r.maxScore,i)},void 0),videoRanges:v,preferHDR:y,minFramerate:f,minBitrate:p,minIndex:m}}(i,x,e,E,w),{codecSet:s,videoRanges:a,minFramerate:o,minBitrate:l,minIndex:c,preferHDR:u}=r;M=c,b=s,x=u?a[a.length-1]:a[0],S=o,e=Math.max(e,l),this.log("picked start tier ".concat(_h(r)))}else b=null==v?void 0:v.codecSet,x=null==v?void 0:v.videoRange;const A=h?h.duration:d?d.duration:0,C=this.bwEstimator.getEstimateTTFB()/1e3,R=[];for(let P=n;P>=t;P--){var L;const t=f[P],o=P>u;if(!t)continue;if(g.useMediaCapabilities&&!t.supportedResult&&!t.supportedPromise){const n=navigator.mediaCapabilities;"function"===typeof(null==n?void 0:n.decodingInfo)&&sh(t,T,x,S,e,E)?(t.supportedPromise=ah(t,T,n,this.supportedCache),t.supportedPromise.then(e=>{if(!this.hls)return;t.supportedResult=e;const n=this.hls.levels,i=n.indexOf(t);e.error?this.warn('MediaCapabilities decodingInfo error: "'.concat(e.error,'" for level ').concat(i," ").concat(_h(e))):e.supported?e.decodingInfoResults.some(e=>!1===e.smooth||!1===e.powerEfficient)&&this.log("MediaCapabilities decodingInfo for level ".concat(i," not smooth or powerEfficient: ").concat(_h(e))):(this.warn("Unsupported MediaCapabilities decodingInfo result for level ".concat(i," ").concat(_h(e))),i>-1&&n.length>1&&(this.log("Removing unsupported level ".concat(i)),this.hls.removeLevel(i),-1===this.hls.loadLevel&&(this.hls.nextLoadLevel=0)))}).catch(e=>{this.warn("Error handling MediaCapabilities decodingInfo: ".concat(e))})):t.supportedResult=ih}if((b&&t.codecSet!==b||x&&t.videoRange!==x||o&&S>t.frameRate||!o&&S>0&&S<t.frameRate||null!=(L=t.supportedResult)&&null!=(L=L.decodingInfoResults)&&L.some(e=>!1===e.smooth))&&(!_||P!==M)){R.push(P);continue}const d=t.details,p=(h?null==d?void 0:d.partTarget:null==d?void 0:d.averagetargetduration)||A;let v;v=o?a*e:s*e;const w=A&&i>=2*A&&0===r?t.averageBitrate:t.maxBitrate,I=this.getTimeToLoadFrag(C,v,w*p,void 0===d);if(v>=w&&(P===c||0===t.loadError&&0===t.fragmentError)&&(I<=C||!wu(I)||y&&!this.bitrateTestDelay||I<l)){const e=this.forcedAutoLevel;return P===m||-1!==e&&e===m||(R.length&&this.trace("Skipped level(s) ".concat(R.join(",")," of ").concat(n,' max with CODECS and VIDEO-RANGE:"').concat(f[R[0]].codecs,'" ').concat(f[R[0]].videoRange,'; not compatible with "').concat(b,'" ').concat(x)),this.info("switch candidate:".concat(u,"->").concat(P," adjustedbw(").concat(Math.round(v),")-bitrate=").concat(Math.round(v-w)," ttfb:").concat(C.toFixed(1)," avgDuration:").concat(p.toFixed(1)," maxFetchDuration:").concat(l.toFixed(1)," fetchDuration:").concat(I.toFixed(1)," firstSelection:").concat(_," codecSet:").concat(t.codecSet," videoRange:").concat(t.videoRange," hls.loadLevel:").concat(m))),_&&(this.firstSelection=P),P}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls;return Math.min(Math.max(e,n),t)}},bufferController:class extends Vu{constructor(e,t){var n;super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=e=>{var t;this.hls&&"open"===(null==(t=this.mediaSource)?void 0:t.readyState)&&this.hls.pauseBuffering()},this._onStartStreaming=e=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=e=>{const{media:t,mediaSource:n}=this;e&&this.log("Media source opened"),t&&n&&(n.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(Ru.MEDIA_ATTACHED,{media:t,mediaSource:n}),null!==this.mediaSource&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:e,_objectUrl:t}=this;e!==t&&this.error("Media element src was set while attaching MediaSource (".concat(t," > ").concat(e,")"))},this.hls=e,this.fragmentTracker=t,this.appendSource=(n=Ju(e.config.preferManagedMediaSource),"undefined"!==typeof self&&n===self.ManagedMediaSource),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(Ru.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Ru.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Ru.BUFFER_RESET,this.onBufferReset,this),e.on(Ru.BUFFER_APPENDING,this.onBufferAppending,this),e.on(Ru.BUFFER_CODECS,this.onBufferCodecs,this),e.on(Ru.BUFFER_EOS,this.onBufferEos,this),e.on(Ru.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Ru.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(Ru.FRAG_PARSED,this.onFragParsed,this),e.on(Ru.FRAG_CHANGED,this.onFragChanged,this),e.on(Ru.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Ru.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Ru.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Ru.BUFFER_RESET,this.onBufferReset,this),e.off(Ru.BUFFER_APPENDING,this.onBufferAppending,this),e.off(Ru.BUFFER_CODECS,this.onBufferCodecs,this),e.off(Ru.BUFFER_EOS,this.onBufferEos,this),e.off(Ru.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Ru.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(Ru.FRAG_PARSED,this.onFragParsed,this),e.off(Ru.FRAG_CHANGED,this.onFragChanged,this),e.off(Ru.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const n={};if(this.operationQueue){const e=this.isUpdating();e||this.operationQueue.removeBlockers();const t=this.isQueued();(e||t)&&this.warn("Transfering MediaSource with".concat(t?" operations in queue":"").concat(e?" updating SourceBuffer(s)":""," ").concat(this.operationQueue)),this.operationQueue.destroy()}const i=this.transferData;return!this.sourceBufferCount&&i&&i.mediaSource===t?Hu(n,i.tracks):this.sourceBuffers.forEach(e=>{const[t]=e;t&&(n[t]=Hu({},this.tracks[t]),this.removeBuffer(t)),e[0]=e[1]=null}),{media:e,mediaSource:t,tracks:n}}initTracks(){this.sourceBuffers=[[null,null],[null,null]],this.tracks={},this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var n;let i=2;(t.audio&&!t.video||!t.altAudio)&&(i=1),this.bufferCodecEventsTotal=i,this.log("".concat(i," bufferCodec event(s) expected.")),null!=(n=this.transferData)&&n.mediaSource&&this.sourceBufferCount&&i&&this.bufferCreated()}onMediaAttaching(e,t){const n=this.media=t.media;this.transferData=this.overrides=void 0;const i=Ju(this.appendSource);if(i){const e=!!t.mediaSource;(e||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const s=this.mediaSource=t.mediaSource||new i;if(this.assignMediaSource(s),e)this._objectUrl=n.src,this.attachTransferred();else{const e=this._objectUrl=self.URL.createObjectURL(s);if(this.appendSource)try{n.removeAttribute("src");const t=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||t&&s instanceof t,Fg(n),function(e,t){const n=self.document.createElement("source");n.type="video/mp4",n.src=t,e.appendChild(n)}(n,e),n.load()}catch(r){n.src=e}else n.src=e}n.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,n;this.log("".concat((null==(t=this.transferData)?void 0:t.mediaSource)===e?"transferred":"created"," media source: ").concat(null==(n=e.constructor)?void 0:n.name)),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const n=this.tracks,i=t.tracks,r=i?Object.keys(i):null,s=r?r.length:0,a=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(i&&r&&s){if(!this.tracksReady)return this.hls.config.startFragPrefetch=!0,void this.log("attachTransferred: waiting for SourceBuffer track info");if(this.log("attachTransferred: (bufferCodecEventsTotal ".concat(this.bufferCodecEventsTotal,")\nrequired tracks: ").concat(_h(n,(e,t)=>"initSegment"===e?void 0:t),";\ntransfer tracks: ").concat(_h(i,(e,t)=>"initSegment"===e?void 0:t),"}")),!Qu(i,n)){t.mediaSource=null,t.tracks=void 0;const r=e.currentTime,s=this.details,a=Math.max(r,(null==s?void 0:s.fragments[0].start)||0);return a-r>1?void this.log("attachTransferred: waiting for playback to reach new tracks start time ".concat(r," -> ").concat(a)):(this.warn('attachTransferred: resetting MediaSource for incompatible tracks ("'.concat(Object.keys(i),'"->"').concat(Object.keys(n),'") start time: ').concat(a," currentTime: ").concat(r)),this.onMediaDetaching(Ru.MEDIA_DETACHING,{}),this.onMediaAttaching(Ru.MEDIA_ATTACHING,t),void(e.currentTime=a))}this.transferData=void 0,r.forEach(e=>{const t=e,n=i[t];if(n){const e=n.buffer;if(e){const i=this.fragmentTracker,r=n.id;if(i.hasFragments(r)||i.hasParts(r)){const n=_f.getBuffered(e);i.detectEvictedFragments(t,n,r,null,!0)}const s=Bg(t),a=[t,e];this.sourceBuffers[s]=a,e.updating&&this.operationQueue&&this.operationQueue.prependBlocker(t),this.trackSourceBuffer(t,n)}}}),a(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),a()}get mediaSourceOpenOrEnded(){var e;const t=null==(e=this.mediaSource)?void 0:e.readyState;return"open"===t||"ended"===t}onMediaDetaching(e,t){const n=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:i,mediaSource:r,_objectUrl:s}=this;if(r){if(this.log("media source ".concat(n?"transferring":"detaching")),n)this.sourceBuffers.forEach(e=>{let[t]=e;t&&this.removeBuffer(t)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const e="open"===r.readyState;try{const t=r.sourceBuffers;for(let n=t.length;n--;)e&&t[n].abort(),r.removeSourceBuffer(t[n]);e&&r.endOfStream()}catch(One){this.warn("onMediaDetaching: ".concat(One.message," while calling endOfStream"))}}this.sourceBufferCount&&this.onBufferReset()}r.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("sourceended",this._onMediaSourceEnded),r.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(r.removeEventListener("startstreaming",this._onStartStreaming),r.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}i&&(i.removeEventListener("emptied",this._onMediaEmptied),n||(s&&self.URL.revokeObjectURL(s),this.mediaSrc===s?(i.removeAttribute("src"),this.appendSource&&Fg(i),i.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(Ru.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(e=>{let[t]=e;t&&this.resetBuffer(t)}),this.initTracks()}resetBuffer(e){var t;const n=null==(t=this.tracks[e])?void 0:t.buffer;if(this.removeBuffer(e),n)try{var i;null!=(i=this.mediaSource)&&i.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}catch(One){this.warn("onBufferReset ".concat(e),One)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[Bg(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new Dg(this.tracks)}onBufferCodecs(e,t){var n;const i=this.tracks,r=Object.keys(t);this.log('BUFFER_CODECS: "'.concat(r,'" (current SB count ').concat(this.sourceBufferCount,")"));const s="audiovideo"in t&&(i.audio||i.video)||i.audiovideo&&("audio"in t||"video"in t),a=!s&&this.sourceBufferCount&&this.media&&r.some(e=>!i[e]);s||a?this.warn('Unsupported transition between "'.concat(Object.keys(i),'" and "').concat(r,'" SourceBuffers')):(r.forEach(e=>{var n,r;const s=t[e],{id:a,codec:o,levelCodec:l,container:c,metadata:u,supplemental:d}=s;let h=i[e];const f=null==(n=this.transferData)||null==(n=n.tracks)?void 0:n[e],p=null!=f&&f.buffer?f:h,m=(null==p?void 0:p.pendingCodec)||(null==p?void 0:p.codec),g=null==p?void 0:p.levelCodec;h||(h=i[e]={buffer:void 0,listeners:[],codec:o,supplemental:d,container:c,levelCodec:l,metadata:u,id:a});const v=Qd(m,g),y=null==v?void 0:v.replace(kg,"$1");let _=Qd(o,l);const b=null==(r=_)?void 0:r.replace(kg,"$1");_&&v&&y!==b&&("audio"===e.slice(0,5)&&(_=Jd(_,this.appendSource)),this.log("switching codec ".concat(m," to ").concat(_)),_!==(h.pendingCodec||h.codec)&&(h.pendingCodec=_),h.container=c,this.appendChangeType(e,c,_))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),this.sourceBufferCount||(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!t.video&&"main"===(null==(n=t.audio)?void 0:n.id)&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks()))}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const n=this.tracks[t];return e[t]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},e},{})}appendChangeType(e,t,n){const i="".concat(t,";codecs=").concat(n),r={label:"change-type=".concat(i),execute:()=>{const r=this.tracks[e];if(r){const s=r.buffer;null!=s&&s.changeType&&(this.log("changing ".concat(e," sourceBuffer type to ").concat(i)),s.changeType(i),r.codec=n,r.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{this.warn("Failed to change ".concat(e," SourceBuffer type"),t)}};this.append(r,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const n=e.start,i=n+.05*e.duration;if(!0===(null==(t=this.fragmentTracker.getAppendedFrag(n,ku))?void 0:t.gap))return;const r={label:"block-audio",execute:()=>{var e;const t=this.tracks.video;(this.lastVideoAppendEnd>i||null!=t&&t.buffer&&_f.isBuffered(t.buffer,i)||!0===(null==(e=this.fragmentTracker.getAppendedFrag(i,ku))?void 0:e.gap))&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:e=>{this.warn("Error executing block-audio operation",e)}};this.blockedAudioAppend={op:r,frag:e},this.append(r,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:n}=this,{data:i,type:r,parent:s,frag:a,part:o,chunkMeta:l,offset:c}=t,u=l.buffering[r],{sn:d,cc:h}=a,f=self.performance.now();u.start=f;const p=a.stats.buffering,m=o?o.stats.buffering:null;0===p.start&&(p.start=f),m&&0===m.start&&(m.start=f);const g=n.audio;let v=!1;"audio"===r&&"audio/mpeg"===(null==g?void 0:g.container)&&(v=!this.lastMpegAudioChunk||1===l.id||this.lastMpegAudioChunk.sn!==l.sn,this.lastMpegAudioChunk=l);const y=n.video,_=null==y?void 0:y.buffer;if(_&&"initSegment"!==d){const e=o||a,t=this.blockedAudioAppend;if("audio"!==r||"main"===s||this.blockedAudioAppend||y.ending||y.ended){if("video"===r){const n=e.end;if(t){const e=t.frag.start;(n>e||n<this.lastVideoAppendEnd||_f.isBuffered(_,e))&&this.unblockAudio()}this.lastVideoAppendEnd=n}}else{const t=e.start+.05*e.duration,n=_.buffered,i=this.currentOp("video");n.length||i?!i&&!_f.isBuffered(_,t)&&this.lastVideoAppendEnd<t&&this.blockAudio(e):this.blockAudio(e)}}const b=(o||a).start,x={label:"append-".concat(r),execute:()=>{var e;u.executeStart=self.performance.now();const t=null==(e=this.tracks[r])?void 0:e.buffer;t&&(v?this.updateTimestampOffset(t,b,.1,r,d,h):void 0!==c&&wu(c)&&this.updateTimestampOffset(t,c,1e-6,r,d,h)),this.appendExecutor(i,r)},onStart:()=>{},onComplete:()=>{const e=self.performance.now();u.executeEnd=u.end=e,0===p.first&&(p.first=e),m&&0===m.first&&(m.first=e);const t={};this.sourceBuffers.forEach(e=>{let[n,i]=e;n&&(t[n]=_f.getBuffered(i))}),this.appendErrors[r]=0,"audio"===r||"video"===r?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(Ru.BUFFER_APPENDED,{type:r,frag:a,part:o,chunkMeta:l,parent:a.type,timeRanges:t})},onError:e=>{var t;const n={type:Au.MEDIA_ERROR,parent:a.type,details:Cu.BUFFER_APPEND_ERROR,sourceBufferName:r,frag:a,part:o,chunkMeta:l,error:e,err:e,fatal:!1},i=null==(t=this.media)?void 0:t.error;if(e.code===DOMException.QUOTA_EXCEEDED_ERR||"QuotaExceededError"==e.name||"quota"in e)n.details=Cu.BUFFER_FULL_ERROR;else if(e.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!i)n.errorAction=qh(!0);else if(e.name===Og&&0===this.sourceBufferCount)n.errorAction=qh(!0);else{const e=++this.appendErrors[r];this.warn("Failed ".concat(e,"/").concat(this.hls.config.appendErrorMaxRetry,' times to append segment in "').concat(r,'" sourceBuffer (').concat(i||"no media error",")")),(e>=this.hls.config.appendErrorMaxRetry||i)&&(n.fatal=!0)}this.hls.trigger(Ru.ERROR,n)}};this.log('queuing "'.concat(r,'" append sn: ').concat(d).concat(o?" p: "+o.index:""," of ").concat(a.type===ku?"level":"track"," ").concat(a.level," cc: ").concat(h)),this.append(x,r,this.isPending(this.tracks[r]))}getFlushOp(e,t,n){return this.log('queuing "'.concat(e,'" remove ').concat(t,"-").concat(n)),{label:"remove",execute:()=>{this.removeExecutor(e,t,n)},onStart:()=>{},onComplete:()=>{this.hls.trigger(Ru.BUFFER_FLUSHED,{type:e})},onError:i=>{this.warn("Failed to remove ".concat(t,"-").concat(n,' from "').concat(e,'" SourceBuffer'),i)}}}onBufferFlushing(e,t){const{type:n,startOffset:i,endOffset:r}=t;n?this.append(this.getFlushOp(n,i,r),n):this.sourceBuffers.forEach(e=>{let[t]=e;t&&this.append(this.getFlushOp(t,i,r),t)})}onFragParsed(e,t){const{frag:n,part:i}=t,r=[],s=i?i.elementaryStreams:n.elementaryStreams;s[ld]?r.push("audiovideo"):(s[ad]&&r.push("audio"),s[od]&&r.push("video"));0===r.length&&this.warn("Fragments must have at least one ElementaryStreamType set. type: ".concat(n.type," level: ").concat(n.level," sn: ").concat(n.sn)),this.blockBuffers(()=>{const e=self.performance.now();n.stats.buffering.end=e,i&&(i.stats.buffering.end=e);const t=i?i.stats:n.stats;this.hls.trigger(Ru.FRAG_BUFFERED,{frag:n,part:i,stats:t,id:n.type})},r).catch(e=>{this.warn("Fragment buffered callback ".concat(e)),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(e=>{let[t]=e;if(t){const e=this.tracks[t];if(e)return!e.ended||e.ending}return!1})}onBufferEos(e,t){var n;this.sourceBuffers.forEach(e=>{let[n]=e;if(n){const e=this.tracks[n];t.type&&t.type!==n||(e.ending=!0,e.ended||(e.ended=!0,this.log("".concat(n," buffer reached EOS"))))}});const i=!1!==(null==(n=this.overrides)?void 0:n.endOfStream);this.sourceBufferCount>0&&!this.sourceBuffers.some(e=>{let[t]=e;var n;return t&&!(null!=(n=this.tracks[t])&&n.ended)})?i?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:e}=this;e&&"open"===e.readyState?(this.log("Calling mediaSource.endOfStream()"),e.endOfStream(),this.hls.trigger(Ru.BUFFERED_TO_END,void 0)):e&&this.log("Could not call mediaSource.endOfStream(). mediaSource.readyState: ".concat(e.readyState))})):(this.tracksEnded(),this.hls.trigger(Ru.BUFFERED_TO_END,void 0)):"video"===t.type&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(e=>{let[t]=e;if(null!==t){const e=this.tracks[t];e&&(e.ending=!1)}})}onLevelUpdated(e,t){let{details:n}=t;n.fragments.length&&(this.details=n,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===Cu.BUFFER_APPEND_ERROR&&t.frag){var n;const e=null==(n=t.errorAction)?void 0:n.nextAutoLevel;wu(e)&&e!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||null===t)return;if(!this.sourceBufferCount)return;const i=e.config,r=n.currentTime,s=t.levelTargetDuration,a=t.live&&null!==i.liveBackBufferLength?i.liveBackBufferLength:i.backBufferLength;if(wu(a)&&a>=0){const e=Math.max(a,s),t=Math.floor(r/s)*s-e;this.flushBackBuffer(r,s,t)}const o=i.frontBufferFlushThreshold;if(wu(o)&&o>0){const e=Math.max(i.maxBufferLength,o),t=Math.max(e,s),n=Math.floor(r/s)*s+t;this.flushFrontBuffer(r,s,n)}}flushBackBuffer(e,t,n){this.sourceBuffers.forEach(e=>{let[t,i]=e;if(i){const e=_f.getBuffered(i);if(e.length>0&&n>e.start(0)){var r;this.hls.trigger(Ru.BACK_BUFFER_REACHED,{bufferEnd:n});const e=this.tracks[t];if(null!=(r=this.details)&&r.live)this.hls.trigger(Ru.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(null!=e&&e.ended)return void this.log("Cannot flush ".concat(t," back buffer while SourceBuffer is in ended state"));this.hls.trigger(Ru.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:t})}}})}flushFrontBuffer(e,t,n){this.sourceBuffers.forEach(t=>{let[i,r]=t;if(r){const t=_f.getBuffered(r),s=t.length;if(s<2)return;const a=t.start(s-1),o=t.end(s-1);if(n>a||e>=a&&e<=o)return;this.hls.trigger(Ru.BUFFER_FLUSHING,{startOffset:a,endOffset:1/0,type:i})}})}getDurationAndRange(){var e;const{details:t,mediaSource:n}=this;if(!t||!this.media||"open"!==(null==n?void 0:n.readyState))return null;const i=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&n.setLiveSeekableRange){const e=Math.max(0,t.fragmentStart);return{duration:1/0,start:e,end:Math.max(e,i)}}return{duration:1/0}}const r=null==(e=this.overrides)?void 0:e.duration;if(r)return wu(r)?{duration:r}:null;const s=this.media.duration;return i>(wu(n.duration)?n.duration:0)&&i>s||!wu(s)?{duration:i}:null}updateMediaSource(e){let{duration:t,start:n,end:i}=e;const r=this.mediaSource;this.media&&r&&"open"===r.readyState&&(r.duration!==t&&(wu(t)&&this.log("Updating MediaSource duration to ".concat(t.toFixed(3))),r.duration=t),void 0!==n&&void 0!==i&&(this.log("MediaSource duration is set to ".concat(r.duration,". Setting seekable range to ").concat(n,"-").concat(i,".")),r.setLiveSeekableRange(n,i)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:n}=this;if(this.log("checkPendingTracks (pending: ".concat(t," codec events expected: ").concat(e,") ").concat(_h(n))),this.tracksReady){var i;const e=null==(i=this.transferData)?void 0:i.tracks;e&&Object.keys(e).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(t=>{let[n,i]=t;if(n){const t=this.tracks[n];e[n]={buffer:i,container:t.container,codec:t.codec,supplemental:t.supplemental,levelCodec:t.levelCodec,id:t.id,metadata:t.metadata}}}),this.hls.trigger(Ru.BUFFER_CREATED,{tracks:e}),this.log("SourceBuffers created. Running queue: ".concat(this.operationQueue)),this.sourceBuffers.forEach(e=>{let[t]=e;this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:n}=this;if(!n)throw new Error("createSourceBuffers called when mediaSource was null");for(const s in e){const a=s,o=e[a];if(this.isPending(o)){const e=this.getTrackCodec(o,a),s="".concat(o.container,";codecs=").concat(e);o.codec=e,this.log("creating sourceBuffer(".concat(s,")").concat(this.currentOp(a)?" Queued":""," ").concat(_h(o)));try{const e=n.addSourceBuffer(s),i=Bg(a),r=[a,e];t[i]=r,o.buffer=e}catch(r){var i;return this.error("error while trying to add sourceBuffer: ".concat(r.message)),this.shiftAndExecuteNext(a),null==(i=this.operationQueue)||i.removeBlockers(),delete this.tracks[a],void this.hls.trigger(Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:r,sourceBufferName:a,mimeType:s,parent:o.id})}this.trackSourceBuffer(a,o)}}this.bufferCreated()}getTrackCodec(e,t){const n=e.supplemental;let i=e.codec;n&&("video"===t||"audiovideo"===t)&&Vd(n,"video")&&(i=function(e,t){const n=[];if(e){const t=e.split(",");for(let e=0;e<t.length;e++)Gd(t[e],"video")||n.push(t[e])}return t&&n.push(t),n.join(",")}(i,n));const r=Qd(i,e.levelCodec);return r?"audio"===t.slice(0,5)?Jd(r,this.appendSource):r:""}trackSourceBuffer(e,t){const n=t.buffer;if(!n)return;const i=this.getTrackCodec(t,e);this.tracks[e]={buffer:n,codec:i,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(e,t)=>{const n=t.removedRanges;null!=n&&n.length&&this.hls.trigger(Ru.BUFFER_FLUSHED,{type:e})})}get mediaSrc(){var e,t;const n=(null==(e=this.media)||null==(t=e.querySelector)?void 0:t.call(e,"source"))||this.media;return null==n?void 0:n.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if("closed"===(null==(t=this.mediaSource)?void 0:t.readyState))return void this.resetBuffer(e);const n=this.currentOp(e);n&&(n.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var n;const i=new Error("".concat(e," SourceBuffer error. MediaSource readyState: ").concat(null==(n=this.mediaSource)?void 0:n.readyState));this.error("".concat(i),t),this.hls.trigger(Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});const r=this.currentOp(e);r&&r.onError(i)}updateTimestampOffset(e,t,n,i,r,s){const a=t-e.timestampOffset;Math.abs(a)>=n&&(this.log("Updating ".concat(i," SourceBuffer timestampOffset to ").concat(t," (sn: ").concat(r," cc: ").concat(s,")")),e.timestampOffset=t)}removeExecutor(e,t,n){const{media:i,mediaSource:r}=this,s=this.tracks[e],a=null==s?void 0:s.buffer;if(!i||!r||!a)return this.warn("Attempting to remove from the ".concat(e," SourceBuffer, but it does not exist")),void this.shiftAndExecuteNext(e);const o=wu(i.duration)?i.duration:1/0,l=wu(r.duration)?r.duration:1/0,c=Math.max(0,t),u=Math.min(n,o,l);u>c&&(!s.ending||s.ended)?(s.ended=!1,this.log("Removing [".concat(c,",").concat(u,"] from the ").concat(e," SourceBuffer")),a.remove(c,u)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.tracks[t],i=null==n?void 0:n.buffer;if(!i)throw new Ng("Attempting to append to the ".concat(t," SourceBuffer, but it does not exist"));n.ending=!1,n.ended=!1,i.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(e=>{this.warn("SourceBuffer blocked callback ".concat(e)),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn("Callback run without blocking ".concat(this.operationQueue," ").concat(t))}}isUpdating(){return this.sourceBuffers.some(e=>{let[t,n]=e;return t&&n.updating})}isQueued(){return this.sourceBuffers.some(e=>{let[t]=e;return t&&!!this.currentOp(t)})}isPending(e){return!!e&&!e.buffer}blockBuffers(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sourceBufferTypes;if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:n}=this,i=t.map(e=>this.appendBlocker(e));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(i).then(t=>{n===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(e=>{var t;const n=null==(t=this.tracks[e])?void 0:t.buffer;n&&!n.updating&&this.shiftAndExecuteNext(e)})}append(e,t,n){this.operationQueue&&this.operationQueue.append(e,t,n)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,t)=>{let[n]=t;return e+(n?1:0)},0)}get sourceBufferTypes(){return this.sourceBuffers.map(e=>{let[t]=e;return t}).filter(e=>!!e)}addBufferListener(e,t,n){const i=this.tracks[e];if(!i)return;const r=i.buffer;if(!r)return;const s=n.bind(this,e);i.listeners.push({event:t,listener:s}),r.addEventListener(t,s)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const n=t.buffer;n&&(t.listeners.forEach(e=>{n.removeEventListener(e.event,e.listener)}),t.listeners.length=0)}},capLevelController:Ug,errorController:class extends Vu{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(Ru.ERROR,this.onError,this),e.on(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Ru.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(Ru.ERROR,this.onError,this),e.off(Ru.ERROR,this.onErrorOut,this),e.off(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Ru.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(null==e?void 0:e.type)===ku?e.level:this.getVariantIndex()}getVariantIndex(){var e;const t=this.hls,n=t.currentLevel;return null!=(e=t.loadLevelObj)&&e.details||-1===n?t.loadLevel:n}variantHasKey(e,t){if(e){var n;if(null!=(n=e.details)&&n.hasKey(t))return!0;const i=e.audioGroups;if(i){return this.hls.allAudioTracks.filter(e=>i.indexOf(e.groupId)>=0).some(e=>{var n;return null==(n=e.details)?void 0:n.hasKey(t)})}}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,t){var n;if(t.fatal)return;const i=this.hls,r=t.context;switch(t.details){case Cu.FRAG_LOAD_ERROR:case Cu.FRAG_LOAD_TIMEOUT:case Cu.KEY_LOAD_ERROR:case Cu.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case Cu.FRAG_PARSING_ERROR:if(null!=(n=t.frag)&&n.gap)return void(t.errorAction=qh());case Cu.FRAG_GAP:case Cu.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=Gh);case Cu.LEVEL_EMPTY_ERROR:case Cu.LEVEL_PARSING_ERROR:{var s;const e=t.parent===ku?t.level:i.loadLevel;t.details===Cu.LEVEL_EMPTY_ERROR&&null!=(s=t.context)&&null!=(s=s.levelDetails)&&s.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,e):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e))}return;case Cu.LEVEL_LOAD_ERROR:case Cu.LEVEL_LOAD_TIMEOUT:return void("number"===typeof(null==r?void 0:r.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.level)));case Cu.AUDIO_TRACK_LOAD_ERROR:case Cu.AUDIO_TRACK_LOAD_TIMEOUT:case Cu.SUBTITLE_LOAD_ERROR:case Cu.SUBTITLE_TRACK_LOAD_TIMEOUT:if(r){const e=i.loadLevelObj;if(e&&(r.type===Iu&&e.hasAudioGroup(r.groupId)||r.type===Du&&e.hasSubtitleGroup(r.groupId)))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=Gh,void(t.errorAction.flags=Yh)}return;case Cu.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:return void(t.errorAction={action:Gh,flags:Xh});case Cu.KEY_SYSTEM_SESSION_UPDATE_FAILED:case Cu.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case Cu.KEY_SYSTEM_NO_SESSION:return void(t.errorAction={action:Gh,flags:Kh});case Cu.BUFFER_ADD_CODEC_ERROR:case Cu.REMUX_ALLOC_ERROR:case Cu.BUFFER_APPEND_ERROR:var a;if(!t.errorAction)t.errorAction=this.getLevelSwitchAction(t,null!=(a=t.level)?a:i.loadLevel);return;case Cu.INTERNAL_EXCEPTION:case Cu.BUFFER_APPENDING_ERROR:case Cu.BUFFER_FULL_ERROR:case Cu.LEVEL_SWITCH_ERROR:case Cu.BUFFER_STALLED_ERROR:case Cu.BUFFER_SEEK_OVER_HOLE:case Cu.BUFFER_NUDGE_ON_STALL:return void(t.errorAction=qh())}t.type===Au.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=qh())}getPlaylistRetryOrSwitchAction(e,t){const n=Nh(this.hls.config.playlistLoadPolicy,e),i=this.playlistError++;if(Uh(n,i,Dh(e),e.response))return{action:Wh,flags:jh,retryConfig:n,retryCount:i};const r=this.getLevelSwitchAction(e,t);return n&&(r.retryConfig=n,r.retryCount=i),r}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:r,keyLoadPolicy:s}=t.config,a=Nh(kh(e)?s:r,e),o=t.levels.reduce((e,t)=>e+t.fragmentError,0);if(i&&(e.details!==Cu.FRAG_GAP&&i.fragmentError++,!Oh(e))){if(Uh(a,o,Dh(e),e.response))return{action:Wh,flags:jh,retryConfig:a,retryCount:o}}const l=this.getLevelSwitchAction(e,n);return a&&(l.retryConfig=a,l.retryCount=o),l}getLevelSwitchAction(e,t){const n=this.hls;null!==t&&void 0!==t||(t=n.loadLevel);const i=this.hls.levels[t];if(i){var r,s;const t=e.details;i.loadError++,t===Cu.BUFFER_APPEND_ERROR&&i.fragmentError++;let l=-1;const{levels:c,loadLevel:u,minAutoLevel:d,maxAutoLevel:h}=n;n.autoLevelEnabled||n.config.preserveManualLevelOnError||(n.loadLevel=-1);const f=null==(r=e.frag)?void 0:r.type,p=(f===Ou&&t===Cu.FRAG_PARSING_ERROR||"audio"===e.sourceBufferName&&(t===Cu.BUFFER_ADD_CODEC_ERROR||t===Cu.BUFFER_APPEND_ERROR))&&c.some(e=>{let{audioCodec:t}=e;return i.audioCodec!==t}),m="video"===e.sourceBufferName&&(t===Cu.BUFFER_ADD_CODEC_ERROR||t===Cu.BUFFER_APPEND_ERROR)&&c.some(e=>{let{codecSet:t,audioCodec:n}=e;return i.codecSet!==t&&i.audioCodec===n}),{type:g,groupId:v}=null!=(s=e.context)?s:{};for(let n=c.length;n--;){const r=(n+u)%c.length;if(r!==u&&r>=d&&r<=h&&0===c[r].loadError){var a,o;const n=c[r];if(t===Cu.FRAG_GAP&&f===ku&&e.frag){const t=c[r].details;if(t){const n=Rh(e.frag,t.fragments,e.frag.start);if(null!=n&&n.gap)continue}}else{if(g===Iu&&n.hasAudioGroup(v)||g===Du&&n.hasSubtitleGroup(v))continue;if(f===Ou&&null!=(a=i.audioGroups)&&a.some(e=>n.hasAudioGroup(e))||f===Nu&&null!=(o=i.subtitleGroups)&&o.some(e=>n.hasSubtitleGroup(e))||p&&i.audioCodec===n.audioCodec||m&&i.codecSet===n.codecSet||!p&&i.codecSet!==n.codecSet)continue}l=r;break}}if(l>-1&&n.loadLevel!==l)return e.levelRetry=!0,this.playlistError=0,{action:Gh,flags:jh,nextAutoLevel:l}}return{action:Gh,flags:Yh}}onErrorOut(e,t){var n;switch(null==(n=t.errorAction)?void 0:n.action){case zh:break;case Gh:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===Cu.FRAG_GAP?/MediaSource readyState: ended/.test(t.error.message)&&(this.warn('MediaSource ended after "'.concat(t.sourceBufferName,'" sourceBuffer append error. Attempting to recover from media error.')),this.hls.recoverMediaError()):t.fatal=!0}t.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i}=n,r=n.nextAutoLevel;switch(i){case jh:this.switchLevel(e,r);break;case Xh:{const i=this.getVariantLevelIndex(e.frag),r=t.levels[i],s=null==r?void 0:r.attrs["HDCP-LEVEL"];if(n.hdcpLevel=s,"NONE"===s)this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(s){t.maxHdcpLevel=ch[ch.indexOf(s)-1],n.resolved=!0,this.warn('Restricting playback to HDCP-LEVEL of "'.concat(t.maxHdcpLevel,'" or lower'));break}}case Kh:{const t=e.decryptdata;if(t){const i=this.hls.levels,r=i.length;for(let n=r;n--;){var s,a;if(this.variantHasKey(i[n],t))this.log("Banned key found in level ".concat(n," (").concat(i[n].bitrate,'bps) or audio group "').concat(null==(s=i[n].audioGroups)?void 0:s.join(","),'" (').concat(null==(a=e.frag)?void 0:a.type," fragment) ").concat($u(t.keyId||[]))),i[n].fragmentError++,i[n].loadError++,this.log("Removing level ".concat(n," with key error (").concat(e.error,")")),this.hls.removeLevel(n)}const o=e.frag;if(this.hls.levels.length<r)n.resolved=!0;else if(o&&o.type!==ku){const e=o.decryptdata;e&&!t.matches(e)&&(n.resolved=!0)}}break}}n.resolved||this.switchLevel(e,r)}switchLevel(e,t){if(void 0!==t&&e.errorAction&&(this.warn("switching to level ".concat(t," after ").concat(e.details)),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===Cu.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&"audiovideo"!==e.sourceBufferName)){const t=th(e.mimeType),n=this.hls.levels;for(let i=n.length;i--;)n[i]["".concat(e.sourceBufferName,"Codec")]===t&&(this.log("Removing level ".concat(i," for ").concat(e.details,' ("').concat(t,'" not supported)')),this.hls.removeLevel(i))}}},fpsController:class{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(Ru.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(Ru.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(Ru.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(Ru.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const e=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=e,e&&"function"===typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const e=i-this.lastTime,r=n-this.lastDroppedFrames,s=t-this.lastDecodedFrames,a=1e3*r/e,o=this.hls;if(o.trigger(Ru.FPS_DROP,{currentDropped:r,currentDecoded:s,totalDroppedFrames:n}),a>0&&r>o.config.fpsDroppedMonitoringThreshold*s){let e=o.currentLevel;o.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+e),e>0&&(-1===o.autoLevelCapping||o.autoLevelCapping>=e)&&(e-=1,o.trigger(Ru.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:o.currentLevel}),o.autoLevelCapping=e,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:qf,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:n_,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends Qp{constructor(e,t,n){super(e,t,n,"subtitle-stream-controller",Nu),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(Ru.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Ru.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(Ru.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(Ru.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(Ru.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(Ru.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(Ru.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Ru.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(Ru.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(Ru.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(Ru.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(Ru.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=Hp,this.setInterval(500),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if(this.fragContextChanged(n)||(ud(n)&&(this.fragPrevious=n),this.state=Hp),!i)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let s;const a=n.start;for(let l=0;l<r.length;l++)if(a>=r[l].start&&a<=r[l].end){s=r[l];break}const o=n.start+n.duration;s?s.end=o:(s={start:a,end:o},r.push(s)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(0===n&&i!==Number.POSITIVE_INFINITY){const e=i-1;if(e<=0)return;t.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach(t=>{for(let n=0;n<t.length;)if(t[n].end<=e)t.shift();else{if(!(t[n].start<e))break;t[n].start=e,n++}}),this.fragmentTracker.removeFragmentsInRange(n,e,Nu)}}onError(e,t){const n=t.frag;(null==n?void 0:n.type)===Nu&&(t.details===Cu.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Up&&(this.state=Hp))}onSubtitleTracksUpdated(e,t){let{subtitleTracks:n}=t;this.levels&&Lg(this.levels,n)?this.levels=n.map(e=>new gh(e)):(this.tracksBuffered=[],this.levels=n.map(e=>{const t=new gh(e);return this.tracksBuffered[t.id]=[],t}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Nu),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,null==(n=this.levels)||!n.length||-1===this.currentTrackId)return void this.clearInterval();const i=this.levels[this.currentTrackId];null!=i&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.state!==Up&&this.setInterval(500)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:i,levels:r}=this,{details:s,id:a}=t;if(!r)return void this.warn("Subtitle tracks were reset while loading level ".concat(a));const o=r[a];if(a>=r.length||!o)return;this.log("Subtitle track ".concat(a," loaded [").concat(s.startSN,",").concat(s.endSN,"]").concat(s.lastPartSn?"[part-".concat(s.lastPartSn,"-").concat(s.lastPartIndex,"]"):"",",duration:").concat(s.totalduration)),this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(s.live||null!=(n=o.details)&&n.live){if(s.deltaUpdateFailed)return;const e=this.mainDetails;if(!e)return void(this.startFragRequested=!1);const t=e.fragments[0];var c;if(o.details)l=this.alignPlaylists(s,o.details,null==(c=this.levelLastLoaded)?void 0:c.details),0===l&&t&&(l=t.start,Ep(s,l));else s.hasProgramDateTime&&e.hasProgramDateTime?(Op(s,e),l=s.fragmentStart):t&&(l=t.start,Ep(s,l));e&&!this.startFragRequested&&this.setStartPosition(e,l)}if(o.details=s,this.levelLastLoaded=o,a===i&&(this.hls.trigger(Ru.SUBTITLE_TRACK_UPDATED,{details:s,id:a,groupId:t.groupId}),this.tick(),s.live&&!this.fragCurrent&&this.media&&this.state===Hp)){Rh(null,s.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),o.details=void 0)}}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,r=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&null!=i&&i.key&&i.iv&&kf(i.method)){const e=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer,Of(i.method)).catch(e=>{throw r.trigger(Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}),e}).then(n=>{const i=performance.now();r.trigger(Ru.FRAG_DECRYPTED,{frag:t,payload:n,stats:{tstart:e,tdecrypt:i}})}).catch(e=>{this.warn("".concat(e.name,": ").concat(e.message)),this.state=Hp})}}doTick(){if(this.media){if(this.state===Hp){const{currentTrackId:e,levels:t}=this,n=null==t?void 0:t[e];if(!n||!t.length||!n.details)return;if(this.waitForLive(n))return;const{config:i}=this,r=this.getLoadPosition(),s=_f.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,i.maxBufferHole),{end:a,len:o}=s,l=n.details;if(o>this.hls.maxBufferLength+l.levelTargetDuration)return;const c=l.fragments,u=c.length,d=l.edge;let h=null;const f=this.fragPrevious;if(a<d){const e=i.maxFragLookUpTolerance,t=a>d-e?0:e;h=Rh(f,c,Math.max(c[0].start,a),t),!h&&f&&f.start<c[0].start&&(h=c[0])}else h=c[u-1];if(h=this.filterReplacedPrimary(h,n.details),!h)return;const p=c[h.sn-l.startSN-1];if(p&&p.cc===h.cc&&this.fragmentTracker.getState(p)===Jh&&(h=p),this.fragmentTracker.getState(h)===Jh){const e=this.mapToInitFragWhenRequired(h);e&&this.loadFragment(e,n,a)}}}else this.state=Hp}loadFragment(e,t,n){ud(e)?super.loadFragment(e,t,n):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new ay(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends Rg{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=null;const t=Wv(this.media.textTracks);for(let i=0;i<t.length;i++)if("hidden"===t[i].mode)e=t[i];else if("showing"===t[i].mode){e=t[i];break}const n=this.findTrackForTextTrack(e);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Ru.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Ru.LEVEL_LOADING,this.onLevelLoading,this),e.on(Ru.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Ru.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(Ru.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Ru.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Ru.LEVEL_LOADING,this.onLevelLoading,this),e.off(Ru.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Ru.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(Ru.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const n=this.media;if(!n)return;const i=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||n.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,i)return;Wv(n.textTracks).forEach(e=>{Gv(e)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,s=this.tracksInGroup[n];if(!s||s.groupId!==i)return void this.warn("Subtitle track with id:".concat(n," and group:").concat(i," not found in active group ").concat(null==s?void 0:s.groupId));const a=s.details;s.details=t.details,this.log("Subtitle track ".concat(n,' "').concat(s.name,'" lang:').concat(s.lang," group:").concat(i," loaded [").concat(r.startSN,"-").concat(r.endSN,"]")),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some(e=>-1===(null==i?void 0:i.indexOf(e)))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter(e=>!n||-1!==n.indexOf(e.groupId));if(e.length)this.selectDefaultTrack&&!e.some(e=>e.default)&&(this.selectDefaultTrack=!1),e.forEach((e,t)=>{e.id=t});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.subtitlePreference;if(!r&&t){this.selectDefaultTrack=!1;const n=Eh(t,e);if(n>-1)r=e[n];else{const e=Eh(t,this.tracks);r=this.tracks[e]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const s={subtitleTracks:e};this.log("Updating subtitle tracks, ".concat(e.length,' track(s) found in "').concat(null==n?void 0:n.join(","),'" group-id')),this.hls.trigger(Ru.SUBTITLE_TRACKS_UPDATED,s),-1!==i&&-1===this.trackId&&this.setSubtitleTrack(i)}}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let i=0;i<t.length;i++){const r=t[i];if((!n||r.default)&&(n||e)&&(!e||wh(r,e)))return i}if(e){for(let n=0;n<t.length;n++){const i=t[n];if(Pg(e.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const i=t[n];if(Pg(e.attrs,i.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){if(Ig(t[n],e))return n}}return-1}onError(e,t){!t.fatal&&t.context&&(t.context.type!==Du||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(-1===e.id)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&wh(e,n))return n;const i=Eh(e,this.tracksInGroup);if(i>-1){const e=this.tracksInGroup[i];return this.setSubtitleTrack(i),e}if(n)return null;{const n=Eh(e,t);if(n>-1)return t[n]}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,i=e.groupId,r=this.getUrlWithDirectives(e.url,t),s=e.details,a=null==s?void 0:s.age;this.log("Loading subtitle ".concat(n,' "').concat(e.name,'" lang:').concat(e.lang," group:").concat(i).concat(void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:"").concat(a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""," ").concat(r)),this.hls.trigger(Ru.SUBTITLE_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Wv(e.textTracks),n=this.currentTrack;let i;if(n&&(i=t.filter(e=>Ig(n,e))[0],i||this.warn('Unable to find subtitle TextTrack with name "'.concat(n.name,'" and language "').concat(n.lang,'"'))),[].slice.call(t).forEach(e=>{"disabled"!==e.mode&&e!==i&&(e.mode="disabled")}),i){const e=this.subtitleDisplay?"showing":"hidden";i.mode!==e&&(i.mode=e)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=e);if(e<-1||e>=t.length||!wu(e))return void this.warn("Invalid subtitle track id: ".concat(e));this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),!i)return void this.hls.trigger(Ru.SUBTITLE_TRACK_SWITCH,{id:e});const r=!!i.details&&!i.details.live;if(e===this.trackId&&i===n&&r)return;this.log("Switching to subtitle-track ".concat(e)+(i?' "'.concat(i.name,'" lang:').concat(i.lang," group:").concat(i.groupId):""));const{id:s,groupId:a="",name:o,type:l,url:c}=i;this.hls.trigger(Ru.SUBTITLE_TRACK_SWITCH,{id:s,groupId:a,name:o,type:l,url:c});const u=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(u)}},timelineController:class{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(Ru.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Ru.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Ru.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(Ru.FRAG_LOADING,this.onFragLoading,this),e.on(Ru.FRAG_LOADED,this.onFragLoaded,this),e.on(Ru.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(Ru.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(Ru.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(Ru.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(Ru.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(Ru.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Ru.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Ru.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(Ru.FRAG_LOADING,this.onFragLoading,this),e.off(Ru.FRAG_LOADED,this.onFragLoaded,this),e.off(Ru.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(Ru.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(Ru.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(Ru.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(Ru.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new Qy(this,"textTrack1"),t=new Qy(this,"textTrack2"),n=new Qy(this,"textTrack3"),i=new Qy(this,"textTrack4");this.cea608Parser1=new Ey(1,e,t),this.cea608Parser2=new Ey(3,n,i)}addCues(e,t,n,i,r){let s=!1;for(let a=r.length;a--;){const e=r[a],i=e_(e[0],e[1],t,n);if(i>=0&&(e[0]=Math.min(e[0],t),e[1]=Math.max(e[1],n),s=!0,i/(n-t)>.5))return}if(s||r.push([t,n]),this.config.renderTextTracksNatively){const r=this.captionsTracks[e];this.Cues.newCue(r,t,n,i)}else{const r=this.Cues.newCue(null,t,n,i);this.hls.trigger(Ru.CUES_PARSED,{type:"captions",cues:r,track:e})}}onInitPtsFound(e,t){let{frag:n,id:i,initPTS:r,timescale:s,trackId:a}=t;const{unparsedVttFrags:o}=this;i===ku&&(this.initPTS[n.cc]={baseTime:r,timescale:s,trackId:a}),o.length&&(this.unparsedVttFrags=[],o.forEach(e=>{this.initPTS[e.frag.cc]?this.onFragLoaded(Ru.FRAG_LOADED,e):this.hls.trigger(Ru.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let i=0;i<n.textTracks.length;i++){const r=n.textTracks[i];if($y(r,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:r,languageCode:s}=t[e],a=this.getExistingTrack(r,s);if(a)n[e]=a,Gv(n[e]),Hv(n[e],i);else{const t=this.createTextTrack("captions",r,s);t&&(t[e]=!0,n[e]=t)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(Ru.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}createTextTrack(e,t,n){const i=this.media;if(i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const n=!!t.transferMedia;if(this.media=null,n)return;const{captionsTracks:i}=this;Object.keys(i).forEach(e=>{Gv(i[e]),delete i[e]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)Gv(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some(e=>e.textCodec===Hy);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(Lg(this.tracks,n))return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const e=this.media,t=e?Wv(e.textTracks):null;if(this.tracks.forEach((e,n)=>{let i;if(t){let n=null;for(let i=0;i<t.length;i++)if(t[i]&&$y(t[i],e)){n=t[i],t[i]=null;break}n&&(i=n)}if(i)Gv(i);else{const t=Zy(e);i=this.createTextTrack(t,e.name,e.lang),i&&(i.mode="disabled")}i&&this.textTracks.push(i)}),null!=t&&t.length){const e=t.filter(e=>null!==e).map(e=>e.label);e.length&&this.hls.logger.warn("Media element contains unused subtitle tracks: ".concat(e.join(", "),". Replace media element for each source to clear TextTracks and captions menu."))}}else if(this.tracks.length){const e=this.tracks.map(e=>({label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}));this.hls.trigger(Ru.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:e})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(e=>{const t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;const n="textTrack".concat(t[1]),i=this.captionsProperties[n];i&&(i.label=e.name,e.lang&&(i.languageCode=e.lang),i.media=e)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===ku){var n,i;const{cea608Parser1:e,cea608Parser2:r,lastSn:s}=this,{cc:a,sn:o}=t.frag,l=null!=(n=null==(i=t.part)?void 0:i.index)?n:-1;e&&r&&(o!==s+1||o===s&&l!==this.lastPartIndex+1||a!==this.lastCc)&&(e.reset(),r.reset()),this.lastCc=a,this.lastSn=o,this.lastPartIndex=l}}onFragLoaded(e,t){const{frag:n,payload:i}=t;if(n.type===Nu)if(i.byteLength){const e=n.decryptdata,r="stats"in t;if(null==e||!e.encrypted||r){const e=this.tracks[n.level],r=this.vttCCs;r[n.cc]||(r[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),e&&e.textCodec===Hy?this._parseIMSC1(n,i):this._parseVTTs(t)}}else this.hls.trigger(Ru.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;Wy(t,this.initPTS[e.cc],t=>{this._appendCues(t,e.level),n.trigger(Ru.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},t=>{n.logger.log("Failed to parse IMSC1: ".concat(t)),n.trigger(Ru.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})})}_parseVTTs(e){var t;const{frag:n,payload:i}=e,{initPTS:r,unparsedVttFrags:s}=this,a=r.length-1;if(!r[n.cc]&&-1===a)return void s.push(e);const o=this.hls;Uy(null!=(t=n.initSegment)&&t.data?Id(n.initSegment.data,new Uint8Array(i)).buffer:i,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,e=>{this._appendCues(e,n.level),o.trigger(Ru.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},t=>{const r="Missing initPTS for VTT MPEGTS"===t.message;r?s.push(e):this._fallbackToIMSC1(n,i),o.logger.log("Failed to parse VTT cue: ".concat(t)),r&&a>n.cc||o.trigger(Ru.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||Wy(t,this.initPTS[e.cc],()=>{n.textCodec=Hy,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||"disabled"===n.mode)return;e.forEach(e=>zv(n,e))}else{const i=this.tracks[t];if(!i)return;const r=i.default?"default":"subtitles"+t;n.trigger(Ru.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===Nu&&this.onFragLoaded(Ru.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:n,samples:i}=t;if(n.type!==ku||"NONE"!==this.closedCaptionsForLevel(n))for(let r=0;r<i.length;r++){const e=i[r].bytes;if(e){this.cea608Parser1||this.initCea608Parsers();const t=this.extractCea608Data(e);this.cea608Parser1.addData(i[r].pts,t[0]),this.cea608Parser2.addData(i[r].pts,t[1])}}}onBufferFlushing(e,t){let{startOffset:n,endOffset:i,endOffsetSubtitles:r,type:s}=t;const{media:a}=this;if(a&&!(a.currentTime<i)){if(!s||"video"===s){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>Vv(e[t],n,i))}if(this.config.renderTextTracksNatively&&0===n&&void 0!==r){const{textTracks:e}=this;Object.keys(e).forEach(t=>Vv(e[t],n,r))}}}extractCea608Data(e){const t=[[],[]],n=31&e[0];let i=2;for(let r=0;r<n;r++){const n=e[i++],r=127&e[i++],s=127&e[i++];if(0===r&&0===s)continue;if(0!==(4&n)){const e=3&n;0!==e&&1!==e||(t[e].push(r),t[e].push(s))}}return t}},audioStreamController:class extends Qp{constructor(e,t,n){super(e,t,n,"audio-stream-controller",Ou),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(Ru.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Ru.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(Ru.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(Ru.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(Ru.BUFFER_RESET,this.onBufferReset,this),e.on(Ru.BUFFER_CREATED,this.onBufferCreated,this),e.on(Ru.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Ru.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(Ru.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(Ru.FRAG_LOADING,this.onFragLoading,this),e.on(Ru.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(Ru.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Ru.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(Ru.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(Ru.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(Ru.BUFFER_RESET,this.onBufferReset,this),e.off(Ru.BUFFER_CREATED,this.onBufferCreated,this),e.off(Ru.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Ru.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(Ru.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(Ru.FRAG_LOADING,this.onFragLoading,this),e.off(Ru.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,t){let{frag:n,id:i,initPTS:r,timescale:s,trackId:a}=t;if(i===ku){const e=n.cc,t=this.fragCurrent;if(this.initPTS[e]={baseTime:r,timescale:s,trackId:a},this.log("InitPTS for cc: ".concat(e," found from main: ").concat(r/s," (").concat(r,"/").concat(s,") trackId: ").concat(a)),this.mainAnchor=n,this.state===qp){const t=this.waitingData;(!t&&!this.loadingParts||t&&t.frag.cc!==e)&&this.syncWithAnchor(n,null==t?void 0:t.frag)}else!this.hls.hasEnoughToStart&&t&&t.cc!==e?(t.abortRequests(),this.syncWithAnchor(n,t)):this.state===Hp&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var n;const i=(null==(n=this.mainFragLoading)?void 0:n.frag)||null;if(t&&(null==i?void 0:i.cc)===t.cc)return;const r=(i||e).cc,s=Ih(this.getLevelDetails(),r,this.getLoadPosition());s&&(this.log("Syncing with main frag at ".concat(s.start," cc ").concat(s.cc)),this.startFragRequested=!1,this.nextLoadPosition=s.start,this.resetLoadingState(),this.state===Hp&&this.doTickIdle())}startLoad(e,t){if(!this.levels)return this.startPosition=e,void(this.state=Up);const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),n>0&&-1===e?(this.log("Override startPosition with lastCurrentTime @".concat(n.toFixed(3))),e=n,this.state=Hp):this.state=Wp,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case Hp:this.doTickIdle();break;case Wp:{const{levels:e,trackId:t}=this,n=null==e?void 0:e[t],i=null==n?void 0:n.details;if(i&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(i))break;this.state=qp}break}case Vp:this.checkRetryDate();break;case qp:{const e=this.waitingData;if(e){const{frag:t,part:n,cache:i,complete:r}=e,s=this.mainAnchor;if(void 0!==this.initPTS[t.cc]){this.waitingData=null,this.state=Gp;const e={frag:t,part:n,payload:i.flush().buffer,networkDetails:null};this._handleFragmentLoadProgress(e),r&&super._handleFragmentLoadComplete(e)}else s&&s.cc!==e.frag.cc&&this.syncWithAnchor(s,e.frag)}else this.state=Hp}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:n,media:i,trackId:r}=this,s=t.config;if(!this.buffering||!i&&!this.primaryPrefetch&&(this.startFragRequested||!s.startFragPrefetch)||null==n||!n[r])return;const a=n[r],o=a.details;if(!o||this.waitForLive(a)||this.waitForCdnTuneIn(o))return this.state=Wp,void(this.startFragRequested=!1);const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,ad,Ou));const c=this.getFwdBufferInfo(l,Ou);if(null===c)return;if(!this.switchingTrack&&this._streamEnded(c,o))return t.trigger(Ru.BUFFER_EOS,{type:"audio"}),void(this.state=Xp);const u=c.len,d=t.maxBufferLength,h=o.fragments,f=h[0].start,p=this.getLoadPosition(),m=this.flushing?p:c.end;if(this.switchingTrack&&i){const e=p;o.PTSKnown&&e<f&&(c.end>f||c.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=f+.05)}if(u>=d&&!this.switchingTrack&&m<h[h.length-1].start)return;let g=this.getNextFragment(m,o);if(g&&this.isLoopLoading(g,m)&&(g=this.getNextFragmentLoopLoading(g,o,c,ku,d)),!g)return void(this.bufferFlushed=!0);let v=(null==(e=this.mainFragLoading)?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&v&&ud(g)&&!g.endList&&(!o.live||!this.loadingParts&&m<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(v)===$h&&(this.mainFragLoading=v=null),v&&ud(v))){if(g.start>v.end){const e=this.fragmentTracker.getFragAtPos(m,ku);e&&e.end>v.end&&(v=e,this.mainFragLoading={frag:e,targetBufferTime:null})}if(g.start>v.end)return}this.loadFragment(g,a,m)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,t){let{audioTracks:n}=t;this.resetTransmuxer(),this.levels=n.map(e=>new gh(e))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==Up&&(this.setInterval(100),this.state=Hp,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const n=this.cachedTrackLoadedData;n&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(Ru.AUDIO_TRACK_LOADED,n))}onAudioTrackLoaded(e,t){var n;const{levels:i}=this,{details:r,id:s,groupId:a,track:o}=t;if(!i)return void this.warn("Audio tracks reset while loading track ".concat(s,' "').concat(o.name,'" of "').concat(a,'"'));const l=this.mainDetails;if(!l||r.endCC>l.endCC||l.expired)return this.cachedTrackLoadedData=t,void(this.state!==Up&&(this.state=Wp));this.cachedTrackLoadedData=null,this.log("Audio track ".concat(s,' "').concat(o.name,'" of "').concat(a,'" loaded [').concat(r.startSN,",").concat(r.endSN,"]").concat(r.lastPartSn?"[part-".concat(r.lastPartSn,"-").concat(r.lastPartIndex,"]"):"",",duration:").concat(r.totalduration));const c=i[s];let u=0;if(r.live||null!=(n=c.details)&&n.live){if(this.checkLiveUpdate(r),r.deltaUpdateFailed)return;var d;if(c.details)u=this.alignPlaylists(r,c.details,null==(d=this.levelLastLoaded)?void 0:d.details);r.alignedSliding||(kp(r,l),r.alignedSliding||Op(r,l),u=r.fragmentStart)}c.details=r,this.levelLastLoaded=c,this.startFragRequested||this.setStartPosition(l,u),this.hls.trigger(Ru.AUDIO_TRACK_UPDATED,{details:r,id:s,groupId:t.groupId}),this.state!==Wp||this.waitForCdnTuneIn(r)||(this.state=Hp),this.tick()}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:i,payload:r}=e,{config:s,trackId:a,levels:o}=this;if(!o)return void this.warn("Audio tracks were reset while fragment load was in progress. Fragment ".concat(n.sn," of level ").concat(n.level," will not be buffered"));const l=o[a];if(!l)return void this.warn("Audio track is undefined on fragment load progress");const c=l.details;if(!c)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(n.start);const u=s.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let d=this.transmuxer;d||(d=this.transmuxer=new Cg(this.hls,Ou,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const h=this.initPTS[n.cc],f=null==(t=n.initSegment)?void 0:t.data;if(void 0!==h){const e=!1,t=i?i.index:-1,s=-1!==t,a=new vf(n.level,n.sn,n.stats.chunkCount,r.byteLength,t,s);d.push(r,f,u,"",n,i,c.totalduration,e,a,h)}else{this.log("Unknown video PTS for cc ".concat(n.cc,", waiting for video PTS before demuxing audio frag ").concat(n.sn," of [").concat(c.startSN," ,").concat(c.endSN,"],track ").concat(a));const{cache:e}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new $p,complete:!1};e.push(new Uint8Array(r)),this.state!==Up&&(this.state=qp)}}_handleFragmentLoadComplete(e){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===ku&&ud(t.frag)&&(this.mainFragLoading=t,this.state===Hp&&this.tick())}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type===Ou)if(this.fragContextChanged(n))this.warn("Fragment ".concat(n.sn).concat(i?" p: "+i.index:""," of level ").concat(n.level," finished buffering, but was aborted. state: ").concat(this.state,", audioSwitch: ").concat(this.switchingTrack?this.switchingTrack.name:"false"));else{if(ud(n)){this.fragPrevious=n;const e=this.switchingTrack;e&&(this.bufferedTrack=e,this.switchingTrack=null,this.hls.trigger(Ru.AUDIO_TRACK_SWITCHED,Gu({},e)))}this.fragBufferedComplete(n,i),this.media&&this.tick()}else this.audioOnly||n.type!==ku||n.elementaryStreams.video||n.elementaryStreams.audiovideo||(this.audioOnly=!0,this.mainFragLoading=null)}onError(e,t){var n;if(t.fatal)this.state=Kp;else switch(t.details){case Cu.FRAG_GAP:case Cu.FRAG_PARSING_ERROR:case Cu.FRAG_DECRYPT_ERROR:case Cu.FRAG_LOAD_ERROR:case Cu.FRAG_LOAD_TIMEOUT:case Cu.KEY_LOAD_ERROR:case Cu.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Ou,t);break;case Cu.AUDIO_TRACK_LOAD_ERROR:case Cu.AUDIO_TRACK_LOAD_TIMEOUT:case Cu.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Wp||(null==(n=t.context)?void 0:n.type)!==Iu||(this.state=Hp);break;case Cu.BUFFER_ADD_CODEC_ERROR:case Cu.BUFFER_APPEND_ERROR:if("audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case Cu.BUFFER_FULL_ERROR:if("audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Cu.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onBufferFlushing(e,t){let{type:n}=t;n!==od&&(this.flushing=!0)}onBufferFlushed(e,t){let{type:n}=t;if(n!==od){this.flushing=!1,this.bufferFlushed=!0,this.state===Xp&&(this.state=Hp);const e=this.mediaBuffer||this.media;e&&(this.afterBufferFlushed(e,n,Ou),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:r,chunkMeta:s}=e,a=this.getCurrentContext(s);if(!a)return void this.resetWhenMissingContext(s);const{frag:o,part:l,level:c}=a,{details:u}=c,{audio:d,text:h,id3:f,initSegment:p}=r;if(!this.fragContextChanged(o)&&u){if(this.state=jp,this.switchingTrack&&d&&this.completeAudioSwitch(this.switchingTrack),null!=p&&p.tracks){const e=o.initSegment||o;if(this.unhandledEncryptionError(p,o))return;this._bufferInitSegment(c,p.tracks,e,s),i.trigger(Ru.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:p.tracks})}if(d){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=d;l&&(l.elementaryStreams[ad]={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),o.setElementaryStreamInfo(ad,e,t,n,i),this.bufferFragmentData(d,o,l,s)}if(null!=f&&null!=(t=f.samples)&&t.length){const e=Hu({id:n,frag:o,details:u},f);i.trigger(Ru.FRAG_PARSING_METADATA,e)}if(h){const e=Hu({id:n,frag:o,details:u},h);i.trigger(Ru.FRAG_PARSING_USERDATA,e)}}else this.fragmentTracker.removeFragment(o)}_bufferInitSegment(e,t,n,i){if(this.state!==jp)return;if(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio)return;const r=t.audio;r.id=Ou;const s=e.audioCodec;this.log("Init audio buffer, container:".concat(r.container,", codecs[level/parsed]=[").concat(s,"/").concat(r.codec,"]")),s&&1===s.split(",").length&&(r.levelCodec=s),this.hls.trigger(Ru.BUFFER_CODECS,t);const a=r.initSegment;if(null!=a&&a.byteLength){const e={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:a};this.hls.trigger(Ru.BUFFER_APPENDING,e)}this.tickImmediate()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);var r;if(this.switchingTrack||i===Jh||i===Zh)if(ud(e))if(null!=(r=t.details)&&r.live&&!this.initPTS[e.cc]){this.log("Waiting for video PTS in continuity counter ".concat(e.cc," of live stream before loading audio fragment ").concat(e.sn," of level ").concat(this.trackId)),this.state=qp;const n=this.mainDetails;n&&n.fragmentStart!==t.details.fragmentStart&&Op(t.details,n)}else super.loadFragment(e,t,n);else this._loadInitSegment(e,t);else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:i,characteristics:r,audioCodec:s,channels:a}=this.bufferedTrack;wh({name:t,lang:n,assocLang:i,characteristics:r,audioCodec:s,channels:a},e,Th)||(Ah(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(Ru.AUDIO_TRACK_SWITCHED,Gu({},e))}},audioTrackController:class extends Rg{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Ru.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Ru.LEVEL_LOADING,this.onLevelLoading,this),e.on(Ru.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Ru.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(Ru.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Ru.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Ru.LEVEL_LOADING,this.onLevelLoading,this),e.off(Ru.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Ru.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(Ru.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,s=this.tracksInGroup[n];if(!s||s.groupId!==i)return void this.warn("Audio track with id:".concat(n," and group:").concat(i," not found in active group ").concat(null==s?void 0:s.groupId));const a=s.details;s.details=t.details,this.log("Audio track ".concat(n,' "').concat(s.name,'" lang:').concat(s.lang," group:").concat(i," loaded [").concat(r.startSN,"-").concat(r.endSN,"]")),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some(e=>-1===(null==i?void 0:i.indexOf(e)))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter(e=>!n||-1!==n.indexOf(e.groupId));if(e.length)this.selectDefaultTrack&&!e.some(e=>e.default)&&(this.selectDefaultTrack=!1),e.forEach((e,t)=>{e.id=t});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.audioPreference;if(!r&&t){const n=Eh(t,e,Th);if(n>-1)r=e[n];else{const e=Eh(t,this.tracks);r=this.tracks[e]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const a={audioTracks:e};this.log("Updating audio tracks, ".concat(e.length," track(s) found in group(s): ").concat(null==n?void 0:n.join(","))),this.hls.trigger(Ru.AUDIO_TRACKS_UPDATED,a);const o=this.trackId;if(-1!==i&&-1===o)this.setAudioTrack(i);else if(e.length&&-1===o){var s;const t=new Error("No audio track selected for current audio group-ID(s): ".concat(null==(s=this.groupIds)?void 0:s.join(",")," track count: ").concat(e.length));this.warn(t.message),this.hls.trigger(Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:t})}}}onError(e,t){!t.fatal&&t.context&&(t.context.type!==Iu||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&wh(e,i,Th))return i;const r=Eh(e,this.tracksInGroup,Th);if(r>-1){const e=this.tracksInGroup[r];return this.setAudioTrack(r),e}if(i){let i=t.loadLevel;-1===i&&(i=t.firstAutoLevel);const r=function(e,t,n,i,r){const s=t[i],a=t.reduce((e,t,n)=>{const i=t.uri;return(e[i]||(e[i]=[])).push(n),e},{}),o=a[s.uri];o.length>1&&(i=Math.max.apply(Math,o));const l=s.videoRange,c=s.frameRate,u=s.codecSet.substring(0,4),d=Mh(t,i,t=>{if(t.videoRange!==l||t.frameRate!==c||t.codecSet.substring(0,4)!==u)return!1;const i=t.audioGroups,s=n.filter(e=>!i||-1!==i.indexOf(e.groupId));return Eh(e,s,r)>-1});return d>-1?d:Mh(t,i,t=>{const i=t.audioGroups,s=n.filter(e=>!i||-1!==i.indexOf(e.groupId));return Eh(e,s,r)>-1})}(e,t.levels,n,i,Th);if(-1===r)return null;t.nextLoadLevel=r}if(e.channels||e.audioCodec){const t=Eh(e,n);if(t>-1)return n[t]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length)return void this.warn("Invalid audio track id: ".concat(e));this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e],r=i.details&&!i.details.live;if(e===this.trackId&&i===n&&r)return;if(this.log("Switching to audio-track ".concat(e,' "').concat(i.name,'" lang:').concat(i.lang," group:").concat(i.groupId," channels:").concat(i.channels)),this.trackId=e,this.currentTrack=i,this.hls.trigger(Ru.AUDIO_TRACK_SWITCHING,Gu({},i)),r)return;const s=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(s)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if((!this.selectDefaultTrack||i.default)&&(!e||wh(e,i,Th)))return n}if(e){const{name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o}=e;for(let e=0;e<t.length;e++){if(wh({name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o},t[e],Th))return e}for(let l=0;l<t.length;l++){const n=t[l];if(Pg(e.attrs,n.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return l}for(let l=0;l<t.length;l++){const n=t[l];if(Pg(e.attrs,n.attrs,["LANGUAGE"]))return l}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Ah(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,i=e.groupId,r=this.getUrlWithDirectives(e.url,t),s=e.details,a=null==s?void 0:s.age;this.log("Loading audio-track ".concat(n,' "').concat(e.name,'" lang:').concat(e.lang," group:").concat(i).concat(void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:"").concat(a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""," ").concat(r)),this.hls.trigger(Ru.AUDIO_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:t||null,track:e})}},emeController:Ov,cmcdController:class{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=e=>{try{this.apply(e,{ot:Hg.MANIFEST,su:!this.initialized})}catch(t){this.hls.logger.warn("Could not generate manifest CMCD data.",t)}},this.applyFragmentData=e=>{try{const{frag:t,part:n}=e,i=this.hls.levels[t.level],r=this.getObjectType(t),s={d:1e3*(n||t).duration,ot:r};r!==Hg.VIDEO&&r!==Hg.AUDIO&&r!=Hg.MUXED||(s.br=i.bitrate/1e3,s.tb=this.getTopBandwidth(r)/1e3,s.bl=this.getBufferLength(r));const a=n?this.getNextPart(n):this.getNextFrag(t);null!=a&&a.url&&a.url!==t.url&&(s.nor=a.url),this.apply(e,s)}catch(t){this.hls.logger.warn("Could not generate segment CMCD data.",t)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;null!=n&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||e.sessionId,this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Ru.MEDIA_DETACHED,this.onMediaDetached,this),e.on(Ru.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Ru.MEDIA_DETACHED,this.onMediaDetached,this),e.off(Ru.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=null==(n=t.tracks.audio)?void 0:n.buffer,this.videoBuffer=null==(i=t.tracks.video)?void 0:i.buffer}createData(){var e;return{v:1,sf:zg.HLS,sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Hu(t,this.createData());const n=t.ot===Hg.INIT||t.ot===Hg.VIDEO||t.ot===Hg.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering);const{includeKeys:i}=this;i&&(t=Object.keys(t).reduce((e,n)=>(i.includes(n)&&(e[n]=t[n]),e),{}));const r={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),Rv(e.headers,t,r)):e.url=Iv(e.url,t,r)}getNextFrag(e){var t;const n=null==(t=this.hls.levels[e.level])?void 0:t.details;if(n){const t=e.sn-n.startSN;return n.fragments[t+1]}}getNextPart(e){var t;const{index:n,fragment:i}=e,r=null==(t=this.hls.levels[i.level])||null==(t=t.details)?void 0:t.partList;if(r){const{sn:e}=i;for(let t=r.length-1;t>=0;t--){const i=r[t];if(i.index===n&&i.fragment.sn===e)return r[t+1]}}}getObjectType(e){const{type:t}=e;return"subtitle"===t?Hg.TIMED_TEXT:"initSegment"===e.sn?Hg.INIT:"audio"===t?Hg.AUDIO:"main"===t?this.hls.audioTracks.length?Hg.VIDEO:Hg.MUXED:void 0}getTopBandwidth(e){let t,n=0;const i=this.hls;if(e===Hg.AUDIO)t=i.audioTracks;else{const e=i.maxAutoLevel,n=e>-1?e+1:i.levels.length;t=i.levels.slice(0,n)}return t.forEach(e=>{e.bitrate>n&&(n=e.bitrate)}),n>0?n:NaN}getBufferLength(e){const t=this.media,n=e===Hg.AUDIO?this.audioBuffer:this.videoBuffer;if(!n||!t)return NaN;return 1e3*_f.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,i){t(e),this.loader.load(e,n,i)}}}},contentSteeringController:class extends Vu{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Ru.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Ru.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Ru.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Ru.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Ru.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Ru.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0)return void this.scheduleRefresh(this.uri,e)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(t=>t!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;null!==n&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((null==n?void 0:n.action)===Gh&&n.flags===Yh){const e=this.levels;let i=this._pathwayPriority,r=this.pathwayId;if(t.context){const{groupId:n,pathwayId:i,type:s}=t.context;n&&e?r=this.getPathwayForGroupId(n,s,r):i&&(r=i)}r in this.penalizedPathways||(this.penalizedPathways[r]=performance.now()),!i&&e&&(i=this.pathways()),i&&i.length>1&&(this.updatePathwayPriority(i),n.resolved=this.pathwayId!==r),t.details!==Cu.BUFFER_APPEND_ERROR||t.fatal?n.resolved||this.warn("Could not resolve ".concat(t.details,' ("').concat(t.error.message,'") with content-steering for Pathway: ').concat(r," levels: ").concat(e?e.length:e," priorities: ").concat(_h(i)," penalized: ").concat(_h(this.penalizedPathways))):n.resolved=!0}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){const n=e[0].pathwayId;this.log("No levels found in Pathway ".concat(this.pathwayId,'. Setting initial Pathway to "').concat(n,'"')),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log("Found ".concat(t.length,"/").concat(e.length,' levels in Pathway "').concat(this.pathwayId,'"')),t}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){let t;this._pathwayPriority=e;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach(e=>{i-n[e]>3e5&&delete n[e]});for(let r=0;r<e.length;r++){const i=e[r];if(i in n)continue;if(i===this.pathwayId)return;const s=this.hls.nextLoadLevel,a=this.hls.levels[s];if(t=this.getLevelsForPathway(i),t.length>0){this.log('Setting Pathway to "'.concat(i,'"')),this.pathwayId=i,Cp(t),this.hls.trigger(Ru.LEVELS_UPDATED,{levels:t});const e=this.hls.levels[s];a&&e&&this.levels&&(e.attrs["STABLE-VARIANT-ID"]!==a.attrs["STABLE-VARIANT-ID"]&&e.bitrate!==a.bitrate&&this.log("Unstable Pathways change from bitrate ".concat(a.bitrate," to ").concat(e.bitrate)),this.hls.nextLoadLevel=s);break}}}getPathwayForGroupId(e,t,n){const i=this.getLevelsForPathway(n).concat(this.levels||[]);for(let r=0;r<i.length;r++)if(t===Iu&&i[r].hasAudioGroup(e)||t===Du&&i[r].hasSubtitleGroup(e))return i[r].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach(e=>{const{ID:r,"BASE-ID":s,"URI-REPLACEMENT":a}=e;if(t.some(e=>e.pathwayId===r))return;const o=this.getLevelsForPathway(s).map(e=>{const t=new Af(e.attrs);t["PATHWAY-ID"]=r;const s=t.AUDIO&&"".concat(t.AUDIO,"_clone_").concat(r),o=t.SUBTITLES&&"".concat(t.SUBTITLES,"_clone_").concat(r);s&&(n[t.AUDIO]=s,t.AUDIO=s),o&&(i[t.SUBTITLES]=o,t.SUBTITLES=o);const l=kv(e.uri,t["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",a),c=new gh({attrs:t,audioCodec:e.audioCodec,bitrate:e.bitrate,height:e.height,name:e.name,url:l,videoCodec:e.videoCodec,width:e.width});if(e.audioGroups)for(let n=1;n<e.audioGroups.length;n++)c.addGroupId("audio","".concat(e.audioGroups[n],"_clone_").concat(r));if(e.subtitleGroups)for(let n=1;n<e.subtitleGroups.length;n++)c.addGroupId("text","".concat(e.subtitleGroups[n],"_clone_").concat(r));return c});t.push(...o),Dv(this.audioTracks,n,a,r),Dv(this.subtitleTracks,i,a,r)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;let i;this.loader&&this.loader.destroy(),this.loader=new n(t);try{i=new self.URL(e)}catch(c){return this.enabled=!1,void this.log("Failed to parse Steering Manifest URI: ".concat(e))}if("data:"!==i.protocol){const e=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate);i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+e)}const r={responseType:"json",url:i.href},s=t.steeringManifestLoadPolicy.default,a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(e,t,n,r)=>{this.log('Loaded steering manifest: "'.concat(i,'"'));const s=e.data;if(1!==(null==s?void 0:s.VERSION))return void this.log("Steering VERSION ".concat(s.VERSION," not supported!"));this.updated=performance.now(),this.timeToLoad=s.TTL;const{"RELOAD-URI":a,"PATHWAY-CLONES":o,"PATHWAY-PRIORITY":l}=s;if(a)try{this.uri=new self.URL(a,i).href}catch(c){return this.enabled=!1,void this.log("Failed to parse Steering Manifest RELOAD-URI: ".concat(a))}this.scheduleRefresh(this.uri||n.url),o&&this.clonePathways(o);const u={steeringManifest:s,url:i.toString()};this.hls.trigger(Ru.STEERING_MANIFEST_LOADED,u),l&&this.updatePathwayPriority(l)},onError:(e,t,n,i)=>{if(this.log("Error loading steering manifest: ".concat(e.code," ").concat(e.text," (").concat(t.url,")")),this.stopLoad(),410===e.code)return this.enabled=!1,void this.log("Steering manifest ".concat(t.url," no longer available"));let r=1e3*this.timeToLoad;if(429===e.code){const e=this.loader;if("function"===typeof(null==e?void 0:e.getResponseHeader)){const t=e.getResponseHeader("Retry-After");t&&(r=1e3*parseFloat(t))}return void this.log("Steering manifest ".concat(t.url," rate limited"))}this.scheduleRefresh(this.uri||t.url,r)},onTimeout:(e,t,n)=>{this.log("Timeout loading steering manifest (".concat(t.url,")")),this.scheduleRefresh(this.uri||t.url)}};this.log("Requesting steering manifest: ".concat(i)),this.loader.load(r,o,l)}scheduleRefresh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3*this.timeToLoad;this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var t;const n=null==(t=this.hls)?void 0:t.media;!n||n.ended?this.scheduleRefresh(e,1e3*this.timeToLoad):this.loadSteeringManifest(e)},t)}},interstitialsController:class extends Vu{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const e=this.currentTime;if(void 0===e||this.playbackDisabled||!this.schedule)return;const t=e-this.timelinePos;if(Math.abs(t)<1/7056e5)return;const n=t<=-.01;this.timelinePos=e,this.bufferedPos=e;const i=this.playingItem;if(!i)return void this.checkBuffer();if(n){this.schedule.resetErrorsInRange(e,e-t)&&this.updateSchedule(!0)}if(this.checkBuffer(),n&&e<i.start||e>=i.end){var r;const t=this.findItemIndex(i);let s=this.schedule.findItemIndexAtTime(e);if(-1===s&&(s=t+(n?-1:1),this.log("seeked ".concat(n?"back ":"","to position not covered by schedule ").concat(e," (resolving from ").concat(t," to ").concat(s,")"))),!this.isInterstitial(i)&&null!=(r=this.media)&&r.paused&&(this.shouldPlay=!1),!n&&s>t){const e=this.schedule.findJumpRestrictedIndex(t+1,s);if(e>t)return void this.setSchedulePosition(e)}return void this.setSchedulePosition(s)}const s=this.playingAsset;if(!s){if(this.playingLastItem&&this.isInterstitial(i)){const t=i.event.assetList[0];t&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(e,t))}return}const a=s.timelineStart,o=s.duration||0;var l;(n&&e<a||e>=a+o)&&(null!=(l=i.event)&&l.appendInPlace&&(this.clearAssetPlayers(i.event,i),this.flushFrontBuffer(e)),this.setScheduleToAssetAtTime(e,s))},this.onTimeupdate=()=>{const e=this.currentTime;if(void 0===e||this.playbackDisabled)return;if(!(e>this.timelinePos))return;this.timelinePos=e,e>this.bufferedPos&&this.checkBuffer();const t=this.playingItem;if(!t||this.playingLastItem)return;if(e>=t.end){this.timelinePos=t.end;const e=this.findItemIndex(t);this.setSchedulePosition(e+1)}const n=this.playingAsset;if(!n)return;e>=n.timelineStart+(n.duration||0)&&this.setScheduleToAssetAtTime(e,n)},this.onScheduleUpdate=(e,t)=>{const n=this.schedule;if(!n)return;const i=this.playingItem,r=n.events||[],s=n.items||[],a=n.durations,o=e.map(e=>e.identifier),l=!(!r.length&&!o.length);(l||t)&&this.log("INTERSTITIALS_UPDATED (".concat(r.length,"): ").concat(r,"\nSchedule: ").concat(s.map(e=>ny(e))," pos: ").concat(this.timelinePos)),o.length&&this.log("Removed events ".concat(o));let c=null,u=null;i&&(c=this.updateItem(i,this.timelinePos),this.itemsMatch(i,c)?this.playingItem=c:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const d=this.bufferingItem;if(d&&(u=this.updateItem(d,this.bufferedPos),this.itemsMatch(d,u)?this.bufferingItem=u:d.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(d.event,null))),e.forEach(e=>{e.assetList.forEach(e=>{this.clearAssetPlayer(e.identifier,null)})}),this.playerQueue.forEach(e=>{if(e.interstitial.appendInPlace){const t=e.assetItem.timelineStart,n=e.timelineOffset-t;if(n)try{e.timelineOffset=t}catch(kne){Math.abs(n)>Yv&&this.warn("".concat(kne,' ("').concat(e.assetId,'" ').concat(e.timelineOffset,"->").concat(t,")"))}}}),l||t){if(this.hls.trigger(Ru.INTERSTITIALS_UPDATED,{events:r.slice(0),schedule:s.slice(0),durations:a,removedIds:o}),this.isInterstitial(i)&&o.includes(i.event.identifier))return this.warn('Interstitial "'.concat(i.event.identifier,'" removed while playing')),void this.primaryFallback(i.event);i&&this.trimInPlace(c,i),d&&u!==c&&this.trimInPlace(u,d),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new iy(e),this.schedule=new ty(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(Ru.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Ru.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(Ru.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(Ru.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(Ru.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(Ru.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(Ru.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(Ru.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(Ru.BUFFER_APPENDED,this.onBufferAppended,this),e.on(Ru.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(Ru.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(Ru.MEDIA_ENDED,this.onMediaEnded,this),e.on(Ru.ERROR,this.onError,this),e.on(Ru.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(Ru.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Ru.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(Ru.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(Ru.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(Ru.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(Ru.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(Ru.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(Ru.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(Ru.BUFFER_CODECS,this.onBufferCodecs,this),e.off(Ru.BUFFER_APPENDED,this.onBufferAppended,this),e.off(Ru.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(Ru.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(Ru.MEDIA_ENDED,this.onMediaEnded,this),e.off(Ru.ERROR,this.onError,this),e.off(Ru.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;null==(e=this.getBufferingPlayer())||e.resumeBuffering()}pauseBuffering(){var e;null==(e=this.getBufferingPlayer())||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){Fp(e,"play",this.onPlay),Fp(e,"pause",this.onPause),Fp(e,"seeking",this.onSeeking),Fp(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const n=this.media=t.media;Np(n,"seeking",this.onSeeking),Np(n,"timeupdate",this.onTimeupdate),Np(n,"play",this.onPlay),Np(n,"pause",this.onPause)}onMediaAttached(e,t){const n=this.effectivePlayingItem,i=this.detachedData;if(this.detachedData=null,null===n)this.checkStart();else if(!i){this.clearScheduleState();const e=this.findItemIndex(n);this.setSchedulePosition(e)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const n=!!t.transferMedia,i=this.media;if(this.media=null,!n&&(i&&this.removeMediaListeners(i),this.detachedData)){const e=this.getBufferingPlayer();e&&(this.log("Removing schedule state for detachedData and ".concat(e)),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,e.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,t=()=>e.bufferingItem||e.waitingItem,n=t=>t?e.getAssetPlayer(t.identifier):t,i=(t,i,s,a,o)=>{if(t){let l=t[i].start;const c=t.event;if(c){if("playout"===i||c.timelineOccupancy!==Xv.Point){const e=n(s);(null==e?void 0:e.interstitial)===c&&(l+=e.assetItem.startOffset+e[o])}}else{l+=("bufferedPos"===a?r():e[a])-t.start}return l}return 0},r=()=>{const t=e.bufferedPos;return t===Number.MAX_VALUE?s("primary"):Math.max(t,0)},s=t=>{var n,i;return null!=(n=e.primaryDetails)&&n.live?e.primaryDetails.edge:(null==(i=e.schedule)?void 0:i.durations[t])||0},a=(t,r)=>{var s,a;const o=e.effectivePlayingItem;if(null!=o&&null!=(s=o.event)&&s.restrictions.skip||!e.schedule)return;e.log("seek to ".concat(t,' "').concat(r,'"'));const l=e.effectivePlayingItem,c=e.schedule.findItemIndexAtTime(t,r),u=null==(a=e.schedule.items)?void 0:a[c],d=e.getBufferingPlayer(),h=null==d?void 0:d.interstitial,f=null==h?void 0:h.appendInPlace,p=l&&e.itemsMatch(l,u);if(l&&(f||p)){const s=n(e.playingAsset),a=(null==s?void 0:s.media)||e.primaryMedia;if(a){const n="primary"===r?a.currentTime:i(l,r,e.playingAsset,"timelinePos","currentTime"),o=t-n,c=(f?n:a.currentTime)+o;if(c>=0&&(!s||f||c<=s.duration))return void(a.currentTime=c)}}if(u){let n=t;if("primary"!==r){const e=t-u[r].start;n=u.start+e}const i=!e.isInterstitial(u);if(e.isInterstitial(l)&&!l.event.appendInPlace||!i&&!u.event.appendInPlace){if(l){const s=e.findItemIndex(l);if(c>s){const t=e.schedule.findJumpRestrictedIndex(s+1,c);if(t>s)return void e.setSchedulePosition(t)}let a=0;if(i)e.timelinePos=n,e.checkBuffer();else{const e=u.event.assetList,n=t-(u[r]||u).start;for(let t=e.length;t--;){const i=e[t];if(i.duration&&n>=i.startOffset&&n<i.startOffset+i.duration){a=t;break}}}e.setSchedulePosition(c,a)}}else{const t=e.media||(f?null==d?void 0:d.media:null);t&&(t.currentTime=n)}}},o=()=>{const n=e.effectivePlayingItem;if(e.isInterstitial(n))return n;const i=t();return e.isInterstitial(i)?i:null},l={get bufferedEnd(){const n=t(),r=e.bufferingItem;var s;return r&&r===n&&(i(r,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-r.playout.start||(null==(s=e.bufferingAsset)?void 0:s.startOffset))||0},get currentTime(){const t=o(),n=e.effectivePlayingItem;return n&&n===t?i(n,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-n.playout.start:0},set currentTime(t){const n=o(),i=e.effectivePlayingItem;i&&i===n&&a(t+i.playout.start,"playout")},get duration(){const e=o();return e?e.playout.end-e.playout.start:0},get assetPlayers(){var t;const n=null==(t=o())?void 0:t.event.assetList;return n?n.map(t=>e.getAssetPlayer(t.identifier)):[]},get playingIndex(){var t;const n=null==(t=o())?void 0:t.event;return n&&e.effectivePlayingAsset?n.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return o()}};return this.manager={get events(){var t;return(null==(t=e.schedule)||null==(t=t.events)?void 0:t.slice(0))||[]},get schedule(){var t;return(null==(t=e.schedule)||null==(t=t.items)?void 0:t.slice(0))||[]},get interstitialPlayer(){return o()?l:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const n=t();return e.findItemIndex(n)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const t=e.effectivePlayingItem;return e.findItemIndex(t)},primary:{get bufferedEnd(){return r()},get currentTime(){const t=e.timelinePos;return t>0?t:0},set currentTime(e){a(e,"primary")},get duration(){return s("primary")},get seekableStart(){var t;return(null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0}},integrated:{get bufferedEnd(){return i(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return i(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(e){a(e,"integrated")},get duration(){return s("integrated")},get seekableStart(){var t;return((t,n)=>{var i;if(0!==t&&"primary"!==n&&null!=(i=e.schedule)&&i.length){var r;const i=e.schedule.findItemIndexAtTime(t),s=null==(r=e.schedule.items)?void 0:r[i];if(s)return t+(s[n].start-s.start)}return t})((null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0,"integrated")}},skip:()=>{const t=e.effectivePlayingItem,n=null==t?void 0:t.event;if(n&&!n.restrictions.skip){const i=e.findItemIndex(t);if(n.appendInPlace){const e=t.playout.start+t.event.duration;a(e+.001,"playout")}else e.advanceAfterAssetEnded(n,i,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,n=null==(e=this.schedule)?void 0:e.items;return!!(this.playbackStarted&&t&&n)&&this.findItemIndex(t)===n.length-1}get playbackStarted(){return null!==this.effectivePlayingItem}get currentTime(){var e,t;if(null===this.mediaSelection)return;const n=this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&!n.event.appendInPlace)return;let i=this.media;!i&&null!=(e=this.bufferingItem)&&null!=(e=e.event)&&e.appendInPlace&&(i=this.primaryMedia);const r=null==(t=i)?void 0:t.currentTime;return void 0!==r&&wu(r)?r:void 0}get primaryMedia(){var e;return this.media||(null==(e=this.detachedData)?void 0:e.media)||null}isInterstitial(e){return!(null==e||!e.event)}retreiveMediaSource(e,t){const n=this.getAssetPlayer(e);n&&this.transferMediaFromPlayer(n,t)}transferMediaFromPlayer(e,t){const n=e.interstitial.appendInPlace,i=e.media;if(n&&i===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&i)return void(this.detachedData={media:i});const n=e.transferMedia();this.log("transfer MediaSource from ".concat(e," ").concat(_h(n))),this.detachedData=n}else t&&i&&(this.shouldPlay||(this.shouldPlay=!i.paused))}transferMediaTo(e,t){var n,i;if(e.media===t)return;let r=null;const s=this.hls,a=e!==s,o=a&&e.interstitial.appendInPlace,l=null==(n=this.detachedData)?void 0:n.mediaSource;let c;if(s.media)o&&(r=s.transferMedia(),this.detachedData=r),c="Primary";else if(l){const e=this.getBufferingPlayer();e?(r=e.transferMedia(),c="".concat(e)):c="detached MediaSource"}else c="detached media";if(!r)if(l)r=this.detachedData,this.log("using detachedData: MediaSource ".concat(_h(r)));else if(!this.detachedData||s.media===t){const e=this.playerQueue;e.length>1&&e.forEach(e=>{if(a&&e.interstitial.appendInPlace!==o){const t=e.interstitial;this.clearInterstitial(e.interstitial,null),t.appendInPlace=!1,t.appendInPlace&&this.warn("Could not change append strategy for queued assets ".concat(t))}}),this.hls.detachMedia(),this.detachedData={media:t}}const u=r&&"mediaSource"in r&&"closed"!==(null==(i=r.mediaSource)?void 0:i.readyState),d=u&&r?r:t;this.log("".concat(u?"transfering MediaSource":"attaching media"," to ").concat(a?e:"Primary"," from ").concat(c," (media.currentTime: ").concat(t.currentTime,")"));const h=this.schedule;if(d===r&&h){const t=a&&e.assetId===h.assetIdAtEnd;d.overrides={duration:h.duration,endOfStream:!a||t,cueRemoval:!a}}e.attachMedia(d)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=null==e?void 0:e.events;if(!t||this.playbackDisabled||!this.media)return;-1===this.bufferedPos&&(this.bufferedPos=0);const n=this.timelinePos,i=this.effectivePlayingItem;if(-1===n){const n=this.hls.startPosition;if(this.log(sy("checkStart",n)),this.timelinePos=n,t.length&&t[0].cue.pre){const n=e.findEventIndex(t[0].identifier);this.setSchedulePosition(n)}else if(n>=0||!this.primaryLive){const t=this.timelinePos=n>0?n:0,i=e.findItemIndexAtTime(t);this.setSchedulePosition(i)}}else if(i&&!this.playingItem){const t=e.findItemIndex(i);this.setSchedulePosition(t)}}advanceAssetBuffering(e,t){const n=e.event,i=n.findAssetIndex(t),r=Zv(n,i);if(n.isAssetPastPlayoutLimit(r)){if(this.schedule){var s;const t=null==(s=this.schedule.items)?void 0:s[this.findItemIndex(e)+1];t&&this.bufferedToItem(t)}}else this.bufferedToEvent(e,r)}advanceAfterAssetEnded(e,t,n){const i=Zv(e,n);if(e.isAssetPastPlayoutLimit(i)){if(this.schedule){const n=this.schedule.items;if(n){const i=t+1;if(i>=n.length)return void this.setSchedulePosition(-1);const r=e.resumeTime;this.timelinePos<r&&(this.log(sy("advanceAfterAssetEnded",r)),this.timelinePos=r,e.appendInPlace&&this.advanceInPlace(r),this.checkBuffer(this.bufferedPos<r)),this.setSchedulePosition(i)}}}else{if(e.appendInPlace){const t=e.assetList[i];t&&this.advanceInPlace(t.timelineStart)}this.setSchedulePosition(t,i)}}setScheduleToAssetAtTime(e,t){const n=this.schedule;if(!n)return;const i=t.parentIdentifier,r=n.getEvent(i);if(r){const t=n.findEventIndex(i),s=n.findAssetIndex(r,e);this.advanceAfterAssetEnded(r,t,s-1)}}setSchedulePosition(e,t){var n;const i=null==(n=this.schedule)?void 0:n.items;if(!i||this.playbackDisabled)return;const r=e>=0?i[e]:null;this.log("setSchedulePosition ".concat(e,", ").concat(t," (").concat(r?ny(r):r,") pos: ").concat(this.timelinePos));const s=this.waitingItem||this.playingItem,a=this.playingLastItem;if(this.isInterstitial(s)){const n=s.event,c=this.playingAsset,u=null==c?void 0:c.identifier,d=u?this.getAssetPlayer(u):null;if(d&&u&&(!this.eventItemsMatch(s,r)||void 0!==t&&u!==n.assetList[t].identifier)){var o;const t=n.findAssetIndex(c);if(this.log("INTERSTITIAL_ASSET_ENDED ".concat(t+1,"/").concat(n.assetList.length," ").concat($v(c))),this.endedAsset=c,this.playingAsset=null,this.hls.trigger(Ru.INTERSTITIAL_ASSET_ENDED,{asset:c,assetListIndex:t,event:n,schedule:i.slice(0),scheduleIndex:e,player:d}),s!==this.playingItem)return void(this.itemsMatch(s,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(n,this.findItemIndex(this.playingItem),t));this.retreiveMediaSource(u,r),!d.media||null!=(o=this.detachedData)&&o.mediaSource||d.detachMedia()}if(!this.eventItemsMatch(s,r)&&(this.endedItem=s,this.playingItem=null,this.log("INTERSTITIAL_ENDED ".concat(n," ").concat(ny(s))),n.hasPlayed=!0,this.hls.trigger(Ru.INTERSTITIAL_ENDED,{event:n,schedule:i.slice(0),scheduleIndex:e}),n.cue.once)){var l;this.updateSchedule();const e=null==(l=this.schedule)?void 0:l.items;if(r&&e){const n=this.findItemIndex(r);this.advanceSchedule(n,e,t,s,a)}return}}this.advanceSchedule(e,i,t,s,a)}advanceSchedule(e,t,n,i,r){const s=this.schedule;if(!s)return;const a=t[e]||null,o=this.primaryMedia,l=this.playerQueue;if(l.length&&l.forEach(t=>{const n=t.interstitial,i=s.findEventIndex(n.identifier);(i<e||i>e+1)&&this.clearInterstitial(n,a)}),this.isInterstitial(a)){this.timelinePos=Math.min(Math.max(this.timelinePos,a.start),a.end);const r=a.event;if(void 0===n){const t=Zv(r,(n=s.findAssetIndex(r,this.timelinePos))-1);if(r.isAssetPastPlayoutLimit(t)||r.appendInPlace&&this.timelinePos===a.end)return void this.advanceAfterAssetEnded(r,e,n);n=t}const l=this.waitingItem;this.assetsBuffered(a,o)||this.setBufferingItem(a);let c=this.preloadAssets(r,n);if(this.eventItemsMatch(a,l||i)||(this.waitingItem=a,this.log("INTERSTITIAL_STARTED ".concat(ny(a)," ").concat(r.appendInPlace?"append in place":"")),this.hls.trigger(Ru.INTERSTITIAL_STARTED,{event:r,schedule:t.slice(0),scheduleIndex:e})),!r.assetListLoaded)return void this.log("Waiting for ASSET-LIST to complete loading ".concat(r));if(r.assetListLoader&&(r.assetListLoader.destroy(),r.assetListLoader=void 0),!o)return void this.log("Waiting for attachMedia to start Interstitial ".concat(r));this.waitingItem=this.endedItem=null,this.playingItem=a;const u=r.assetList[n];if(!u)return void this.advanceAfterAssetEnded(r,e,n||0);if(c||(c=this.getAssetPlayer(u.identifier)),null===c||c.destroyed){const e=r.assetList.length;this.warn("asset ".concat(n+1,"/").concat(e," player destroyed ").concat(r)),c=this.createAssetPlayer(r,u,n),c.loadSource()}if(!this.eventItemsMatch(a,this.bufferingItem)&&r.appendInPlace&&this.isAssetBuffered(u))return;this.startAssetPlayer(c,n,t,e,o),this.shouldPlay&&ry(c.media)}else a?(this.resumePrimary(a,e,i),this.shouldPlay&&ry(this.hls.media)):r&&this.isInterstitial(i)&&(this.endedItem=null,this.playingItem=i,i.event.appendInPlace||this.attachPrimary(s.durations.primary,null))}get playbackDisabled(){return!1===this.hls.config.enableInterstitialPlayback}get primaryDetails(){var e;return null==(e=this.mediaSelection)?void 0:e.main.details}get primaryLive(){var e;return!(null==(e=this.primaryDetails)||!e.live)}resumePrimary(e,t,n){var i,r;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log("resuming ".concat(ny(e))),null==(i=this.detachedData)||!i.mediaSource){let n=this.timelinePos;(n<e.start||n>=e.end)&&(n=this.getPrimaryResumption(e,t),this.log(sy("resumePrimary",n)),this.timelinePos=n),this.attachPrimary(n,e)}if(!n)return;const s=null==(r=this.schedule)?void 0:r.items;s&&(this.log("INTERSTITIALS_PRIMARY_RESUMED ".concat(ny(e))),this.hls.trigger(Ru.INTERSTITIALS_PRIMARY_RESUMED,{schedule:s.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const n=e.start;if(this.primaryLive){const e=this.primaryDetails;if(0===t)return this.hls.startPosition;if(e&&(n<e.fragmentStart||n>e.edge))return this.hls.liveSyncPosition||-1}return n}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);if(null!=t&&t.hls)return t.hls.bufferedToEnd;return _f.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,n){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const i=this.primaryMedia;if(!i)return;const r=this.hls;r.media?this.checkBuffer():(this.transferMediaTo(r,i),n&&this.startLoadingPrimaryAt(e,n)),n||(this.log(sy("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,n))}startLoadingPrimaryAt(e,t){var n;const i=this.hls;!i.loadingEnabled||!i.media||Math.abs(((null==(n=i.mainForwardBufferInfo)?void 0:n.start)||i.media.currentTime)-e)>.5?i.startLoad(e,t):i.bufferingEnabled||i.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),null==(e=this.schedule)||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(Ru.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(Ru.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(-1===t.level||!this.schedule)return;const n=this.hls.levels[t.level];if(!n.details)return;const i=Gu(Gu({},this.mediaSelection||this.altSelection),{},{main:n});this.mediaSelection=i,this.schedule.parseInterstitialDateRanges(i,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const n=this.hls.audioTracks[t.id],i=this.mediaSelection;if(!i)return void(this.altSelection=Gu(Gu({},this.altSelection),{},{audio:n}));const r=Gu(Gu({},i),{},{audio:n});this.mediaSelection=r}onSubtitleTrackUpdated(e,t){const n=this.hls.subtitleTracks[t.id],i=this.mediaSelection;if(!i)return void(this.altSelection=Gu(Gu({},this.altSelection),{},{subtitles:n}));const r=Gu(Gu({},i),{},{subtitles:n});this.mediaSelection=r}onAudioTrackSwitching(e,t){const n=Sh(t);this.playerQueue.forEach(e=>{let{hls:i}=e;return i&&(i.setAudioOption(t)||i.setAudioOption(n))})}onSubtitleTrackSwitch(e,t){const n=Sh(t);this.playerQueue.forEach(e=>{let{hls:i}=e;return i&&(i.setSubtitleOption(t)||-1!==t.id&&i.setSubtitleOption(n))})}onBufferCodecs(e,t){const n=t.tracks;n&&(this.requiredTracks=n)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const n=this.playingItem;if(n&&!this.itemsMatch(n,this.bufferingItem)&&!this.isInterstitial(n)){const e=this.timelinePos;this.bufferedPos=e,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let e=0;e<t.length;e++){const i=t[e];if(i.cue.post){var n;const e=this.schedule.findEventIndex(i.identifier),t=null==(n=this.schedule.items)?void 0:n[e];this.isInterstitial(t)&&this.eventItemsMatch(t,this.bufferingItem)&&this.bufferedToItem(t,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const e=this.findItemIndex(t);this.setSchedulePosition(e+1)}else this.shouldPlay=!1}updateItem(e,t){var n;const i=null==(n=this.schedule)?void 0:n.items;if(e&&i){return i[this.findItemIndex(e,t)]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((t,n)=>{e.event.isAssetPastPlayoutLimit(n)&&this.clearAssetPlayer(t.identifier,null)});const n=e.end+.25,i=_f.bufferInfo(this.primaryMedia,n,0);if(i.end>n||(i.nextStart||0)>n){this.log("trim buffered interstitial ".concat(ny(e)," (was ").concat(ny(t),")"));const i=!0;this.attachPrimary(n,null,i),this.flushFrontBuffer(n)}}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var n;return!!t&&(e===t||e.event.identifier===(null==(n=t.event)?void 0:n.identifier))}findItemIndex(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}updateSchedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;const n=this.mediaSelection;n&&(null==(t=this.schedule)||t.updateSchedule(n,[],e))}checkBuffer(e){var t;const n=null==(t=this.schedule)?void 0:t.items;if(!n)return;const i=_f.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=i.len<1),this.updateBufferedPos(i.end,n,e)}updateBufferedPos(e,t,n){const i=this.schedule,r=this.bufferingItem;if(this.bufferedPos>e||!i)return;if(1===t.length&&this.itemsMatch(t[0],r))return void(this.bufferedPos=e);const s=this.playingItem,a=this.findItemIndex(s);let o=i.findItemIndexAtTime(e);if(this.bufferedPos<e){var l;const n=this.findItemIndex(r),i=Math.min(n+1,t.length-1),s=t[i];if((-1===o&&r&&e>=r.end||null!=(l=s.event)&&l.appendInPlace&&e+.01>=s.start)&&(o=i),this.isInterstitial(r)){const e=r.event;if(i-a>1&&!1===e.appendInPlace)return;if(0===e.assetList.length&&e.assetListLoader)return}if(this.bufferedPos=e,o>n&&o>a)this.bufferedToItem(s);else{const t=this.primaryDetails;this.primaryLive&&t&&e>t.edge-t.targetduration&&s.start<t.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(s)&&this.preloadAssets(s.event,0)}}else n&&s&&!this.itemsMatch(s,r)&&(o===a?this.bufferedToItem(s):o===a+1&&this.bufferedToItem(t[o]))}assetsBuffered(e,t){return 0!==e.event.assetList.length&&!e.event.assetList.some(e=>{const n=this.getAssetPlayer(e.identifier);return!(null!=n&&n.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,n=this.schedule;if(!this.itemsMatch(e,t)&&n){const{items:i,events:r}=n;if(!i||!r)return t;const s=this.isInterstitial(e),a=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const o=a?a.remaining:t?t.end-this.timelinePos:0;if(this.log("INTERSTITIALS_BUFFERED_TO_BOUNDARY ".concat(ny(e))+(t?" (".concat(o.toFixed(2)," remaining)"):"")),!this.playbackDisabled)if(s){const t=n.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((e,n)=>{const i=this.getAssetPlayer(e.identifier);i&&(n===t&&i.loadSource(),i.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(e=>e.pauseBuffering());this.hls.trigger(Ru.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:r.slice(0),schedule:i.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return t}bufferedToItem(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.setBufferingItem(e);if(!this.playbackDisabled)if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(null!==n){this.bufferingAsset=null;const t=this.detachedData;if(t)if(t.mediaSource){const t=!0;this.attachPrimary(e.start,e,t)}else this.preloadPrimary(e);else this.preloadPrimary(e)}}preloadPrimary(e){const t=this.findItemIndex(e),n=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(n)}bufferedToEvent(e,t){const n=e.event,i=0===n.assetList.length&&!n.assetListLoader,r=n.cue.once;if(i||!r){const e=this.preloadAssets(n,t);if(null!=e&&e.interstitial.appendInPlace){const t=this.primaryMedia;t&&this.bufferAssetPlayer(e,t)}}}preloadAssets(e,t){const n=e.assetUrl,i=e.assetList.length,r=0===i&&!e.assetListLoader,s=e.cue.once;if(r){const r=e.timelineStart;if(e.appendInPlace){var a;const t=this.playingItem;this.isInterstitial(t)||(null==t||null==(a=t.nextEvent)?void 0:a.identifier)!==e.identifier||this.flushFrontBuffer(r+.25)}let s,o=0;if(!this.playingItem&&this.primaryLive&&(o=this.hls.startPosition,-1===o&&(o=this.hls.liveSyncPosition||0)),o&&!e.cue.pre&&!e.cue.post){const e=o-r;e>0&&(s=Math.round(1e3*e)/1e3)}if(this.log("Load interstitial asset ".concat(t+1,"/").concat(n?1:i," ").concat(e).concat(s?" live-start: ".concat(o," start-offset: ").concat(s):"")),n)return this.createAsset(e,0,0,r,e.duration,n);const l=this.assetListLoader.loadAssetList(e,s);l&&(e.assetListLoader=l)}else if(!s&&i){for(let r=t;r<i;r++){const t=e.assetList[r],n=this.getAssetPlayerQueueIndex(t.identifier);-1!==n&&!this.playerQueue[n].destroyed||t.error||this.createAssetPlayer(e,t,r)}const n=e.assetList[t];if(n){const e=this.getAssetPlayer(n.identifier);return e&&e.loadSource(),e}}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log("Removing front buffer starting at ".concat(e));Object.keys(t).forEach(t=>{this.hls.trigger(Ru.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:t})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let n=0;n<t.length;n++)if(e===t[n].assetId)return n;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t)for(let n=0;n<e.length;n++)if(e[n].media===t)return e[n];return null}createAsset(e,t,n,i,r,s){const a={parentIdentifier:e.identifier,identifier:Kv(e,s,t),duration:r,startOffset:n,timelineStart:i,uri:s};return this.createAssetPlayer(e,a,t)}createAssetPlayer(e,t,n){const i=this.hls,r=i.userConfig;let s=r.videoPreference;const a=i.loadLevelObj||i.levels[i.currentLevel];(s||a)&&(s=Hu({},s),a.videoCodec&&(s.videoCodec=a.videoCodec),a.videoRange&&(s.allowedVideoRanges=[a.videoRange]));const o=i.audioTracks[i.audioTrack],l=i.subtitleTracks[i.subtitleTrack];let c=0;if(this.primaryLive||e.appendInPlace){const e=this.timelinePos-t.timelineStart;if(e>1){const n=t.duration;n&&e<n&&(c=e)}}const u=t.identifier,d=Gu(Gu({},r),{},{maxMaxBufferLength:Math.min(180,i.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:i.sessionId,assetPlayerId:u,abrEwmaDefaultEstimate:i.bandwidthEstimate,interstitialsController:void 0,startPosition:c,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:s,audioPreference:o||r.audioPreference,subtitlePreference:l||r.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(d.timelineOffset=t.timelineStart));const h=d.cmcd;null!=h&&h.sessionId&&h.contentId&&(d.cmcd=Hu({},h,{contentId:jv(t.uri)})),this.getAssetPlayer(u)&&this.warn("Duplicate date range identifier ".concat(e," and asset ").concat(u));const f=new ey(this.HlsPlayerClass,d,e,t);this.playerQueue.push(f),e.assetList[n]=t;let p=!0;const m=i=>{if(i.live){var r;const t=new Error("Interstitials MUST be VOD assets ".concat(e)),i={fatal:!0,type:Au.OTHER_ERROR,details:Cu.INTERSTITIAL_ASSET_ITEM_ERROR,error:t},s=(null==(r=this.schedule)?void 0:r.findEventIndex(e.identifier))||-1;return void this.handleAssetItemError(i,e,s,n,t.message)}const s=i.edge-i.fragmentStart,a=t.duration;(p||null===a||s>a)&&(p=!1,this.log('Interstitial asset "'.concat(u,'" duration change ').concat(a," > ").concat(s)),t.duration=s,this.updateSchedule())};f.on(Ru.LEVEL_UPDATED,(e,t)=>{let{details:n}=t;return m(n)}),f.on(Ru.LEVEL_PTS_UPDATED,(e,t)=>{let{details:n}=t;return m(n)}),f.on(Ru.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const g=(e,t)=>{const n=this.getAssetPlayer(u);if(n&&t.tracks){n.off(Ru.BUFFER_CODECS,g),n.tracks=t.tracks;const e=this.primaryMedia;this.bufferingAsset===n.assetItem&&e&&!n.media&&this.bufferAssetPlayer(n,e)}};f.on(Ru.BUFFER_CODECS,g);f.on(Ru.BUFFERED_TO_END,()=>{var n;const i=this.getAssetPlayer(u);if(this.log("buffered to end of asset ".concat(i)),!i||!this.schedule)return;const r=this.schedule.findEventIndex(e.identifier),s=null==(n=this.schedule.items)?void 0:n[r];this.isInterstitial(s)&&this.advanceAssetBuffering(s,t)});const v=t=>()=>{if(!this.getAssetPlayer(u)||!this.schedule)return;this.shouldPlay=!0;const n=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,n,t)};return f.once(Ru.MEDIA_ENDED,v(n)),f.once(Ru.PLAYOUT_LIMIT_REACHED,v(1/0)),f.on(Ru.ERROR,(t,i)=>{if(!this.schedule)return;const r=this.getAssetPlayer(u);if(i.details===Cu.BUFFER_STALLED_ERROR)return null!=r&&r.appendInPlace?void this.handleInPlaceStall(e):(this.onTimeupdate(),void this.checkBuffer(!0));this.handleAssetItemError(i,e,this.schedule.findEventIndex(e.identifier),n,"Asset player error ".concat(i.error," ").concat(e))}),f.on(Ru.DESTROYING,()=>{if(!this.getAssetPlayer(u)||!this.schedule)return;const t=new Error("Asset player destroyed unexpectedly ".concat(u)),i={fatal:!0,type:Au.OTHER_ERROR,details:Cu.INTERSTITIAL_ASSET_ITEM_ERROR,error:t};this.handleAssetItemError(i,e,this.schedule.findEventIndex(e.identifier),n,t.message)}),this.log("INTERSTITIAL_ASSET_PLAYER_CREATED ".concat($v(t))),this.hls.trigger(Ru.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:n,event:e,player:f}),f}clearInterstitial(e,t){this.clearAssetPlayers(e,t),e.reset()}clearAssetPlayers(e,t){e.assetList.forEach(e=>{this.clearAssetPlayer(e.identifier,t)})}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(-1!==t){this.log('reset asset player "'.concat(e,'" after error'));const n=this.playerQueue[t];this.transferMediaFromPlayer(n,null),n.resetDetails()}}clearAssetPlayer(e,t){const n=this.getAssetPlayerQueueIndex(e);if(-1!==n){const e=this.playerQueue[n];this.log("clear ".concat(e," toSegment: ").concat(t?ny(t):t)),this.transferMediaFromPlayer(e,t),this.playerQueue.splice(n,1),e.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,n,i,r){const{interstitial:s,assetItem:a,assetId:o}=e,l=s.assetList.length,c=this.playingAsset;this.endedAsset=null,this.playingAsset=a,c&&c.identifier===o||(c&&(this.clearAssetPlayer(c.identifier,n[i]),delete c.error),this.log("INTERSTITIAL_ASSET_STARTED ".concat(t+1,"/").concat(l," ").concat($v(a))),this.hls.trigger(Ru.INTERSTITIAL_ASSET_STARTED,{asset:a,assetListIndex:t,event:s,schedule:n.slice(0),scheduleIndex:i,player:e})),this.bufferAssetPlayer(e,r)}bufferAssetPlayer(e,t){var n,i;if(!this.schedule)return;const{interstitial:r,assetItem:s}=e,a=this.schedule.findEventIndex(r.identifier),o=null==(n=this.schedule.items)?void 0:n[a];if(!o)return;e.loadSource(),this.setBufferingItem(o),this.bufferingAsset=s;const l=this.getBufferingPlayer();if(l===e)return;const c=r.appendInPlace;if(c&&!1===(null==l?void 0:l.interstitial.appendInPlace))return;const u=(null==l?void 0:l.tracks)||(null==(i=this.detachedData)?void 0:i.tracks)||this.requiredTracks;if(c&&s!==this.playingAsset){if(!e.tracks)return void this.log("Waiting for track info before buffering ".concat(e));if(u&&!Qu(u,e.tracks)){const t=new Error("Asset ".concat($v(s)," SourceBuffer tracks ('").concat(Object.keys(e.tracks),"') are not compatible with primary content tracks ('").concat(Object.keys(u),"')")),n={fatal:!0,type:Au.OTHER_ERROR,details:Cu.INTERSTITIAL_ASSET_ITEM_ERROR,error:t},i=r.findAssetIndex(s);return void this.handleAssetItemError(n,r,a,i,t.message)}}this.transferMediaTo(e,t)}handleInPlaceStall(e){const t=this.schedule,n=this.primaryMedia;if(!t||!n)return;const i=n.currentTime,r=t.findAssetIndex(e,i),s=e.assetList[r];if(s){const a=this.getAssetPlayer(s.identifier);if(a){const o=a.currentTime||i-s.timelineStart,l=a.duration-o;if(this.warn("Stalled at ".concat(o," of ").concat(o+l," in ").concat(a," ").concat(e," (media.currentTime: ").concat(i,")")),o&&(l/n.playbackRate<.5||a.bufferedInPlaceToEnd(n))&&a.hls){const n=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,n,r)}}}}advanceInPlace(e){const t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}handleAssetItemError(e,t,n,i,r){if(e.details===Cu.BUFFER_STALLED_ERROR)return;const s=t.assetList[i]||null;if(this.warn("INTERSTITIAL_ASSET_ERROR ".concat(s?$v(s):s," ").concat(e.error)),!this.schedule)return;const a=(null==s?void 0:s.identifier)||"",o=this.getAssetPlayerQueueIndex(a),l=this.playerQueue[o]||null,c=this.schedule.items,u=Hu({},e,{fatal:!1,errorAction:qh(!0),asset:s,assetListIndex:i,event:t,schedule:c,scheduleIndex:n,player:l});if(this.hls.trigger(Ru.INTERSTITIAL_ASSET_ERROR,u),!e.fatal)return;const d=this.playingAsset,h=this.bufferingAsset,f=new Error(r);if(s&&(this.clearAssetPlayer(a,null),s.error=f),t.assetList.some(e=>!e.error))for(let p=i;p<t.assetList.length;p++)this.resetAssetPlayer(t.assetList[p].identifier);else t.error=f;this.updateSchedule(!0),t.error?this.primaryFallback(t):d&&d.identifier===a?this.advanceAfterAssetEnded(t,n,i):h&&h.identifier===a&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,h)}primaryFallback(e){const t=e.timelineStart,n=this.effectivePlayingItem;let i=this.timelinePos;if(n){this.log('Fallback to primary from event "'.concat(e.identifier,'" start: ').concat(t," pos: ").concat(i," playing: ").concat(ny(n)," error: ").concat(e.error)),-1===i&&(i=this.hls.startPosition);const r=this.updateItem(n,i);this.itemsMatch(n,r)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t))}else if(-1===i)return void this.checkStart();if(!this.schedule)return;const r=this.schedule.findItemIndexAtTime(i);this.setSchedulePosition(r)}onAssetListLoaded(e,t){var n,i;const r=t.event,s=r.identifier,a=t.assetListResponse.ASSETS;if(null==(n=this.schedule)||!n.hasEvent(s))return;const o=r.timelineStart,l=r.duration;let c=0;a.forEach((e,t)=>{const n=parseFloat(e.DURATION);this.createAsset(r,t,c,o+c,n,e.URI),c+=n}),r.duration=c,this.log("Loaded asset-list with duration: ".concat(c," (was: ").concat(l,") ").concat(r));const u=this.waitingItem,d=(null==u?void 0:u.event.identifier)===s;this.updateSchedule();const h=null==(i=this.bufferingItem)?void 0:i.event;if(d){var f;const e=this.schedule.findEventIndex(s),t=null==(f=this.schedule.items)?void 0:f[e];if(t){if(!this.playingItem&&this.timelinePos>t.end){if(this.schedule.findItemIndexAtTime(this.timelinePos)!==e)return r.error=new Error("Interstitial ".concat(a.length?"no longer within playback range":"asset-list is empty"," ").concat(this.timelinePos," ").concat(r)),this.log(r.error.message),this.updateSchedule(!0),void this.primaryFallback(r)}this.setBufferingItem(t)}this.setSchedulePosition(e)}else if((null==h?void 0:h.identifier)===s){const e=r.assetList[0];if(e){const t=this.getAssetPlayer(e.identifier);if(h.appendInPlace){const e=this.primaryMedia;t&&e&&this.bufferAssetPlayer(t,e)}else t&&t.loadSource()}}}onError(e,t){if(this.schedule)switch(t.details){case Cu.ASSET_LIST_PARSING_ERROR:case Cu.ASSET_LIST_LOAD_ERROR:case Cu.ASSET_LIST_LOAD_TIMEOUT:{const e=t.interstitial;e&&(this.updateSchedule(!0),this.primaryFallback(e));break}case Cu.BUFFER_STALLED_ERROR:{const e=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(e)&&e.event.appendInPlace)return void this.handleInPlaceStall(e.event);this.log("Primary player stall @".concat(this.timelinePos," bufferedPos: ").concat(this.bufferedPos)),this.onTimeupdate(),this.checkBuffer(!0);break}}}}});function u_(e){return e&&"object"===typeof e?Array.isArray(e)?e.map(u_):Object.keys(e).reduce((t,n)=>(t[n]=u_(e[n]),t),{}):e}function d_(e,t){const n=e.loader;if(n!==r_&&n!==l_)t.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1;else{(function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(kne){}return!1})()&&(e.loader=r_,e.progressive=!0,e.enableSoftwareAES=!0,t.log("[config]: Progressive streaming enabled, using FetchLoader"))}}class h_ extends gf{constructor(e,t){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var e;null!=(e=this.media)&&e.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{var e;this.hls&&(this.ended=(null==(e=this.media)?void 0:e.currentTime)||1,this.hls.trigger(Ru.MEDIA_ENDED,{stalled:!1}))},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Ru.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Ru.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(100),this.mediaSource=t.mediaSource;const n=this.media=t.media;Np(n,"playing",this.onMediaPlaying),Np(n,"waiting",this.onMediaWaiting),Np(n,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:n}=this;n&&(Fp(n,"playing",this.onMediaPlaying),Fp(n,"waiting",this.onMediaWaiting),Fp(n,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(null==(e=this.media)||!e.readyState||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var n,i;const r=null==(n=this.hls)?void 0:n.config;if(!r)return;const s=this.media;if(!s)return;const{seeking:a}=s,o=this.seeking&&!a,l=!this.seeking&&a,c=s.paused&&!a||s.ended||0===s.playbackRate;if(this.seeking=a,e!==t)return t&&(this.ended=0),this.moved=!0,a||(this.nudgeRetry=0,r.nudgeOnVideoHole&&!c&&e>t&&this.nudgeOnVideoHole(e,t)),void(0===this.waiting&&this.stallResolved(e));if(l||o)return void(o&&this.stallResolved(e));if(c)return this.nudgeRetry=0,this.stallResolved(e),void(!this.ended&&s.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(Ru.MEDIA_ENDED,{stalled:!1})));if(!_f.getBuffered(s).length)return void(this.nudgeRetry=0);const u=_f.bufferInfo(s,e,0),d=u.nextStart||0,h=this.fragmentTracker;if(a&&h&&this.hls){const t=f_(this.hls.inFlightFragments,e),n=u.len>2,i=!d||t||d-e>2&&!h.getPartialFragment(e);if(n||i)return;this.moved=!1}const f=null==(i=this.hls)?void 0:i.latestLevelDetails;if(!this.moved&&null!==this.stalled&&h){if(!(u.len>0)&&!d)return;const t=Math.max(d,u.start||0)-e,n=!(null==f||!f.live)?2*f.targetduration:2,i=m_(e,h);if(t>0&&(t<=n||i))return void(s.paused||this._trySkipBufferHole(i))}const p=r.detectStallWithCurrentTimeMs,m=self.performance.now(),g=this.waiting;let v=this.stalled;if(null===v){if(!(g>0&&m-g<p))return void(this.stalled=m);v=this.stalled=g}const y=m-v;if(!a&&(y>=p||g)&&this.hls){var _;if("ended"===(null==(_=this.mediaSource)?void 0:_.readyState)&&(null==f||!f.live)&&Math.abs(e-((null==f?void 0:f.edge)||0))<1){if(this.ended)return;return this.ended=e||1,void this.hls.trigger(Ru.MEDIA_ENDED,{stalled:!0})}if(this._reportStall(u),!this.media||!this.hls)return}const b=_f.bufferInfo(s,e,r.maxBufferHole);this._tryFixBufferStall(b,y,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const n=self.performance.now()-t;this.log("playback not stuck anymore @".concat(e,", after ").concat(Math.round(n),"ms")),this.stallReported=!1,this.waiting=0,this.hls.trigger(Ru.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var n;const i=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&null!=(n=this.buffered.audio)&&n.length&&i&&i.length>1&&e>i.end(0)){const n=_f.bufferedInfo(_f.timeRangesToArray(this.buffered.audio),e,0);if(n.len>1&&t>=n.start){const n=_f.timeRangesToArray(i),r=_f.bufferedInfo(n,t,0).bufferedIndex;if(r>-1&&r<n.length-1){const t=_f.bufferedInfo(n,e,0).bufferedIndex,i=n[r].end,s=n[r+1].start;if((-1===t||t>r)&&s-i<1&&e-i<2){const n=new Error("nudging playhead to flush pipeline after video hole. currentTime: ".concat(e," hole: ").concat(i," -> ").concat(s," buffered index: ").concat(t));this.warn(n.message),this.media.currentTime+=1e-6;let r=m_(e,this.fragmentTracker);r&&"fragment"in r?r=r.fragment:r||(r=void 0);const a=_f.bufferInfo(this.media,e,0);this.hls.trigger(Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:n,reason:n.message,frag:r,buffer:a.len,bufferInfo:a})}}}}}_tryFixBufferStall(e,t,n){var i,r;const{fragmentTracker:s,media:a}=this,o=null==(i=this.hls)?void 0:i.config;if(!a||!s||!o)return;const l=null==(r=this.hls)?void 0:r.latestLevelDetails,c=m_(n,s);if(c||null!=l&&l.live&&n<l.fragmentStart){if(this._trySkipBufferHole(c)||!this.media)return}const u=e.buffered,d=this.adjacentTraversal(e,n);(u&&u.length>1&&e.len>o.maxBufferHole||e.nextStart&&(e.nextStart-n<o.maxBufferHole||d))&&(t>1e3*o.highBufferWatchdogPeriod||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const n=this.fragmentTracker,i=e.nextStart;if(n&&i){const e=n.getFragAtPos(t,ku),r=n.getFragAtPos(i,ku);if(e&&r)return r.sn-e.sn<2}return!1}_reportStall(e){const{hls:t,media:n,stallReported:i,stalled:r}=this;if(!i&&null!==r&&n&&t){this.stallReported=!0;const i=new Error("Playback stalling at @".concat(n.currentTime," due to low buffer (").concat(_h(e),")"));this.warn(i.message),t.trigger(Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.BUFFER_STALLED_ERROR,fatal:!1,error:i,buffer:e.len,bufferInfo:e,stalled:{start:r}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:n,media:i}=this,r=null==(t=this.hls)?void 0:t.config;if(!i||!n||!r)return 0;const s=i.currentTime,a=_f.bufferInfo(i,s,0),o=s<a.start?a.start:a.nextStart;if(o&&this.hls){const t=a.len<=r.maxBufferHole,c=a.len>0&&a.len<1&&i.readyState<3,u=o-s;if(u>0&&(t||c)){if(u>r.maxBufferHole){let t=!1;if(0===s){const e=n.getAppendedFrag(0,ku);e&&o<e.end&&(t=!0)}if(!t&&e){var l;if(null==(l=this.hls.loadLevelObj)||!l.details)return 0;if(f_(this.hls.inFlightFragments,o))return 0;let t=!1,i=e.end;for(;i<o;){const e=m_(i,n);if(!e){t=!0;break}i+=e.duration}if(t)return 0}}const t=Math.max(o+.05,s+.1);if(this.warn("skipping hole, adjusting currentTime from ".concat(s," to ").concat(t)),this.moved=!0,i.currentTime=t,null==e||!e.gap){const n=new Error("fragment loaded with buffer holes, seeking from ".concat(s," to ").concat(t)),i={type:Au.MEDIA_ERROR,details:Cu.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:n,reason:n.message,buffer:a.len,bufferInfo:a};e&&("fragment"in e?i.part=e:i.frag=e),this.hls.trigger(Ru.ERROR,i)}return t}}return 0}_tryNudgeBuffer(e){const{hls:t,media:n,nudgeRetry:i}=this,r=null==t?void 0:t.config;if(!n||!r)return 0;const s=n.currentTime;if(this.nudgeRetry++,i<r.nudgeMaxRetry){const a=s+(i+1)*r.nudgeOffset,o=new Error("Nudging 'currentTime' from ".concat(s," to ").concat(a));this.warn(o.message),n.currentTime=a,t.trigger(Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1,buffer:e.len,bufferInfo:e})}else{const n=new Error("Playhead still not moving while enough data buffered @".concat(s," after ").concat(r.nudgeMaxRetry," nudges"));this.error(n.message),t.trigger(Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.BUFFER_STALLED_ERROR,error:n,fatal:!0,buffer:e.len,bufferInfo:e})}}}function f_(e,t){const n=p_(e.main);if(n&&n.start<=t)return n;const i=p_(e.audio);return i&&i.start<=t?i:null}function p_(e){if(!e)return null;switch(e.state){case Hp:case Up:case Xp:case Kp:return null}return e.frag}function m_(e,t){return t.getAppendedFrag(e,ku)||t.getPartialFragment(e)}function g_(){if("undefined"!==typeof self)return self.VTTCue||self.TextTrackCue}function v_(e,t,n,i,r){let s=new e(t,n,"");try{s.value=i,r&&(s.type=r)}catch(kne){s=new e(t,n,_h(r?Gu({type:r},i):i))}return s}const y_=(()=>{const e=g_();try{e&&new e(0,Number.POSITIVE_INFINITY,"")}catch(kne){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class __{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(Ru.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(Ru.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Ru.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(Ru.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Ru.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(Ru.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(Ru.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Ru.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(Ru.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Ru.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(Ru.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,t){var n;this.media=t.media,!1===(null==(n=t.overrides)?void 0:n.cueRemoval)&&(this.removeCues=!1)}onMediaAttached(){var e;const t=null==(e=this.hls)?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(e,t){this.media=null;!!t.transferMedia||(this.id3Track&&(this.removeCues&&Gv(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if("metadata"===n.kind&&"id3"===n.label)return Hv(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:n,enableID3MetadataCues:i}=this.hls.config;if(!n&&!i)return;const{samples:r}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const s=g_();if(s)for(let a=0;a<r.length;a++){const e=r[a].type;if(e===Am.emsg&&!n||!i)continue;const t=Em(r[a].data),o=r[a].pts;let l=o+r[a].duration;l>y_&&(l=y_);l-o<=0&&(l=o+.25);for(let n=0;n<t.length;n++){const i=t[n];if(!wm(i)){this.updateId3CueEnds(o,e);const t=v_(s,o,l,i,e);t&&this.id3Track.addCue(t)}}}}updateId3CueEnds(e,t){var n;const i=null==(n=this.id3Track)?void 0:n.cues;if(i)for(let r=i.length;r--;){const n=i[r];n.type===t&&n.startTime<e&&n.endTime===y_&&(n.endTime=e)}}onBufferFlushing(e,t){let{startOffset:n,endOffset:i,type:r}=t;const{id3Track:s,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:l}}=a;if(s&&(o||l)){let e;e="audio"===r?e=>e.type===Am.audioId3&&l:"video"===r?e=>e.type===Am.emsg&&o:e=>e.type===Am.audioId3&&l||e.type===Am.emsg&&o,Vv(s,n,i,e)}}onLevelUpdated(e,t){let{details:n}=t;this.updateDateRangeCues(n,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.hls||!this.media)return;const{assetPlayerId:n,timelineOffset:i,enableDateRangeMetadataCues:r,interstitialsController:s}=this.hls.config;if(!r)return;const a=g_();if(n&&i&&!s){const{fragmentStart:t,fragmentEnd:i}=e;let r=this.assetCue;r?(r.startTime=t,r.endTime=i):a&&(r=this.assetCue=v_(a,t,i,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),r&&(r.id=n,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(r),r.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:o}=this,{dateRanges:l}=e,c=Object.keys(l);let u=this.dateRangeCuesAppended;var d;if(o&&t)if(null!=(d=o.cues)&&d.length){const e=Object.keys(u).filter(e=>!c.includes(e));for(let t=e.length;t--;){var h;const n=e[t],i=null==(h=u[n])?void 0:h.cues;delete u[n],i&&Object.keys(i).forEach(e=>{const t=i[e];if(t){t.removeEventListener("enter",this.onEventCueEnter);try{o.removeCue(t)}catch(kne){}}})}}else u=this.dateRangeCuesAppended={};const f=e.fragments[e.fragments.length-1];if(0!==c.length&&wu(null==f?void 0:f.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let e=0;e<c.length;e++){const t=c[e],n=l[t],i=n.startTime,r=u[t],o=(null==r?void 0:r.cues)||{};let d=(null==r?void 0:r.durationKnown)||!1,h=y_;const{duration:f,endDate:p}=n;if(p&&null!==f)h=i+f,d=!0;else if(n.endOnNext&&!d){const e=c.reduce((e,t)=>{if(t!==n.id){const i=l[t];if(i.class===n.class&&i.startDate>n.startDate&&(!e||n.startDate<e.startDate))return i}return e},null);e&&(h=e.startTime,d=!0)}const m=Object.keys(n.attr);for(let e=0;e<m.length;e++){const l=m[e];if(!Cf(l))continue;const c=o[l];if(c)!d||null!=r&&r.durationKnown?Math.abs(c.startTime-i)>.01&&(c.startTime=i,c.endTime=h):c.endTime=h;else if(a){let e=n.attr[l];Rf(l)&&(e=ed(e));const r=v_(a,i,h,{key:l,data:e},Am.dateRange);r&&(r.id=t,this.id3Track.addCue(r),o[l]=r,s&&("X-ASSET-LIST"!==l&&"X-ASSET-URL"!==l||r.addEventListener("enter",this.onEventCueEnter)))}}u[t]={cues:o,dateRange:n,durationKnown:d}}}}}class b_{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:e}=this,t=this.levelDetails;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(null===n)return;this._latency=n;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:r}=this.config;if(!i||1===r||!t.live)return;const s=this.targetLatency;if(null===s)return;const a=n-s;if(a<Math.min(this.maxLatency,s+t.targetduration)&&a>.05&&this.forwardBufferLength>1){const t=Math.min(2,Math.max(1,r)),n=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20,i=Math.min(t,Math.max(1,n));this.changeMediaPlaybackRate(e,i)}else 1!==e.playbackRate&&0!==e.playbackRate&&this.changeMediaPlaybackRate(e,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return(null==(e=this.hls)?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(void 0!==e.liveMaxLatencyDuration)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(null===e||null===this.hls)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:r,liveSyncDurationCount:s,lowLatencyMode:a}=this.config,o=this.hls.userConfig;let l=a&&n||t;(this._targetLatencyUpdated||o.liveSyncDuration||o.liveSyncDurationCount||0===l)&&(l=void 0!==r?r:s*i);const c=i;return l+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,c)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(null===e||null===t)return null;const n=this.levelDetails;if(null===n)return null;const i=n.edge,r=e-t-this.edgeStalled,s=i-n.totalduration,a=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(s,r),a)}get drift(){const e=this.levelDetails;return null===e?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(null===e)return 0;const t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Ru.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(Ru.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(Ru.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Ru.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Ru.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(Ru.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,t){let{details:n}=t;n.advanced&&this.onTimeupdate(),!n.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var n;t.details===Cu.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&null!=(n=this.levelDetails)&&n.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var n,i;e.playbackRate!==t&&(null==(n=this.hls)||n.logger.debug("[latency-controller]: latency=".concat(this.latency.toFixed(3),", targetLatency=").concat(null==(i=this.targetLatency)?void 0:i.toFixed(3),", forwardBufferLength=").concat(this.forwardBufferLength.toFixed(3),": adjusting playback rate from ").concat(e.playbackRate," to ").concat(t)),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return null===e?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}class x_ extends Rg{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Ru.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Ru.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Ru.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Ru.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Ru.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Ru.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Ru.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Ru.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Ru.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Ru.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(e=>{e.loadError=0,e.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,i=[],r={},s={};let a=!1,o=!1,l=!1;t.levels.forEach(e=>{const t=e.attrs;let{audioCodec:c,videoCodec:u}=e;c&&(e.audioCodec=c=Jd(c,n)||void 0),u&&(u=e.videoCodec=function(e){const t=e.split(",");for(let n=0;n<t.length;n++){const e=t[n].split(".");e.length>2&&"avc1"===e[0]&&(t[n]="avc1.".concat(parseInt(e[1]).toString(16)).concat(("000"+parseInt(e[2]).toString(16)).slice(-4)))}return t.join(",")}(u));const{width:d,height:h,unknownCodecs:f}=e,p=(null==f?void 0:f.length)||0;if(a||(a=!(!d||!h)),o||(o=!!u),l||(l=!!c),p||c&&!this.isAudioSupported(c)||u&&!this.isVideoSupported(u))return void this.log('Some or all CODECS not supported "'.concat(t.CODECS,'"'));const{CODECS:m,"FRAME-RATE":g,"HDCP-LEVEL":v,"PATHWAY-ID":y,RESOLUTION:_,"VIDEO-RANGE":b}=t,x="".concat(y||".","-"),S="".concat(x).concat(e.bitrate,"-").concat(_,"-").concat(g,"-").concat(m,"-").concat(b,"-").concat(v);if(r[S])if(r[S].uri===e.url||e.attrs["PATHWAY-ID"])r[S].addGroupId("audio",t.AUDIO),r[S].addGroupId("text",t.SUBTITLES);else{const t=s[S]+=1;e.attrs["PATHWAY-ID"]=new Array(t+1).join(".");const n=this.createLevel(e);r[S]=n,i.push(n)}else{const t=this.createLevel(e);r[S]=t,s[S]=1,i.push(t)}}),this.filterAndSortMediaOptions(i,t,a,o,l)}createLevel(e){const t=new gh(e),n=e.supplemental;if(null!=n&&n.videoCodec&&!this.isVideoSupported(n.videoCodec)){const e=new Error('SUPPLEMENTAL-CODECS not supported "'.concat(n.videoCodec,'"'));this.log(e.message),t.supportedResult=rh(e,[])}return t}isAudioSupported(e){return Vd(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return Vd(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,n,i,r){var s;let a=[],o=[],l=e;const c=(null==(s=t.stats)?void 0:s.parsing)||{};if((n||i)&&r&&(l=l.filter(e=>{let{videoCodec:t,videoRange:n,width:i,height:r}=e;return(!!t||!(!i||!r))&&(!!(s=n)&&uh.indexOf(s)>-1);var s})),0===l.length)return Promise.resolve().then(()=>{if(this.hls){let e="no level with compatible codecs found in manifest",n=e;t.levels.length&&(n="one or more CODECS in variant not supported: ".concat(_h(t.levels.map(e=>e.attrs.CODECS).filter((e,t,n)=>n.indexOf(e)===t))),this.warn(n),e+=" (".concat(n,")"));const i=new Error(e);this.hls.trigger(Ru.ERROR,{type:Au.MEDIA_ERROR,details:Cu.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:i,reason:n})}}),void(c.end=performance.now());t.audioTracks&&(a=t.audioTracks.filter(e=>!e.audioCodec||this.isAudioSupported(e.audioCodec)),S_(a)),t.subtitles&&(o=t.subtitles,S_(o));const u=l.slice(0);l.sort((e,t)=>{if(e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"])return(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&e.height!==t.height)return e.height-t.height;if(e.frameRate!==t.frameRate)return e.frameRate-t.frameRate;if(e.videoRange!==t.videoRange)return uh.indexOf(e.videoRange)-uh.indexOf(t.videoRange);if(e.videoCodec!==t.videoCodec){const n=Yd(e.videoCodec),i=Yd(t.videoCodec);if(n!==i)return i-n}if(e.uri===t.uri&&e.codecSet!==t.codecSet){const n=Xd(e.codecSet),i=Xd(t.codecSet);if(n!==i)return i-n}return e.averageBitrate!==t.averageBitrate?e.averageBitrate-t.averageBitrate:0});let d=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==u.length))for(let v=0;v<u.length;v++)if(u[v].pathwayId===l[0].pathwayId){d=u[v];break}this._levels=l;for(let v=0;v<l.length;v++)if(l[v]===d){var h;this._firstLevel=v;const e=d.bitrate,t=this.hls.bandwidthEstimate;if(this.log("manifest loaded, ".concat(l.length," level(s) found, first bitrate: ").concat(e)),void 0===(null==(h=this.hls.userConfig)?void 0:h.abrEwmaDefaultEstimate)){const n=Math.min(e,this.hls.config.abrEwmaDefaultEstimateMax);n>t&&t===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=n)}break}const f=r&&!i,p=this.hls.config,m=!(!p.audioStreamController||!p.audioTrackController),g={levels:l,audioTracks:a,subtitleTracks:o,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:r,video:i,altAudio:m&&!f&&a.some(e=>!!e.url)};c.end=performance.now(),this.hls.trigger(Ru.MANIFEST_PARSED,g)}get levels(){return 0===this._levels.length?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){const n=new Error("invalid level idx"),i=e<0;if(this.hls.trigger(Ru.ERROR,{type:Au.OTHER_ERROR,details:Cu.LEVEL_SWITCH_ERROR,level:e,fatal:i,error:n,reason:n.message}),i)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,r=i?i.attrs["PATHWAY-ID"]:void 0,s=t[e],a=s.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=s,n===e&&i&&r===a)return;this.log("Switching to level ".concat(e," (").concat(s.height?s.height+"p ":"").concat(s.videoRange?s.videoRange+" ":"").concat(s.codecSet?s.codecSet+" ":"","@").concat(s.bitrate,")").concat(a?" with Pathway "+a:""," from level ").concat(n).concat(r?" with Pathway "+r:""));const o={level:e,attrs:s.attrs,details:s.details,bitrate:s.bitrate,averageBitrate:s.averageBitrate,maxBitrate:s.maxBitrate,realBitrate:s.realBitrate,width:s.width,height:s.height,codecSet:s.codecSet,audioCodec:s.audioCodec,videoCodec:s.videoCodec,audioGroups:s.audioGroups,subtitleGroups:s.subtitleGroups,loaded:s.loaded,loadError:s.loadError,fragmentError:s.fragmentError,name:s.name,id:s.id,uri:s.uri,url:s.url,urlId:0,audioGroupIds:s.audioGroupIds,textGroupIds:s.textGroupIds};this.hls.trigger(Ru.LEVEL_SWITCHING,o);const l=s.details;if(!l||l.live){const e=this.switchParams(s.uri,null==i?void 0:i.details,l);this.loadPlaylist(e)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0===this._startLevel){const e=this.hls.config.startLevel;return void 0!==e?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),n=e.filter(e=>-1!==t.indexOf(e));if(e.length<1)return void this.warn("pathwayPriority ".concat(e," should contain at least one pathway from list: ").concat(t));this.steering.pathwayPriority=n}}onError(e,t){!t.fatal&&t.context&&t.context.type===Pu&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,t){let{frag:n}=t;if(void 0!==n&&n.type===ku){const e=n.elementaryStreams;if(!Object.keys(e).some(t=>!!e[t]))return;const t=this._levels[n.level];null!=t&&t.loadError&&(this.log("Resetting level error count of ".concat(t.loadError," on frag buffered")),t.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:r}=t,s=t.levelInfo;var a;if(!s)return this.warn("Invalid level index ".concat(i)),void(null!=(a=t.deliveryDirectives)&&a.skip&&(r.deltaUpdateFailed=!0));if(s===this.currentLevel||t.withoutMultiVariant){0===s.fragmentError&&(s.loadError=0);let e=s.details;e===t.details&&e.advanced&&(e=void 0),this.playlistLoaded(i,t,e)}else null!=(n=t.deliveryDirectives)&&n.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=this.getUrlWithDirectives(e.uri,t),i=this.currentLevelIndex,r=e.attrs["PATHWAY-ID"],s=e.details,a=null==s?void 0:s.age;this.log("Loading level index ".concat(i).concat(void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:"").concat(r?" Pathway "+r:"").concat(a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""," ").concat(n)),this.hls.trigger(Ru.LEVEL_LOADING,{url:n,level:i,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(1===this._levels.length)return;const n=this._levels.filter((t,n)=>n!==e||(this.steering&&this.steering.removeLevel(t),t===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,t.details&&t.details.fragments.forEach(e=>e.level=-1)),!1));Cp(n),this._levels=n,this.currentLevelIndex>-1&&null!=(t=this.currentLevel)&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const i=n.length-1;this._firstLevel=Math.min(this._firstLevel,i),this._startLevel&&(this._startLevel=Math.min(this._startLevel,i)),this.hls.trigger(Ru.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,t){let{levels:n}=t;this._levels=n}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(Ru.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function S_(e){const t={};e.forEach(e=>{const n=e.groupId||"";e.id=t[n]=t[n]||0,t[n]++})}function E_(){return self.SourceBuffer||self.WebKitSourceBuffer}function w_(){if(!Ju())return!1;const e=E_();return!e||e.prototype&&"function"===typeof e.prototype.appendBuffer&&"function"===typeof e.prototype.remove}class T_ extends Qp{constructor(e,t,n){super(e,t,n,"stream-controller",ku),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const e=this.media,t=e?e.currentTime:null;if(null===t||!wu(t))return;if(this.log("Media seeked to ".concat(t.toFixed(3))),!this.getBufferedFrag(t))return;const n=this.getFwdBufferInfoAtPos(e,t,ku,0);null!==n&&0!==n.len?this.tick():this.warn("Main forward buffer length at ".concat(t,' on "seeked" event ').concat(n?n.len:"empty",")"))},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(Ru.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Ru.LEVEL_LOADING,this.onLevelLoading,this),e.on(Ru.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Ru.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(Ru.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(Ru.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(Ru.BUFFER_CREATED,this.onBufferCreated,this),e.on(Ru.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(Ru.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Ru.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(Ru.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Ru.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Ru.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(Ru.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(Ru.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(Ru.BUFFER_CREATED,this.onBufferCreated,this),e.off(Ru.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(Ru.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Ru.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:n,hls:i}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let e=i.startLevel;-1===e&&(i.config.testBandwidth&&this.levels.length>1?(e=0,this.bitrateTest=!0):e=i.firstAutoLevel),i.nextLoadLevel=e,this.level=i.loadLevel,this._hasEnoughToStart=!!t}n>0&&-1===e&&!t&&(this.log("Override startPosition with lastCurrentTime @".concat(n.toFixed(3))),e=n),this.state=Hp,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=Up}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Jp:{const{levels:e,level:t}=this,n=null==e?void 0:e[t],i=null==n?void 0:n.details;if(i&&(!i.live||this.levelLastLoaded===n&&!this.waitForLive(n))){if(this.waitForCdnTuneIn(i))break;this.state=Hp;break}if(this.hls.nextLoadLevel!==this.level){this.state=Hp;break}break}case Vp:this.checkRetryDate()}this.state===Hp&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),null!=(e=this.media)&&e.readyState&&!1===this.media.seeking&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this;if(null===t||!i&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;const r=this.buffering?e.nextLoadLevel:e.loadLevel;if(null==n||!n[r])return;const s=n[r],a=this.getMainFwdBufferInfo();if(null===a)return;const o=this.getLevelDetails();if(o&&this._streamEnded(a,o)){const e={};return 2===this.altAudio&&(e.type="video"),this.hls.trigger(Ru.BUFFER_EOS,e),void(this.state=Xp)}if(!this.buffering)return;e.loadLevel!==r&&-1===e.manualLevel&&this.log("Adapting to level ".concat(r," from level ").concat(this.level)),this.level=e.nextLoadLevel=r;const l=s.details;if(!l||this.state===Jp||this.waitForLive(s))return this.level=r,this.state=Jp,void(this.startFragRequested=!1);const c=a.len,u=this.getMaxBufferLength(s.maxBitrate);if(c>=u)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const d=this.backtrackFragment?this.backtrackFragment.start:a.end;let h=this.getNextFragment(d,l);if(this.couldBacktrack&&!this.fragPrevious&&h&&ud(h)&&this.fragmentTracker.getState(h)!==$h){var f;const e=(null!=(f=this.backtrackFragment)?f:h).sn-l.startSN,t=l.fragments[e-1];t&&h.cc===t.cc&&(h=t,this.fragmentTracker.removeFragment(t))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(h&&this.isLoopLoading(h,d)){if(!h.gap){const e=this.audioOnly&&!this.altAudio?ad:od,t=(e===od?this.videoBuffer:this.mediaBuffer)||this.media;t&&this.afterBufferFlushed(t,e,ku)}h=this.getNextFragmentLoopLoading(h,l,a,ku,u)}h&&(!h.initSegment||h.initSegment.data||this.bitrateTest||(h=h.initSegment),this.loadFragment(h,s,d))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);i===Jh||i===Zh?ud(e)?this.bitrateTest?(this.log("Fragment ".concat(e.sn," of level ").concat(e.level," is being downloaded to test bitrate and will not be buffered")),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,n):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,ku)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(null!=t&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const r=this.getLevelDetails();if(null!=r&&r.live){const e=this.getMainFwdBufferInfo();if(!e||e.len<2*r.targetduration)return}if(!t.paused&&e){const t=e[this.hls.nextLoadLevel],i=this.fragLastKbps;n=i&&this.fragCurrent?this.fragCurrent.duration*t.maxBitrate/(1e3*i)+1:0}else n=0;const s=this.getBufferedFrag(t.currentTime+n);if(s){const e=this.followingBufferedFrag(s);if(e){this.abortCurrentFrag();const t=e.maxStartPTS?e.maxStartPTS:e.start,n=e.duration,i=Math.max(s.end,t+Math.min(Math.max(n-this.config.maxFragLookUpTolerance,n*(this.couldBacktrack?.5:.125)),n*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(i,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case zp:case Gp:case Vp:case jp:case Yp:this.state=Hp}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,2===this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;Np(n,"playing",this.onMediaPlaying),Np(n,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:n}=this;n&&(Fp(n,"playing",this.onMediaPlaying),Fp(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t);!!t.transferMedia||(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(Ru.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let n=!1,i=!1;for(let r=0;r<t.levels.length;r++){const e=t.levels[r].audioCodec;e&&(n=n||-1!==e.indexOf("mp4a.40.2"),i=i||-1!==e.indexOf("mp4a.40.5"))}this.audioCodecSwitch=n&&i&&!function(){var e;const t=E_();return"function"===typeof(null==t||null==(e=t.prototype)?void 0:e.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==Hp)return;const i=t.levelInfo;(!i.details||i.details.live&&(this.levelLastLoaded!==i||i.details.expired)||this.waitForCdnTuneIn(i.details))&&(this.state=Jp)}onLevelLoaded(e,t){var n;const{levels:i,startFragRequested:r}=this,s=t.level,a=t.details,o=a.totalduration;if(!i)return void this.warn("Levels were reset while loading level ".concat(s));this.log("Level ".concat(s," loaded [").concat(a.startSN,",").concat(a.endSN,"]").concat(a.lastPartSn?"[part-".concat(a.lastPartSn,"-").concat(a.lastPartIndex,"]"):"",", cc [").concat(a.startCC,", ").concat(a.endCC,"] duration:").concat(o));const l=t.levelInfo,c=this.fragCurrent;!c||this.state!==Gp&&this.state!==Vp||c.level!==t.level&&c.loader&&this.abortCurrentFrag();let u=0;if(a.live||null!=(n=l.details)&&n.live){var d;if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;u=this.alignPlaylists(a,l.details,null==(d=this.levelLastLoaded)?void 0:d.details)}if(l.details=a,this.levelLastLoaded=l,r||this.setStartPosition(a,u),this.hls.trigger(Ru.LEVEL_UPDATED,{details:a,level:s}),this.state===Jp){if(this.waitForCdnTuneIn(a))return;this.state=Hp}r&&a.live&&this.synchronizeToLiveEdge(a),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,r=this.getLoadPosition(),s=e.fragmentStart,a=e.edge,o=r>=s-t.maxFragLookUpTolerance&&r<=a;if(null!==i&&n.duration>i&&(r<i||!o)){const s=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!o&&n.readyState<4||r<a-s)&&(this._hasEnoughToStart||(this.nextLoadPosition=i),n.readyState))if(this.warn("Playback: ".concat(r.toFixed(3)," is located too far from the end of live sliding playlist: ").concat(a,", reset currentTime to : ").concat(i.toFixed(3))),"buffered"===this.config.liveSyncMode){var l;const e=_f.bufferInfo(n,i,0);if(null==(l=e.buffered)||!l.length)return void(n.currentTime=i);if(e.start<=r)return void(n.currentTime=i);const{nextStart:t}=_f.bufferedInfo(e.buffered,r,0);t&&(n.currentTime=t)}else n.currentTime=i}}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:i,payload:r}=e,{levels:s}=this;if(!s)return void this.warn("Levels were reset while fragment load was in progress. Fragment ".concat(n.sn," of level ").concat(n.level," will not be buffered"));const a=s[n.level];if(!a)return void this.warn("Level ".concat(n.level," not found on progress"));const o=a.details;if(!o)return this.warn("Dropping fragment ".concat(n.sn," of level ").concat(n.level," after level details were reset")),void this.fragmentTracker.removeFragment(n);const l=a.videoCodec,c=o.PTSKnown||!o.live,u=null==(t=n.initSegment)?void 0:t.data,d=this._getAudioCodec(a),h=this.transmuxer=this.transmuxer||new Cg(this.hls,ku,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),f=i?i.index:-1,p=-1!==f,m=new vf(n.level,n.sn,n.stats.chunkCount,r.byteLength,f,p),g=this.initPTS[n.cc];h.push(r,u,d,l,n,i,o.totalduration,c,m,g)}onAudioTrackSwitching(e,t){const n=this.hls,i=0!==this.altAudio;if(Ah(t.url,n))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const e=this.fragCurrent;e&&(this.log("Switching to main audio track, cancel main fragment load"),e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(i)return this.altAudio=0,this.fragmentTracker.removeAllFragments(),n.once(Ru.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(Ru.AUDIO_TRACK_SWITCHED,t)}),void n.trigger(Ru.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});n.trigger(Ru.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=Ah(t.url,this.hls);if(n){const e=this.videoBuffer;e&&this.mediaBuffer!==e&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=e)}this.altAudio=n?2:0,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,r,s=!1;for(const a in n){const e=n[a];if("main"===e.id){if(r=a,i=e,"video"===a){const e=n[a];e&&(this.videoBuffer=e.buffer)}}else s=!0}s&&i?(this.log("Alternate track found, use ".concat(r,".buffered to schedule main fragment loading")),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t,r=n.type===ku;if(r){if(this.fragContextChanged(n))return this.warn("Fragment ".concat(n.sn).concat(i?" p: "+i.index:""," of level ").concat(n.level," finished buffering, but was aborted. state: ").concat(this.state)),void(this.state===Yp&&(this.state=Hp));const e=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*e.total/(e.buffering.end-e.loading.first)),ud(n)&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}const s=this.media;s&&(!this._hasEnoughToStart&&_f.getBuffered(s).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),r&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var n;if(t.fatal)this.state=Kp;else switch(t.details){case Cu.FRAG_GAP:case Cu.FRAG_PARSING_ERROR:case Cu.FRAG_DECRYPT_ERROR:case Cu.FRAG_LOAD_ERROR:case Cu.FRAG_LOAD_TIMEOUT:case Cu.KEY_LOAD_ERROR:case Cu.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ku,t);break;case Cu.LEVEL_LOAD_ERROR:case Cu.LEVEL_LOAD_TIMEOUT:case Cu.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Jp||(null==(n=t.context)?void 0:n.type)!==Pu||(this.state=Hp);break;case Cu.BUFFER_ADD_CODEC_ERROR:case Cu.BUFFER_APPEND_ERROR:if("main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case Cu.BUFFER_FULL_ERROR:if("main"!==t.parent)return;if(this.reduceLengthAndFlushBuffer(t)){!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}break;case Cu.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onFragLoadEmergencyAborted(){this.state=Hp,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,t){let{type:n}=t;if(n!==ad||!this.altAudio){const e=(n===od?this.videoBuffer:this.mediaBuffer)||this.media;e&&(this.afterBufferFlushed(e,n,ku),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,-1===this.level&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking)return void this.log("could not seek to ".concat(n,", already seeking at ").concat(t));const i=this.timelineOffset;i&&n&&(n+=i);const r=this.getLevelDetails(),s=_f.getBuffered(e),a=s.length?s.start(0):0,o=a-n,l=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||o>0&&(o<l||this.loadingParts&&o<2*((null==r?void 0:r.partTarget)||0)))&&(this.log("adjusting start position by ".concat(o," to match buffer start")),n+=o,this.startPosition=n),t<n&&(this.log("seek to target start position ".concat(n," from current time ").concat(t," buffer start ").concat(a)),e.currentTime=n)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(e=>{const{hls:n}=this,i=null==e?void 0:e.frag;if(!i||this.fragContextChanged(i))return;t.fragmentError=0,this.state=Hp,this.startFragRequested=!1,this.bitrateTest=!1;const r=i.stats;r.parsing.start=r.parsing.end=r.buffering.start=r.buffering.end=self.performance.now(),n.trigger(Ru.FRAG_LOADED,e),i.bitrateTest=!1}).catch(t=>{this.state!==Up&&this.state!==Kp&&(this.warn(t),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const t=this.playlistType,{hls:n}=this,{remuxResult:i,chunkMeta:r}=e,s=this.getCurrentContext(r);if(!s)return void this.resetWhenMissingContext(r);const{frag:a,part:o,level:l}=s,{video:c,text:u,id3:d,initSegment:h}=i,{details:f}=l,p=this.altAudio?void 0:i.audio;if(this.fragContextChanged(a))this.fragmentTracker.removeFragment(a);else{if(this.state=jp,h){const e=h.tracks;if(e){const i=a.initSegment||a;if(this.unhandledEncryptionError(h,a))return;this._bufferInitSegment(l,e,i,r),n.trigger(Ru.FRAG_PARSING_INIT_SEGMENT,{frag:i,id:t,tracks:e})}const i=h.initPTS,s=h.timescale,o=this.initPTS[a.cc];if(wu(i)&&(!o||o.baseTime!==i||o.timescale!==s)){const e=h.trackId;this.initPTS[a.cc]={baseTime:i,timescale:s,trackId:e},n.trigger(Ru.INIT_PTS_FOUND,{frag:a,id:t,initPTS:i,timescale:s,trackId:e})}}if(c&&f){p&&"audiovideo"===c.type&&this.logMuxedErr(a);const e=f.fragments[a.sn-1-f.startSN],t=a.sn===f.startSN,n=!e||a.cc>e.cc;if(!1!==i.independent){const{startPTS:e,endPTS:i,startDTS:s,endDTS:l}=c;if(o)o.elementaryStreams[c.type]={startPTS:e,endPTS:i,startDTS:s,endDTS:l};else if(c.firstKeyFrame&&c.independent&&1===r.id&&!n&&(this.couldBacktrack=!0),c.dropped&&c.independent){const r=this.getMainFwdBufferInfo(),s=(r?r.end:this.getLoadPosition())+this.config.maxBufferHole,o=c.firstKeyFramePTS?c.firstKeyFramePTS:e;if(!t&&s<o-this.config.maxBufferHole&&!n)return void this.backtrack(a);n&&(a.gap=!0),a.setElementaryStreamInfo(c.type,a.start,i,a.start,l,!0)}else t&&e-(f.appliedTimelineOffset||0)>2&&(a.gap=!0);a.setElementaryStreamInfo(c.type,e,i,s,l),this.backtrackFragment&&(this.backtrackFragment=a),this.bufferFragmentData(c,a,o,r,t||n)}else{if(!t&&!n)return void this.backtrack(a);a.gap=!0}}if(p){const{startPTS:e,endPTS:t,startDTS:n,endDTS:i}=p;o&&(o.elementaryStreams[ad]={startPTS:e,endPTS:t,startDTS:n,endDTS:i}),a.setElementaryStreamInfo(ad,e,t,n,i),this.bufferFragmentData(p,a,o,r)}if(f&&null!=d&&d.samples.length){const e={id:t,frag:a,details:f,samples:d.samples};n.trigger(Ru.FRAG_PARSING_METADATA,e)}if(f&&u){const e={id:t,frag:a,details:f,samples:u.samples};n.trigger(Ru.FRAG_PARSING_USERDATA,e)}}}logMuxedErr(e){this.warn("".concat(ud(e)?"Media":"Init"," segment with muxed audiovideo where only video expected: ").concat(e.url))}_bufferInitSegment(e,t,n,i){if(this.state!==jp)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(n));const{audio:r,video:s,audiovideo:a}=t;if(r){const n=e.audioCodec;let i=Qd(r.codec,n);"mp4a"===i&&(i="mp4a.40.5");const s=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){i&&(i=-1!==i.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");const e=r.metadata;e&&"channelCount"in e&&1!==(e.channelCount||1)&&-1===s.indexOf("firefox")&&(i="mp4a.40.5")}i&&-1!==i.indexOf("mp4a.40.5")&&-1!==s.indexOf("android")&&"audio/mpeg"!==r.container&&(i="mp4a.40.2",this.log("Android: force audio codec to ".concat(i))),n&&n!==i&&this.log('Swapping manifest audio codec "'.concat(n,'" for "').concat(i,'"')),r.levelCodec=i,r.id=ku,this.log("Init audio buffer, container:".concat(r.container,", codecs[selected/level/parsed]=[").concat(i||"","/").concat(n||"","/").concat(r.codec,"]")),delete t.audiovideo}if(s){s.levelCodec=e.videoCodec,s.id=ku;const n=s.codec;if(4===(null==n?void 0:n.length))switch(n){case"hvc1":case"hev1":s.codec="hvc1.1.6.L120.90";break;case"av01":s.codec="av01.0.04M.08";break;case"avc1":s.codec="avc1.42e01e"}this.log("Init video buffer, container:".concat(s.container,", codecs[level/parsed]=[").concat(e.videoCodec||"","/").concat(n,"]").concat(s.codec!==n?" parsed-corrected="+s.codec:"").concat(s.supplemental?" supplemental="+s.supplemental:"")),delete t.audiovideo}a&&(this.log("Init audiovideo buffer, container:".concat(a.container,", codecs[level/parsed]=[").concat(e.codecs,"/").concat(a.codec,"]")),delete t.video,delete t.audio);const o=Object.keys(t);if(o.length){if(this.hls.trigger(Ru.BUFFER_CODECS,t),!this.hls)return;o.forEach(e=>{const r=t[e].initSegment;null!=r&&r.byteLength&&this.hls.trigger(Ru.BUFFER_APPENDING,{type:e,data:r,frag:n,part:null,chunkMeta:i,parent:n.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&2===this.altAudio?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,ku)}get maxBufferLength(){const{levels:e,level:t}=this,n=null==e?void 0:e[t];return n?this.getMaxBufferLength(n.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Hp}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&!1===e.seeking){const n=e.currentTime;if(_f.isBuffered(e,n)?t=this.getAppendedFrag(n):_f.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const e=this.fragPlaying,n=t.level;e&&t.sn===e.sn&&e.level===n||(this.fragPlaying=t,this.hls.trigger(Ru.FRAG_CHANGED,{frag:t}),e&&e.level===n||this.hls.trigger(Ru.LEVEL_SWITCHED,{level:n}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;return wu(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;if(wu(t)){const e=this.getLevelDetails(),n=this.currentFrag||(e?Rh(null,e.fragments,t):null);if(n){const e=n.programDateTime;if(null!==e){const i=e+1e3*(t-n.start);return new Date(i)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class M_ extends Vu{constructor(e,t){super("key-loader",t),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyIdToKeyInfo){const i=this.keyIdToKeyInfo[n].loader;if(i){var t;if(e&&e!==(null==(t=i.context)?void 0:t.frag.type))return;i.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Cu.KEY_LOAD_ERROR,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return new mf({type:Au.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:r,error:n,networkDetails:i})}loadClear(e,t,n){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let i=0,r=t.length;i<r;i++){const s=t[i];if(e.cc<=s.cc&&(!ud(e)||!ud(s)||e.sn<s.sn)||!n&&i==r-1)return this.emeController.selectKeySystemFormat(s).then(e=>{if(!this.emeController)return;s.setKeyFormat(e);const t=Yf(e);return t?this.emeController.getKeySystemAccess([t]):void 0})}if(this.config.requireKeySystemAccessOnStart){const e=Kf(this.config);if(e.length)return this.emeController.getKeySystemAccess(e)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r){const n=new Error(t?"Expected frag.decryptdata to be defined after setting format ".concat(t):"Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ".concat(this.emeController&&this.config.emeEnabled,")"));return Promise.reject(this.createKeyLoadError(e,Cu.KEY_LOAD_ERROR,n))}const s=r.uri;if(!s)return Promise.reject(this.createKeyLoadError(e,Cu.KEY_LOAD_ERROR,new Error('Invalid key URI: "'.concat(s,'"'))));const a=A_(r);let o=this.keyIdToKeyInfo[a];if(null!=(n=o)&&n.decryptdata.key)return r.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});if(this.emeController&&null!=(i=o)&&i.keyLoadPromise){switch(this.emeController.getKeyStatus(o.decryptdata)){case"usable":case"usable-in-future":return o.keyLoadPromise.then(t=>{const{keyInfo:n}=t;return r.key=n.decryptdata.key,{frag:e,keyInfo:n}})}}switch(this.log("".concat(this.keyIdToKeyInfo[a]?"Rel":"L","oading").concat(r.keyId?" keyId: "+$u(r.keyId):""," URI: ").concat(r.uri," from ").concat(e.type," ").concat(e.level)),o=this.keyIdToKeyInfo[a]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===r.keyFormat?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,Cu.KEY_LOAD_ERROR,new Error('Key supplied with unsupported METHOD: "'.concat(r.method,'"'))))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var i;if(!e.decryptdata.keyId&&null!=(i=t.initSegment)&&i.data){const n=function(e){const t=[];return Ld(e,e=>t.push(e.subarray(8,24))),t}(t.initSegment.data);if(n.length){let t=n[0];t.some(e=>0!==e)?(this.log("Using keyId found in init segment ".concat($u(t))),$f.setKeyIdForUri(e.decryptdata.uri,t)):(t=$f.addKeyIdForUri(e.decryptdata.uri),this.log("Generating keyId to patch media ".concat($u(t)))),e.decryptdata.keyId=t}}if(!e.decryptdata.keyId&&!ud(t))return Promise.resolve(n);const r=this.emeController.loadKey(n);return(e.keyLoadPromise=r.then(t=>(e.mediaKeySessionContext=t,n))).catch(n=>{throw e.keyLoadPromise=null,"data"in n&&(n.data.frag=t),n})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=new(0,n.loader)(n);return t.keyLoader=e.loader=i,e.keyLoadPromise=new Promise((r,s)=>{const a={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},o=n.keyLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(e,t,n,i)=>{const{frag:a,keyInfo:o}=n,l=A_(o.decryptdata);if(!a.decryptdata||o!==this.keyIdToKeyInfo[l])return s(this.createKeyLoadError(a,Cu.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),i));o.decryptdata.key=a.decryptdata.key=new Uint8Array(e.data),a.keyLoader=null,o.loader=null,r({frag:a,keyInfo:o})},onError:(e,n,i,r)=>{this.resetLoader(n),s(this.createKeyLoadError(t,Cu.KEY_LOAD_ERROR,new Error("HTTP Error ".concat(e.code," loading key ").concat(e.text)),i,Gu({url:a.url,data:void 0},e)))},onTimeout:(e,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(t,Cu.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),i))},onAbort:(e,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(t,Cu.INTERNAL_ABORTED,new Error("key loading aborted"),i))}};i.load(a,l,c)})}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,r=n.loader;t.keyLoader===r&&(t.keyLoader=null,n.loader=null);const s=A_(n.decryptdata)||i;delete this.keyIdToKeyInfo[s],r&&r.destroy()}}function A_(e){if(e.keyFormat!==Vf){const t=e.keyId;if(t)return $u(t)}return e.uri}function C_(e){const{type:t}=e;switch(t){case Iu:return Ou;case Du:return Nu;default:return ku}}function R_(e,t){let n=e.url;return void 0!==n&&0!==n.indexOf("data:")||(n=t.url),n}class L_{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Ru.LEVEL_LOADING,this.onLevelLoading,this),e.on(Ru.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(Ru.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(Ru.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(Ru.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Ru.LEVEL_LOADING,this.onLevelLoading,this),e.off(Ru.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(Ru.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(Ru.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,r=new(n||i)(t);return this.loaders[e.type]=r,r}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Lu,url:n,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:n,level:i,pathwayId:r,url:s,deliveryDirectives:a,levelInfo:o}=t;this.load({id:n,level:i,pathwayId:r,responseType:"text",type:Pu,url:s,deliveryDirectives:a,levelOrTrack:o})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:s,track:a}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Iu,url:r,deliveryDirectives:s,levelOrTrack:a})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:s,track:a}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Du,url:r,deliveryDirectives:s,levelOrTrack:a})}onLevelsUpdated(e,t){const n=this.loaders[Pu];if(n){const e=n.context;e&&!t.levels.some(t=>t===e.levelOrTrack)&&(n.abort(),delete this.loaders[Pu])}}load(e){var t;const n=this.hls.config;let i,r=this.getInternalLoader(e);if(r){const t=this.hls.logger,n=r.context;if(n&&n.levelOrTrack===e.levelOrTrack&&(n.url===e.url||n.deliveryDirectives&&!e.deliveryDirectives))return void(n.url===e.url?t.log("[playlist-loader]: ignore ".concat(e.url," ongoing request")):t.log("[playlist-loader]: ignore ".concat(e.url," in favor of ").concat(n.url)));t.log("[playlist-loader]: aborting previous loader for type: ".concat(e.type)),r.abort()}if(i=e.type===Lu?n.manifestLoadPolicy.default:Hu({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),wu(null==(t=e.deliveryDirectives)?void 0:t.part)){let t;if(e.type===Pu&&null!==e.level?t=this.hls.levels[e.level].details:e.type===Iu&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===Du&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t){const e=t.partTarget,n=t.targetduration;if(e&&n){const t=1e3*Math.max(3*e,.8*n);i=Hu({},i,{maxTimeToFirstByteMs:Math.min(t,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(t,i.maxTimeToFirstByteMs)})}}}const s=i.errorRetry||i.timeoutRetry||{},a={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:s.maxNumRetry||0,retryDelay:s.retryDelayMs||0,maxRetryDelay:s.maxRetryDelayMs||0},o={onSuccess:(e,t,n,i)=>{const r=this.getInternalLoader(n);this.resetInternalLoader(n.type);const s=e.data;t.parsing.start=performance.now(),ap.isMediaPlaylist(s)||n.type!==Lu?this.handleTrackOrLevelPlaylist(e,t,n,i||null,r):this.handleMasterPlaylist(e,t,n,i)},onError:(e,t,n,i)=>{this.handleNetworkError(t,n,!1,e,i)},onTimeout:(e,t,n)=>{this.handleNetworkError(t,n,!0,void 0,e)}};r.load(e,a,o)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:n}=this.hls;(e||n)&&(this.hls.logger.log("".concat(e?"auto":"force"," startLoad with configured startPosition ").concat(t)),this.hls.startLoad(t))}handleMasterPlaylist(e,t,n,i){const r=this.hls,s=e.data,a=R_(e,n),o=ap.parseMasterPlaylist(s,a);if(o.playlistParsingError)return t.parsing.end=performance.now(),void this.handleManifestParsingError(e,n,o.playlistParsingError,i,t);const{contentSteering:l,levels:c,sessionData:u,sessionKeys:d,startTimeOffset:h,variableList:f}=o;this.variableList=f,c.forEach(e=>{const{unknownCodecs:t}=e;if(t){const{preferManagedMediaSource:n}=this.hls.config;let{audioCodec:i,videoCodec:r}=e;for(let s=t.length;s--;){const a=t[s];Vd(a,"audio",n)?(e.audioCodec=i=i?"".concat(i,",").concat(a):a,zd.audio[i.substring(0,4)]=2,t.splice(s,1)):Vd(a,"video",n)&&(e.videoCodec=r=r?"".concat(r,",").concat(a):a,zd.video[r.substring(0,4)]=2,t.splice(s,1))}}});const{AUDIO:p=[],SUBTITLES:m,"CLOSED-CAPTIONS":g}=ap.parseMasterPlaylistMedia(s,a,o);if(p.length){p.some(e=>!e.url)||!c[0].audioCodec||c[0].attrs.AUDIO||(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Af({}),bitrate:0,url:""}))}r.trigger(Ru.MANIFEST_LOADED,{levels:c,audioTracks:p,subtitles:m,captions:g,contentSteering:l,url:a,stats:t,networkDetails:i,sessionData:u,sessionKeys:d,startTimeOffset:h,variableList:f})}handleTrackOrLevelPlaylist(e,t,n,i,r){const s=this.hls,{id:a,level:o,type:l}=n,c=R_(e,n),u=wu(o)?o:wu(a)?a:0,d=C_(n),h=ap.parseLevelPlaylist(e.data,c,u,d,0,this.variableList);if(l===Lu){const e={attrs:new Af({}),bitrate:0,details:h,name:"",url:c};h.requestScheduled=t.loading.start+wp(h,0),s.trigger(Ru.MANIFEST_LOADED,{levels:[e],audioTracks:[],url:c,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=h,this.handlePlaylistLoaded(h,e,t,n,i,r)}handleManifestParsingError(e,t,n,i,r){this.hls.trigger(Ru.ERROR,{type:Au.NETWORK_ERROR,details:Cu.MANIFEST_PARSING_ERROR,fatal:t.type===Lu,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:r})}handleNetworkError(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s="A network ".concat(n?"timeout":"error"+(i?" (status "+i.code+")":"")," occurred while loading ").concat(e.type);e.type===Pu?s+=": ".concat(e.level," id: ").concat(e.id):e.type!==Iu&&e.type!==Du||(s+=" id: ".concat(e.id,' group-id: "').concat(e.groupId,'"'));const a=new Error(s);this.hls.logger.warn("[playlist-loader]: ".concat(s));let o=Cu.UNKNOWN,l=!1;const c=this.getInternalLoader(e);switch(e.type){case Lu:o=n?Cu.MANIFEST_LOAD_TIMEOUT:Cu.MANIFEST_LOAD_ERROR,l=!0;break;case Pu:o=n?Cu.LEVEL_LOAD_TIMEOUT:Cu.LEVEL_LOAD_ERROR,l=!1;break;case Iu:o=n?Cu.AUDIO_TRACK_LOAD_TIMEOUT:Cu.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case Du:o=n?Cu.SUBTITLE_TRACK_LOAD_TIMEOUT:Cu.SUBTITLE_LOAD_ERROR,l=!1}c&&this.resetInternalLoader(e.type);const u={type:Au.NETWORK_ERROR,details:o,fatal:l,url:e.url,loader:c,context:e,error:a,networkDetails:t,stats:r};if(i){const n=(null==t?void 0:t.url)||e.url;u.response=Gu({url:n,data:void 0},i)}this.hls.trigger(Ru.ERROR,u)}handlePlaylistLoaded(e,t,n,i,r,s){const a=this.hls,{type:o,level:l,levelOrTrack:c,id:u,groupId:d,deliveryDirectives:h}=i,f=R_(t,i),p=C_(i);let m="number"===typeof i.level&&p===ku?l:void 0;const g=e.playlistParsingError;if(g){if(this.hls.logger.warn("".concat(g," ").concat(e.url)),!a.config.ignorePlaylistParsingErrors)return void a.trigger(Ru.ERROR,{type:Au.NETWORK_ERROR,details:Cu.LEVEL_PARSING_ERROR,fatal:!1,url:f,error:g,reason:g.message,response:t,context:i,level:m,parent:p,networkDetails:r,stats:n});e.playlistParsingError=null}if(!e.fragments.length){const s=e.playlistParsingError=new Error("No Segments found in Playlist");return void a.trigger(Ru.ERROR,{type:Au.NETWORK_ERROR,details:Cu.LEVEL_EMPTY_ERROR,fatal:!1,url:f,error:s,reason:s.message,response:t,context:i,level:m,parent:p,networkDetails:r,stats:n})}switch(e.live&&s&&(s.getCacheAge&&(e.ageHeader=s.getCacheAge()||0),s.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),o){case Lu:case Pu:if(m)if(c){if(c!==a.levels[m]){const e=a.levels.indexOf(c);e>-1&&(m=e)}}else m=0;a.trigger(Ru.LEVEL_LOADED,{details:e,levelInfo:c||a.levels[0],level:m||0,id:u||0,stats:n,networkDetails:r,deliveryDirectives:h,withoutMultiVariant:o===Lu});break;case Iu:a.trigger(Ru.AUDIO_TRACK_LOADED,{details:e,track:c,id:u||0,groupId:d||"",stats:n,networkDetails:r,deliveryDirectives:h});break;case Du:a.trigger(Ru.SUBTITLE_TRACK_LOADED,{details:e,track:c,id:u||0,groupId:d||"",stats:n,networkDetails:r,deliveryDirectives:h})}}}class P_{static get version(){return rm}static isMSESupported(){return w_()}static isSupported(){return function(){if(!w_())return!1;const e=Ju();return"function"===typeof(null==e?void 0:e.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(t=>e.isTypeSupported(jd(t,"video")))||["mp4a.40.2","fLaC"].some(t=>e.isTypeSupported(jd(t,"audio"))))}()}static getMediaSource(){return Ju()}static get Events(){return Ru}static get MetadataSchema(){return Am}static get ErrorTypes(){return Au}static get ErrorDetails(){return Cu}static get DefaultConfig(){return P_.defaultConfig?P_.defaultConfig:c_}static set DefaultConfig(e){P_.defaultConfig=e}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new im,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=function(e,t,n){const i=Yu();if("object"===typeof console&&!0===e||"object"===typeof e){const r=["debug","log","info","warn","error"];r.forEach(t=>{i[t]=Xu(t,e,n)});try{i.log('Debug logs enabled for "'.concat(t,'" in hls.js version ',"1.6.15"))}catch(kne){return Yu()}r.forEach(t=>{Ku[t]=Xu(t,e)})}else Hu(Ku,i);return i}(e.debug||!1,"Hls instance",e.assetPlayerId),n=this.config=function(e,t,n){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=u_(e),r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach(e=>{const s="".concat("level"===e?"playlist":e,"LoadPolicy"),a=void 0===t[s],o=[];r.forEach(n=>{const r="".concat(e,"Loading").concat(n),l=t[r];if(void 0!==l&&a){o.push(r);const e=i[s].default;switch(t[s]={default:e},n){case"TimeOut":e.maxLoadTimeMs=l,e.maxTimeToFirstByteMs=l;break;case"MaxRetry":e.errorRetry.maxNumRetry=l,e.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":e.errorRetry.retryDelayMs=l,e.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":e.errorRetry.maxRetryDelayMs=l,e.timeoutRetry.maxRetryDelayMs=l}}}),o.length&&n.warn('hls.js config: "'.concat(o.join('", "'),'" setting(s) are deprecated, use "').concat(s,'": ').concat(_h(t[s])))}),Gu(Gu({},i),t)}(P_.DefaultConfig,e,t);this.userConfig=e,n.progressive&&d_(n,t);const{abrController:i,bufferController:r,capLevelController:s,errorController:a,fpsController:o}=n,l=new a(this),c=this.abrController=new i(this),u=new ef(this),d=n.interstitialsController,h=d?this.interstitialsController=new d(this,P_):null,f=this.bufferController=new r(this,u),p=this.capLevelController=new s(this),m=new o(this),g=new L_(this),v=n.contentSteeringController,y=v?new v(this):null,_=this.levelController=new x_(this,y),b=new __(this),x=new M_(this.config,this.logger),S=this.streamController=new T_(this,u,x),E=this.gapController=new h_(this,u);p.setStreamController(S),m.setStreamController(S);const w=[g,_,S];h&&w.splice(1,0,h),y&&w.splice(1,0,y),this.networkControllers=w;const T=[c,f,E,p,m,b,u];this.audioTrackController=this.createController(n.audioTrackController,w);const M=n.audioStreamController;M&&w.push(this.audioStreamController=new M(this,u,x)),this.subtitleTrackController=this.createController(n.subtitleTrackController,w);const A=n.subtitleStreamController;A&&w.push(this.subtititleStreamController=new A(this,u,x)),this.createController(n.timelineController,T),x.emeController=this.emeController=this.createController(n.emeController,T),this.cmcdController=this.createController(n.cmcdController,T),this.latencyController=this.createController(b_,T),this.coreComponents=T,w.push(l);const C=l.onErrorOut;"function"===typeof C&&this.on(Ru.ERROR,C,l),this.on(Ru.MANIFEST_LOADED,g.onManifestLoaded,g)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;this._emitter.on(e,t,n)}once(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,i=arguments.length>3?arguments[3]:void 0;this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const t=e===Ru.ERROR;this.trigger(Ru.ERROR,{type:Au.OTHER_ERROR,details:Cu.INTERNAL_EXCEPTION,fatal:t,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(Ru.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(e=>e.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(e=>e.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const t=new Error("attachMedia failed: invalid argument (".concat(e,")"));return void this.trigger(Ru.ERROR,{type:Au.OTHER_ERROR,details:Cu.ATTACH_MEDIA_ERROR,fatal:!0,error:t})}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,n=t?e.media:e,i=t?e:{media:n};this._media=n,this.trigger(Ru.MEDIA_ATTACHING,i)}detachMedia(){this.logger.log("detachMedia"),this.trigger(Ru.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(Ru.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,n=this._url,i=this._url=rd.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log("loadSource:".concat(i)),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(Ru.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1?arguments[1]:void 0;this.logger.log("startLoad(".concat(e+(t?", <skip seek to start>":""),")")),this.started=!0,this.resumeBuffering();for(let n=0;n<this.networkControllers.length&&(this.networkControllers[n].startLoad(e,t),this.started&&this.networkControllers);n++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!this.started&&this.networkControllers);e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[ku]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[Ou]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[Nu]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=null==e?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=function(){try{return crypto.randomUUID()}catch(e){try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch(e){let t=(new Date).getTime();const n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)});return n}}}()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log("set currentLevel:".concat(e)),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log("set nextLevel:".concat(e)),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log("set loadLevel:".concat(e)),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log("set firstLevel:".concat(e)),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return-1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log("set startLevel:".concat(e)),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log("set autoLevelCapping:".concat(e)),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){(function(e){return ch.indexOf(e)>-1})(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(i=-1===t&&null!=e&&e.length?e.length-1:t,n)for(let r=i;r--;){const t=e[r].attrs["HDCP-LEVEL"];if(t&&t<=n)return r}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return(null==(t=this.audioTrackController)?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return(null==(t=this.subtitleTrackController)?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!(null==(e=this.bufferController)||!e.bufferedToEnd)}get interstitialsManager(){var e;return(null==(e=this.interstitialsController)?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e){return ah(e,xh(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.allAudioTracks),navigator.mediaCapabilities)}}P_.defaultConfig=void 0;const I_="SearchComponent_main__66YvN",D_="SearchComponent_button__YrHYF",k_="SearchComponent_item__oeZil",O_="SearchComponent_item_button__LjPur",N_="SearchComponent_custom_date_input__8pmye",F_="SearchComponent_arrow_icon__Zbv47";function B_(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=B_(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function U_(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=B_(e))&&(i&&(i+=" "),i+=t);return i}Math.pow(10,8);const H_=6048e5,z_=6e4,G_=36e5,V_=Symbol.for("constructDateFrom");function W_(e,t){return"function"===typeof e?e(t):e&&"object"===typeof e&&V_ in e?e[V_](t):e instanceof Date?new e.constructor(t):new Date(t)}function j_(e,t){return W_(t||e,e)}function Y_(e,t){var n;const i=()=>W_(null===t||void 0===t?void 0:t.in,NaN),r=null!==(n=null===t||void 0===t?void 0:t.additionalDigits)&&void 0!==n?n:2,s=function(e){const t={},n=e.split(X_.dateTimeDelimiter);let i;if(n.length>2)return t;/:/.test(n[0])?i=n[0]:(t.date=n[0],i=n[1],X_.timeZoneDelimiter.test(t.date)&&(t.date=e.split(X_.timeZoneDelimiter)[0],i=e.substr(t.date.length,e.length)));if(i){const e=X_.timezone.exec(i);e?(t.time=i.replace(e[1],""),t.timezone=e[1]):t.time=i}return t}(e);let a;if(s.date){const e=function(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),i=e.match(n);if(!i)return{year:NaN,restDateString:""};const r=i[1]?parseInt(i[1]):null,s=i[2]?parseInt(i[2]):null;return{year:null===s?r:100*s,restDateString:e.slice((i[1]||i[2]).length)}}(s.date,r);a=function(e,t){if(null===t)return new Date(NaN);const n=e.match(K_);if(!n)return new Date(NaN);const i=!!n[4],r=Q_(n[1]),s=Q_(n[2])-1,a=Q_(n[3]),o=Q_(n[4]),l=Q_(n[5])-1;if(i)return function(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}(0,o,l)?function(e,t,n){const i=new Date(0);i.setUTCFullYear(e,0,4);const r=i.getUTCDay()||7,s=7*(t-1)+n+1-r;return i.setUTCDate(i.getUTCDate()+s),i}(t,o,l):new Date(NaN);{const e=new Date(0);return function(e,t,n){return t>=0&&t<=11&&n>=1&&n<=($_[t]||(eb(e)?29:28))}(t,s,a)&&function(e,t){return t>=1&&t<=(eb(e)?366:365)}(t,r)?(e.setUTCFullYear(t,s,Math.max(r,a)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!a||isNaN(+a))return i();const o=+a;let l,c=0;if(s.time&&(c=function(e){const t=e.match(q_);if(!t)return NaN;const n=Z_(t[1]),i=Z_(t[2]),r=Z_(t[3]);if(!function(e,t,n){if(24===e)return 0===t&&0===n;return n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}(n,i,r))return NaN;return n*G_+i*z_+1e3*r}(s.time),isNaN(c)))return i();if(!s.timezone){const e=new Date(o+c),n=j_(0,null===t||void 0===t?void 0:t.in);return n.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),n.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),n}return l=function(e){if("Z"===e)return 0;const t=e.match(J_);if(!t)return 0;const n="+"===t[1]?-1:1,i=parseInt(t[2]),r=t[3]&&parseInt(t[3])||0;if(!function(e,t){return t>=0&&t<=59}(0,r))return NaN;return n*(i*G_+r*z_)}(s.timezone),isNaN(l)?i():j_(o+c+l,null===t||void 0===t?void 0:t.in)}const X_={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},K_=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,q_=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,J_=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Q_(e){return e?parseInt(e):1}function Z_(e){return e&&parseFloat(e.replace(",","."))||0}const $_=[31,null,31,30,31,30,31,31,30,31,30,31];function eb(e){return e%400===0||e%4===0&&e%100!==0}const tb={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function nb(e){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const ib={date:nb({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:nb({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:nb({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},rb={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function sb(e){return(t,n)=>{let i;if("formatting"===(null!==n&&void 0!==n&&n.context?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,r=null!==n&&void 0!==n&&n.width?String(n.width):t;i=e.formattingValues[r]||e.formattingValues[t]}else{const t=e.defaultWidth,r=null!==n&&void 0!==n&&n.width?String(n.width):e.defaultWidth;i=e.values[r]||e.values[t]}return i[e.argumentCallback?e.argumentCallback(t):t]}}const ab={ordinalNumber:(e,t)=>{const n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:sb({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:sb({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:sb({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:sb({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:sb({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function ob(e){return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=n.width,r=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],s=t.match(r);if(!s)return null;const a=s[0],o=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n;return}(o,e=>e.test(a)):function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n;return}(o,e=>e.test(a));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;return{value:c,rest:t.slice(a.length)}}}const lb={ordinalNumber:(cb={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.match(cb.matchPattern);if(!n)return null;const i=n[0],r=e.match(cb.parsePattern);if(!r)return null;let s=cb.valueCallback?cb.valueCallback(r[0]):r[0];return s=t.valueCallback?t.valueCallback(s):s,{value:s,rest:e.slice(i.length)}}),era:ob({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:ob({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:ob({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:ob({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:ob({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})};var cb;const ub={code:"en-US",formatDistance:(e,t,n)=>{let i;const r=tb[e];return i="string"===typeof r?r:1===t?r.one:r.other.replace("{{count}}",t.toString()),null!==n&&void 0!==n&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i},formatLong:ib,formatRelative:(e,t,n,i)=>rb[e],localize:ab,match:lb,options:{weekStartsOn:0,firstWeekContainsDate:1}},db=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},hb=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},fb={p:hb,P:(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],i=n[1],r=n[2];if(!r)return db(e,t);let s;switch(i){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;default:s=t.dateTime({width:"full"})}return s.replace("{{date}}",db(i,t)).replace("{{time}}",hb(r,t))}},pb=/^D+$/,mb=/^Y+$/,gb=["D","DD","YY","YYYY"];function vb(e){return pb.test(e)}function yb(e){return mb.test(e)}function _b(e,t,n){const i=function(e,t,n){const i="Y"===e[0]?"years":"days of the month";return"Use `".concat(e.toLowerCase(),"` instead of `").concat(e,"` (in `").concat(t,"`) for formatting ").concat(i," to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md")}(e,t,n);if(console.warn(i),gb.includes(e))throw new RangeError(i)}let bb={};function xb(){return bb}function Sb(){return Object.assign({},xb())}function Eb(e,t){const n=function(e){var t;return"function"===typeof e&&(null===(t=e.prototype)||void 0===t?void 0:t.constructor)===e}(t)?new t(0):W_(t,0);return n.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),n.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),n}class wb{constructor(){Mr(this,"subPriority",0)}validate(e,t){return!0}}class Tb extends wb{constructor(e,t,n,i,r){super(),this.value=e,this.validateValue=t,this.setValue=n,this.priority=i,r&&(this.subPriority=r)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,n){return this.setValue(e,t,this.value,n)}}class Mb extends wb{constructor(e,t){super(),Mr(this,"priority",10),Mr(this,"subPriority",-1),this.context=e||(e=>W_(t,e))}set(e,t){return t.timestampIsSet?e:W_(e,Eb(e,this.context))}}class Ab{run(e,t,n,i){const r=this.parse(e,t,n,i);return r?{setter:new Tb(r.value,this.validate,this.set,this.priority,this.subPriority),rest:r.rest}:null}validate(e,t,n){return!0}}const Cb=/^(1[0-2]|0?\d)/,Rb=/^(3[0-1]|[0-2]?\d)/,Lb=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,Pb=/^(5[0-3]|[0-4]?\d)/,Ib=/^(2[0-3]|[0-1]?\d)/,Db=/^(2[0-4]|[0-1]?\d)/,kb=/^(1[0-1]|0?\d)/,Ob=/^(1[0-2]|0?\d)/,Nb=/^[0-5]?\d/,Fb=/^[0-5]?\d/,Bb=/^\d/,Ub=/^\d{1,2}/,Hb=/^\d{1,3}/,zb=/^\d{1,4}/,Gb=/^-?\d+/,Vb=/^-?\d/,Wb=/^-?\d{1,2}/,jb=/^-?\d{1,3}/,Yb=/^-?\d{1,4}/,Xb=/^([+-])(\d{2})(\d{2})?|Z/,Kb=/^([+-])(\d{2})(\d{2})|Z/,qb=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,Jb=/^([+-])(\d{2}):(\d{2})|Z/,Qb=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function Zb(e,t){return e?{value:t(e.value),rest:e.rest}:e}function $b(e,t){const n=t.match(e);return n?{value:parseInt(n[0],10),rest:t.slice(n[0].length)}:null}function ex(e,t){const n=t.match(e);if(!n)return null;if("Z"===n[0])return{value:0,rest:t.slice(1)};const i="+"===n[1]?1:-1,r=n[2]?parseInt(n[2],10):0,s=n[3]?parseInt(n[3],10):0,a=n[5]?parseInt(n[5],10):0;return{value:i*(r*G_+s*z_+1e3*a),rest:t.slice(n[0].length)}}function tx(e){return $b(Gb,e)}function nx(e,t){switch(e){case 1:return $b(Bb,t);case 2:return $b(Ub,t);case 3:return $b(Hb,t);case 4:return $b(zb,t);default:return $b(new RegExp("^\\d{1,"+e+"}"),t)}}function ix(e,t){switch(e){case 1:return $b(Vb,t);case 2:return $b(Wb,t);case 3:return $b(jb,t);case 4:return $b(Yb,t);default:return $b(new RegExp("^-?\\d{1,"+e+"}"),t)}}function rx(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function sx(e,t){const n=t>0,i=n?t:1-t;let r;if(i<=50)r=e||100;else{const t=i+50;r=e+100*Math.trunc(t/100)-(e>=t%100?100:0)}return n?r:1-r}function ax(e){return e%400===0||e%4===0&&e%100!==0}function ox(e,t){var n,i,r,s,a,o;const l=xb(),c=null!==(n=null!==(i=null!==(r=null!==(s=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==s?s:null===t||void 0===t||null===(a=t.locale)||void 0===a||null===(a=a.options)||void 0===a?void 0:a.weekStartsOn)&&void 0!==r?r:l.weekStartsOn)&&void 0!==i?i:null===(o=l.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==n?n:0,u=j_(e,null===t||void 0===t?void 0:t.in),d=u.getDay(),h=(d<c?7:0)+d-c;return u.setDate(u.getDate()-h),u.setHours(0,0,0,0),u}function lx(e,t){var n,i,r,s,a,o;const l=j_(e,null===t||void 0===t?void 0:t.in),c=l.getFullYear(),u=xb(),d=null!==(n=null!==(i=null!==(r=null!==(s=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==s?s:null===t||void 0===t||null===(a=t.locale)||void 0===a||null===(a=a.options)||void 0===a?void 0:a.firstWeekContainsDate)&&void 0!==r?r:u.firstWeekContainsDate)&&void 0!==i?i:null===(o=u.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==n?n:1,h=W_((null===t||void 0===t?void 0:t.in)||e,0);h.setFullYear(c+1,0,d),h.setHours(0,0,0,0);const f=ox(h,t),p=W_((null===t||void 0===t?void 0:t.in)||e,0);p.setFullYear(c,0,d),p.setHours(0,0,0,0);const m=ox(p,t);return+l>=+f?c+1:+l>=+m?c:c-1}function cx(e,t){return ox(e,Cr(Cr({},t),{},{weekStartsOn:1}))}function ux(e,t){var n,i,r,s,a,o;const l=xb(),c=null!==(n=null!==(i=null!==(r=null!==(s=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==s?s:null===t||void 0===t||null===(a=t.locale)||void 0===a||null===(a=a.options)||void 0===a?void 0:a.firstWeekContainsDate)&&void 0!==r?r:l.firstWeekContainsDate)&&void 0!==i?i:null===(o=l.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==n?n:1,u=lx(e,t),d=W_((null===t||void 0===t?void 0:t.in)||e,0);d.setFullYear(u,0,c),d.setHours(0,0,0,0);return ox(d,t)}function dx(e,t){const n=j_(e,null===t||void 0===t?void 0:t.in),i=+ox(n,t)-+ux(n,t);return Math.round(i/H_)+1}function hx(e,t,n){const i=j_(e,null===n||void 0===n?void 0:n.in),r=dx(i,n)-t;return i.setDate(i.getDate()-7*r),j_(i,null===n||void 0===n?void 0:n.in)}function fx(e,t){const n=j_(e,null===t||void 0===t?void 0:t.in),i=n.getFullYear(),r=W_(n,0);r.setFullYear(i+1,0,4),r.setHours(0,0,0,0);const s=cx(r),a=W_(n,0);a.setFullYear(i,0,4),a.setHours(0,0,0,0);const o=cx(a);return n.getTime()>=s.getTime()?i+1:n.getTime()>=o.getTime()?i:i-1}function px(e,t){const n=fx(e,t),i=W_((null===t||void 0===t?void 0:t.in)||e,0);return i.setFullYear(n,0,4),i.setHours(0,0,0,0),cx(i)}function mx(e,t){const n=j_(e,null===t||void 0===t?void 0:t.in),i=+cx(n)-+px(n);return Math.round(i/H_)+1}function gx(e,t,n){const i=j_(e,null===n||void 0===n?void 0:n.in),r=mx(i,n)-t;return i.setDate(i.getDate()-7*r),i}const vx=[31,28,31,30,31,30,31,31,30,31,30,31],yx=[31,29,31,30,31,30,31,31,30,31,30,31];function _x(e,t,n){const i=j_(e,null===n||void 0===n?void 0:n.in);return isNaN(t)?W_((null===n||void 0===n?void 0:n.in)||e,NaN):t?(i.setDate(i.getDate()+t),i):i}function bx(e,t,n){var i,r,s,a,o,l;const c=xb(),u=null!==(i=null!==(r=null!==(s=null!==(a=null===n||void 0===n?void 0:n.weekStartsOn)&&void 0!==a?a:null===n||void 0===n||null===(o=n.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==s?s:c.weekStartsOn)&&void 0!==r?r:null===(l=c.locale)||void 0===l||null===(l=l.options)||void 0===l?void 0:l.weekStartsOn)&&void 0!==i?i:0,d=j_(e,null===n||void 0===n?void 0:n.in),h=d.getDay(),f=7-u;return _x(d,t<0||t>6?t-(h+f)%7:((t%7+7)%7+f)%7-(h+f)%7,n)}function xx(e,t){const n=j_(e,null===t||void 0===t?void 0:t.in).getDay();return 0===n?7:n}function Sx(e,t,n){const i=j_(e,null===n||void 0===n?void 0:n.in);return _x(i,t-xx(i,n),n)}function Ex(e){const t=j_(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}const wx={G:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",140),Mr(this,"incompatibleTokens",["R","u","t","T"])}parse(e,t,n){switch(t){case"G":case"GG":case"GGG":return n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"});case"GGGGG":return n.era(e,{width:"narrow"});default:return n.era(e,{width:"wide"})||n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"})}}set(e,t,n){return t.era=n,e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}},y:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",130),Mr(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(e,t,n){const i=e=>({year:e,isTwoDigitYear:"yy"===t});switch(t){case"y":return Zb(nx(4,e),i);case"yo":return Zb(n.ordinalNumber(e,{unit:"year"}),i);default:return Zb(nx(t.length,e),i)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,n){const i=e.getFullYear();if(n.isTwoDigitYear){const t=sx(n.year,i);return e.setFullYear(t,0,1),e.setHours(0,0,0,0),e}const r="era"in t&&1!==t.era?1-n.year:n.year;return e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}},Y:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",130),Mr(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(e,t,n){const i=e=>({year:e,isTwoDigitYear:"YY"===t});switch(t){case"Y":return Zb(nx(4,e),i);case"Yo":return Zb(n.ordinalNumber(e,{unit:"year"}),i);default:return Zb(nx(t.length,e),i)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,n,i){const r=lx(e,i);if(n.isTwoDigitYear){const t=sx(n.year,r);return e.setFullYear(t,0,i.firstWeekContainsDate),e.setHours(0,0,0,0),ox(e,i)}const s="era"in t&&1!==t.era?1-n.year:n.year;return e.setFullYear(s,0,i.firstWeekContainsDate),e.setHours(0,0,0,0),ox(e,i)}},R:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",130),Mr(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(e,t){return ix("R"===t?4:t.length,e)}set(e,t,n){const i=W_(e,0);return i.setFullYear(n,0,4),i.setHours(0,0,0,0),cx(i)}},u:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",130),Mr(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(e,t){return ix("u"===t?4:t.length,e)}set(e,t,n){return e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}},Q:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",120),Mr(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(e,t,n){switch(t){case"Q":case"QQ":return nx(t.length,e);case"Qo":return n.ordinalNumber(e,{unit:"quarter"});case"QQQ":return n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(e,{width:"narrow",context:"formatting"});default:return n.quarter(e,{width:"wide",context:"formatting"})||n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=1&&t<=4}set(e,t,n){return e.setMonth(3*(n-1),1),e.setHours(0,0,0,0),e}},q:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",120),Mr(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(e,t,n){switch(t){case"q":case"qq":return nx(t.length,e);case"qo":return n.ordinalNumber(e,{unit:"quarter"});case"qqq":return n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(e,{width:"narrow",context:"standalone"});default:return n.quarter(e,{width:"wide",context:"standalone"})||n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=1&&t<=4}set(e,t,n){return e.setMonth(3*(n-1),1),e.setHours(0,0,0,0),e}},M:new class extends Ab{constructor(){super(...arguments),Mr(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),Mr(this,"priority",110)}parse(e,t,n){const i=e=>e-1;switch(t){case"M":return Zb($b(Cb,e),i);case"MM":return Zb(nx(2,e),i);case"Mo":return Zb(n.ordinalNumber(e,{unit:"month"}),i);case"MMM":return n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(e,{width:"narrow",context:"formatting"});default:return n.month(e,{width:"wide",context:"formatting"})||n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}},L:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",110),Mr(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(e,t,n){const i=e=>e-1;switch(t){case"L":return Zb($b(Cb,e),i);case"LL":return Zb(nx(2,e),i);case"Lo":return Zb(n.ordinalNumber(e,{unit:"month"}),i);case"LLL":return n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(e,{width:"narrow",context:"standalone"});default:return n.month(e,{width:"wide",context:"standalone"})||n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}},w:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",100),Mr(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(e,t,n){switch(t){case"w":return $b(Pb,e);case"wo":return n.ordinalNumber(e,{unit:"week"});default:return nx(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,n,i){return ox(hx(e,n,i),i)}},I:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",100),Mr(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(e,t,n){switch(t){case"I":return $b(Pb,e);case"Io":return n.ordinalNumber(e,{unit:"week"});default:return nx(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,n){return cx(gx(e,n))}},d:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",90),Mr(this,"subPriority",1),Mr(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(e,t,n){switch(t){case"d":return $b(Rb,e);case"do":return n.ordinalNumber(e,{unit:"date"});default:return nx(t.length,e)}}validate(e,t){const n=ax(e.getFullYear()),i=e.getMonth();return n?t>=1&&t<=yx[i]:t>=1&&t<=vx[i]}set(e,t,n){return e.setDate(n),e.setHours(0,0,0,0),e}},D:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",90),Mr(this,"subpriority",1),Mr(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(e,t,n){switch(t){case"D":case"DD":return $b(Lb,e);case"Do":return n.ordinalNumber(e,{unit:"date"});default:return nx(t.length,e)}}validate(e,t){return ax(e.getFullYear())?t>=1&&t<=366:t>=1&&t<=365}set(e,t,n){return e.setMonth(0,n),e.setHours(0,0,0,0),e}},E:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",90),Mr(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(e,t,n){switch(t){case"E":case"EE":case"EEE":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,i){return(e=bx(e,n,i)).setHours(0,0,0,0),e}},e:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",90),Mr(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(e,t,n,i){const r=e=>{const t=7*Math.floor((e-1)/7);return(e+i.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return Zb(nx(t.length,e),r);case"eo":return Zb(n.ordinalNumber(e,{unit:"day"}),r);case"eee":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeeee":return n.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,i){return(e=bx(e,n,i)).setHours(0,0,0,0),e}},c:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",90),Mr(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(e,t,n,i){const r=e=>{const t=7*Math.floor((e-1)/7);return(e+i.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return Zb(nx(t.length,e),r);case"co":return Zb(n.ordinalNumber(e,{unit:"day"}),r);case"ccc":return n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"ccccc":return n.day(e,{width:"narrow",context:"standalone"});case"cccccc":return n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});default:return n.day(e,{width:"wide",context:"standalone"})||n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,i){return(e=bx(e,n,i)).setHours(0,0,0,0),e}},i:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",90),Mr(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(e,t,n){const i=e=>0===e?7:e;switch(t){case"i":case"ii":return nx(t.length,e);case"io":return n.ordinalNumber(e,{unit:"day"});case"iii":return Zb(n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),i);case"iiiii":return Zb(n.day(e,{width:"narrow",context:"formatting"}),i);case"iiiiii":return Zb(n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),i);default:return Zb(n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),i)}}validate(e,t){return t>=1&&t<=7}set(e,t,n){return(e=Sx(e,n)).setHours(0,0,0,0),e}},a:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",80),Mr(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(e,t,n){switch(t){case"a":case"aa":case"aaa":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(rx(n),0,0,0),e}},b:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",80),Mr(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(e,t,n){switch(t){case"b":case"bb":case"bbb":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(rx(n),0,0,0),e}},B:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",80),Mr(this,"incompatibleTokens",["a","b","t","T"])}parse(e,t,n){switch(t){case"B":case"BB":case"BBB":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(rx(n),0,0,0),e}},h:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",70),Mr(this,"incompatibleTokens",["H","K","k","t","T"])}parse(e,t,n){switch(t){case"h":return $b(Ob,e);case"ho":return n.ordinalNumber(e,{unit:"hour"});default:return nx(t.length,e)}}validate(e,t){return t>=1&&t<=12}set(e,t,n){const i=e.getHours()>=12;return i&&n<12?e.setHours(n+12,0,0,0):i||12!==n?e.setHours(n,0,0,0):e.setHours(0,0,0,0),e}},H:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",70),Mr(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(e,t,n){switch(t){case"H":return $b(Ib,e);case"Ho":return n.ordinalNumber(e,{unit:"hour"});default:return nx(t.length,e)}}validate(e,t){return t>=0&&t<=23}set(e,t,n){return e.setHours(n,0,0,0),e}},K:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",70),Mr(this,"incompatibleTokens",["h","H","k","t","T"])}parse(e,t,n){switch(t){case"K":return $b(kb,e);case"Ko":return n.ordinalNumber(e,{unit:"hour"});default:return nx(t.length,e)}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.getHours()>=12&&n<12?e.setHours(n+12,0,0,0):e.setHours(n,0,0,0),e}},k:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",70),Mr(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(e,t,n){switch(t){case"k":return $b(Db,e);case"ko":return n.ordinalNumber(e,{unit:"hour"});default:return nx(t.length,e)}}validate(e,t){return t>=1&&t<=24}set(e,t,n){const i=n<=24?n%24:n;return e.setHours(i,0,0,0),e}},m:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",60),Mr(this,"incompatibleTokens",["t","T"])}parse(e,t,n){switch(t){case"m":return $b(Nb,e);case"mo":return n.ordinalNumber(e,{unit:"minute"});default:return nx(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,n){return e.setMinutes(n,0,0),e}},s:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",50),Mr(this,"incompatibleTokens",["t","T"])}parse(e,t,n){switch(t){case"s":return $b(Fb,e);case"so":return n.ordinalNumber(e,{unit:"second"});default:return nx(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,n){return e.setSeconds(n,0),e}},S:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",30),Mr(this,"incompatibleTokens",["t","T"])}parse(e,t){return Zb(nx(t.length,e),e=>Math.trunc(e*Math.pow(10,3-t.length)))}set(e,t,n){return e.setMilliseconds(n),e}},X:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",10),Mr(this,"incompatibleTokens",["t","T","x"])}parse(e,t){switch(t){case"X":return ex(Xb,e);case"XX":return ex(Kb,e);case"XXXX":return ex(qb,e);case"XXXXX":return ex(Qb,e);default:return ex(Jb,e)}}set(e,t,n){return t.timestampIsSet?e:W_(e,e.getTime()-Ex(e)-n)}},x:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",10),Mr(this,"incompatibleTokens",["t","T","X"])}parse(e,t){switch(t){case"x":return ex(Xb,e);case"xx":return ex(Kb,e);case"xxxx":return ex(qb,e);case"xxxxx":return ex(Qb,e);default:return ex(Jb,e)}}set(e,t,n){return t.timestampIsSet?e:W_(e,e.getTime()-Ex(e)-n)}},t:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",40),Mr(this,"incompatibleTokens","*")}parse(e){return tx(e)}set(e,t,n){return[W_(e,1e3*n),{timestampIsSet:!0}]}},T:new class extends Ab{constructor(){super(...arguments),Mr(this,"priority",20),Mr(this,"incompatibleTokens","*")}parse(e){return tx(e)}set(e,t,n){return[W_(e,n),{timestampIsSet:!0}]}}},Tx=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Mx=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ax=/^'([^]*?)'?$/,Cx=/''/g,Rx=/\S/,Lx=/[a-zA-Z]/;function Px(e,t,n,i){var r,s,a,o,l,c,u,d,h,f,p,m,g,v;const y=()=>W_((null===i||void 0===i?void 0:i.in)||n,NaN),_=Sb(),b=null!==(r=null!==(s=null===i||void 0===i?void 0:i.locale)&&void 0!==s?s:_.locale)&&void 0!==r?r:ub,x=null!==(a=null!==(o=null!==(l=null!==(c=null===i||void 0===i?void 0:i.firstWeekContainsDate)&&void 0!==c?c:null===i||void 0===i||null===(u=i.locale)||void 0===u||null===(u=u.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==l?l:_.firstWeekContainsDate)&&void 0!==o?o:null===(d=_.locale)||void 0===d||null===(d=d.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==a?a:1,S=null!==(h=null!==(f=null!==(p=null!==(m=null===i||void 0===i?void 0:i.weekStartsOn)&&void 0!==m?m:null===i||void 0===i||null===(g=i.locale)||void 0===g||null===(g=g.options)||void 0===g?void 0:g.weekStartsOn)&&void 0!==p?p:_.weekStartsOn)&&void 0!==f?f:null===(v=_.locale)||void 0===v||null===(v=v.options)||void 0===v?void 0:v.weekStartsOn)&&void 0!==h?h:0;if(!t)return e?y():j_(n,null===i||void 0===i?void 0:i.in);const E={firstWeekContainsDate:x,weekStartsOn:S,locale:b},w=[new Mb(null===i||void 0===i?void 0:i.in,n)],T=t.match(Mx).map(e=>{const t=e[0];if(t in fb){return(0,fb[t])(e,b.formatLong)}return e}).join("").match(Tx),M=[];for(let L of T){null!==i&&void 0!==i&&i.useAdditionalWeekYearTokens||!yb(L)||_b(L,t,e),null!==i&&void 0!==i&&i.useAdditionalDayOfYearTokens||!vb(L)||_b(L,t,e);const n=L[0],r=wx[n];if(r){const{incompatibleTokens:t}=r;if(Array.isArray(t)){const e=M.find(e=>t.includes(e.token)||e.token===n);if(e)throw new RangeError("The format string mustn't contain `".concat(e.fullToken,"` and `").concat(L,"` at the same time"))}else if("*"===r.incompatibleTokens&&M.length>0)throw new RangeError("The format string mustn't contain `".concat(L,"` and any other token at the same time"));M.push({token:n,fullToken:L});const i=r.run(e,L,b.match,E);if(!i)return y();w.push(i.setter),e=i.rest}else{if(n.match(Lx))throw new RangeError("Format string contains an unescaped latin alphabet character `"+n+"`");if("''"===L?L="'":"'"===n&&(L=Ix(L)),0!==e.indexOf(L))return y();e=e.slice(L.length)}}if(e.length>0&&Rx.test(e))return y();const A=w.map(e=>e.priority).sort((e,t)=>t-e).filter((e,t,n)=>n.indexOf(e)===t).map(e=>w.filter(t=>t.priority===e).sort((e,t)=>t.subPriority-e.subPriority)).map(e=>e[0]);let C=j_(n,null===i||void 0===i?void 0:i.in);if(isNaN(+C))return y();const R={};for(const L of A){if(!L.validate(C,E))return y();const e=L.set(C,R,E);Array.isArray(e)?(C=e[0],Object.assign(R,e[1])):C=e}return C}function Ix(e){return e.match(Ax)[1].replace(Cx,"'")}function Dx(e){return e instanceof Date||"object"===typeof e&&"[object Date]"===Object.prototype.toString.call(e)}function kx(e){return!(!Dx(e)&&"number"!==typeof e||isNaN(+j_(e)))}function Ox(e,t){return+j_(e)<+j_(t)}function Nx(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=W_.bind(null,e||n.find(e=>"object"===typeof e));return n.map(r)}function Fx(e,t){const n=j_(e,null===t||void 0===t?void 0:t.in);return n.setHours(0,0,0,0),n}function Bx(e,t,n){const[i,r]=Nx(null===n||void 0===n?void 0:n.in,e,t),s=Fx(i),a=Fx(r),o=+s-Ex(s),l=+a-Ex(a);return Math.round((o-l)/864e5)}function Ux(e,t){const n=j_(e,null===t||void 0===t?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function Hx(e,t){const n=j_(e,null===t||void 0===t?void 0:t.in);return Bx(n,Ux(n))+1}function zx(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const Gx={y(e,t){const n=e.getFullYear(),i=n>0?n:1-n;return zx("yy"===t?i%100:i,t.length)},M(e,t){const n=e.getMonth();return"M"===t?String(n+1):zx(n+1,2)},d:(e,t)=>zx(e.getDate(),t.length),a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(e,t)=>zx(e.getHours()%12||12,t.length),H:(e,t)=>zx(e.getHours(),t.length),m:(e,t)=>zx(e.getMinutes(),t.length),s:(e,t)=>zx(e.getSeconds(),t.length),S(e,t){const n=t.length,i=e.getMilliseconds();return zx(Math.trunc(i*Math.pow(10,n-3)),t.length)}},Vx="midnight",Wx="noon",jx="morning",Yx="afternoon",Xx="evening",Kx="night",qx={G:function(e,t,n){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});default:return n.era(i,{width:"wide"})}},y:function(e,t,n){if("yo"===t){const t=e.getFullYear(),i=t>0?t:1-t;return n.ordinalNumber(i,{unit:"year"})}return Gx.y(e,t)},Y:function(e,t,n,i){const r=lx(e,i),s=r>0?r:1-r;if("YY"===t){return zx(s%100,2)}return"Yo"===t?n.ordinalNumber(s,{unit:"year"}):zx(s,t.length)},R:function(e,t){return zx(fx(e),t.length)},u:function(e,t){return zx(e.getFullYear(),t.length)},Q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return zx(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return zx(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,n){const i=e.getMonth();switch(t){case"M":case"MM":return Gx.M(e,t);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,n){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return zx(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,n,i){const r=dx(e,i);return"wo"===t?n.ordinalNumber(r,{unit:"week"}):zx(r,t.length)},I:function(e,t,n){const i=mx(e);return"Io"===t?n.ordinalNumber(i,{unit:"week"}):zx(i,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):Gx.d(e,t)},D:function(e,t,n){const i=Hx(e);return"Do"===t?n.ordinalNumber(i,{unit:"dayOfYear"}):zx(i,t.length)},E:function(e,t,n){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,n,i){const r=e.getDay(),s=(r-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return zx(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(e,t,n,i){const r=e.getDay(),s=(r-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return zx(s,t.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(e,t,n){const i=e.getDay(),r=0===i?7:i;switch(t){case"i":return String(r);case"ii":return zx(r,t.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,n){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,n){const i=e.getHours();let r;switch(r=12===i?Wx:0===i?Vx:i/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){const i=e.getHours();let r;switch(r=i>=17?Xx:i>=12?Yx:i>=4?jx:Kx,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return Gx.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):Gx.H(e,t)},K:function(e,t,n){const i=e.getHours()%12;return"Ko"===t?n.ordinalNumber(i,{unit:"hour"}):zx(i,t.length)},k:function(e,t,n){let i=e.getHours();return 0===i&&(i=24),"ko"===t?n.ordinalNumber(i,{unit:"hour"}):zx(i,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Gx.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Gx.s(e,t)},S:function(e,t){return Gx.S(e,t)},X:function(e,t,n){const i=e.getTimezoneOffset();if(0===i)return"Z";switch(t){case"X":return Qx(i);case"XXXX":case"XX":return Zx(i);default:return Zx(i,":")}},x:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"x":return Qx(i);case"xxxx":case"xx":return Zx(i);default:return Zx(i,":")}},O:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Jx(i,":");default:return"GMT"+Zx(i,":")}},z:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Jx(i,":");default:return"GMT"+Zx(i,":")}},t:function(e,t,n){return zx(Math.trunc(+e/1e3),t.length)},T:function(e,t,n){return zx(+e,t.length)}};function Jx(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e>0?"-":"+",i=Math.abs(e),r=Math.trunc(i/60),s=i%60;return 0===s?n+String(r):n+String(r)+t+zx(s,2)}function Qx(e,t){if(e%60===0){return(e>0?"-":"+")+zx(Math.abs(e)/60,2)}return Zx(e,t)}function Zx(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e>0?"-":"+",i=Math.abs(e);return n+zx(Math.trunc(i/60),2)+t+zx(i%60,2)}const $x=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,eS=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,tS=/^'([^]*?)'?$/,nS=/''/g,iS=/[a-zA-Z]/;function rS(e,t,n){var i,r,s,a,o,l,c,u,d,h,f,p,m,g;const v=xb(),y=null!==(i=null!==(r=null===n||void 0===n?void 0:n.locale)&&void 0!==r?r:v.locale)&&void 0!==i?i:ub,_=null!==(s=null!==(a=null!==(o=null!==(l=null===n||void 0===n?void 0:n.firstWeekContainsDate)&&void 0!==l?l:null===n||void 0===n||null===(c=n.locale)||void 0===c||null===(c=c.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==o?o:v.firstWeekContainsDate)&&void 0!==a?a:null===(u=v.locale)||void 0===u||null===(u=u.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==s?s:1,b=null!==(d=null!==(h=null!==(f=null!==(p=null===n||void 0===n?void 0:n.weekStartsOn)&&void 0!==p?p:null===n||void 0===n||null===(m=n.locale)||void 0===m||null===(m=m.options)||void 0===m?void 0:m.weekStartsOn)&&void 0!==f?f:v.weekStartsOn)&&void 0!==h?h:null===(g=v.locale)||void 0===g||null===(g=g.options)||void 0===g?void 0:g.weekStartsOn)&&void 0!==d?d:0,x=j_(e,null===n||void 0===n?void 0:n.in);if(!kx(x))throw new RangeError("Invalid time value");let S=t.match(eS).map(e=>{const t=e[0];if("p"===t||"P"===t){return(0,fb[t])(e,y.formatLong)}return e}).join("").match($x).map(e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:sS(e)};if(qx[t])return{isToken:!0,value:e};if(t.match(iS))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}});y.localize.preprocessor&&(S=y.localize.preprocessor(x,S));const E={firstWeekContainsDate:_,weekStartsOn:b,locale:y};return S.map(i=>{if(!i.isToken)return i.value;const r=i.value;(null!==n&&void 0!==n&&n.useAdditionalWeekYearTokens||!yb(r))&&(null!==n&&void 0!==n&&n.useAdditionalDayOfYearTokens||!vb(r))||_b(r,t,String(e));return(0,qx[r[0]])(x,r,y.localize,E)}).join("")}function sS(e){const t=e.match(tS);return t?t[1].replace(nS,"'"):e}function aS(e,t,n){const i=j_(e,null===n||void 0===n?void 0:n.in);return i.setHours(t),i}function oS(e,t,n){const i=j_(e,null===n||void 0===n?void 0:n.in);return i.setMinutes(t),i}function lS(e,t,n){const i=j_(e,null===n||void 0===n?void 0:n.in);return i.setSeconds(t),i}function cS(e,t){const n=j_(e,null===t||void 0===t?void 0:t.in);return n.setDate(1),n.setHours(0,0,0,0),n}function uS(e,t){const n=j_(e,null===t||void 0===t?void 0:t.in),i=n.getMonth(),r=i-i%3;return n.setMonth(r,1),n.setHours(0,0,0,0),n}function dS(e,t){const n=j_(e,null===t||void 0===t?void 0:t.in);return n.setHours(23,59,59,999),n}function hS(e,t){var n,i,r,s,a,o;const l=xb(),c=null!==(n=null!==(i=null!==(r=null!==(s=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==s?s:null===t||void 0===t||null===(a=t.locale)||void 0===a||null===(a=a.options)||void 0===a?void 0:a.weekStartsOn)&&void 0!==r?r:l.weekStartsOn)&&void 0!==i?i:null===(o=l.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==n?n:0,u=j_(e,null===t||void 0===t?void 0:t.in),d=u.getDay(),h=6+(d<c?-7:0)-(d-c);return u.setDate(u.getDate()+h),u.setHours(23,59,59,999),u}function fS(e,t){const n=j_(e,null===t||void 0===t?void 0:t.in),i=n.getMonth();return n.setFullYear(n.getFullYear(),i+1,0),n.setHours(23,59,59,999),n}function pS(e,t,n){const[i,r]=Nx(null===n||void 0===n?void 0:n.in,e,t);return i.getFullYear()===r.getFullYear()}function mS(e,t,n){const[i,r]=Nx(null===n||void 0===n?void 0:n.in,e,t);return i.getFullYear()===r.getFullYear()&&i.getMonth()===r.getMonth()}function gS(e,t,n){const[i,r]=Nx(null===n||void 0===n?void 0:n.in,e,t);return+uS(i)===+uS(r)}function vS(e,t,n){const[i,r]=Nx(null===n||void 0===n?void 0:n.in,e,t);return+Fx(i)===+Fx(r)}function yS(e,t){return+j_(e)===+j_(t)}function _S(e,t,n){const i=+j_(e,null===n||void 0===n?void 0:n.in),[r,s]=[+j_(t.start,null===n||void 0===n?void 0:n.in),+j_(t.end,null===n||void 0===n?void 0:n.in)].sort((e,t)=>e-t);return i>=r&&i<=s}function bS(e,t){const n=j_(e,null===t||void 0===t?void 0:t.in),i=n.getFullYear(),r=n.getMonth(),s=W_(n,0);return s.setFullYear(i,r+1,0),s.setHours(0,0,0,0),s.getDate()}function xS(e,t,n){const i=j_(e,null===n||void 0===n?void 0:n.in),r=i.getFullYear(),s=i.getDate(),a=W_((null===n||void 0===n?void 0:n.in)||e,0);a.setFullYear(r,t,15),a.setHours(0,0,0,0);const o=bS(a);return i.setMonth(t,Math.min(s,o)),i}function SS(e,t,n){const i=j_(e,null===n||void 0===n?void 0:n.in),r=t-(Math.trunc(i.getMonth()/3)+1);return xS(i,i.getMonth()+3*r)}function ES(e,t){return j_(e,null===t||void 0===t?void 0:t.in).getFullYear()}function wS(e,t){return j_(e,null===t||void 0===t?void 0:t.in).getMonth()}function TS(e,t){const n=j_(e,null===t||void 0===t?void 0:t.in),i=n.getFullYear();return n.setFullYear(i+1,0,0),n.setHours(23,59,59,999),n}function MS(e,t){const n=j_(e,null===t||void 0===t?void 0:t.in);return Math.trunc(n.getMonth()/3)+1}function AS(e,t){return j_(e,null===t||void 0===t?void 0:t.in).getHours()}function CS(e,t){return j_(e,null===t||void 0===t?void 0:t.in).getMinutes()}function RS(e){return j_(e).getSeconds()}function LS(e,t,n){const i=j_(e,null===n||void 0===n?void 0:n.in);if(isNaN(t))return W_((null===n||void 0===n?void 0:n.in)||e,NaN);if(!t)return i;const r=i.getDate(),s=W_((null===n||void 0===n?void 0:n.in)||e,i.getTime());s.setMonth(i.getMonth()+t+1,0);return r>=s.getDate()?s:(i.setFullYear(s.getFullYear(),s.getMonth(),r),i)}function PS(e,t,n){return LS(e,-t,n)}function IS(e,t,n){const[i,r]=Nx(null===n||void 0===n?void 0:n.in,e,t);return 12*(i.getFullYear()-r.getFullYear())+(i.getMonth()-r.getMonth())}function DS(e,t,n){return LS(e,3*t,n)}function kS(e,t,n){return DS(e,-t,n)}function OS(e,t,n){const[i,r]=Nx(null===n||void 0===n?void 0:n.in,e,t);return 4*(i.getFullYear()-r.getFullYear())+(MS(i)-MS(r))}function NS(e,t,n){return LS(e,12*t,n)}function FS(e,t,n){return NS(e,-t,n)}function BS(e,t,n){const[i,r]=Nx(null===n||void 0===n?void 0:n.in,e,t);return i.getFullYear()-r.getFullYear()}function US(e,t){let n,i=null===t||void 0===t?void 0:t.in;return e.forEach(e=>{i||"object"!==typeof e||(i=W_.bind(null,e));const t=j_(e,i);(!n||n>t||isNaN(+t))&&(n=t)}),W_(i,n||NaN)}function HS(e,t){let n,i=null===t||void 0===t?void 0:t.in;return e.forEach(e=>{i||"object"!==typeof e||(i=W_.bind(null,e));const t=j_(e,i);(!n||n<t||isNaN(+t))&&(n=t)}),W_(i,n||NaN)}function zS(e,t,n){return W_((null===n||void 0===n?void 0:n.in)||e,+j_(e)+t)}function GS(e,t,n){return zS(e,t*G_,n)}function VS(e,t,n){const i=j_(e,null===n||void 0===n?void 0:n.in);return i.setTime(i.getTime()+t*z_),i}function WS(e,t,n){return zS(e,1e3*t,n)}function jS(e,t){return+j_(e)>+j_(t)}function YS(e,t){return j_(e,null===t||void 0===t?void 0:t.in).getDay()}function XS(e,t){return j_(e,null===t||void 0===t?void 0:t.in).getDate()}function KS(e,t,n){return _x(e,7*t,n)}function qS(e){return+j_(e)}function JS(e,t,n){const i=j_(e,null===n||void 0===n?void 0:n.in);return isNaN(+i)?W_((null===n||void 0===n?void 0:n.in)||e,NaN):(i.setFullYear(t),i)}function QS(e,t,n){const[i,r]=Nx(null===n||void 0===n?void 0:n.in,e,t),s=ZS(i,r),a=Math.abs(Bx(i,r));i.setDate(i.getDate()-s*a);const o=s*(a-Number(ZS(i,r)===-s));return 0===o?0:o}function ZS(e,t){const n=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return n<0?-1:n>0?1:n}function $S(e,t,n){return KS(e,-t,n)}function eE(e,t,n){return _x(e,-t,n)}var tE="undefined"!==typeof document?t.useLayoutEffect:function(){};const nE=Cr({},i).useInsertionEffect||(e=>e());function iE(){return"undefined"!==typeof window}function rE(e){return oE(e)?(e.nodeName||"").toLowerCase():"#document"}function sE(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function aE(e){var t;return null==(t=(oE(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function oE(e){return!!iE()&&(e instanceof Node||e instanceof sE(e).Node)}function lE(e){return!!iE()&&(e instanceof Element||e instanceof sE(e).Element)}function cE(e){return!!iE()&&(e instanceof HTMLElement||e instanceof sE(e).HTMLElement)}function uE(e){return!(!iE()||"undefined"===typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof sE(e).ShadowRoot)}const dE=new Set(["inline","contents"]);function hE(e){const{overflow:t,overflowX:n,overflowY:i,display:r}=wE(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!dE.has(r)}const fE=new Set(["table","td","th"]);function pE(e){return fE.has(rE(e))}const mE=[":popover-open",":modal"];function gE(e){return mE.some(t=>{try{return e.matches(t)}catch(n){return!1}})}const vE=["transform","translate","scale","rotate","perspective"],yE=["transform","translate","scale","rotate","perspective","filter"],_E=["paint","layout","strict","content"];function bE(e){const t=xE(),n=lE(e)?wE(e):e;return vE.some(e=>!!n[e]&&"none"!==n[e])||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||yE.some(e=>(n.willChange||"").includes(e))||_E.some(e=>(n.contain||"").includes(e))}function xE(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const SE=new Set(["html","body","#document"]);function EE(e){return SE.has(rE(e))}function wE(e){return sE(e).getComputedStyle(e)}function TE(e){return lE(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function ME(e){if("html"===rE(e))return e;const t=e.assignedSlot||e.parentNode||uE(e)&&e.host||aE(e);return uE(t)?t.host:t}function AE(e){const t=ME(e);return EE(t)?e.ownerDocument?e.ownerDocument.body:e.body:cE(t)&&hE(t)?t:AE(t)}function CE(e,t,n){var i;void 0===t&&(t=[]),void 0===n&&(n=!0);const r=AE(e),s=r===(null==(i=e.ownerDocument)?void 0:i.body),a=sE(r);if(s){const e=RE(a);return t.concat(a,a.visualViewport||[],hE(r)?r:[],e&&n?CE(e):[])}return t.concat(r,CE(r,[],n))}function RE(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}var LE=n(396);const PE=Math.min,IE=Math.max,DE=Math.round,kE=Math.floor,OE=e=>({x:e,y:e}),NE={left:"right",right:"left",bottom:"top",top:"bottom"},FE={start:"end",end:"start"};function BE(e,t){return"function"===typeof e?e(t):e}function UE(e){return e.split("-")[0]}function HE(e){return e.split("-")[1]}function zE(e){return"y"===e?"height":"width"}const GE=new Set(["top","bottom"]);function VE(e){return GE.has(UE(e))?"y":"x"}function WE(e){return"x"===VE(e)?"y":"x"}function jE(e){return e.replace(/start|end/g,e=>FE[e])}const YE=["left","right"],XE=["right","left"],KE=["top","bottom"],qE=["bottom","top"];function JE(e,t,n,i){const r=HE(e);let s=function(e,t,n){switch(e){case"top":case"bottom":return n?t?XE:YE:t?YE:XE;case"left":case"right":return t?KE:qE;default:return[]}}(UE(e),"start"===n,i);return r&&(s=s.map(e=>e+"-"+r),t&&(s=s.concat(s.map(jE)))),s}function QE(e){return e.replace(/left|right|bottom|top/g,e=>NE[e])}function ZE(e){return"number"!==typeof e?function(e){return Cr({top:0,right:0,bottom:0,left:0},e)}(e):{top:e,right:e,bottom:e,left:e}}function $E(e){const{x:t,y:n,width:i,height:r}=e;return{width:i,height:r,top:n,left:t,right:t+i,bottom:n+r,x:t,y:n}}const ew=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"];function tw(e,t,n){let{reference:i,floating:r}=e;const s=VE(t),a=WE(t),o=zE(a),l=UE(t),c="y"===s,u=i.x+i.width/2-r.width/2,d=i.y+i.height/2-r.height/2,h=i[o]/2-r[o]/2;let f;switch(l){case"top":f={x:u,y:i.y-r.height};break;case"bottom":f={x:u,y:i.y+i.height};break;case"right":f={x:i.x+i.width,y:d};break;case"left":f={x:i.x-r.width,y:d};break;default:f={x:i.x,y:i.y}}switch(HE(t)){case"start":f[a]-=h*(n&&c?-1:1);break;case"end":f[a]+=h*(n&&c?-1:1)}return f}async function nw(e,t){var n;void 0===t&&(t={});const{x:i,y:r,platform:s,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=BE(t,e),p=ZE(f),m=o[h?"floating"===d?"reference":"floating":d],g=$E(await s.getClippingRect({element:null==(n=await(null==s.isElement?void 0:s.isElement(m)))||n?m:m.contextElement||await(null==s.getDocumentElement?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),v="floating"===d?{x:i,y:r,width:a.floating.width,height:a.floating.height}:a.reference,y=await(null==s.getOffsetParent?void 0:s.getOffsetParent(o.floating)),_=await(null==s.isElement?void 0:s.isElement(y))&&await(null==s.getScale?void 0:s.getScale(y))||{x:1,y:1},b=$E(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:v,offsetParent:y,strategy:l}):v);return{top:(g.top-b.top+p.top)/_.y,bottom:(b.bottom-g.bottom+p.bottom)/_.y,left:(g.left-b.left+p.left)/_.x,right:(b.right-g.right+p.right)/_.x}}const iw=new Set(["left","top"]);function rw(e){const t=wE(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const r=cE(e),s=r?e.offsetWidth:n,a=r?e.offsetHeight:i,o=DE(n)!==s||DE(i)!==a;return o&&(n=s,i=a),{width:n,height:i,$:o}}function sw(e){return lE(e)?e:e.contextElement}function aw(e){const t=sw(e);if(!cE(t))return OE(1);const n=t.getBoundingClientRect(),{width:i,height:r,$:s}=rw(t);let a=(s?DE(n.width):n.width)/i,o=(s?DE(n.height):n.height)/r;return a&&Number.isFinite(a)||(a=1),o&&Number.isFinite(o)||(o=1),{x:a,y:o}}const ow=OE(0);function lw(e){const t=sE(e);return xE()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:ow}function cw(e,t,n,i){void 0===t&&(t=!1),void 0===n&&(n=!1);const r=e.getBoundingClientRect(),s=sw(e);let a=OE(1);t&&(i?lE(i)&&(a=aw(i)):a=aw(e));const o=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==sE(e))&&t}(s,n,i)?lw(s):OE(0);let l=(r.left+o.x)/a.x,c=(r.top+o.y)/a.y,u=r.width/a.x,d=r.height/a.y;if(s){const e=sE(s),t=i&&lE(i)?sE(i):i;let n=e,r=RE(n);for(;r&&i&&t!==n;){const e=aw(r),t=r.getBoundingClientRect(),i=wE(r),s=t.left+(r.clientLeft+parseFloat(i.paddingLeft))*e.x,a=t.top+(r.clientTop+parseFloat(i.paddingTop))*e.y;l*=e.x,c*=e.y,u*=e.x,d*=e.y,l+=s,c+=a,n=sE(r),r=RE(n)}}return $E({width:u,height:d,x:l,y:c})}function uw(e,t){const n=TE(e).scrollLeft;return t?t.left+n:cw(aE(e)).left+n}function dw(e,t){const n=e.getBoundingClientRect();return{x:n.left+t.scrollLeft-uw(e,n),y:n.top+t.scrollTop}}const hw=new Set(["absolute","fixed"]);function fw(e,t,n){let i;if("viewport"===t)i=function(e,t){const n=sE(e),i=aE(e),r=n.visualViewport;let s=i.clientWidth,a=i.clientHeight,o=0,l=0;if(r){s=r.width,a=r.height;const e=xE();(!e||e&&"fixed"===t)&&(o=r.offsetLeft,l=r.offsetTop)}const c=uw(i);if(c<=0){const e=i.ownerDocument,t=e.body,n=getComputedStyle(t),r="CSS1Compat"===e.compatMode&&parseFloat(n.marginLeft)+parseFloat(n.marginRight)||0,a=Math.abs(i.clientWidth-t.clientWidth-r);a<=25&&(s-=a)}else c<=25&&(s+=c);return{width:s,height:a,x:o,y:l}}(e,n);else if("document"===t)i=function(e){const t=aE(e),n=TE(e),i=e.ownerDocument.body,r=IE(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),s=IE(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let a=-n.scrollLeft+uw(e);const o=-n.scrollTop;return"rtl"===wE(i).direction&&(a+=IE(t.clientWidth,i.clientWidth)-r),{width:r,height:s,x:a,y:o}}(aE(e));else if(lE(t))i=function(e,t){const n=cw(e,!0,"fixed"===t),i=n.top+e.clientTop,r=n.left+e.clientLeft,s=cE(e)?aw(e):OE(1);return{width:e.clientWidth*s.x,height:e.clientHeight*s.y,x:r*s.x,y:i*s.y}}(t,n);else{const n=lw(e);i={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return $E(i)}function pw(e,t){const n=ME(e);return!(n===t||!lE(n)||EE(n))&&("fixed"===wE(n).position||pw(n,t))}function mw(e,t,n){const i=cE(t),r=aE(t),s="fixed"===n,a=cw(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=OE(0);function c(){l.x=uw(r)}if(i||!i&&!s)if(("body"!==rE(t)||hE(r))&&(o=TE(t)),i){const e=cw(t,!0,s,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else r&&c();s&&!i&&r&&c();const u=!r||i||s?OE(0):dw(r,o);return{x:a.left+o.scrollLeft-l.x-u.x,y:a.top+o.scrollTop-l.y-u.y,width:a.width,height:a.height}}function gw(e){return"static"===wE(e).position}function vw(e,t){if(!cE(e)||"fixed"===wE(e).position)return null;if(t)return t(e);let n=e.offsetParent;return aE(e)===n&&(n=n.ownerDocument.body),n}function yw(e,t){const n=sE(e);if(gE(e))return n;if(!cE(e)){let t=ME(e);for(;t&&!EE(t);){if(lE(t)&&!gw(t))return t;t=ME(t)}return n}let i=vw(e,t);for(;i&&pE(i)&&gw(i);)i=vw(i,t);return i&&EE(i)&&gw(i)&&!bE(i)?n:i||function(e){let t=ME(e);for(;cE(t)&&!EE(t);){if(bE(t))return t;if(gE(t))return null;t=ME(t)}return null}(e)||n}const _w={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:i,strategy:r}=e;const s="fixed"===r,a=aE(i),o=!!t&&gE(t.floating);if(i===a||o&&s)return n;let l={scrollLeft:0,scrollTop:0},c=OE(1);const u=OE(0),d=cE(i);if((d||!d&&!s)&&(("body"!==rE(i)||hE(a))&&(l=TE(i)),cE(i))){const e=cw(i);c=aw(i),u.x=e.x+i.clientLeft,u.y=e.y+i.clientTop}const h=!a||d||s?OE(0):dw(a,l);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}},getDocumentElement:aE,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:i,strategy:r}=e;const s=[..."clippingAncestors"===n?gE(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let i=CE(e,[],!1).filter(e=>lE(e)&&"body"!==rE(e)),r=null;const s="fixed"===wE(e).position;let a=s?ME(e):e;for(;lE(a)&&!EE(a);){const t=wE(a),n=bE(a);n||"fixed"!==t.position||(r=null),(s?!n&&!r:!n&&"static"===t.position&&r&&hw.has(r.position)||hE(a)&&!n&&pw(e,a))?i=i.filter(e=>e!==a):r=t,a=ME(a)}return t.set(e,i),i}(t,this._c):[].concat(n),i],a=s[0],o=s.reduce((e,n)=>{const i=fw(t,n,r);return e.top=IE(i.top,e.top),e.right=PE(i.right,e.right),e.bottom=PE(i.bottom,e.bottom),e.left=IE(i.left,e.left),e},fw(t,a,r));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},getOffsetParent:yw,getElementRects:async function(e){const t=this.getOffsetParent||yw,n=this.getDimensions,i=await n(e.floating);return{reference:mw(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=rw(e);return{width:t,height:n}},getScale:aw,isElement:lE,isRTL:function(e){return"rtl"===wE(e).direction}};function bw(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function xw(e,t,n,i){void 0===i&&(i={});const{ancestorScroll:r=!0,ancestorResize:s=!0,elementResize:a="function"===typeof ResizeObserver,layoutShift:o="function"===typeof IntersectionObserver,animationFrame:l=!1}=i,c=sw(e),u=r||s?[...c?CE(c):[],...CE(t)]:[];u.forEach(e=>{r&&e.addEventListener("scroll",n,{passive:!0}),s&&e.addEventListener("resize",n)});const d=c&&o?function(e,t){let n,i=null;const r=aE(e);function s(){var e;clearTimeout(n),null==(e=i)||e.disconnect(),i=null}return function a(o,l){void 0===o&&(o=!1),void 0===l&&(l=1),s();const c=e.getBoundingClientRect(),{left:u,top:d,width:h,height:f}=c;if(o||t(),!h||!f)return;const p={rootMargin:-kE(d)+"px "+-kE(r.clientWidth-(u+h))+"px "+-kE(r.clientHeight-(d+f))+"px "+-kE(u)+"px",threshold:IE(0,PE(1,l))||1};let m=!0;function g(t){const i=t[0].intersectionRatio;if(i!==l){if(!m)return a();i?a(!1,i):n=setTimeout(()=>{a(!1,1e-7)},1e3)}1!==i||bw(c,e.getBoundingClientRect())||a(),m=!1}try{i=new IntersectionObserver(g,Cr(Cr({},p),{},{root:r.ownerDocument}))}catch(v){i=new IntersectionObserver(g,p)}i.observe(e)}(!0),s}(c,n):null;let h,f=-1,p=null;a&&(p=new ResizeObserver(e=>{let[i]=e;i&&i.target===c&&p&&(p.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var e;null==(e=p)||e.observe(t)})),n()}),c&&!l&&p.observe(c),p.observe(t));let m=l?cw(e):null;return l&&function t(){const i=cw(e);m&&!bw(m,i)&&n();m=i,h=requestAnimationFrame(t)}(),n(),()=>{var e;u.forEach(e=>{r&&e.removeEventListener("scroll",n),s&&e.removeEventListener("resize",n)}),null==d||d(),null==(e=p)||e.disconnect(),p=null,l&&cancelAnimationFrame(h)}}const Sw=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,i;const{x:r,y:s,placement:a,middlewareData:o}=t,l=await async function(e,t){const{placement:n,platform:i,elements:r}=e,s=await(null==i.isRTL?void 0:i.isRTL(r.floating)),a=UE(n),o=HE(n),l="y"===VE(n),c=iw.has(a)?-1:1,u=s&&l?-1:1,d=BE(t,e);let{mainAxis:h,crossAxis:f,alignmentAxis:p}="number"===typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&"number"===typeof p&&(f="end"===o?-1*p:p),l?{x:f*u,y:h*c}:{x:h*c,y:f*u}}(t,e);return a===(null==(n=o.offset)?void 0:n.placement)&&null!=(i=o.arrow)&&i.alignmentOffset?{}:{x:r+l.x,y:s+l.y,data:Cr(Cr({},l),{},{placement:a})}}}},Ew=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:r,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:c}=t,u=BE(e,t),{mainAxis:h=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:v=!0}=u,y=d(u,ew);if(null!=(n=s.arrow)&&n.alignmentOffset)return{};const _=UE(r),b=VE(o),x=UE(o)===o,S=await(null==l.isRTL?void 0:l.isRTL(c.floating)),E=p||(x||!v?[QE(o)]:function(e){const t=QE(e);return[jE(e),t,jE(t)]}(o)),w="none"!==g;!p&&w&&E.push(...JE(o,v,g,S));const T=[o,...E],M=await nw(t,y),A=[];let C=(null==(i=s.flip)?void 0:i.overflows)||[];if(h&&A.push(M[_]),f){const e=function(e,t,n){void 0===n&&(n=!1);const i=HE(e),r=WE(e),s=zE(r);let a="x"===r?i===(n?"end":"start")?"right":"left":"start"===i?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=QE(a)),[a,QE(a)]}(r,a,S);A.push(M[e[0]],M[e[1]])}if(C=[...C,{placement:r,overflows:A}],!A.every(e=>e<=0)){var R,L;const e=((null==(R=s.flip)?void 0:R.index)||0)+1,t=T[e];if(t){if(!("alignment"===f&&b!==VE(t))||C.every(e=>VE(e.placement)!==b||e.overflows[0]>0))return{data:{index:e,overflows:C},reset:{placement:t}}}let n=null==(L=C.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:L.placement;if(!n)switch(m){case"bestFit":{var P;const e=null==(P=C.filter(e=>{if(w){const t=VE(e.placement);return t===b||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:P[0];e&&(n=e);break}case"initialPlacement":n=o}if(r!==n)return{reset:{placement:n}}}return{}}}},ww=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:i,placement:r,rects:s,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=BE(e,t)||{};if(null==c)return{};const d=ZE(u),h={x:n,y:i},f=WE(r),p=zE(f),m=await a.getDimensions(c),g="y"===f,v=g?"top":"left",y=g?"bottom":"right",_=g?"clientHeight":"clientWidth",b=s.reference[p]+s.reference[f]-h[f]-s.floating[p],x=h[f]-s.reference[f],S=await(null==a.getOffsetParent?void 0:a.getOffsetParent(c));let E=S?S[_]:0;E&&await(null==a.isElement?void 0:a.isElement(S))||(E=o.floating[_]||s.floating[p]);const w=b/2-x/2,T=E/2-m[p]/2-1,M=PE(d[v],T),A=PE(d[y],T),C=M,R=E-m[p]-A,L=E/2-m[p]/2+w,P=IE(C,PE(L,R));const I=!l.arrow&&null!=HE(r)&&L!==P&&s.reference[p]/2-(L<C?M:A)-m[p]/2<0,D=I?L<C?L-C:L-R:0;return{[f]:h[f]+D,data:Cr({[f]:P,centerOffset:L-P-D},I&&{alignmentOffset:D}),reset:I}}}),Tw=(e,t,n)=>{const i=new Map,r=Cr({platform:_w},n),s=Cr(Cr({},r.platform),{},{_c:i});return(async(e,t,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:a}=n,o=s.filter(Boolean),l=await(null==a.isRTL?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:r}),{x:u,y:d}=tw(c,i,l),h=i,f={},p=0;for(let m=0;m<o.length;m++){const{name:n,fn:s}=o[m],{x:g,y:v,data:y,reset:_}=await s({x:u,y:d,initialPlacement:i,placement:h,strategy:r,middlewareData:f,rects:c,platform:a,elements:{reference:e,floating:t}});u=null!=g?g:u,d=null!=v?v:d,f=Cr(Cr({},f),{},{[n]:Cr(Cr({},f[n]),y)}),_&&p<=50&&(p++,"object"===typeof _&&(_.placement&&(h=_.placement),_.rects&&(c=!0===_.rects?await a.getElementRects({reference:e,floating:t,strategy:r}):_.rects),({x:u,y:d}=tw(c,h,l))),m=-1)}return{x:u,y:d,placement:h,strategy:r,middlewareData:f}})(e,t,Cr(Cr({},r),{},{platform:s}))};var Mw="undefined"!==typeof document?t.useLayoutEffect:function(){};function Aw(e,t){if(e===t)return!0;if(typeof e!==typeof t)return!1;if("function"===typeof e&&e.toString()===t.toString())return!0;let n,i,r;if(e&&t&&"object"===typeof e){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(i=n;0!==i--;)if(!Aw(e[i],t[i]))return!1;return!0}if(r=Object.keys(e),n=r.length,n!==Object.keys(t).length)return!1;for(i=n;0!==i--;)if(!{}.hasOwnProperty.call(t,r[i]))return!1;for(i=n;0!==i--;){const n=r[i];if(("_owner"!==n||!e.$$typeof)&&!Aw(e[n],t[n]))return!1}return!0}return e!==e&&t!==t}function Cw(e){if("undefined"===typeof window)return 1;return(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Rw(e,t){const n=Cw(e);return Math.round(t*n)/n}function Lw(e){const n=t.useRef(e);return Mw(()=>{n.current=e}),n}const Pw=(e,t)=>Cr(Cr({},Sw(e)),{},{options:[e,t]}),Iw=(e,t)=>Cr(Cr({},(e=>({name:"arrow",options:e,fn(t){const{element:n,padding:i}="function"===typeof e?e(t):e;return n&&(r=n,{}.hasOwnProperty.call(r,"current"))?null!=n.current?ww({element:n.current,padding:i}).fn(t):{}:n?ww({element:n,padding:i}).fn(t):{};var r}}))(e)),{},{options:[e,t]}),Dw=["transform"],kw=["context","width","height","tipRadius","strokeWidth","staticOffset","stroke","d","style"];const Ow="ArrowLeft",Nw="ArrowRight",Fw="ArrowUp",Bw="ArrowDown";const Uw=[Ow,Nw],Hw=[Fw,Bw],zw=Cr({},i);let Gw=!1,Vw=0;const Ww=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Vw++;const jw=zw.useId||function(){const[e,n]=t.useState(()=>Gw?Ww():void 0);return tE(()=>{null==e&&n(Ww())},[]),t.useEffect(()=>{Gw=!0},[]),e};const Yw=t.forwardRef(function(e,n){const{context:{placement:i,elements:{floating:r},middlewareData:{arrow:s,shift:a}},width:o=14,height:l=7,tipRadius:c=0,strokeWidth:u=0,staticOffset:h,stroke:f,d:m,style:{transform:g}={}}=e,v=d(e.style,Dw),y=d(e,kw);const _=jw(),[b,x]=t.useState(!1);if(tE(()=>{if(!r)return;"rtl"===wE(r).direction&&x(!0)},[r]),!r)return null;const[S,E]=i.split("-"),w="top"===S||"bottom"===S;let T=h;(w&&null!=a&&a.x||!w&&null!=a&&a.y)&&(T=null);const M=2*u,A=M/2,C=o/2*(c/-8+1),R=l/2*c/4,L=!!m,P=T&&"end"===E?"bottom":"top";let I=T&&"end"===E?"right":"left";T&&b&&(I="end"===E?"left":"right");const D=null!=(null==s?void 0:s.x)?T||s.x:"",k=null!=(null==s?void 0:s.y)?T||s.y:"",O=m||"M0,0 H"+o+" L"+(o-C)+","+(l-R)+" Q"+o/2+","+l+" "+C+","+(l-R)+" Z",N={top:L?"rotate(180deg)":"",left:L?"rotate(90deg)":"rotate(-90deg)",bottom:L?"":"rotate(180deg)",right:L?"rotate(-90deg)":"rotate(90deg)"}[S];return(0,p.jsxs)("svg",Cr(Cr({},y),{},{"aria-hidden":!0,ref:n,width:L?o:o+M,height:o,viewBox:"0 0 "+o+" "+(l>o?l:o),style:Cr({position:"absolute",pointerEvents:"none",[I]:D,[P]:k,[S]:w||L?"100%":"calc(100% - "+M/2+"px)",transform:[N,g].filter(e=>!!e).join(" ")},v),children:[M>0&&(0,p.jsx)("path",{clipPath:"url(#"+_+")",fill:"none",stroke:f,strokeWidth:M+(m?0:1),d:O}),(0,p.jsx)("path",{stroke:M&&!m?y.fill:"none",d:O}),(0,p.jsx)("clipPath",{id:_,children:(0,p.jsx)("rect",{x:-A,y:A*(L?-1:1),width:o+M,height:o})})]}))});function Xw(){const e=new Map;return{emit(t,n){var i;null==(i=e.get(t))||i.forEach(e=>e(n))},on(t,n){e.has(t)||e.set(t,new Set),e.get(t).add(n)},off(t,n){var i;null==(i=e.get(t))||i.delete(n)}}}const Kw=t.createContext(null),qw=t.createContext(null),Jw=()=>{var e;return(null==(e=t.useContext(Kw))?void 0:e.id)||null},Qw=()=>t.useContext(qw);function Zw(e){const{open:n=!1,onOpenChange:i,elements:r}=e,s=jw(),a=t.useRef({}),[o]=t.useState(()=>Xw()),l=null!=Jw();const[c,u]=t.useState(r.reference),d=function(e){const n=t.useRef(()=>{});return nE(()=>{n.current=e}),t.useCallback(function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return null==n.current?void 0:n.current(...t)},[])}((e,t,n)=>{a.current.openEvent=e?t:void 0,o.emit("openchange",{open:e,event:t,reason:n,nested:l}),null==i||i(e,t,n)}),h=t.useMemo(()=>({setPositionReference:u}),[]),f=t.useMemo(()=>({reference:c||r.reference||null,floating:r.floating||null,domReference:r.reference}),[c,r.reference,r.floating]);return t.useMemo(()=>({dataRef:a,open:n,onOpenChange:d,elements:f,events:o,floatingId:s,refs:h}),[n,d,f,o,s,h])}function $w(e){void 0===e&&(e={});const{nodeId:n}=e,i=Zw(Cr(Cr({},e),{},{elements:Cr({reference:null,floating:null},e.elements)})),r=e.rootContext||i,s=r.elements,[a,o]=t.useState(null),[l,c]=t.useState(null),u=(null==s?void 0:s.domReference)||a,d=t.useRef(null),h=Qw();tE(()=>{u&&(d.current=u)},[u]);const f=function(e){void 0===e&&(e={});const{placement:n="bottom",strategy:i="absolute",middleware:r=[],platform:s,elements:{reference:a,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=e,[d,h]=t.useState({x:0,y:0,strategy:i,placement:n,middlewareData:{},isPositioned:!1}),[f,p]=t.useState(r);Aw(f,r)||p(r);const[m,g]=t.useState(null),[v,y]=t.useState(null),_=t.useCallback(e=>{e!==E.current&&(E.current=e,g(e))},[]),b=t.useCallback(e=>{e!==w.current&&(w.current=e,y(e))},[]),x=a||m,S=o||v,E=t.useRef(null),w=t.useRef(null),T=t.useRef(d),M=null!=c,A=Lw(c),C=Lw(s),R=Lw(u),L=t.useCallback(()=>{if(!E.current||!w.current)return;const e={placement:n,strategy:i,middleware:f};C.current&&(e.platform=C.current),Tw(E.current,w.current,e).then(e=>{const t=Cr(Cr({},e),{},{isPositioned:!1!==R.current});P.current&&!Aw(T.current,t)&&(T.current=t,LE.flushSync(()=>{h(t)}))})},[f,n,i,C,R]);Mw(()=>{!1===u&&T.current.isPositioned&&(T.current.isPositioned=!1,h(e=>Cr(Cr({},e),{},{isPositioned:!1})))},[u]);const P=t.useRef(!1);Mw(()=>(P.current=!0,()=>{P.current=!1}),[]),Mw(()=>{if(x&&(E.current=x),S&&(w.current=S),x&&S){if(A.current)return A.current(x,S,L);L()}},[x,S,L,A,M]);const I=t.useMemo(()=>({reference:E,floating:w,setReference:_,setFloating:b}),[_,b]),D=t.useMemo(()=>({reference:x,floating:S}),[x,S]),k=t.useMemo(()=>{const e={position:i,left:0,top:0};if(!D.floating)return e;const t=Rw(D.floating,d.x),n=Rw(D.floating,d.y);return l?Cr(Cr({},e),{},{transform:"translate("+t+"px, "+n+"px)"},Cw(D.floating)>=1.5&&{willChange:"transform"}):{position:i,left:t,top:n}},[i,l,D.floating,d.x,d.y]);return t.useMemo(()=>Cr(Cr({},d),{},{update:L,refs:I,elements:D,floatingStyles:k}),[d,L,I,D,k])}(Cr(Cr({},e),{},{elements:Cr(Cr({},s),l&&{reference:l})})),p=t.useCallback(e=>{const t=lE(e)?{getBoundingClientRect:()=>e.getBoundingClientRect(),getClientRects:()=>e.getClientRects(),contextElement:e}:e;c(t),f.refs.setReference(t)},[f.refs]),m=t.useCallback(e=>{(lE(e)||null===e)&&(d.current=e,o(e)),(lE(f.refs.reference.current)||null===f.refs.reference.current||null!==e&&!lE(e))&&f.refs.setReference(e)},[f.refs]),g=t.useMemo(()=>Cr(Cr({},f.refs),{},{setReference:m,setPositionReference:p,domReference:d}),[f.refs,m,p]),v=t.useMemo(()=>Cr(Cr({},f.elements),{},{domReference:u}),[f.elements,u]),y=t.useMemo(()=>Cr(Cr(Cr({},f),r),{},{refs:g,elements:v,nodeId:n}),[f,g,v,n,r]);return tE(()=>{r.dataRef.current.floatingContext=y;const e=null==h?void 0:h.nodesRef.current.find(e=>e.id===n);e&&(e.context=y)}),t.useMemo(()=>Cr(Cr({},f),{},{context:y,refs:g,elements:v}),[f,g,v,y])}var eT=function(e,t){return eT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},eT(e,t)};function tT(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}eT(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var nT=function(){return nT=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},nT.apply(this,arguments)};function iT(e,t,n){if(n||2===arguments.length)for(var i,r=0,s=t.length;r<s;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}"function"===typeof SuppressedError&&SuppressedError;var rT,sT=function(e){var n=e.showTimeSelectOnly,i=void 0!==n&&n,r=e.showTime,s=void 0!==r&&r,a=e.className,o=e.children,l=e.inline,c=i?"Choose Time":"Choose Date".concat(s?" and Time":"");return t.createElement("div",{className:a,"aria-label":c,role:l?void 0:"dialog","aria-modal":l?void 0:"true"},o)},aT=function(e){var n=e.children,i=e.onClickOutside,r=e.className,s=e.containerRef,a=e.style,o=function(e,n){var i=(0,t.useRef)(null),r=(0,t.useRef)(e);(0,t.useEffect)(function(){r.current=e},[e]);var s=(0,t.useCallback)(function(e){var t,s=e.composed&&e.composedPath&&e.composedPath().find(function(e){return e instanceof Node})||e.target;i.current&&!i.current.contains(s)&&(n&&s instanceof HTMLElement&&s.classList.contains(n)||null===(t=r.current)||void 0===t||t.call(r,e))},[n]);return(0,t.useEffect)(function(){return document.addEventListener("mousedown",s),function(){document.removeEventListener("mousedown",s)}},[s]),i}(i,e.ignoreClass);return t.createElement("div",{className:r,style:a,ref:function(e){o.current=e,s&&(s.current=e)}},n)};function oT(){return"undefined"!==typeof window?window:globalThis}!function(e){e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.PageUp="PageUp",e.PageDown="PageDown",e.Home="Home",e.End="End",e.Enter="Enter",e.Space=" ",e.Tab="Tab",e.Escape="Escape",e.Backspace="Backspace",e.X="x"}(rT||(rT={}));function lT(e){if(null==e)return new Date;var t="string"===typeof e?Y_(e):j_(e);return uT(t)?t:new Date}function cT(e,t,n,i,r){void 0===r&&(r=lT());for(var s=RT(n)||RT(CT()),a=0,o=Array.isArray(t)?t:[t];a<o.length;a++){var l=o[a],c=Px(e,l,r,{locale:s,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});if(uT(c)&&(!i||e===dT(c,l,n)))return c}return null}function uT(e,t){return kx(e)&&!Ox(e,new Date("1/1/1800"))}function dT(e,t,n){if("en"===n)return rS(e,t,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var i=n?RT(n):void 0;return n&&!i&&console.warn('A locale object was not found for the provided string ["'.concat(n,'"].')),rS(e,t,{locale:i=i||RT(CT()),useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function hT(e,t){var n=t.dateFormat,i=t.locale,r=Array.isArray(n)&&n.length>0?n[0]:n;return e&&dT(e,r,i)||""}function fT(e,t){var n=t.hour,i=void 0===n?0:n,r=t.minute,s=void 0===r?0:r,a=t.second;return aS(oS(lS(e,void 0===a?0:a),s),i)}function pT(e){return Fx(e)}function mT(e,t,n){return ox(e,{locale:RT(t||CT()),weekStartsOn:n})}function gT(e){return cS(e)}function vT(e){return Ux(e)}function yT(e){return uS(e)}function _T(){return Fx(lT())}function bT(e){return dS(e)}function xT(e){return fS(e)}function ST(e,t){return e&&t?pS(e,t):!e&&!t}function ET(e,t){return e&&t?mS(e,t):!e&&!t}function wT(e,t){return e&&t?gS(e,t):!e&&!t}function TT(e,t){return e&&t?vS(e,t):!e&&!t}function MT(e,t){return e&&t?yS(e,t):!e&&!t}function AT(e,t,n){var i,r=Fx(t),s=dS(n);try{i=_S(e,{start:r,end:s})}catch(One){i=!1}return i}function CT(){return oT().__localeId__}function RT(e){if("string"===typeof e){var t=oT();return t.__localeData__?t.__localeData__[e]:void 0}return e}function LT(e,t){return dT(xS(lT(),e),"LLLL",t)}function PT(e,t){return dT(xS(lT(),e),"LLL",t)}function IT(e,t){var n=void 0===t?{}:t,i=n.minDate,r=n.maxDate,s=n.excludeDates,a=n.excludeDateIntervals,o=n.includeDates,l=n.includeDateIntervals,c=n.filterDate;return!!n.disabled||(zT(e,{minDate:i,maxDate:r})||s&&s.some(function(t){return t instanceof Date?TT(e,t):TT(e,t.date)})||a&&a.some(function(t){var n=t.start,i=t.end;return _S(e,{start:n,end:i})})||o&&!o.some(function(t){return TT(e,t)})||l&&!l.some(function(t){var n=t.start,i=t.end;return _S(e,{start:n,end:i})})||c&&!c(lT(e))||!1)}function DT(e,t){var n=void 0===t?{}:t,i=n.excludeDates,r=n.excludeDateIntervals;return r&&r.length>0?r.some(function(t){var n=t.start,i=t.end;return _S(e,{start:n,end:i})}):i&&i.some(function(t){var n;return t instanceof Date?TT(e,t):TT(e,null!==(n=t.date)&&void 0!==n?n:new Date)})||!1}function kT(e,t){var n=void 0===t?{}:t,i=n.minDate,r=n.maxDate,s=n.excludeDates,a=n.includeDates,o=n.filterDate;return zT(e,{minDate:i?cS(i):void 0,maxDate:r?fS(r):void 0})||(null===s||void 0===s?void 0:s.some(function(t){return ET(e,t instanceof Date?t:t.date)}))||a&&!a.some(function(t){return ET(e,t)})||o&&!o(lT(e))||!1}function OT(e,t,n,i){var r=ES(e),s=wS(e),a=ES(t),o=wS(t),l=ES(i);return r===a&&r===l?s<=n&&n<=o:r<a&&(l===r&&s<=n||l===a&&o>=n||l<a&&l>r)}function NT(e,t){var n=void 0===t?{}:t,i=n.minDate,r=n.maxDate,s=n.excludeDates,a=n.includeDates;return zT(e,{minDate:i,maxDate:r})||s&&s.some(function(t){return ET(t instanceof Date?t:t.date,e)})||a&&!a.some(function(t){return ET(t,e)})||!1}function FT(e,t){var n=void 0===t?{}:t,i=n.minDate,r=n.maxDate,s=n.excludeDates,a=n.includeDates,o=n.filterDate;return!!n.disabled||(zT(e,{minDate:i,maxDate:r})||(null===s||void 0===s?void 0:s.some(function(t){return wT(e,t instanceof Date?t:t.date)}))||a&&!a.some(function(t){return wT(e,t)})||o&&!o(lT(e))||!1)}function BT(e,t,n){if(!t||!n)return!1;if(!kx(t)||!kx(n))return!1;var i=ES(t),r=ES(n);return i<=e&&r>=e}function UT(e,t){var n=void 0===t?{}:t,i=n.minDate,r=n.maxDate,s=n.excludeDates,a=n.includeDates,o=n.filterDate;if(n.disabled)return!0;var l=new Date(e,0,1);return zT(l,{minDate:i?Ux(i):void 0,maxDate:r?TS(r):void 0})||(null===s||void 0===s?void 0:s.some(function(e){return ST(l,e instanceof Date?e:e.date)}))||a&&!a.some(function(e){return ST(l,e)})||o&&!o(lT(l))||!1}function HT(e,t,n,i){var r=ES(e),s=MS(e),a=ES(t),o=MS(t),l=ES(i);return r===a&&r===l?s<=n&&n<=o:r<a&&(l===r&&s<=n||l===a&&o>=n||l<a&&l>r)}function zT(e,t){var n,i=void 0===t?{}:t,r=i.minDate,s=i.maxDate;return null!==(n=r&&Bx(e,r)<0||s&&Bx(e,s)>0)&&void 0!==n&&n}function GT(e,t){return t.some(function(t){return AS(t)===AS(e)&&CS(t)===CS(e)&&RS(t)===RS(e)})}function VT(e,t){var n=void 0===t?{}:t,i=n.excludeTimes,r=n.includeTimes,s=n.filterTime;return i&&GT(e,i)||r&&!GT(e,r)||s&&!s(e)||!1}function WT(e,t){var n=t.minTime,i=t.maxTime;if(!n||!i)throw new Error("Both minTime and maxTime props required");var r=lT();r=lS(r=oS(r=aS(r,AS(e)),CS(e)),RS(e));var s=lT();s=lS(s=oS(s=aS(s,AS(n)),CS(n)),RS(n));var a,o=lT();o=lS(o=oS(o=aS(o,AS(i)),CS(i)),RS(i));try{a=!_S(r,{start:s,end:o})}catch(One){a=!1}return a}function jT(e,t){var n=void 0===t?{}:t,i=n.minDate,r=n.includeDates,s=PS(e,1);return i&&IS(i,s)>0||r&&r.every(function(e){return IS(e,s)>0})||!1}function YT(e,t){var n=void 0===t?{}:t,i=n.maxDate,r=n.includeDates,s=LS(e,1);return i&&IS(s,i)>0||r&&r.every(function(e){return IS(s,e)>0})||!1}function XT(e,t){var n=void 0===t?{}:t,i=n.minDate,r=n.includeDates,s=FS(e,1);return i&&BS(i,s)>0||r&&r.every(function(e){return BS(e,s)>0})||!1}function KT(e,t){var n=void 0===t?{}:t,i=n.maxDate,r=n.includeDates,s=NS(e,1);return i&&BS(s,i)>0||r&&r.every(function(e){return BS(s,e)>0})||!1}function qT(e){var t=e.minDate,n=e.includeDates;return n&&t?US(n.filter(function(e){return Bx(e,t)>=0})):n?US(n):t}function JT(e){var t=e.maxDate,n=e.includeDates;return n&&t?HS(n.filter(function(e){return Bx(e,t)<=0})):n?HS(n):t}function QT(e,t){var n;void 0===e&&(e=[]),void 0===t&&(t="react-datepicker__day--highlighted");for(var i=new Map,r=0,s=e.length;r<s;r++){var a=e[r];if(Dx(a)){var o=dT(a,"MM.dd.yyyy");(f=i.get(o)||[]).includes(t)||(f.push(t),i.set(o,f))}else if("object"===typeof a){var l=null!==(n=Object.keys(a)[0])&&void 0!==n?n:"",c=a[l];if("string"===typeof l&&Array.isArray(c))for(var u=0,d=c.length;u<d;u++){var h=c[u];if(h){var f;o=dT(h,"MM.dd.yyyy");(f=i.get(o)||[]).includes(l)||(f.push(l),i.set(o,f))}}}}return i}function ZT(e,t){void 0===e&&(e=[]),void 0===t&&(t="react-datepicker__day--holidays");var n=new Map;return e.forEach(function(e){var i=e.date,r=e.holidayName;if(Dx(i)){var s=dT(i,"MM.dd.yyyy"),a=n.get(s)||{className:"",holidayNames:[]};if(!("className"in a)||a.className!==t||(o=a.holidayNames,l=[r],o.length!==l.length||!o.every(function(e,t){return e===l[t]}))){var o,l;a.className=t;var c=a.holidayNames;a.holidayNames=c?iT(iT([],c,!0),[r],!1):[r],n.set(s,a)}}}),n}function $T(e,t,n,i,r){for(var s=r.length,a=[],o=0;o<s;o++){var l=e,c=r[o];c&&(l=WS(l=VS(l=GS(l,AS(c)),CS(c)),RS(c)));var u=VS(e,(n+1)*i);jS(l,t)&&Ox(l,u)&&void 0!=c&&a.push(c)}return a}function eM(e){return e<10?"0".concat(e):"".concat(e)}function tM(e,t){void 0===t&&(t=12);var n=Math.ceil(ES(e)/t)*t;return{startPeriod:n-(t-1),endPeriod:n}}function nM(e){var t=e.getSeconds(),n=e.getMilliseconds();return j_(e.getTime()-1e3*t-n)}function iM(e){if(!Dx(e))throw new Error("Invalid date");var t=new Date(e);return t.setHours(0,0,0,0),t}function rM(e,t){if(!Dx(e)||!Dx(t))throw new Error("Invalid date received");return Ox(iM(e),iM(t))}function sM(e){return e.key===rT.Space}var aM,oM=function(e){function n(n){var i=e.call(this,n)||this;return i.inputRef=t.createRef(),i.onTimeChange=function(e){var t,n;i.setState({time:e});var r=i.props.date,s=r instanceof Date&&!isNaN(+r)?r:new Date;if(null===e||void 0===e?void 0:e.includes(":")){var a=e.split(":"),o=a[0],l=a[1];s.setHours(Number(o)),s.setMinutes(Number(l))}null===(n=(t=i.props).onChange)||void 0===n||n.call(t,s)},i.renderTimeInput=function(){var e=i.state.time,n=i.props,r=n.date,s=n.timeString,a=n.customTimeInput;return a?(0,t.cloneElement)(a,{date:r,value:e,onChange:i.onTimeChange}):t.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:i.inputRef,onClick:function(){var e;null===(e=i.inputRef.current)||void 0===e||e.focus()},required:!0,value:e,onChange:function(e){i.onTimeChange(e.target.value||s)}})},i.state={time:i.props.timeString},i}return tT(n,e),n.getDerivedStateFromProps=function(e,t){return e.timeString!==t.time?{time:e.timeString}:null},n.prototype.render=function(){return t.createElement("div",{className:"react-datepicker__input-time-container"},t.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),t.createElement("div",{className:"react-datepicker-time__input-container"},t.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},n}(t.Component),lM=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.dayEl=(0,t.createRef)(),n.handleClick=function(e){!n.isDisabled()&&n.props.onClick&&n.props.onClick(e)},n.handleMouseEnter=function(e){!n.isDisabled()&&n.props.onMouseEnter&&n.props.onMouseEnter(e)},n.handleOnKeyDown=function(e){var t,i;e.key===rT.Space&&(e.preventDefault(),e.key=rT.Enter),null===(i=(t=n.props).handleOnKeyDown)||void 0===i||i.call(t,e)},n.isSameDay=function(e){return TT(n.props.day,e)},n.isKeyboardSelected=function(){var e;if(n.props.disabledKeyboardNavigation)return!1;var t=n.props.selectsMultiple?null===(e=n.props.selectedDates)||void 0===e?void 0:e.some(function(e){return n.isSameDayOrWeek(e)}):n.isSameDayOrWeek(n.props.selected),i=n.props.preSelection&&n.isDisabled(n.props.preSelection);return!t&&n.isSameDayOrWeek(n.props.preSelection)&&!i},n.isDisabled=function(e){return void 0===e&&(e=n.props.day),IT(e,{minDate:n.props.minDate,maxDate:n.props.maxDate,excludeDates:n.props.excludeDates,excludeDateIntervals:n.props.excludeDateIntervals,includeDateIntervals:n.props.includeDateIntervals,includeDates:n.props.includeDates,filterDate:n.props.filterDate,disabled:n.props.disabled})},n.isExcluded=function(){return DT(n.props.day,{excludeDates:n.props.excludeDates,excludeDateIntervals:n.props.excludeDateIntervals})},n.isStartOfWeek=function(){return TT(n.props.day,mT(n.props.day,n.props.locale,n.props.calendarStartDay))},n.isSameWeek=function(e){return n.props.showWeekPicker&&TT(e,mT(n.props.day,n.props.locale,n.props.calendarStartDay))},n.isSameDayOrWeek=function(e){return n.isSameDay(e)||n.isSameWeek(e)},n.getHighLightedClass=function(){var e=n.props,t=e.day,i=e.highlightDates;if(!i)return!1;var r=dT(t,"MM.dd.yyyy");return i.get(r)},n.getHolidaysClass=function(){var e,t=n.props,i=t.day,r=t.holidays;if(!r)return[void 0];var s=dT(i,"MM.dd.yyyy");return r.has(s)?[null===(e=r.get(s))||void 0===e?void 0:e.className]:[void 0]},n.isInRange=function(){var e=n.props,t=e.day,i=e.startDate,r=e.endDate;return!(!i||!r)&&AT(t,i,r)},n.isInSelectingRange=function(){var e,t=n.props,i=t.day,r=t.selectsStart,s=t.selectsEnd,a=t.selectsRange,o=t.selectsDisabledDaysInRange,l=t.startDate,c=t.swapRange,u=t.endDate,d=null!==(e=n.props.selectingDate)&&void 0!==e?e:n.props.preSelection;if(!(r||s||a)||!d||!o&&n.isDisabled())return!1;if(r&&u&&(Ox(d,u)||MT(d,u)))return AT(i,d,u);if(s&&l&&(jS(d,l)||MT(d,l)))return AT(i,l,d);if(a&&l&&!u){if(MT(d,l))return AT(i,l,d);if(jS(d,l))return AT(i,l,d);if(c&&Ox(d,l))return AT(i,d,l)}return!1},n.isSelectingRangeStart=function(){var e;if(!n.isInSelectingRange())return!1;var t=n.props,i=t.day,r=t.startDate,s=t.selectsStart,a=t.swapRange,o=t.selectsRange,l=null!==(e=n.props.selectingDate)&&void 0!==e?e:n.props.preSelection;return TT(i,s||o&&a&&r&&l&&Ox(l,r)?l:r)},n.isSelectingRangeEnd=function(){var e;if(!n.isInSelectingRange())return!1;var t=n.props,i=t.day,r=t.endDate,s=t.selectsEnd,a=t.selectsRange,o=t.swapRange,l=t.startDate,c=null!==(e=n.props.selectingDate)&&void 0!==e?e:n.props.preSelection;return TT(i,s?c:a&&o&&l&&c?Ox(c,l)?l:c:a?c:r)},n.isRangeStart=function(){var e=n.props,t=e.day,i=e.startDate,r=e.endDate;return!(!i||!r)&&TT(i,t)},n.isRangeEnd=function(){var e=n.props,t=e.day,i=e.startDate,r=e.endDate;return!(!i||!r)&&TT(r,t)},n.isWeekend=function(){var e=YS(n.props.day);return 0===e||6===e},n.isAfterMonth=function(){return void 0!==n.props.month&&(n.props.month+1)%12===wS(n.props.day)},n.isBeforeMonth=function(){return void 0!==n.props.month&&(wS(n.props.day)+1)%12===n.props.month},n.isCurrentDay=function(){return n.isSameDay(lT())},n.isSelected=function(){var e;return n.props.selectsMultiple?null===(e=n.props.selectedDates)||void 0===e?void 0:e.some(function(e){return n.isSameDayOrWeek(e)}):n.isSameDayOrWeek(n.props.selected)},n.getClassNames=function(e){return U_("react-datepicker__day",n.props.dayClassName?n.props.dayClassName(e):void 0,"react-datepicker__day--"+function(e,t){return dT(e,"ddd",t)}(n.props.day),{"react-datepicker__day--disabled":n.isDisabled(),"react-datepicker__day--excluded":n.isExcluded(),"react-datepicker__day--selected":n.isSelected(),"react-datepicker__day--keyboard-selected":n.isKeyboardSelected(),"react-datepicker__day--range-start":n.isRangeStart(),"react-datepicker__day--range-end":n.isRangeEnd(),"react-datepicker__day--in-range":n.isInRange(),"react-datepicker__day--in-selecting-range":n.isInSelectingRange(),"react-datepicker__day--selecting-range-start":n.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":n.isSelectingRangeEnd(),"react-datepicker__day--today":n.isCurrentDay(),"react-datepicker__day--weekend":n.isWeekend(),"react-datepicker__day--outside-month":n.isAfterMonth()||n.isBeforeMonth()},n.getHighLightedClass(),n.getHolidaysClass())},n.getAriaLabel=function(){var e=n.props,t=e.day,i=e.ariaLabelPrefixWhenEnabled,r=void 0===i?"Choose":i,s=e.ariaLabelPrefixWhenDisabled,a=void 0===s?"Not available":s,o=n.isDisabled()||n.isExcluded()?a:r;return"".concat(o," ").concat(dT(t,"PPPP",n.props.locale))},n.getTitle=function(){var e=n.props,t=e.day,i=e.holidays,r=void 0===i?new Map:i,s=e.excludeDates,a=dT(t,"MM.dd.yyyy"),o=[];return r.has(a)&&o.push.apply(o,r.get(a).holidayNames),n.isExcluded()&&o.push(null===s||void 0===s?void 0:s.filter(function(e){return e instanceof Date?TT(e,t):TT(null===e||void 0===e?void 0:e.date,t)}).map(function(e){if(!(e instanceof Date))return null===e||void 0===e?void 0:e.message})),o.join(", ")},n.getTabIndex=function(){var e=n.props.selected,t=n.props.preSelection;return(!n.props.showWeekPicker||!n.props.showWeekNumber&&n.isStartOfWeek())&&(n.isKeyboardSelected()||n.isSameDay(e)&&TT(t,e))?0:-1},n.handleFocusDay=function(){var e;n.shouldFocusDay()&&(null===(e=n.dayEl.current)||void 0===e||e.focus({preventScroll:!0}))},n.renderDayContents=function(){return n.props.monthShowsDuplicateDaysEnd&&n.isAfterMonth()||n.props.monthShowsDuplicateDaysStart&&n.isBeforeMonth()?null:n.props.renderDayContents?n.props.renderDayContents(XS(n.props.day),n.props.day):XS(n.props.day)},n.render=function(){return t.createElement("div",{ref:n.dayEl,className:n.getClassNames(n.props.day),onKeyDown:n.handleOnKeyDown,onClick:n.handleClick,onMouseEnter:n.props.usePointerEvent?void 0:n.handleMouseEnter,onPointerEnter:n.props.usePointerEvent?n.handleMouseEnter:void 0,tabIndex:n.getTabIndex(),"aria-label":n.getAriaLabel(),role:"gridcell",title:n.getTitle(),"aria-disabled":n.isDisabled(),"aria-current":n.isCurrentDay()?"date":void 0,"aria-selected":n.isSelected()||n.isInRange()},n.renderDayContents(),""!==n.getTitle()&&t.createElement("span",{className:"overlay"},n.getTitle()))},n}return tT(n,e),n.prototype.componentDidMount=function(){this.handleFocusDay()},n.prototype.componentDidUpdate=function(){this.handleFocusDay()},n.prototype.shouldFocusDay=function(){var e=!1;return 0===this.getTabIndex()&&this.isSameDay(this.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(e=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(e=!1),this.isDayActiveElement()&&(e=!0),this.isDuplicateDay()&&(e=!1)),e},n.prototype.isDayActiveElement=function(){var e,t,n;return(null===(t=null===(e=this.props.containerRef)||void 0===e?void 0:e.current)||void 0===t?void 0:t.contains(document.activeElement))&&(null===(n=document.activeElement)||void 0===n?void 0:n.classList.contains("react-datepicker__day"))},n.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},n}(t.Component),cM=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.weekNumberEl=(0,t.createRef)(),n.handleClick=function(e){n.props.onClick&&n.props.onClick(e)},n.handleOnKeyDown=function(e){var t,i;e.key===rT.Space&&(e.preventDefault(),e.key=rT.Enter),null===(i=(t=n.props).handleOnKeyDown)||void 0===i||i.call(t,e)},n.isKeyboardSelected=function(){return!n.props.disabledKeyboardNavigation&&!TT(n.props.date,n.props.selected)&&TT(n.props.date,n.props.preSelection)},n.getTabIndex=function(){return n.props.showWeekPicker&&n.props.showWeekNumber&&(n.isKeyboardSelected()||TT(n.props.date,n.props.selected)&&TT(n.props.preSelection,n.props.selected))?0:-1},n.handleFocusWeekNumber=function(e){var t=!1;0===n.getTabIndex()&&!(null===e||void 0===e?void 0:e.isInputFocused)&&TT(n.props.date,n.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(t=!0),n.props.inline&&!n.props.shouldFocusDayInline&&(t=!1),n.props.containerRef&&n.props.containerRef.current&&n.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(t=!0)),t&&n.weekNumberEl.current&&n.weekNumberEl.current.focus({preventScroll:!0})},n}return tT(n,e),Object.defineProperty(n,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},n.prototype.componentDidUpdate=function(e){this.handleFocusWeekNumber(e)},n.prototype.render=function(){var e=this.props,i=e.weekNumber,r=e.isWeekDisabled,s=e.ariaLabelPrefix,a=void 0===s?n.defaultProps.ariaLabelPrefix:s,o=e.onClick,l={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!o&&!r,"react-datepicker__week-number--selected":!!o&&TT(this.props.date,this.props.selected)};return t.createElement("div",{ref:this.weekNumberEl,className:U_(l),"aria-label":"".concat(a," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex(),role:"gridcell"},i)},n}(t.Component),uM=function(e){function n(){var i=null!==e&&e.apply(this,arguments)||this;return i.isDisabled=function(e){return IT(e,{minDate:i.props.minDate,maxDate:i.props.maxDate,excludeDates:i.props.excludeDates,excludeDateIntervals:i.props.excludeDateIntervals,includeDateIntervals:i.props.includeDateIntervals,includeDates:i.props.includeDates,filterDate:i.props.filterDate})},i.handleDayClick=function(e,t){i.props.onDayClick&&i.props.onDayClick(e,t)},i.handleDayMouseEnter=function(e){i.props.onDayMouseEnter&&i.props.onDayMouseEnter(e)},i.handleWeekClick=function(e,t,r){for(var s,a,o,l=new Date(e),c=0;c<7;c++){var u=new Date(e);if(u.setDate(u.getDate()+c),!i.isDisabled(u)){l=u;break}}"function"===typeof i.props.onWeekSelect&&i.props.onWeekSelect(l,t,r),i.props.showWeekPicker&&i.handleDayClick(l,r),(null!==(s=i.props.shouldCloseOnSelect)&&void 0!==s?s:n.defaultProps.shouldCloseOnSelect)&&(null===(o=(a=i.props).setOpen)||void 0===o||o.call(a,!1))},i.formatWeekNumber=function(e){return i.props.formatWeekNumber?i.props.formatWeekNumber(e):function(e){return mx(e)}(e)},i.isWeekDisabled=function(){for(var e=i.startOfWeek(),t=_x(e,6),n=new Date(e);n<=t;){if(!i.isDisabled(n))return!1;n=_x(n,1)}return!0},i.renderDays=function(){var e=i.startOfWeek(),r=[],s=i.formatWeekNumber(e);if(i.props.showWeekNumber){var a=i.props.onWeekSelect||i.props.showWeekPicker?i.handleWeekClick.bind(i,e,s):void 0;r.push(t.createElement(cM,nT({key:"W"},n.defaultProps,i.props,{weekNumber:s,isWeekDisabled:i.isWeekDisabled(),date:e,onClick:a})))}return r.concat([0,1,2,3,4,5,6].map(function(r){var s=_x(e,r);return t.createElement(lM,nT({},n.defaultProps,i.props,{ariaLabelPrefixWhenEnabled:i.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:i.props.disabledDayAriaLabelPrefix,key:s.valueOf(),day:s,onClick:i.handleDayClick.bind(i,s),onMouseEnter:i.handleDayMouseEnter.bind(i,s)}))}))},i.startOfWeek=function(){return mT(i.props.day,i.props.locale,i.props.calendarStartDay)},i.isKeyboardSelected=function(){return!i.props.disabledKeyboardNavigation&&!TT(i.startOfWeek(),i.props.selected)&&TT(i.startOfWeek(),i.props.preSelection)},i}return tT(n,e),Object.defineProperty(n,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),n.prototype.render=function(){var e={"react-datepicker__week":!0,"react-datepicker__week--selected":TT(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()},n=this.props.weekClassName?this.props.weekClassName(this.startOfWeek()):void 0;return t.createElement("div",{className:U_(e,n),role:"row"},this.renderDays())},n}(t.Component),dM="two_columns",hM="three_columns",fM="four_columns",pM=((aM={})[dM]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},aM[hM]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},aM[fM]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},aM);function mM(e,t){return e?fM:t?dM:hM}var gM=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.MONTH_REFS=iT([],Array(12),!0).map(function(){return(0,t.createRef)()}),n.QUARTER_REFS=iT([],Array(4),!0).map(function(){return(0,t.createRef)()}),n.isDisabled=function(e){return IT(e,{minDate:n.props.minDate,maxDate:n.props.maxDate,excludeDates:n.props.excludeDates,excludeDateIntervals:n.props.excludeDateIntervals,includeDateIntervals:n.props.includeDateIntervals,includeDates:n.props.includeDates,filterDate:n.props.filterDate,disabled:n.props.disabled})},n.isExcluded=function(e){return DT(e,{excludeDates:n.props.excludeDates,excludeDateIntervals:n.props.excludeDateIntervals})},n.handleDayClick=function(e,t){var i,r;null===(r=(i=n.props).onDayClick)||void 0===r||r.call(i,e,t,n.props.orderInDisplay)},n.handleDayMouseEnter=function(e){var t,i;null===(i=(t=n.props).onDayMouseEnter)||void 0===i||i.call(t,e)},n.handleMouseLeave=function(){var e,t;null===(t=(e=n.props).onMouseLeave)||void 0===t||t.call(e)},n.isRangeStartMonth=function(e){var t=n.props,i=t.day,r=t.startDate,s=t.endDate;return!(!r||!s)&&ET(xS(i,e),r)},n.isRangeStartQuarter=function(e){var t=n.props,i=t.day,r=t.startDate,s=t.endDate;return!(!r||!s)&&wT(SS(i,e),r)},n.isRangeEndMonth=function(e){var t=n.props,i=t.day,r=t.startDate,s=t.endDate;return!(!r||!s)&&ET(xS(i,e),s)},n.isRangeEndQuarter=function(e){var t=n.props,i=t.day,r=t.startDate,s=t.endDate;return!(!r||!s)&&wT(SS(i,e),s)},n.isInSelectingRangeMonth=function(e){var t,i=n.props,r=i.day,s=i.selectsStart,a=i.selectsEnd,o=i.selectsRange,l=i.startDate,c=i.endDate,u=null!==(t=n.props.selectingDate)&&void 0!==t?t:n.props.preSelection;return!(!(s||a||o)||!u)&&(s&&c?OT(u,c,e,r):(a&&l||!(!o||!l||c))&&OT(l,u,e,r))},n.isSelectingMonthRangeStart=function(e){var t;if(!n.isInSelectingRangeMonth(e))return!1;var i=n.props,r=i.day,s=i.startDate,a=i.selectsStart,o=xS(r,e),l=null!==(t=n.props.selectingDate)&&void 0!==t?t:n.props.preSelection;return ET(o,a?l:s)},n.isSelectingMonthRangeEnd=function(e){var t;if(!n.isInSelectingRangeMonth(e))return!1;var i=n.props,r=i.day,s=i.endDate,a=i.selectsEnd,o=i.selectsRange,l=xS(r,e),c=null!==(t=n.props.selectingDate)&&void 0!==t?t:n.props.preSelection;return ET(l,a||o?c:s)},n.isInSelectingRangeQuarter=function(e){var t,i=n.props,r=i.day,s=i.selectsStart,a=i.selectsEnd,o=i.selectsRange,l=i.startDate,c=i.endDate,u=null!==(t=n.props.selectingDate)&&void 0!==t?t:n.props.preSelection;return!(!(s||a||o)||!u)&&(s&&c?HT(u,c,e,r):(a&&l||!(!o||!l||c))&&HT(l,u,e,r))},n.isWeekInMonth=function(e){var t=n.props.day,i=_x(e,6);return ET(e,t)||ET(i,t)},n.isCurrentMonth=function(e,t){return ES(e)===ES(lT())&&t===wS(lT())},n.isCurrentQuarter=function(e,t){return ES(e)===ES(lT())&&t===MS(lT())},n.isSelectedMonth=function(e,t,n){return wS(n)===t&&ES(e)===ES(n)},n.isSelectMonthInList=function(e,t,i){return i.some(function(i){return n.isSelectedMonth(e,t,i)})},n.isSelectedQuarter=function(e,t,n){return MS(n)===t&&ES(e)===ES(n)},n.isSelectQuarterInList=function(e,t,i){return i.some(function(i){return n.isSelectedQuarter(e,t,i)})},n.isMonthSelected=function(){var e=n.props,t=e.day,i=e.selected,r=e.selectedDates,s=e.selectsMultiple,a=wS(t);return s?null===r||void 0===r?void 0:r.some(function(e){return n.isSelectedMonth(t,a,e)}):!!i&&n.isSelectedMonth(t,a,i)},n.isQuarterSelected=function(){var e=n.props,t=e.day,i=e.selected,r=e.selectedDates,s=e.selectsMultiple,a=MS(t);return s?null===r||void 0===r?void 0:r.some(function(e){return n.isSelectedQuarter(t,a,e)}):!!i&&n.isSelectedQuarter(t,a,i)},n.renderWeeks=function(){if(!uT(n.props.day))return[];for(var e=[],i=n.props.fixedHeight,r=0,s=!1,a=mT(gT(n.props.day),n.props.locale,n.props.calendarStartDay),o=n.props.selected?function(e){return n.props.showWeekPicker?mT(e,n.props.locale,n.props.calendarStartDay):n.props.selected}(n.props.selected):void 0,l=n.props.preSelection?function(e){return n.props.showWeekPicker?mT(e,n.props.locale,n.props.calendarStartDay):n.props.preSelection}(n.props.preSelection):void 0;e.push(t.createElement(uM,nT({},n.props,{ariaLabelPrefix:n.props.weekAriaLabelPrefix,key:r,day:a,month:wS(n.props.day),onDayClick:n.handleDayClick,onDayMouseEnter:n.handleDayMouseEnter,selected:o,preSelection:l,showWeekNumber:n.props.showWeekNumbers}))),!s;){r++,a=KS(a,1);var c=i&&r>=6,u=!i&&!n.isWeekInMonth(a);if(c||u){if(!n.props.peekNextMonth)break;s=!0}}return e},n.onMonthClick=function(e,t){var i=n.isMonthDisabledForLabelDate(t),r=i.isDisabled,s=i.labelDate;r||n.handleDayClick(gT(s),e)},n.onMonthMouseEnter=function(e){var t=n.isMonthDisabledForLabelDate(e),i=t.isDisabled,r=t.labelDate;i||n.handleDayMouseEnter(gT(r))},n.handleMonthNavigation=function(e,t){var i,r,s,a;null===(r=(i=n.props).setPreSelection)||void 0===r||r.call(i,t),null===(a=null===(s=n.MONTH_REFS[e])||void 0===s?void 0:s.current)||void 0===a||a.focus()},n.handleKeyboardNavigation=function(e,t,i){var r,s=n.props,a=s.selected,o=s.preSelection,l=s.setPreSelection,c=s.minDate,u=s.maxDate,d=s.showFourColumnMonthYearPicker,h=s.showTwoColumnMonthYearPicker;if(o){var f=mM(d,h),p=n.getVerticalOffset(f),m=null===(r=pM[f])||void 0===r?void 0:r.grid,g=function(e,t,n){var i,r,s=t,a=n;switch(e){case rT.ArrowRight:s=LS(t,1),a=11===n?0:n+1;break;case rT.ArrowLeft:s=PS(t,1),a=0===n?11:n-1;break;case rT.ArrowUp:s=PS(t,p),a=(null===(i=null===m||void 0===m?void 0:m[0])||void 0===i?void 0:i.includes(n))?n+12-p:n-p;break;case rT.ArrowDown:s=LS(t,p),a=(null===(r=null===m||void 0===m?void 0:m[m.length-1])||void 0===r?void 0:r.includes(n))?n-12+p:n+p}return{newCalculatedDate:s,newCalculatedMonth:a}};if(t!==rT.Enter){var v=function(e,t,i){for(var r=e,s=!1,a=0,o=g(r,t,i),l=o.newCalculatedDate,d=o.newCalculatedMonth;!s;){if(a>=40){l=t,d=i;break}var h;if(c&&l<c)r=rT.ArrowRight,l=(h=g(r,l,d)).newCalculatedDate,d=h.newCalculatedMonth;if(u&&l>u)r=rT.ArrowLeft,l=(h=g(r,l,d)).newCalculatedDate,d=h.newCalculatedMonth;if(NT(l,n.props))l=(h=g(r,l,d)).newCalculatedDate,d=h.newCalculatedMonth;else s=!0;a++}return{newCalculatedDate:l,newCalculatedMonth:d}}(t,o,i),y=v.newCalculatedDate,_=v.newCalculatedMonth;switch(t){case rT.ArrowRight:case rT.ArrowLeft:case rT.ArrowUp:case rT.ArrowDown:n.handleMonthNavigation(_,y)}}else n.isMonthDisabled(i)||(n.onMonthClick(e,i),null===l||void 0===l||l(a))}},n.getVerticalOffset=function(e){var t,n;return null!==(n=null===(t=pM[e])||void 0===t?void 0:t.verticalNavigationOffset)&&void 0!==n?n:0},n.onMonthKeyDown=function(e,t){var i=n.props,r=i.disabledKeyboardNavigation,s=i.handleOnMonthKeyDown,a=e.key;a!==rT.Tab&&e.preventDefault(),r||n.handleKeyboardNavigation(e,a,t),s&&s(e)},n.onQuarterClick=function(e,t){var i=SS(n.props.day,t);FT(i,n.props)||n.handleDayClick(yT(i),e)},n.onQuarterMouseEnter=function(e){var t=SS(n.props.day,e);FT(t,n.props)||n.handleDayMouseEnter(yT(t))},n.handleQuarterNavigation=function(e,t){var i,r,s,a;n.isDisabled(t)||n.isExcluded(t)||(null===(r=(i=n.props).setPreSelection)||void 0===r||r.call(i,t),null===(a=null===(s=n.QUARTER_REFS[e-1])||void 0===s?void 0:s.current)||void 0===a||a.focus())},n.onQuarterKeyDown=function(e,t){var i,r,s=e.key;if(!n.props.disabledKeyboardNavigation)switch(s){case rT.Enter:n.onQuarterClick(e,t),null===(r=(i=n.props).setPreSelection)||void 0===r||r.call(i,n.props.selected);break;case rT.ArrowRight:if(!n.props.preSelection)break;n.handleQuarterNavigation(4===t?1:t+1,DS(n.props.preSelection,1));break;case rT.ArrowLeft:if(!n.props.preSelection)break;n.handleQuarterNavigation(1===t?4:t-1,kS(n.props.preSelection,1))}},n.isMonthDisabledForLabelDate=function(e){var t,i=n.props,r=i.day,s=i.disabled,a=i.minDate,o=i.maxDate,l=i.excludeDates,c=i.includeDates,u=xS(r,e);return s?{isDisabled:!0,labelDate:xS(r,e)}:{isDisabled:null!==(t=(a||o||l||c)&&kT(u,n.props))&&void 0!==t&&t,labelDate:u}},n.isMonthDisabled=function(e){return n.isMonthDisabledForLabelDate(e).isDisabled},n.getMonthClassNames=function(e){var t=n.props,i=t.day,r=t.startDate,s=t.endDate,a=t.preSelection,o=t.monthClassName,l=o?o(xS(i,e)):void 0,c=n.getSelection();return U_("react-datepicker__month-text","react-datepicker__month-".concat(e),l,{"react-datepicker__month-text--disabled":n.isMonthDisabled(e),"react-datepicker__month-text--selected":c?n.isSelectMonthInList(i,e,c):void 0,"react-datepicker__month-text--keyboard-selected":!n.props.disabledKeyboardNavigation&&a&&n.isSelectedMonth(i,e,a)&&!n.isMonthSelected()&&!n.isMonthDisabled(e),"react-datepicker__month-text--in-selecting-range":n.isInSelectingRangeMonth(e),"react-datepicker__month-text--in-range":r&&s?OT(r,s,e,i):void 0,"react-datepicker__month-text--range-start":n.isRangeStartMonth(e),"react-datepicker__month-text--range-end":n.isRangeEndMonth(e),"react-datepicker__month-text--selecting-range-start":n.isSelectingMonthRangeStart(e),"react-datepicker__month-text--selecting-range-end":n.isSelectingMonthRangeEnd(e),"react-datepicker__month-text--today":n.isCurrentMonth(i,e)})},n.getTabIndex=function(e){if(null==n.props.preSelection)return"-1";var t=wS(n.props.preSelection),i=n.isMonthDisabledForLabelDate(t).isDisabled;return e!==t||i||n.props.disabledKeyboardNavigation?"-1":"0"},n.getQuarterTabIndex=function(e){if(null==n.props.preSelection)return"-1";var t=MS(n.props.preSelection),i=FT(n.props.day,n.props);return e!==t||i||n.props.disabledKeyboardNavigation?"-1":"0"},n.getAriaLabel=function(e){var t=n.props,i=t.chooseDayAriaLabelPrefix,r=void 0===i?"Choose":i,s=t.disabledDayAriaLabelPrefix,a=void 0===s?"Not available":s,o=t.day,l=t.locale,c=xS(o,e),u=n.isDisabled(c)||n.isExcluded(c)?a:r;return"".concat(u," ").concat(dT(c,"MMMM yyyy",l))},n.getQuarterClassNames=function(e){var t=n.props,i=t.day,r=t.startDate,s=t.endDate,a=t.minDate,o=t.maxDate,l=t.excludeDates,c=t.includeDates,u=t.filterDate,d=t.preSelection,h=t.disabledKeyboardNavigation,f=t.disabled,p=(a||o||l||c||u||f)&&FT(SS(i,e),n.props),m=n.getSelection();return U_("react-datepicker__quarter-text","react-datepicker__quarter-".concat(e),{"react-datepicker__quarter-text--disabled":p,"react-datepicker__quarter-text--selected":m?n.isSelectQuarterInList(i,e,m):void 0,"react-datepicker__quarter-text--keyboard-selected":!h&&d&&n.isSelectedQuarter(i,e,d)&&!n.isQuarterSelected()&&!p,"react-datepicker__quarter-text--in-selecting-range":n.isInSelectingRangeQuarter(e),"react-datepicker__quarter-text--in-range":r&&s?HT(r,s,e,i):void 0,"react-datepicker__quarter-text--range-start":n.isRangeStartQuarter(e),"react-datepicker__quarter-text--range-end":n.isRangeEndQuarter(e),"react-datepicker__quarter-text--today":n.isCurrentQuarter(i,e)})},n.getMonthContent=function(e){var t=n.props,i=t.showFullMonthYearPicker,r=t.renderMonthContent,s=t.locale,a=t.day,o=PT(e,s),l=LT(e,s);return r?r(e,o,l,a):i?l:o},n.getQuarterContent=function(e){var t,i=n.props,r=i.renderQuarterContent,s=function(e,t){return dT(SS(lT(),e),"QQQ",t)}(e,i.locale);return null!==(t=null===r||void 0===r?void 0:r(e,s))&&void 0!==t?t:s},n.renderMonths=function(){var e,i=n.props,r=i.showTwoColumnMonthYearPicker,s=i.showFourColumnMonthYearPicker,a=i.day,o=i.selected,l=null===(e=pM[mM(s,r)])||void 0===e?void 0:e.grid;return null===l||void 0===l?void 0:l.map(function(e,i){return t.createElement("div",{className:"react-datepicker__month-wrapper",key:i},e.map(function(e,i){return t.createElement("div",{ref:n.MONTH_REFS[e],key:i,onClick:function(t){n.onMonthClick(t,e)},onKeyDown:function(t){sM(t)&&(t.preventDefault(),t.key=rT.Enter),n.onMonthKeyDown(t,e)},onMouseEnter:n.props.usePointerEvent?void 0:function(){return n.onMonthMouseEnter(e)},onPointerEnter:n.props.usePointerEvent?function(){return n.onMonthMouseEnter(e)}:void 0,tabIndex:Number(n.getTabIndex(e)),className:n.getMonthClassNames(e),"aria-disabled":n.isMonthDisabled(e),role:"option","aria-label":n.getAriaLabel(e),"aria-current":n.isCurrentMonth(a,e)?"date":void 0,"aria-selected":o?n.isSelectedMonth(a,e,o):void 0},n.getMonthContent(e))}))})},n.renderQuarters=function(){var e=n.props,i=e.day,r=e.selected;return t.createElement("div",{className:"react-datepicker__quarter-wrapper"},[1,2,3,4].map(function(e,s){return t.createElement("div",{key:s,ref:n.QUARTER_REFS[s],role:"option",onClick:function(t){n.onQuarterClick(t,e)},onKeyDown:function(t){n.onQuarterKeyDown(t,e)},onMouseEnter:n.props.usePointerEvent?void 0:function(){return n.onQuarterMouseEnter(e)},onPointerEnter:n.props.usePointerEvent?function(){return n.onQuarterMouseEnter(e)}:void 0,className:n.getQuarterClassNames(e),"aria-selected":r?n.isSelectedQuarter(i,e,r):void 0,tabIndex:Number(n.getQuarterTabIndex(e)),"aria-current":n.isCurrentQuarter(i,e)?"date":void 0},n.getQuarterContent(e))}))},n.getClassNames=function(){var e=n.props,t=e.selectingDate,i=e.selectsStart,r=e.selectsEnd;return U_("react-datepicker__month",{"react-datepicker__month--selecting-range":t&&(i||r)},{"react-datepicker__monthPicker":e.showMonthYearPicker},{"react-datepicker__quarterPicker":e.showQuarterYearPicker},{"react-datepicker__weekPicker":e.showWeekPicker})},n}return tT(n,e),n.prototype.getSelection=function(){var e=this.props,t=e.selected,n=e.selectedDates;return e.selectsMultiple?n:t?[t]:void 0},n.prototype.render=function(){var e=this.props,n=e.showMonthYearPicker,i=e.showQuarterYearPicker,r=e.day,s=e.ariaLabelPrefix,a=void 0===s?"Month ":s,o=a?a.trim()+" ":"",l=uT(r)?"".concat(o).concat(dT(r,"MMMM, yyyy",this.props.locale)):"";return n||i?t.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":l,role:"listbox"},n?this.renderMonths():this.renderQuarters()):t.createElement("div",{role:"table"},this.props.dayNamesHeader&&t.createElement("div",{role:"rowgroup"},this.props.dayNamesHeader),t.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":l,role:"rowgroup"},this.renderWeeks()))},n}(t.Component),vM=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.monthOptionButtonsRef={},n.isSelectedMonth=function(e){return n.props.month===e},n.handleOptionKeyDown=function(e,t){var i;switch(t.key){case"Enter":t.preventDefault(),n.onChange(e);break;case"Escape":t.preventDefault(),n.props.onCancel();break;case"ArrowUp":case"ArrowDown":t.preventDefault();var r=(e+("ArrowUp"===t.key?-1:1)+n.props.monthNames.length)%n.props.monthNames.length;null===(i=n.monthOptionButtonsRef[r])||void 0===i||i.focus()}},n.renderOptions=function(){return n.monthOptionButtonsRef={},n.props.monthNames.map(function(e,i){return t.createElement("div",{ref:function(e){n.monthOptionButtonsRef[i]=e,n.isSelectedMonth(i)&&(null===e||void 0===e||e.focus())},role:"button",tabIndex:0,className:n.isSelectedMonth(i)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:e,onClick:n.onChange.bind(n,i),onKeyDown:n.handleOptionKeyDown.bind(n,i),"aria-selected":n.isSelectedMonth(i)?"true":void 0},n.isSelectedMonth(i)?t.createElement("span",{className:"react-datepicker__month-option--selected"},"\u2713"):"",e)})},n.onChange=function(e){return n.props.onChange(e)},n.handleClickOutside=function(){return n.props.onCancel()},n}return tT(n,e),n.prototype.render=function(){return t.createElement(aT,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},n}(t.Component),yM=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={dropdownVisible:!1},n.renderSelectOptions=function(e){return e.map(function(e,n){return t.createElement("option",{key:e,value:n},e)})},n.renderSelectMode=function(e){return t.createElement("select",{value:n.props.month,className:"react-datepicker__month-select",onChange:function(e){return n.onChange(parseInt(e.target.value))}},n.renderSelectOptions(e))},n.renderReadView=function(e,i){return t.createElement("button",{key:"read",type:"button",style:{visibility:e?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:n.toggleDropdown},t.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),t.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},i[n.props.month]))},n.renderDropdown=function(e){return t.createElement(vM,nT({key:"dropdown"},n.props,{monthNames:e,onChange:n.onChange,onCancel:n.toggleDropdown}))},n.renderScrollMode=function(e){var t=n.state.dropdownVisible,i=[n.renderReadView(!t,e)];return t&&i.unshift(n.renderDropdown(e)),i},n.onChange=function(e){n.toggleDropdown(),e!==n.props.month&&n.props.onChange(e)},n.toggleDropdown=function(){return n.setState({dropdownVisible:!n.state.dropdownVisible})},n}return tT(n,e),n.prototype.render=function(){var e,n=this,i=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(e){return PT(e,n.props.locale)}:function(e){return LT(e,n.props.locale)});switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode(i);break;case"select":e=this.renderSelectMode(i)}return t.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},e)},n}(t.Component);function _M(e,t){for(var n=[],i=gT(e),r=gT(t);!jS(i,r);)n.push(lT(i)),i=LS(i,1);return n}var bM=function(e){function n(n){var i=e.call(this,n)||this;return i.renderOptions=function(){return i.state.monthYearsList.map(function(e){var n=qS(e),r=ST(i.props.date,e)&&ET(i.props.date,e);return t.createElement("div",{className:r?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:n,onClick:i.onChange.bind(i,n),"aria-selected":r?"true":void 0},r?t.createElement("span",{className:"react-datepicker__month-year-option--selected"},"\u2713"):"",dT(e,i.props.dateFormat,i.props.locale))})},i.onChange=function(e){return i.props.onChange(e)},i.handleClickOutside=function(){i.props.onCancel()},i.state={monthYearsList:_M(i.props.minDate,i.props.maxDate)},i}return tT(n,e),n.prototype.render=function(){var e=U_({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return t.createElement(aT,{className:e,onClickOutside:this.handleClickOutside},this.renderOptions())},n}(t.Component),xM=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={dropdownVisible:!1},n.renderSelectOptions=function(){for(var e=gT(n.props.minDate),i=gT(n.props.maxDate),r=[];!jS(e,i);){var s=qS(e);r.push(t.createElement("option",{key:s,value:s},dT(e,n.props.dateFormat,n.props.locale))),e=LS(e,1)}return r},n.onSelectChange=function(e){n.onChange(parseInt(e.target.value))},n.renderSelectMode=function(){return t.createElement("select",{value:qS(gT(n.props.date)),className:"react-datepicker__month-year-select",onChange:n.onSelectChange},n.renderSelectOptions())},n.renderReadView=function(e){var i=dT(n.props.date,n.props.dateFormat,n.props.locale);return t.createElement("div",{key:"read",style:{visibility:e?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:n.toggleDropdown},t.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),t.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},i))},n.renderDropdown=function(){return t.createElement(bM,nT({key:"dropdown"},n.props,{onChange:n.onChange,onCancel:n.toggleDropdown}))},n.renderScrollMode=function(){var e=n.state.dropdownVisible,t=[n.renderReadView(!e)];return e&&t.unshift(n.renderDropdown()),t},n.onChange=function(e){n.toggleDropdown();var t=lT(e);ST(n.props.date,t)&&ET(n.props.date,t)||n.props.onChange(t)},n.toggleDropdown=function(){return n.setState({dropdownVisible:!n.state.dropdownVisible})},n}return tT(n,e),n.prototype.render=function(){var e;switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode();break;case"select":e=this.renderSelectMode()}return t.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},e)},n}(t.Component),SM=function(e){function n(){var i=null!==e&&e.apply(this,arguments)||this;return i.state={height:null},i.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var e,t,r;i.list&&(i.list.scrollTop=null!==(r=i.centerLi&&n.calcCenterPosition(i.props.monthRef?i.props.monthRef.clientHeight-(null!==(t=null===(e=i.header)||void 0===e?void 0:e.clientHeight)&&void 0!==t?t:0):i.list.clientHeight,i.centerLi))&&void 0!==r?r:0)})},i.handleClick=function(e){var t,n;(i.props.minTime||i.props.maxTime)&&WT(e,i.props)||(i.props.excludeTimes||i.props.includeTimes||i.props.filterTime)&&VT(e,i.props)||null===(n=(t=i.props).onChange)||void 0===n||n.call(t,e)},i.isSelectedTime=function(e){return i.props.selected&&(t=i.props.selected,n=e,nM(t).getTime()===nM(n).getTime());var t,n},i.isDisabledTime=function(e){return(i.props.minTime||i.props.maxTime)&&WT(e,i.props)||(i.props.excludeTimes||i.props.includeTimes||i.props.filterTime)&&VT(e,i.props)},i.liClasses=function(e){var t,r=["react-datepicker__time-list-item",i.props.timeClassName?i.props.timeClassName(e):void 0];return i.isSelectedTime(e)&&r.push("react-datepicker__time-list-item--selected"),i.isDisabledTime(e)&&r.push("react-datepicker__time-list-item--disabled"),i.props.injectTimes&&(3600*AS(e)+60*CS(e)+RS(e))%(60*(null!==(t=i.props.intervals)&&void 0!==t?t:n.defaultProps.intervals))!==0&&r.push("react-datepicker__time-list-item--injected"),r.join(" ")},i.handleOnKeyDown=function(e,t){var n,r;e.key===rT.Space&&(e.preventDefault(),e.key=rT.Enter),(e.key===rT.ArrowUp||e.key===rT.ArrowLeft)&&e.target instanceof HTMLElement&&e.target.previousSibling&&(e.preventDefault(),e.target.previousSibling instanceof HTMLElement&&e.target.previousSibling.focus()),(e.key===rT.ArrowDown||e.key===rT.ArrowRight)&&e.target instanceof HTMLElement&&e.target.nextSibling&&(e.preventDefault(),e.target.nextSibling instanceof HTMLElement&&e.target.nextSibling.focus()),e.key===rT.Enter&&i.handleClick(t),null===(r=(n=i.props).handleOnKeyDown)||void 0===r||r.call(n,e)},i.renderTimes=function(){for(var e,r=[],s="string"===typeof i.props.format?i.props.format:"p",a=null!==(e=i.props.intervals)&&void 0!==e?e:n.defaultProps.intervals,o=i.props.selected||i.props.openToDate||lT(),l=pT(o),c=i.props.injectTimes&&i.props.injectTimes.sort(function(e,t){return e.getTime()-t.getTime()}),u=60*function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+n-+t)/36e5)}(o),d=u/a,h=0;h<d;h++){var f=VS(l,h*a);if(r.push(f),c){var p=$T(l,f,h,a,c);r=r.concat(p)}}var m=r.reduce(function(e,t){return t.getTime()<=o.getTime()?t:e},r[0]);return r.map(function(e){return t.createElement("li",{key:e.valueOf(),onClick:i.handleClick.bind(i,e),className:i.liClasses(e),ref:function(t){e===m&&(i.centerLi=t)},onKeyDown:function(t){i.handleOnKeyDown(t,e)},tabIndex:e===m?0:-1,role:"option","aria-selected":i.isSelectedTime(e)?"true":void 0,"aria-disabled":i.isDisabledTime(e)?"true":void 0},dT(e,s,i.props.locale))})},i.renderTimeCaption=function(){return!1===i.props.showTimeCaption?t.createElement(t.Fragment,null):t.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(i.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(e){i.header=e}},t.createElement("div",{className:"react-datepicker-time__header"},i.props.timeCaption))},i}return tT(n,e),Object.defineProperty(n,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},n.prototype.componentWillUnmount=function(){var e;null===(e=this.resizeObserver)||void 0===e||e.disconnect()},n.prototype.observeDatePickerHeightChanges=function(){var e=this,t=this.props.monthRef;this.updateContainerHeight(),t&&(this.resizeObserver=new ResizeObserver(function(){e.updateContainerHeight()}),this.resizeObserver.observe(t))},n.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},n.prototype.render=function(){var e,i=this,r=this.state.height;return t.createElement("div",{className:"react-datepicker__time-container ".concat((null!==(e=this.props.todayButton)&&void 0!==e?e:n.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),t.createElement("div",{className:"react-datepicker__time"},t.createElement("div",{className:"react-datepicker__time-box"},t.createElement("ul",{className:"react-datepicker__time-list",ref:function(e){i.list=e},style:r?{height:r}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},n.calcCenterPosition=function(e,t){return t.offsetTop-(e/2-t.clientHeight/2)},n}(t.Component),EM=function(e){function n(n){var i=e.call(this,n)||this;return i.YEAR_REFS=iT([],Array(i.props.yearItemNumber),!0).map(function(){return(0,t.createRef)()}),i.isDisabled=function(e){return IT(e,{minDate:i.props.minDate,maxDate:i.props.maxDate,excludeDates:i.props.excludeDates,includeDates:i.props.includeDates,filterDate:i.props.filterDate})},i.isExcluded=function(e){return DT(e,{excludeDates:i.props.excludeDates})},i.selectingDate=function(){var e;return null!==(e=i.props.selectingDate)&&void 0!==e?e:i.props.preSelection},i.updateFocusOnPaginate=function(e){window.requestAnimationFrame(function(){var t,n;null===(n=null===(t=i.YEAR_REFS[e])||void 0===t?void 0:t.current)||void 0===n||n.focus()})},i.handleYearClick=function(e,t){i.props.onDayClick&&i.props.onDayClick(e,t)},i.handleYearNavigation=function(e,t){var n,r,s,a,o=i.props,l=o.date,c=o.yearItemNumber;if(void 0!==l&&void 0!==c){var u=tM(l,c).startPeriod;i.isDisabled(t)||i.isExcluded(t)||(null===(r=(n=i.props).setPreSelection)||void 0===r||r.call(n,t),e-u<0?i.updateFocusOnPaginate(c-(u-e)):e-u>=c?i.updateFocusOnPaginate(Math.abs(c-(e-u))):null===(a=null===(s=i.YEAR_REFS[e-u])||void 0===s?void 0:s.current)||void 0===a||a.focus())}},i.isSameDay=function(e,t){return TT(e,t)},i.isCurrentYear=function(e){return e===ES(lT())},i.isRangeStart=function(e){return i.props.startDate&&i.props.endDate&&ST(JS(lT(),e),i.props.startDate)},i.isRangeEnd=function(e){return i.props.startDate&&i.props.endDate&&ST(JS(lT(),e),i.props.endDate)},i.isInRange=function(e){return BT(e,i.props.startDate,i.props.endDate)},i.isInSelectingRange=function(e){var t=i.props,n=t.selectsStart,r=t.selectsEnd,s=t.selectsRange,a=t.startDate,o=t.endDate;return!(!(n||r||s)||!i.selectingDate())&&(n&&o?BT(e,i.selectingDate(),o):(r&&a||!(!s||!a||o))&&BT(e,a,i.selectingDate()))},i.isSelectingRangeStart=function(e){var t;if(!i.isInSelectingRange(e))return!1;var n=i.props,r=n.startDate,s=n.selectsStart,a=JS(lT(),e);return ST(a,s?null!==(t=i.selectingDate())&&void 0!==t?t:null:null!==r&&void 0!==r?r:null)},i.isSelectingRangeEnd=function(e){var t;if(!i.isInSelectingRange(e))return!1;var n=i.props,r=n.endDate,s=n.selectsEnd,a=n.selectsRange,o=JS(lT(),e);return ST(o,s||a?null!==(t=i.selectingDate())&&void 0!==t?t:null:null!==r&&void 0!==r?r:null)},i.isKeyboardSelected=function(e){if(!i.props.disabledKeyboardNavigation&&void 0!==i.props.date&&null!=i.props.preSelection){var t=i.props,n=t.minDate,r=t.maxDate,s=t.excludeDates,a=t.includeDates,o=t.filterDate,l=t.selected,c=vT(JS(i.props.date,e)),u=(n||r||s||a||o)&&UT(e,i.props),d=!!l&&TT(c,vT(l)),h=TT(c,vT(i.props.preSelection));return!i.props.inline&&!d&&h&&!u}},i.isSelectedYear=function(e){var t=i.props,n=t.selectsMultiple,r=t.selected,s=t.selectedDates;return n?null===s||void 0===s?void 0:s.some(function(t){return e===ES(t)}):!!r&&e===ES(r)},i.onYearClick=function(e,t){var n=i.props.date;void 0!==n&&i.handleYearClick(vT(JS(n,t)),e)},i.onYearKeyDown=function(e,t){var n,r,s=e.key,a=i.props,o=a.date,l=a.yearItemNumber,c=a.handleOnKeyDown;if(s!==rT.Tab&&e.preventDefault(),!i.props.disabledKeyboardNavigation)switch(s){case rT.Enter:if(null==i.props.selected)break;i.onYearClick(e,t),null===(r=(n=i.props).setPreSelection)||void 0===r||r.call(n,i.props.selected);break;case rT.ArrowRight:if(null==i.props.preSelection)break;i.handleYearNavigation(t+1,NS(i.props.preSelection,1));break;case rT.ArrowLeft:if(null==i.props.preSelection)break;i.handleYearNavigation(t-1,FS(i.props.preSelection,1));break;case rT.ArrowUp:if(void 0===o||void 0===l||null==i.props.preSelection)break;var u=tM(o,l).startPeriod;if((f=t-(h=3))<u){var d=l%h;t>=u&&t<u+d?h=d:h+=d,f=t-h}i.handleYearNavigation(f,FS(i.props.preSelection,h));break;case rT.ArrowDown:if(void 0===o||void 0===l||null==i.props.preSelection)break;var h,f,p=tM(o,l).endPeriod;if((f=t+(h=3))>p){d=l%h;t<=p&&t>p-d?h=d:h+=d,f=t+h}i.handleYearNavigation(f,NS(i.props.preSelection,h))}c&&c(e)},i.getYearClassNames=function(e){var t=i.props,n=t.date,r=t.disabled,s=t.minDate,a=t.maxDate,o=t.excludeDates,l=t.includeDates,c=t.filterDate,u=t.yearClassName;return U_("react-datepicker__year-text","react-datepicker__year-".concat(e),n?null===u||void 0===u?void 0:u(JS(n,e)):void 0,{"react-datepicker__year-text--selected":i.isSelectedYear(e),"react-datepicker__year-text--disabled":(s||a||o||l||c||r)&&UT(e,i.props),"react-datepicker__year-text--keyboard-selected":i.isKeyboardSelected(e),"react-datepicker__year-text--range-start":i.isRangeStart(e),"react-datepicker__year-text--range-end":i.isRangeEnd(e),"react-datepicker__year-text--in-range":i.isInRange(e),"react-datepicker__year-text--in-selecting-range":i.isInSelectingRange(e),"react-datepicker__year-text--selecting-range-start":i.isSelectingRangeStart(e),"react-datepicker__year-text--selecting-range-end":i.isSelectingRangeEnd(e),"react-datepicker__year-text--today":i.isCurrentYear(e)})},i.getYearTabIndex=function(e){if(i.props.disabledKeyboardNavigation||null==i.props.preSelection)return"-1";var t=ES(i.props.preSelection),n=UT(e,i.props);return e!==t||n?"-1":"0"},i.getYearContent=function(e){return i.props.renderYearContent?i.props.renderYearContent(e):e},i}return tT(n,e),n.prototype.render=function(){var e=this,n=[],i=this.props,r=i.date,s=i.yearItemNumber,a=i.onYearMouseEnter,o=i.onYearMouseLeave;if(void 0===r)return null;for(var l=tM(r,s),c=l.startPeriod,u=l.endPeriod,d=function(i){n.push(t.createElement("div",{ref:h.YEAR_REFS[i-c],onClick:function(t){e.onYearClick(t,i)},onKeyDown:function(t){sM(t)&&(t.preventDefault(),t.key=rT.Enter),e.onYearKeyDown(t,i)},tabIndex:Number(h.getYearTabIndex(i)),className:h.getYearClassNames(i),onMouseEnter:h.props.usePointerEvent?void 0:function(e){return a(e,i)},onPointerEnter:h.props.usePointerEvent?function(e){return a(e,i)}:void 0,onMouseLeave:h.props.usePointerEvent?void 0:function(e){return o(e,i)},onPointerLeave:h.props.usePointerEvent?function(e){return o(e,i)}:void 0,key:i,"aria-current":h.isCurrentYear(i)?"date":void 0},h.getYearContent(i)))},h=this,f=c;f<=u;f++)d(f);return t.createElement("div",{className:"react-datepicker__year"},t.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},n))},n}(t.Component);function wM(e,t,n,i){for(var r=[],s=0;s<2*t+1;s++){var a=e+t-s,o=!0;n&&(o=ES(n)<=a),i&&o&&(o=ES(i)>=a),o&&r.push(a)}return r}var TM=function(e){function n(n){var i=e.call(this,n)||this;i.yearOptionButtonsRef={},i.handleOptionKeyDown=function(e,t){var n;switch(t.key){case"Enter":t.preventDefault(),i.onChange(e);break;case"Escape":t.preventDefault(),i.props.onCancel();break;case"ArrowUp":case"ArrowDown":t.preventDefault();var r=e+("ArrowUp"===t.key?1:-1);i.yearOptionButtonsRef[r]&&(null===(n=i.yearOptionButtonsRef[r])||void 0===n||n.focus())}},i.renderOptions=function(){i.yearOptionButtonsRef={};var e=i.props.year,n=i.state.yearsList.map(function(n){return t.createElement("div",{ref:function(t){i.yearOptionButtonsRef[n]=t,n===e&&(null===t||void 0===t||t.focus())},role:"button",tabIndex:0,className:e===n?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:n,onClick:i.onChange.bind(i,n),onKeyDown:i.handleOptionKeyDown.bind(i,n),"aria-selected":e===n?"true":void 0},e===n?t.createElement("span",{className:"react-datepicker__year-option--selected"},"\u2713"):"",n)}),r=i.props.minDate?ES(i.props.minDate):null,s=i.props.maxDate?ES(i.props.maxDate):null;return s&&i.state.yearsList.find(function(e){return e===s})||n.unshift(t.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:i.incrementYears},t.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),r&&i.state.yearsList.find(function(e){return e===r})||n.push(t.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:i.decrementYears},t.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),n},i.onChange=function(e){i.props.onChange(e)},i.handleClickOutside=function(){i.props.onCancel()},i.shiftYears=function(e){var t=i.state.yearsList.map(function(t){return t+e});i.setState({yearsList:t})},i.incrementYears=function(){return i.shiftYears(1)},i.decrementYears=function(){return i.shiftYears(-1)};var r=n.yearDropdownItemNumber,s=n.scrollableYearDropdown,a=r||(s?10:5);return i.state={yearsList:wM(i.props.year,a,i.props.minDate,i.props.maxDate)},i.dropdownRef=(0,t.createRef)(),i}return tT(n,e),n.prototype.componentDidMount=function(){var e=this.dropdownRef.current;if(e){var t=e.children?Array.from(e.children):null,n=t?t.find(function(e){return e.ariaSelected}):null;e.scrollTop=n&&n instanceof HTMLElement?n.offsetTop+(n.clientHeight-e.clientHeight)/2:(e.scrollHeight-e.clientHeight)/2}},n.prototype.render=function(){var e=U_({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return t.createElement(aT,{className:e,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},n}(t.Component),MM=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={dropdownVisible:!1},n.renderSelectOptions=function(){for(var e=n.props.minDate?ES(n.props.minDate):1900,i=n.props.maxDate?ES(n.props.maxDate):2100,r=[],s=e;s<=i;s++)r.push(t.createElement("option",{key:s,value:s},s));return r},n.onSelectChange=function(e){n.onChange(parseInt(e.target.value))},n.renderSelectMode=function(){return t.createElement("select",{value:n.props.year,className:"react-datepicker__year-select",onChange:n.onSelectChange},n.renderSelectOptions())},n.renderReadView=function(e){return t.createElement("button",{key:"read",type:"button",style:{visibility:e?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:n.toggleDropdown},t.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),t.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},n.props.year))},n.renderDropdown=function(){return t.createElement(TM,nT({key:"dropdown"},n.props,{onChange:n.onChange,onCancel:n.toggleDropdown}))},n.renderScrollMode=function(){var e=n.state.dropdownVisible,t=[n.renderReadView(!e)];return e&&t.unshift(n.renderDropdown()),t},n.onChange=function(e){n.toggleDropdown(),e!==n.props.year&&n.props.onChange(e)},n.toggleDropdown=function(e){n.setState({dropdownVisible:!n.state.dropdownVisible},function(){n.props.adjustDateOnChange&&n.handleYearChange(n.props.date,e)})},n.handleYearChange=function(e,t){var i;null===(i=n.onSelect)||void 0===i||i.call(n,e,t),n.setOpen()},n.onSelect=function(e,t){var i,r;null===(r=(i=n.props).onSelect)||void 0===r||r.call(i,e,t)},n.setOpen=function(){var e,t;null===(t=(e=n.props).setOpen)||void 0===t||t.call(e,!0)},n}return tT(n,e),n.prototype.render=function(){var e;switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode();break;case"select":e=this.renderSelectMode()}return t.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},e)},n}(t.Component),AM=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],CM="react-datepicker-ignore-onclickoutside",RM=function(e){function n(i){var r=e.call(this,i)||this;return r.monthContainer=void 0,r.handleClickOutside=function(e){r.props.onClickOutside(e)},r.setClickOutsideRef=function(){return r.containerRef.current},r.handleDropdownFocus=function(e){var t,n;(function(e){var t=(e.className||"").split(/\s+/);return AM.some(function(e){return t.indexOf(e)>=0})})(e.target)&&(null===(n=(t=r.props).onDropdownFocus)||void 0===n||n.call(t,e))},r.getDateInView=function(){var e=r.props,t=e.preSelection,n=e.selected,i=e.openToDate,s=qT(r.props),a=JT(r.props),o=lT(),l=i||n||t;return l||(s&&Ox(o,s)?s:a&&jS(o,a)?a:o)},r.increaseMonth=function(){r.setState(function(e){return{date:LS(e.date,1)}},function(){return r.handleMonthChange(r.state.date)})},r.decreaseMonth=function(){r.setState(function(e){return{date:PS(e.date,1)}},function(){return r.handleMonthChange(r.state.date)})},r.handleDayClick=function(e,t,n){r.props.onSelect(e,t,n),r.props.setPreSelection&&r.props.setPreSelection(e)},r.handleDayMouseEnter=function(e){r.setState({selectingDate:e}),r.props.onDayMouseEnter&&r.props.onDayMouseEnter(e)},r.handleMonthMouseLeave=function(){r.setState({selectingDate:void 0}),r.props.onMonthMouseLeave&&r.props.onMonthMouseLeave()},r.handleYearMouseEnter=function(e,t){r.setState({selectingDate:JS(lT(),t)}),r.props.onYearMouseEnter&&r.props.onYearMouseEnter(e,t)},r.handleYearMouseLeave=function(e,t){r.props.onYearMouseLeave&&r.props.onYearMouseLeave(e,t)},r.handleYearChange=function(e){var t,n,i,s;null===(n=(t=r.props).onYearChange)||void 0===n||n.call(t,e),r.setState({isRenderAriaLiveMessage:!0}),r.props.adjustDateOnChange&&(r.props.onSelect(e),null===(s=(i=r.props).setOpen)||void 0===s||s.call(i,!0)),r.props.setPreSelection&&r.props.setPreSelection(e)},r.getEnabledPreSelectionDateForMonth=function(e){if(!IT(e,r.props))return e;for(var t=gT(e),n=QS(xT(e),t),i=null,s=0;s<=n;s++){var a=_x(t,s);if(!IT(a,r.props)){i=a;break}}return i},r.handleMonthChange=function(e){var t,n,i,s=null!==(t=r.getEnabledPreSelectionDateForMonth(e))&&void 0!==t?t:e;r.handleCustomMonthChange(s),r.props.adjustDateOnChange&&(r.props.onSelect(s),null===(i=(n=r.props).setOpen)||void 0===i||i.call(n,!0)),r.props.setPreSelection&&r.props.setPreSelection(s)},r.handleCustomMonthChange=function(e){var t,n;null===(n=(t=r.props).onMonthChange)||void 0===n||n.call(t,e),r.setState({isRenderAriaLiveMessage:!0})},r.handleMonthYearChange=function(e){r.handleYearChange(e),r.handleMonthChange(e)},r.changeYear=function(e){r.setState(function(t){return{date:JS(t.date,Number(e))}},function(){return r.handleYearChange(r.state.date)})},r.changeMonth=function(e){r.setState(function(t){return{date:xS(t.date,Number(e))}},function(){return r.handleMonthChange(r.state.date)})},r.changeMonthYear=function(e){r.setState(function(t){return{date:JS(xS(t.date,wS(e)),ES(e))}},function(){return r.handleMonthYearChange(r.state.date)})},r.header=function(e){if(void 0===e&&(e=r.state.date),!uT(e))return[];var n=r.props.disabled,i=mT(e,r.props.locale,r.props.calendarStartDay),s=[];return r.props.showWeekNumbers&&s.push(t.createElement("div",{key:"W",className:"react-datepicker__day-name ".concat(n?"react-datepicker__day-name--disabled":""),role:"columnheader"},t.createElement("span",{className:"react-datepicker__sr-only"},"Week number"),t.createElement("span",{"aria-hidden":"true"},r.props.weekLabel||"#"))),s.concat([0,1,2,3,4,5,6].map(function(e){var s=_x(i,e),a=r.formatWeekday(s,r.props.locale),o=r.props.weekDayClassName?r.props.weekDayClassName(s):void 0;return t.createElement("div",{key:e,role:"columnheader",className:U_("react-datepicker__day-name",o,n?"react-datepicker__day-name--disabled":"")},t.createElement("span",{className:"react-datepicker__sr-only"},dT(s,"EEEE",r.props.locale)),t.createElement("span",{"aria-hidden":"true"},a))}))},r.formatWeekday=function(e,t){return r.props.formatWeekDay?function(e,t,n){return t(dT(e,"EEEE",n))}(e,r.props.formatWeekDay,t):r.props.useWeekdaysShort?function(e,t){return dT(e,"EEE",t)}(e,t):function(e,t){return dT(e,"EEEEEE",t)}(e,t)},r.decreaseYear=function(){r.setState(function(e){var t;return{date:FS(e.date,r.props.showYearPicker?null!==(t=r.props.yearItemNumber)&&void 0!==t?t:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.clearSelectingDate=function(){r.setState({selectingDate:void 0})},r.renderPreviousButton=function(){var e,i,s;if(!r.props.renderCustomHeader){var a,o=null!==(e=r.props.monthsShown)&&void 0!==e?e:n.defaultProps.monthsShown,l=r.props.showPreviousMonths?o-1:0,c=null!==(i=r.props.monthSelectedIn)&&void 0!==i?i:l,u=PS(r.state.date,c);switch(!0){case r.props.disabled:a=!0;break;case r.props.showMonthYearPicker:a=XT(r.state.date,r.props);break;case r.props.showYearPicker:a=function(e,t){var n=void 0===t?{}:t,i=n.minDate,r=n.yearItemNumber,s=void 0===r?12:r,a=tM(vT(FS(e,s)),s).endPeriod,o=i&&ES(i);return o&&o>a||!1}(r.state.date,r.props);break;case r.props.showQuarterYearPicker:a=function(e,t){var n=void 0===t?{}:t,i=n.minDate,r=n.includeDates,s=kS(Ux(e),1);return i&&OS(i,s)>0||r&&r.every(function(e){return OS(e,s)>0})||!1}(r.state.date,r.props);break;default:a=jT(u,r.props)}if(((null!==(s=r.props.forceShowMonthNavigation)&&void 0!==s?s:n.defaultProps.forceShowMonthNavigation)||r.props.showDisabledMonthNavigation||!a)&&!r.props.showTimeSelectOnly){var d=["react-datepicker__navigation","react-datepicker__navigation--previous"],h=r.decreaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(h=r.decreaseYear),a&&r.props.showDisabledMonthNavigation&&(d.push("react-datepicker__navigation--previous--disabled"),h=void 0);var f=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,p=r.props,m=p.previousMonthButtonLabel,g=void 0===m?n.defaultProps.previousMonthButtonLabel:m,v=p.previousYearButtonLabel,y=void 0===v?n.defaultProps.previousYearButtonLabel:v,_=r.props,b=_.previousMonthAriaLabel,x=void 0===b?"string"===typeof g?g:"Previous Month":b,S=_.previousYearAriaLabel,E=void 0===S?"string"===typeof y?y:"Previous Year":S;return t.createElement("button",{type:"button",className:d.join(" "),onClick:h,onKeyDown:r.props.handleOnKeyDown,"aria-label":f?E:x},t.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"].join(" ")},f?y:g))}}},r.increaseYear=function(){r.setState(function(e){var t;return{date:NS(e.date,r.props.showYearPicker?null!==(t=r.props.yearItemNumber)&&void 0!==t?t:n.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.renderNextButton=function(){var e;if(!r.props.renderCustomHeader){var i;switch(!0){case r.props.disabled:i=!0;break;case r.props.showMonthYearPicker:i=KT(r.state.date,r.props);break;case r.props.showYearPicker:i=function(e,t){var n=void 0===t?{}:t,i=n.maxDate,r=n.yearItemNumber,s=void 0===r?12:r,a=tM(NS(e,s),s).startPeriod,o=i&&ES(i);return o&&o<a||!1}(r.state.date,r.props);break;case r.props.showQuarterYearPicker:i=function(e,t){var n=void 0===t?{}:t,i=n.maxDate,r=n.includeDates,s=DS(TS(e),1);return i&&OS(s,i)>0||r&&r.every(function(e){return OS(s,e)>0})||!1}(r.state.date,r.props);break;default:i=YT(r.state.date,r.props)}if(((null!==(e=r.props.forceShowMonthNavigation)&&void 0!==e?e:n.defaultProps.forceShowMonthNavigation)||r.props.showDisabledMonthNavigation||!i)&&!r.props.showTimeSelectOnly){var s=["react-datepicker__navigation","react-datepicker__navigation--next"];r.props.showTimeSelect&&s.push("react-datepicker__navigation--next--with-time"),r.props.todayButton&&s.push("react-datepicker__navigation--next--with-today-button");var a=r.increaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(a=r.increaseYear),i&&r.props.showDisabledMonthNavigation&&(s.push("react-datepicker__navigation--next--disabled"),a=void 0);var o=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,l=r.props,c=l.nextMonthButtonLabel,u=void 0===c?n.defaultProps.nextMonthButtonLabel:c,d=l.nextYearButtonLabel,h=void 0===d?n.defaultProps.nextYearButtonLabel:d,f=r.props,p=f.nextMonthAriaLabel,m=void 0===p?"string"===typeof u?u:"Next Month":p,g=f.nextYearAriaLabel,v=void 0===g?"string"===typeof h?h:"Next Year":g;return t.createElement("button",{type:"button",className:s.join(" "),onClick:a,onKeyDown:r.props.handleOnKeyDown,"aria-label":o?v:m},t.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"].join(" ")},o?h:u))}}},r.renderCurrentMonth=function(e){void 0===e&&(e=r.state.date);var n=["react-datepicker__current-month"];return r.props.showYearDropdown&&n.push("react-datepicker__current-month--hasYearDropdown"),r.props.showMonthDropdown&&n.push("react-datepicker__current-month--hasMonthDropdown"),r.props.showMonthYearDropdown&&n.push("react-datepicker__current-month--hasMonthYearDropdown"),t.createElement("h2",{className:n.join(" ")},uT(e)?dT(e,r.props.dateFormat,r.props.locale):"")},r.renderYearDropdown=function(e){if(void 0===e&&(e=!1),r.props.showYearDropdown&&!e)return t.createElement(MM,nT({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeYear,year:ES(r.state.date)}))},r.renderMonthDropdown=function(e){if(void 0===e&&(e=!1),r.props.showMonthDropdown&&!e)return t.createElement(yM,nT({},n.defaultProps,r.props,{month:wS(r.state.date),onChange:r.changeMonth}))},r.renderMonthYearDropdown=function(e){if(void 0===e&&(e=!1),r.props.showMonthYearDropdown&&!e)return t.createElement(xM,nT({},n.defaultProps,r.props,{date:r.state.date,onChange:r.changeMonthYear}))},r.handleTodayButtonClick=function(e){r.props.onSelect(_T(),e),r.props.setPreSelection&&r.props.setPreSelection(_T())},r.renderTodayButton=function(){if(r.props.todayButton&&!r.props.showTimeSelectOnly)return t.createElement("div",{className:"react-datepicker__today-button",onClick:r.handleTodayButtonClick},r.props.todayButton)},r.renderDayNamesHeader=function(e){return t.createElement("div",{className:"react-datepicker__day-names",role:"row"},r.header(e))},r.renderDefaultHeader=function(e){var n=e.monthDate,i=e.i;return t.createElement("div",{className:"react-datepicker__header ".concat(r.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},r.renderCurrentMonth(n),t.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(r.props.dropdownMode),onFocus:r.handleDropdownFocus},r.renderMonthDropdown(0!==i),r.renderMonthYearDropdown(0!==i),r.renderYearDropdown(0!==i)))},r.renderCustomHeader=function(e){var n,i,s=e.monthDate,a=e.i;if(r.props.showTimeSelect&&!r.state.monthContainer||r.props.showTimeSelectOnly)return null;var o,l=r.props,c=l.showYearPicker,u=l.yearItemNumber;if(c){var d=tM(s,u);o={startYear:d.startPeriod,endYear:d.endPeriod}}var h=jT(r.state.date,r.props),f=YT(r.state.date,r.props),p=XT(r.state.date,r.props),m=KT(r.state.date,r.props);return t.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:r.props.onDropdownFocus},null===(i=(n=r.props).renderCustomHeader)||void 0===i?void 0:i.call(n,nT(nT(nT({},r.state),c&&{visibleYearsRange:o}),{customHeaderCount:a,monthDate:s,changeMonth:r.changeMonth,changeYear:r.changeYear,decreaseMonth:r.decreaseMonth,increaseMonth:r.increaseMonth,decreaseYear:r.decreaseYear,increaseYear:r.increaseYear,prevMonthButtonDisabled:h,nextMonthButtonDisabled:f,prevYearButtonDisabled:p,nextYearButtonDisabled:m})))},r.renderYearHeader=function(e){var i=e.monthDate,s=r.props,a=s.showYearPicker,o=s.yearItemNumber,l=tM(i,void 0===o?n.defaultProps.yearItemNumber:o),c=l.startPeriod,u=l.endPeriod;return t.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},a?"".concat(c," - ").concat(u):ES(i))},r.renderHeader=function(e){var t=e.monthDate,n=e.i,i={monthDate:t,i:void 0===n?0:n};switch(!0){case void 0!==r.props.renderCustomHeader:return r.renderCustomHeader(i);case r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker:return r.renderYearHeader(i);default:return r.renderDefaultHeader(i)}},r.renderMonths=function(){var e,i;if(!r.props.showTimeSelectOnly&&!r.props.showYearPicker){for(var s=[],a=null!==(e=r.props.monthsShown)&&void 0!==e?e:n.defaultProps.monthsShown,o=r.props.showPreviousMonths?a-1:0,l=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?NS(r.state.date,o):PS(r.state.date,o),c=null!==(i=r.props.monthSelectedIn)&&void 0!==i?i:o,u=0;u<a;++u){var d=u-c+o,h=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?NS(l,d):LS(l,d),f="month-".concat(u),p=u<a-1,m=u>0;s.push(t.createElement("div",{key:f,ref:function(e){r.monthContainer=null!==e&&void 0!==e?e:void 0},className:"react-datepicker__month-container"},r.renderHeader({monthDate:h,i:u}),t.createElement(gM,nT({},n.defaultProps,r.props,{containerRef:r.containerRef,ariaLabelPrefix:r.props.monthAriaLabelPrefix,day:h,onDayClick:r.handleDayClick,handleOnKeyDown:r.props.handleOnDayKeyDown,handleOnMonthKeyDown:r.props.handleOnKeyDown,onDayMouseEnter:r.handleDayMouseEnter,onMouseLeave:r.handleMonthMouseLeave,orderInDisplay:u,selectingDate:r.state.selectingDate,monthShowsDuplicateDaysEnd:p,monthShowsDuplicateDaysStart:m,dayNamesHeader:r.renderDayNamesHeader(h)}))))}return s}},r.renderYears=function(){if(!r.props.showTimeSelectOnly)return r.props.showYearPicker?t.createElement("div",{className:"react-datepicker__year--container"},r.renderHeader({monthDate:r.state.date}),t.createElement(EM,nT({},n.defaultProps,r.props,{selectingDate:r.state.selectingDate,date:r.state.date,onDayClick:r.handleDayClick,clearSelectingDate:r.clearSelectingDate,onYearMouseEnter:r.handleYearMouseEnter,onYearMouseLeave:r.handleYearMouseLeave}))):void 0},r.renderTimeSection=function(){if(r.props.showTimeSelect&&(r.state.monthContainer||r.props.showTimeSelectOnly))return t.createElement(SM,nT({},n.defaultProps,r.props,{onChange:r.props.onTimeChange,format:r.props.timeFormat,intervals:r.props.timeIntervals,monthRef:r.state.monthContainer}))},r.renderInputTimeSection=function(){var e=r.props.selected?new Date(r.props.selected):void 0,i=e&&uT(e)&&Boolean(r.props.selected)?"".concat(eM(e.getHours()),":").concat(eM(e.getMinutes())):"";if(r.props.showTimeInput)return t.createElement(oM,nT({},n.defaultProps,r.props,{date:e,timeString:i,onChange:r.props.onTimeChange}))},r.renderAriaLiveRegion=function(){var e;if(!uT(r.state.date))return t.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"});var i,s=tM(r.state.date,null!==(e=r.props.yearItemNumber)&&void 0!==e?e:n.defaultProps.yearItemNumber),a=s.startPeriod,o=s.endPeriod;return i=r.props.showYearPicker?"".concat(a," - ").concat(o):r.props.showMonthYearPicker||r.props.showQuarterYearPicker?ES(r.state.date):"".concat(LT(wS(r.state.date),r.props.locale)," ").concat(ES(r.state.date)),t.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},r.state.isRenderAriaLiveMessage&&i)},r.renderChildren=function(){if(r.props.children)return t.createElement("div",{className:"react-datepicker__children-container"},r.props.children)},r.containerRef=(0,t.createRef)(),r.state={date:r.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},r}return tT(n,e),Object.defineProperty(n,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,outsideClickIgnoreClass:CM,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:12}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){var e=this;this.props.showTimeSelect&&(this.assignMonthContainer=void e.setState({monthContainer:e.monthContainer}))},n.prototype.componentDidUpdate=function(e){var t=this;if(!this.props.preSelection||!uT(this.props.preSelection)||TT(this.props.preSelection,e.preSelection)&&this.props.monthSelectedIn===e.monthSelectedIn)this.props.openToDate&&!TT(this.props.openToDate,e.openToDate)&&this.setState({date:this.props.openToDate});else{var n=!ET(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return n&&t.handleCustomMonthChange(t.state.date)})}},n.prototype.render=function(){var e=this.props.container||sT;return t.createElement(aT,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},t.createElement("div",{style:{display:"contents"},ref:this.containerRef},t.createElement(e,{className:U_("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly,inline:this.props.inline},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},n}(t.Component),LM=function(e){var n=e.icon,i=e.className,r=void 0===i?"":i,s=e.onClick,a="react-datepicker__calendar-icon";if("string"===typeof n)return t.createElement("i",{className:"".concat(a," ").concat(n," ").concat(r),"aria-hidden":"true",onClick:s});if(t.isValidElement(n)){var o=n;return t.cloneElement(o,{className:"".concat(o.props.className||""," ").concat(a," ").concat(r),onClick:function(e){"function"===typeof o.props.onClick&&o.props.onClick(e),"function"===typeof s&&s(e)}})}return t.createElement("svg",{className:"".concat(a," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:s},t.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},PM=function(e){function t(t){var n=e.call(this,t)||this;return n.portalRoot=null,n.el=document.createElement("div"),n}return tT(t,e),t.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},t.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},t.prototype.render=function(){return LE.createPortal(this.props.children,this.el)},t}(t.Component),IM=function(e){return(e instanceof HTMLAnchorElement||!e.disabled)&&-1!==e.tabIndex},DM=function(e){function n(n){var i=e.call(this,n)||this;return i.getTabChildren=function(){var e;return Array.prototype.slice.call(null===(e=i.tabLoopRef.current)||void 0===e?void 0:e.querySelectorAll("[tabindex], a, button, input, select, textarea"),1,-1).filter(IM)},i.handleFocusStart=function(){var e=i.getTabChildren();e&&e.length>1&&e[e.length-1].focus()},i.handleFocusEnd=function(){var e=i.getTabChildren();e&&e.length>1&&e[0].focus()},i.tabLoopRef=(0,t.createRef)(),i}return tT(n,e),n.prototype.render=function(){var e;return(null!==(e=this.props.enableTabLoop)&&void 0!==e?e:n.defaultProps.enableTabLoop)?t.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},t.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,t.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},n.defaultProps={enableTabLoop:!0},n}(t.Component);var kM=function(e){function n(n){var i,r,s,a="boolean"!==typeof n.hidePopper||n.hidePopper,o=(0,t.useRef)(null),l=$w(nT({open:!a,whileElementsMounted:xw,placement:n.popperPlacement,middleware:iT([(r={padding:15},Cr(Cr({},Ew(r)),{},{options:[r,s]})),Pw(10),Iw({element:o})],null!==(i=n.popperModifiers)&&void 0!==i?i:[],!0)},n.popperProps)),c=nT(nT({},n),{hidePopper:a,popperProps:nT(nT({},l),{arrowRef:o})});return t.createElement(e,nT({},c))}return n.displayName="withFloating(".concat(e.displayName||e.name||"Component",")"),n}(function(e){var n=e.className,i=e.wrapperClassName,r=e.hidePopper,s=void 0===r||r,a=e.popperComponent,o=e.targetComponent,l=e.enableTabLoop,c=e.popperOnKeyDown,u=e.portalId,d=e.portalHost,h=e.popperProps,f=e.showArrow,p=void 0;if(!s){var m=U_("react-datepicker-popper",n);p=t.createElement(DM,{enableTabLoop:l},t.createElement("div",{ref:h.refs.setFloating,style:h.floatingStyles,className:m,"data-placement":h.placement,onKeyDown:c},a,f&&t.createElement(Yw,{ref:h.arrowRef,context:h.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}e.popperContainer&&(p=(0,t.createElement)(e.popperContainer,{},p)),u&&!s&&(p=t.createElement(PM,{portalId:u,portalHost:d},p));var g=U_("react-datepicker-wrapper",i);return t.createElement(t.Fragment,null,t.createElement("div",{ref:h.refs.setReference,className:g},o),p)});var OM="Date input not valid.",NM=function(e){function n(i){var r=e.call(this,i)||this;return r.calendar=null,r.input=null,r.getPreSelection=function(){return r.props.openToDate?r.props.openToDate:r.props.selectsEnd&&r.props.startDate?r.props.startDate:r.props.selectsStart&&r.props.endDate?r.props.endDate:lT()},r.modifyHolidays=function(){var e;return null===(e=r.props.holidays)||void 0===e?void 0:e.reduce(function(e,t){var n=new Date(t.date);return uT(n)?iT(iT([],e,!0),[nT(nT({},t),{date:n})],!1):e},[])},r.calcInitialState=function(){var e,t=r.getPreSelection(),n=qT(r.props),i=JT(r.props),s=n&&Ox(t,pT(n))?n:i&&jS(t,bT(i))?i:t;return{open:r.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:null!==(e=r.props.selectsRange?r.props.startDate:r.props.selected)&&void 0!==e?e:s,highlightDates:QT(r.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},r.getInputValue=function(){var e,t=r.props,i=t.locale,s=t.startDate,a=t.endDate,o=t.rangeSeparator,l=t.selected,c=t.selectedDates,u=t.selectsMultiple,d=t.selectsRange,h=t.value,f=null!==(e=r.props.dateFormat)&&void 0!==e?e:n.defaultProps.dateFormat,p=r.state.inputValue;return"string"===typeof h?h:"string"===typeof p?p:d?function(e,t,n){if(!e&&!t)return"";var i=e?hT(e,n):"",r=t?hT(t,n):"",s=n.rangeSeparator||" - ";return"".concat(i).concat(s).concat(r)}(s,a,{dateFormat:f,locale:i,rangeSeparator:o}):u?function(e,t){if(!(null===e||void 0===e?void 0:e.length))return"";var n=e[0]?hT(e[0],t):"";if(1===e.length)return n;if(2===e.length&&e[1]){var i=hT(e[1],t);return"".concat(n,", ").concat(i)}var r=e.length-1;return"".concat(n," (+").concat(r,")")}(null!==c&&void 0!==c?c:[],{dateFormat:f,locale:i}):hT(l,{dateFormat:f,locale:i})},r.resetHiddenStatus=function(){r.setState(nT(nT({},r.state),{wasHidden:!1}))},r.setHiddenStatus=function(){r.setState(nT(nT({},r.state),{wasHidden:!0}))},r.setHiddenStateOnVisibilityHidden=function(){"hidden"===document.visibilityState&&r.setHiddenStatus()},r.clearPreventFocusTimeout=function(){r.preventFocusTimeout&&clearTimeout(r.preventFocusTimeout)},r.setFocus=function(){var e,t;null===(t=null===(e=r.input)||void 0===e?void 0:e.focus)||void 0===t||t.call(e,{preventScroll:!0})},r.setBlur=function(){var e,t;null===(t=null===(e=r.input)||void 0===e?void 0:e.blur)||void 0===t||t.call(e),r.cancelFocusInput()},r.deferBlur=function(){requestAnimationFrame(function(){r.setBlur()})},r.setOpen=function(e,t){void 0===t&&(t=!1),r.setState({open:e,preSelection:e&&r.state.open?r.state.preSelection:r.calcInitialState().preSelection,lastPreSelectChange:BM},function(){e||r.setState(function(e){return{focused:!!t&&e.focused}},function(){!t&&r.deferBlur(),r.setState({inputValue:null})})})},r.inputOk=function(){return Dx(r.state.preSelection)},r.isCalendarOpen=function(){return void 0===r.props.open?r.state.open&&!r.props.disabled&&!r.props.readOnly:r.props.open},r.handleFocus=function(e){var t,n,i=r.state.wasHidden,s=!i||r.state.open;i&&r.resetHiddenStatus(),r.state.preventFocus||(null===(n=(t=r.props).onFocus)||void 0===n||n.call(t,e),!s||r.props.preventOpenOnFocus||r.props.readOnly||r.setOpen(!0)),r.setState({focused:!0})},r.sendFocusBackToInput=function(){r.preventFocusTimeout&&r.clearPreventFocusTimeout(),r.setState({preventFocus:!0},function(){r.preventFocusTimeout=setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})})},r.cancelFocusInput=function(){clearTimeout(r.inputFocusTimeout),r.inputFocusTimeout=void 0},r.deferFocusInput=function(){r.cancelFocusInput(),r.inputFocusTimeout=setTimeout(function(){return r.setFocus()},1)},r.handleDropdownFocus=function(){r.cancelFocusInput()},r.resetInputValue=function(){r.setState(nT(nT({},r.state),{inputValue:null}))},r.handleBlur=function(e){var t,n;(!r.state.open||r.props.withPortal||r.props.showTimeInput)&&(null===(n=(t=r.props).onBlur)||void 0===n||n.call(t,e)),r.resetInputValue(),r.state.open&&!1===r.props.open&&r.setOpen(!1),r.setState({focused:!1})},r.handleCalendarClickOutside=function(e){var t,n;r.props.inline||r.setOpen(!1),null===(n=(t=r.props).onClickOutside)||void 0===n||n.call(t,e),r.props.withPortal&&e.preventDefault()},r.handleChange=function(){for(var e,t,i,s,a,o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];var c=o[0];if(!r.props.onChangeRaw||(r.props.onChangeRaw.apply(r,o),c&&"function"===typeof c.isDefaultPrevented&&!c.isDefaultPrevented())){r.setState({inputValue:(null===c||void 0===c?void 0:c.target)instanceof HTMLInputElement?c.target.value:null,lastPreSelectChange:FM});var u=r.props,d=u.selectsRange,h=u.startDate,f=u.endDate,p=null!==(e=r.props.dateFormat)&&void 0!==e?e:n.defaultProps.dateFormat,m=null!==(t=r.props.strictParsing)&&void 0!==t?t:n.defaultProps.strictParsing,g=(null===c||void 0===c?void 0:c.target)instanceof HTMLInputElement?c.target.value:"";if(d){var v=r.props.rangeSeparator,y=v.trim(),_=g.split(p.includes(y)?v:y,2).map(function(e){return e.trim()}),b=_[0],x=_[1],S=cT(null!==b&&void 0!==b?b:"",p,r.props.locale,m),E=S?cT(null!==x&&void 0!==x?x:"",p,r.props.locale,m):null,w=(null===h||void 0===h?void 0:h.getTime())!==(null===S||void 0===S?void 0:S.getTime()),T=(null===f||void 0===f?void 0:f.getTime())!==(null===E||void 0===E?void 0:E.getTime());if(!w&&!T)return;if(S&&IT(S,r.props))return;if(E&&IT(E,r.props))return;null===(s=(i=r.props).onChange)||void 0===s||s.call(i,[S,E],c)}else{var M=cT(g,p,r.props.locale,m,null!==(a=r.props.selected)&&void 0!==a?a:void 0);!M&&g||r.setSelected(M,c,!0)}}},r.handleSelect=function(e,t,i){var s;if(!r.props.readOnly){var a=r.props,o=a.selectsRange,l=a.startDate,c=a.endDate,u=a.locale,d=a.swapRange,h=null!==(s=r.props.dateFormat)&&void 0!==s?s:n.defaultProps.dateFormat,f=!o||l&&!c&&(d||!rM(e,l));if(r.props.shouldCloseOnSelect&&!r.props.showTimeSelect&&f&&r.sendFocusBackToInput(),r.props.onChangeRaw){var p=hT(e,{dateFormat:h,locale:u});r.props.onChangeRaw(t,{date:e,formattedDate:p})}r.setSelected(e,t,!1,i),r.props.showDateSelect&&r.setState({isRenderAriaLiveMessage:!0}),!r.props.shouldCloseOnSelect||r.props.showTimeSelect?r.setPreSelection(e):f&&r.setOpen(!1)}},r.setSelected=function(e,t,n,i){var s,a,o=e;if(r.props.showYearPicker){if(null!==o&&UT(ES(o),r.props))return}else if(r.props.showMonthYearPicker){if(null!==o&&kT(o,r.props))return}else if(null!==o&&IT(o,r.props))return;var l=r.props,c=l.onChange,u=l.selectsRange,d=l.startDate,h=l.endDate,f=l.selectsMultiple,p=l.selectedDates,m=l.minTime,g=l.swapRange;if(!MT(r.props.selected,o)||r.props.allowSameDay||u||f)if(null!==o&&(!r.props.selected||n&&(r.props.showTimeSelect||r.props.showTimeSelectOnly||r.props.showTimeInput)||(o=fT(o,{hour:AS(r.props.selected),minute:CS(r.props.selected),second:RS(r.props.selected)})),n||!r.props.showTimeSelect&&!r.props.showTimeSelectOnly||m&&(o=fT(o,{hour:m.getHours(),minute:m.getMinutes(),second:m.getSeconds()})),r.props.inline||r.setState({preSelection:o}),r.props.focusSelectedMonth||r.setState({monthSelectedIn:i})),u){var v=d&&!h,y=!d&&!!h,_=d&&h;!d&&!h?null===c||void 0===c||c([o,null],t):v?null===o?null===c||void 0===c||c([null,null],t):rM(o,d)?g?null===c||void 0===c||c([o,d],t):null===c||void 0===c||c([o,null],t):null===c||void 0===c||c([d,o],t):y&&(o&&rM(o,h)?null===c||void 0===c||c([o,h],t):null===c||void 0===c||c([o,null],t)),_&&(null===c||void 0===c||c([o,null],t))}else if(f){if(null!==o)if(null===p||void 0===p?void 0:p.length)if(p.some(function(e){return TT(e,o)})){var b=p.filter(function(e){return!TT(e,o)});null===c||void 0===c||c(b,t)}else null===c||void 0===c||c(iT(iT([],p,!0),[o],!1),t);else null===c||void 0===c||c([o],t)}else null===c||void 0===c||c(o,t);n||(null===(a=(s=r.props).onSelect)||void 0===a||a.call(s,o,t),r.setState({inputValue:null}))},r.setPreSelection=function(e){if(!r.props.readOnly){var t=Dx(r.props.minDate),n=Dx(r.props.maxDate),i=!0;if(e){var s=pT(e);if(t&&n)i=AT(e,r.props.minDate,r.props.maxDate);else if(t){var a=pT(r.props.minDate);i=jS(e,a)||MT(s,a)}else if(n){var o=bT(r.props.maxDate);i=Ox(e,o)||MT(s,o)}}i&&r.setState({preSelection:e})}},r.toggleCalendar=function(){r.setOpen(!r.state.open)},r.handleTimeChange=function(e){var t,n;if(!r.props.selectsRange&&!r.props.selectsMultiple){var i=r.props.selected?r.props.selected:r.getPreSelection(),s=r.props.selected?e:fT(i,{hour:AS(e),minute:CS(e)});r.setState({preSelection:s}),null===(n=(t=r.props).onChange)||void 0===n||n.call(t,s),r.props.shouldCloseOnSelect&&!r.props.showTimeInput&&(r.sendFocusBackToInput(),r.setOpen(!1)),r.props.showTimeInput&&r.setOpen(!0),(r.props.showTimeSelectOnly||r.props.showTimeSelect)&&r.setState({isRenderAriaLiveMessage:!0}),r.setState({inputValue:null})}},r.onInputClick=function(){var e,t;r.props.disabled||r.props.readOnly||r.setOpen(!0),null===(t=(e=r.props).onInputClick)||void 0===t||t.call(e)},r.onInputKeyDown=function(e){var t,n,i,s,a,o;null===(n=(t=r.props).onKeyDown)||void 0===n||n.call(t,e);var l=e.key;if(r.state.open||r.props.inline||r.props.preventOpenOnFocus){if(r.state.open){if(l===rT.ArrowDown||l===rT.ArrowUp){e.preventDefault();var c=r.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":r.props.showWeekPicker&&r.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':r.props.showFullMonthYearPicker||r.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',u=(null===(s=r.calendar)||void 0===s?void 0:s.containerRef.current)instanceof Element&&r.calendar.containerRef.current.querySelector(c);return void(u instanceof HTMLElement&&u.focus({preventScroll:!0}))}var d=lT(r.state.preSelection);l===rT.Enter?(e.preventDefault(),e.target.blur(),r.inputOk()&&r.state.lastPreSelectChange===BM?(r.handleSelect(d,e),!r.props.shouldCloseOnSelect&&r.setPreSelection(d)):r.setOpen(!1)):l===rT.Escape?(e.preventDefault(),e.target.blur(),r.sendFocusBackToInput(),r.setOpen(!1)):l===rT.Tab&&r.setOpen(!1),r.inputOk()||null===(o=(a=r.props).onInputError)||void 0===o||o.call(a,{code:1,msg:OM})}}else l!==rT.ArrowDown&&l!==rT.ArrowUp&&l!==rT.Enter||null===(i=r.onInputClick)||void 0===i||i.call(r)},r.onPortalKeyDown=function(e){e.key===rT.Escape&&(e.preventDefault(),r.setState({preventFocus:!0},function(){r.setOpen(!1),setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})}))},r.onDayKeyDown=function(e){var t,n,i,s,a,o,l=r.props,c=l.minDate,u=l.maxDate,d=l.disabledKeyboardNavigation,h=l.showWeekPicker,f=l.shouldCloseOnSelect,p=l.locale,m=l.calendarStartDay,g=l.adjustDateOnChange,v=l.inline;if(null===(n=(t=r.props).onKeyDown)||void 0===n||n.call(t,e),!d){var y=e.key,_=e.shiftKey,b=lT(r.state.preSelection),x=function(e,t){var n=t;switch(e){case rT.ArrowRight:n=h?KS(t,1):_x(t,1);break;case rT.ArrowLeft:n=h?$S(t,1):eE(t,1);break;case rT.ArrowUp:n=$S(t,1);break;case rT.ArrowDown:n=KS(t,1);break;case rT.PageUp:n=_?FS(t,1):PS(t,1);break;case rT.PageDown:n=_?NS(t,1):LS(t,1);break;case rT.Home:n=mT(t,p,m);break;case rT.End:n=function(e){return hS(e)}(t)}return n};if(y===rT.Enter)return e.preventDefault(),r.handleSelect(b,e),void(!f&&r.setPreSelection(b));if(y===rT.Escape)return e.preventDefault(),r.setOpen(!1),void(r.inputOk()||null===(s=(i=r.props).onInputError)||void 0===s||s.call(i,{code:1,msg:OM}));var S=null;switch(y){case rT.ArrowLeft:case rT.ArrowRight:case rT.ArrowUp:case rT.ArrowDown:case rT.PageUp:case rT.PageDown:case rT.Home:case rT.End:S=function(e,t){for(var n=e,i=!1,s=0,a=x(e,t);!i;){if(s>=40){a=t;break}c&&a<c&&(n=rT.ArrowRight,a=IT(c,r.props)?x(n,a):c),u&&a>u&&(n=rT.ArrowLeft,a=IT(u,r.props)?x(n,a):u),IT(a,r.props)?(n!==rT.PageUp&&n!==rT.Home||(n=rT.ArrowRight),n!==rT.PageDown&&n!==rT.End||(n=rT.ArrowLeft),a=x(n,a)):i=!0,s++}return a}(y,b)}if(S){if(e.preventDefault(),r.setState({lastPreSelectChange:BM}),g&&r.setSelected(S),r.setPreSelection(S),v){var E=wS(b),w=wS(S),T=ES(b),M=ES(S);E!==w||T!==M?r.setState({shouldFocusDayInline:!0}):r.setState({shouldFocusDayInline:!1})}}else null===(o=(a=r.props).onInputError)||void 0===o||o.call(a,{code:1,msg:OM})}},r.onPopperKeyDown=function(e){e.key===rT.Escape&&(e.preventDefault(),r.sendFocusBackToInput(),r.setOpen(!1))},r.onClearClick=function(e){e&&e.preventDefault&&e.preventDefault(),r.sendFocusBackToInput();var t=r.props,n=t.selectsRange,i=t.onChange;n?null===i||void 0===i||i([null,null],e):null===i||void 0===i||i(null,e),r.setState({inputValue:null})},r.clear=function(){r.onClearClick()},r.onScroll=function(e){"boolean"===typeof r.props.closeOnScroll&&r.props.closeOnScroll?e.target!==document&&e.target!==document.documentElement&&e.target!==document.body||r.setOpen(!1):"function"===typeof r.props.closeOnScroll&&r.props.closeOnScroll(e)&&r.setOpen(!1)},r.renderCalendar=function(){var e,i;return r.props.inline||r.isCalendarOpen()?t.createElement(RM,nT({showMonthYearDropdown:void 0,ref:function(e){r.calendar=e}},r.props,r.state,{setOpen:r.setOpen,dateFormat:null!==(e=r.props.dateFormatCalendar)&&void 0!==e?e:n.defaultProps.dateFormatCalendar,onSelect:r.handleSelect,onClickOutside:r.handleCalendarClickOutside,holidays:ZT(r.modifyHolidays()),outsideClickIgnoreClass:r.props.outsideClickIgnoreClass,onDropdownFocus:r.handleDropdownFocus,onTimeChange:r.handleTimeChange,className:r.props.calendarClassName,container:r.props.calendarContainer,handleOnKeyDown:r.props.onKeyDown,handleOnDayKeyDown:r.onDayKeyDown,setPreSelection:r.setPreSelection,dropdownMode:null!==(i=r.props.dropdownMode)&&void 0!==i?i:n.defaultProps.dropdownMode}),r.props.children):null},r.renderAriaLiveRegion=function(){var e,i,s=r.props.locale,a=null!==(e=r.props.dateFormat)&&void 0!==e?e:n.defaultProps.dateFormat,o=r.props.showTimeInput||r.props.showTimeSelect?"PPPPp":"PPPP";return i=r.props.selectsRange?"Selected start date: ".concat(hT(r.props.startDate,{dateFormat:o,locale:s}),". ").concat(r.props.endDate?"End date: "+hT(r.props.endDate,{dateFormat:o,locale:s}):""):r.props.showTimeSelectOnly?"Selected time: ".concat(hT(r.props.selected,{dateFormat:a,locale:s})):r.props.showYearPicker?"Selected year: ".concat(hT(r.props.selected,{dateFormat:"yyyy",locale:s})):r.props.showMonthYearPicker?"Selected month: ".concat(hT(r.props.selected,{dateFormat:"MMMM yyyy",locale:s})):r.props.showQuarterYearPicker?"Selected quarter: ".concat(hT(r.props.selected,{dateFormat:"yyyy, QQQ",locale:s})):"Selected date: ".concat(hT(r.props.selected,{dateFormat:o,locale:s})),t.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},i)},r.renderDateInput=function(){var e,i,s=U_(r.props.className,((e={})[r.props.outsideClickIgnoreClass||n.defaultProps.outsideClickIgnoreClass]=r.state.open,e)),a=r.props.customInput||t.createElement("input",{type:"text"}),o=r.props.customInputRef||"ref";return(0,t.cloneElement)(a,((i={})[o]=function(e){r.input=e},i.value=r.getInputValue(),i.onBlur=r.handleBlur,i.onChange=r.handleChange,i.onClick=r.onInputClick,i.onFocus=r.handleFocus,i.onKeyDown=r.onInputKeyDown,i.id=r.props.id,i.name=r.props.name,i.form=r.props.form,i.autoFocus=r.props.autoFocus,i.placeholder=r.props.placeholderText,i.disabled=r.props.disabled,i.autoComplete=r.props.autoComplete,i.className=U_(a.props.className,s),i.title=r.props.title,i.readOnly=r.props.readOnly,i.required=r.props.required,i.tabIndex=r.props.tabIndex,i["aria-describedby"]=r.props.ariaDescribedBy,i["aria-invalid"]=r.props.ariaInvalid,i["aria-labelledby"]=r.props.ariaLabelledBy,i["aria-required"]=r.props.ariaRequired,i))},r.renderClearButton=function(){var e=r.props,n=e.isClearable,i=e.disabled,s=e.selected,a=e.startDate,o=e.endDate,l=e.clearButtonTitle,c=e.clearButtonClassName,u=void 0===c?"":c,d=e.ariaLabelClose,h=void 0===d?"Close":d,f=e.selectedDates,p=e.readOnly;return!n||p||null==s&&null==a&&null==o&&!(null===f||void 0===f?void 0:f.length)?null:t.createElement("button",{type:"button",className:U_("react-datepicker__close-icon",u,{"react-datepicker__close-icon--disabled":i}),disabled:i,"aria-label":h,onClick:r.onClearClick,title:l,tabIndex:-1})},r.state=r.calcInitialState(),r.preventFocusTimeout=void 0,r}return tT(n,e),Object.defineProperty(n,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,outsideClickIgnoreClass:CM,readOnly:!1,rangeSeparator:" - ",withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:12,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.componentDidUpdate=function(e,t){var n,i,r,s,a,o;e.inline&&(a=e.selected,o=this.props.selected,a&&o?wS(a)!==wS(o)||ES(a)!==ES(o):a!==o)&&this.setPreSelection(this.props.selected),void 0!==this.state.monthSelectedIn&&e.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),e.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:QT(this.props.highlightDates)}),t.focused||MT(e.selected,this.props.selected)||this.setState({inputValue:null}),t.open!==this.state.open&&(!1===t.open&&!0===this.state.open&&(null===(i=(n=this.props).onCalendarOpen)||void 0===i||i.call(n)),!0===t.open&&!1===this.state.open&&(null===(s=(r=this.props).onCalendarClose)||void 0===s||s.call(r)))},n.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},n.prototype.renderInputContainer=function(){var e=this.props,n=e.showIcon,i=e.icon,r=e.calendarIconClassname,s=e.calendarIconClassName,a=e.toggleCalendarOnIconClick,o=this.state.open;return r&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),t.createElement("div",{className:"react-datepicker__input-container".concat(n?" react-datepicker__view-calendar-icon":"")},n&&t.createElement(LM,nT({icon:i,className:U_(s,!s&&r,o&&"react-datepicker-ignore-onclickoutside")},a?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},n.prototype.render=function(){var e=this.renderCalendar();if(this.props.inline)return e;if(this.props.withPortal){var n=this.state.open?t.createElement(DM,{enableTabLoop:this.props.enableTabLoop},t.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},e)):null;return this.state.open&&this.props.portalId&&(n=t.createElement(PM,nT({portalId:this.props.portalId},this.props),n)),t.createElement("div",null,this.renderInputContainer(),n)}return t.createElement(kM,nT({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:e,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},n}(t.Component),FM="input",BM="navigate";const UM={button:"ButtonBorder_button__1ouXv",active:"ButtonBorder_active__Z-FRF",animated_text:"ButtonBorder_animated_text__frYYF"},HM=["active","disabled","className","type","title","onClick","defaultClassName"],zM=(0,t.forwardRef)((e,t)=>{let{active:n,disabled:i,className:r,type:s,title:a,onClick:o,defaultClassName:l=!0}=e;d(e,HM);return(0,p.jsx)("button",{ref:t,disabled:i,className:"".concat(l&&UM.button," ").concat(n&&UM.active," ").concat(r),type:null!==s&&void 0!==s?s:"button",onClick:e=>o(e),children:(0,p.jsx)("span",{className:"".concat(n&&UM.button_element__highlight),children:a})})});function GM(e,t){if(void 0!==e.one&&1===t)return e.one;var n=t%10,i=t%100;return 1===n&&11!==i?e.singularNominative.replace("{{count}}",String(t)):n>=2&&n<=4&&(i<10||i>20)?e.singularGenitive.replace("{{count}}",String(t)):e.pluralGenitive.replace("{{count}}",String(t))}function VM(e){return function(t,n){return null!==n&&void 0!==n&&n.addSuffix?n.comparison&&n.comparison>0?e.future?GM(e.future,t):"\u0447\u0435\u0440\u0435\u0437 "+GM(e.regular,t):e.past?GM(e.past,t):GM(e.regular,t)+" \u043d\u0430\u0437\u0430\u0434":GM(e.regular,t)}}var WM={lessThanXSeconds:VM({regular:{one:"\u043c\u0435\u043d\u044c\u0448\u0435 \u0441\u0435\u043a\u0443\u043d\u0434\u044b",singularNominative:"\u043c\u0435\u043d\u044c\u0448\u0435 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u044b",singularGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434",pluralGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434"},future:{one:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 \u0441\u0435\u043a\u0443\u043d\u0434\u0443",singularNominative:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u0443",singularGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u044b",pluralGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434"}}),xSeconds:VM({regular:{singularNominative:"{{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u0430",singularGenitive:"{{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u044b",pluralGenitive:"{{count}} \u0441\u0435\u043a\u0443\u043d\u0434"},past:{singularNominative:"{{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u0443 \u043d\u0430\u0437\u0430\u0434",singularGenitive:"{{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u044b \u043d\u0430\u0437\u0430\u0434",pluralGenitive:"{{count}} \u0441\u0435\u043a\u0443\u043d\u0434 \u043d\u0430\u0437\u0430\u0434"},future:{singularNominative:"\u0447\u0435\u0440\u0435\u0437 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u0443",singularGenitive:"\u0447\u0435\u0440\u0435\u0437 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u044b",pluralGenitive:"\u0447\u0435\u0440\u0435\u0437 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434"}}),halfAMinute:function(e,t){return null!==t&&void 0!==t&&t.addSuffix?t.comparison&&t.comparison>0?"\u0447\u0435\u0440\u0435\u0437 \u043f\u043e\u043b\u043c\u0438\u043d\u0443\u0442\u044b":"\u043f\u043e\u043b\u043c\u0438\u043d\u0443\u0442\u044b \u043d\u0430\u0437\u0430\u0434":"\u043f\u043e\u043b\u043c\u0438\u043d\u0443\u0442\u044b"},lessThanXMinutes:VM({regular:{one:"\u043c\u0435\u043d\u044c\u0448\u0435 \u043c\u0438\u043d\u0443\u0442\u044b",singularNominative:"\u043c\u0435\u043d\u044c\u0448\u0435 {{count}} \u043c\u0438\u043d\u0443\u0442\u044b",singularGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435 {{count}} \u043c\u0438\u043d\u0443\u0442",pluralGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435 {{count}} \u043c\u0438\u043d\u0443\u0442"},future:{one:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 \u043c\u0438\u043d\u0443\u0442\u0443",singularNominative:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0438\u043d\u0443\u0442\u0443",singularGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0438\u043d\u0443\u0442\u044b",pluralGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0438\u043d\u0443\u0442"}}),xMinutes:VM({regular:{singularNominative:"{{count}} \u043c\u0438\u043d\u0443\u0442\u0430",singularGenitive:"{{count}} \u043c\u0438\u043d\u0443\u0442\u044b",pluralGenitive:"{{count}} \u043c\u0438\u043d\u0443\u0442"},past:{singularNominative:"{{count}} \u043c\u0438\u043d\u0443\u0442\u0443 \u043d\u0430\u0437\u0430\u0434",singularGenitive:"{{count}} \u043c\u0438\u043d\u0443\u0442\u044b \u043d\u0430\u0437\u0430\u0434",pluralGenitive:"{{count}} \u043c\u0438\u043d\u0443\u0442 \u043d\u0430\u0437\u0430\u0434"},future:{singularNominative:"\u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0438\u043d\u0443\u0442\u0443",singularGenitive:"\u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0438\u043d\u0443\u0442\u044b",pluralGenitive:"\u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0438\u043d\u0443\u0442"}}),aboutXHours:VM({regular:{singularNominative:"\u043e\u043a\u043e\u043b\u043e {{count}} \u0447\u0430\u0441\u0430",singularGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u0447\u0430\u0441\u043e\u0432",pluralGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u0447\u0430\u0441\u043e\u0432"},future:{singularNominative:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u0447\u0430\u0441",singularGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u0447\u0430\u0441\u0430",pluralGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u0447\u0430\u0441\u043e\u0432"}}),xHours:VM({regular:{singularNominative:"{{count}} \u0447\u0430\u0441",singularGenitive:"{{count}} \u0447\u0430\u0441\u0430",pluralGenitive:"{{count}} \u0447\u0430\u0441\u043e\u0432"}}),xDays:VM({regular:{singularNominative:"{{count}} \u0434\u0435\u043d\u044c",singularGenitive:"{{count}} \u0434\u043d\u044f",pluralGenitive:"{{count}} \u0434\u043d\u0435\u0439"}}),aboutXWeeks:VM({regular:{singularNominative:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043d\u0435\u0434\u0435\u043b\u0438",singularGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043d\u0435\u0434\u0435\u043b\u044c",pluralGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043d\u0435\u0434\u0435\u043b\u044c"},future:{singularNominative:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u043d\u0435\u0434\u0435\u043b\u044e",singularGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u043d\u0435\u0434\u0435\u043b\u0438",pluralGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u043d\u0435\u0434\u0435\u043b\u044c"}}),xWeeks:VM({regular:{singularNominative:"{{count}} \u043d\u0435\u0434\u0435\u043b\u044f",singularGenitive:"{{count}} \u043d\u0435\u0434\u0435\u043b\u0438",pluralGenitive:"{{count}} \u043d\u0435\u0434\u0435\u043b\u044c"}}),aboutXMonths:VM({regular:{singularNominative:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043c\u0435\u0441\u044f\u0446\u0430",singularGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043c\u0435\u0441\u044f\u0446\u0435\u0432",pluralGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043c\u0435\u0441\u044f\u0446\u0435\u0432"},future:{singularNominative:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0435\u0441\u044f\u0446",singularGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0435\u0441\u044f\u0446\u0430",pluralGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0435\u0441\u044f\u0446\u0435\u0432"}}),xMonths:VM({regular:{singularNominative:"{{count}} \u043c\u0435\u0441\u044f\u0446",singularGenitive:"{{count}} \u043c\u0435\u0441\u044f\u0446\u0430",pluralGenitive:"{{count}} \u043c\u0435\u0441\u044f\u0446\u0435\u0432"}}),aboutXYears:VM({regular:{singularNominative:"\u043e\u043a\u043e\u043b\u043e {{count}} \u0433\u043e\u0434\u0430",singularGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043b\u0435\u0442",pluralGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043b\u0435\u0442"},future:{singularNominative:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u0433\u043e\u0434",singularGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u0433\u043e\u0434\u0430",pluralGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u043b\u0435\u0442"}}),xYears:VM({regular:{singularNominative:"{{count}} \u0433\u043e\u0434",singularGenitive:"{{count}} \u0433\u043e\u0434\u0430",pluralGenitive:"{{count}} \u043b\u0435\u0442"}}),overXYears:VM({regular:{singularNominative:"\u0431\u043e\u043b\u044c\u0448\u0435 {{count}} \u0433\u043e\u0434\u0430",singularGenitive:"\u0431\u043e\u043b\u044c\u0448\u0435 {{count}} \u043b\u0435\u0442",pluralGenitive:"\u0431\u043e\u043b\u044c\u0448\u0435 {{count}} \u043b\u0435\u0442"},future:{singularNominative:"\u0431\u043e\u043b\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u0433\u043e\u0434",singularGenitive:"\u0431\u043e\u043b\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u0433\u043e\u0434\u0430",pluralGenitive:"\u0431\u043e\u043b\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u043b\u0435\u0442"}}),almostXYears:VM({regular:{singularNominative:"\u043f\u043e\u0447\u0442\u0438 {{count}} \u0433\u043e\u0434",singularGenitive:"\u043f\u043e\u0447\u0442\u0438 {{count}} \u0433\u043e\u0434\u0430",pluralGenitive:"\u043f\u043e\u0447\u0442\u0438 {{count}} \u043b\u0435\u0442"},future:{singularNominative:"\u043f\u043e\u0447\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 {{count}} \u0433\u043e\u0434",singularGenitive:"\u043f\u043e\u0447\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 {{count}} \u0433\u043e\u0434\u0430",pluralGenitive:"\u043f\u043e\u0447\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 {{count}} \u043b\u0435\u0442"}})};const jM=function(e,t,n){return WM[e](t,n)};function YM(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const XM={date:YM({formats:{full:"EEEE, d MMMM y '\u0433.'",long:"d MMMM y '\u0433.'",medium:"d MMM y '\u0433.'",short:"dd.MM.y"},defaultWidth:"full"}),time:YM({formats:{full:"H:mm:ss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},defaultWidth:"full"}),dateTime:YM({formats:{any:"{{date}}, {{time}}"},defaultWidth:"any"})};function KM(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}var qM={};function JM(e,t){var n,i,r,s,a,o,l,c;KM(1,arguments);var u=qM,d=function(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}(null!==(n=null!==(i=null!==(r=null!==(s=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==s?s:null===t||void 0===t||null===(a=t.locale)||void 0===a||null===(o=a.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==r?r:u.weekStartsOn)&&void 0!==i?i:null===(l=u.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==n?n:0);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=function(e){KM(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===wr(e)&&"[object Date]"===t?new Date(e.getTime()):"number"===typeof e||"[object Number]"===t?new Date(e):("string"!==typeof e&&"[object String]"!==t||"undefined"===typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}(e),f=h.getUTCDay(),p=(f<d?7:0)+f-d;return h.setUTCDate(h.getUTCDate()-p),h.setUTCHours(0,0,0,0),h}function QM(e,t,n){KM(2,arguments);var i=JM(e,n),r=JM(t,n);return i.getTime()===r.getTime()}var ZM=["\u0432\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435","\u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0432\u0442\u043e\u0440\u043d\u0438\u043a","\u0441\u0440\u0435\u0434\u0443","\u0447\u0435\u0442\u0432\u0435\u0440\u0433","\u043f\u044f\u0442\u043d\u0438\u0446\u0443","\u0441\u0443\u0431\u0431\u043e\u0442\u0443"];function $M(e){var t=ZM[e];return 2===e?"'\u0432\u043e "+t+" \u0432' p":"'\u0432 "+t+" \u0432' p"}var eA={lastWeek:function(e,t,n){var i=e.getUTCDay();return QM(e,t,n)?$M(i):function(e){var t=ZM[e];switch(e){case 0:return"'\u0432 \u043f\u0440\u043e\u0448\u043b\u043e\u0435 "+t+" \u0432' p";case 1:case 2:case 4:return"'\u0432 \u043f\u0440\u043e\u0448\u043b\u044b\u0439 "+t+" \u0432' p";case 3:case 5:case 6:return"'\u0432 \u043f\u0440\u043e\u0448\u043b\u0443\u044e "+t+" \u0432' p"}}(i)},yesterday:"'\u0432\u0447\u0435\u0440\u0430 \u0432' p",today:"'\u0441\u0435\u0433\u043e\u0434\u043d\u044f \u0432' p",tomorrow:"'\u0437\u0430\u0432\u0442\u0440\u0430 \u0432' p",nextWeek:function(e,t,n){var i=e.getUTCDay();return QM(e,t,n)?$M(i):function(e){var t=ZM[e];switch(e){case 0:return"'\u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0435 "+t+" \u0432' p";case 1:case 2:case 4:return"'\u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 "+t+" \u0432' p";case 3:case 5:case 6:return"'\u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0443\u044e "+t+" \u0432' p"}}(i)},other:"P"};const tA=function(e,t,n,i){var r=eA[e];return"function"===typeof r?r(t,n,i):r};function nA(e){return function(t,n){var i;if("formatting"===(null!==n&&void 0!==n&&n.context?String(n.context):"standalone")&&e.formattingValues){var r=e.defaultFormattingWidth||e.defaultWidth,s=null!==n&&void 0!==n&&n.width?String(n.width):r;i=e.formattingValues[s]||e.formattingValues[r]}else{var a=e.defaultWidth,o=null!==n&&void 0!==n&&n.width?String(n.width):e.defaultWidth;i=e.values[o]||e.values[a]}return i[e.argumentCallback?e.argumentCallback(t):t]}}const iA={ordinalNumber:function(e,t){var n=Number(e),i=null===t||void 0===t?void 0:t.unit;return n+("date"===i?"-\u0435":"week"===i||"minute"===i||"second"===i?"-\u044f":"-\u0439")},era:nA({values:{narrow:["\u0434\u043e \u043d.\u044d.","\u043d.\u044d."],abbreviated:["\u0434\u043e \u043d. \u044d.","\u043d. \u044d."],wide:["\u0434\u043e \u043d\u0430\u0448\u0435\u0439 \u044d\u0440\u044b","\u043d\u0430\u0448\u0435\u0439 \u044d\u0440\u044b"]},defaultWidth:"wide"}),quarter:nA({values:{narrow:["1","2","3","4"],abbreviated:["1-\u0439 \u043a\u0432.","2-\u0439 \u043a\u0432.","3-\u0439 \u043a\u0432.","4-\u0439 \u043a\u0432."],wide:["1-\u0439 \u043a\u0432\u0430\u0440\u0442\u0430\u043b","2-\u0439 \u043a\u0432\u0430\u0440\u0442\u0430\u043b","3-\u0439 \u043a\u0432\u0430\u0440\u0442\u0430\u043b","4-\u0439 \u043a\u0432\u0430\u0440\u0442\u0430\u043b"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:nA({values:{narrow:["\u042f","\u0424","\u041c","\u0410","\u041c","\u0418","\u0418","\u0410","\u0421","\u041e","\u041d","\u0414"],abbreviated:["\u044f\u043d\u0432.","\u0444\u0435\u0432.","\u043c\u0430\u0440\u0442","\u0430\u043f\u0440.","\u043c\u0430\u0439","\u0438\u044e\u043d\u044c","\u0438\u044e\u043b\u044c","\u0430\u0432\u0433.","\u0441\u0435\u043d\u0442.","\u043e\u043a\u0442.","\u043d\u043e\u044f\u0431.","\u0434\u0435\u043a."],wide:["\u044f\u043d\u0432\u0430\u0440\u044c","\u0444\u0435\u0432\u0440\u0430\u043b\u044c","\u043c\u0430\u0440\u0442","\u0430\u043f\u0440\u0435\u043b\u044c","\u043c\u0430\u0439","\u0438\u044e\u043d\u044c","\u0438\u044e\u043b\u044c","\u0430\u0432\u0433\u0443\u0441\u0442","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044c","\u043e\u043a\u0442\u044f\u0431\u0440\u044c","\u043d\u043e\u044f\u0431\u0440\u044c","\u0434\u0435\u043a\u0430\u0431\u0440\u044c"]},defaultWidth:"wide",formattingValues:{narrow:["\u042f","\u0424","\u041c","\u0410","\u041c","\u0418","\u0418","\u0410","\u0421","\u041e","\u041d","\u0414"],abbreviated:["\u044f\u043d\u0432.","\u0444\u0435\u0432.","\u043c\u0430\u0440.","\u0430\u043f\u0440.","\u043c\u0430\u044f","\u0438\u044e\u043d.","\u0438\u044e\u043b.","\u0430\u0432\u0433.","\u0441\u0435\u043d\u0442.","\u043e\u043a\u0442.","\u043d\u043e\u044f\u0431.","\u0434\u0435\u043a."],wide:["\u044f\u043d\u0432\u0430\u0440\u044f","\u0444\u0435\u0432\u0440\u0430\u043b\u044f","\u043c\u0430\u0440\u0442\u0430","\u0430\u043f\u0440\u0435\u043b\u044f","\u043c\u0430\u044f","\u0438\u044e\u043d\u044f","\u0438\u044e\u043b\u044f","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f","\u043e\u043a\u0442\u044f\u0431\u0440\u044f","\u043d\u043e\u044f\u0431\u0440\u044f","\u0434\u0435\u043a\u0430\u0431\u0440\u044f"]},defaultFormattingWidth:"wide"}),day:nA({values:{narrow:["\u0412","\u041f","\u0412","\u0421","\u0427","\u041f","\u0421"],short:["\u0432\u0441","\u043f\u043d","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043f\u0442","\u0441\u0431"],abbreviated:["\u0432\u0441\u043a","\u043f\u043d\u0434","\u0432\u0442\u0440","\u0441\u0440\u0434","\u0447\u0442\u0432","\u043f\u0442\u043d","\u0441\u0443\u0431"],wide:["\u0432\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435","\u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0432\u0442\u043e\u0440\u043d\u0438\u043a","\u0441\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0435\u0440\u0433","\u043f\u044f\u0442\u043d\u0438\u0446\u0430","\u0441\u0443\u0431\u0431\u043e\u0442\u0430"]},defaultWidth:"wide"}),dayPeriod:nA({values:{narrow:{am:"\u0414\u041f",pm:"\u041f\u041f",midnight:"\u043f\u043e\u043b\u043d.",noon:"\u043f\u043e\u043b\u0434.",morning:"\u0443\u0442\u0440\u043e",afternoon:"\u0434\u0435\u043d\u044c",evening:"\u0432\u0435\u0447.",night:"\u043d\u043e\u0447\u044c"},abbreviated:{am:"\u0414\u041f",pm:"\u041f\u041f",midnight:"\u043f\u043e\u043b\u043d.",noon:"\u043f\u043e\u043b\u0434.",morning:"\u0443\u0442\u0440\u043e",afternoon:"\u0434\u0435\u043d\u044c",evening:"\u0432\u0435\u0447.",night:"\u043d\u043e\u0447\u044c"},wide:{am:"\u0414\u041f",pm:"\u041f\u041f",midnight:"\u043f\u043e\u043b\u043d\u043e\u0447\u044c",noon:"\u043f\u043e\u043b\u0434\u0435\u043d\u044c",morning:"\u0443\u0442\u0440\u043e",afternoon:"\u0434\u0435\u043d\u044c",evening:"\u0432\u0435\u0447\u0435\u0440",night:"\u043d\u043e\u0447\u044c"}},defaultWidth:"any",formattingValues:{narrow:{am:"\u0414\u041f",pm:"\u041f\u041f",midnight:"\u043f\u043e\u043b\u043d.",noon:"\u043f\u043e\u043b\u0434.",morning:"\u0443\u0442\u0440\u0430",afternoon:"\u0434\u043d\u044f",evening:"\u0432\u0435\u0447.",night:"\u043d\u043e\u0447\u0438"},abbreviated:{am:"\u0414\u041f",pm:"\u041f\u041f",midnight:"\u043f\u043e\u043b\u043d.",noon:"\u043f\u043e\u043b\u0434.",morning:"\u0443\u0442\u0440\u0430",afternoon:"\u0434\u043d\u044f",evening:"\u0432\u0435\u0447.",night:"\u043d\u043e\u0447\u0438"},wide:{am:"\u0414\u041f",pm:"\u041f\u041f",midnight:"\u043f\u043e\u043b\u043d\u043e\u0447\u044c",noon:"\u043f\u043e\u043b\u0434\u0435\u043d\u044c",morning:"\u0443\u0442\u0440\u0430",afternoon:"\u0434\u043d\u044f",evening:"\u0432\u0435\u0447\u0435\u0440\u0430",night:"\u043d\u043e\u0447\u0438"}},defaultFormattingWidth:"wide"})};function rA(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.width,r=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],s=t.match(r);if(!s)return null;var a,o=s[0],l=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n;return}(l,function(e){return e.test(o)}):function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n]))return n;return}(l,function(e){return e.test(o)});return a=e.valueCallback?e.valueCallback(c):c,{value:a=n.valueCallback?n.valueCallback(a):a,rest:t.slice(o.length)}}}var sA={ordinalNumber:function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.match(e.matchPattern);if(!i)return null;var r=i[0],s=t.match(e.parsePattern);if(!s)return null;var a=e.valueCallback?e.valueCallback(s[0]):s[0];return{value:a=n.valueCallback?n.valueCallback(a):a,rest:t.slice(r.length)}}}({matchPattern:/^(\d+)(-?(\u0435|\u044f|\u0439|\u043e\u0435|\u044c\u0435|\u0430\u044f|\u044c\u044f|\u044b\u0439|\u043e\u0439|\u0438\u0439|\u044b\u0439))?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:rA({matchPatterns:{narrow:/^((\u0434\u043e )?\u043d\.?\s?\u044d\.?)/i,abbreviated:/^((\u0434\u043e )?\u043d\.?\s?\u044d\.?)/i,wide:/^(\u0434\u043e \u043d\u0430\u0448\u0435\u0439 \u044d\u0440\u044b|\u043d\u0430\u0448\u0435\u0439 \u044d\u0440\u044b|\u043d\u0430\u0448\u0430 \u044d\u0440\u0430)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^\u0434/i,/^\u043d/i]},defaultParseWidth:"any"}),quarter:rA({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^[1234](-?[\u044b\u043e\u0438]?\u0439?)? \u043a\u0432.?/i,wide:/^[1234](-?[\u044b\u043e\u0438]?\u0439?)? \u043a\u0432\u0430\u0440\u0442\u0430\u043b/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:rA({matchPatterns:{narrow:/^[\u044f\u0444\u043c\u0430\u0438\u0441\u043e\u043d\u0434]/i,abbreviated:/^(\u044f\u043d\u0432|\u0444\u0435\u0432|\u043c\u0430\u0440\u0442?|\u0430\u043f\u0440|\u043c\u0430[\u0439\u044f]|\u0438\u044e\u043d[\u044c\u044f]?|\u0438\u044e\u043b[\u044c\u044f]?|\u0430\u0432\u0433|\u0441\u0435\u043d\u0442?|\u043e\u043a\u0442|\u043d\u043e\u044f\u0431?|\u0434\u0435\u043a)\.?/i,wide:/^(\u044f\u043d\u0432\u0430\u0440[\u044c\u044f]|\u0444\u0435\u0432\u0440\u0430\u043b[\u044c\u044f]|\u043c\u0430\u0440\u0442\u0430?|\u0430\u043f\u0440\u0435\u043b[\u044c\u044f]|\u043c\u0430[\u0439\u044f]|\u0438\u044e\u043d[\u044c\u044f]|\u0438\u044e\u043b[\u044c\u044f]|\u0430\u0432\u0433\u0443\u0441\u0442\u0430?|\u0441\u0435\u043d\u0442\u044f\u0431\u0440[\u044c\u044f]|\u043e\u043a\u0442\u044f\u0431\u0440[\u044c\u044f]|\u043e\u043a\u0442\u044f\u0431\u0440[\u044c\u044f]|\u043d\u043e\u044f\u0431\u0440[\u044c\u044f]|\u0434\u0435\u043a\u0430\u0431\u0440[\u044c\u044f])/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^\u044f/i,/^\u0444/i,/^\u043c/i,/^\u0430/i,/^\u043c/i,/^\u0438/i,/^\u0438/i,/^\u0430/i,/^\u0441/i,/^\u043e/i,/^\u043d/i,/^\u044f/i],any:[/^\u044f/i,/^\u0444/i,/^\u043c\u0430\u0440/i,/^\u0430\u043f/i,/^\u043c\u0430[\u0439\u044f]/i,/^\u0438\u044e\u043d/i,/^\u0438\u044e\u043b/i,/^\u0430\u0432/i,/^\u0441/i,/^\u043e/i,/^\u043d/i,/^\u0434/i]},defaultParseWidth:"any"}),day:rA({matchPatterns:{narrow:/^[\u0432\u043f\u0441\u0447]/i,short:/^(\u0432\u0441|\u0432\u043e|\u043f\u043d|\u043f\u043e|\u0432\u0442|\u0441\u0440|\u0447\u0442|\u0447\u0435|\u043f\u0442|\u043f\u044f|\u0441\u0431|\u0441\u0443)\.?/i,abbreviated:/^(\u0432\u0441\u043a|\u0432\u043e\u0441|\u043f\u043d\u0434|\u043f\u043e\u043d|\u0432\u0442\u0440|\u0432\u0442\u043e|\u0441\u0440\u0434|\u0441\u0440\u0435|\u0447\u0442\u0432|\u0447\u0435\u0442|\u043f\u0442\u043d|\u043f\u044f\u0442|\u0441\u0443\u0431).?/i,wide:/^(\u0432\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c[\u0435\u044f]|\u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a\u0430?|\u0432\u0442\u043e\u0440\u043d\u0438\u043a\u0430?|\u0441\u0440\u0435\u0434[\u0430\u044b]|\u0447\u0435\u0442\u0432\u0435\u0440\u0433\u0430?|\u043f\u044f\u0442\u043d\u0438\u0446[\u0430\u044b]|\u0441\u0443\u0431\u0431\u043e\u0442[\u0430\u044b])/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^\u0432/i,/^\u043f/i,/^\u0432/i,/^\u0441/i,/^\u0447/i,/^\u043f/i,/^\u0441/i],any:[/^\u0432[\u043e\u0441]/i,/^\u043f[\u043e\u043d]/i,/^\u0432/i,/^\u0441\u0440/i,/^\u0447/i,/^\u043f[\u044f\u0442]/i,/^\u0441[\u0443\u0431]/i]},defaultParseWidth:"any"}),dayPeriod:rA({matchPatterns:{narrow:/^([\u0434\u043f]\u043f|\u043f\u043e\u043b\u043d\.?|\u043f\u043e\u043b\u0434\.?|\u0443\u0442\u0440[\u043e\u0430]|\u0434\u0435\u043d\u044c|\u0434\u043d\u044f|\u0432\u0435\u0447\.?|\u043d\u043e\u0447[\u044c\u0438])/i,abbreviated:/^([\u0434\u043f]\u043f|\u043f\u043e\u043b\u043d\.?|\u043f\u043e\u043b\u0434\.?|\u0443\u0442\u0440[\u043e\u0430]|\u0434\u0435\u043d\u044c|\u0434\u043d\u044f|\u0432\u0435\u0447\.?|\u043d\u043e\u0447[\u044c\u0438])/i,wide:/^([\u0434\u043f]\u043f|\u043f\u043e\u043b\u043d\u043e\u0447\u044c|\u043f\u043e\u043b\u0434\u0435\u043d\u044c|\u0443\u0442\u0440[\u043e\u0430]|\u0434\u0435\u043d\u044c|\u0434\u043d\u044f|\u0432\u0435\u0447\u0435\u0440\u0430?|\u043d\u043e\u0447[\u044c\u0438])/i},defaultMatchWidth:"wide",parsePatterns:{any:{am:/^\u0434\u043f/i,pm:/^\u043f\u043f/i,midnight:/^\u043f\u043e\u043b\u043d/i,noon:/^\u043f\u043e\u043b\u0434/i,morning:/^\u0443/i,afternoon:/^\u0434[\u0435\u043d]/i,evening:/^\u0432/i,night:/^\u043d/i}},defaultParseWidth:"any"})};const aA={code:"ru",formatDistance:jM,formatLong:XM,formatRelative:tA,localize:iA,match:sA,options:{weekStartsOn:1,firstWeekContainsDate:1}};var oA=n(51);function lA(e){e()}var cA={notify(){},get:()=>[]};function uA(e,t){let n,i=cA,r=0,s=!1;function a(){c.onStateChange&&c.onStateChange()}function o(){r++,n||(n=t?t.addNestedSub(a):e.subscribe(a),i=function(){let e=null,t=null;return{clear(){e=null,t=null},notify(){lA(()=>{let t=e;for(;t;)t.callback(),t=t.next})},get(){const t=[];let n=e;for(;n;)t.push(n),n=n.next;return t},subscribe(n){let i=!0;const r=t={callback:n,next:null,prev:t};return r.prev?r.prev.next=r:e=r,function(){i&&null!==e&&(i=!1,r.next?r.next.prev=r.prev:t=r.prev,r.prev?r.prev.next=r.next:e=r.next)}}}}())}function l(){r--,n&&0===r&&(n(),n=void 0,i.clear(),i=cA)}const c={addNestedSub:function(e){o();const t=i.subscribe(e);let n=!1;return()=>{n||(n=!0,t(),l())}},notifyNestedSubs:function(){i.notify()},handleChangeWrapper:a,isSubscribed:function(){return s},trySubscribe:function(){s||(s=!0,o())},tryUnsubscribe:function(){s&&(s=!1,l())},getListeners:()=>i};return c}var dA=(()=>!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement))(),hA=(()=>"undefined"!==typeof navigator&&"ReactNative"===navigator.product)(),fA=(()=>dA||hA?t.useLayoutEffect:t.useEffect)();Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.prototype;var pA=Symbol.for("react-redux-context"),mA="undefined"!==typeof globalThis?globalThis:{};function gA(){var e;if(!t.createContext)return{};const n=null!==(e=mA[pA])&&void 0!==e?e:mA[pA]=new Map;let i=n.get(t.createContext);return i||(i=t.createContext(null),n.set(t.createContext,i)),i}var vA=gA();var yA=function(e){const{children:n,context:i,serverState:r,store:s}=e,a=t.useMemo(()=>{const e=uA(s);return{store:s,subscription:e,getServerState:r?()=>r:void 0}},[s,r]),o=t.useMemo(()=>s.getState(),[s]);fA(()=>{const{subscription:e}=a;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),o!==s.getState()&&e.notifyNestedSubs(),()=>{e.tryUnsubscribe(),e.onStateChange=void 0}},[a,o]);const l=i||vA;return t.createElement(l.Provider,{value:a},n)};function _A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vA;return function(){return t.useContext(e)}}var bA=_A();function xA(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vA;const t=e===vA?bA:_A(e),n=()=>{const{store:e}=t();return e};return Object.assign(n,{withTypes:()=>n}),n}var SA=xA();function EA(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vA;const t=e===vA?SA:xA(e),n=()=>t().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var wA=EA(),TA=(e,t)=>e===t;function MA(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vA;const n=e===vA?bA:_A(e),i=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{equalityFn:r=TA}="function"===typeof i?{equalityFn:i}:i;const s=n(),{store:a,subscription:o,getServerState:l}=s,c=(t.useRef(!0),t.useCallback({[e.name]:t=>e(t)}[e.name],[e])),u=(0,oA.useSyncExternalStoreWithSelector)(o.addNestedSub,a.getState,l||a.getState,c,r);return t.useDebugValue(u),u};return Object.assign(i,{withTypes:()=>i}),i}const AA=()=>wA(),CA=MA();var RA=Symbol.for("immer-nothing"),LA=Symbol.for("immer-draftable"),PA=Symbol.for("immer-state");function IA(e){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var DA=Object.getPrototypeOf;function kA(e){return!!e&&!!e[PA]}function OA(e){var t;return!!e&&(BA(e)||Array.isArray(e)||!!e[LA]||!(null===(t=e.constructor)||void 0===t||!t[LA])||VA(e)||WA(e))}var NA=Object.prototype.constructor.toString(),FA=new WeakMap;function BA(e){if(!e||"object"!==typeof e)return!1;const t=Object.getPrototypeOf(e);if(null===t||t===Object.prototype)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(n===Object)return!0;if("function"!==typeof n)return!1;let i=FA.get(n);return void 0===i&&(i=Function.toString.call(n),FA.set(n,i)),i===NA}function UA(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===HA(e)){(n?Reflect.ownKeys(e):Object.keys(e)).forEach(n=>{t(n,e[n],e)})}else e.forEach((n,i)=>t(i,n,e))}function HA(e){const t=e[PA];return t?t.type_:Array.isArray(e)?1:VA(e)?2:WA(e)?3:0}function zA(e,t){return 2===HA(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function GA(e,t,n){const i=HA(e);2===i?e.set(t,n):3===i?e.add(n):e[t]=n}function VA(e){return e instanceof Map}function WA(e){return e instanceof Set}function jA(e){return e.copy_||e.base_}function YA(e,t){if(VA(e))return new Map(e);if(WA(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=BA(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[PA];let n=Reflect.ownKeys(t);for(let i=0;i<n.length;i++){const r=n[i],s=t[r];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[r]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[r]})}return Object.create(DA(e),t)}{const t=DA(e);if(null!==t&&n)return Cr({},e);const i=Object.create(t);return Object.assign(i,e)}}function XA(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return qA(e)||kA(e)||!OA(e)||(HA(e)>1&&Object.defineProperties(e,{set:KA,add:KA,clear:KA,delete:KA}),Object.freeze(e),t&&Object.values(e).forEach(e=>XA(e,!0))),e}var KA={value:function(){IA(2)}};function qA(e){return null===e||"object"!==typeof e||Object.isFrozen(e)}var JA,QA={};function ZA(e){const t=QA[e];return t||IA(0),t}function $A(){return JA}function eC(e,t){t&&(ZA("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function tC(e){nC(e),e.drafts_.forEach(rC),e.drafts_=null}function nC(e){e===JA&&(JA=e.parent_)}function iC(e){return JA={drafts_:[],parent_:JA,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function rC(e){const t=e[PA];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function sC(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[PA].modified_&&(tC(t),IA(4)),OA(e)&&(e=aC(t,e),t.parent_||lC(t,e)),t.patches_&&ZA("Patches").generateReplacementPatches_(n[PA].base_,e,t.patches_,t.inversePatches_)):e=aC(t,n,[]),tC(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==RA?e:void 0}function aC(e,t,n){if(qA(t))return t;const i=e.immer_.shouldUseStrictIteration(),r=t[PA];if(!r)return UA(t,(i,s)=>oC(e,r,t,i,s,n),i),t;if(r.scope_!==e)return t;if(!r.modified_)return lC(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const t=r.copy_;let s=t,a=!1;3===r.type_&&(s=new Set(t),t.clear(),a=!0),UA(s,(i,s)=>oC(e,r,t,i,s,n,a),i),lC(e,t,!1),n&&e.patches_&&ZA("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function oC(e,t,n,i,r,s,a){if(null==r)return;if("object"!==typeof r&&!a)return;const o=qA(r);if(!o||a){if(kA(r)){const a=aC(e,r,s&&t&&3!==t.type_&&!zA(t.assigned_,i)?s.concat(i):void 0);if(GA(n,i,a),!kA(a))return;e.canAutoFreeze_=!1}else a&&n.add(r);if(OA(r)&&!o){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;if(t&&t.base_&&t.base_[i]===r&&o)return;aC(e,r),t&&t.scope_.parent_||"symbol"===typeof i||!(VA(n)?n.has(i):Object.prototype.propertyIsEnumerable.call(n,i))||lC(e,r)}}}function lC(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&XA(t,n)}var cC={get(e,t){if(t===PA)return e;const n=jA(e);if(!zA(n,t))return function(e,t,n){var i;const r=hC(t,n);return r?"value"in r?r.value:null===(i=r.get)||void 0===i?void 0:i.call(e.draft_):void 0}(e,n,t);const i=n[t];return e.finalized_||!OA(i)?i:i===dC(e.base_,t)?(pC(e),e.copy_[t]=mC(i,e)):i},has:(e,t)=>t in jA(e),ownKeys:e=>Reflect.ownKeys(jA(e)),set(e,t,n){const i=hC(jA(e),t);if(null!==i&&void 0!==i&&i.set)return i.set.call(e.draft_,n),!0;if(!e.modified_){const i=dC(jA(e),t),a=null===i||void 0===i?void 0:i[PA];if(a&&a.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(((r=n)===(s=i)?0!==r||1/r===1/s:r!==r&&s!==s)&&(void 0!==n||zA(e.base_,t)))return!0;pC(e),fC(e)}var r,s;return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==dC(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,pC(e),fC(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=jA(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:i.enumerable,value:n[t]}:i},defineProperty(){IA(11)},getPrototypeOf:e=>DA(e.base_),setPrototypeOf(){IA(12)}},uC={};function dC(e,t){const n=e[PA];return(n?jA(n):e)[t]}function hC(e,t){if(!(t in e))return;let n=DA(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=DA(n)}}function fC(e){e.modified_||(e.modified_=!0,e.parent_&&fC(e.parent_))}function pC(e){e.copy_||(e.copy_=YA(e.base_,e.scope_.immer_.useStrictShallowCopy_))}UA(cC,(e,t)=>{uC[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),uC.deleteProperty=function(e,t){return uC.set.call(this,e,t,void 0)},uC.set=function(e,t,n){return cC.set.call(this,e[0],t,n,e[0])};function mC(e,t){const n=VA(e)?ZA("MapSet").proxyMap_(e,t):WA(e)?ZA("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),i={type_:n?1:0,scope_:t?t.scope_:$A(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=cC;n&&(r=[i],s=uC);const{revoke:a,proxy:o}=Proxy.revocable(r,s);return i.draft_=o,i.revoke_=a,o}(e,t);return(t?t.scope_:$A()).drafts_.push(n),n}function gC(e){if(!OA(e)||qA(e))return e;const t=e[PA];let n,i=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=YA(e,t.scope_.immer_.useStrictShallowCopy_),i=t.scope_.immer_.shouldUseStrictIteration()}else n=YA(e,!0);return UA(n,(e,t)=>{GA(n,e,gC(t))},i),t&&(t.finalized_=!1),n}var vC=new class{constructor(e){var t=this;this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,n)=>{if("function"===typeof e&&"function"!==typeof t){const n=t;t=e;const i=this;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return i.produce(e,e=>t.call(this,e,...s))}}let i;if("function"!==typeof t&&IA(6),void 0!==n&&"function"!==typeof n&&IA(7),OA(e)){const r=iC(this),s=mC(e,void 0);let a=!0;try{i=t(s),a=!1}finally{a?tC(r):nC(r)}return eC(r,n),sC(i,r)}if(!e||"object"!==typeof e){if(i=t(e),void 0===i&&(i=e),i===RA&&(i=void 0),this.autoFreeze_&&XA(i,!0),n){const t=[],r=[];ZA("Patches").generateReplacementPatches_(e,i,t,r),n(t,r)}return i}IA(1)},this.produceWithPatches=(e,n)=>{if("function"===typeof e)return function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];return t.produceWithPatches(n,t=>e(t,...r))};let i,r;return[this.produce(e,n,(e,t)=>{i=e,r=t}),i,r]},"boolean"===typeof(null===e||void 0===e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"===typeof(null===e||void 0===e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),"boolean"===typeof(null===e||void 0===e?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){OA(e)||IA(8),kA(e)&&(e=function(e){kA(e)||IA(10);return gC(e)}(e));const t=iC(this),n=mC(e,void 0);return n[PA].isManual_=!0,nC(t),n}finishDraft(e,t){const n=e&&e[PA];n&&n.isManual_||IA(9);const{scope_:i}=n;return eC(i,t),sC(void 0,i)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}n>-1&&(t=t.slice(n+1));const i=ZA("Patches").applyPatches_;return kA(e)?i(e,t):this.produce(e,e=>i(e,t))}},yC=vC.produce,_C=vC.setUseStrictIteration.bind(vC);function bC(e){return"Minified Redux error #".concat(e,"; visit https://redux.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}var xC=(()=>"function"===typeof Symbol&&Symbol.observable||"@@observable")(),SC=()=>Math.random().toString(36).substring(7).split("").join("."),EC={INIT:"@@redux/INIT".concat(SC()),REPLACE:"@@redux/REPLACE".concat(SC()),PROBE_UNKNOWN_ACTION:()=>"@@redux/PROBE_UNKNOWN_ACTION".concat(SC())};function wC(e){if("object"!==typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function TC(e,t,n){if("function"!==typeof e)throw new Error(bC(2));if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(bC(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(bC(1));return n(TC)(e,t)}let i=e,r=t,s=new Map,a=s,o=0,l=!1;function c(){a===s&&(a=new Map,s.forEach((e,t)=>{a.set(t,e)}))}function u(){if(l)throw new Error(bC(3));return r}function d(e){if("function"!==typeof e)throw new Error(bC(4));if(l)throw new Error(bC(5));let t=!0;c();const n=o++;return a.set(n,e),function(){if(t){if(l)throw new Error(bC(6));t=!1,c(),a.delete(n),s=null}}}function h(e){if(!wC(e))throw new Error(bC(7));if("undefined"===typeof e.type)throw new Error(bC(8));if("string"!==typeof e.type)throw new Error(bC(17));if(l)throw new Error(bC(9));try{l=!0,r=i(r,e)}finally{l=!1}return(s=a).forEach(e=>{e()}),e}h({type:EC.INIT});return{dispatch:h,subscribe:d,getState:u,replaceReducer:function(e){if("function"!==typeof e)throw new Error(bC(10));i=e,h({type:EC.REPLACE})},[xC]:function(){const e=d;return{subscribe(t){if("object"!==typeof t||null===t)throw new Error(bC(11));function n(){const e=t;e.next&&e.next(u())}n();return{unsubscribe:e(n)}},[xC](){return this}}}}}function MC(e){const t=Object.keys(e),n={};for(let s=0;s<t.length;s++){const i=t[s];0,"function"===typeof e[i]&&(n[i]=e[i])}const i=Object.keys(n);let r;try{!function(e){Object.keys(e).forEach(t=>{const n=e[t];if("undefined"===typeof n(void 0,{type:EC.INIT}))throw new Error(bC(12));if("undefined"===typeof n(void 0,{type:EC.PROBE_UNKNOWN_ACTION()}))throw new Error(bC(13))})}(n)}catch(kne){r=kne}return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(r)throw r;let s=!1;const a={};for(let r=0;r<i.length;r++){const o=i[r],l=n[o],c=e[o],u=l(c,t);if("undefined"===typeof u){t&&t.type;throw new Error(bC(14))}a[o]=u,s=s||u!==c}return s=s||i.length!==Object.keys(e).length,s?a:e}}function AC(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?e=>e:1===t.length?t[0]:t.reduce((e,t)=>function(){return e(t(...arguments))})}function CC(e){return t=>{let{dispatch:n,getState:i}=t;return t=>r=>"function"===typeof r?r(n,i,e):t(r)}}var RC=CC(),LC=CC;const PC=["reducerPath"];var IC="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?AC:AC.apply(null,arguments)};"undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;function DC(e,t){function n(){if(t){let n=t(...arguments);if(!n)throw new Error(eR(0));return Cr(Cr({type:e,payload:n.payload},"meta"in n&&{meta:n.meta}),"error"in n&&{error:n.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return n.toString=()=>"".concat(e),n.type=e,n.match=t=>function(e){return wC(e)&&"type"in e&&"string"===typeof e.type}(t)&&t.type===e,n}var kC=class e extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return super.concat.apply(this,t)}prepend(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return 1===n.length&&Array.isArray(n[0])?new e(...n[0].concat(this)):new e(...n.concat(this))}};function OC(e){return OA(e)?yC(e,()=>{}):e}function NC(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}var FC="RTK_autoBatch",BC=e=>t=>{setTimeout(t,e)},UC=e=>function(t){const{autoBatch:n=!0}=null!==t&&void 0!==t?t:{};let i=new kC(e);return n&&i.push(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"raf"};return t=>function(){const n=t(...arguments);let i=!0,r=!1,s=!1;const a=new Set,o="tick"===e.type?queueMicrotask:"raf"===e.type?"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:BC(10):"callback"===e.type?e.queueNotification:BC(e.timeout),l=()=>{s=!1,r&&(r=!1,a.forEach(e=>e()))};return Object.assign({},n,{subscribe(e){const t=n.subscribe(()=>i&&e());return a.add(e),()=>{t(),a.delete(e)}},dispatch(e){try{var t;return i=!(null!==e&&void 0!==e&&null!==(t=e.meta)&&void 0!==t&&t[FC]),r=!i,r&&(s||(s=!0,o(l))),n.dispatch(e)}finally{i=!0}}})}}("object"===typeof n?n:void 0)),i};function HC(e){const t={},n=[];let i;const r={addCase(e,n){const i="string"===typeof e?e:e.type;if(!i)throw new Error(eR(28));if(i in t)throw new Error(eR(29));return t[i]=n,r},addAsyncThunk:(e,i)=>(i.pending&&(t[e.pending.type]=i.pending),i.rejected&&(t[e.rejected.type]=i.rejected),i.fulfilled&&(t[e.fulfilled.type]=i.fulfilled),i.settled&&n.push({matcher:e.settled,reducer:i.settled}),r),addMatcher:(e,t)=>(n.push({matcher:e,reducer:t}),r),addDefaultCase:e=>(i=e,r)};return e(r),[t,n,i]}_C(!1);var zC=Symbol.for("rtk-slice-createasyncthunk");function GC(e,t){return"".concat(e,"/").concat(t)}function VC(){var e;let{creators:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=null===t||void 0===t||null===(e=t.asyncThunk)||void 0===e?void 0:e[zC];return function(e){const{name:t,reducerPath:i=t}=e;if(!t)throw new Error(eR(11));const r=("function"===typeof e.reducers?e.reducers(function(){function e(e,t){return Cr({_reducerDefinitionType:"asyncThunk",payloadCreator:e},t)}return e.withTypes=()=>e,{reducer:e=>Object.assign({[e.name](){return e(...arguments)}}[e.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(e,t)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}),asyncThunk:e}}()):e.reducers)||{},s=Object.keys(r),a={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},o={addCase(e,t){const n="string"===typeof e?e:e.type;if(!n)throw new Error(eR(12));if(n in a.sliceCaseReducersByType)throw new Error(eR(13));return a.sliceCaseReducersByType[n]=t,o},addMatcher:(e,t)=>(a.sliceMatchers.push({matcher:e,reducer:t}),o),exposeAction:(e,t)=>(a.actionCreators[e]=t,o),exposeCaseReducer:(e,t)=>(a.sliceCaseReducersByName[e]=t,o)};function l(){const[t={},n=[],i]="function"===typeof e.extraReducers?HC(e.extraReducers):[e.extraReducers],r=Cr(Cr({},t),a.sliceCaseReducersByType);return function(e,t){let n,[i,r,s]=HC(t);if("function"===typeof e)n=()=>OC(e());else{const t=OC(e);n=()=>t}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n(),t=arguments.length>1?arguments[1]:void 0,a=[i[t.type],...r.filter(e=>{let{matcher:n}=e;return n(t)}).map(e=>{let{reducer:t}=e;return t})];return 0===a.filter(e=>!!e).length&&(a=[s]),a.reduce((e,n)=>{if(n){if(kA(e)){const i=n(e,t);return void 0===i?e:i}if(OA(e))return yC(e,e=>n(e,t));{const i=n(e,t);if(void 0===i){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return i}}return e},e)}return a.getInitialState=n,a}(e.initialState,e=>{for(let t in r)e.addCase(t,r[t]);for(let t of a.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of n)e.addMatcher(t.matcher,t.reducer);i&&e.addDefaultCase(i)})}s.forEach(i=>{const s=r[i],a={reducerName:i,type:GC(t,i),createNotation:"function"===typeof e.reducers};!function(e){return"asyncThunk"===e._reducerDefinitionType}(s)?function(e,t,n){let i,r,{type:s,reducerName:a,createNotation:o}=e;if("reducer"in t){if(o&&!function(e){return"reducerWithPrepare"===e._reducerDefinitionType}(t))throw new Error(eR(17));i=t.reducer,r=t.prepare}else i=t;n.addCase(s,i).exposeCaseReducer(a,i).exposeAction(a,r?DC(s,r):DC(s))}(a,s,o):function(e,t,n,i){let{type:r,reducerName:s}=e;if(!i)throw new Error(eR(18));const{payloadCreator:a,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=t,h=i(r,a,d);n.exposeAction(s,h),o&&n.addCase(h.fulfilled,o);l&&n.addCase(h.pending,l);c&&n.addCase(h.rejected,c);u&&n.addMatcher(h.settled,u);n.exposeCaseReducer(s,{fulfilled:o||YC,pending:l||YC,rejected:c||YC,settled:u||YC})}(a,s,o,n)});const c=e=>e,u=new Map,h=new WeakMap;let f;function p(e,t){return f||(f=l()),f(e,t)}function m(){return f||(f=l()),f.getInitialState()}function g(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function i(e){let r=e[t];return"undefined"===typeof r&&n&&(r=NC(h,i,m)),r}function r(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c;const i=NC(u,n,()=>new WeakMap);return NC(i,t,()=>{const i={};for(const[s,a]of Object.entries(null!==(r=e.selectors)&&void 0!==r?r:{})){var r;i[s]=WC(a,t,()=>NC(h,t,m),n)}return i})}return{reducerPath:t,getSelectors:r,get selectors(){return r(i)},selectSlice:i}}const v=Cr(Cr({name:t,reducer:p,actions:a.actionCreators,caseReducers:a.sliceCaseReducersByName,getInitialState:m},g(i)),{},{injectInto(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{reducerPath:n}=t,r=d(t,PC);const s=null!==n&&void 0!==n?n:i;return e.inject({reducerPath:s,reducer:p},r),Cr(Cr({},v),g(s,!0))}});return v}}function WC(e,t,n,i){function r(r){let s=t(r);"undefined"===typeof s&&i&&(s=n());for(var a=arguments.length,o=new Array(a>1?a-1:0),l=1;l<a;l++)o[l-1]=arguments[l];return e(s,...o)}return r.unwrapped=e,r}var jC=VC();function YC(){}var XC="listener",KC="completed",qC="cancelled";"task-".concat(qC),"task-".concat(KC),"".concat(XC,"-").concat(qC),"".concat(XC,"-").concat(KC);var{assign:JC}=Object,QC="listenerMiddleware",ZC=JC(DC("".concat(QC,"/add")),{withTypes:()=>ZC}),$C=("".concat(QC,"/removeAll"),JC(DC("".concat(QC,"/remove")),{withTypes:()=>$C}));Symbol.for("rtk-state-proxy-original");function eR(e){return"Minified Redux Toolkit error #".concat(e,"; visit https://redux-toolkit.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}const tR=jC({name:"search",initialState:{results:[],filters:{dateStart:null,dateEnd:null}},selectors:{filters:e=>e.filters,isFiltersValid:e=>!!e.filters.dateStart&&!!e.filters.dateEnd,results:e=>e.results},reducers:{setDateStart:(e,t)=>{e.filters&&(e.filters.dateStart=t.payload)},setDateEnd:(e,t)=>{e.filters&&(e.filters.dateEnd=t.payload)}}}),{reducer:nR,actions:iR,selectors:rR}=tR,sR=()=>{const e=CA(rR.filters),t=CA(rR.isFiltersValid),n=AA(),i=Ns();return(0,p.jsxs)("div",{className:I_,children:[(0,p.jsx)("div",{className:k_,style:{position:"relative",zIndex:10},children:(0,p.jsx)(NM,{locale:aA,selected:e.dateStart?new Date(e.dateStart):null,onChange:t=>{var i;n(iR.setDateStart(null!==(i=null===t||void 0===t?void 0:t.toISOString())&&void 0!==i?i:null)),t&&e.dateEnd&&t>new Date(e.dateEnd)&&n(iR.setDateEnd(null))},selectsStart:!0,isClearable:!1,monthsShown:1,minDate:new Date,startDate:e.dateStart?new Date(e.dateStart):null,endDate:e.dateEnd?new Date(e.dateEnd):null,dateFormat:"dd.MM.yyyy",popperPlacement:"bottom-start",showPopperArrow:!1,previousMonthButtonLabel:"< \u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439",nextMonthButtonLabel:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 >",customInput:(0,p.jsx)(aR,{})})}),(0,p.jsx)("div",{className:k_,style:{position:"relative",zIndex:10},children:(0,p.jsx)(NM,{locale:aA,selected:e.dateEnd?new Date(e.dateEnd):null,selectsEnd:!0,onChange:t=>{var i;t&&e.dateStart&&t<new Date(e.dateStart)||n(iR.setDateEnd(null!==(i=null===t||void 0===t?void 0:t.toISOString())&&void 0!==i?i:null))},isClearable:!1,monthsShown:1,startDate:e.dateStart?new Date(e.dateStart):null,endDate:e.dateEnd?new Date(e.dateEnd):null,minDate:new Date,dateFormat:"dd.MM.yyyy",popperPlacement:"bottom-start",showPopperArrow:!1,previousMonthButtonLabel:"< \u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439",nextMonthButtonLabel:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 >",customInput:(0,p.jsx)(oR,{})})}),(0,p.jsx)("div",{className:"".concat(k_," ").concat(O_),children:(0,p.jsx)(zM,{className:D_,title:"\u041d\u0430\u0439\u0442\u0438 \u043d\u043e\u043c\u0435\u0440\u0430",disabled:!t,onClick:()=>i("/search")})})]})},aR=(0,t.forwardRef)((e,t)=>{let{value:n,onClick:i,title:r}=e;return(0,p.jsxs)("button",{className:N_,onClick:i,ref:t,children:[n||"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0430\u0442\u0443 \u0437\u0430\u0435\u0437\u0434\u0430",(0,p.jsx)("span",{className:F_,children:"\u25bc"})]})}),oR=(0,t.forwardRef)((e,t)=>{let{value:n,onClick:i,title:r}=e;return(0,p.jsxs)("button",{className:N_,onClick:i,ref:t,children:[n||"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0430\u0442\u0443 \u0432\u044b\u0435\u0437\u0434a",(0,p.jsx)("span",{className:F_,children:"\u25bc"})]})});Er.registerPlugin(pu);const lR=e=>{let{scrollerRef:n}=e;const i=(0,t.useRef)(null),r=(0,t.useRef)(null),s=(0,t.useContext)(E),a=(0,t.useContext)(x),o=(0,t.useRef)(null);return(0,t.useEffect)(()=>{if(P_.isSupported()&&o.current){const e=new P_;e.loadSource("/hls/index.m3u8"),e.attachMedia(o.current)}else o.current&&o.current.canPlayType("application/vnd.apple.mpegurl")&&(o.current.src="/hls/index.m3u8")},[o.current]),(0,t.useEffect)(()=>{Er.to(r.current,{scrollTrigger:{trigger:i.current,scroller:n.current,start:"top top",end:"bottom top",scrub:!0},backgroundPosition:"center 100%"}),Er.timeline({scrollTrigger:{trigger:i.current,scroller:n.current,start:"top -10%",scrub:!1,onEnter:()=>{a[1]("home")},onLeaveBack:()=>{a[1]("hidden")}}})},[n]),(0,p.jsx)("section",{ref:i,className:qa,children:(0,p.jsxs)("div",{ref:r,className:"".concat(no),children:[(0,p.jsx)("video",{ref:o,autoPlay:!0,muted:!0,loop:!0,playsInline:!0,className:io}),(0,p.jsx)("div",{className:"".concat(to)}),(0,p.jsxs)("header",{className:"".concat(Za),children:[(0,p.jsxs)("div",{className:$a,children:[(0,p.jsx)(N,{className:Qa}),(0,p.jsxs)("nav",{className:Ja,children:[(0,p.jsx)(g,{active:!1,title:"\u041e \u043d\u0430\u0441",onClick:()=>s[1]("about")}),(0,p.jsx)(g,{active:!1,title:"\u041f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u0435",onClick:()=>s[1]("acco")}),(0,p.jsx)(g,{active:!1,title:"\u0426\u0435\u043d\u044b",onClick:()=>s[1]("price")}),(0,p.jsx)(g,{active:!1,title:"\u041d\u043e\u0432\u043e\u0441\u0442\u0438",onClick:()=>s[1]("news")})]})]}),(0,p.jsx)("div",{className:eo,children:(0,p.jsx)(b,{title:"\u041f\u043e\u0434\u0430\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443",onClick:()=>{}})})]}),(0,p.jsx)("div",{className:ro,children:(0,p.jsxs)("div",{className:so,children:[(0,p.jsx)("div",{className:ao,children:"\u0413\u041e\u0421\u0422\u0418\u041d\u0418\u0426\u0410 \u041d\u0415\u0419\u041c\u0410\u0420\u041a"}),(0,p.jsx)("div",{className:oo,children:"\u0416\u0418\u0412\u0418 \u0422\u0410\u041c, \u0413\u0414\u0415 \u0420\u0410\u0421\u0422\u0415\u0422 \u0411\u0423\u0414\u0423\u0429\u0415\u0415"}),(0,p.jsx)(sR,{})]})})]})})},cR={main:"AboutComponent_main__dtRxZ",animate_before_first:"AboutComponent_animate_before_first__kG1yt",animate_before_second:"AboutComponent_animate_before_second__qKXUq",animate:"AboutComponent_animate__jQFOH",animated_block:"AboutComponent_animated_block__y4BDs",hint_span:"AboutComponent_hint_span__rOvBe",description_section:"AboutComponent_description_section__ALXjd",word:"AboutComponent_word__5YsVW",content:"AboutComponent_content__4GnI5",image_small:"AboutComponent_image_small__WFM6+",image_medium:"AboutComponent_image_medium__ebGy3",content_text:"AboutComponent_content_text__5ObK0",content_image_left:"AboutComponent_content_image_left__k+4Si",content_image_right:"AboutComponent_content_image_right__LUp+j",text_title:"AboutComponent_text_title__SSUCM",text_paragraph:"AboutComponent_text_paragraph__rFKNR",header_about:"AboutComponent_header_about__v79EU",text_header_animated:"AboutComponent_text_header_animated__KQpdh",animated_text_words:"AboutComponent_animated_text_words__HTyCv"},uR=n.p+"static/media/about_im_1_1.48a6bcc82f914213b79e.jpeg",dR=n.p+"static/media/about_im_1_2.43b2424ad2202d17acc9.jpeg",hR=n.p+"static/media/about_im_2_1.99387e17241e723441ac.jpg",fR=n.p+"static/media/about_im_2_2.f4d1bbbb1015d67fa655.jpg",pR=e=>{let{scrollerRef:n}=e;const i=(0,t.useRef)(null),r=(0,t.useRef)(null),s=Ns();(0,t.useEffect)(()=>{n.current&&(Er.timeline({scrollTrigger:{trigger:i.current,scroller:n.current,start:"top 30%",scrub:!1,once:!0}}).from(".".concat(cR.text_header_animated),{x:"100vw",opacity:0,stagger:.01,duration:.01}).to(".".concat(cR.text_header_animated),{x:0,opacity:1,stagger:.01,duration:.7}),Er.timeline({scrollTrigger:{trigger:i.current,scroller:n.current,start:"top 30%",scrub:!1,once:!0}}).from(".".concat(cR.animate_before_first),{y:"100vw",opacity:0,duration:.1}).to(".".concat(cR.animate_before_first),{y:0,opacity:1,duration:.3}).to(".".concat(cR.animate_before_first),{duration:.05}).from(".".concat(cR.animate_before_second),{y:"100vw",opacity:0,duration:.1}).to(".".concat(cR.animate_before_second),{y:0,opacity:1,duration:.3}))},[n]);return(0,p.jsx)("section",{ref:i,className:cR.main,children:(0,p.jsxs)("div",{ref:r,className:cR.description_section,children:[(0,p.jsx)("span",{className:cR.hint_span,children:"\u041e \u041d\u0410\u0421"}),(0,p.jsx)("h1",{className:cR.header_about,children:"\u041a\u041e\u041c\u0424\u041e\u0420\u0422\u041d\u042b\u0415  \u041c\u0415\u0411\u0415\u041b\u0418\u0420\u041e\u0412\u0410\u041d\u041d\u042b\u0415  \u041d\u041e\u041c\u0415\u0420\u0410  \u0421  \u041e\u0411\u0421\u041b\u0423\u0416\u0418\u0412\u0410\u041d\u0418\u0415\u041c  \u0412  \u0426\u0415\u041d\u0422\u0420\u0415  \u0413\u041e\u0420\u041e\u0414\u0410".split(" ").map((e,t)=>(0,p.jsxs)("span",{className:cR.word,children:[e.split("").map((e,t)=>(0,p.jsx)("span",{className:cR.text_header_animated,children:e},t)),(0,p.jsx)("span",{className:cR.space,children:"\xa0"})]},t))}),(0,p.jsxs)("div",{className:cR.content,children:[(0,p.jsxs)("div",{className:cR.content_image_left,children:[(0,p.jsx)("div",{className:"".concat(cR.image_medium," ").concat(cR.animate_before_first),style:{backgroundImage:"url(".concat(uR,")")}}),(0,p.jsx)("div",{className:"".concat(cR.image_small," ").concat(cR.animate_before_second),style:{backgroundImage:"url(".concat(dR,")")}})]}),(0,p.jsxs)("div",{className:cR.content_text,children:[(0,p.jsx)("div",{className:"".concat(cR.text_title," ").concat(cR.animate_before_second),children:"\u0421\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0435 \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u0435 \u0434\u043b\u044f \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u043e\u0432 \u0418\u0422-\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0439"}),(0,p.jsx)("div",{className:"".concat(cR.text_paragraph," ").concat(cR.animate_before_first),children:(0,p.jsxs)("ul",{children:[(0,p.jsx)("li",{children:"\u0426\u0435\u043d\u0442\u0440 \u0433\u043e\u0440\u043e\u0434\u0430 \u0438 \u0443\u043d\u0438\u0432\u0435\u0440\u0441\u0438\u0442\u0435\u0442\u044b \u0440\u044f\u0434\u043e\u043c"}),(0,p.jsx)("li",{children:"\u041a\u0440\u0443\u0433\u043b\u043e\u0441\u0443\u0442\u043e\u0447\u043d\u0430\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0438 \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u043d\u043e\u0439 \u0440\u0435\u0436\u0438\u043c"}),(0,p.jsx)("li",{children:"\u0423\u0445\u043e\u0436\u0435\u043d\u043d\u044b\u0435 \u0438 \u0447\u0438\u0441\u0442\u044b\u0435 \u043e\u0431\u0449\u0438\u0435 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0430"}),(0,p.jsx)("li",{children:"\u0420\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u0430\u044f \u0443\u0431\u043e\u0440\u043a\u0430 \u0438 \u0441\u043c\u0435\u043d\u0430 \u0431\u0435\u043b\u044c\u044f"}),(0,p.jsx)("li",{children:"\u0420\u0430\u0431\u043e\u0447\u0438\u0435 \u043c\u0435\u0441\u0442\u0430 \u0434\u043b\u044f \u0443\u0447\u0435\u0431\u044b \u043f\u0440\u044f\u043c\u043e \u0432 \u043a\u043e\u043c\u043d\u0430\u0442\u0430\u0445"}),(0,p.jsx)("li",{children:"\u0412\u044b\u0441\u043e\u043a\u043e\u0441\u043a\u043e\u0440\u043e\u0441\u0442\u043d\u043e\u0439 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442 \u043d\u0430 \u0432\u0441\u0435\u0439 \u0442\u0435\u0440\u0440\u0438\u0442\u043e\u0440\u0438\u0438 \u043a\u0430\u043c\u043f\u0443\u0441\u0430"}),(0,p.jsx)("li",{children:"\u0418\u043d\u0442\u0435\u0440\u043d\u0435\u0442 \u0438 \u043a\u043e\u043c\u043c\u0443\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0443\u0436\u0435 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u044b \u0432 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c"})]})}),(0,p.jsx)(b,{title:"\u0425\u043e\u0447\u0443 \u0432\u0437\u0433\u043b\u044f\u043d\u0443\u0442\u044c \u043d\u0430 \u043d\u043e\u043c\u0435\u0440\u0430",onClick:()=>s("/room")})]}),(0,p.jsxs)("div",{className:cR.content_image_right,children:[(0,p.jsx)("div",{className:"".concat(cR.image_small," ").concat(cR.animate_before_first),style:{backgroundImage:"url(".concat(hR,")")}}),(0,p.jsx)("div",{className:"".concat(cR.image_medium," ").concat(cR.animate_before_second),style:{backgroundImage:"url(".concat(fR,")")}})]})]})]})})},mR="AccommodationComponent_main__+R7qc",gR="AccommodationComponent_hint_span__KKz55",vR="AccommodationComponent_description_section__JhGnD",yR="AccommodationComponent_content__DffD4",_R="AccommodationComponent_overlay_items__QutjB",bR="AccommodationComponent_title_text__OGroR",xR="AccommodationComponent_items_content__Ncpfh",SR="AccommodationComponent_items_button__Q9MDt",ER="AccommodationComponent_item_center__n0XYV",wR=n.p+"static/media/conditions.bf943da25d23fabcdc7f.webp",TR=n.p+"static/media/rules.445aab76dc585b769d54.webp",MR=n.p+"static/media/docs.e9100e5bdd53f2e89639.jpeg",AR=e=>{let{scrollerRef:n}=e;const i=(0,t.useRef)(null),r=(0,t.useRef)(null),s=(0,t.useRef)(null),[a,o]=(0,t.useState)(wR);(0,t.useEffect)(()=>{n.current&&Er.timeline({scrollTrigger:{trigger:i.current,scroller:n.current,start:"top 10%",scrub:!1,once:!0}}).from(".".concat(yR),{y:"100vw",opacity:0,duration:.1}).to(".".concat(yR),{y:0,opacity:1,duration:.5,ease:"sine.out"})},[n]);const l=(0,t.useRef)(null),c=e=>{var t;switch(l.current&&(l.current.kill(),l.current=null),null===(t=s.current)||void 0===t||t.style.setProperty("background-position","0 100%"),e){case"conditions":o(wR);break;case"rules":o(TR);break;case"docs":o(MR)}requestAnimationFrame(()=>{l.current=Er.to(s.current,{backgroundPositionY:"50%",duration:.7,ease:"power2.out",onComplete:()=>{l.current=null}})})};return(0,p.jsx)("section",{ref:i,className:mR,children:(0,p.jsxs)("div",{ref:r,className:vR,children:[(0,p.jsx)("span",{className:gR,children:"\u041f\u0420\u041e\u0416\u0418\u0412\u0410\u041d\u0418\u0415"}),(0,p.jsxs)("div",{ref:s,className:yR,style:{backgroundImage:"url(".concat(a,")")},children:[(0,p.jsxs)("div",{className:xR,onMouseOver:()=>a!==wR&&c("conditions"),children:[(0,p.jsx)("div",{className:_R}),(0,p.jsx)("span",{className:bR,children:"\u0423\u0441\u043b\u043e\u0432\u0438\u044f \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u044f"}),(0,p.jsx)("div",{className:SR,children:"\u0413\u043e\u0441\u0442\u0438\u043d\u0438\u0446\u044b \u041d\u0435\u0439\u043c\u0430\u0440\u043a \u043f\u0440\u0435\u0434\u043b\u0430\u0433\u0430\u044e\u0442 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 \u0442\u0438\u043f\u044b \u043a\u043e\u043c\u043d\u0430\u0442, \u0447\u0442\u043e\u0431\u044b \u0443\u0434\u043e\u0432\u043b\u0435\u0442\u0432\u043e\u0440\u0438\u0442\u044c \u043f\u043e\u0442\u0440\u0435\u0431\u043d\u043e\u0441\u0442\u0438 \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u043e\u0432 \u0438 \u0438\u0445 \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u0435\u0439. \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u043c\u0435\u0436\u0434\u0443 \u043e\u0434\u043d\u043e\u043c\u0435\u0441\u0442\u043d\u044b\u043c\u0438, \u0434\u0432\u0443\u0445\u043c\u0435\u0441\u0442\u043d\u044b\u043c\u0438 \u0438 \u043c\u043d\u043e\u0433\u043e\u043c\u0435\u0441\u0442\u043d\u044b\u043c\u0438 \u043d\u043e\u043c\u0435\u0440\u0430\u043c\u0438. \u041a\u0430\u0436\u0434\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u043e\u0441\u043d\u0430\u0449\u0451\u043d \u0432\u0441\u0435\u043c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u043c \u0434\u043b\u044f \u043a\u043e\u043c\u0444\u043e\u0440\u0442\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u044f: \u043c\u0435\u0431\u0435\u043b\u044c, \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442 \u0438 \u0443\u0431\u043e\u0440\u043a\u0430. \u042d\u0442\u043e \u0438\u0434\u0435\u0430\u043b\u044c\u043d\u044b\u0439 \u0432\u044b\u0431\u043e\u0440 \u0434\u043b\u044f \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u043e\u0432, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0438\u0449\u0443\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0435 \u0438 \u0443\u0434\u043e\u0431\u043d\u043e\u0435 \u043c\u0435\u0441\u0442\u043e \u0434\u043b\u044f \u0436\u0438\u0437\u043d\u0438 \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u0443\u0447\u0451\u0431\u044b. \u041c\u044b \u0437\u0430\u0431\u043e\u0442\u0438\u043c\u0441\u044f \u043e \u0442\u043e\u043c, \u0447\u0442\u043e\u0431\u044b \u043a\u0430\u0436\u0434\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u043e\u0432\u0430\u043b \u0432\u044b\u0441\u043e\u043a\u0438\u043c \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u0430\u043c, \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0438 \u0443\u044e\u0442 \u0434\u043b\u044f \u043d\u0430\u0448\u0438\u0445 \u043f\u043e\u0441\u0442\u043e\u044f\u043b\u044c\u0446\u0435\u0432."})]}),(0,p.jsxs)("div",{className:"".concat(xR," ").concat(ER),onMouseOver:()=>a!==TR&&c("rules"),children:[(0,p.jsx)("div",{className:_R}),(0,p.jsx)("span",{className:bR,children:"\u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u044f"}),(0,p.jsx)("div",{className:SR,children:"\u0412 \u0433\u043e\u0441\u0442\u0438\u043d\u0438\u0446\u0430\u0445 \u041d\u0435\u0439\u043c\u0430\u0440\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u043e\u043c\u043e\u0433\u0443\u0442 \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043e\u043c\u0444\u043e\u0440\u0442\u043d\u0443\u044e \u0438 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u0443\u044e \u0430\u0442\u043c\u043e\u0441\u0444\u0435\u0440\u0443 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0433\u043e\u0441\u0442\u0435\u0439. \u041c\u044b \u0441\u0442\u0440\u0435\u043c\u0438\u043c\u0441\u044f \u043a \u0442\u043e\u043c\u0443, \u0447\u0442\u043e\u0431\u044b \u043a\u0430\u0436\u0434\u044b\u0439 \u043f\u043e\u0441\u0442\u043e\u044f\u043b\u0435\u0446 \u0447\u0443\u0432\u0441\u0442\u0432\u043e\u0432\u0430\u043b \u0441\u0435\u0431\u044f \u0443\u044e\u0442\u043d\u043e \u0438 \u043c\u043e\u0433 \u0441\u043e\u0441\u0440\u0435\u0434\u043e\u0442\u043e\u0447\u0438\u0442\u044c\u0441\u044f \u043d\u0430 \u0443\u0447\u0451\u0431\u0435. \u0412 \u043f\u0440\u0430\u0432\u0438\u043b\u0430\u0445 \u043e\u043f\u0438\u0441\u0430\u043d\u044b \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043c\u043e\u043c\u0435\u043d\u0442\u044b, \u0442\u0430\u043a\u0438\u0435 \u043a\u0430\u043a \u0432\u0440\u0435\u043c\u044f \u0442\u0438\u0448\u0438\u043d\u044b, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u0449\u0438\u0445 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432 \u0438 \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u0432\u044b\u0445\u043e\u0434\u0430 \u0438\u0437 \u043d\u043e\u043c\u0435\u0440\u043e\u0432. \u041e\u0437\u043d\u0430\u043a\u043e\u043c\u043b\u0435\u043d\u0438\u0435 \u0441 \u043f\u0440\u0430\u0432\u0438\u043b\u0430\u043c\u0438 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043f\u043e\u0441\u0442\u043e\u044f\u043b\u044c\u0446\u0435\u0432, \u0447\u0442\u043e\u0431\u044b \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0442\u044c \u0433\u0430\u0440\u043c\u043e\u043d\u0438\u0447\u043d\u043e\u0435 \u0441\u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u0443\u0432\u0430\u0436\u0435\u043d\u0438\u0435 \u043a \u043b\u0438\u0447\u043d\u043e\u043c\u0443 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u0443 \u043a\u0430\u0436\u0434\u043e\u0433\u043e."})]}),(0,p.jsxs)("div",{className:xR,onMouseOver:()=>a!==MR&&c("docs"),children:[(0,p.jsx)("div",{className:_R}),(0,p.jsx)("span",{className:bR,children:"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b \u043f\u0440\u0438 \u0437\u0430\u0441\u0435\u043b\u0435\u043d\u0438\u0438"}),(0,p.jsx)("div",{className:SR,children:"\u041f\u0440\u0438 \u0437\u0430\u0441\u0435\u043b\u0435\u043d\u0438\u0438 \u0432 \u0433\u043e\u0441\u0442\u0438\u043d\u0438\u0446\u044b \u041d\u0435\u0439\u043c\u0430\u0440\u043a \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u044b\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b. \u042d\u0442\u043e \u043c\u043e\u0436\u0435\u0442 \u0432\u043a\u043b\u044e\u0447\u0430\u0442\u044c \u043f\u0430\u0441\u043f\u043e\u0440\u0442, \u0441\u0442\u0443\u0434\u0435\u043d\u0447\u0435\u0441\u043a\u0438\u0439 \u0431\u0438\u043b\u0435\u0442 \u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u044f\u044e\u0449\u0438\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b. \u041c\u044b \u043f\u043e\u043d\u0438\u043c\u0430\u0435\u043c, \u0447\u0442\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0441\u043b\u043e\u0436\u043d\u044b\u043c, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043d\u0430\u0448\u0438 \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0438 \u0433\u043e\u0442\u043e\u0432\u044b \u043f\u043e\u043c\u043e\u0447\u044c \u0432\u0430\u043c \u043d\u0430 \u043a\u0430\u0436\u0434\u043e\u043c \u044d\u0442\u0430\u043f\u0435. \u041f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u0430\u044f \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0443\u0441\u043a\u043e\u0440\u0438\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0437\u0430\u0441\u0435\u043b\u0435\u043d\u0438\u044f \u0438 \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442 \u0432\u0430\u043c \u0431\u044b\u0441\u0442\u0440\u0435\u0435 \u043d\u0430\u0447\u0430\u0442\u044c \u043d\u0430\u0441\u043b\u0430\u0436\u0434\u0430\u0442\u044c\u0441\u044f \u043a\u043e\u043c\u0444\u043e\u0440\u0442\u043e\u043c \u043d\u0430\u0448\u0435\u0433\u043e \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u044f. \u0423\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0443 \u0432\u0430\u0441 \u0435\u0441\u0442\u044c \u0432\u0441\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b \u043f\u0435\u0440\u0435\u0434 \u043f\u0440\u0438\u0435\u0437\u0434\u043e\u043c."})]})]})]})})},CR={main:"PriceComponent_main__e15LC",animate_before_first:"PriceComponent_animate_before_first__oInP4",animate_before_second:"PriceComponent_animate_before_second__UHW5Z",animate:"PriceComponent_animate__WzEXZ",animated_block:"PriceComponent_animated_block__tB9dF",title_slide:"PriceComponent_title_slide__7OOLL",embla:"PriceComponent_embla__b47E4",embla__container:"PriceComponent_embla__container__UF-8O",buttons:"PriceComponent_buttons__7pSXN",button:"PriceComponent_button__16c0g",embla__slide:"PriceComponent_embla__slide__9pu3n",hint_span:"PriceComponent_hint_span__U7Pl2",description_section:"PriceComponent_description_section__BX15j",word:"PriceComponent_word__YAzfv",content:"PriceComponent_content__wwjwk",image_small:"PriceComponent_image_small__LZW3i",image_medium:"PriceComponent_image_medium__YCTC+",content_text:"PriceComponent_content_text__rPf97",content_image_left:"PriceComponent_content_image_left__68cwg",content_image_right:"PriceComponent_content_image_right__QsFw7",text_title:"PriceComponent_text_title__93DKJ",text_paragraph:"PriceComponent_text_paragraph__5Dq3E",header_about:"PriceComponent_header_about__3iNNa",text_header_animated:"PriceComponent_text_header_animated__5Vn8C",animated_text_words:"PriceComponent_animated_text_words__I32pC"},RR=n.p+"static/media/alpha.24bfaa29552d3ea2d203.webp",LR=n.p+"static/media/gamma.bf943da25d23fabcdc7f.webp",PR=n.p+"static/media/omega.acd4815b0c38366756b2.webp";function IR(e){return function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e)||Array.isArray(e)}function DR(e,t){const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;return JSON.stringify(Object.keys(e.breakpoints||{}))===JSON.stringify(Object.keys(t.breakpoints||{}))&&n.every(n=>{const i=e[n],r=t[n];return"function"===typeof i?"".concat(i)==="".concat(r):IR(i)&&IR(r)?DR(i,r):i===r})}function kR(e){return e.concat().sort((e,t)=>e.name>t.name?1:-1).map(e=>e.options)}function OR(e){return"number"===typeof e}function NR(e){return"string"===typeof e}function FR(e){return"boolean"===typeof e}function BR(e){return"[object Object]"===Object.prototype.toString.call(e)}function UR(e){return Math.abs(e)}function HR(e){return Math.sign(e)}function zR(e,t){return UR(e-t)}function GR(e){return XR(e).map(Number)}function VR(e){return e[WR(e)]}function WR(e){return Math.max(0,e.length-1)}function jR(e,t){return t===WR(e)}function YR(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Array.from(Array(e),(e,n)=>t+n)}function XR(e){return Object.keys(e)}function KR(e,t){return[e,t].reduce((e,t)=>(XR(t).forEach(n=>{const i=e[n],r=t[n],s=BR(i)&&BR(r);e[n]=s?KR(i,r):r}),e),{})}function qR(e,t){return"undefined"!==typeof t.MouseEvent&&e instanceof t.MouseEvent}function JR(){let e=[];const t={add:function(n,i,r){let s,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{passive:!0};if("addEventListener"in n)n.addEventListener(i,r,a),s=()=>n.removeEventListener(i,r,a);else{const e=n;e.addListener(r),s=()=>e.removeListener(r)}return e.push(s),t},clear:function(){e=e.filter(e=>e())}};return t}function QR(e,t,n,i){const r=JR(),s=1e3/60;let a=null,o=0,l=0;function c(e){if(!l)return;a||(a=e,n(),n());const r=e-a;for(a=e,o+=r;o>=s;)n(),o-=s;i(o/s),l&&(l=t.requestAnimationFrame(c))}function u(){t.cancelAnimationFrame(l),a=null,o=0,l=0}return{init:function(){r.add(e,"visibilitychange",()=>{e.hidden&&(a=null,o=0)})},destroy:function(){u(),r.clear()},start:function(){l||(l=t.requestAnimationFrame(c))},stop:u,update:n,render:i}}function ZR(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=UR(e-t);function i(t){return t<e}function r(e){return e>t}function s(e){return i(e)||r(e)}return{length:n,max:t,min:e,constrain:function(n){return s(n)?i(n)?e:t:n},reachedAny:s,reachedMax:r,reachedMin:i,removeOffset:function(e){return n?e-n*Math.ceil((e-t)/n):e}}}function $R(e,t,n){const{constrain:i}=ZR(0,e),r=e+1;let s=a(t);function a(e){return n?UR((r+e)%r):i(e)}function o(){return s}function l(){return $R(e,o(),n)}const c={get:o,set:function(e){return s=a(e),c},add:function(e){return l().set(o()+e)},clone:l};return c}function eL(e,t,n,i,r,s,a,o,l,c,u,d,h,f,p,m,g,v,y){const{cross:_,direction:b}=e,x=["INPUT","SELECT","TEXTAREA"],S={passive:!1},E=JR(),w=JR(),T=ZR(50,225).constrain(f.measure(20)),M={mouse:300,touch:400},A={mouse:500,touch:600},C=p?43:25;let R=!1,L=0,P=0,I=!1,D=!1,k=!1,O=!1;function N(e){if(!qR(e,i)&&e.touches.length>=2)return F(e);const t=s.readPoint(e),n=s.readPoint(e,_),a=zR(t,L),l=zR(n,P);if(!D&&!O){if(!e.cancelable)return F(e);if(D=a>l,!D)return F(e)}const u=s.pointerMove(e);a>m&&(k=!0),c.useFriction(.3).useDuration(.75),o.start(),r.add(b(u)),e.preventDefault()}function F(e){const t=u.byDistance(0,!1).index!==d.get(),n=s.pointerUp(e)*(p?A:M)[O?"mouse":"touch"],i=function(e,t){const n=d.add(-1*HR(e)),i=u.byDistance(e,!p).distance;return p||UR(e)<T?i:g&&t?.5*i:u.byIndex(n.get(),0).distance}(b(n),t),r=function(e,t){if(0===e||0===t)return 0;if(UR(e)<=UR(t))return 0;const n=zR(UR(e),UR(t));return UR(n/e)}(n,i),a=C-10*r,o=v+r/50;D=!1,I=!1,w.clear(),c.useDuration(a).useFriction(o),l.distance(i,!p),O=!1,h.emit("pointerUp")}function B(e){k&&(e.stopPropagation(),e.preventDefault(),k=!1)}return{init:function(e){if(!y)return;function o(o){(FR(y)||y(e,o))&&function(e){const o=qR(e,i);if(O=o,k=p&&o&&!e.buttons&&R,R=zR(r.get(),a.get())>=2,o&&0!==e.button)return;if(function(e){const t=e.nodeName||"";return x.includes(t)}(e.target))return;I=!0,s.pointerDown(e),c.useFriction(0).useDuration(0),r.set(a),function(){const e=O?n:t;w.add(e,"touchmove",N,S).add(e,"touchend",F).add(e,"mousemove",N,S).add(e,"mouseup",F)}(),L=s.readPoint(e),P=s.readPoint(e,_),h.emit("pointerDown")}(o)}const l=t;E.add(l,"dragstart",e=>e.preventDefault(),S).add(l,"touchmove",()=>{},S).add(l,"touchend",()=>{}).add(l,"touchstart",o).add(l,"mousedown",o).add(l,"touchcancel",F).add(l,"contextmenu",F).add(l,"click",B,!0)},destroy:function(){E.clear(),w.clear()},pointerDown:function(){return I}}}function tL(e,t){let n,i;function r(e){return e.timeStamp}function s(n,i){const r=i||e.scroll,s="client".concat("x"===r?"X":"Y");return(qR(n,t)?n:n.touches[0])[s]}return{pointerDown:function(e){return n=e,i=e,s(e)},pointerMove:function(e){const t=s(e)-s(i),a=r(e)-r(n)>170;return i=e,a&&(n=e),t},pointerUp:function(e){if(!n||!i)return 0;const t=s(i)-s(n),a=r(e)-r(n),o=r(e)-r(i)>170,l=t/a;return a&&!o&&UR(l)>.1?l:0},readPoint:s}}function nL(e,t,n,i,r,s,a){const o=[e].concat(i);let l,c,u=[],d=!1;function h(e){return r.measureSize(a.measure(e))}return{init:function(r){s&&(c=h(e),u=i.map(h),l=new ResizeObserver(n=>{(FR(s)||s(r,n))&&function(n){for(const s of n){if(d)return;const n=s.target===e,a=i.indexOf(s.target),o=n?c:u[a];if(UR(h(n?e:i[a])-o)>=.5){r.reInit(),t.emit("resize");break}}}(n)}),n.requestAnimationFrame(()=>{o.forEach(e=>l.observe(e))}))},destroy:function(){d=!0,l&&l.disconnect()}}}function iL(e,t,n,i,r){const s=r.measure(10),a=r.measure(50),o=ZR(.1,.99);let l=!1;function c(){return!l&&(!!e.reachedAny(n.get())&&!!e.reachedAny(t.get()))}return{shouldConstrain:c,constrain:function(r){if(!c())return;const l=e.reachedMin(t.get())?"min":"max",u=UR(e[l]-t.get()),d=n.get()-t.get(),h=o.constrain(u/a);n.subtract(d*h),!r&&UR(d)<s&&(n.set(e.constrain(n.get())),i.useDuration(25).useBaseFriction())},toggleActive:function(e){l=!e}}}function rL(e,t,n,i){const r=t.min+.1,s=t.max+.1,{reachedMin:a,reachedMax:o}=ZR(r,s);return{loop:function(t){if(!function(e){return 1===e?o(n.get()):-1===e&&a(n.get())}(t))return;const r=e*(-1*t);i.forEach(e=>e.add(r))}}}function sL(e,t,n,i,r){const{reachedAny:s,removeOffset:a,constrain:o}=i;function l(e){return e.concat().sort((e,t)=>UR(e)-UR(t))[0]}function c(t,i){const r=[t,t+n,t-n];if(!e)return t;if(!i)return l(r);const s=r.filter(e=>HR(e)===i);return s.length?l(s):VR(r)-n}const u={byDistance:function(n,i){const l=r.get()+n,{index:u,distance:d}=function(n){const i=e?a(n):o(n),r=t.map((e,t)=>({diff:c(e-i,0),index:t})).sort((e,t)=>UR(e.diff)-UR(t.diff)),{index:s}=r[0];return{index:s,distance:i}}(l),h=!e&&s(l);return!i||h?{index:u,distance:n}:{index:u,distance:n+c(t[u]-d,0)}},byIndex:function(e,n){return{index:e,distance:c(t[e]-r.get(),n)}},shortcut:c};return u}function aL(e,t,n,i,r,s,a,o){const l={passive:!0,capture:!0};let c=0;function u(e){"Tab"===e.code&&(c=(new Date).getTime())}const d={init:function(d){o&&(s.add(document,"keydown",u,!1),t.forEach((t,u)=>{s.add(t,"focus",t=>{(FR(o)||o(d,t))&&function(t){if((new Date).getTime()-c>10)return;a.emit("slideFocusStart"),e.scrollLeft=0;const s=n.findIndex(e=>e.includes(t));OR(s)&&(r.useDuration(0),i.index(s,0),a.emit("slideFocus"))}(u)},l)}))}};return d}function oL(e){let t=e;function n(e){return OR(e)?e:e.get()}return{get:function(){return t},set:function(e){t=n(e)},add:function(e){t+=n(e)},subtract:function(e){t-=n(e)}}}function lL(e,t){const n="x"===e.scroll?function(e){return"translate3d(".concat(e,"px,0px,0px)")}:function(e){return"translate3d(0px,".concat(e,"px,0px)")},i=t.style;let r=null,s=!1;return{clear:function(){s||(i.transform="",t.getAttribute("style")||t.removeAttribute("style"))},to:function(t){if(s)return;const a=(o=e.direction(t),Math.round(100*o)/100);var o;a!==r&&(i.transform=n(a),r=a)},toggleActive:function(e){s=!e}}}function cL(e,t,n,i,r,s,a,o,l){const c=GR(r),u=GR(r).reverse(),d=function(){const e=a[0];return p(f(u,e),n,!1)}().concat(function(){const e=t-a[0]-1;return p(f(c,e),-n,!0)}());function h(e,t){return e.reduce((e,t)=>e-r[t],t)}function f(e,t){return e.reduce((e,n)=>h(e,t)>0?e.concat([n]):e,[])}function p(r,a,c){const u=function(e){return s.map((n,r)=>({start:n-i[r]+.5+e,end:n+t-.5+e}))}(a);return r.map(t=>{const i=c?0:-n,r=c?n:0,s=c?"end":"start",a=u[t][s];return{index:t,loopPoint:a,slideLocation:oL(-1),translate:lL(e,l[t]),target:()=>o.get()>a?i:r}})}const m={canLoop:function(){return d.every(e=>{let{index:n}=e;const i=c.filter(e=>e!==n);return h(i,t)<=.1})},clear:function(){d.forEach(e=>e.translate.clear())},loop:function(){d.forEach(e=>{const{target:t,translate:n,slideLocation:i}=e,r=t();r!==i.get()&&(n.to(r),i.set(r))})},loopPoints:d};return m}function uL(e,t,n){let i,r=!1;return{init:function(s){n&&(i=new MutationObserver(e=>{r||(FR(n)||n(s,e))&&function(e){for(const n of e)if("childList"===n.type){s.reInit(),t.emit("slidesChanged");break}}(e)}),i.observe(e,{childList:!0}))},destroy:function(){i&&i.disconnect(),r=!0}}}function dL(e,t,n,i){const r={};let s,a=null,o=null,l=!1;const c={init:function(){s=new IntersectionObserver(e=>{l||(e.forEach(e=>{const n=t.indexOf(e.target);r[n]=e}),a=null,o=null,n.emit("slidesInView"))},{root:e.parentElement,threshold:i}),t.forEach(e=>s.observe(e))},destroy:function(){s&&s.disconnect(),l=!0},get:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e&&a)return a;if(!e&&o)return o;const t=function(e){return XR(r).reduce((t,n)=>{const i=parseInt(n),{isIntersecting:s}=r[i];return(e&&s||!e&&!s)&&t.push(i),t},[])}(e);return e&&(a=t),e||(o=t),t}};return c}function hL(e,t,n,i,r,s,a,o,l){const{startEdge:c,endEdge:u,direction:d}=e,h=OR(n);const f={groupSlides:function(e){return h?function(e,t){return GR(e).filter(e=>e%t===0).map(n=>e.slice(n,n+t))}(e,n):function(e){return e.length?GR(e).reduce((n,h,f)=>{const p=VR(n)||0,m=0===p,g=h===WR(e),v=r[c]-s[p][c],y=r[c]-s[h][u],_=!i&&m?d(a):0,b=UR(y-(!i&&g?d(o):0)-(v+_));return f&&b>t+l&&n.push(h),g&&n.push(e.length),n},[]).map((t,n,i)=>{const r=Math.max(i[n-1]||0);return e.slice(r,t)}):[]}(e)}};return f}function fL(e,t,n,i,r,s,a){const{align:o,axis:l,direction:c,startIndex:u,loop:d,duration:h,dragFree:f,dragThreshold:p,inViewThreshold:m,slidesToScroll:g,skipSnaps:v,containScroll:y,watchResize:_,watchSlides:b,watchDrag:x,watchFocus:S}=s,E={measure:function(e){const{offsetTop:t,offsetLeft:n,offsetWidth:i,offsetHeight:r}=e;return{top:t,right:n+i,bottom:t+r,left:n,width:i,height:r}}},w=E.measure(t),T=n.map(E.measure),M=function(e,t){const n="rtl"===t,i="y"===e,r=!i&&n?-1:1;return{scroll:i?"y":"x",cross:i?"x":"y",startEdge:i?"top":n?"right":"left",endEdge:i?"bottom":n?"left":"right",measureSize:function(e){const{height:t,width:n}=e;return i?t:n},direction:function(e){return e*r}}}(l,c),A=M.measureSize(w),C=function(e){return{measure:function(t){return e*(t/100)}}}(A),R=function(e,t){const n={start:function(){return 0},center:function(e){return i(e)/2},end:i};function i(e){return t-e}const r={measure:function(i,r){return NR(e)?n[e](i):e(t,i,r)}};return r}(o,A),L=!d&&!!y,P=d||!!y,{slideSizes:I,slideSizesWithGaps:D,startGap:k,endGap:O}=function(e,t,n,i,r,s){const{measureSize:a,startEdge:o,endEdge:l}=e,c=n[0]&&r,u=function(){if(!c)return 0;const e=n[0];return UR(t[o]-e[o])}(),d=function(){if(!c)return 0;const e=s.getComputedStyle(VR(i));return parseFloat(e.getPropertyValue("margin-".concat(l)))}(),h=n.map(a),f=n.map((e,t,n)=>{const i=!t,r=jR(n,t);return i?h[t]+u:r?h[t]+d:n[t+1][o]-e[o]}).map(UR);return{slideSizes:h,slideSizesWithGaps:f,startGap:u,endGap:d}}(M,w,T,n,P,r),N=hL(M,A,g,d,w,T,k,O,2),{snaps:F,snapsAligned:B}=function(e,t,n,i,r){const{startEdge:s,endEdge:a}=e,{groupSlides:o}=r,l=o(i).map(e=>VR(e)[a]-e[0][s]).map(UR).map(t.measure),c=i.map(e=>n[s]-e[s]).map(e=>-UR(e)),u=o(c).map(e=>e[0]).map((e,t)=>e+l[t]);return{snaps:c,snapsAligned:u}}(M,R,w,T,N),U=-VR(F)+VR(D),{snapsContained:H,scrollContainLimit:z}=function(e,t,n,i,r){const s=ZR(-t+e,0),a=n.map((e,t)=>{const{min:i,max:r}=s,a=s.constrain(e),o=!t,c=jR(n,t);return o?r:c||l(i,a)?i:l(r,a)?r:a}).map(e=>parseFloat(e.toFixed(3))),o=function(){const e=a[0],t=VR(a);return ZR(a.lastIndexOf(e),a.indexOf(t)+1)}();function l(e,t){return zR(e,t)<=1}return{snapsContained:function(){if(t<=e+r)return[s.max];if("keepSnaps"===i)return a;const{min:n,max:l}=o;return a.slice(n,l)}(),scrollContainLimit:o}}(A,U,B,y,2),G=L?H:B,{limit:V}=function(e,t,n){const i=t[0];return{limit:ZR(n?i-e:VR(t),i)}}(U,G,d),W=$R(WR(G),u,d),j=W.clone(),Y=GR(n),X=QR(i,r,()=>(e=>{let{dragHandler:t,scrollBody:n,scrollBounds:i,options:{loop:r}}=e;r||i.constrain(t.pointerDown()),n.seek()})(oe),e=>((e,t)=>{let{scrollBody:n,translate:i,location:r,offsetLocation:s,previousLocation:a,scrollLooper:o,slideLooper:l,dragHandler:c,animation:u,eventHandler:d,scrollBounds:h,options:{loop:f}}=e;const p=n.settled(),m=!h.shouldConstrain(),g=f?p:p&&m,v=g&&!c.pointerDown();v&&u.stop();const y=r.get()*t+a.get()*(1-t);s.set(y),f&&(o.loop(n.direction()),l.loop()),i.to(s.get()),v&&d.emit("settle"),g||d.emit("scroll")})(oe,e)),K=G[W.get()],q=oL(K),J=oL(K),Q=oL(K),Z=oL(K),$=function(e,t,n,i,r,s){let a=0,o=0,l=r,c=s,u=e.get(),d=0;function h(e){return l=e,p}function f(e){return c=e,p}const p={direction:function(){return o},duration:function(){return l},velocity:function(){return a},seek:function(){const t=i.get()-e.get();let r=0;return l?(n.set(e),a+=t/l,a*=c,u+=a,e.add(a),r=u-d):(a=0,n.set(i),e.set(i),r=t),o=HR(r),d=u,p},settled:function(){return UR(i.get()-t.get())<.001},useBaseFriction:function(){return f(s)},useBaseDuration:function(){return h(r)},useFriction:f,useDuration:h};return p}(q,Q,J,Z,h,.68),ee=sL(d,G,U,V,Z),te=function(e,t,n,i,r,s,a){function o(r){const o=r.distance,l=r.index!==t.get();s.add(o),o&&(i.duration()?e.start():(e.update(),e.render(1),e.update())),l&&(n.set(t.get()),t.set(r.index),a.emit("select"))}const l={distance:function(e,t){o(r.byDistance(e,t))},index:function(e,n){const i=t.clone().set(e);o(r.byIndex(i.get(),n))}};return l}(X,W,j,$,ee,Z,a),ne=function(e){const{max:t,length:n}=e;return{get:function(e){return n?(e-t)/-n:0}}}(V),ie=JR(),re=dL(t,n,a,m),{slideRegistry:se}=function(e,t,n,i,r,s){const{groupSlides:a}=r,{min:o,max:l}=i,c=function(){const i=a(s),r=!e||"keepSnaps"===t;return 1===n.length?[s]:r?i:i.slice(o,l).map((e,t,n)=>{const i=!t,r=jR(n,t);return i?YR(VR(n[0])+1):r?YR(WR(s)-VR(n)[0]+1,VR(n)[0]):e})}();return{slideRegistry:c}}(L,y,G,z,N,Y),ae=aL(e,n,se,te,$,ie,a,S),oe={ownerDocument:i,ownerWindow:r,eventHandler:a,containerRect:w,slideRects:T,animation:X,axis:M,dragHandler:eL(M,e,i,r,Z,tL(M,r),q,X,te,$,ee,W,a,C,f,p,v,.68,x),eventStore:ie,percentOfView:C,index:W,indexPrevious:j,limit:V,location:q,offsetLocation:Q,previousLocation:J,options:s,resizeHandler:nL(t,a,r,n,M,_,E),scrollBody:$,scrollBounds:iL(V,Q,Z,$,C),scrollLooper:rL(U,V,Q,[q,Q,J,Z]),scrollProgress:ne,scrollSnapList:G.map(ne.get),scrollSnaps:G,scrollTarget:ee,scrollTo:te,slideLooper:cL(M,A,U,I,D,F,G,Q,n),slideFocus:ae,slidesHandler:uL(t,a,b),slidesInView:re,slideIndexes:Y,slideRegistry:se,slidesToScroll:N,target:Z,translate:lL(M,t)};return oe}const pL={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function mL(e){function t(e,t){return KR(e,t||{})}const n={mergeOptions:t,optionsAtMedia:function(n){const i=n.breakpoints||{},r=XR(i).filter(t=>e.matchMedia(t).matches).map(e=>i[e]).reduce((e,n)=>t(e,n),{});return t(n,r)},optionsMediaQueries:function(t){return t.map(e=>XR(e.breakpoints||{})).reduce((e,t)=>e.concat(t),[]).map(e.matchMedia)}};return n}function gL(e,t,n){const i=e.ownerDocument,r=i.defaultView,s=mL(r),a=function(e){let t=[];const n={init:function(n,i){return t=i.filter(t=>{let{options:n}=t;return!1!==e.optionsAtMedia(n).active}),t.forEach(t=>t.init(n,e)),i.reduce((e,t)=>Object.assign(e,{[t.name]:t}),{})},destroy:function(){t=t.filter(e=>e.destroy())}};return n}(s),o=JR(),l=function(){let e,t={};function n(e){return t[e]||[]}const i={init:function(t){e=t},emit:function(t){return n(t).forEach(n=>n(e,t)),i},off:function(e,r){return t[e]=n(e).filter(e=>e!==r),i},on:function(e,r){return t[e]=n(e).concat([r]),i},clear:function(){t={}}};return i}(),{mergeOptions:c,optionsAtMedia:u,optionsMediaQueries:d}=s,{on:h,off:f,emit:p}=l,m=M;let g,v,y,_,b=!1,x=c(pL,gL.globalOptions),S=c(x),E=[];function w(t){const n=fL(e,y,_,i,r,t,l);if(t.loop&&!n.slideLooper.canLoop()){return w(Object.assign({},t,{loop:!1}))}return n}function T(t,n){b||(x=c(x,t),S=u(x),E=n||E,function(){const{container:t,slides:n}=S,i=NR(t)?e.querySelector(t):t;y=i||e.children[0];const r=NR(n)?y.querySelectorAll(n):n;_=[].slice.call(r||y.children)}(),g=w(S),d([x,...E.map(e=>{let{options:t}=e;return t})]).forEach(e=>o.add(e,"change",M)),S.active&&(g.translate.to(g.location.get()),g.animation.init(),g.slidesInView.init(),g.slideFocus.init(L),g.eventHandler.init(L),g.resizeHandler.init(L),g.slidesHandler.init(L),g.options.loop&&g.slideLooper.loop(),y.offsetParent&&_.length&&g.dragHandler.init(L),v=a.init(L,E)))}function M(e,t){const n=R();A(),T(c({startIndex:n},e),t),l.emit("reInit")}function A(){g.dragHandler.destroy(),g.eventStore.clear(),g.translate.clear(),g.slideLooper.clear(),g.resizeHandler.destroy(),g.slidesHandler.destroy(),g.slidesInView.destroy(),g.animation.destroy(),a.destroy(),o.clear()}function C(e,t,n){S.active&&!b&&(g.scrollBody.useBaseFriction().useDuration(!0===t?0:S.duration),g.scrollTo.index(e,n||0))}function R(){return g.index.get()}const L={canScrollNext:function(){return g.index.add(1).get()!==R()},canScrollPrev:function(){return g.index.add(-1).get()!==R()},containerNode:function(){return y},internalEngine:function(){return g},destroy:function(){b||(b=!0,o.clear(),A(),l.emit("destroy"),l.clear())},off:f,on:h,emit:p,plugins:function(){return v},previousScrollSnap:function(){return g.indexPrevious.get()},reInit:m,rootNode:function(){return e},scrollNext:function(e){C(g.index.add(1).get(),e,-1)},scrollPrev:function(e){C(g.index.add(-1).get(),e,1)},scrollProgress:function(){return g.scrollProgress.get(g.offsetLocation.get())},scrollSnapList:function(){return g.scrollSnapList},scrollTo:C,selectedScrollSnap:R,slideNodes:function(){return _},slidesInView:function(){return g.slidesInView.get()},slidesNotInView:function(){return g.slidesInView.get(!1)}};return T(t,n),setTimeout(()=>l.emit("init"),0),L}function vL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const i=(0,t.useRef)(e),r=(0,t.useRef)(n),[s,a]=(0,t.useState)(),[o,l]=(0,t.useState)(),c=(0,t.useCallback)(()=>{s&&s.reInit(i.current,r.current)},[s]);return(0,t.useEffect)(()=>{DR(i.current,e)||(i.current=e,c())},[e,c]),(0,t.useEffect)(()=>{(function(e,t){if(e.length!==t.length)return!1;const n=kR(e),i=kR(t);return n.every((e,t)=>DR(e,i[t]))})(r.current,n)||(r.current=n,c())},[n,c]),(0,t.useEffect)(()=>{if("undefined"!==typeof window&&window.document&&window.document.createElement&&o){gL.globalOptions=vL.globalOptions;const e=gL(o,i.current,r.current);return a(e),()=>e.destroy()}a(void 0)},[o,a]),[l,s]}gL.globalOptions=void 0,vL.globalOptions=void 0;const yL="RoomsSlideComponent_main__0KQmE",_L="RoomsSlideComponent_price__YgOOu",bL="RoomsSlideComponent_description__1kGSA",xL="RoomsSlideComponent_button__leakJ",SL="RoomsSlideComponent_description_block__HEqd5",EL="RoomsSlideComponent_hint__pzK+Z",wL="RoomsSlideComponent_text_description__1wD7R",TL="RoomsSlideComponent_title__KSZOT",ML="RoomsSlideComponent_about__IT0vA",AL=["title","className","image","description","price","about"],CL=e=>{let{title:t,className:n,image:i,description:r,price:s,about:a}=e;d(e,AL);const o=Ds(),l=Ns();return(0,p.jsx)("div",{className:"".concat(yL," ").concat(n),style:{backgroundImage:"url(".concat(i,")")},children:(0,p.jsxs)("div",{className:bL,children:[(0,p.jsxs)("div",{className:_L,children:["\u043e\u0442 ",s," \u0442\u044b\u0441. \u0440."]}),(0,p.jsxs)("div",{className:SL,children:[(0,p.jsx)("p",{className:EL,children:"\u0421\u0443\u043f\u0435\u0440 \u043a\u043e\u043c\u0444\u043e\u0440\u0442\u043d\u043e"}),(0,p.jsx)("p",{className:TL,children:t}),(0,p.jsx)("p",{className:wL,children:r})]}),(0,p.jsx)("div",{className:ML,children:a}),(0,p.jsx)(b,{className:xL,title:"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c",onClick:()=>l("room",{state:{background:o}})})]})})},RL=e=>{let{scrollerRef:n}=e;const i=(0,t.useRef)(null),r=(0,t.useRef)(null),[s,a]=vL({loop:!0});(0,t.useEffect)(()=>{if(!a)return;const e=setInterval(()=>{a.canScrollNext()?a.scrollNext():a.scrollTo(0)},3e3);return()=>clearInterval(e)},[a]),(0,t.useEffect)(()=>{n.current&&(Er.timeline({scrollTrigger:{trigger:i.current,scroller:n.current,start:"top 30%",scrub:!1,once:!0}}).from(".".concat(CR.text_header_animated),{x:"100vw",opacity:0,stagger:.01,duration:.01}).to(".".concat(CR.text_header_animated),{x:0,opacity:1,stagger:.01,duration:.7}),Er.timeline({scrollTrigger:{trigger:i.current,scroller:n.current,start:"top 30%",scrub:!1,once:!0}}).from(".".concat(CR.embla),{y:"100vw",opacity:0,duration:.1}).to(".".concat(CR.embla),{y:0,opacity:1,duration:.5,ease:"sine.out"}))},[n]);return(0,p.jsx)("section",{ref:i,className:CR.main,children:(0,p.jsxs)("div",{ref:r,className:CR.description_section,children:[(0,p.jsx)("span",{className:CR.hint_span,children:"\u0426\u0415\u041d\u042b"}),(0,p.jsx)("h1",{className:CR.header_about,children:"\u0414\u041e\u0421\u0422\u0423\u041f\u041d\u042b\u0415 \u041a\u0410\u0422\u0415\u0413\u041e\u0420\u0418\u0418 \u041d\u041e\u041c\u0415\u0420\u041e\u0412".split(" ").map((e,t)=>(0,p.jsxs)("span",{className:CR.word,children:[e.split("").map((e,t)=>(0,p.jsx)("span",{className:CR.text_header_animated,children:e},t)),(0,p.jsx)("span",{className:CR.space,children:"\xa0"})]},t))}),(0,p.jsx)("div",{className:CR.embla,ref:s,children:(0,p.jsxs)("div",{className:CR.embla__container,children:[(0,p.jsx)("div",{className:CR.embla__slide,children:(0,p.jsx)(CL,{title:"\u041d\u043e\u043c\u0435\u0440 \u0410\u043b\u044c\u0444\u0430",image:RR,price:12.5,description:"\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u043e\u0435 \u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \u0432 \u0434\u0432\u0443\u0445\u043c\u0435\u0441\u0442\u043d\u043e\u043c \u043d\u043e\u043c\u0435\u0440\u0435",about:"\u041f\u043b\u043e\u0449\u0430\u0434\u044c 35.5 \u043c | 2 \u0421/\u0423 | 4 \u043f\u0435\u0440\u0441\u043e\u043d\u044b"})}),(0,p.jsx)("div",{className:CR.embla__slide,children:(0,p.jsx)(CL,{title:"\u041d\u043e\u043c\u0435\u0440 \u0413\u0430\u043c\u043c\u0430",image:LR,price:16,description:"\u041d\u043e\u043c\u0435\u0440\u0430 \u043f\u043e\u0432\u044b\u0448\u0435\u043d\u043d\u043e\u0439 \u043a\u043e\u043c\u0444\u043e\u0440\u0442\u043d\u043e\u0441\u0442\u0438",about:"\u041f\u043b\u043e\u0449\u0430\u0434\u044c 33.3 \u043c | 2 \u0421/\u0423 | 3 \u043f\u0435\u0440\u0441\u043e\u043d\u044b"})}),(0,p.jsx)("div",{className:CR.embla__slide,children:(0,p.jsx)(CL,{title:"\u041d\u043e\u043c\u0435\u0440 \u041e\u043c\u0435\u0433\u0430",image:PR,price:25,description:"\u041e\u0434\u043d\u043e\u043c\u0435\u0441\u0442\u043d\u043e\u0435 \u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0438\u0435",about:"\u041f\u043b\u043e\u0449\u0430\u0434\u044c 16.7 \u043c | 1 \u0421/\u0423 | 2 \u043f\u0435\u0440\u0441\u043e\u043d\u044b"})})]})}),(0,p.jsxs)("div",{className:CR.buttons,children:[(0,p.jsx)("div",{className:CR.button,onClick:()=>a&&a.scrollPrev(),children:"<"}),(0,p.jsx)("div",{className:CR.button,onClick:()=>a&&a.scrollNext(),children:">"})]})]})})},LL={main:"EnvironmentsComponent_main__upF68",animate_before_first:"EnvironmentsComponent_animate_before_first__NHVZD",animate_before_second:"EnvironmentsComponent_animate_before_second__jvzsB",animate:"EnvironmentsComponent_animate__QRDMT",animated_block:"EnvironmentsComponent_animated_block__fcZHT",title_slide:"EnvironmentsComponent_title_slide__1UbKV",embla:"EnvironmentsComponent_embla__oPddb",embla__container:"EnvironmentsComponent_embla__container__pJiXT",buttons:"EnvironmentsComponent_buttons__BTzsR",button:"EnvironmentsComponent_button__DEFDL",embla__slide:"EnvironmentsComponent_embla__slide__dF+uD",hint_span:"EnvironmentsComponent_hint_span__HobEz",description_section:"EnvironmentsComponent_description_section__ie+yU",word:"EnvironmentsComponent_word__10vAg",content:"EnvironmentsComponent_content__XSIaq",image_small:"EnvironmentsComponent_image_small__DCLgD",image_medium:"EnvironmentsComponent_image_medium__3vLRr",content_text:"EnvironmentsComponent_content_text__JERdJ",content_image_left:"EnvironmentsComponent_content_image_left__6muQg",content_image_right:"EnvironmentsComponent_content_image_right__fvaM7",text_title:"EnvironmentsComponent_text_title__ZuEyY",text_paragraph:"EnvironmentsComponent_text_paragraph__zRcbo",header_about:"EnvironmentsComponent_header_about__CAUx+",text_header_animated:"EnvironmentsComponent_text_header_animated__xlW3J",animated_text_words:"EnvironmentsComponent_animated_text_words__0rqsR"},PL=n.p+"static/media/barber.635cc46dab81c02f9775.png",IL=n.p+"static/media/mola.4bc043627314d7280e17.webp",DL=n.p+"static/media/ozon.9c1902816f6ea08026b6.webp",kL=n.p+"static/media/cofe-like.0e112a2c3e34168c22ef.jpeg",OL=n.p+"static/media/sber.4670217c7604e024e078.webp",NL=n.p+"static/media/wild.524ae37312dbc9a1ac67.webp",FL=n.p+"static/media/ya2.31845d19dbe2e46b7aeb.jpg",BL="EnvironmentComponent_main__ACUzf",UL="EnvironmentComponent_description__Q3nyl",HL="EnvironmentComponent_gradient_overlay__iKL7L",zL="EnvironmentComponent_address__Ync7T",GL="EnvironmentComponent_title__Tknzs",VL=["title","className","image","address"],WL=e=>{let{title:t,className:n,image:i,address:r}=e;d(e,VL);return(0,p.jsxs)("div",{className:"".concat(BL," ").concat(n),style:{backgroundImage:"url(".concat(i,")")},children:[(0,p.jsx)("div",{className:HL}),(0,p.jsxs)("div",{className:UL,children:[(0,p.jsx)("div",{className:zL,children:r}),(0,p.jsx)("div",{className:GL,children:t})]})]})},jL=e=>{let{scrollerRef:n}=e;const i=(0,t.useRef)(null),r=(0,t.useRef)(null),[s,a]=vL({loop:!0});(0,t.useEffect)(()=>{if(!a)return;const e=setInterval(()=>{a.canScrollNext()?a.scrollNext():a.scrollTo(0)},3e3);return()=>clearInterval(e)},[a]),(0,t.useEffect)(()=>{n.current&&(Er.timeline({scrollTrigger:{trigger:i.current,scroller:n.current,start:"top 30%",scrub:!1,once:!0}}).from(".".concat(LL.text_header_animated),{x:"100vw",opacity:0,stagger:.01,duration:.01}).to(".".concat(LL.text_header_animated),{x:0,opacity:1,stagger:.01,duration:.7}),Er.timeline({scrollTrigger:{trigger:i.current,scroller:n.current,start:"top 30%",scrub:!1,once:!0}}).from(".".concat(LL.embla),{y:"100vw",opacity:0,duration:.1}).to(".".concat(LL.embla),{y:0,opacity:1,duration:.5,ease:"sine.out"}))},[n]);return(0,p.jsx)("section",{ref:i,className:LL.main,children:(0,p.jsxs)("div",{ref:r,className:LL.description_section,children:[(0,p.jsx)("span",{className:LL.hint_span,children:"\u041e\u041a\u0420\u0423\u0416\u0415\u041d\u0418\u0415"}),(0,p.jsx)("h1",{className:LL.header_about,children:"\u0412\u0421\u0415 \u0423\u0414\u041e\u0411\u0421\u0422\u0412\u0410 \u041f\u041e\u0411\u041b\u0418\u0417\u041e\u0421\u0422\u0418".split(" ").map((e,t)=>(0,p.jsxs)("span",{className:LL.word,children:[e.split("").map((e,t)=>(0,p.jsx)("span",{className:LL.text_header_animated,children:e},t)),(0,p.jsx)("span",{className:LL.space,children:"\xa0"})]},t))}),(0,p.jsx)("div",{className:LL.embla,ref:s,children:window.innerWidth>700?(0,p.jsxs)("div",{className:LL.embla__container,children:[(0,p.jsx)("div",{className:LL.embla__slide,children:(0,p.jsx)(WL,{image:PL,title:"\u0411\u0430\u0440\u0431\u0435\u0440 \u0448\u043e\u043f",address:"\u0411. \u043e\u0432\u0440\u0430\u0433\u0438 12\u043a1"})}),(0,p.jsx)("div",{className:LL.embla__slide,children:(0,p.jsx)(WL,{image:IL,title:"MOLA MOLA",address:"\u0411. \u043e\u0432\u0440\u0430\u0433\u0438 12\u043a2"})}),(0,p.jsx)("div",{className:LL.embla__slide,children:(0,p.jsx)(WL,{image:DL,title:"OZON",address:"\u0411. \u043e\u0432\u0440\u0430\u0433\u0438 12\u043a3"})}),(0,p.jsx)("div",{className:LL.embla__slide,children:(0,p.jsx)(WL,{image:NL,title:"WILDBERRIES",address:"\u0411. \u043e\u0432\u0440\u0430\u0433\u0438 12\u043a4"})}),(0,p.jsx)("div",{className:LL.embla__slide,children:(0,p.jsx)(WL,{image:kL,title:"COFFEE LIKE",address:"\u0411. \u043e\u0432\u0440\u0430\u0433\u0438 12\u043a5"})}),(0,p.jsx)("div",{className:LL.embla__slide,children:(0,p.jsx)(WL,{image:OL,title:"SBER",address:"\u0411. \u043e\u0432\u0440\u0430\u0433\u0438 12\u043a6"})}),(0,p.jsx)("div",{className:LL.embla__slide,children:(0,p.jsx)(WL,{image:FL,title:"\u042f.\u041c\u0430\u0440\u043a\u0435\u0442",address:"\u0411. \u043e\u0432\u0440\u0430\u0433\u0438 12\u043a7"})})]}):(0,p.jsxs)("div",{className:LL.embla__container,children:[(0,p.jsxs)("div",{className:LL.embla__slide,children:[(0,p.jsx)(WL,{image:PL,title:"\u0411\u0430\u0440\u0431\u0435\u0440 \u0448\u043e\u043f",address:"\u0411. \u043e\u0432\u0440\u0430\u0433\u0438 12\u043a1"}),(0,p.jsx)(WL,{image:IL,title:"MOLA MOLA",address:"\u0411. \u043e\u0432\u0440\u0430\u0433\u0438 12\u043a2"})]}),(0,p.jsxs)("div",{className:LL.embla__slide,children:[(0,p.jsx)(WL,{image:DL,title:"OZON",address:"\u0411. \u043e\u0432\u0440\u0430\u0433\u0438 12\u043a3"}),(0,p.jsx)(WL,{image:NL,title:"WILDBERRIES",address:"\u0411. \u043e\u0432\u0440\u0430\u0433\u0438 12\u043a4"})]}),(0,p.jsxs)("div",{className:LL.embla__slide,children:[(0,p.jsx)(WL,{image:kL,title:"COFFEE LIKE",address:"\u0411. \u043e\u0432\u0440\u0430\u0433\u0438 12\u043a5"}),(0,p.jsx)(WL,{image:OL,title:"SBER",address:"\u0411. \u043e\u0432\u0440\u0430\u0433\u0438 12\u043a6"})]}),(0,p.jsx)("div",{className:LL.embla__slide,children:(0,p.jsx)(WL,{image:FL,title:"\u042f.\u041c\u0430\u0440\u043a\u0435\u0442",address:"\u0411. \u043e\u0432\u0440\u0430\u0433\u0438 12\u043a7"})})]})})]})})},YL="NewsComponent_main__JdIwC",XL="NewsComponent_hint_span__-Mln6",KL="NewsComponent_description_section__r2+GN",qL="NewsComponent_content__RLbNm",JL="NewsComponent_animate_before_first__zgQJg",QL="NewsComponent_animate_before_second__j9vhJ",ZL="NewsComponent_embla__bcu1O",$L="NewsComponent_embla__container__aG5e5",eP="NewsComponent_buttons__4UWwi",tP="NewsComponent_button__wS-YW",nP="NewsComponent_embla__slide__4pAca",iP="NewsComponent_hint_slide__vZQoL",rP="NewsComponent_date__ZZDYP",sP="NewsComponent_overlay_blur__ContS",aP="NewsComponent_content_right__Rk3vc",oP="NewsComponent_content_left__Ci36B",lP=n.p+"static/media/new1.f1438098105dc4920bc5.jpeg",cP=n.p+"static/media/new2.f7847c96df1ce516d0a6.jpeg",uP=n.p+"static/media/new3.92d9e4c67ea7a273dc34.jpeg",dP=[{title:"\u041d\u043e\u0432\u044b\u0439 \u0442\u0438\u043f \u043a\u043e\u043c\u043d\u0430\u0442 \u0432 \u0433\u043e\u0441\u0442\u0438\u043d\u0438\u0446\u0430\u0445 \u041d\u0435\u0439\u043c\u0430\u0440\u043a",description:"\u041c\u044b \u0440\u0430\u0434\u044b \u0441\u043e\u043e\u0431\u0449\u0438\u0442\u044c, \u0447\u0442\u043e \u0432 \u0433\u043e\u0441\u0442\u0438\u043d\u0438\u0446\u0430\u0445 \u041d\u0435\u0439\u043c\u0430\u0440\u043a \u0442\u0435\u043f\u0435\u0440\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u043d\u043e\u0432\u044b\u0435 \u0442\u0438\u043f\u044b \u043a\u043e\u043c\u043d\u0430\u0442, \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u043e\n                  \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u043e\u0432. \u042d\u0442\u0438 \u043a\u043e\u043c\u043d\u0430\u0442\u044b \u043f\u0440\u0435\u0434\u043b\u0430\u0433\u0430\u044e\u0442 \u0441\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u0438 \u043a\u043e\u043c\u0444\u043e\u0440\u0442, \u0447\u0442\u043e \u0441\u043e\u0437\u0434\u0430\u0435\u0442\n                  \u0438\u0434\u0435\u0430\u043b\u044c\u043d\u044b\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0434\u043b\u044f \u0443\u0447\u0435\u0431\u044b \u0438 \u043e\u0442\u0434\u044b\u0445\u0430. \u041a\u0430\u0436\u0434\u0430\u044f \u043a\u043e\u043c\u043d\u0430\u0442\u0430 ...",date:"21.03.2001",image:lP},{title:"\u0421\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u0435\u0439",description:"\u041d\u0435\u0439\u043c\u0430\u0440\u043a \u043f\u0440\u0435\u0434\u043b\u0430\u0433\u0430\u0435\u0442 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u0435\u0439 \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u043e\u0432! \u041c\u044b \u043f\u043e\u043d\u0438\u043c\u0430\u0435\u043c, \u043a\u0430\u043a \u0432\u0430\u0436\u043d\u043e\n                  \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0442\u044c \u0441\u0432\u044f\u0437\u044c \u0441 \u0432\u0430\u0448\u0438\u043c\u0438 \u0434\u0435\u0442\u044c\u043c\u0438 \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u0443\u0447\u0435\u0431\u044b, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043c\u044b \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u043c \u0441\u043a\u0438\u0434\u043a\u0438 \u043d\u0430 \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u0435 \u0434\u043b\u044f\n                  \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u0435\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0436\u0435\u043b\u0430\u044e\u0442 \u043f\u043e\u0441\u0435\u0442\u0438\u0442\u044c \u0441\u0432\u043e\u0438\u0445 \u0434\u0435\u0442\u0435\u0439.",date:"14.04.2025",image:cP},{title:"\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0430 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438 \u0434\u043b\u044f \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u043e\u0432",description:"\u0413\u043e\u0441\u0442\u0438\u043d\u0438\u0446\u044b \u041d\u0435\u0439\u043c\u0430\u0440\u043a \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u044e\u0442 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0443 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438 \u0434\u043b\u044f \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u043e\u0432, \u043f\u0440\u0435\u0434\u043b\u0430\u0433\u0430\u044f \u043a\u043e\u043d\u0441\u0443\u043b\u044c\u0442\u0430\u0446\u0438\u0438 \u0438 \u043f\u043e\u043c\u043e\u0449\u044c \u0432 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u0430\u0441\u043f\u0435\u043a\u0442\u0430\u0445 \u0438\u0445 \u0436\u0438\u0437\u043d\u0438. \u041c\u044b \u043f\u043e\u043d\u0438\u043c\u0430\u0435\u043c, \u0447\u0442\u043e \u0443\u0447\u0435\u0431\u0430 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0441\u043b\u043e\u0436\u043d\u043e\u0439, \u0438 \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0443\u0441\u043b\u043e\u0432\u0438\u044f, \u0433\u0434\u0435 ...",date:"07.07.2025",image:uP}],hP=e=>{let{scrollerRef:n}=e;const i=(0,t.useRef)(null),r=(0,t.useRef)(null),[s,a]=(0,t.useState)("\u041d\u043e\u0432\u044b\u0439 \u0442\u0438\u043f \u043a\u043e\u043c\u043d\u0430\u0442 \u0432 \u0433\u043e\u0441\u0442\u0438\u043d\u0438\u0446\u0430\u0445 \u041d\u0435\u0439\u043c\u0430\u0440\u043a"),[o,l]=(0,t.useState)(lP),c=(0,t.useRef)(null),[u,d]=vL({loop:!0});(0,t.useEffect)(()=>{if(!d)return;d.on("select",()=>{const e=d.selectedScrollSnap();a(dP[e].title),f(e)});const e=setInterval(()=>{d.canScrollNext()?d.scrollNext():d.scrollTo(0)},3e3);return()=>clearInterval(e)},[d]),(0,t.useEffect)(()=>{n.current&&Er.timeline({scrollTrigger:{trigger:i.current,scroller:n.current,start:"top 30%",scrub:!1,once:!0}}).from(".".concat(JL),{y:"100vw",opacity:0,duration:.1}).to(".".concat(JL),{y:0,opacity:1,duration:.3}).to(".".concat(JL),{duration:.05}).from(".".concat(QL),{y:"100vw",opacity:0,duration:.1}).to(".".concat(QL),{y:0,opacity:1,duration:.3})},[n]);const h=(0,t.useRef)(null),f=e=>{var t;h.current&&(h.current.kill(),h.current=null),null===(t=c.current)||void 0===t||t.style.setProperty("opacity","0"),l(dP[e].image),requestAnimationFrame(()=>{h.current=Er.to(c.current,{opacity:1,duration:1,ease:"power2.out",onComplete:()=>{h.current=null}})})};return(0,p.jsx)("section",{ref:i,className:YL,children:(0,p.jsxs)("div",{ref:r,className:KL,children:[(0,p.jsx)("span",{className:XL,children:"\u041d\u041e\u0412\u041e\u0421\u0422\u0418"}),(0,p.jsxs)("div",{className:qL,style:{backgroundImage:"url(".concat(o,")")},children:[(0,p.jsx)("div",{className:sP}),(0,p.jsxs)("div",{className:aP,children:[(0,p.jsx)("div",{className:JL,children:s}),(0,p.jsxs)("div",{className:"".concat(eP," ").concat(QL),children:[(0,p.jsx)("div",{className:tP,onClick:()=>d&&d.scrollPrev(),children:"<"}),(0,p.jsx)("div",{className:tP,onClick:()=>d&&d.scrollNext(),children:">"})]})]}),(0,p.jsx)("div",{ref:c,className:"".concat(oP,"  ").concat(QL),style:{backgroundImage:"url(".concat(o,")")}}),(0,p.jsx)("div",{className:"".concat(ZL," ").concat(JL),ref:u,children:(0,p.jsx)("div",{className:$L,children:dP.map((e,t)=>(0,p.jsxs)("div",{className:nP,children:[(0,p.jsx)("div",{children:e.description}),(0,p.jsxs)("div",{className:rP,children:[(0,p.jsxs)("div",{children:["\u0414\u0430\u0442\u0430 \u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u043d\u043e\u0432\u043e\u0441\u0442\u0438: ",e.date]}),(0,p.jsx)("div",{className:iP,children:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 >"})]})]},t))})})]})]})})},fP="ConcactComponent_main__IBVwj",pP="ConcactComponent_description_section__TNRo-",mP="ConcactComponent_logo__E2k+n",gP="ConcactComponent_info_column__CEmDJ",vP="ConcactComponent_content__EJs8v",yP="ConcactComponent_map_column__HtGOY",_P=()=>(0,p.jsx)("footer",{className:fP,children:(0,p.jsx)("div",{className:pP,children:(0,p.jsxs)("div",{className:vP,children:[(0,p.jsx)(N,{className:mP}),(0,p.jsxs)("div",{className:gP,children:[(0,p.jsx)("div",{children:"\u0413\u043e\u0441\u0442\u0438\u043d\u0438\u0446\u0430 \u043d\u0435\u0439\u043c\u0430\u0440\u043a:"}),(0,p.jsx)("div",{children:"+79200520222"}),(0,p.jsx)("div",{children:"kgrant@inbox.ru"})]}),(0,p.jsxs)("div",{className:gP,children:[(0,p.jsx)("div",{children:"\u041c\u044b \u0432 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0445 \u0441\u0435\u0442\u044f\u0445:"}),(0,p.jsx)("div",{children:"\u0412\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u0435"}),(0,p.jsx)("div",{children:"\u0422\u0435\u043b\u0435\u0433\u0440\u0430\u043c"}),(0,p.jsx)("div",{children:"WhatsApp"})]}),(0,p.jsxs)("div",{className:gP,children:[(0,p.jsx)("div",{children:"\u041d\u0430\u0448\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u044b:"}),(0,p.jsx)("div",{children:"\u0421\u0430\u0439\u0442 \u041d\u0435\u0439\u043c\u0430\u0440\u043a"}),(0,p.jsx)("div",{children:"\u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u0447\u0435\u0441\u0432\u0442\u043e \u0441 \u041d\u0435\u0439\u043c\u0430\u0440\u043a"})]}),(0,p.jsx)("iframe",{className:yP,src:"https://yandex.ru/map-widget/v1/?from=mapframe&ll=43.981812%2C56.314407&mode=whatshere&whatshere%5Bpoint%5D=43.981813%2C56.314407&whatshere%5Bzoom%5D=17&z=17",width:"100%",height:"100%",frameBorder:"0"})]})})}),bP={main:"LocationComponent_main__itoQu",animate_before_first:"LocationComponent_animate_before_first__+zr0C",animate_before_second:"LocationComponent_animate_before_second__JthQE",animate:"LocationComponent_animate__SHWrQ",animated_block:"LocationComponent_animated_block__airWt",button:"LocationComponent_button__Gng1j",hint_span:"LocationComponent_hint_span__MdHTi",description_section:"LocationComponent_description_section__pnIha",word:"LocationComponent_word__wt3wP",content:"LocationComponent_content__YSGbr",description_right:"LocationComponent_description_right__wF4Ii",description_not_building:"LocationComponent_description_not_building__E5IFn",description_not_building_white:"LocationComponent_description_not_building_white__19kQo",description_header:"LocationComponent_description_header__uCPcp",description_text:"LocationComponent_description_text__3gaWh",image_small:"LocationComponent_image_small__nV0Zp",image_medium:"LocationComponent_image_medium__phVdw",content_text:"LocationComponent_content_text__WxsRV",content_image_left:"LocationComponent_content_image_left__RpFae",content_image_right:"LocationComponent_content_image_right__gUsoF",text_title:"LocationComponent_text_title__FaQeR",text_paragraph:"LocationComponent_text_paragraph__cuo01",header_about:"LocationComponent_header_about__nQzIX",text_header_animated:"LocationComponent_text_header_animated__syR0I",content_left:"LocationComponent_content_left__Wl62S",content_right:"LocationComponent_content_right__ArH24",animated_text_words:"LocationComponent_animated_text_words__O7ejh"},xP="181",SP={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},EP={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},wP=0,TP=1,MP=2,AP=3,CP=0,RP=1,LP=2,PP=3,IP=0,DP=1,kP=2,OP=0,NP=1,FP=2,BP=3,UP=4,HP=5,zP=100,GP=101,VP=102,WP=103,jP=104,YP=200,XP=201,KP=202,qP=203,JP=204,QP=205,ZP=206,$P=207,eI=208,tI=209,nI=210,iI=211,rI=212,sI=213,aI=214,oI=0,lI=1,cI=2,uI=3,dI=4,hI=5,fI=6,pI=7,mI=0,gI=1,vI=2,yI=0,_I=1,bI=2,xI=3,SI=4,EI=5,wI=6,TI=7,MI="attached",AI="detached",CI=300,RI=301,LI=302,PI=303,II=304,DI=306,kI=1e3,OI=1001,NI=1002,FI=1003,BI=1004,UI=1004,HI=1005,zI=1005,GI=1006,VI=1007,WI=1007,jI=1008,YI=1008,XI=1009,KI=1010,qI=1011,JI=1012,QI=1013,ZI=1014,$I=1015,eD=1016,tD=1017,nD=1018,iD=1020,rD=35902,sD=35899,aD=1021,oD=1022,lD=1023,cD=1026,uD=1027,dD=1028,hD=1029,fD=1030,pD=1031,mD=1032,gD=1033,vD=33776,yD=33777,_D=33778,bD=33779,xD=35840,SD=35841,ED=35842,wD=35843,TD=36196,MD=37492,AD=37496,CD=37808,RD=37809,LD=37810,PD=37811,ID=37812,DD=37813,kD=37814,OD=37815,ND=37816,FD=37817,BD=37818,UD=37819,HD=37820,zD=37821,GD=36492,VD=36494,WD=36495,jD=36283,YD=36284,XD=36285,KD=36286,qD=2200,JD=2201,QD=2202,ZD=2300,$D=2301,ek=2302,tk=2400,nk=2401,ik=2402,rk=2500,sk=2501,ak=0,ok=1,lk=2,ck=3200,uk=3201,dk=3202,hk=3203,fk=0,pk=1,mk="",gk="srgb",vk="srgb-linear",yk="linear",_k="srgb",bk=0,xk=7680,Sk=7681,Ek=7682,wk=7683,Tk=34055,Mk=34056,Ak=5386,Ck=512,Rk=513,Lk=514,Pk=515,Ik=516,Dk=517,kk=518,Ok=519,Nk=512,Fk=513,Bk=514,Uk=515,Hk=516,zk=517,Gk=518,Vk=519,Wk=35044,jk=35048,Yk=35040,Xk=35045,Kk=35049,qk=35041,Jk=35046,Qk=35050,Zk=35042,$k="100",eO="300 es",tO=2e3,nO=2001,iO={COMPUTE:"compute",RENDER:"render"},rO={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},sO={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function aO(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}const oO={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function lO(e,t){return new oO[e](t)}function cO(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function uO(){const e=cO("canvas");return e.style.display="block",e}const dO={};let hO=null;function fO(e){hO=e}function pO(){return hO}function mO(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i="THREE."+t.shift();hO?hO("log",i,...t):console.log(i,...t)}function gO(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i="THREE."+t.shift();hO?hO("warn",i,...t):console.warn(i,...t)}function vO(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i="THREE."+t.shift();hO?hO("error",i,...t):console.error(i,...t)}function yO(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=t.join(" ");i in dO||(dO[i]=!0,gO(...t))}class _O{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return void 0!==n&&(void 0!==n[e]&&-1!==n[e].indexOf(t))}removeEventListener(e,t){const n=this._listeners;if(void 0===n)return;const i=n[e];if(void 0!==i){const e=i.indexOf(t);-1!==e&&i.splice(e,1)}}dispatchEvent(e){const t=this._listeners;if(void 0===t)return;const n=t[e.type];if(void 0!==n){e.target=this;const t=n.slice(0);for(let n=0,i=t.length;n<i;n++)t[n].call(this,e);e.target=null}}}const bO=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let xO=1234567;const SO=Math.PI/180,EO=180/Math.PI;function wO(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(bO[255&e]+bO[e>>8&255]+bO[e>>16&255]+bO[e>>24&255]+"-"+bO[255&t]+bO[t>>8&255]+"-"+bO[t>>16&15|64]+bO[t>>24&255]+"-"+bO[63&n|128]+bO[n>>8&255]+"-"+bO[n>>16&255]+bO[n>>24&255]+bO[255&i]+bO[i>>8&255]+bO[i>>16&255]+bO[i>>24&255]).toLowerCase()}function TO(e,t,n){return Math.max(t,Math.min(n,e))}function MO(e,t){return(e%t+t)%t}function AO(e,t,n){return(1-n)*e+n*t}function CO(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function RO(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const LO={DEG2RAD:SO,RAD2DEG:EO,generateUUID:wO,clamp:TO,euclideanModulo:MO,mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:AO,damp:function(e,t,n,i){return AO(e,t,1-Math.exp(-n*i))},pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(MO(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(xO=e);let t=xO+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*SO},radToDeg:function(e){return e*EO},isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,i,r){const s=Math.cos,a=Math.sin,o=s(n/2),l=a(n/2),c=s((t+i)/2),u=a((t+i)/2),d=s((t-i)/2),h=a((t-i)/2),f=s((i-t)/2),p=a((i-t)/2);switch(r){case"XYX":e.set(o*u,l*d,l*h,o*c);break;case"YZY":e.set(l*h,o*u,l*d,o*c);break;case"ZXZ":e.set(l*d,l*h,o*u,o*c);break;case"XZX":e.set(o*u,l*p,l*f,o*c);break;case"YXY":e.set(l*f,o*u,l*p,o*c);break;case"ZYZ":e.set(l*p,l*f,o*u,o*c);break;default:gO("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:RO,denormalize:CO};class PO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;PO.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=TO(this.x,e.x,t.x),this.y=TO(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=TO(this.x,e,t),this.y=TO(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(TO(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(TO(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*n-s*i+e.x,this.y=r*i+s*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class IO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,r,s,a){let o=n[i+0],l=n[i+1],c=n[i+2],u=n[i+3],d=r[s+0],h=r[s+1],f=r[s+2],p=r[s+3];if(a<=0)return e[t+0]=o,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(a>=1)return e[t+0]=d,e[t+1]=h,e[t+2]=f,void(e[t+3]=p);if(u!==p||o!==d||l!==h||c!==f){let e=o*d+l*h+c*f+u*p;e<0&&(d=-d,h=-h,f=-f,p=-p,e=-e);let t=1-a;if(e<.9995){const n=Math.acos(e),i=Math.sin(n);t=Math.sin(t*n)/i,o=o*t+d*(a=Math.sin(a*n)/i),l=l*t+h*a,c=c*t+f*a,u=u*t+p*a}else{o=o*t+d*a,l=l*t+h*a,c=c*t+f*a,u=u*t+p*a;const e=1/Math.sqrt(o*o+l*l+c*c+u*u);o*=e,l*=e,c*=e,u*=e}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,i,r,s){const a=n[i],o=n[i+1],l=n[i+2],c=n[i+3],u=r[s],d=r[s+1],h=r[s+2],f=r[s+3];return e[t]=a*f+c*u+o*h-l*d,e[t+1]=o*f+c*d+l*u-a*h,e[t+2]=l*f+c*h+a*d-o*u,e[t+3]=c*f-a*u-o*d-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e._x,i=e._y,r=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(n/2),c=a(i/2),u=a(r/2),d=o(n/2),h=o(i/2),f=o(r/2);switch(s){case"XYZ":this._x=d*c*u+l*h*f,this._y=l*h*u-d*c*f,this._z=l*c*f+d*h*u,this._w=l*c*u-d*h*f;break;case"YXZ":this._x=d*c*u+l*h*f,this._y=l*h*u-d*c*f,this._z=l*c*f-d*h*u,this._w=l*c*u+d*h*f;break;case"ZXY":this._x=d*c*u-l*h*f,this._y=l*h*u+d*c*f,this._z=l*c*f+d*h*u,this._w=l*c*u-d*h*f;break;case"ZYX":this._x=d*c*u-l*h*f,this._y=l*h*u+d*c*f,this._z=l*c*f-d*h*u,this._w=l*c*u+d*h*f;break;case"YZX":this._x=d*c*u+l*h*f,this._y=l*h*u+d*c*f,this._z=l*c*f-d*h*u,this._w=l*c*u-d*h*f;break;case"XZY":this._x=d*c*u-l*h*f,this._y=l*h*u-d*c*f,this._z=l*c*f+d*h*u,this._w=l*c*u+d*h*f;break;default:gO("Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],r=t[8],s=t[1],a=t[5],o=t[9],l=t[2],c=t[6],u=t[10],d=n+a+u;if(d>0){const e=.5/Math.sqrt(d+1);this._w=.25/e,this._x=(c-o)*e,this._y=(r-l)*e,this._z=(s-i)*e}else if(n>a&&n>u){const e=2*Math.sqrt(1+n-a-u);this._w=(c-o)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(r+l)/e}else if(a>u){const e=2*Math.sqrt(1+a-n-u);this._w=(r-l)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(o+c)/e}else{const e=2*Math.sqrt(1+u-n-a);this._w=(s-i)/e,this._x=(r+l)/e,this._y=(o+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(TO(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,r=e._z,s=e._w,a=t._x,o=t._y,l=t._z,c=t._w;return this._x=n*c+s*a+i*l-r*o,this._y=i*c+s*o+r*a-n*l,this._z=r*c+s*l+n*o-i*a,this._w=s*c-n*a-i*o-r*l,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,i=e._y,r=e._z,s=e._w,a=this.dot(e);a<0&&(n=-n,i=-i,r=-r,s=-s,a=-a);let o=1-t;if(a<.9995){const e=Math.acos(a),l=Math.sin(e);o=Math.sin(o*e)/l,t=Math.sin(t*e)/l,this._x=this._x*o+n*t,this._y=this._y*o+i*t,this._z=this._z*o+r*t,this._w=this._w*o+s*t,this._onChangeCallback()}else this._x=this._x*o+n*t,this._y=this._y*o+i*t,this._z=this._z*o+r*t,this._w=this._w*o+s*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(i*Math.sin(e),i*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class DO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;DO.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(OO.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(OO.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=e.elements,s=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,r=e.x,s=e.y,a=e.z,o=e.w,l=2*(s*i-a*n),c=2*(a*t-r*i),u=2*(r*n-s*t);return this.x=t+o*l+s*u-a*c,this.y=n+o*c+a*l-r*u,this.z=i+o*u+r*c-s*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=TO(this.x,e.x,t.x),this.y=TO(this.y,e.y,t.y),this.z=TO(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=TO(this.x,e,t),this.y=TO(this.y,e,t),this.z=TO(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(TO(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,r=e.z,s=t.x,a=t.y,o=t.z;return this.x=i*o-r*a,this.y=r*s-n*o,this.z=n*a-i*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return kO.copy(this).projectOnVector(e),this.sub(kO)}reflect(e){return this.sub(kO.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(TO(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const kO=new DO,OO=new IO;class NO{constructor(e,t,n,i,r,s,a,o,l){NO.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,i,r,s,a,o,l)}set(e,t,n,i,r,s,a,o,l){const c=this.elements;return c[0]=e,c[1]=i,c[2]=a,c[3]=t,c[4]=r,c[5]=o,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],a=n[3],o=n[6],l=n[1],c=n[4],u=n[7],d=n[2],h=n[5],f=n[8],p=i[0],m=i[3],g=i[6],v=i[1],y=i[4],_=i[7],b=i[2],x=i[5],S=i[8];return r[0]=s*p+a*v+o*b,r[3]=s*m+a*y+o*x,r[6]=s*g+a*_+o*S,r[1]=l*p+c*v+u*b,r[4]=l*m+c*y+u*x,r[7]=l*g+c*_+u*S,r[2]=d*p+h*v+f*b,r[5]=d*m+h*y+f*x,r[8]=d*g+h*_+f*S,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*s*c-t*a*l-n*r*c+n*a*o+i*r*l-i*s*o}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=c*s-a*l,d=a*o-c*r,h=l*r-s*o,f=t*u+n*d+i*h;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const p=1/f;return e[0]=u*p,e[1]=(i*l-c*n)*p,e[2]=(a*n-i*s)*p,e[3]=d*p,e[4]=(c*t-i*o)*p,e[5]=(i*r-a*t)*p,e[6]=h*p,e[7]=(n*o-l*t)*p,e[8]=(s*t-n*r)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,r,s,a){const o=Math.cos(r),l=Math.sin(r);return this.set(n*o,n*l,-n*(o*s+l*a)+s+e,-i*l,i*o,-i*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(FO.makeScale(e,t)),this}rotate(e){return this.premultiply(FO.makeRotation(-e)),this}translate(e,t){return this.premultiply(FO.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const FO=new NO,BO=(new NO).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),UO=(new NO).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function HO(){const e={enabled:!0,workingColorSpace:vk,spaces:{},convert:function(e,t,n){return!1!==this.enabled&&t!==n&&t&&n?(this.spaces[t].transfer===_k&&(e.r=GO(e.r),e.g=GO(e.g),e.b=GO(e.b)),this.spaces[t].primaries!==this.spaces[n].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===_k&&(e.r=VO(e.r),e.g=VO(e.g),e.b=VO(e.b)),e):e},workingToColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},colorSpaceToWorking:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return e===mk?yk:this.spaces[e].transfer},getToneMappingMode:function(e){return this.spaces[e].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.workingColorSpace;return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,n){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.workingColorSpace;return this.spaces[e].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(t,n){return yO("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),e.workingToColorSpace(t,n)},toWorkingColorSpace:function(t,n){return yO("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),e.colorSpaceToWorking(t,n)}},t=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],i=[.3127,.329];return e.define({[vk]:{primaries:t,whitePoint:i,transfer:yk,toXYZ:BO,fromXYZ:UO,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:gk},outputColorSpaceConfig:{drawingBufferColorSpace:gk}},[gk]:{primaries:t,whitePoint:i,transfer:_k,toXYZ:BO,fromXYZ:UO,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:gk}}}),e}const zO=HO();function GO(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function VO(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let WO;class jO{static getDataURL(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png";if(/^data:/i.test(e.src))return e.src;if("undefined"===typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===WO&&(WO=cO("canvas")),WO.width=e.width,WO.height=e.height;const n=WO.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=WO}return t.toDataURL(n)}static sRGBToLinear(e){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){const t=cO("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),r=i.data;for(let e=0;e<r.length;e++)r[e]=255*GO(r[e]/255);return n.putImageData(i,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*GO(t[e]/255)):t[e]=GO(t[e]);return{data:t,width:e.width,height:e.height}}return gO("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let YO=0;class XO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,Object.defineProperty(this,"id",{value:YO++}),this.uuid=wO(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return"undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):null!==t?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)i[t].isDataTexture?e.push(KO(i[t].image)):e.push(KO(i[t]))}else e=KO(i);n.url=e}return t||(e.images[this.uuid]=n),n}}function KO(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?jO.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(gO("Texture: Unable to serialize Texture."),{})}let qO=0;const JO=new DO;class QO extends _O{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:QO.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:QO.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:OI,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:OI,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:GI,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:jI,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:lD,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:XI,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:QO.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:mk;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:qO++}),this.uuid=wO(),this.name="",this.source=new XO(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new PO(0,0),this.repeat=new PO(1,1),this.center=new PO(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new NO,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(JO).x}get height(){return this.source.getSize(JO).y}get depth(){return this.source.getSize(JO).z}get image(){return this.source.data}set image(e){void 0===e&&(e=null),this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(void 0===n){gO("Texture.setValues(): parameter '".concat(t,"' has value of undefined."));continue}const i=this[t];void 0!==i?i&&n&&i.isVector2&&n.isVector2||i&&n&&i.isVector3&&n.isVector3||i&&n&&i.isMatrix3&&n.isMatrix3?i.copy(n):this[t]=n:gO("Texture.setValues(): property '".concat(t,"' does not exist."))}}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==CI)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case kI:e.x=e.x-Math.floor(e.x);break;case OI:e.x=e.x<0?0:1;break;case NI:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case kI:e.y=e.y-Math.floor(e.y);break;case OI:e.y=e.y<0?0:1;break;case NI:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}QO.DEFAULT_IMAGE=null,QO.DEFAULT_MAPPING=CI,QO.DEFAULT_ANISOTROPY=1;class ZO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;ZO.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*t+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*t+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*t+s[7]*n+s[11]*i+s[15]*r,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,r;const s=.01,a=.1,o=e.elements,l=o[0],c=o[4],u=o[8],d=o[1],h=o[5],f=o[9],p=o[2],m=o[6],g=o[10];if(Math.abs(c-d)<s&&Math.abs(u-p)<s&&Math.abs(f-m)<s){if(Math.abs(c+d)<a&&Math.abs(u+p)<a&&Math.abs(f+m)<a&&Math.abs(l+h+g-3)<a)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,o=(h+1)/2,v=(g+1)/2,y=(c+d)/4,_=(u+p)/4,b=(f+m)/4;return e>o&&e>v?e<s?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(e),i=y/n,r=_/n):o>v?o<s?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(o),n=y/i,r=b/i):v<s?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(v),n=_/r,i=b/r),this.set(n,i,r,t),this}let v=Math.sqrt((m-f)*(m-f)+(u-p)*(u-p)+(d-c)*(d-c));return Math.abs(v)<.001&&(v=1),this.x=(m-f)/v,this.y=(u-p)/v,this.z=(d-c)/v,this.w=Math.acos((l+h+g-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=TO(this.x,e.x,t.x),this.y=TO(this.y,e.y,t.y),this.z=TO(this.z,e.z,t.z),this.w=TO(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=TO(this.x,e,t),this.y=TO(this.y,e,t),this.z=TO(this.z,e,t),this.w=TO(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(TO(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class $O extends _O{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:GI,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new ZO(0,0,e,t),this.scissorTest=!1,this.viewport=new ZO(0,0,e,t);const i={width:e,height:t,depth:n.depth},r=new QO(i);this.textures=[];const s=n.count;for(let a=0;a<s;a++)this.textures[a]=r.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={minFilter:GI,generateMipmaps:!1,flipY:!1,internalFormat:null};void 0!==e.mapping&&(t.mapping=e.mapping),void 0!==e.wrapS&&(t.wrapS=e.wrapS),void 0!==e.wrapT&&(t.wrapT=e.wrapT),void 0!==e.wrapR&&(t.wrapR=e.wrapR),void 0!==e.magFilter&&(t.magFilter=e.magFilter),void 0!==e.minFilter&&(t.minFilter=e.minFilter),void 0!==e.format&&(t.format=e.format),void 0!==e.type&&(t.type=e.type),void 0!==e.anisotropy&&(t.anisotropy=e.anisotropy),void 0!==e.colorSpace&&(t.colorSpace=e.colorSpace),void 0!==e.flipY&&(t.flipY=e.flipY),void 0!==e.generateMipmaps&&(t.generateMipmaps=e.generateMipmaps),void 0!==e.internalFormat&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++){this.textures[n].setValues(t)}}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,r=this.textures.length;i<r;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=n,!0!==this.textures[i].isData3DTexture&&(this.textures[i].isArrayTexture=this.textures[i].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const n=Object.assign({},e.textures[t].image);this.textures[t].source=new XO(n)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class eN extends $O{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.isWebGLRenderTarget=!0}}class tN extends QO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=FI,this.minFilter=FI,this.wrapR=OI,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class nN extends eN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new tN(null,e,t,n),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}}class iN extends QO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=FI,this.minFilter=FI,this.wrapR=OI,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class rN extends eN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new iN(null,e,t,n),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}}class sN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new DO(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new DO(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(oN.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(oN.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=oN.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const i=n.getAttribute("position");if(!0===t&&void 0!==i&&!0!==e.isInstancedMesh)for(let t=0,n=i.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,oN):oN.fromBufferAttribute(i,t),oN.applyMatrix4(e.matrixWorld),this.expandByPoint(oN);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),lN.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),lN.copy(n.boundingBox)),lN.applyMatrix4(e.matrixWorld),this.union(lN)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,oN),oN.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(mN),gN.subVectors(this.max,mN),cN.subVectors(e.a,mN),uN.subVectors(e.b,mN),dN.subVectors(e.c,mN),hN.subVectors(uN,cN),fN.subVectors(dN,uN),pN.subVectors(cN,dN);let t=[0,-hN.z,hN.y,0,-fN.z,fN.y,0,-pN.z,pN.y,hN.z,0,-hN.x,fN.z,0,-fN.x,pN.z,0,-pN.x,-hN.y,hN.x,0,-fN.y,fN.x,0,-pN.y,pN.x,0];return!!_N(t,cN,uN,dN,gN)&&(t=[1,0,0,0,1,0,0,0,1],!!_N(t,cN,uN,dN,gN)&&(vN.crossVectors(hN,fN),t=[vN.x,vN.y,vN.z],_N(t,cN,uN,dN,gN)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,oN).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(oN).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(aN[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),aN[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),aN[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),aN[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),aN[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),aN[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),aN[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),aN[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(aN)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const aN=[new DO,new DO,new DO,new DO,new DO,new DO,new DO,new DO],oN=new DO,lN=new sN,cN=new DO,uN=new DO,dN=new DO,hN=new DO,fN=new DO,pN=new DO,mN=new DO,gN=new DO,vN=new DO,yN=new DO;function _N(e,t,n,i,r){for(let s=0,a=e.length-3;s<=a;s+=3){yN.fromArray(e,s);const a=r.x*Math.abs(yN.x)+r.y*Math.abs(yN.y)+r.z*Math.abs(yN.z),o=t.dot(yN),l=n.dot(yN),c=i.dot(yN);if(Math.max(-Math.max(o,l,c),Math.min(o,l,c))>a)return!1}return!0}const bN=new sN,xN=new DO,SN=new DO;class EN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new DO,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):bN.setFromPoints(e).getCenter(n);let i=0;for(let r=0,s=e.length;r<s;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;xN.subVectors(e,this.center);const t=xN.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(xN,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(SN.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(xN.copy(e.center).add(SN)),this.expandByPoint(xN.copy(e.center).sub(SN))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const wN=new DO,TN=new DO,MN=new DO,AN=new DO,CN=new DO,RN=new DO,LN=new DO;class PN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new DO,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new DO(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,wN)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=wN.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(wN.copy(this.origin).addScaledVector(this.direction,t),wN.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){TN.copy(e).add(t).multiplyScalar(.5),MN.copy(t).sub(e).normalize(),AN.copy(this.origin).sub(TN);const r=.5*e.distanceTo(t),s=-this.direction.dot(MN),a=AN.dot(this.direction),o=-AN.dot(MN),l=AN.lengthSq(),c=Math.abs(1-s*s);let u,d,h,f;if(c>0)if(u=s*o-a,d=s*a-o,f=r*c,u>=0)if(d>=-f)if(d<=f){const e=1/c;u*=e,d*=e,h=u*(u+s*d+2*a)+d*(s*u+d+2*o)+l}else d=r,u=Math.max(0,-(s*d+a)),h=-u*u+d*(d+2*o)+l;else d=-r,u=Math.max(0,-(s*d+a)),h=-u*u+d*(d+2*o)+l;else d<=-f?(u=Math.max(0,-(-s*r+a)),d=u>0?-r:Math.min(Math.max(-r,-o),r),h=-u*u+d*(d+2*o)+l):d<=f?(u=0,d=Math.min(Math.max(-r,-o),r),h=d*(d+2*o)+l):(u=Math.max(0,-(s*r+a)),d=u>0?r:Math.min(Math.max(-r,-o),r),h=-u*u+d*(d+2*o)+l);else d=s>0?-r:r,u=Math.max(0,-(s*d+a)),h=-u*u+d*(d+2*o)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,u),i&&i.copy(TN).addScaledVector(MN,d),h}intersectSphere(e,t){wN.subVectors(e.center,this.origin);const n=wN.dot(this.direction),i=wN.dot(wN)-n*n,r=e.radius*e.radius;if(i>r)return null;const s=Math.sqrt(r-i),a=n-s,o=n+s;return o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return!(e.radius<0)&&this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,r,s,a,o;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,d=this.origin;return l>=0?(n=(e.min.x-d.x)*l,i=(e.max.x-d.x)*l):(n=(e.max.x-d.x)*l,i=(e.min.x-d.x)*l),c>=0?(r=(e.min.y-d.y)*c,s=(e.max.y-d.y)*c):(r=(e.max.y-d.y)*c,s=(e.min.y-d.y)*c),n>s||r>i?null:((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),u>=0?(a=(e.min.z-d.z)*u,o=(e.max.z-d.z)*u):(a=(e.max.z-d.z)*u,o=(e.min.z-d.z)*u),n>o||a>i?null:((a>n||n!==n)&&(n=a),(o<i||i!==i)&&(i=o),i<0?null:this.at(n>=0?n:i,t)))}intersectsBox(e){return null!==this.intersectBox(e,wN)}intersectTriangle(e,t,n,i,r){CN.subVectors(t,e),RN.subVectors(n,e),LN.crossVectors(CN,RN);let s,a=this.direction.dot(LN);if(a>0){if(i)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}AN.subVectors(this.origin,e);const o=s*this.direction.dot(RN.crossVectors(AN,RN));if(o<0)return null;const l=s*this.direction.dot(CN.cross(AN));if(l<0)return null;if(o+l>a)return null;const c=-s*AN.dot(LN);return c<0?null:this.at(c/a,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class IN{constructor(e,t,n,i,r,s,a,o,l,c,u,d,h,f,p,m){IN.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,i,r,s,a,o,l,c,u,d,h,f,p,m)}set(e,t,n,i,r,s,a,o,l,c,u,d,h,f,p,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=r,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=c,g[10]=u,g[14]=d,g[3]=h,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new IN).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/DN.setFromMatrixColumn(e,0).length(),r=1/DN.setFromMatrixColumn(e,1).length(),s=1/DN.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*s,t[9]=n[9]*s,t[10]=n[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,r=e.z,s=Math.cos(n),a=Math.sin(n),o=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if("XYZ"===e.order){const e=s*c,n=s*u,i=a*c,r=a*u;t[0]=o*c,t[4]=-o*u,t[8]=l,t[1]=n+i*l,t[5]=e-r*l,t[9]=-a*o,t[2]=r-e*l,t[6]=i+n*l,t[10]=s*o}else if("YXZ"===e.order){const e=o*c,n=o*u,i=l*c,r=l*u;t[0]=e+r*a,t[4]=i*a-n,t[8]=s*l,t[1]=s*u,t[5]=s*c,t[9]=-a,t[2]=n*a-i,t[6]=r+e*a,t[10]=s*o}else if("ZXY"===e.order){const e=o*c,n=o*u,i=l*c,r=l*u;t[0]=e-r*a,t[4]=-s*u,t[8]=i+n*a,t[1]=n+i*a,t[5]=s*c,t[9]=r-e*a,t[2]=-s*l,t[6]=a,t[10]=s*o}else if("ZYX"===e.order){const e=s*c,n=s*u,i=a*c,r=a*u;t[0]=o*c,t[4]=i*l-n,t[8]=e*l+r,t[1]=o*u,t[5]=r*l+e,t[9]=n*l-i,t[2]=-l,t[6]=a*o,t[10]=s*o}else if("YZX"===e.order){const e=s*o,n=s*l,i=a*o,r=a*l;t[0]=o*c,t[4]=r-e*u,t[8]=i*u+n,t[1]=u,t[5]=s*c,t[9]=-a*c,t[2]=-l*c,t[6]=n*u+i,t[10]=e-r*u}else if("XZY"===e.order){const e=s*o,n=s*l,i=a*o,r=a*l;t[0]=o*c,t[4]=-u,t[8]=l*c,t[1]=e*u+r,t[5]=s*c,t[9]=n*u-i,t[2]=i*u-n,t[6]=a*c,t[10]=r*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(ON,e,NN)}lookAt(e,t,n){const i=this.elements;return UN.subVectors(e,t),0===UN.lengthSq()&&(UN.z=1),UN.normalize(),FN.crossVectors(n,UN),0===FN.lengthSq()&&(1===Math.abs(n.z)?UN.x+=1e-4:UN.z+=1e-4,UN.normalize(),FN.crossVectors(n,UN)),FN.normalize(),BN.crossVectors(UN,FN),i[0]=FN.x,i[4]=BN.x,i[8]=UN.x,i[1]=FN.y,i[5]=BN.y,i[9]=UN.y,i[2]=FN.z,i[6]=BN.z,i[10]=UN.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],a=n[4],o=n[8],l=n[12],c=n[1],u=n[5],d=n[9],h=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],b=n[15],x=i[0],S=i[4],E=i[8],w=i[12],T=i[1],M=i[5],A=i[9],C=i[13],R=i[2],L=i[6],P=i[10],I=i[14],D=i[3],k=i[7],O=i[11],N=i[15];return r[0]=s*x+a*T+o*R+l*D,r[4]=s*S+a*M+o*L+l*k,r[8]=s*E+a*A+o*P+l*O,r[12]=s*w+a*C+o*I+l*N,r[1]=c*x+u*T+d*R+h*D,r[5]=c*S+u*M+d*L+h*k,r[9]=c*E+u*A+d*P+h*O,r[13]=c*w+u*C+d*I+h*N,r[2]=f*x+p*T+m*R+g*D,r[6]=f*S+p*M+m*L+g*k,r[10]=f*E+p*A+m*P+g*O,r[14]=f*w+p*C+m*I+g*N,r[3]=v*x+y*T+_*R+b*D,r[7]=v*S+y*M+_*L+b*k,r[11]=v*E+y*A+_*P+b*O,r[15]=v*w+y*C+_*I+b*N,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],s=e[1],a=e[5],o=e[9],l=e[13],c=e[2],u=e[6],d=e[10],h=e[14];return e[3]*(+r*o*u-i*l*u-r*a*d+n*l*d+i*a*h-n*o*h)+e[7]*(+t*o*h-t*l*d+r*s*d-i*s*h+i*l*c-r*o*c)+e[11]*(+t*l*u-t*a*h-r*s*u+n*s*h+r*a*c-n*l*c)+e[15]*(-i*a*c-t*o*u+t*a*d+i*s*u-n*s*d+n*o*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=e[9],d=e[10],h=e[11],f=e[12],p=e[13],m=e[14],g=e[15],v=u*m*l-p*d*l+p*o*h-a*m*h-u*o*g+a*d*g,y=f*d*l-c*m*l-f*o*h+s*m*h+c*o*g-s*d*g,_=c*p*l-f*u*l+f*a*h-s*p*h-c*a*g+s*u*g,b=f*u*o-c*p*o-f*a*d+s*p*d+c*a*m-s*u*m,x=t*v+n*y+i*_+r*b;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const S=1/x;return e[0]=v*S,e[1]=(p*d*r-u*m*r-p*i*h+n*m*h+u*i*g-n*d*g)*S,e[2]=(a*m*r-p*o*r+p*i*l-n*m*l-a*i*g+n*o*g)*S,e[3]=(u*o*r-a*d*r-u*i*l+n*d*l+a*i*h-n*o*h)*S,e[4]=y*S,e[5]=(c*m*r-f*d*r+f*i*h-t*m*h-c*i*g+t*d*g)*S,e[6]=(f*o*r-s*m*r-f*i*l+t*m*l+s*i*g-t*o*g)*S,e[7]=(s*d*r-c*o*r+c*i*l-t*d*l-s*i*h+t*o*h)*S,e[8]=_*S,e[9]=(f*u*r-c*p*r-f*n*h+t*p*h+c*n*g-t*u*g)*S,e[10]=(s*p*r-f*a*r+f*n*l-t*p*l-s*n*g+t*a*g)*S,e[11]=(c*a*r-s*u*r-c*n*l+t*u*l+s*n*h-t*a*h)*S,e[12]=b*S,e[13]=(c*p*i-f*u*i+f*n*d-t*p*d-c*n*m+t*u*m)*S,e[14]=(f*a*i-s*p*i-f*n*o+t*p*o+s*n*m-t*a*m)*S,e[15]=(s*u*i-c*a*i+c*n*o-t*u*o-s*n*d+t*a*d)*S,this}scale(e){const t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),r=1-n,s=e.x,a=e.y,o=e.z,l=r*s,c=r*a;return this.set(l*s+n,l*a-i*o,l*o+i*a,0,l*a+i*o,c*a+n,c*o-i*s,0,l*o-i*a,c*o+i*s,r*o*o+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,r,s){return this.set(1,n,r,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,r=t._x,s=t._y,a=t._z,o=t._w,l=r+r,c=s+s,u=a+a,d=r*l,h=r*c,f=r*u,p=s*c,m=s*u,g=a*u,v=o*l,y=o*c,_=o*u,b=n.x,x=n.y,S=n.z;return i[0]=(1-(p+g))*b,i[1]=(h+_)*b,i[2]=(f-y)*b,i[3]=0,i[4]=(h-_)*x,i[5]=(1-(d+g))*x,i[6]=(m+v)*x,i[7]=0,i[8]=(f+y)*S,i[9]=(m-v)*S,i[10]=(1-(d+p))*S,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let r=DN.set(i[0],i[1],i[2]).length();const s=DN.set(i[4],i[5],i[6]).length(),a=DN.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],kN.copy(this);const o=1/r,l=1/s,c=1/a;return kN.elements[0]*=o,kN.elements[1]*=o,kN.elements[2]*=o,kN.elements[4]*=l,kN.elements[5]*=l,kN.elements[6]*=l,kN.elements[8]*=c,kN.elements[9]*=c,kN.elements[10]*=c,t.setFromRotationMatrix(kN),n.x=r,n.y=s,n.z=a,this}makePerspective(e,t,n,i,r,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:tO,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=this.elements,c=2*r/(t-e),u=2*r/(n-i),d=(t+e)/(t-e),h=(n+i)/(n-i);let f,p;if(o)f=r/(s-r),p=s*r/(s-r);else if(a===tO)f=-(s+r)/(s-r),p=-2*s*r/(s-r);else{if(a!==nO)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);f=-s/(s-r),p=-s*r/(s-r)}return l[0]=c,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=u,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,i,r,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:tO,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=this.elements,c=2/(t-e),u=2/(n-i),d=-(t+e)/(t-e),h=-(n+i)/(n-i);let f,p;if(o)f=1/(s-r),p=s/(s-r);else if(a===tO)f=-2/(s-r),p=-(s+r)/(s-r);else{if(a!==nO)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);f=-1/(s-r),p=-r/(s-r)}return l[0]=c,l[4]=0,l[8]=0,l[12]=d,l[1]=0,l[5]=u,l[9]=0,l[13]=h,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const DN=new DO,kN=new IN,ON=new DO(0,0,0),NN=new DO(1,1,1),FN=new DO,BN=new DO,UN=new DO,HN=new IN,zN=new IO;class GN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:GN.DEFAULT_ORDER;this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=e.elements,r=i[0],s=i[4],a=i[8],o=i[1],l=i[5],c=i[9],u=i[2],d=i[6],h=i[10];switch(t){case"XYZ":this._y=Math.asin(TO(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-TO(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,h),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(TO(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,h),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,r));break;case"ZYX":this._y=Math.asin(-TO(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,h),this._z=Math.atan2(o,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(TO(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(a,h));break;case"XZY":this._z=Math.asin(-TO(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-c,h),this._y=0);break;default:gO("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return HN.makeRotationFromQuaternion(e),this.setFromRotationMatrix(HN,t,n)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return zN.setFromEuler(this),this.setFromQuaternion(zN,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}GN.DEFAULT_ORDER="XYZ";class VN{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&1<<e)}}let WN=0;const jN=new DO,YN=new IO,XN=new IN,KN=new DO,qN=new DO,JN=new DO,QN=new IO,ZN=new DO(1,0,0),$N=new DO(0,1,0),eF=new DO(0,0,1),tF={type:"added"},nF={type:"removed"},iF={type:"childadded",child:null},rF={type:"childremoved",child:null};class sF extends _O{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:WN++}),this.uuid=wO(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=sF.DEFAULT_UP.clone();const e=new DO,t=new GN,n=new IO,i=new DO(1,1,1);t._onChange(function(){n.setFromEuler(t,!1)}),n._onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new IN},normalMatrix:{value:new NO}}),this.matrix=new IN,this.matrixWorld=new IN,this.matrixAutoUpdate=sF.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=sF.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new VN,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return YN.setFromAxisAngle(e,t),this.quaternion.multiply(YN),this}rotateOnWorldAxis(e,t){return YN.setFromAxisAngle(e,t),this.quaternion.premultiply(YN),this}rotateX(e){return this.rotateOnAxis(ZN,e)}rotateY(e){return this.rotateOnAxis($N,e)}rotateZ(e){return this.rotateOnAxis(eF,e)}translateOnAxis(e,t){return jN.copy(e).applyQuaternion(this.quaternion),this.position.add(jN.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(ZN,e)}translateY(e){return this.translateOnAxis($N,e)}translateZ(e){return this.translateOnAxis(eF,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(XN.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?KN.copy(e):KN.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),qN.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?XN.lookAt(qN,KN,this.up):XN.lookAt(KN,qN,this.up),this.quaternion.setFromRotationMatrix(XN),i&&(XN.extractRotation(i.matrixWorld),YN.setFromRotationMatrix(XN),this.quaternion.premultiply(YN.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(vO("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(tF),iF.child=e,this.dispatchEvent(iF),iF.child=null):vO("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(nF),rF.child=e,this.dispatchEvent(rF),rF.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),XN.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),XN.multiply(e.parent.matrixWorld)),e.applyMatrix4(XN),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(tF),iF.child=e,this.dispatchEvent(iF),iF.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}getObjectsByProperty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[e]===t&&n.push(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(qN,e,JN),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(qN,QN,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++){t[n].updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){e[t].updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const i={};function r(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map(e=>Cr(Cr({},e),{},{boundingBox:e.boundingBox?e.boundingBox.toJSON():void 0,boundingSphere:e.boundingSphere?e.boundingSphere.toJSON():void 0})),i.instanceInfo=this._instanceInfo.map(e=>Cr({},e)),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(e),i.indirectTexture=this._indirectTexture.toJSON(e),null!==this._colorsTexture&&(i.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(i.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(i.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const i=n[t];r(e.shapes,i)}else r(e.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,i=this.material.length;n<i;n++)t.push(r(e.materials,this.material[n]));i.material=t}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];i.animations.push(r(e.animations,n))}}if(t){const t=s(e.geometries),i=s(e.materials),r=s(e.textures),a=s(e.images),o=s(e.shapes),l=s(e.skeletons),c=s(e.animations),u=s(e.nodes);t.length>0&&(n.geometries=t),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),a.length>0&&(n.images=a),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=i,n;function s(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}sF.DEFAULT_UP=new DO(0,1,0),sF.DEFAULT_MATRIX_AUTO_UPDATE=!0,sF.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const aF=new DO,oF=new DO,lF=new DO,cF=new DO,uF=new DO,dF=new DO,hF=new DO,fF=new DO,pF=new DO,mF=new DO,gF=new ZO,vF=new ZO,yF=new ZO;class _F{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new DO,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new DO,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new DO;this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),aF.subVectors(e,t),i.cross(aF);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(e,t,n,i,r){aF.subVectors(i,t),oF.subVectors(n,t),lF.subVectors(e,t);const s=aF.dot(aF),a=aF.dot(oF),o=aF.dot(lF),l=oF.dot(oF),c=oF.dot(lF),u=s*l-a*a;if(0===u)return r.set(0,0,0),null;const d=1/u,h=(l*o-a*c)*d,f=(s*c-a*o)*d;return r.set(1-h-f,f,h)}static containsPoint(e,t,n,i){return null!==this.getBarycoord(e,t,n,i,cF)&&(cF.x>=0&&cF.y>=0&&cF.x+cF.y<=1)}static getInterpolation(e,t,n,i,r,s,a,o){return null===this.getBarycoord(e,t,n,i,cF)?(o.x=0,o.y=0,"z"in o&&(o.z=0),"w"in o&&(o.w=0),null):(o.setScalar(0),o.addScaledVector(r,cF.x),o.addScaledVector(s,cF.y),o.addScaledVector(a,cF.z),o)}static getInterpolatedAttribute(e,t,n,i,r,s){return gF.setScalar(0),vF.setScalar(0),yF.setScalar(0),gF.fromBufferAttribute(e,t),vF.fromBufferAttribute(e,n),yF.fromBufferAttribute(e,i),s.setScalar(0),s.addScaledVector(gF,r.x),s.addScaledVector(vF,r.y),s.addScaledVector(yF,r.z),s}static isFrontFacing(e,t,n,i){return aF.subVectors(n,t),oF.subVectors(e,t),aF.cross(oF).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return aF.subVectors(this.c,this.b),oF.subVectors(this.a,this.b),.5*aF.cross(oF).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return _F.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return _F.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,i,r){return _F.getInterpolation(e,this.a,this.b,this.c,t,n,i,r)}containsPoint(e){return _F.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return _F.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,r=this.c;let s,a;uF.subVectors(i,n),dF.subVectors(r,n),fF.subVectors(e,n);const o=uF.dot(fF),l=dF.dot(fF);if(o<=0&&l<=0)return t.copy(n);pF.subVectors(e,i);const c=uF.dot(pF),u=dF.dot(pF);if(c>=0&&u<=c)return t.copy(i);const d=o*u-c*l;if(d<=0&&o>=0&&c<=0)return s=o/(o-c),t.copy(n).addScaledVector(uF,s);mF.subVectors(e,r);const h=uF.dot(mF),f=dF.dot(mF);if(f>=0&&h<=f)return t.copy(r);const p=h*l-o*f;if(p<=0&&l>=0&&f<=0)return a=l/(l-f),t.copy(n).addScaledVector(dF,a);const m=c*f-h*u;if(m<=0&&u-c>=0&&h-f>=0)return hF.subVectors(r,i),a=(u-c)/(u-c+(h-f)),t.copy(i).addScaledVector(hF,a);const g=1/(m+p+d);return s=p*g,a=d*g,t.copy(n).addScaledVector(uF,s).addScaledVector(dF,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const bF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},xF={h:0,s:0,l:0},SF={h:0,s:0,l:0};function EF(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class wF{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gk;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,zO.colorSpaceToWorking(this,t),this}setRGB(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:zO.workingColorSpace;return this.r=e,this.g=t,this.b=n,zO.colorSpaceToWorking(this,i),this}setHSL(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:zO.workingColorSpace;if(e=MO(e,1),t=TO(t,0,1),n=TO(n,0,1),0===t)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=EF(r,i,e+1/3),this.g=EF(r,i,e),this.b=EF(r,i,e-1/3)}return zO.colorSpaceToWorking(this,i),this}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gk;function i(t){void 0!==t&&parseFloat(t)<1&&gO("Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const s=t[1],a=t[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,n);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,n);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,n);break;default:gO("Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=t[1],r=i.length;if(3===r)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,n);if(6===r)return this.setHex(parseInt(i,16),n);gO("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gk;const n=bF[e.toLowerCase()];return void 0!==n?this.setHex(n,t):gO("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=GO(e.r),this.g=GO(e.g),this.b=GO(e.b),this}copyLinearToSRGB(e){return this.r=VO(e.r),this.g=VO(e.g),this.b=VO(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gk;return zO.workingToColorSpace(TF.copy(this),e),65536*Math.round(TO(255*TF.r,0,255))+256*Math.round(TO(255*TF.g,0,255))+Math.round(TO(255*TF.b,0,255))}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gk;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zO.workingColorSpace;zO.workingToColorSpace(TF.copy(this),t);const n=TF.r,i=TF.g,r=TF.b,s=Math.max(n,i,r),a=Math.min(n,i,r);let o,l;const c=(a+s)/2;if(a===s)o=0,l=0;else{const e=s-a;switch(l=c<=.5?e/(s+a):e/(2-s-a),s){case n:o=(i-r)/e+(i<r?6:0);break;case i:o=(r-n)/e+2;break;case r:o=(n-i)/e+4}o/=6}return e.h=o,e.s=l,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zO.workingColorSpace;return zO.workingToColorSpace(TF.copy(this),t),e.r=TF.r,e.g=TF.g,e.b=TF.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gk;zO.workingToColorSpace(TF.copy(this),e);const t=TF.r,n=TF.g,i=TF.b;return e!==gk?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(i.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*n),",").concat(Math.round(255*i),")")}offsetHSL(e,t,n){return this.getHSL(xF),this.setHSL(xF.h+e,xF.s+t,xF.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(xF),e.getHSL(SF);const n=AO(xF.h,SF.h,t),i=AO(xF.s,SF.s,t),r=AO(xF.l,SF.l,t);return this.setHSL(n,i,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,i=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*i,this.g=r[1]*t+r[4]*n+r[7]*i,this.b=r[2]*t+r[5]*n+r[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const TF=new wF;wF.NAMES=bF;let MF=0;class AF extends _O{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:MF++}),this.uuid=wO(),this.name="",this.type="Material",this.blending=NP,this.side=IP,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=JP,this.blendDst=QP,this.blendEquation=zP,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new wF(0,0,0),this.blendAlpha=0,this.depthFunc=uI,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Ok,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=xk,this.stencilZFail=xk,this.stencilZPass=xk,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!==e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){gO("Material: parameter '".concat(t,"' has value of undefined."));continue}const i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:gO("Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."))}}toJSON(e){const t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};function i(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==NP&&(n.blending=this.blending),this.side!==IP&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),this.blendSrc!==JP&&(n.blendSrc=this.blendSrc),this.blendDst!==QP&&(n.blendDst=this.blendDst),this.blendEquation!==zP&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==uI&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Ok&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==xk&&(n.stencilFail=this.stencilFail),this.stencilZFail!==xk&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==xk&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=i(e.textures),r=i(e.images);t.length>0&&(n.textures=t),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let i=0;i!==e;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class CF extends AF{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new wF(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new GN,this.combine=mI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const RF=LF();function LF(){const e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const e=l-127;e<-27?(i[l]=0,i[256|l]=32768,r[l]=24,r[256|l]=24):e<-14?(i[l]=1024>>-e-14,i[256|l]=1024>>-e-14|32768,r[l]=-e-1,r[256|l]=-e-1):e<=15?(i[l]=e+15<<10,i[256|l]=e+15<<10|32768,r[l]=13,r[256|l]=13):e<128?(i[l]=31744,i[256|l]=64512,r[l]=24,r[256|l]=24):(i[l]=31744,i[256|l]=64512,r[l]=13,r[256|l]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;0===(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,s[l]=e|t}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(o[l]=1024);return{floatView:t,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:a,offsetTable:o}}function PF(e){Math.abs(e)>65504&&gO("DataUtils.toHalfFloat(): Value out of range."),e=TO(e,-65504,65504),RF.floatView[0]=e;const t=RF.uint32View[0],n=t>>23&511;return RF.baseTable[n]+((8388607&t)>>RF.shiftTable[n])}function IF(e){const t=e>>10;return RF.uint32View[0]=RF.mantissaTable[RF.offsetTable[t]+(1023&e)]+RF.exponentTable[t],RF.floatView[0]}class DF{static toHalfFloat(e){return PF(e)}static fromHalfFloat(e){return IF(e)}}const kF=new DO,OF=new PO;let NF=0;class FF{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:NF++}),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=Wk,this.updateRanges=[],this.gpuType=$I,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)OF.fromBufferAttribute(this,t),OF.applyMatrix3(e),this.setXY(t,OF.x,OF.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)kF.fromBufferAttribute(this,t),kF.applyMatrix3(e),this.setXYZ(t,kF.x,kF.y,kF.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)kF.fromBufferAttribute(this,t),kF.applyMatrix4(e),this.setXYZ(t,kF.x,kF.y,kF.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)kF.fromBufferAttribute(this,t),kF.applyNormalMatrix(e),this.setXYZ(t,kF.x,kF.y,kF.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)kF.fromBufferAttribute(this,t),kF.transformDirection(e),this.setXYZ(t,kF.x,kF.y,kF.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=CO(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=RO(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=CO(t,this.array)),t}setX(e,t){return this.normalized&&(t=RO(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=CO(t,this.array)),t}setY(e,t){return this.normalized&&(t=RO(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=CO(t,this.array)),t}setZ(e,t){return this.normalized&&(t=RO(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=CO(t,this.array)),t}setW(e,t){return this.normalized&&(t=RO(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=RO(t,this.array),n=RO(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=RO(t,this.array),n=RO(n,this.array),i=RO(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=RO(t,this.array),n=RO(n,this.array),i=RO(i,this.array),r=RO(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Wk&&(e.usage=this.usage),e}}class BF extends FF{constructor(e,t,n){super(new Int8Array(e),t,n)}}class UF extends FF{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class HF extends FF{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class zF extends FF{constructor(e,t,n){super(new Int16Array(e),t,n)}}class GF extends FF{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class VF extends FF{constructor(e,t,n){super(new Int32Array(e),t,n)}}class WF extends FF{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class jF extends FF{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=IF(this.array[e*this.itemSize]);return this.normalized&&(t=CO(t,this.array)),t}setX(e,t){return this.normalized&&(t=RO(t,this.array)),this.array[e*this.itemSize]=PF(t),this}getY(e){let t=IF(this.array[e*this.itemSize+1]);return this.normalized&&(t=CO(t,this.array)),t}setY(e,t){return this.normalized&&(t=RO(t,this.array)),this.array[e*this.itemSize+1]=PF(t),this}getZ(e){let t=IF(this.array[e*this.itemSize+2]);return this.normalized&&(t=CO(t,this.array)),t}setZ(e,t){return this.normalized&&(t=RO(t,this.array)),this.array[e*this.itemSize+2]=PF(t),this}getW(e){let t=IF(this.array[e*this.itemSize+3]);return this.normalized&&(t=CO(t,this.array)),t}setW(e,t){return this.normalized&&(t=RO(t,this.array)),this.array[e*this.itemSize+3]=PF(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=RO(t,this.array),n=RO(n,this.array)),this.array[e+0]=PF(t),this.array[e+1]=PF(n),this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=RO(t,this.array),n=RO(n,this.array),i=RO(i,this.array)),this.array[e+0]=PF(t),this.array[e+1]=PF(n),this.array[e+2]=PF(i),this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=RO(t,this.array),n=RO(n,this.array),i=RO(i,this.array),r=RO(r,this.array)),this.array[e+0]=PF(t),this.array[e+1]=PF(n),this.array[e+2]=PF(i),this.array[e+3]=PF(r),this}}class YF extends FF{constructor(e,t,n){super(new Float32Array(e),t,n)}}let XF=0;const KF=new IN,qF=new sF,JF=new DO,QF=new sN,ZF=new sN,$F=new DO;class eB extends _O{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:XF++}),this.uuid=wO(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(aO(e)?WF:GF)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new NO).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return KF.makeRotationFromQuaternion(e),this.applyMatrix4(KF),this}rotateX(e){return KF.makeRotationX(e),this.applyMatrix4(KF),this}rotateY(e){return KF.makeRotationY(e),this.applyMatrix4(KF),this}rotateZ(e){return KF.makeRotationZ(e),this.applyMatrix4(KF),this}translate(e,t,n){return KF.makeTranslation(e,t,n),this.applyMatrix4(KF),this}scale(e,t,n){return KF.makeScale(e,t,n),this.applyMatrix4(KF),this}lookAt(e){return qF.lookAt(e),qF.updateMatrix(),this.applyMatrix4(qF.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(JF).negate(),this.translate(JF.x,JF.y,JF.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];t.push(i.x,i.y,i.z||0)}this.setAttribute("position",new YF(t,3))}else{const n=Math.min(e.length,t.count);for(let i=0;i<n;i++){const n=e[i];t.setXYZ(i,n.x,n.y,n.z||0)}e.length>t.count&&gO("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new sN);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return vO("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new DO(-1/0,-1/0,-1/0),new DO(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const e=t[n];QF.setFromBufferAttribute(e),this.morphTargetsRelative?($F.addVectors(this.boundingBox.min,QF.min),this.boundingBox.expandByPoint($F),$F.addVectors(this.boundingBox.max,QF.max),this.boundingBox.expandByPoint($F)):(this.boundingBox.expandByPoint(QF.min),this.boundingBox.expandByPoint(QF.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&vO('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new EN);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return vO("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new DO,1/0);if(e){const n=this.boundingSphere.center;if(QF.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){const n=t[e];ZF.setFromBufferAttribute(n),this.morphTargetsRelative?($F.addVectors(QF.min,ZF.min),QF.expandByPoint($F),$F.addVectors(QF.max,ZF.max),QF.expandByPoint($F)):(QF.expandByPoint(ZF.min),QF.expandByPoint(ZF.max))}QF.getCenter(n);let i=0;for(let t=0,r=e.count;t<r;t++)$F.fromBufferAttribute(e,t),i=Math.max(i,n.distanceToSquared($F));if(t)for(let r=0,s=t.length;r<s;r++){const s=t[r],a=this.morphTargetsRelative;for(let t=0,r=s.count;t<r;t++)$F.fromBufferAttribute(s,t),a&&(JF.fromBufferAttribute(e,t),$F.add(JF)),i=Math.max(i,n.distanceToSquared($F))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&vO('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void vO("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.position,i=t.normal,r=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new FF(new Float32Array(4*n.count),4));const s=this.getAttribute("tangent"),a=[],o=[];for(let E=0;E<n.count;E++)a[E]=new DO,o[E]=new DO;const l=new DO,c=new DO,u=new DO,d=new PO,h=new PO,f=new PO,p=new DO,m=new DO;function g(e,t,i){l.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),u.fromBufferAttribute(n,i),d.fromBufferAttribute(r,e),h.fromBufferAttribute(r,t),f.fromBufferAttribute(r,i),c.sub(l),u.sub(l),h.sub(d),f.sub(d);const s=1/(h.x*f.y-f.x*h.y);isFinite(s)&&(p.copy(c).multiplyScalar(f.y).addScaledVector(u,-h.y).multiplyScalar(s),m.copy(u).multiplyScalar(h.x).addScaledVector(c,-f.x).multiplyScalar(s),a[e].add(p),a[t].add(p),a[i].add(p),o[e].add(m),o[t].add(m),o[i].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:e.count}]);for(let E=0,w=v.length;E<w;++E){const t=v[E],n=t.start;for(let i=n,r=n+t.count;i<r;i+=3)g(e.getX(i+0),e.getX(i+1),e.getX(i+2))}const y=new DO,_=new DO,b=new DO,x=new DO;function S(e){b.fromBufferAttribute(i,e),x.copy(b);const t=a[e];y.copy(t),y.sub(b.multiplyScalar(b.dot(t))).normalize(),_.crossVectors(x,t);const n=_.dot(o[e])<0?-1:1;s.setXYZW(e,y.x,y.y,y.z,n)}for(let E=0,w=v.length;E<w;++E){const t=v[E],n=t.start;for(let i=n,r=n+t.count;i<r;i+=3)S(e.getX(i+0)),S(e.getX(i+1)),S(e.getX(i+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new FF(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const i=new DO,r=new DO,s=new DO,a=new DO,o=new DO,l=new DO,c=new DO,u=new DO;if(e)for(let d=0,h=e.count;d<h;d+=3){const h=e.getX(d+0),f=e.getX(d+1),p=e.getX(d+2);i.fromBufferAttribute(t,h),r.fromBufferAttribute(t,f),s.fromBufferAttribute(t,p),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),a.fromBufferAttribute(n,h),o.fromBufferAttribute(n,f),l.fromBufferAttribute(n,p),a.add(c),o.add(c),l.add(c),n.setXYZ(h,a.x,a.y,a.z),n.setXYZ(f,o.x,o.y,o.z),n.setXYZ(p,l.x,l.y,l.z)}else for(let e=0,d=t.count;e<d;e+=3)i.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)$F.fromBufferAttribute(e,t),$F.normalize(),e.setXYZ(t,$F.x,$F.y,$F.z)}toNonIndexed(){function e(e,t){const n=e.array,i=e.itemSize,r=e.normalized,s=new n.constructor(t.length*i);let a=0,o=0;for(let l=0,c=t.length;l<c;l++){a=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*i;for(let e=0;e<i;e++)s[o++]=n[a++]}return new FF(s,i,r)}if(null===this.index)return gO("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new eB,n=this.index.array,i=this.attributes;for(const a in i){const r=e(i[a],n);t.setAttribute(a,r)}const r=this.morphAttributes;for(const a in r){const i=[],s=r[a];for(let t=0,r=s.length;t<r;t++){const r=e(s[t],n);i.push(r)}t.morphAttributes[a]=i}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,o=s.length;a<o;a++){const e=s[a];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const o in n){const t=n[o];e.data.attributes[o]=t.toJSON(e.data)}const i={};let r=!1;for(const o in this.morphAttributes){const t=this.morphAttributes[o],n=[];for(let i=0,r=t.length;i<r;i++){const r=t[i];n.push(r.toJSON(e.data))}n.length>0&&(i[o]=n,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere=a.toJSON()),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone());const i=e.attributes;for(const l in i){const e=i[l];this.setAttribute(l,e.clone(t))}const r=e.morphAttributes;for(const l in r){const e=[],n=r[l];for(let i=0,r=n.length;i<r;i++)e.push(n[i].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let l=0,c=s.length;l<c;l++){const e=s[l];this.addGroup(e.start,e.count,e.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const tB=new IN,nB=new PN,iB=new EN,rB=new DO,sB=new DO,aB=new DO,oB=new DO,lB=new DO,cB=new DO,uB=new DO,dB=new DO;class hB extends sF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new eB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new CF;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const a=this.morphTargetInfluences;if(r&&a){cB.set(0,0,0);for(let n=0,i=r.length;n<i;n++){const i=a[n],o=r[n];0!==i&&(lB.fromBufferAttribute(o,e),s?cB.addScaledVector(lB,i):cB.addScaledVector(lB.sub(t),i))}t.add(cB)}return t}raycast(e,t){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0!==i){if(null===n.boundingSphere&&n.computeBoundingSphere(),iB.copy(n.boundingSphere),iB.applyMatrix4(r),nB.copy(e.ray).recast(e.near),!1===iB.containsPoint(nB.origin)){if(null===nB.intersectSphere(iB,rB))return;if(nB.origin.distanceToSquared(rB)>(e.far-e.near)**2)return}tB.copy(r).invert(),nB.copy(e.ray).applyMatrix4(tB),null!==n.boundingBox&&!1===nB.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,nB)}}_computeIntersections(e,t,n){let i;const r=this.geometry,s=this.material,a=r.index,o=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv1,u=r.attributes.normal,d=r.groups,h=r.drawRange;if(null!==a)if(Array.isArray(s))for(let f=0,p=d.length;f<p;f++){const r=d[f],o=s[r.materialIndex];for(let s=Math.max(r.start,h.start),d=Math.min(a.count,Math.min(r.start+r.count,h.start+h.count));s<d;s+=3){i=fB(this,o,e,n,l,c,u,a.getX(s),a.getX(s+1),a.getX(s+2)),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,t.push(i))}}else{for(let r=Math.max(0,h.start),o=Math.min(a.count,h.start+h.count);r<o;r+=3){i=fB(this,s,e,n,l,c,u,a.getX(r),a.getX(r+1),a.getX(r+2)),i&&(i.faceIndex=Math.floor(r/3),t.push(i))}}else if(void 0!==o)if(Array.isArray(s))for(let f=0,p=d.length;f<p;f++){const r=d[f],a=s[r.materialIndex];for(let s=Math.max(r.start,h.start),d=Math.min(o.count,Math.min(r.start+r.count,h.start+h.count));s<d;s+=3){i=fB(this,a,e,n,l,c,u,s,s+1,s+2),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,t.push(i))}}else{for(let r=Math.max(0,h.start),a=Math.min(o.count,h.start+h.count);r<a;r+=3){i=fB(this,s,e,n,l,c,u,r,r+1,r+2),i&&(i.faceIndex=Math.floor(r/3),t.push(i))}}}}function fB(e,t,n,i,r,s,a,o,l,c){e.getVertexPosition(o,sB),e.getVertexPosition(l,aB),e.getVertexPosition(c,oB);const u=function(e,t,n,i,r,s,a,o){let l;if(l=t.side===DP?i.intersectTriangle(a,s,r,!0,o):i.intersectTriangle(r,s,a,t.side===IP,o),null===l)return null;dB.copy(o),dB.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(dB);return c<n.near||c>n.far?null:{distance:c,point:dB.clone(),object:e}}(e,t,n,i,sB,aB,oB,uB);if(u){const e=new DO;_F.getBarycoord(uB,sB,aB,oB,e),r&&(u.uv=_F.getInterpolatedAttribute(r,o,l,c,e,new PO)),s&&(u.uv1=_F.getInterpolatedAttribute(s,o,l,c,e,new PO)),a&&(u.normal=_F.getInterpolatedAttribute(a,o,l,c,e,new DO),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const t={a:o,b:l,c:c,normal:new DO,materialIndex:0};_F.getNormal(sB,aB,oB,t.normal),u.face=t,u.barycoord=e}return u}class pB extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};const a=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);const o=[],l=[],c=[],u=[];let d=0,h=0;function f(e,t,n,i,r,s,f,p,m,g,v){const y=s/m,_=f/g,b=s/2,x=f/2,S=p/2,E=m+1,w=g+1;let T=0,M=0;const A=new DO;for(let a=0;a<w;a++){const s=a*_-x;for(let o=0;o<E;o++){const d=o*y-b;A[e]=d*i,A[t]=s*r,A[n]=S,l.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[n]=p>0?1:-1,c.push(A.x,A.y,A.z),u.push(o/m),u.push(1-a/g),T+=1}}for(let a=0;a<g;a++)for(let e=0;e<m;e++){const t=d+e+E*a,n=d+e+E*(a+1),i=d+(e+1)+E*(a+1),r=d+(e+1)+E*a;o.push(t,n,r),o.push(n,i,r),M+=6}a.addGroup(h,M,v),h+=M,d+=T}f("z","y","x",-1,-1,n,t,e,s,r,0),f("z","y","x",1,-1,n,t,-e,s,r,1),f("x","z","y",1,1,e,n,t,i,s,2),f("x","z","y",1,-1,e,n,-t,i,s,3),f("x","y","z",1,-1,e,t,n,i,r,4),f("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(o),this.setAttribute("position",new YF(l,3)),this.setAttribute("normal",new YF(c,3)),this.setAttribute("uv",new YF(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pB(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function mB(e){const t={};for(const n in e){t[n]={};for(const i in e[n]){const r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(gO("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][i]=null):t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}}return t}function gB(e){const t={};for(let n=0;n<e.length;n++){const i=mB(e[n]);for(const e in i)t[e]=i[e]}return t}function vB(e){const t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:zO.workingColorSpace}const yB={clone:mB,merge:gB};class _B extends AF{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=mB(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class bB extends sF{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new IN,this.projectionMatrix=new IN,this.projectionMatrixInverse=new IN,this.coordinateSystem=tO,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const xB=new DO,SB=new PO,EB=new PO;class wB extends bB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*EO*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*SO*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*EO*Math.atan(Math.tan(.5*SO*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){xB.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(xB.x,xB.y).multiplyScalar(-e/xB.z),xB.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(xB.x,xB.y).multiplyScalar(-e/xB.z)}getViewSize(e,t){return this.getViewBounds(e,SB,EB),t.subVectors(EB,SB)}setViewOffset(e,t,n,i,r,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*SO*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i;const s=this.view;if(null!==this.view&&this.view.enabled){const e=s.fullWidth,a=s.fullHeight;r+=s.offsetX*i/e,t-=s.offsetY*n/a,i*=s.width/e,n*=s.height/a}const a=this.filmOffset;0!==a&&(r+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const TB=-90;class MB extends sF{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new wB(TB,1,e,t);i.layers=this.layers,this.add(i);const r=new wB(TB,1,e,t);r.layers=this.layers,this.add(r);const s=new wB(TB,1,e,t);s.layers=this.layers,this.add(s);const a=new wB(TB,1,e,t);a.layers=this.layers,this.add(a);const o=new wB(TB,1,e,t);o.layers=this.layers,this.add(o);const l=new wB(TB,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,i,r,s,a,o]=t;for(const l of t)this.remove(l);if(e===tO)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else{if(e!==nO)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,s,a,o,l,c]=this.children,u=e.getRenderTarget(),d=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),f=e.xr.enabled;e.xr.enabled=!1;const p=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,i),e.render(t,r),e.setRenderTarget(n,1,i),e.render(t,s),e.setRenderTarget(n,2,i),e.render(t,a),e.setRenderTarget(n,3,i),e.render(t,o),e.setRenderTarget(n,4,i),e.render(t,l),n.texture.generateMipmaps=p,e.setRenderTarget(n,5,i),e.render(t,c),e.setRenderTarget(u,d,h),e.xr.enabled=f,n.texture.needsPMREMUpdate=!0}}class AB extends QO{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],arguments.length>1&&void 0!==arguments[1]?arguments[1]:RI,arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0,arguments.length>9?arguments[9]:void 0),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class CB extends eN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new AB(i),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={tEquirect:{value:null}},i="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new pB(5,5,5),a=new _B({name:"CubemapFromEquirect",uniforms:mB(n),vertexShader:i,fragmentShader:r,side:DP,blending:OP});a.uniforms.tEquirect.value=t;const o=new hB(s,a),l=t.minFilter;t.minFilter===jI&&(t.minFilter=GI);return new MB(1,10,this).update(e,o),t.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,n,i);e.setRenderTarget(r)}}class RB extends sF{constructor(){super(),this.isGroup=!0,this.type="Group"}}const LB={type:"move"};class PB{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new RB,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new RB,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new DO,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new DO),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new RB,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new DO,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new DO),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let i=null,r=null,s=null;const a=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){s=!0;for(const s of e.hand.values()){const e=t.getJointPose(s,n),i=this._getHandJoint(l,s);null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.matrixWorldNeedsUpdate=!0,i.jointRadius=e.radius),i.visible=null!==e}const i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],a=i.position.distanceTo(r.position),o=.02,c=.005;l.inputState.pinching&&a>o+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&a<=o-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1));null!==a&&(i=t.getPose(e.targetRaySpace,n),null===i&&null!==r&&(i=r),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(LB)))}return null!==a&&(a.visible=null!==i),null!==o&&(o.visible=null!==r),null!==l&&(l.visible=null!==s),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new RB;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class IB{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;this.isFogExp2=!0,this.name="",this.color=new wF(e),this.density=t}clone(){return new IB(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class DB{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this.isFog=!0,this.name="",this.color=new wF(e),this.near=t,this.far=n}clone(){return new DB(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class kB extends sF{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new GN,this.environmentIntensity=1,this.environmentRotation=new GN,this.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class OB{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Wk,this.updateRanges=[],this.version=0,this.uuid=wO()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=wO()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=wO()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const NB=new DO;class FB{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)NB.fromBufferAttribute(this,t),NB.applyMatrix4(e),this.setXYZ(t,NB.x,NB.y,NB.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)NB.fromBufferAttribute(this,t),NB.applyNormalMatrix(e),this.setXYZ(t,NB.x,NB.y,NB.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)NB.fromBufferAttribute(this,t),NB.transformDirection(e),this.setXYZ(t,NB.x,NB.y,NB.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=CO(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=RO(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=RO(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=RO(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=RO(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=RO(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=CO(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=CO(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=CO(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=CO(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=RO(t,this.array),n=RO(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=RO(t,this.array),n=RO(n,this.array),i=RO(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=RO(t,this.array),n=RO(n,this.array),i=RO(i,this.array),r=RO(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}clone(e){if(void 0===e){mO("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new FF(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new FB(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){mO("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class BB extends AF{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new wF(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let UB;const HB=new DO,zB=new DO,GB=new DO,VB=new PO,WB=new PO,jB=new IN,YB=new DO,XB=new DO,KB=new DO,qB=new PO,JB=new PO,QB=new PO;class ZB extends sF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new BB;if(super(),this.isSprite=!0,this.type="Sprite",void 0===UB){UB=new eB;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new OB(e,5);UB.setIndex([0,1,2,0,2,3]),UB.setAttribute("position",new FB(t,3,0,!1)),UB.setAttribute("uv",new FB(t,2,3,!1))}this.geometry=UB,this.material=e,this.center=new PO(.5,.5),this.count=1}raycast(e,t){null===e.camera&&vO('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),zB.setFromMatrixScale(this.matrixWorld),jB.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),GB.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&zB.multiplyScalar(-GB.z);const n=this.material.rotation;let i,r;0!==n&&(r=Math.cos(n),i=Math.sin(n));const s=this.center;$B(YB.set(-.5,-.5,0),GB,s,zB,i,r),$B(XB.set(.5,-.5,0),GB,s,zB,i,r),$B(KB.set(.5,.5,0),GB,s,zB,i,r),qB.set(0,0),JB.set(1,0),QB.set(1,1);let a=e.ray.intersectTriangle(YB,XB,KB,!1,HB);if(null===a&&($B(XB.set(-.5,.5,0),GB,s,zB,i,r),JB.set(0,1),a=e.ray.intersectTriangle(YB,KB,XB,!1,HB),null===a))return;const o=e.ray.origin.distanceTo(HB);o<e.near||o>e.far||t.push({distance:o,point:HB.clone(),uv:_F.getInterpolation(HB,YB,XB,KB,qB,JB,QB,new PO),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function $B(e,t,n,i,r,s){VB.subVectors(e,n).addScalar(.5).multiply(i),void 0!==r?(WB.x=s*VB.x-r*VB.y,WB.y=r*VB.x+s*VB.y):WB.copy(VB),e.copy(t),e.x+=WB.x,e.y+=WB.y,e.applyMatrix4(jB)}const eU=new DO,tU=new DO;class nU extends sF{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const e=t[n];this.addLevel(e.object.clone(),e.distance,e.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t=Math.abs(t);const i=this.levels;let r;for(r=0;r<i.length&&!(t<i[r].distance);r++);return i.splice(r,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const e=t.splice(n,1);return this.remove(e[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i;n++){let i=t[n].distance;if(t[n].object.visible&&(i-=i*t[n].hysteresis),e<i)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){eU.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(eU);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){eU.setFromMatrixPosition(e.matrixWorld),tU.setFromMatrixPosition(this.matrixWorld);const n=eU.distanceTo(tU)/e.zoom;let i,r;for(t[0].object.visible=!0,i=1,r=t.length;i<r;i++){let e=t[i].distance;if(t[i].object.visible&&(e-=e*t[i].hysteresis),!(n>=e))break;t[i-1].object.visible=!1,t[i].object.visible=!0}for(this._currentLevel=i-1;i<r;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,r=n.length;i<r;i++){const e=n[i];t.object.levels.push({object:e.object.uuid,distance:e.distance,hysteresis:e.hysteresis})}return t}}const iU=new DO,rU=new ZO,sU=new ZO,aU=new DO,oU=new IN,lU=new DO,cU=new EN,uU=new IN,dU=new PN;class hU extends hB{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=MI,this.bindMatrix=new IN,this.bindMatrixInverse=new IN,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new sN),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,lU),this.boundingBox.expandByPoint(lU)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new EN),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,lU),this.boundingSphere.expandByPoint(lU)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,i=this.matrixWorld;void 0!==n&&(null===this.boundingSphere&&this.computeBoundingSphere(),cU.copy(this.boundingSphere),cU.applyMatrix4(i),!1!==e.ray.intersectsSphere(cU)&&(uU.copy(i).invert(),dU.copy(e.ray).applyMatrix4(uU),null!==this.boundingBox&&!1===dU.intersectsBox(this.boundingBox)||this._computeIntersections(e,t,dU)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new ZO,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===MI?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===AI?this.bindMatrixInverse.copy(this.bindMatrix).invert():gO("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,i=this.geometry;rU.fromBufferAttribute(i.attributes.skinIndex,e),sU.fromBufferAttribute(i.attributes.skinWeight,e),iU.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const e=sU.getComponent(r);if(0!==e){const i=rU.getComponent(r);oU.multiplyMatrices(n.bones[i].matrixWorld,n.boneInverses[i]),t.addScaledVector(aU.copy(iU).applyMatrix4(oU),e)}}return t.applyMatrix4(this.bindMatrixInverse)}}class fU extends sF{constructor(){super(),this.isBone=!0,this.type="Bone"}}class pU extends QO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(null,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:FI,arguments.length>9&&void 0!==arguments[9]?arguments[9]:FI,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>10?arguments[10]:void 0,arguments.length>11?arguments[11]:void 0),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const mU=new IN,gU=new IN;class vU{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.uuid=wO(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){gO("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new IN)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new IN;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let r=0,s=e.length;r<s;r++){const i=e[r]?e[r].matrixWorld:gU;mU.multiplyMatrices(i,t[r]),mU.toArray(n,16*r)}null!==i&&(i.needsUpdate=!0)}clone(){return new vU(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new pU(t,e,e,lD,$I);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const i=e.bones[n];let r=t[i];void 0===r&&(gO("Skeleton: No bone found with UUID:",i),r=new fU),this.bones.push(r),this.boneInverses.push((new IN).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,r=t.length;i<r;i++){const r=t[i];e.bones.push(r.uuid);const s=n[i];e.boneInverses.push(s.toArray())}return e}}class yU extends FF{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const _U=new IN,bU=new IN,xU=[],SU=new sN,EU=new IN,wU=new hB,TU=new EN;class MU extends hB{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new yU(new Float32Array(16*n),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<n;i++)this.setMatrixAt(i,EU)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new sN),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,_U),SU.copy(e.boundingBox).applyMatrix4(_U),this.boundingBox.union(SU)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new EN),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,_U),TU.copy(e.boundingSphere).applyMatrix4(_U),this.boundingSphere.union(TU)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.morphTexture&&(this.morphTexture=e.morphTexture.clone()),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){const n=t.morphTargetInfluences,i=this.morphTexture.source.data.data,r=e*(n.length+1)+1;for(let s=0;s<n.length;s++)n[s]=i[r+s]}raycast(e,t){const n=this.matrixWorld,i=this.count;if(wU.geometry=this.geometry,wU.material=this.material,void 0!==wU.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),TU.copy(this.boundingSphere),TU.applyMatrix4(n),!1!==e.ray.intersectsSphere(TU)))for(let r=0;r<i;r++){this.getMatrixAt(r,_U),bU.multiplyMatrices(n,_U),wU.matrixWorld=bU,wU.raycast(e,xU);for(let e=0,n=xU.length;e<n;e++){const n=xU[e];n.instanceId=r,n.object=this,t.push(n)}xU.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new yU(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){const n=t.morphTargetInfluences,i=n.length+1;null===this.morphTexture&&(this.morphTexture=new pU(new Float32Array(i*this.count),i,this.count,dD,$I));const r=this.morphTexture.source.data.data;let s=0;for(let l=0;l<n.length;l++)s+=n[l];const a=this.geometry.morphTargetsRelative?1:1-s,o=i*e;r[o]=a,r.set(n,o+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null)}}const AU=new DO,CU=new DO,RU=new NO;class LU{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new DO(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=AU.subVectors(n,t).cross(CU.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(AU),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||RU.getNormalMatrix(e),i=this.coplanarPoint(AU).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const PU=new EN,IU=new PO(.5,.5),DU=new DO;class kU{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new LU,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new LU,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new LU,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new LU,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new LU,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new LU;this.planes=[e,t,n,i,r,s]}set(e,t,n,i,r,s){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(s),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tO,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.planes,r=e.elements,s=r[0],a=r[1],o=r[2],l=r[3],c=r[4],u=r[5],d=r[6],h=r[7],f=r[8],p=r[9],m=r[10],g=r[11],v=r[12],y=r[13],_=r[14],b=r[15];if(i[0].setComponents(l-s,h-c,g-f,b-v).normalize(),i[1].setComponents(l+s,h+c,g+f,b+v).normalize(),i[2].setComponents(l+a,h+u,g+p,b+y).normalize(),i[3].setComponents(l-a,h-u,g-p,b-y).normalize(),n)i[4].setComponents(o,d,m,_).normalize(),i[5].setComponents(l-o,h-d,g-m,b-_).normalize();else if(i[4].setComponents(l-o,h-d,g-m,b-_).normalize(),t===tO)i[5].setComponents(l+o,h+d,g+m,b+_).normalize();else{if(t!==nO)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(o,d,m,_).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),PU.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),PU.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(PU)}intersectsSprite(e){PU.center.set(0,0,0);const t=IU.distanceTo(e.center);return PU.radius=.7071067811865476+t,PU.applyMatrix4(e.matrixWorld),this.intersectsSphere(PU)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let r=0;r<6;r++){if(t[r].distanceToPoint(n)<i)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(DU.x=i.normal.x>0?e.max.x:e.min.x,DU.y=i.normal.y>0?e.max.y:e.min.y,DU.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(DU)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}const OU=new IN,NU=new kU;class FU{constructor(){this.coordinateSystem=tO}intersectsObject(e,t){if(!t.isArrayCamera||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(OU.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),NU.setFromProjectionMatrix(OU,i.coordinateSystem,i.reversedDepth),NU.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(OU.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),NU.setFromProjectionMatrix(OU,i.coordinateSystem,i.reversedDepth),NU.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(OU.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),NU.setFromProjectionMatrix(OU,i.coordinateSystem,i.reversedDepth),NU.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(OU.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),NU.setFromProjectionMatrix(OU,i.coordinateSystem,i.reversedDepth),NU.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(OU.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),NU.setFromProjectionMatrix(OU,i.coordinateSystem,i.reversedDepth),NU.containsPoint(e))return!0}return!1}clone(){return new FU}}function BU(e,t){return e-t}function UU(e,t){return e.z-t.z}function HU(e,t){return t.z-e.z}class zU{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,i){const r=this.pool,s=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const a=r[this.index];s.push(a),this.index++,a.start=e,a.count=t,a.z=n,a.index=i}reset(){this.list.length=0,this.index=0}}const GU=new IN,VU=new wF(1,1,1),WU=new kU,jU=new FU,YU=new sN,XU=new EN,KU=new DO,qU=new DO,JU=new DO,QU=new zU,ZU=new hB,$U=[];function eH(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=t.itemSize;if(e.isInterleavedBufferAttribute||e.array.constructor!==t.array.constructor){const r=e.count;for(let s=0;s<r;s++)for(let r=0;r<i;r++)t.setComponent(s+n,r,e.getComponent(s,r))}else t.array.set(e.array,n*i);t.needsUpdate=!0}function tH(e,t){if(e.constructor!==t.constructor){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++)t[i]=e[i]}else{const n=Math.min(e.length,t.length);t.set(new e.constructor(e.buffer,0,n))}}class nH extends hB{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2*t,i=arguments.length>3?arguments[3]:void 0;super(new eB,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(4*this._maxInstanceCount);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new pU(t,e,e,lD,$I);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new pU(t,e,e,hD,ZI);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new pU(t,e,e,lD,$I);n.colorSpace=zO.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,i=this._maxIndexCount;if(!1===this._geometryInitialized){for(const i in e.attributes){const r=e.getAttribute(i),{array:s,itemSize:a,normalized:o}=r,l=new s.constructor(n*a),c=new FF(l,a,o);t.setAttribute(i,c)}if(null!==e.getIndex()){const e=n>65535?new Uint32Array(i):new Uint16Array(i);t.setIndex(new FF(e,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(Boolean(e.getIndex())!==Boolean(t.getIndex()))throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error('THREE.BatchedMesh: Added geometry missing "'.concat(n,'". All geometries must have consistent attributes.'));const i=e.getAttribute(n),r=t.getAttribute(n);if(i.itemSize!==r.itemSize||i.normalized!==r.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||!1===t[e].active)throw new Error("THREE.BatchedMesh: Invalid instanceId ".concat(e,". Instance is either out of range or has been deleted."))}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||!1===t[e].active)throw new Error("THREE.BatchedMesh: Invalid geometryId ".concat(e,". Geometry is either out of range or has been deleted."))}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new sN);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,i=t.length;n<i;n++){if(!1===t[n].active)continue;const i=t[n].geometryIndex;this.getMatrixAt(n,GU),this.getBoundingBoxAt(i,YU).applyMatrix4(GU),e.union(YU)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new EN);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,i=t.length;n<i;n++){if(!1===t[n].active)continue;const i=t[n].geometryIndex;this.getMatrixAt(n,GU),this.getBoundingSphereAt(i,XU).applyMatrix4(GU),e.union(XU)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&0===this._availableInstanceIds.length)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const t={visible:!0,active:!0,geometryIndex:e};let n=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(BU),n=this._availableInstanceIds.shift(),this._instanceInfo[n]=t):(n=this._instanceInfo.length,this._instanceInfo.push(t));const i=this._matricesTexture;GU.identity().toArray(i.image.data,16*n),i.needsUpdate=!0;const r=this._colorsTexture;return r&&(VU.toArray(r.image.data,4*n),r.needsUpdate=!0),this._visibilityChanged=!0,n}addGeometry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;this._initializeGeometry(e),this._validateGeometry(e);const i={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},r=this._geometryInfo;i.vertexStart=this._nextVertexStart,i.reservedVertexCount=-1===t?e.getAttribute("position").count:t;const s=e.getIndex();if(null!==s&&(i.indexStart=this._nextIndexStart,i.reservedIndexCount=-1===n?s.count:n),-1!==i.indexStart&&i.indexStart+i.reservedIndexCount>this._maxIndexCount||i.vertexStart+i.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let a;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(BU),a=this._availableGeometryIds.shift(),r[a]=i):(a=this._geometryCount,this._geometryCount++,r.push(i)),this.setGeometryAt(a,e),this._nextIndexStart=i.indexStart+i.reservedIndexCount,this._nextVertexStart=i.vertexStart+i.reservedVertexCount,a}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,i=null!==n.getIndex(),r=n.getIndex(),s=t.getIndex(),a=this._geometryInfo[e];if(i&&s.count>a.reservedIndexCount||t.attributes.position.count>a.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const o=a.vertexStart,l=a.reservedVertexCount;a.vertexCount=t.getAttribute("position").count;for(const c in n.attributes){const e=t.getAttribute(c),i=n.getAttribute(c);eH(e,i,o);const r=e.itemSize;for(let t=e.count,n=l;t<n;t++){const e=o+t;for(let t=0;t<r;t++)i.setComponent(e,t,0)}i.needsUpdate=!0,i.addUpdateRange(o*r,l*r)}if(i){const e=a.indexStart,n=a.reservedIndexCount;a.indexCount=t.getIndex().count;for(let t=0;t<s.count;t++)r.setX(e+t,o+s.getX(t));for(let t=s.count,i=n;t<i;t++)r.setX(e+t,o);r.needsUpdate=!0,r.addUpdateRange(e,a.reservedIndexCount)}return a.start=i?a.indexStart:a.vertexStart,a.count=i?a.indexCount:a.vertexCount,a.boundingBox=null,null!==t.boundingBox&&(a.boundingBox=t.boundingBox.clone()),a.boundingSphere=null,null!==t.boundingSphere&&(a.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||!1===t[e].active)return this;const n=this._instanceInfo;for(let i=0,r=n.length;i<r;i++)n[i].active&&n[i].geometryIndex===e&&this.deleteInstance(i);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,i=n.map((e,t)=>t).sort((e,t)=>n[e].vertexStart-n[t].vertexStart),r=this.geometry;for(let s=0,a=n.length;s<a;s++){const a=i[s],o=n[a];if(!1!==o.active){if(null!==r.index){if(o.indexStart!==t){const{indexStart:n,vertexStart:i,reservedIndexCount:s}=o,a=r.index,l=a.array,c=e-i;for(let e=n;e<n+s;e++)l[e]=l[e]+c;a.array.copyWithin(t,n,n+s),a.addUpdateRange(t,s),o.indexStart=t}t+=o.reservedIndexCount}if(o.vertexStart!==e){const{vertexStart:t,reservedVertexCount:n}=o,i=r.attributes;for(const r in i){const s=i[r],{array:a,itemSize:o}=s;a.copyWithin(e*o,t*o,(t+n)*o),s.addUpdateRange(e*o,n*o)}o.vertexStart=e}e+=o.reservedVertexCount,o.start=r.index?o.indexStart:o.vertexStart,this._nextIndexStart=r.index?o.indexStart+o.reservedIndexCount:0,this._nextVertexStart=o.vertexStart+o.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,i=this._geometryInfo[e];if(null===i.boundingBox){const e=new sN,t=n.index,r=n.attributes.position;for(let n=i.start,s=i.start+i.count;n<s;n++){let i=n;t&&(i=t.getX(i)),e.expandByPoint(KU.fromBufferAttribute(r,i))}i.boundingBox=e}return t.copy(i.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,i=this._geometryInfo[e];if(null===i.boundingSphere){const t=new EN;this.getBoundingBoxAt(e,YU),YU.getCenter(t.center);const r=n.index,s=n.attributes.position;let a=0;for(let e=i.start,n=i.start+i.count;e<n;e++){let n=e;r&&(n=r.getX(n)),KU.fromBufferAttribute(s,n),a=Math.max(a,t.center.distanceToSquared(KU))}t.radius=Math.sqrt(a),i.boundingSphere=t}return t.copy(i.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,i=this._matricesTexture.image.data;return t.toArray(i,16*e),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,16*e)}setColorAt(e,t){return this.validateInstanceId(e),null===this._colorsTexture&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,4*e),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,4*e)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t||(this._instanceInfo[e].visible=t,this._visibilityChanged=!0),this}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(BU);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error("BatchedMesh: Instance ids outside the range ".concat(e," are being used. Cannot shrink instance count."));const i=new Int32Array(e),r=new Int32Array(e);tH(this._multiDrawCounts,i),tH(this._multiDrawStarts,r),this._multiDrawCounts=i,this._multiDrawStarts=r,this._maxInstanceCount=e;const s=this._indirectTexture,a=this._matricesTexture,o=this._colorsTexture;s.dispose(),this._initIndirectTexture(),tH(s.image.data,this._indirectTexture.image.data),a.dispose(),this._initMatricesTexture(),tH(a.image.data,this._matricesTexture.image.data),o&&(o.dispose(),this._initColorsTexture(),tH(o.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(e=>e.active);if(Math.max(...n.map(e=>e.vertexStart+e.reservedVertexCount))>e)throw new Error("BatchedMesh: Geometry vertex values are being used outside the range ".concat(t,". Cannot shrink further."));if(this.geometry.index){if(Math.max(...n.map(e=>e.indexStart+e.reservedIndexCount))>t)throw new Error("BatchedMesh: Geometry index values are being used outside the range ".concat(t,". Cannot shrink further."))}const i=this.geometry;i.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new eB,this._initializeGeometry(i));const r=this.geometry;i.index&&tH(i.index.array,r.index.array);for(const s in i.attributes)tH(i.attributes[s].array,r.attributes[s].array)}raycast(e,t){const n=this._instanceInfo,i=this._geometryInfo,r=this.matrixWorld,s=this.geometry;ZU.material=this.material,ZU.geometry.index=s.index,ZU.geometry.attributes=s.attributes,null===ZU.geometry.boundingBox&&(ZU.geometry.boundingBox=new sN),null===ZU.geometry.boundingSphere&&(ZU.geometry.boundingSphere=new EN);for(let a=0,o=n.length;a<o;a++){if(!n[a].visible||!n[a].active)continue;const s=n[a].geometryIndex,o=i[s];ZU.geometry.setDrawRange(o.start,o.count),this.getMatrixAt(a,ZU.matrixWorld).premultiply(r),this.getBoundingBoxAt(s,ZU.geometry.boundingBox),this.getBoundingSphereAt(s,ZU.geometry.boundingSphere),ZU.raycast(e,$U);for(let e=0,n=$U.length;e<n;e++){const n=$U[e];n.object=this,n.batchId=a,t.push(n)}$U.length=0}ZU.material=null,ZU.geometry.index=null,ZU.geometry.attributes={},ZU.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=null!==e.boundingBox?e.boundingBox.clone():null,this.boundingSphere=null!==e.boundingSphere?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(e=>Cr(Cr({},e),{},{boundingBox:null!==e.boundingBox?e.boundingBox.clone():null,boundingSphere:null!==e.boundingSphere?e.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(e=>Cr({},e)),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),null!==this._colorsTexture&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,null!==this._colorsTexture&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,i,r){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const s=i.getIndex(),a=null===s?1:s.array.BYTES_PER_ELEMENT,o=this._instanceInfo,l=this._multiDrawStarts,c=this._multiDrawCounts,u=this._geometryInfo,d=this.perObjectFrustumCulled,h=this._indirectTexture,f=h.image.data,p=n.isArrayCamera?jU:WU;d&&!n.isArrayCamera&&(GU.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),WU.setFromProjectionMatrix(GU,n.coordinateSystem,n.reversedDepth));let m=0;if(this.sortObjects){GU.copy(this.matrixWorld).invert(),KU.setFromMatrixPosition(n.matrixWorld).applyMatrix4(GU),qU.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(GU);for(let i=0,r=o.length;i<r;i++)if(o[i].visible&&o[i].active){const e=o[i].geometryIndex;this.getMatrixAt(i,GU),this.getBoundingSphereAt(e,XU).applyMatrix4(GU);let t=!1;if(d&&(t=!p.intersectsSphere(XU,n)),!t){const t=u[e],n=JU.subVectors(XU.center,KU).dot(qU);QU.push(t.start,t.count,n,i)}}const e=QU.list,t=this.customSort;null===t?e.sort(r.transparent?HU:UU):t.call(this,e,n);for(let n=0,i=e.length;n<i;n++){const t=e[n];l[m]=t.start*a,c[m]=t.count,f[m]=t.index,m++}QU.reset()}else for(let g=0,v=o.length;g<v;g++)if(o[g].visible&&o[g].active){const e=o[g].geometryIndex;let t=!1;if(d&&(this.getMatrixAt(g,GU),this.getBoundingSphereAt(e,XU).applyMatrix4(GU),t=!p.intersectsSphere(XU,n)),!t){const t=u[e];l[m]=t.start*a,c[m]=t.count,f[m]=g,m++}}h.needsUpdate=!0,this._multiDrawCount=m,this._visibilityChanged=!1}onBeforeShadow(e,t,n,i,r,s){this.onBeforeRender(e,null,i,r,s)}}class iH extends AF{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new wF(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const rH=new DO,sH=new DO,aH=new IN,oH=new PN,lH=new EN,cH=new DO,uH=new DO;class dH extends sF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new eB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new iH;super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,i=t.count;e<i;e++)rH.fromBufferAttribute(t,e-1),sH.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=rH.distanceTo(sH);e.setAttribute("lineDistance",new YF(n,1))}else gO("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Line.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),lH.copy(n.boundingSphere),lH.applyMatrix4(i),lH.radius+=r,!1===e.ray.intersectsSphere(lH))return;aH.copy(i).invert(),oH.copy(e.ray).applyMatrix4(aH);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=this.isLineSegments?2:1,c=n.index,u=n.attributes.position;if(null!==c){const n=Math.max(0,s.start),i=Math.min(c.count,s.start+s.count);for(let r=n,s=i-1;r<s;r+=l){const n=c.getX(r),i=c.getX(r+1),s=hH(this,e,oH,o,n,i,r);s&&t.push(s)}if(this.isLineLoop){const r=c.getX(i-1),s=c.getX(n),a=hH(this,e,oH,o,r,s,i-1);a&&t.push(a)}}else{const n=Math.max(0,s.start),i=Math.min(u.count,s.start+s.count);for(let r=n,s=i-1;r<s;r+=l){const n=hH(this,e,oH,o,r,r+1,r);n&&t.push(n)}if(this.isLineLoop){const r=hH(this,e,oH,o,i-1,n,i-1);r&&t.push(r)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function hH(e,t,n,i,r,s,a){const o=e.geometry.attributes.position;rH.fromBufferAttribute(o,r),sH.fromBufferAttribute(o,s);if(n.distanceSqToSegment(rH,sH,cH,uH)>i)return;cH.applyMatrix4(e.matrixWorld);const l=t.ray.origin.distanceTo(cH);return l<t.near||l>t.far?void 0:{distance:l,point:uH.clone().applyMatrix4(e.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:e}}const fH=new DO,pH=new DO;class mH extends dH{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,i=t.count;e<i;e+=2)fH.fromBufferAttribute(t,e),pH.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+fH.distanceTo(pH);e.setAttribute("lineDistance",new YF(n,1))}else gO("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class gH extends dH{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class vH extends AF{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new wF(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const yH=new IN,_H=new PN,bH=new EN,xH=new DO;class SH extends sF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new eB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new vH;super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Points.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),bH.copy(n.boundingSphere),bH.applyMatrix4(i),bH.radius+=r,!1===e.ray.intersectsSphere(bH))return;yH.copy(i).invert(),_H.copy(e.ray).applyMatrix4(yH);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=n.index,c=n.attributes.position;if(null!==l){for(let n=Math.max(0,s.start),r=Math.min(l.count,s.start+s.count);n<r;n++){const r=l.getX(n);xH.fromBufferAttribute(c,r),EH(xH,r,o,i,e,t,this)}}else{for(let n=Math.max(0,s.start),r=Math.min(c.count,s.start+s.count);n<r;n++)xH.fromBufferAttribute(c,n),EH(xH,n,o,i,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function EH(e,t,n,i,r,s,a){const o=_H.distanceSqToPoint(e);if(o<n){const n=new DO;_H.closestPointToPoint(e,n),n.applyMatrix4(i);const l=r.ray.origin.distanceTo(n);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(o),point:n,index:t,face:null,faceIndex:null,barycoord:null,object:a})}}class wH extends QO{constructor(e,t,n,i){super(e,t,n,i,arguments.length>4&&void 0!==arguments[4]?arguments[4]:GI,arguments.length>5&&void 0!==arguments[5]?arguments[5]:GI,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const r=this;"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(function t(){r.needsUpdate=!0,r._requestVideoFrameCallbackId=e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){0!==this._requestVideoFrameCallbackId&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class TH extends wH{constructor(e,t,n,i,r,s,a,o){super({},e,t,n,i,r,s,a,o),this.isVideoFrameTexture=!0}update(){}clone(){return(new this.constructor).copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class MH extends QO{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=FI,this.minFilter=FI,this.generateMipmaps=!1,this.needsUpdate=!0}}class AH extends QO{constructor(e,t,n,i,r,s,a,o,l,c,u,d){super(null,s,a,o,l,c,i,r,u,d),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class CH extends AH{constructor(e,t,n,i,r,s){super(e,t,n,r,s),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=OI,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class RH extends AH{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,RI),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class LH extends QO{constructor(e,t,n,i,r,s,a,o,l){super(e,t,n,i,r,s,a,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class PH extends QO{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ZI,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:FI,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:FI,l=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:cD,u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1;if(c!==cD&&c!==uD)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:e,height:t,depth:u},i,r,s,a,o,c,n,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new XO(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class IH extends QO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class DH extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:i,heightSegments:r},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),i=Math.max(3,Math.floor(i)),r=Math.max(1,Math.floor(r));const s=[],a=[],o=[],l=[],c=t/2,u=Math.PI/2*e,d=t,h=2*u+d,f=2*n+r,p=i+1,m=new DO,g=new DO;for(let v=0;v<=f;v++){let y=0,_=0,b=0,x=0;if(v<=n){const t=v/n,i=t*Math.PI/2;_=-c-e*Math.cos(i),b=e*Math.sin(i),x=-e*Math.cos(i),y=t*u}else if(v<=n+r){const i=(v-n)/r;_=i*t-c,b=e,x=0,y=u+i*d}else{const t=(v-n-r)/n,i=t*Math.PI/2;_=c+e*Math.sin(i),b=e*Math.cos(i),x=e*Math.sin(i),y=u+d+t*u}const S=Math.max(0,Math.min(1,y/h));let E=0;0===v?E=.5/i:v===f&&(E=-.5/i);for(let e=0;e<=i;e++){const t=e/i,n=t*Math.PI*2,r=Math.sin(n),s=Math.cos(n);g.x=-b*s,g.y=_,g.z=b*r,a.push(g.x,g.y,g.z),m.set(-b*s,x,b*r),m.normalize(),o.push(m.x,m.y,m.z),l.push(t+E,S)}if(v>0){const e=(v-1)*p;for(let t=0;t<i;t++){const n=e+t,i=e+t+1,r=v*p+t,a=v*p+t+1;s.push(n,i,r),s.push(i,a,r)}}}this.setIndex(s),this.setAttribute("position",new YF(a,3)),this.setAttribute("normal",new YF(o,3)),this.setAttribute("uv",new YF(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new DH(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class kH extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const r=[],s=[],a=[],o=[],l=new DO,c=new PO;s.push(0,0,0),a.push(0,0,1),o.push(.5,.5);for(let u=0,d=3;u<=t;u++,d+=3){const r=n+u/t*i;l.x=e*Math.cos(r),l.y=e*Math.sin(r),s.push(l.x,l.y,l.z),a.push(0,0,1),c.x=(s[d]/e+1)/2,c.y=(s[d+1]/e+1)/2,o.push(c.x,c.y)}for(let u=1;u<=t;u++)r.push(u,u+1,0);this.setIndex(r),this.setAttribute("position",new YF(s,3)),this.setAttribute("normal",new YF(a,3)),this.setAttribute("uv",new YF(o,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new kH(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class OH extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:o};const l=this;i=Math.floor(i),r=Math.floor(r);const c=[],u=[],d=[],h=[];let f=0;const p=[],m=n/2;let g=0;function v(n){const r=f,s=new PO,p=new DO;let v=0;const y=!0===n?e:t,_=!0===n?1:-1;for(let e=1;e<=i;e++)u.push(0,m*_,0),d.push(0,_,0),h.push(.5,.5),f++;const b=f;for(let e=0;e<=i;e++){const t=e/i*o+a,n=Math.cos(t),r=Math.sin(t);p.x=y*r,p.y=m*_,p.z=y*n,u.push(p.x,p.y,p.z),d.push(0,_,0),s.x=.5*n+.5,s.y=.5*r*_+.5,h.push(s.x,s.y),f++}for(let e=0;e<i;e++){const t=r+e,i=b+e;!0===n?c.push(i,i+1,t):c.push(i+1,i,t),v+=3}l.addGroup(g,v,!0===n?1:2),g+=v}!function(){const s=new DO,v=new DO;let y=0;const _=(t-e)/n;for(let l=0;l<=r;l++){const c=[],g=l/r,y=g*(t-e)+e;for(let e=0;e<=i;e++){const t=e/i,r=t*o+a,l=Math.sin(r),p=Math.cos(r);v.x=y*l,v.y=-g*n+m,v.z=y*p,u.push(v.x,v.y,v.z),s.set(l,_,p).normalize(),d.push(s.x,s.y,s.z),h.push(t,1-g),c.push(f++)}p.push(c)}for(let n=0;n<i;n++)for(let i=0;i<r;i++){const s=p[i][n],a=p[i+1][n],o=p[i+1][n+1],l=p[i][n+1];(e>0||0!==i)&&(c.push(s,a,l),y+=3),(t>0||i!==r-1)&&(c.push(a,o,l),y+=3)}l.addGroup(g,y,0),g+=y}(),!1===s&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new YF(u,3)),this.setAttribute("normal",new YF(d,3)),this.setAttribute("uv",new YF(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new OH(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class NH extends OH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;super(0,e,t,n,i,r,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:s,thetaLength:a}}static fromJSON(e){return new NH(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class FH extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const r=[],s=[];function a(e,t,n,i){const r=i+1,s=[];for(let a=0;a<=r;a++){s[a]=[];const i=e.clone().lerp(n,a/r),o=t.clone().lerp(n,a/r),l=r-a;for(let e=0;e<=l;e++)s[a][e]=0===e&&a===r?i:i.clone().lerp(o,e/l)}for(let a=0;a<r;a++)for(let e=0;e<2*(r-a)-1;e++){const t=Math.floor(e/2);e%2===0?(o(s[a][t+1]),o(s[a+1][t]),o(s[a][t])):(o(s[a][t+1]),o(s[a+1][t+1]),o(s[a+1][t]))}}function o(e){r.push(e.x,e.y,e.z)}function l(t,n){const i=3*t;n.x=e[i+0],n.y=e[i+1],n.z=e[i+2]}function c(e,t,n,i){i<0&&1===e.x&&(s[t]=e.x-1),0===n.x&&0===n.z&&(s[t]=i/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}function d(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}!function(e){const n=new DO,i=new DO,r=new DO;for(let s=0;s<t.length;s+=3)l(t[s+0],n),l(t[s+1],i),l(t[s+2],r),a(n,i,r,e)}(i),function(e){const t=new DO;for(let n=0;n<r.length;n+=3)t.x=r[n+0],t.y=r[n+1],t.z=r[n+2],t.normalize().multiplyScalar(e),r[n+0]=t.x,r[n+1]=t.y,r[n+2]=t.z}(n),function(){const e=new DO;for(let t=0;t<r.length;t+=3){e.x=r[t+0],e.y=r[t+1],e.z=r[t+2];const n=u(e)/2/Math.PI+.5,i=d(e)/Math.PI+.5;s.push(n,1-i)}(function(){const e=new DO,t=new DO,n=new DO,i=new DO,a=new PO,o=new PO,l=new PO;for(let d=0,h=0;d<r.length;d+=9,h+=6){e.set(r[d+0],r[d+1],r[d+2]),t.set(r[d+3],r[d+4],r[d+5]),n.set(r[d+6],r[d+7],r[d+8]),a.set(s[h+0],s[h+1]),o.set(s[h+2],s[h+3]),l.set(s[h+4],s[h+5]),i.copy(e).add(t).add(n).divideScalar(3);const f=u(i);c(a,h+0,e,f),c(o,h+2,t,f),c(l,h+4,n,f)}})(),function(){for(let e=0;e<s.length;e+=6){const t=s[e+0],n=s[e+2],i=s[e+4],r=Math.max(t,n,i),a=Math.min(t,n,i);r>.9&&a<.1&&(t<.2&&(s[e+0]+=1),n<.2&&(s[e+2]+=1),i<.2&&(s[e+4]+=1))}}()}(),this.setAttribute("position",new YF(r,3)),this.setAttribute("normal",new YF(r.slice(),3)),this.setAttribute("uv",new YF(s,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new FH(e.vertices,e.indices,e.radius,e.details)}}class BH extends FH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2,i=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new BH(e.radius,e.detail)}}const UH=new DO,HH=new DO,zH=new DO,GH=new _F;class VH extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const n=4,i=Math.pow(10,n),r=Math.cos(SO*t),s=e.getIndex(),a=e.getAttribute("position"),o=s?s.count:a.count,l=[0,0,0],c=["a","b","c"],u=new Array(3),d={},h=[];for(let e=0;e<o;e+=3){s?(l[0]=s.getX(e),l[1]=s.getX(e+1),l[2]=s.getX(e+2)):(l[0]=e,l[1]=e+1,l[2]=e+2);const{a:t,b:n,c:o}=GH;if(t.fromBufferAttribute(a,l[0]),n.fromBufferAttribute(a,l[1]),o.fromBufferAttribute(a,l[2]),GH.getNormal(zH),u[0]="".concat(Math.round(t.x*i),",").concat(Math.round(t.y*i),",").concat(Math.round(t.z*i)),u[1]="".concat(Math.round(n.x*i),",").concat(Math.round(n.y*i),",").concat(Math.round(n.z*i)),u[2]="".concat(Math.round(o.x*i),",").concat(Math.round(o.y*i),",").concat(Math.round(o.z*i)),u[0]!==u[1]&&u[1]!==u[2]&&u[2]!==u[0])for(let e=0;e<3;e++){const t=(e+1)%3,n=u[e],i=u[t],s=GH[c[e]],a=GH[c[t]],o="".concat(n,"_").concat(i),f="".concat(i,"_").concat(n);f in d&&d[f]?(zH.dot(d[f].normal)<=r&&(h.push(s.x,s.y,s.z),h.push(a.x,a.y,a.z)),d[f]=null):o in d||(d[o]={index0:l[e],index1:l[t],normal:zH.clone()})}}for(const e in d)if(d[e]){const{index0:t,index1:n}=d[e];UH.fromBufferAttribute(a,t),HH.fromBufferAttribute(a,n),h.push(UH.x,UH.y,UH.z),h.push(HH.x,HH.y,HH.z)}this.setAttribute("position",new YF(h,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class WH{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){gO("Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),r=0;t.push(0);for(let s=1;s<=e;s++)n=this.getPoint(s/e),r+=n.distanceTo(i),t.push(r),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getLengths();let i=0;const r=n.length;let s;s=t||e*n[r-1];let a,o=0,l=r-1;for(;o<=l;)if(i=Math.floor(o+(l-o)/2),a=n[i]-s,a<0)o=i+1;else{if(!(a>0)){l=i;break}l=i-1}if(i=l,n[i]===s)return i/(r-1);const c=n[i];return(i+(s-c)/(n[i+1]-c))/(r-1)}getTangent(e,t){const n=1e-4;let i=e-n,r=e+n;i<0&&(i=0),r>1&&(r=1);const s=this.getPoint(i),a=this.getPoint(r),o=t||(s.isVector2?new PO:new DO);return o.copy(a).sub(s).normalize(),o}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new DO,i=[],r=[],s=[],a=new DO,o=new IN;for(let h=0;h<=e;h++){const t=h/e;i[h]=this.getTangentAt(t,new DO)}r[0]=new DO,s[0]=new DO;let l=Number.MAX_VALUE;const c=Math.abs(i[0].x),u=Math.abs(i[0].y),d=Math.abs(i[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),d<=l&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],a),s[0].crossVectors(i[0],r[0]);for(let h=1;h<=e;h++){if(r[h]=r[h-1].clone(),s[h]=s[h-1].clone(),a.crossVectors(i[h-1],i[h]),a.length()>Number.EPSILON){a.normalize();const e=Math.acos(TO(i[h-1].dot(i[h]),-1,1));r[h].applyMatrix4(o.makeRotationAxis(a,e))}s[h].crossVectors(i[h],r[h])}if(!0===t){let t=Math.acos(TO(r[0].dot(r[e]),-1,1));t/=e,i[0].dot(a.crossVectors(r[0],r[e]))>0&&(t=-t);for(let n=1;n<=e;n++)r[n].applyMatrix4(o.makeRotationAxis(i[n],t*n)),s[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class jH extends WH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PO,n=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const r=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=r?0:n),!0!==this.aClockwise||r||(i===n?i=-n:i-=n);const s=this.aStartAngle+e*i;let a=this.aX+this.xRadius*Math.cos(s),o=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=a-this.aX,i=o-this.aY;a=n*e-i*t+this.aX,o=n*t+i*e+this.aY}return t.set(a,o)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class YH extends jH{constructor(e,t,n,i,r,s){super(e,t,n,n,i,r,s),this.isArcCurve=!0,this.type="ArcCurve"}}function XH(){let e=0,t=0,n=0,i=0;function r(r,s,a,o){e=r,t=a,n=-3*r+3*s-2*a-o,i=2*r-2*s+a+o}return{initCatmullRom:function(e,t,n,i,s){r(t,n,s*(n-e),s*(i-t))},initNonuniformCatmullRom:function(e,t,n,i,s,a,o){let l=(t-e)/s-(n-e)/(s+a)+(n-t)/a,c=(n-t)/a-(i-t)/(a+o)+(i-n)/o;l*=a,c*=a,r(t,n,l,c)},calc:function(r){const s=r*r;return e+t*r+n*s+i*(s*r)}}}const KH=new DO,qH=new XH,JH=new XH,QH=new XH;class ZH extends WH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new DO,n=this.points,i=n.length,r=(i-(this.closed?0:1))*e;let s,a,o=Math.floor(r),l=r-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/i)+1)*i:0===l&&o===i-1&&(o=i-2,l=1),this.closed||o>0?s=n[(o-1)%i]:(KH.subVectors(n[0],n[1]).add(n[0]),s=KH);const c=n[o%i],u=n[(o+1)%i];if(this.closed||o+2<i?a=n[(o+2)%i]:(KH.subVectors(n[i-1],n[i-2]).add(n[i-1]),a=KH),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(s.distanceToSquared(c),e),n=Math.pow(c.distanceToSquared(u),e),i=Math.pow(u.distanceToSquared(a),e);n<1e-4&&(n=1),t<1e-4&&(t=n),i<1e-4&&(i=n),qH.initNonuniformCatmullRom(s.x,c.x,u.x,a.x,t,n,i),JH.initNonuniformCatmullRom(s.y,c.y,u.y,a.y,t,n,i),QH.initNonuniformCatmullRom(s.z,c.z,u.z,a.z,t,n,i)}else"catmullrom"===this.curveType&&(qH.initCatmullRom(s.x,c.x,u.x,a.x,this.tension),JH.initCatmullRom(s.y,c.y,u.y,a.y,this.tension),QH.initCatmullRom(s.z,c.z,u.z,a.z,this.tension));return t.set(qH.calc(l),JH.calc(l),QH.calc(l)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new DO).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function $H(e,t,n,i,r){const s=.5*(i-t),a=.5*(r-n),o=e*e;return(2*n-2*i+s+a)*(e*o)+(-3*n+3*i-2*s-a)*o+s*e+n}function ez(e,t,n,i){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,i)}function tz(e,t,n,i,r){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,i)+function(e,t){return e*e*e*t}(e,r)}class nz extends WH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new PO,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PO,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new PO,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new PO;super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PO,n=this.v0,i=this.v1,r=this.v2,s=this.v3;return t.set(tz(e,n.x,i.x,r.x,s.x),tz(e,n.y,i.y,r.y,s.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class iz extends WH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new DO,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new DO,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new DO,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new DO;super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new DO,n=this.v0,i=this.v1,r=this.v2,s=this.v3;return t.set(tz(e,n.x,i.x,r.x,s.x),tz(e,n.y,i.y,r.y,s.y),tz(e,n.z,i.z,r.z,s.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class rz extends WH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new PO,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PO;super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PO;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PO).subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class sz extends WH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new DO,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new DO;super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new DO;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new DO).subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class az extends WH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new PO,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PO,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new PO;super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PO,n=this.v0,i=this.v1,r=this.v2;return t.set(ez(e,n.x,i.x,r.x),ez(e,n.y,i.y,r.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class oz extends WH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new DO,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new DO,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new DO;super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new DO,n=this.v0,i=this.v1,r=this.v2;return t.set(ez(e,n.x,i.x,r.x),ez(e,n.y,i.y,r.y),ez(e,n.z,i.z,r.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class lz extends WH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PO,n=this.points,i=(n.length-1)*e,r=Math.floor(i),s=i-r,a=n[0===r?r:r-1],o=n[r],l=n[r>n.length-2?n.length-1:r+1],c=n[r>n.length-3?n.length-1:r+2];return t.set($H(s,a.x,o.x,l.x,c.x),$H(s,a.y,o.y,l.y,c.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new PO).fromArray(n))}return this}}var cz=Object.freeze({__proto__:null,ArcCurve:YH,CatmullRomCurve3:ZH,CubicBezierCurve:nz,CubicBezierCurve3:iz,EllipseCurve:jH,LineCurve:rz,LineCurve3:sz,QuadraticBezierCurve:az,QuadraticBezierCurve3:oz,SplineCurve:lz});class uz extends WH{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=!0===e.isVector2?"LineCurve":"LineCurve3";this.curves.push(new cz[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let r=0;for(;r<i.length;){if(i[r]>=n){const e=i[r]-n,s=this.curves[r],a=s.getLength(),o=0===a?0:1-e/a;return s.getPointAt(o,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const t=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const s=r[i],a=s.isEllipseCurve?2*e:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,o=s.getPoints(a);for(let e=0;e<o.length;e++){const i=o[e];n&&n.equals(i)||(t.push(i),n=i)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new cz[n.type]).fromJSON(n))}return this}}class dz extends uz{constructor(e){super(),this.type="Path",this.currentPoint=new PO,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new rz(this.currentPoint.clone(),new PO(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const r=new az(this.currentPoint.clone(),new PO(e,t),new PO(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,r,s){const a=new nz(this.currentPoint.clone(),new PO(e,t),new PO(n,i),new PO(r,s));return this.curves.push(a),this.currentPoint.set(r,s),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new lz(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,r,s){const a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+a,t+o,n,i,r,s),this}absarc(e,t,n,i,r,s){return this.absellipse(e,t,n,n,i,r,s),this}ellipse(e,t,n,i,r,s,a,o){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,i,r,s,a,o),this}absellipse(e,t,n,i,r,s,a,o){const l=new jH(e,t,n,i,r,s,a,o);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class hz extends dz{constructor(e){super(e),this.uuid=wO(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new dz).fromJSON(n))}return this}}function fz(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const i=t&&t.length,r=i?t[0]*n:e.length;let s=pz(e,0,r,n,!0);const a=[];if(!s||s.next===s.prev)return a;let o,l,c;if(i&&(s=function(e,t,n,i){const r=[];for(let s=0,a=t.length;s<a;s++){const n=pz(e,t[s]*i,s<a-1?t[s+1]*i:e.length,i,!1);n===n.next&&(n.steiner=!0),r.push(Tz(n))}r.sort(xz);for(let s=0;s<r.length;s++)n=Sz(r[s],n);return n}(e,t,s,n)),e.length>80*n){o=e[0],l=e[1];let t=o,i=l;for(let s=n;s<r;s+=n){const n=e[s],r=e[s+1];n<o&&(o=n),r<l&&(l=r),n>t&&(t=n),r>i&&(i=r)}c=Math.max(t-o,i-l),c=0!==c?32767/c:0}return gz(s,a,n,o,l,c,0),a}function pz(e,t,n,i,r){let s;if(r===function(e,t,n,i){let r=0;for(let s=t,a=n-i;s<n;s+=i)r+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return r}(e,t,n,i)>0)for(let a=t;a<n;a+=i)s=Nz(a/i|0,e[a],e[a+1],s);else for(let a=n-i;a>=t;a-=i)s=Nz(a/i|0,e[a],e[a+1],s);return s&&Lz(s,s.next)&&(Fz(s),s=s.next),s}function mz(e,t){if(!e)return e;t||(t=e);let n,i=e;do{if(n=!1,i.steiner||!Lz(i,i.next)&&0!==Rz(i.prev,i,i.next))i=i.next;else{if(Fz(i),i=t=i.prev,i===i.next)break;n=!0}}while(n||i!==t);return t}function gz(e,t,n,i,r,s,a){if(!e)return;!a&&s&&function(e,t,n,i){let r=e;do{0===r.z&&(r.z=wz(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){let t,n=1;do{let i,r=e;e=null;let s=null;for(t=0;r;){t++;let a=r,o=0;for(let e=0;e<n&&(o++,a=a.nextZ,a);e++);let l=n;for(;o>0||l>0&&a;)0!==o&&(0===l||!a||r.z<=a.z)?(i=r,r=r.nextZ,o--):(i=a,a=a.nextZ,l--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;r=a}s.nextZ=null,n*=2}while(t>1)}(r)}(e,i,r,s);let o=e;for(;e.prev!==e.next;){const l=e.prev,c=e.next;if(s?yz(e,i,r,s):vz(e))t.push(l.i,e.i,c.i),Fz(e),e=c.next,o=c.next;else if((e=c)===o){a?1===a?gz(e=_z(mz(e),t),t,n,i,r,s,2):2===a&&bz(e,t,n,i,r,s):gz(mz(e),t,n,i,r,s,1);break}}}function vz(e){const t=e.prev,n=e,i=e.next;if(Rz(t,n,i)>=0)return!1;const r=t.x,s=n.x,a=i.x,o=t.y,l=n.y,c=i.y,u=Math.min(r,s,a),d=Math.min(o,l,c),h=Math.max(r,s,a),f=Math.max(o,l,c);let p=i.next;for(;p!==t;){if(p.x>=u&&p.x<=h&&p.y>=d&&p.y<=f&&Az(r,o,s,l,a,c,p.x,p.y)&&Rz(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function yz(e,t,n,i){const r=e.prev,s=e,a=e.next;if(Rz(r,s,a)>=0)return!1;const o=r.x,l=s.x,c=a.x,u=r.y,d=s.y,h=a.y,f=Math.min(o,l,c),p=Math.min(u,d,h),m=Math.max(o,l,c),g=Math.max(u,d,h),v=wz(f,p,t,n,i),y=wz(m,g,t,n,i);let _=e.prevZ,b=e.nextZ;for(;_&&_.z>=v&&b&&b.z<=y;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==r&&_!==a&&Az(o,u,l,d,c,h,_.x,_.y)&&Rz(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==r&&b!==a&&Az(o,u,l,d,c,h,b.x,b.y)&&Rz(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;_&&_.z>=v;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==r&&_!==a&&Az(o,u,l,d,c,h,_.x,_.y)&&Rz(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;b&&b.z<=y;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==r&&b!==a&&Az(o,u,l,d,c,h,b.x,b.y)&&Rz(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function _z(e,t){let n=e;do{const i=n.prev,r=n.next.next;!Lz(i,r)&&Pz(i,n,n.next,r)&&kz(i,r)&&kz(r,i)&&(t.push(i.i,n.i,r.i),Fz(n),Fz(n.next),n=e=r),n=n.next}while(n!==e);return mz(n)}function bz(e,t,n,i,r,s){let a=e;do{let e=a.next.next;for(;e!==a.prev;){if(a.i!==e.i&&Cz(a,e)){let o=Oz(a,e);return a=mz(a,a.next),o=mz(o,o.next),gz(a,t,n,i,r,s,0),void gz(o,t,n,i,r,s,0)}e=e.next}a=a.next}while(a!==e)}function xz(e,t){let n=e.x-t.x;if(0===n&&(n=e.y-t.y,0===n)){n=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)}return n}function Sz(e,t){const n=function(e,t){let n=t;const i=e.x,r=e.y;let s,a=-1/0;if(Lz(e,n))return n;do{if(Lz(e,n.next))return n.next;if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const e=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=i&&e>a&&(a=e,s=n.x<n.next.x?n:n.next,e===i))return s}n=n.next}while(n!==t);if(!s)return null;const o=s,l=s.x,c=s.y;let u=1/0;n=s;do{if(i>=n.x&&n.x>=l&&i!==n.x&&Mz(r<c?i:a,r,l,c,r<c?a:i,r,n.x,n.y)){const t=Math.abs(r-n.y)/(i-n.x);kz(n,e)&&(t<u||t===u&&(n.x>s.x||n.x===s.x&&Ez(s,n)))&&(s=n,u=t)}n=n.next}while(n!==o);return s}(e,t);if(!n)return t;const i=Oz(n,e);return mz(i,i.next),mz(n,n.next)}function Ez(e,t){return Rz(e.prev,e,t.prev)<0&&Rz(t.next,e,e.next)<0}function wz(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Tz(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Mz(e,t,n,i,r,s,a,o){return(r-a)*(t-o)>=(e-a)*(s-o)&&(e-a)*(i-o)>=(n-a)*(t-o)&&(n-a)*(s-o)>=(r-a)*(i-o)}function Az(e,t,n,i,r,s,a,o){return!(e===a&&t===o)&&Mz(e,t,n,i,r,s,a,o)}function Cz(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Pz(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(kz(e,t)&&kz(t,e)&&function(e,t){let n=e,i=!1;const r=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!==n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(Rz(e.prev,e,t.prev)||Rz(e,t.prev,t))||Lz(e,t)&&Rz(e.prev,e,e.next)>0&&Rz(t.prev,t,t.next)>0)}function Rz(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Lz(e,t){return e.x===t.x&&e.y===t.y}function Pz(e,t,n,i){const r=Dz(Rz(e,t,n)),s=Dz(Rz(e,t,i)),a=Dz(Rz(n,i,e)),o=Dz(Rz(n,i,t));return r!==s&&a!==o||(!(0!==r||!Iz(e,n,t))||(!(0!==s||!Iz(e,i,t))||(!(0!==a||!Iz(n,e,i))||!(0!==o||!Iz(n,t,i)))))}function Iz(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Dz(e){return e>0?1:e<0?-1:0}function kz(e,t){return Rz(e.prev,e,e.next)<0?Rz(e,t,e.next)>=0&&Rz(e,e.prev,t)>=0:Rz(e,t,e.prev)<0||Rz(e,e.next,t)<0}function Oz(e,t){const n=Bz(e.i,e.x,e.y),i=Bz(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function Nz(e,t,n,i){const r=Bz(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Fz(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Bz(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Uz{static triangulate(e,t){return fz(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:2)}}class Hz{static area(e){const t=e.length;let n=0;for(let i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return.5*n}static isClockWise(e){return Hz.area(e)<0}static triangulateShape(e,t){const n=[],i=[],r=[];zz(e),Gz(n,e);let s=e.length;t.forEach(zz);for(let o=0;o<t.length;o++)i.push(s),s+=t[o].length,Gz(n,t[o]);const a=Uz.triangulate(n,i);for(let o=0;o<a.length;o+=3)r.push(a.slice(o,o+3));return r}}function zz(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Gz(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}class Vz extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new hz([new PO(.5,.5),new PO(-.5,.5),new PO(-.5,-.5),new PO(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],r=[];for(let a=0,o=e.length;a<o;a++){s(e[a])}function s(e){const s=[],a=void 0!==t.curveSegments?t.curveSegments:12,o=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:1;let c=void 0===t.bevelEnabled||t.bevelEnabled,u=void 0!==t.bevelThickness?t.bevelThickness:.2,d=void 0!==t.bevelSize?t.bevelSize:u-.1,h=void 0!==t.bevelOffset?t.bevelOffset:0,f=void 0!==t.bevelSegments?t.bevelSegments:3;const p=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:Wz;let g,v,y,_,b,x=!1;p&&(g=p.getSpacedPoints(o),x=!0,c=!1,v=p.computeFrenetFrames(o,!1),y=new DO,_=new DO,b=new DO),c||(f=0,u=0,d=0,h=0);const S=e.extractPoints(a);let E=S.shape;const w=S.holes;if(!Hz.isClockWise(E)){E=E.reverse();for(let e=0,t=w.length;e<t;e++){const t=w[e];Hz.isClockWise(t)&&(w[e]=t.reverse())}}function T(e){const t=1e-10*1e-10;let n=e[0];for(let i=1;i<=e.length;i++){const r=i%e.length,s=e[r],a=s.x-n.x,o=s.y-n.y,l=a*a+o*o,c=Math.max(Math.abs(s.x),Math.abs(s.y),Math.abs(n.x),Math.abs(n.y));l<=t*c*c?(e.splice(r,1),i--):n=s}}T(E),w.forEach(T);const M=w.length,A=E;for(let t=0;t<M;t++){const e=w[t];E=E.concat(e)}function C(e,t,n){return t||vO("ExtrudeGeometry: vec does not exist"),e.clone().addScaledVector(t,n)}const R=E.length;function L(e,t,n){let i,r,s;const a=e.x-t.x,o=e.y-t.y,l=n.x-e.x,c=n.y-e.y,u=a*a+o*o,d=a*c-o*l;if(Math.abs(d)>Number.EPSILON){const d=Math.sqrt(u),h=Math.sqrt(l*l+c*c),f=t.x-o/d,p=t.y+a/d,m=((n.x-c/h-f)*c-(n.y+l/h-p)*l)/(a*c-o*l);i=f+a*m-e.x,r=p+o*m-e.y;const g=i*i+r*r;if(g<=2)return new PO(i,r);s=Math.sqrt(g/2)}else{let e=!1;a>Number.EPSILON?l>Number.EPSILON&&(e=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(o)===Math.sign(c)&&(e=!0),e?(i=-o,r=a,s=Math.sqrt(u)):(i=a,r=o,s=Math.sqrt(u/2))}return new PO(i/s,r/s)}const P=[];for(let t=0,n=A.length,i=n-1,r=t+1;t<n;t++,i++,r++)i===n&&(i=0),r===n&&(r=0),P[t]=L(A[t],A[i],A[r]);const I=[];let D,k,O=P.concat();for(let t=0,n=M;t<n;t++){const e=w[t];D=[];for(let t=0,n=e.length,i=n-1,r=t+1;t<n;t++,i++,r++)i===n&&(i=0),r===n&&(r=0),D[t]=L(e[t],e[i],e[r]);I.push(D),O=O.concat(D)}if(0===f)k=Hz.triangulateShape(A,w);else{const e=[],t=[];for(let n=0;n<f;n++){const i=n/f,r=u*Math.cos(i*Math.PI/2),s=d*Math.sin(i*Math.PI/2)+h;for(let t=0,n=A.length;t<n;t++){const n=C(A[t],P[t],s);U(n.x,n.y,-r),0===i&&e.push(n)}for(let e=0,n=M;e<n;e++){const n=w[e];D=I[e];const a=[];for(let e=0,t=n.length;e<t;e++){const t=C(n[e],D[e],s);U(t.x,t.y,-r),0===i&&a.push(t)}0===i&&t.push(a)}}k=Hz.triangulateShape(e,t)}const N=k.length,F=d+h;for(let t=0;t<R;t++){const e=c?C(E[t],O[t],F):E[t];x?(_.copy(v.normals[0]).multiplyScalar(e.x),y.copy(v.binormals[0]).multiplyScalar(e.y),b.copy(g[0]).add(_).add(y),U(b.x,b.y,b.z)):U(e.x,e.y,0)}for(let t=1;t<=o;t++)for(let e=0;e<R;e++){const n=c?C(E[e],O[e],F):E[e];x?(_.copy(v.normals[t]).multiplyScalar(n.x),y.copy(v.binormals[t]).multiplyScalar(n.y),b.copy(g[t]).add(_).add(y),U(b.x,b.y,b.z)):U(n.x,n.y,l/o*t)}for(let t=f-1;t>=0;t--){const e=t/f,n=u*Math.cos(e*Math.PI/2),i=d*Math.sin(e*Math.PI/2)+h;for(let t=0,r=A.length;t<r;t++){const e=C(A[t],P[t],i);U(e.x,e.y,l+n)}for(let t=0,r=w.length;t<r;t++){const e=w[t];D=I[t];for(let t=0,r=e.length;t<r;t++){const r=C(e[t],D[t],i);x?U(r.x,r.y+g[o-1].y,g[o-1].x+n):U(r.x,r.y,l+n)}}}function B(e,t){let n=e.length;for(;--n>=0;){const i=n;let r=n-1;r<0&&(r=e.length-1);for(let e=0,n=o+2*f;e<n;e++){const n=R*e,s=R*(e+1);z(t+i+n,t+r+n,t+r+s,t+i+s)}}}function U(e,t,n){s.push(e),s.push(t),s.push(n)}function H(e,t,r){G(e),G(t),G(r);const s=i.length/3,a=m.generateTopUV(n,i,s-3,s-2,s-1);V(a[0]),V(a[1]),V(a[2])}function z(e,t,r,s){G(e),G(t),G(s),G(t),G(r),G(s);const a=i.length/3,o=m.generateSideWallUV(n,i,a-6,a-3,a-2,a-1);V(o[0]),V(o[1]),V(o[3]),V(o[1]),V(o[2]),V(o[3])}function G(e){i.push(s[3*e+0]),i.push(s[3*e+1]),i.push(s[3*e+2])}function V(e){r.push(e.x),r.push(e.y)}!function(){const e=i.length/3;if(c){let e=0,t=R*e;for(let n=0;n<N;n++){const e=k[n];H(e[2]+t,e[1]+t,e[0]+t)}e=o+2*f,t=R*e;for(let n=0;n<N;n++){const e=k[n];H(e[0]+t,e[1]+t,e[2]+t)}}else{for(let e=0;e<N;e++){const t=k[e];H(t[2],t[1],t[0])}for(let e=0;e<N;e++){const t=k[e];H(t[0]+R*o,t[1]+R*o,t[2]+R*o)}}n.addGroup(e,i.length/3-e,0)}(),function(){const e=i.length/3;let t=0;B(A,t),t+=A.length;for(let n=0,i=w.length;n<i;n++){const e=w[n];B(e,t),t+=e.length}n.addGroup(e,i.length/3-e,1)}()}this.setAttribute("position",new YF(i,3)),this.setAttribute("uv",new YF(r,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(let i=0,r=e.length;i<r;i++){const t=e[i];n.shapes.push(t.uuid)}else n.shapes.push(e.uuid);n.options=Object.assign({},t),void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const i=t[e.shapes[r]];n.push(i)}const i=e.options.extrudePath;return void 0!==i&&(e.options.extrudePath=(new cz[i.type]).fromJSON(i)),new Vz(n,e.options)}}const Wz={generateTopUV:function(e,t,n,i,r){const s=t[3*n],a=t[3*n+1],o=t[3*i],l=t[3*i+1],c=t[3*r],u=t[3*r+1];return[new PO(s,a),new PO(o,l),new PO(c,u)]},generateSideWallUV:function(e,t,n,i,r,s){const a=t[3*n],o=t[3*n+1],l=t[3*n+2],c=t[3*i],u=t[3*i+1],d=t[3*i+2],h=t[3*r],f=t[3*r+1],p=t[3*r+2],m=t[3*s],g=t[3*s+1],v=t[3*s+2];return Math.abs(o-u)<Math.abs(a-c)?[new PO(a,1-l),new PO(c,1-d),new PO(h,1-p),new PO(m,1-v)]:[new PO(o,1-l),new PO(u,1-d),new PO(f,1-p),new PO(g,1-v)]}};class jz extends FH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new jz(e.radius,e.detail)}}class Yz extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new PO(0,-.5),new PO(.5,0),new PO(0,.5)],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=TO(i,0,2*Math.PI);const r=[],s=[],a=[],o=[],l=[],c=1/t,u=new DO,d=new PO,h=new DO,f=new DO,p=new DO;let m=0,g=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,h.x=1*g,h.y=-m,h.z=0*g,p.copy(h),h.normalize(),o.push(h.x,h.y,h.z);break;case e.length-1:o.push(p.x,p.y,p.z);break;default:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,h.x=1*g,h.y=-m,h.z=0*g,f.copy(h),h.x+=p.x,h.y+=p.y,h.z+=p.z,h.normalize(),o.push(h.x,h.y,h.z),p.copy(f)}for(let v=0;v<=t;v++){const r=n+v*c*i,h=Math.sin(r),f=Math.cos(r);for(let n=0;n<=e.length-1;n++){u.x=e[n].x*h,u.y=e[n].y,u.z=e[n].x*f,s.push(u.x,u.y,u.z),d.x=v/t,d.y=n/(e.length-1),a.push(d.x,d.y);const i=o[3*n+0]*h,r=o[3*n+1],c=o[3*n+0]*f;l.push(i,r,c)}}for(let v=0;v<t;v++)for(let t=0;t<e.length-1;t++){const n=t+v*e.length,i=n,s=n+e.length,a=n+e.length+1,o=n+1;r.push(i,s,o),r.push(a,o,s)}this.setIndex(r),this.setAttribute("position",new YF(s,3)),this.setAttribute("uv",new YF(a,2)),this.setAttribute("normal",new YF(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Yz(e.points,e.segments,e.phiStart,e.phiLength)}}class Xz extends FH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Xz(e.radius,e.detail)}}class Kz extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const r=e/2,s=t/2,a=Math.floor(n),o=Math.floor(i),l=a+1,c=o+1,u=e/a,d=t/o,h=[],f=[],p=[],m=[];for(let g=0;g<c;g++){const e=g*d-s;for(let t=0;t<l;t++){const n=t*u-r;f.push(n,-e,0),p.push(0,0,1),m.push(t/a),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let e=0;e<a;e++){const t=e+l*g,n=e+l*(g+1),i=e+1+l*(g+1),r=e+1+l*g;h.push(t,n,r),h.push(n,i,r)}this.setIndex(h),this.setAttribute("position",new YF(f,3)),this.setAttribute("normal",new YF(p,3)),this.setAttribute("uv",new YF(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Kz(e.width,e.height,e.widthSegments,e.heightSegments)}}class qz extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:s},n=Math.max(3,n),i=Math.max(1,i);const a=[],o=[],l=[],c=[];let u=e;const d=(t-e)/i,h=new DO,f=new PO;for(let p=0;p<=i;p++){for(let e=0;e<=n;e++){const i=r+e/n*s;h.x=u*Math.cos(i),h.y=u*Math.sin(i),o.push(h.x,h.y,h.z),l.push(0,0,1),f.x=(h.x/t+1)/2,f.y=(h.y/t+1)/2,c.push(f.x,f.y)}u+=d}for(let p=0;p<i;p++){const e=p*(n+1);for(let t=0;t<n;t++){const i=t+e,r=i,s=i+n+1,o=i+n+2,l=i+1;a.push(r,s,l),a.push(s,o,l)}}this.setIndex(a),this.setAttribute("position",new YF(o,3)),this.setAttribute("normal",new YF(l,3)),this.setAttribute("uv",new YF(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new qz(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Jz extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new hz([new PO(0,.5),new PO(-.5,-.5),new PO(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],r=[],s=[];let a=0,o=0;if(!1===Array.isArray(e))l(e);else for(let c=0;c<e.length;c++)l(e[c]),this.addGroup(a,o,c),a+=o,o=0;function l(e){const a=i.length/3,l=e.extractPoints(t);let c=l.shape;const u=l.holes;!1===Hz.isClockWise(c)&&(c=c.reverse());for(let t=0,n=u.length;t<n;t++){const e=u[t];!0===Hz.isClockWise(e)&&(u[t]=e.reverse())}const d=Hz.triangulateShape(c,u);for(let t=0,n=u.length;t<n;t++){const e=u[t];c=c.concat(e)}for(let t=0,n=c.length;t<n;t++){const e=c[t];i.push(e.x,e.y,0),r.push(0,0,1),s.push(e.x,e.y)}for(let t=0,i=d.length;t<i;t++){const e=d[t],i=e[0]+a,r=e[1]+a,s=e[2]+a;n.push(i,r,s),o+=3}}this.setIndex(n),this.setAttribute("position",new YF(i,3)),this.setAttribute("normal",new YF(r,3)),this.setAttribute("uv",new YF(s,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,i=e.length;n<i;n++){const i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let i=0,r=e.shapes.length;i<r;i++){const r=t[e.shapes[i]];n.push(r)}return new Jz(n,e.curveSegments)}}class Qz extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const o=Math.min(s+a,Math.PI);let l=0;const c=[],u=new DO,d=new DO,h=[],f=[],p=[],m=[];for(let g=0;g<=n;g++){const h=[],v=g/n;let y=0;0===g&&0===s?y=.5/t:g===n&&o===Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const o=n/t;u.x=-e*Math.cos(i+o*r)*Math.sin(s+v*a),u.y=e*Math.cos(s+v*a),u.z=e*Math.sin(i+o*r)*Math.sin(s+v*a),f.push(u.x,u.y,u.z),d.copy(u).normalize(),p.push(d.x,d.y,d.z),m.push(o+y,1-v),h.push(l++)}c.push(h)}for(let g=0;g<n;g++)for(let e=0;e<t;e++){const t=c[g][e+1],i=c[g][e],r=c[g+1][e],a=c[g+1][e+1];(0!==g||s>0)&&h.push(t,i,a),(g!==n-1||o<Math.PI)&&h.push(i,r,a)}this.setIndex(h),this.setAttribute("position",new YF(f,3)),this.setAttribute("normal",new YF(p,3)),this.setAttribute("uv",new YF(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Qz(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Zz extends FH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Zz(e.radius,e.detail)}}class $z extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:48,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},n=Math.floor(n),i=Math.floor(i);const s=[],a=[],o=[],l=[],c=new DO,u=new DO,d=new DO;for(let h=0;h<=n;h++)for(let s=0;s<=i;s++){const f=s/i*r,p=h/n*Math.PI*2;u.x=(e+t*Math.cos(p))*Math.cos(f),u.y=(e+t*Math.cos(p))*Math.sin(f),u.z=t*Math.sin(p),a.push(u.x,u.y,u.z),c.x=e*Math.cos(f),c.y=e*Math.sin(f),d.subVectors(u,c).normalize(),o.push(d.x,d.y,d.z),l.push(s/i),l.push(h/n)}for(let h=1;h<=n;h++)for(let e=1;e<=i;e++){const t=(i+1)*h+e-1,n=(i+1)*(h-1)+e-1,r=(i+1)*(h-1)+e,a=(i+1)*h+e;s.push(t,n,a),s.push(n,r,a)}this.setIndex(s),this.setAttribute("position",new YF(a,3)),this.setAttribute("normal",new YF(o,3)),this.setAttribute("uv",new YF(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $z(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class eG extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:s},n=Math.floor(n),i=Math.floor(i);const a=[],o=[],l=[],c=[],u=new DO,d=new DO,h=new DO,f=new DO,p=new DO,m=new DO,g=new DO;for(let y=0;y<=n;++y){const a=y/n*r*Math.PI*2;v(a,r,s,e,h),v(a+.01,r,s,e,f),m.subVectors(f,h),g.addVectors(f,h),p.crossVectors(m,g),g.crossVectors(p,m),p.normalize(),g.normalize();for(let e=0;e<=i;++e){const r=e/i*Math.PI*2,s=-t*Math.cos(r),a=t*Math.sin(r);u.x=h.x+(s*g.x+a*p.x),u.y=h.y+(s*g.y+a*p.y),u.z=h.z+(s*g.z+a*p.z),o.push(u.x,u.y,u.z),d.subVectors(u,h).normalize(),l.push(d.x,d.y,d.z),c.push(y/n),c.push(e/i)}}for(let y=1;y<=n;y++)for(let e=1;e<=i;e++){const t=(i+1)*(y-1)+(e-1),n=(i+1)*y+(e-1),r=(i+1)*y+e,s=(i+1)*(y-1)+e;a.push(t,n,s),a.push(n,r,s)}function v(e,t,n,i,r){const s=Math.cos(e),a=Math.sin(e),o=n/t*e,l=Math.cos(o);r.x=i*(2+l)*.5*s,r.y=i*(2+l)*a*.5,r.z=i*Math.sin(o)*.5}this.setIndex(a),this.setAttribute("position",new YF(o,3)),this.setAttribute("normal",new YF(l,3)),this.setAttribute("uv",new YF(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new eG(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class tG extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new oz(new DO(-1,-1,0),new DO(-1,1,0),new DO(1,1,0)),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r};const s=e.computeFrenetFrames(t,r);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;const a=new DO,o=new DO,l=new PO;let c=new DO;const u=[],d=[],h=[],f=[];function p(r){c=e.getPointAt(r/t,c);const l=s.normals[r],h=s.binormals[r];for(let e=0;e<=i;e++){const t=e/i*Math.PI*2,r=Math.sin(t),s=-Math.cos(t);o.x=s*l.x+r*h.x,o.y=s*l.y+r*h.y,o.z=s*l.z+r*h.z,o.normalize(),d.push(o.x,o.y,o.z),a.x=c.x+n*o.x,a.y=c.y+n*o.y,a.z=c.z+n*o.z,u.push(a.x,a.y,a.z)}}!function(){for(let e=0;e<t;e++)p(e);p(!1===r?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=i;n++)l.x=e/t,l.y=n/i,h.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=i;t++){const n=(i+1)*(e-1)+(t-1),r=(i+1)*e+(t-1),s=(i+1)*e+t,a=(i+1)*(e-1)+t;f.push(n,r,a),f.push(r,s,a)}}()}(),this.setIndex(f),this.setAttribute("position",new YF(u,3)),this.setAttribute("normal",new YF(d,3)),this.setAttribute("uv",new YF(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new tG((new cz[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class nG extends eB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,i=new DO,r=new DO;if(null!==e.index){const s=e.attributes.position,a=e.index;let o=e.groups;0===o.length&&(o=[{start:0,count:a.count,materialIndex:0}]);for(let e=0,l=o.length;e<l;++e){const l=o[e],c=l.start;for(let e=c,o=c+l.count;e<o;e+=3)for(let l=0;l<3;l++){const o=a.getX(e+l),c=a.getX(e+(l+1)%3);i.fromBufferAttribute(s,o),r.fromBufferAttribute(s,c),!0===iG(i,r,n)&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}}else{const s=e.attributes.position;for(let e=0,a=s.count/3;e<a;e++)for(let o=0;o<3;o++){const a=3*e+o,l=3*e+(o+1)%3;i.fromBufferAttribute(s,a),r.fromBufferAttribute(s,l),!0===iG(i,r,n)&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new YF(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function iG(e,t,n){const i="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),r="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==n.has(i)&&!0!==n.has(r)&&(n.add(i),n.add(r),!0)}var rG=Object.freeze({__proto__:null,BoxGeometry:pB,CapsuleGeometry:DH,CircleGeometry:kH,ConeGeometry:NH,CylinderGeometry:OH,DodecahedronGeometry:BH,EdgesGeometry:VH,ExtrudeGeometry:Vz,IcosahedronGeometry:jz,LatheGeometry:Yz,OctahedronGeometry:Xz,PlaneGeometry:Kz,PolyhedronGeometry:FH,RingGeometry:qz,ShapeGeometry:Jz,SphereGeometry:Qz,TetrahedronGeometry:Zz,TorusGeometry:$z,TorusKnotGeometry:eG,TubeGeometry:tG,WireframeGeometry:nG});class sG extends AF{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new wF(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class aG extends _B{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class oG extends AF{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new wF(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wF(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fk,this.normalScale=new PO(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new GN,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class lG extends oG{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new PO(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return TO(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new wF(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new wF(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new wF(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!==e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!==e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!==e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!==e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!==e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!==e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class cG extends AF{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new wF(16777215),this.specular=new wF(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wF(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fk,this.normalScale=new PO(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new GN,this.combine=mI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class uG extends AF{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new wF(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wF(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fk,this.normalScale=new PO(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class dG extends AF{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fk,this.normalScale=new PO(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class hG extends AF{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new wF(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wF(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fk,this.normalScale=new PO(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new GN,this.combine=mI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class fG extends AF{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=ck,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class pG extends AF{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class mG extends AF{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new wF(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=fk,this.normalScale=new PO(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class gG extends iH{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function vG(e,t){return e&&e.constructor!==t?"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e}function yG(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function _G(e){const t=e.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort(function(t,n){return e[t]-e[n]}),n}function bG(e,t,n){const i=e.length,r=new e.constructor(i);for(let s=0,a=0;a!==i;++s){const i=n[s]*t;for(let n=0;n!==t;++n)r[a++]=e[i+n]}return r}function xG(e,t,n,i){let r=1,s=e[0];for(;void 0!==s&&void 0===s[i];)s=e[r++];if(void 0===s)return;let a=s[i];if(void 0!==a)if(Array.isArray(a))do{a=s[i],void 0!==a&&(t.push(s.time),n.push(...a)),s=e[r++]}while(void 0!==s);else if(void 0!==a.toArray)do{a=s[i],void 0!==a&&(t.push(s.time),a.toArray(n,n.length)),s=e[r++]}while(void 0!==s);else do{a=s[i],void 0!==a&&(t.push(s.time),n.push(a)),s=e[r++]}while(void 0!==s)}class SG{static convertArray(e,t){return vG(e,t)}static isTypedArray(e){return yG(e)}static getKeyframeOrder(e){return _G(e)}static sortedArray(e,t,n){return bG(e,t,n)}static flattenJSON(e,t,n,i){xG(e,t,n,i)}static subclip(e,t,n,i){return function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30;const s=e.clone();s.name=t;const a=[];for(let l=0;l<s.tracks.length;++l){const e=s.tracks[l],t=e.getValueSize(),o=[],c=[];for(let s=0;s<e.times.length;++s){const a=e.times[s]*r;if(!(a<n||a>=i)){o.push(e.times[s]);for(let n=0;n<t;++n)c.push(e.values[s*t+n])}}0!==o.length&&(e.times=vG(o,e.times.constructor),e.values=vG(c,e.values.constructor),a.push(e))}s.tracks=a;let o=1/0;for(let l=0;l<s.tracks.length;++l)o>s.tracks[l].times[0]&&(o=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*o);return s.resetDuration(),s}(e,t,n,i,arguments.length>4&&void 0!==arguments[4]?arguments[4]:30)}static makeClipAdditive(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;i<=0&&(i=30);const r=n.tracks.length,s=t/i;for(let a=0;a<r;++a){const t=n.tracks[a],i=t.ValueTypeName;if("bool"===i||"string"===i)continue;const r=e.tracks.find(function(e){return e.name===t.name&&e.ValueTypeName===i});if(void 0===r)continue;let o=0;const l=t.getValueSize();t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(o=l/3);let c=0;const u=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const d=t.times.length-1;let h;if(s<=t.times[0]){const e=o,n=l-o;h=t.values.slice(e,n)}else if(s>=t.times[d]){const e=d*l+o,n=e+l-o;h=t.values.slice(e,n)}else{const e=t.createInterpolant(),n=o,i=l-o;e.evaluate(s),h=e.resultBuffer.slice(n,i)}"quaternion"===i&&(new IO).fromArray(h).normalize().conjugate().toArray(h);const f=r.times.length;for(let e=0;e<f;++e){const t=e*u+c;if("quaternion"===i)IO.multiplyQuaternionsFlat(r.values,t,h,0,r.values,t);else{const e=u-2*c;for(let n=0;n<e;++n)r.values[t+n]-=h[n]}}}return e.blendMode=sk,e}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:30)}}class EG{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let s;n:{i:if(!(e<i)){for(let s=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(r=i,i=t[++n],e<i)break t}s=t.length;break n}if(!(e>=r)){const a=t[1];e<a&&(n=2,r=a);for(let s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(n===s)break;if(i=r,r=t[--n-1],e>=r)break t}s=n,n=0;break n}break e}for(;n<s;){const i=n+s>>>1;e<t[i]?s=i:n=i+1}if(i=t[n],r=t[n-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let s=0;s!==i;++s)t[s]=n[r+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class wG extends EG{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:tk,endingEnd:tk}}intervalChanged_(e,t,n){const i=this.parameterPositions;let r=e-2,s=e+1,a=i[r],o=i[s];if(void 0===a)switch(this.getSettings_().endingStart){case nk:r=e,a=2*t-n;break;case ik:r=i.length-2,a=t+i[r]-i[r+1];break;default:r=e,a=n}if(void 0===o)switch(this.getSettings_().endingEnd){case nk:s=e,o=2*n-t;break;case ik:s=1,o=n+i[1]-i[0];break;default:s=e-1,o=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-n),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=this._offsetPrev,u=this._offsetNext,d=this._weightPrev,h=this._weightNext,f=(n-t)/(i-t),p=f*f,m=p*f,g=-d*m+2*d*p-d*f,v=(1+d)*m+(-1.5-2*d)*p+(-.5+d)*f+1,y=(-1-h)*m+(1.5+h)*p+.5*f,_=h*m-h*p;for(let b=0;b!==a;++b)r[b]=g*s[c+b]+v*s[l+b]+y*s[o+b]+_*s[u+b];return r}}class TG extends EG{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=(n-t)/(i-t),u=1-c;for(let d=0;d!==a;++d)r[d]=s[l+d]*u+s[o+d]*c;return r}}class MG extends EG{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class AG{constructor(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=vG(t,this.TimeBufferType),this.values=vG(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:vG(e.times,Array),values:vG(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new MG(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new TG(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new wG(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case ZD:t=this.InterpolantFactoryMethodDiscrete;break;case $D:t=this.InterpolantFactoryMethodLinear;break;case ek:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return gO("KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ZD;case this.InterpolantFactoryMethodLinear:return $D;case this.InterpolantFactoryMethodSmooth:return ek}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let r=0,s=i-1;for(;r!==i&&n[r]<e;)++r;for(;-1!==s&&n[s]>t;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);const e=this.getValueSize();this.times=n.slice(r,s),this.values=this.values.slice(r*e,s*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(vO("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,r=n.length;0===r&&(vO("KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==r;a++){const t=n[a];if("number"===typeof t&&isNaN(t)){vO("KeyframeTrack: Time is not a valid number.",this,a,t),e=!1;break}if(null!==s&&s>t){vO("KeyframeTrack: Out of order keys.",this,a,t,s),e=!1;break}s=t}if(void 0!==i&&yG(i))for(let a=0,o=i.length;a!==o;++a){const t=i[a];if(isNaN(t)){vO("KeyframeTrack: Value is not a valid number.",this,a,t),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===ek,r=e.length-1;let s=1;for(let a=1;a<r;++a){let r=!1;const o=e[a];if(o!==e[a+1]&&(1!==a||o!==e[0]))if(i)r=!0;else{const e=a*n,i=e-n,s=e+n;for(let a=0;a!==n;++a){const n=t[e+a];if(n!==t[i+a]||n!==t[s+a]){r=!0;break}}}if(r){if(a!==s){e[s]=e[a];const i=a*n,r=s*n;for(let e=0;e!==n;++e)t[r+e]=t[i+e]}++s}}if(r>0){e[s]=e[r];for(let e=r*n,i=s*n,a=0;a!==n;++a)t[i+a]=t[e+a];++s}return s!==e.length?(this.times=e.slice(0,s),this.values=t.slice(0,s*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}AG.prototype.ValueTypeName="",AG.prototype.TimeBufferType=Float32Array,AG.prototype.ValueBufferType=Float32Array,AG.prototype.DefaultInterpolation=$D;class CG extends AG{constructor(e,t,n){super(e,t,n)}}CG.prototype.ValueTypeName="bool",CG.prototype.ValueBufferType=Array,CG.prototype.DefaultInterpolation=ZD,CG.prototype.InterpolantFactoryMethodLinear=void 0,CG.prototype.InterpolantFactoryMethodSmooth=void 0;class RG extends AG{constructor(e,t,n,i){super(e,t,n,i)}}RG.prototype.ValueTypeName="color";class LG extends AG{constructor(e,t,n,i){super(e,t,n,i)}}LG.prototype.ValueTypeName="number";class PG extends EG{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(n-t)/(i-t);let l=e*a;for(let c=l+a;l!==c;l+=4)IO.slerpFlat(r,0,s,l-a,s,l,o);return r}}class IG extends AG{constructor(e,t,n,i){super(e,t,n,i)}InterpolantFactoryMethodLinear(e){return new PG(this.times,this.values,this.getValueSize(),e)}}IG.prototype.ValueTypeName="quaternion",IG.prototype.InterpolantFactoryMethodSmooth=void 0;class DG extends AG{constructor(e,t,n){super(e,t,n)}}DG.prototype.ValueTypeName="string",DG.prototype.ValueBufferType=Array,DG.prototype.DefaultInterpolation=ZD,DG.prototype.InterpolantFactoryMethodLinear=void 0,DG.prototype.InterpolantFactoryMethodSmooth=void 0;class kG extends AG{constructor(e,t,n,i){super(e,t,n,i)}}kG.prototype.ValueTypeName="vector";class OG{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rk;this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=wO(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let s=0,a=n.length;s!==a;++s)t.push(NG(n[s]).scale(i));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r.userData=JSON.parse(e.userData||"{}"),r}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let r=0,s=n.length;r!==s;++r)t.push(AG.toJSON(n[r]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const r=t.length,s=[];for(let a=0;a<r;a++){let e=[],o=[];e.push((a+r-1)%r,a,(a+1)%r),o.push(0,1,0);const l=_G(e);e=bG(e,1,l),o=bG(o,1,l),i||0!==e[0]||(e.push(r),o.push(o[0])),s.push(new LG(".morphTargetInfluences["+t[a].name+"]",e,o).scale(1/n))}return new this(e,-1,s)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let a=0,o=e.length;a<o;a++){const t=e[a],n=t.name.match(r);if(n&&n.length>1){const e=n[1];let r=i[e];r||(i[e]=r=[]),r.push(t)}}const s=[];for(const a in i)s.push(this.CreateFromMorphTargetSequence(a,i[a],t,n));return s}static parseAnimation(e,t){if(gO("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return vO("AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,i,r){if(0!==n.length){const s=[],a=[];xG(n,s,a,i),0!==s.length&&r.push(new e(t,s,a))}},i=[],r=e.name||"default",s=e.fps||30,a=e.blendMode;let o=e.length||-1;const l=e.hierarchy||[];for(let c=0;c<l.length;c++){const e=l[c].keys;if(e&&0!==e.length)if(e[0].morphTargets){const t={};let n;for(n=0;n<e.length;n++)if(e[n].morphTargets)for(let i=0;i<e[n].morphTargets.length;i++)t[e[n].morphTargets[i]]=-1;for(const r in t){const t=[],s=[];for(let i=0;i!==e[n].morphTargets.length;++i){const i=e[n];t.push(i.time),s.push(i.morphTarget===r?1:0)}i.push(new LG(".morphTargetInfluence["+r+"]",t,s))}o=t.length*s}else{const r=".bones["+t[c].name+"]";n(kG,r+".position",e,"pos",i),n(IG,r+".quaternion",e,"rot",i),n(kG,r+".scale",e,"scl",i)}}if(0===i.length)return null;return new this(r,o,i,a)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function NG(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return LG;case"vector":case"vector2":case"vector3":case"vector4":return kG;case"color":return RG;case"quaternion":return IG;case"bool":case"boolean":return CG;case"string":return DG}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];xG(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const FG={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class BG{constructor(e,t,n){const i=this;let r,s=!1,a=0,o=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(e){o++,!1===s&&void 0!==i.onStart&&i.onStart(e,a,o),s=!0},this.itemEnd=function(e){a++,void 0!==i.onProgress&&i.onProgress(e,a,o),a===o&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return r?r(e):e},this.setURLModifier=function(e){return r=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],i=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return i}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const UG=new BG;class HG{constructor(e){this.manager=void 0!==e?e:UG,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(i,r){n.load(e,i,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}HG.DEFAULT_MATERIAL_NAME="__DEFAULT";const zG={};class GG extends Error{constructor(e,t){super(e),this.response=t}}class VG extends HG{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=FG.get("file:".concat(e));if(void 0!==r)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(void 0!==zG[e])return void zG[e].push({onLoad:t,onProgress:n,onError:i});zG[e]=[],zG[e].push({onLoad:t,onProgress:n,onError:i});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:"function"===typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),a=this.mimeType,o=this.responseType;fetch(s).then(t=>{if(200===t.status||0===t.status){if(0===t.status&&gO("FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const n=zG[e],i=t.body.getReader(),r=t.headers.get("X-File-Size")||t.headers.get("Content-Length"),s=r?parseInt(r):0,a=0!==s;let o=0;const l=new ReadableStream({start(e){!function t(){i.read().then(i=>{let{done:r,value:l}=i;if(r)e.close();else{o+=l.byteLength;const i=new ProgressEvent("progress",{lengthComputable:a,loaded:o,total:s});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(i)}e.enqueue(l),t()}},t=>{e.error(t)})}()}});return new Response(l)}throw new GG('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)}).then(e=>{switch(o){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then(e=>(new DOMParser).parseFromString(e,a));case"json":return e.json();default:if(""===a)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(a),n=t&&t[1]?t[1].toLowerCase():void 0,i=new TextDecoder(n);return e.arrayBuffer().then(e=>i.decode(e))}}}).then(t=>{FG.add("file:".concat(e),t);const n=zG[e];delete zG[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onLoad&&i.onLoad(t)}}).catch(t=>{const n=zG[e];if(void 0===n)throw this.manager.itemError(e),t;delete zG[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onError&&i.onError(t)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class WG extends HG{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new VG(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(n){try{t(r.parse(JSON.parse(n)))}catch(kne){i?i(kne):vO(kne),r.manager.itemError(e)}},n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=OG.parse(e[n]);t.push(i)}return t}}class jG extends HG{constructor(e){super(e)}load(e,t,n,i){const r=this,s=[],a=new AH,o=new VG(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(r.withCredentials);let l=0;function c(c){o.load(e[c],function(e){const n=r.parse(e,!0);s[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(a.minFilter=GI),a.image=s,a.format=n.format,a.needsUpdate=!0,t&&t(a))},n,i)}if(Array.isArray(e))for(let u=0,d=e.length;u<d;++u)c(u);else o.load(e,function(e){const n=r.parse(e,!0);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){s[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++)s[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]),s[t].format=n.format,s[t].width=n.width,s[t].height=n.height}a.image=s}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=GI),a.format=n.format,a.needsUpdate=!0,t&&t(a)},n,i);return a}}const YG=new WeakMap;class XG extends HG{constructor(e){super(e)}load(e,t,n,i){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,s=FG.get("image:".concat(e));if(void 0!==s){if(!0===s.complete)r.manager.itemStart(e),setTimeout(function(){t&&t(s),r.manager.itemEnd(e)},0);else{let e=YG.get(s);void 0===e&&(e=[],YG.set(s,e)),e.push({onLoad:t,onError:i})}return s}const a=cO("img");function o(){c(),t&&t(this);const n=YG.get(this)||[];for(let e=0;e<n.length;e++){const t=n[e];t.onLoad&&t.onLoad(this)}YG.delete(this),r.manager.itemEnd(e)}function l(t){c(),i&&i(t),FG.remove("image:".concat(e));const n=YG.get(this)||[];for(let e=0;e<n.length;e++){const i=n[e];i.onError&&i.onError(t)}YG.delete(this),r.manager.itemError(e),r.manager.itemEnd(e)}function c(){a.removeEventListener("load",o,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),FG.add("image:".concat(e),a),r.manager.itemStart(e),a.src=e,a}}class KG extends HG{constructor(e){super(e)}load(e,t,n,i){const r=new AB;r.colorSpace=gk;const s=new XG(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let a=0;function o(n){s.load(e[n],function(e){r.images[n]=e,a++,6===a&&(r.needsUpdate=!0,t&&t(r))},void 0,i)}for(let l=0;l<e.length;++l)o(l);return r}}class qG extends HG{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new pU,a=new VG(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(r.withCredentials),a.load(e,function(e){let n;try{n=r.parse(e)}catch(a){if(void 0===i)return void a(a);i(a)}void 0!==n.image?s.image=n.image:void 0!==n.data&&(s.image.width=n.width,s.image.height=n.height,s.image.data=n.data),s.wrapS=void 0!==n.wrapS?n.wrapS:OI,s.wrapT=void 0!==n.wrapT?n.wrapT:OI,s.magFilter=void 0!==n.magFilter?n.magFilter:GI,s.minFilter=void 0!==n.minFilter?n.minFilter:GI,s.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.colorSpace&&(s.colorSpace=n.colorSpace),void 0!==n.flipY&&(s.flipY=n.flipY),void 0!==n.format&&(s.format=n.format),void 0!==n.type&&(s.type=n.type),void 0!==n.mipmaps&&(s.mipmaps=n.mipmaps,s.minFilter=jI),1===n.mipmapCount&&(s.minFilter=GI),void 0!==n.generateMipmaps&&(s.generateMipmaps=n.generateMipmaps),s.needsUpdate=!0,t&&t(s,n)},n,i),s}}class JG extends HG{constructor(e){super(e)}load(e,t,n,i){const r=new QO,s=new XG(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(e){r.image=e,r.needsUpdate=!0,void 0!==t&&t(r)},n,i),r}}class QG extends sF{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new wF(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}}class ZG extends QG{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(sF.DEFAULT_UP),this.updateMatrix(),this.groundColor=new wF(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const $G=new IN,eV=new DO,tV=new DO;class nV{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new PO(512,512),this.mapType=XI,this.map=null,this.mapPass=null,this.matrix=new IN,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new kU,this._frameExtents=new PO(1,1),this._viewportCount=1,this._viewports=[new ZO(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;eV.setFromMatrixPosition(e.matrixWorld),t.position.copy(eV),tV.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(tV),t.updateMatrixWorld(),$G.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix($G,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply($G)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class iV extends nV{constructor(){super(new wB(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=2*EO*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height*this.aspect,r=e.distance||t.far;n===t.fov&&i===t.aspect&&r===t.far||(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class rV extends QG{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(sF.DEFAULT_UP),this.updateMatrix(),this.target=new sF,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new iV}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const sV=new IN,aV=new DO,oV=new DO;class lV extends nV{constructor(){super(new wB(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new PO(4,2),this._viewportCount=6,this._viewports=[new ZO(2,1,1,1),new ZO(0,1,1,1),new ZO(3,1,1,1),new ZO(1,1,1,1),new ZO(3,0,1,1),new ZO(1,0,1,1)],this._cubeDirections=[new DO(1,0,0),new DO(-1,0,0),new DO(0,0,1),new DO(0,0,-1),new DO(0,1,0),new DO(0,-1,0)],this._cubeUps=[new DO(0,1,0),new DO(0,1,0),new DO(0,1,0),new DO(0,1,0),new DO(0,0,1),new DO(0,0,-1)]}updateMatrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.camera,i=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),aV.setFromMatrixPosition(e.matrixWorld),n.position.copy(aV),oV.copy(n.position),oV.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(oV),n.updateMatrixWorld(),i.makeTranslation(-aV.x,-aV.y,-aV.z),sV.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(sV,n.coordinateSystem,n.reversedDepth)}}class cV extends QG{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new lV}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class uV extends bB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-e,s=n+e,a=i+t,o=i-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,s=r+e*this.view.width,a-=t*this.view.offsetY,o=a-t*this.view.height}this.projectionMatrix.makeOrthographic(r,s,a,o,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class dV extends nV{constructor(){super(new uV(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class hV extends QG{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(sF.DEFAULT_UP),this.updateMatrix(),this.target=new sF,this.shadow=new dV}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class fV extends QG{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class pV extends QG{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class mV{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new DO)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,r=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.282095),t.addScaledVector(s[1],.488603*i),t.addScaledVector(s[2],.488603*r),t.addScaledVector(s[3],.488603*n),t.addScaledVector(s[4],n*i*1.092548),t.addScaledVector(s[5],i*r*1.092548),t.addScaledVector(s[6],.315392*(3*r*r-1)),t.addScaledVector(s[7],n*r*1.092548),t.addScaledVector(s[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,r=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.886227),t.addScaledVector(s[1],1.023328*i),t.addScaledVector(s[2],1.023328*r),t.addScaledVector(s[3],1.023328*n),t.addScaledVector(s[4],.858086*n*i),t.addScaledVector(s[5],.858086*i*r),t.addScaledVector(s[6],.743125*r*r-.247708),t.addScaledVector(s[7],.858086*n*r),t.addScaledVector(s[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+3*i);return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+3*i);return e}static getBasisAt(e,t){const n=e.x,i=e.y,r=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-i*i)}}class gV extends QG{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new mV;super(void 0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class vV extends HG{constructor(e){super(e),this.textures={}}load(e,t,n,i){const r=this,s=new VG(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,function(n){try{t(r.parse(JSON.parse(n)))}catch(kne){i?i(kne):vO(kne),r.manager.itemError(e)}},n,i)}parse(e){const t=this.textures;function n(e){return void 0===t[e]&&gO("MaterialLoader: Undefined texture",e),t[e]}const i=this.createMaterialFromType(e.type);if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&void 0!==i.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.sheen&&(i.sheen=e.sheen),void 0!==e.sheenColor&&(i.sheenColor=(new wF).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(i.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==i.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==i.specular&&i.specular.setHex(e.specular),void 0!==e.specularIntensity&&(i.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==i.specularColor&&i.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearcoat&&(i.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(i.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.dispersion&&(i.dispersion=e.dispersion),void 0!==e.iridescence&&(i.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(i.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(i.transmission=e.transmission),void 0!==e.thickness&&(i.thickness=e.thickness),void 0!==e.attenuationDistance&&(i.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==i.attenuationColor&&i.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(i.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(i.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.shadowSide&&(i.shadowSide=e.shadowSide),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(i.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(i.depthFunc=e.depthFunc),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(i.blendSrc=e.blendSrc),void 0!==e.blendDst&&(i.blendDst=e.blendDst),void 0!==e.blendEquation&&(i.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(i.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(i.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(i.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==i.blendColor&&i.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(i.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(i.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(i.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(i.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(i.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(i.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(i.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(i.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(i.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),void 0!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.alphaToCoverage&&(i.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(i.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(i.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.toneMapped&&(i.toneMapped=e.toneMapped),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.vertexColors&&("number"===typeof e.vertexColors?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const r in e.uniforms){const t=e.uniforms[r];switch(i.uniforms[r]={},t.type){case"t":i.uniforms[r].value=n(t.value);break;case"c":i.uniforms[r].value=(new wF).setHex(t.value);break;case"v2":i.uniforms[r].value=(new PO).fromArray(t.value);break;case"v3":i.uniforms[r].value=(new DO).fromArray(t.value);break;case"v4":i.uniforms[r].value=(new ZO).fromArray(t.value);break;case"m3":i.uniforms[r].value=(new NO).fromArray(t.value);break;case"m4":i.uniforms[r].value=(new IN).fromArray(t.value);break;default:i.uniforms[r].value=t.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(i.glslVersion=e.glslVersion),void 0!==e.extensions)for(const r in e.extensions)i.extensions[r]=e.extensions[r];if(void 0!==e.lights&&(i.lights=e.lights),void 0!==e.clipping&&(i.clipping=e.clipping),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.matcap&&(i.matcap=n(e.matcap)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),i.normalScale=(new PO).fromArray(t)}return void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(i.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(i.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.envMapRotation&&i.envMapRotation.fromArray(e.envMapRotation),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(i.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(i.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(i.clearcoatNormalScale=(new PO).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(i.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(i.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(i.thicknessMap=n(e.thicknessMap)),void 0!==e.anisotropyMap&&(i.anisotropyMap=n(e.anisotropyMap)),void 0!==e.sheenColorMap&&(i.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return vV.createMaterialFromType(e)}static createMaterialFromType(e){return new{ShadowMaterial:sG,SpriteMaterial:BB,RawShaderMaterial:aG,ShaderMaterial:_B,PointsMaterial:vH,MeshPhysicalMaterial:lG,MeshStandardMaterial:oG,MeshPhongMaterial:cG,MeshToonMaterial:uG,MeshNormalMaterial:dG,MeshLambertMaterial:hG,MeshDepthMaterial:fG,MeshDistanceMaterial:pG,MeshBasicMaterial:CF,MeshMatcapMaterial:mG,LineDashedMaterial:gG,LineBasicMaterial:iH,Material:AF}[e]}}class yV{static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!==typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class _V extends eB{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class bV extends HG{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new VG(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,function(n){try{t(r.parse(JSON.parse(n)))}catch(kne){i?i(kne):vO(kne),r.manager.itemError(e)}},n,i)}parse(e){const t={},n={};function i(e,i){if(void 0!==t[i])return t[i];const r=e.interleavedBuffers[i],s=function(e,t){if(void 0!==n[t])return n[t];const i=e.arrayBuffers,r=i[t],s=new Uint32Array(r).buffer;return n[t]=s,s}(e,r.buffer),a=lO(r.type,s),o=new OB(a,r.stride);return o.uuid=r.uuid,t[i]=o,o}const r=e.isInstancedBufferGeometry?new _V:new eB,s=e.data.index;if(void 0!==s){const e=lO(s.type,s.array);r.setIndex(new FF(e,1))}const a=e.data.attributes;for(const u in a){const t=a[u];let n;if(t.isInterleavedBufferAttribute){const r=i(e.data,t.data);n=new FB(r,t.itemSize,t.offset,t.normalized)}else{const e=lO(t.type,t.array);n=new(t.isInstancedBufferAttribute?yU:FF)(e,t.itemSize,t.normalized)}void 0!==t.name&&(n.name=t.name),void 0!==t.usage&&n.setUsage(t.usage),r.setAttribute(u,n)}const o=e.data.morphAttributes;if(o)for(const u in o){const t=o[u],n=[];for(let r=0,s=t.length;r<s;r++){const s=t[r];let a;if(s.isInterleavedBufferAttribute){const t=i(e.data,s.data);a=new FB(t,s.itemSize,s.offset,s.normalized)}else{const e=lO(s.type,s.array);a=new FF(e,s.itemSize,s.normalized)}void 0!==s.name&&(a.name=s.name),n.push(a)}r.morphAttributes[u]=n}e.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let u=0,d=l.length;u!==d;++u){const e=l[u];r.addGroup(e.start,e.count,e.materialIndex)}const c=e.data.boundingSphere;return void 0!==c&&(r.boundingSphere=(new EN).fromJSON(c)),e.name&&(r.name=e.name),e.userData&&(r.userData=e.userData),r}}class xV extends HG{constructor(e){super(e)}load(e,t,n,i){const r=this,s=""===this.path?yV.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const a=new VG(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(n){let s=null;try{s=JSON.parse(n)}catch(o){return void 0!==i&&i(o),void o("ObjectLoader: Can't parse "+e+".",o.message)}const a=s.metadata;if(void 0===a||void 0===a.type||"geometry"===a.type.toLowerCase())return void 0!==i&&i(new Error("THREE.ObjectLoader: Can't load "+e)),void vO("ObjectLoader: Can't load "+e);r.parse(s,t)},n,i)}async loadAsync(e,t){const n=""===this.path?yV.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const i=new VG(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);const r=await i.loadAsync(e,t),s=JSON.parse(r),a=s.metadata;if(void 0===a||void 0===a.type||"geometry"===a.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(s)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=this.parseImages(e.images,function(){void 0!==t&&t(l)}),a=this.parseTextures(e.textures,s),o=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,r,o,a,n),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),this.bindLightTargets(l),void 0!==t){let e=!1;for(const t in s)if(s[t].data instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),r=await this.parseImagesAsync(e.images),s=this.parseTextures(e.textures,r),a=this.parseMaterials(e.materials,s),o=this.parseObject(e.object,i,a,s,t),l=this.parseSkeletons(e.skeletons,o);return this.bindSkeletons(o,l),this.bindLightTargets(o),o}parseShapes(e){const t={};if(void 0!==e)for(let n=0,i=e.length;n<i;n++){const i=(new hz).fromJSON(e[n]);t[i.uuid]=i}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse(function(e){e.isBone&&(i[e.uuid]=e)}),void 0!==e)for(let r=0,s=e.length;r<s;r++){const t=(new vU).fromJSON(e[r],i);n[t.uuid]=t}return n}parseGeometries(e,t){const n={};if(void 0!==e){const i=new bV;for(let r=0,s=e.length;r<s;r++){let s;const a=e[r];switch(a.type){case"BufferGeometry":case"InstancedBufferGeometry":s=i.parse(a);break;default:a.type in rG?s=rG[a.type].fromJSON(a,t):gO('ObjectLoader: Unsupported geometry type "'.concat(a.type,'"'))}s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.userData&&(s.userData=a.userData),n[a.uuid]=s}}return n}parseMaterials(e,t){const n={},i={};if(void 0!==e){const r=new vV;r.setTextures(t);for(let t=0,s=e.length;t<s;t++){const s=e[t];void 0===n[s.uuid]&&(n[s.uuid]=r.parse(s)),i[s.uuid]=n[s.uuid]}}return i}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const i=e[n],r=OG.parse(i);t[r.uuid]=r}return t}parseImages(e,t){const n=this,i={};let r;function s(e){if("string"===typeof e){const t=e;return function(e){return n.manager.itemStart(e),r.load(e,function(){n.manager.itemEnd(e)},void 0,function(){n.manager.itemError(e),n.manager.itemEnd(e)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t)}return e.data?{data:lO(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){const n=new BG(t);r=new XG(n),r.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){const n=e[t],r=n.url;if(Array.isArray(r)){const e=[];for(let t=0,n=r.length;t<n;t++){const n=s(r[t]);null!==n&&(n instanceof HTMLImageElement?e.push(n):e.push(new pU(n.data,n.width,n.height)))}i[n.uuid]=new XO(e)}else{const e=s(n.url);i[n.uuid]=new XO(e)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function r(e){if("string"===typeof e){const n=e,r=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:t.resourcePath+n;return await i.loadAsync(r)}return e.data?{data:lO(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){i=new XG(this.manager),i.setCrossOrigin(this.crossOrigin);for(let t=0,i=e.length;t<i;t++){const i=e[t],s=i.url;if(Array.isArray(s)){const e=[];for(let t=0,n=s.length;t<n;t++){const n=s[t],i=await r(n);null!==i&&(i instanceof HTMLImageElement?e.push(i):e.push(new pU(i.data,i.width,i.height)))}n[i.uuid]=new XO(e)}else{const e=await r(i.url);n[i.uuid]=new XO(e)}}}return n}parseTextures(e,t){function n(e,t){return"number"===typeof e?e:(gO("ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const i={};if(void 0!==e)for(let r=0,s=e.length;r<s;r++){const s=e[r];void 0===s.image&&gO('ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&gO("ObjectLoader: Undefined image",s.image);const a=t[s.image],o=a.data;let l;Array.isArray(o)?(l=new AB,6===o.length&&(l.needsUpdate=!0)):(l=o&&o.data?new pU:new QO,o&&(l.needsUpdate=!0)),l.source=a,l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),void 0!==s.mapping&&(l.mapping=n(s.mapping,SV)),void 0!==s.channel&&(l.channel=s.channel),void 0!==s.offset&&l.offset.fromArray(s.offset),void 0!==s.repeat&&l.repeat.fromArray(s.repeat),void 0!==s.center&&l.center.fromArray(s.center),void 0!==s.rotation&&(l.rotation=s.rotation),void 0!==s.wrap&&(l.wrapS=n(s.wrap[0],EV),l.wrapT=n(s.wrap[1],EV)),void 0!==s.format&&(l.format=s.format),void 0!==s.internalFormat&&(l.internalFormat=s.internalFormat),void 0!==s.type&&(l.type=s.type),void 0!==s.colorSpace&&(l.colorSpace=s.colorSpace),void 0!==s.minFilter&&(l.minFilter=n(s.minFilter,wV)),void 0!==s.magFilter&&(l.magFilter=n(s.magFilter,wV)),void 0!==s.anisotropy&&(l.anisotropy=s.anisotropy),void 0!==s.flipY&&(l.flipY=s.flipY),void 0!==s.generateMipmaps&&(l.generateMipmaps=s.generateMipmaps),void 0!==s.premultiplyAlpha&&(l.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(l.unpackAlignment=s.unpackAlignment),void 0!==s.compareFunction&&(l.compareFunction=s.compareFunction),void 0!==s.userData&&(l.userData=s.userData),i[s.uuid]=l}return i}parseObject(e,t,n,i,r){let s,a,o;function l(e){return void 0===t[e]&&gO("ObjectLoader: Undefined geometry",e),t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let i=0,r=e.length;i<r;i++){const r=e[i];void 0===n[r]&&gO("ObjectLoader: Undefined material",r),t.push(n[r])}return t}return void 0===n[e]&&gO("ObjectLoader: Undefined material",e),n[e]}}function u(e){return void 0===i[e]&&gO("ObjectLoader: Undefined texture",e),i[e]}switch(e.type){case"Scene":s=new kB,void 0!==e.background&&(Number.isInteger(e.background)?s.background=new wF(e.background):s.background=u(e.background)),void 0!==e.environment&&(s.environment=u(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?s.fog=new DB(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(s.fog=new IB(e.fog.color,e.fog.density)),""!==e.fog.name&&(s.fog.name=e.fog.name)),void 0!==e.backgroundBlurriness&&(s.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(s.backgroundIntensity=e.backgroundIntensity),void 0!==e.backgroundRotation&&s.backgroundRotation.fromArray(e.backgroundRotation),void 0!==e.environmentIntensity&&(s.environmentIntensity=e.environmentIntensity),void 0!==e.environmentRotation&&s.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":s=new wB(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(s.focus=e.focus),void 0!==e.zoom&&(s.zoom=e.zoom),void 0!==e.filmGauge&&(s.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(s.filmOffset=e.filmOffset),void 0!==e.view&&(s.view=Object.assign({},e.view));break;case"OrthographicCamera":s=new uV(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(s.zoom=e.zoom),void 0!==e.view&&(s.view=Object.assign({},e.view));break;case"AmbientLight":s=new fV(e.color,e.intensity);break;case"DirectionalLight":s=new hV(e.color,e.intensity),s.target=e.target||"";break;case"PointLight":s=new cV(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":s=new pV(e.color,e.intensity,e.width,e.height);break;case"SpotLight":s=new rV(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),s.target=e.target||"";break;case"HemisphereLight":s=new ZG(e.color,e.groundColor,e.intensity);break;case"LightProbe":s=(new gV).fromJSON(e);break;case"SkinnedMesh":a=l(e.geometry),o=c(e.material),s=new hU(a,o),void 0!==e.bindMode&&(s.bindMode=e.bindMode),void 0!==e.bindMatrix&&s.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(s.skeleton=e.skeleton);break;case"Mesh":a=l(e.geometry),o=c(e.material),s=new hB(a,o);break;case"InstancedMesh":a=l(e.geometry),o=c(e.material);const t=e.count,n=e.instanceMatrix,i=e.instanceColor;s=new MU(a,o,t),s.instanceMatrix=new yU(new Float32Array(n.array),16),void 0!==i&&(s.instanceColor=new yU(new Float32Array(i.array),i.itemSize));break;case"BatchedMesh":a=l(e.geometry),o=c(e.material),s=new nH(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,o),s.geometry=a,s.perObjectFrustumCulled=e.perObjectFrustumCulled,s.sortObjects=e.sortObjects,s._drawRanges=e.drawRanges,s._reservedRanges=e.reservedRanges,s._geometryInfo=e.geometryInfo.map(e=>{let t=null,n=null;return void 0!==e.boundingBox&&(t=(new sN).fromJSON(e.boundingBox)),void 0!==e.boundingSphere&&(n=(new EN).fromJSON(e.boundingSphere)),Cr(Cr({},e),{},{boundingBox:t,boundingSphere:n})}),s._instanceInfo=e.instanceInfo,s._availableInstanceIds=e._availableInstanceIds,s._availableGeometryIds=e._availableGeometryIds,s._nextIndexStart=e.nextIndexStart,s._nextVertexStart=e.nextVertexStart,s._geometryCount=e.geometryCount,s._maxInstanceCount=e.maxInstanceCount,s._maxVertexCount=e.maxVertexCount,s._maxIndexCount=e.maxIndexCount,s._geometryInitialized=e.geometryInitialized,s._matricesTexture=u(e.matricesTexture.uuid),s._indirectTexture=u(e.indirectTexture.uuid),void 0!==e.colorsTexture&&(s._colorsTexture=u(e.colorsTexture.uuid)),void 0!==e.boundingSphere&&(s.boundingSphere=(new EN).fromJSON(e.boundingSphere)),void 0!==e.boundingBox&&(s.boundingBox=(new sN).fromJSON(e.boundingBox));break;case"LOD":s=new nU;break;case"Line":s=new dH(l(e.geometry),c(e.material));break;case"LineLoop":s=new gH(l(e.geometry),c(e.material));break;case"LineSegments":s=new mH(l(e.geometry),c(e.material));break;case"PointCloud":case"Points":s=new SH(l(e.geometry),c(e.material));break;case"Sprite":s=new ZB(c(e.material));break;case"Group":s=new RB;break;case"Bone":s=new fU;break;default:s=new sF}if(s.uuid=e.uuid,void 0!==e.name&&(s.name=e.name),void 0!==e.matrix?(s.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(s.matrixAutoUpdate=e.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(void 0!==e.position&&s.position.fromArray(e.position),void 0!==e.rotation&&s.rotation.fromArray(e.rotation),void 0!==e.quaternion&&s.quaternion.fromArray(e.quaternion),void 0!==e.scale&&s.scale.fromArray(e.scale)),void 0!==e.up&&s.up.fromArray(e.up),void 0!==e.castShadow&&(s.castShadow=e.castShadow),void 0!==e.receiveShadow&&(s.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.intensity&&(s.shadow.intensity=e.shadow.intensity),void 0!==e.shadow.bias&&(s.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(s.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(s.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&s.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(s.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(s.visible=e.visible),void 0!==e.frustumCulled&&(s.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(s.renderOrder=e.renderOrder),void 0!==e.userData&&(s.userData=e.userData),void 0!==e.layers&&(s.layers.mask=e.layers),void 0!==e.children){const a=e.children;for(let e=0;e<a.length;e++)s.add(this.parseObject(a[e],t,n,i,r))}if(void 0!==e.animations){const t=e.animations;for(let e=0;e<t.length;e++){const n=t[e];s.animations.push(r[n])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(s.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e],i=s.getObjectByProperty("uuid",n.object);void 0!==i&&s.addLevel(i,n.distance,n.hysteresis)}}return s}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const n=t[e.skeleton];void 0===n?gO("ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,i=e.getObjectByProperty("uuid",n);t.target=void 0!==i?i:new sF}})}}const SV={UVMapping:CI,CubeReflectionMapping:RI,CubeRefractionMapping:LI,EquirectangularReflectionMapping:PI,EquirectangularRefractionMapping:II,CubeUVReflectionMapping:DI},EV={RepeatWrapping:kI,ClampToEdgeWrapping:OI,MirroredRepeatWrapping:NI},wV={NearestFilter:FI,NearestMipmapNearestFilter:BI,NearestMipmapLinearFilter:HI,LinearFilter:GI,LinearMipmapNearestFilter:VI,LinearMipmapLinearFilter:jI},TV=new WeakMap;class MV extends HG{constructor(e){super(e),this.isImageBitmapLoader=!0,"undefined"===typeof createImageBitmap&&gO("ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&gO("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,s=FG.get("image-bitmap:".concat(e));if(void 0!==s)return r.manager.itemStart(e),s.then?void s.then(n=>{if(!0!==TV.has(s))return t&&t(n),r.manager.itemEnd(e),n;i&&i(TV.get(s)),r.manager.itemError(e),r.manager.itemEnd(e)}):(setTimeout(function(){t&&t(s),r.manager.itemEnd(e)},0),s);const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,a.signal="function"===typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const o=fetch(e,a).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(n){return FG.add("image-bitmap:".concat(e),n),t&&t(n),r.manager.itemEnd(e),n}).catch(function(t){i&&i(t),TV.set(o,t),FG.remove("image-bitmap:".concat(e)),r.manager.itemError(e),r.manager.itemEnd(e)});FG.add("image-bitmap:".concat(e),o),r.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let AV;class CV{static getContext(){return void 0===AV&&(AV=new(window.AudioContext||window.webkitAudioContext)),AV}static setContext(e){AV=e}}class RV extends HG{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new VG(this.manager);function a(t){i?i(t):vO(t),r.manager.itemError(e)}s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(e){try{const n=e.slice(0);CV.getContext().decodeAudioData(n,function(e){t(e)}).catch(a)}catch(kne){a(kne)}},n,i)}}const LV=new IN,PV=new IN,IV=new IN;class DV{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new wB,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new wB,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,IV.copy(e.projectionMatrix);const n=t.eyeSep/2,i=n*t.near/t.focus,r=t.near*Math.tan(SO*t.fov*.5)/t.zoom;let s,a;PV.elements[12]=-n,LV.elements[12]=n,s=-r*t.aspect+i,a=r*t.aspect+i,IV.elements[0]=2*t.near/(a-s),IV.elements[8]=(a+s)/(a-s),this.cameraL.projectionMatrix.copy(IV),s=-r*t.aspect-i,a=r*t.aspect-i,IV.elements[0]=2*t.near/(a-s),IV.elements[8]=(a+s)/(a-s),this.cameraR.projectionMatrix.copy(IV)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(PV),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(LV)}}class kV extends wB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class OV{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const NV=new DO,FV=new IO,BV=new DO,UV=new DO,HV=new DO;class zV extends sF{constructor(){super(),this.type="AudioListener",this.context=CV.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new OV}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(NV,FV,BV),UV.set(0,0,-1).applyQuaternion(FV),HV.set(0,1,0).applyQuaternion(FV),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(NV.x,e),t.positionY.linearRampToValueAtTime(NV.y,e),t.positionZ.linearRampToValueAtTime(NV.z,e),t.forwardX.linearRampToValueAtTime(UV.x,e),t.forwardY.linearRampToValueAtTime(UV.y,e),t.forwardZ.linearRampToValueAtTime(UV.z,e),t.upX.linearRampToValueAtTime(HV.x,e),t.upY.linearRampToValueAtTime(HV.y,e),t.upZ.linearRampToValueAtTime(HV.z,e)}else t.setPosition(NV.x,NV.y,NV.z),t.setOrientation(UV.x,UV.y,UV.z,HV.x,HV.y,HV.z)}}class GV extends sF{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0===this.isPlaying)return void gO("Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void gO("Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;gO("Audio: this Audio has no playback control.")}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this;gO("Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,!0===this.isPlaying&&void 0!==this.source.detune&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;gO("Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return!1===this.hasPlaybackControl?(gO("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;gO("Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),"buffer"!==e.sourceType?(gO("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const VV=new DO,WV=new IO,jV=new DO,YV=new DO;class XV extends GV{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(VV,WV,jV),YV.set(0,0,1).applyQuaternion(WV);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(VV.x,e),t.positionY.linearRampToValueAtTime(VV.y,e),t.positionZ.linearRampToValueAtTime(VV.z,e),t.orientationX.linearRampToValueAtTime(YV.x,e),t.orientationY.linearRampToValueAtTime(YV.y,e),t.orientationZ.linearRampToValueAtTime(YV.z,e)}else t.setPosition(VV.x,VV.y,VV.z),t.setOrientation(YV.x,YV.y,YV.z)}}class KV{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class qV{constructor(e,t,n){let i,r,s;switch(this.binding=e,this.valueSize=n,t){case"quaternion":i=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,r=e*i+i;let s=this.cumulativeWeight;if(0===s){for(let e=0;e!==i;++e)n[r+e]=n[e];s=t}else{s+=t;const e=t/s;this._mixBufferRegion(n,r,0,e,i)}this.cumulativeWeight=s}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const e=t*this._origIndex;this._mixBufferRegion(n,i,e,1-r,t)}s>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(n[o]!==n[o+t]){a.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let r=n,s=i;r!==s;++r)t[r]=t[i+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,r){if(i>=.5)for(let s=0;s!==r;++s)e[t+s]=e[n+s]}_slerp(e,t,n,i){IO.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,r){const s=this._workIndex*r;IO.multiplyQuaternionsFlat(e,s,e,t,e,n),IO.slerpFlat(e,t,e,t,e,s,i)}_lerp(e,t,n,i,r){const s=1-i;for(let a=0;a!==r;++a){const r=t+a;e[r]=e[r]*s+e[n+a]*i}}_lerpAdditive(e,t,n,i,r){for(let s=0;s!==r;++s){const r=t+s;e[r]=e[r]+e[n+s]*i}}}const JV="\\[\\]\\.:\\/",QV=new RegExp("["+JV+"]","g"),ZV="[^"+JV+"]",$V="[^"+JV.replace("\\.","")+"]",eW=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",ZV)+/(WCOD+)?/.source.replace("WCOD",$V)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ZV)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ZV)+"$"),tW=["material","materials","bones","map"];class nW{constructor(e,t,n){this.path=t,this.parsedPath=n||nW.parseTrackName(t),this.node=nW.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new nW.Composite(e,t,n):new nW(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(QV,"")}static parseTrackName(e){const t=eW.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const e=n.nodeName.substring(i+1);-1!==tW.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let i=0;i<e.length;i++){const r=e[i];if(r.name===t||r.uuid===t)return r;const s=n(r.children);if(s)return s}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let r=t.propertyIndex;if(e||(e=nW.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void gO("PropertyBinding: No target node found for track: "+this.path+".");if(n){let i=t.objectIndex;switch(n){case"materials":if(!e.material)return void vO("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void vO("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void vO("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===i){i=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void vO("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void vO("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void vO("PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==i){if(void 0===e[i])return void vO("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}const s=e[i];if(void 0===s){return void vO("PropertyBinding: Trying to update property for track: "+t.nodeName+"."+i+" but it wasn't found.",e)}let a=this.Versioning.None;this.targetObject=e,!0===e.isMaterial?a=this.Versioning.NeedsUpdate:!0===e.isObject3D&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void vO("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void vO("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}nW.Composite=class{constructor(e,t,n){const i=n||nW.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},nW.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},nW.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},nW.prototype.GetterByBindingType=[nW.prototype._getValue_direct,nW.prototype._getValue_array,nW.prototype._getValue_arrayElement,nW.prototype._getValue_toArray],nW.prototype.SetterByBindingTypeAndVersioning=[[nW.prototype._setValue_direct,nW.prototype._setValue_direct_setNeedsUpdate,nW.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[nW.prototype._setValue_array,nW.prototype._setValue_array_setNeedsUpdate,nW.prototype._setValue_array_setMatrixWorldNeedsUpdate],[nW.prototype._setValue_arrayElement,nW.prototype._setValue_arrayElement_setNeedsUpdate,nW.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[nW.prototype._setValue_fromArray,nW.prototype._setValue_fromArray_setNeedsUpdate,nW.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class iW{constructor(){this.isAnimationObjectGroup=!0,this.uuid=wO(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,s=r.length;let a,o=e.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],d=u.uuid;let h=t[d];if(void 0===h){h=o++,t[d]=h,e.push(u);for(let e=0,t=s;e!==t;++e)r[e].push(new nW(u,n[e],i[e]))}else if(h<l){a=e[h];const o=--l,c=e[o];t[c.uuid]=h,e[h]=c,t[d]=o,e[o]=u;for(let e=0,t=s;e!==t;++e){const t=r[e],s=t[o];let a=t[h];t[h]=s,void 0===a&&(a=new nW(u,n[e],i[e])),t[o]=a}}else e[h]!==a&&vO("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_;for(let s=0,a=arguments.length;s!==a;++s){const a=arguments[s],o=a.uuid,l=t[o];if(void 0!==l&&l>=r){const s=r++,c=e[s];t[c.uuid]=l,e[l]=c,t[o]=s,e[s]=a;for(let e=0,t=i;e!==t;++e){const t=n[e],i=t[s],r=t[l];t[l]=i,t[s]=r}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_,s=e.length;for(let a=0,o=arguments.length;a!==o;++a){const o=arguments[a].uuid,l=t[o];if(void 0!==l)if(delete t[o],l<r){const a=--r,o=e[a],c=--s,u=e[c];t[o.uuid]=l,e[l]=o,t[u.uuid]=a,e[a]=u,e.pop();for(let e=0,t=i;e!==t;++e){const t=n[e],i=t[a],r=t[c];t[l]=i,t[a]=r,t.pop()}}else{const r=--s,a=e[r];r>0&&(t[a.uuid]=l),e[l]=a,e.pop();for(let e=0,t=i;e!==t;++e){const t=n[e];t[l]=t[r],t.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const r=this._bindings;if(void 0!==i)return r[i];const s=this._paths,a=this._parsedPaths,o=this._objects,l=o.length,c=this.nCachedObjects_,u=new Array(l);i=r.length,n[e]=i,s.push(e),a.push(t),r.push(u);for(let d=c,h=o.length;d!==h;++d){const n=o[d];u[d]=new nW(n,e,t)}return u}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const i=this._paths,r=this._parsedPaths,s=this._bindings,a=s.length-1,o=s[a];t[e[a]]=n,s[n]=o,s.pop(),r[n]=r[a],r.pop(),i[n]=i[a],i.pop()}}}class rW{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.blendMode;this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const r=t.tracks,s=r.length,a=new Array(s),o={endingStart:tk,endingEnd:tk};for(let l=0;l!==s;++l){const e=r[l].createInterpolant(null);a[l]=e,e.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=JD,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.fadeOut(t),this.fadeIn(t),!0===n){const n=this._clip.duration,i=e._clip.duration,r=i/n,s=n/i;e.warp(1,r,t),this.warp(s,1,t)}return this}crossFadeTo(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,r=i.time,s=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const o=a.parameterPositions,l=a.sampleValues;return o[0]=r,o[1]=r+n,l[0]=e/s,l[1]=t/s,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled)return void this._updateWeight(e);const r=this._startTime;if(null!==r){const i=(e-r)*n;i<0||0===n?t=0:(this._startTime=null,t=n*i)}t*=this._updateTimeScale(e);const s=this._updateTime(t),a=this._updateWeight(e);if(a>0){const e=this._interpolants,t=this._propertyBindings;if(this.blendMode===sk)for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(s),t[n].accumulateAdditive(a);else for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(s),t[n].accumulate(i,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,r=this._loopCount;const s=n===QD;if(0===e)return-1===r?i:s&&1===(1&r)?t-i:i;if(n===qD){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else{if(!(i<0)){this.time=i;break e}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),i>=t||i<0){const n=Math.floor(i/t);i-=t*n,r+=Math.abs(n);const a=this.repetitions-r;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===a){const t=e<0;this._setEndings(t,!t,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=i;if(s&&1===(1&r))return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=nk,i.endingEnd=nk):(i.endingStart=e?this.zeroSlopeAtStart?nk:tk:ik,i.endingEnd=t?this.zeroSlopeAtEnd?nk:tk:ik)}_scheduleFading(e,t,n){const i=this._mixer,r=i.time;let s=this._weightInterpolant;null===s&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);const a=s.parameterPositions,o=s.sampleValues;return a[0]=r,o[0]=t,a[1]=r+e,o[1]=n,this}}const sW=new Float32Array(1);class aW extends _O{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,s=e._propertyBindings,a=e._interpolants,o=n.uuid,l=this._bindingsByRootAndName;let c=l[o];void 0===c&&(c={},l[o]=c);for(let u=0;u!==r;++u){const e=i[u],r=e.name;let l=c[r];if(void 0!==l)++l.referenceCount,s[u]=l;else{if(l=s[u],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,o,r));continue}const i=t&&t._propertyBindings[u].binding.parsedPath;l=new qV(nW.create(n,r,i),e.ValueTypeName,e.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,o,r),s[u]=l}a[u].resultBuffer=l.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,r=this._actionsByClip;let s=r[t];if(void 0===s)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=s;else{const t=s.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=i.length,i.push(e),s.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,s=this._actionsByClip,a=s[r],o=a.knownActions,l=o[o.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,o[c]=l,o.pop(),e._byClipCacheIndex=null;delete a.actionByRoot[(e._localRoot||this._root).uuid],0===o.length&&delete s[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const e=t[n];0===--e.referenceCount&&this._removeInactiveBinding(e)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,r=this._bindings;let s=i[t];void 0===s&&(s={},i[t]=s),s[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,s=this._bindingsByRootAndName,a=s[i],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete a[r],0===Object.keys(a).length&&delete s[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new TG(new Float32Array(2),new Float32Array(2),1,sW),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){const i=t||this._root,r=i.uuid;let s="string"===typeof e?OG.findByName(i,e):e;const a=null!==s?s.uuid:e,o=this._actionsByClip[a];let l=null;if(void 0===n&&(n=null!==s?s.blendMode:rk),void 0!==o){const e=o.actionByRoot[r];if(void 0!==e&&e.blendMode===n)return e;l=o.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;const c=new rW(this,s,t,n);return this._bindAction(c,l),this._addInactiveAction(c,a,r),c}existingAction(e,t){const n=t||this._root,i=n.uuid,r="string"===typeof e?OG.findByName(n,e):e,s=r?r.uuid:e,a=this._actionsByClip[s];return void 0!==a&&a.actionByRoot[i]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==n;++l){t[l]._update(i,e,r,s)}const a=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)a[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){const e=r.knownActions;for(let n=0,i=e.length;n!==i;++n){const i=e[n];this._deactivateAction(i);const r=i._cacheIndex,s=t[t.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,s._cacheIndex=r,t[r]=s,t.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const r in n){const e=n[r].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}const i=this._bindingsByRootAndName[t];if(void 0!==i)for(const r in i){const e=i[r];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class oW extends $O{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(e,t,i),this.isRenderTarget3D=!0,this.depth=n,this.texture=new iN(null,e,t,n),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}}class lW{constructor(e){this.value=e}clone(){return new lW(void 0===this.value.clone?this.value:this.value.clone())}}let cW=0;class uW extends _O{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:cW++}),this.name="",this.usage=Wk,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,i=t.length;n<i;n++){const e=Array.isArray(t[n])?t[n]:[t[n]];for(let t=0;t<e.length;t++)this.uniforms.push(e[t].clone())}return this}clone(){return(new this.constructor).copy(this)}}class dW extends OB{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class hW{constructor(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=r,this.normalized=s,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const fW=new IN;class pW{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new PN(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new VN,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):vO("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return fW.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(fW),this}intersectObject(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return gW(e,this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),t.sort(mW),t}intersectObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let i=0,r=e.length;i<r;i++)gW(e[i],this,n,t);return n.sort(mW),n}}function mW(e,t){return e.distance-t.distance}function gW(e,t,n,i){let r=!0;if(e.layers.test(t.layers)){!1===e.raycast(t,n)&&(r=!1)}if(!0===r&&!0===i){const i=e.children;for(let e=0,r=i.length;e<r;e++)gW(i[e],t,n,!0)}}class vW{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,void 0!==e.hidden&&(this._pageVisibilityHandler=yW.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){null!==this._pageVisibilityHandler&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return null!==this._pageVisibilityHandler&&!0===this._document.hidden?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(void 0!==e?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function yW(){!1===this._document.hidden&&this.reset()}class _W{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=TO(this.phi,e,Math.PI-e),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(TO(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class bW{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}}class xW{constructor(e,t,n,i){xW.prototype.isMatrix2=!0,this.elements=[1,0,0,1],void 0!==e&&this.set(e,t,n,i)}identity(){return this.set(1,0,0,1),this}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,i){const r=this.elements;return r[0]=e,r[2]=t,r[1]=n,r[3]=i,this}}const SW=new PO;class EW{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new PO(1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PO(-1/0,-1/0);this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=SW.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,SW).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const wW=new DO,TW=new DO,MW=new DO,AW=new DO,CW=new DO,RW=new DO,LW=new DO;class PW{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new DO,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new DO;this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){wW.subVectors(e,this.start),TW.subVectors(this.end,this.start);const n=TW.dot(TW);let i=TW.dot(wW)/n;return t&&(i=TO(i,0,1)),i}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}distanceSqToLine3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:RW,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:LW;const i=1e-8*1e-8;let r,s;const a=this.start,o=e.start,l=this.end,c=e.end;MW.subVectors(l,a),AW.subVectors(c,o),CW.subVectors(a,o);const u=MW.dot(MW),d=AW.dot(AW),h=AW.dot(CW);if(u<=i&&d<=i)return t.copy(a),n.copy(o),t.sub(n),t.dot(t);if(u<=i)r=0,s=h/d,s=TO(s,0,1);else{const e=MW.dot(CW);if(d<=i)s=0,r=TO(-e/u,0,1);else{const t=MW.dot(AW),n=u*d-t*t;r=0!==n?TO((t*h-e*d)/n,0,1):0,s=(t*r+h)/d,s<0?(s=0,r=TO(-e/u,0,1)):s>1&&(s=1,r=TO((t-e)/u,0,1))}}return t.copy(a).add(MW.multiplyScalar(r)),n.copy(o).add(AW.multiplyScalar(s)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const IW=new DO;class DW extends sF{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new eB,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,o=32;s<o;s++,a++){const e=s/o*Math.PI*2,t=a/o*Math.PI*2;i.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}n.setAttribute("position",new YF(i,3));const r=new iH({fog:!1,toneMapped:!1});this.cone=new mH(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),IW.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(IW),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const kW=new DO,OW=new IN,NW=new IN;class FW extends mH{constructor(e){const t=BW(e),n=new eB,i=[],r=[];for(let o=0;o<t.length;o++){const e=t[o];e.parent&&e.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(0,0,0),r.push(0,0,0))}n.setAttribute("position",new YF(i,3)),n.setAttribute("color",new YF(r,3));super(n,new iH({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const s=new wF(255),a=new wF(65280);this.setColors(s,a)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");NW.copy(this.root.matrixWorld).invert();for(let r=0,s=0;r<t.length;r++){const e=t[r];e.parent&&e.parent.isBone&&(OW.multiplyMatrices(NW,e.matrixWorld),kW.setFromMatrixPosition(OW),i.setXYZ(s,kW.x,kW.y,kW.z),OW.multiplyMatrices(NW,e.parent.matrixWorld),kW.setFromMatrixPosition(OW),i.setXYZ(s+1,kW.x,kW.y,kW.z),s+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const n=this.geometry.getAttribute("color");for(let i=0;i<n.count;i+=2)n.setXYZ(i,e.r,e.g,e.b),n.setXYZ(i+1,t.r,t.g,t.b);return n.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function BW(e){const t=[];!0===e.isBone&&t.push(e);for(let n=0;n<e.children.length;n++)t.push(...BW(e.children[n]));return t}class UW extends hB{constructor(e,t,n){super(new Qz(t,4,2),new CF({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const HW=new DO,zW=new wF,GW=new wF;class VW extends sF{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const i=new Xz(t);i.rotateY(.5*Math.PI),this.material=new CF({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const r=i.getAttribute("position"),s=new Float32Array(3*r.count);i.setAttribute("color",new FF(s,3)),this.add(new hB(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");zW.copy(this.light.color),GW.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const i=e<n/2?zW:GW;t.setXYZ(e,i.r,i.g,i.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(HW.setFromMatrixPosition(this.light.matrixWorld).negate())}}class WW extends mH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;n=new wF(n),i=new wF(i);const r=t/2,s=e/t,a=e/2,o=[],l=[];for(let u=0,d=0,h=-a;u<=t;u++,h+=s){o.push(-a,0,h,a,0,h),o.push(h,0,-a,h,0,a);const e=u===r?n:i;e.toArray(l,d),d+=3,e.toArray(l,d),d+=3,e.toArray(l,d),d+=3,e.toArray(l,d),d+=3}const c=new eB;c.setAttribute("position",new YF(o,3)),c.setAttribute("color",new YF(l,3));super(c,new iH({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class jW extends mH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;r=new wF(r),s=new wF(s);const a=[],o=[];if(t>1)for(let c=0;c<t;c++){const n=c/t*(2*Math.PI),i=Math.sin(n)*e,l=Math.cos(n)*e;a.push(0,0,0),a.push(i,0,l);const u=1&c?r:s;o.push(u.r,u.g,u.b),o.push(u.r,u.g,u.b)}for(let c=0;c<n;c++){const t=1&c?r:s,l=e-e/n*c;for(let e=0;e<i;e++){let n=e/i*(2*Math.PI),r=Math.sin(n)*l,s=Math.cos(n)*l;a.push(r,0,s),o.push(t.r,t.g,t.b),n=(e+1)/i*(2*Math.PI),r=Math.sin(n)*l,s=Math.cos(n)*l,a.push(r,0,s),o.push(t.r,t.g,t.b)}}const l=new eB;l.setAttribute("position",new YF(a,3)),l.setAttribute("color",new YF(o,3));super(l,new iH({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const YW=new DO,XW=new DO,KW=new DO;class qW extends sF{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===t&&(t=1);let i=new eB;i.setAttribute("position",new YF([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new iH({fog:!1,toneMapped:!1});this.lightPlane=new dH(i,r),this.add(this.lightPlane),i=new eB,i.setAttribute("position",new YF([0,0,0,0,0,1],3)),this.targetLine=new dH(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),YW.setFromMatrixPosition(this.light.matrixWorld),XW.setFromMatrixPosition(this.light.target.matrixWorld),KW.subVectors(XW,YW),this.lightPlane.lookAt(XW),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(XW),this.targetLine.scale.z=KW.length()}}const JW=new DO,QW=new bB;class ZW extends mH{constructor(e){const t=new eB,n=new iH({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={};function a(e,t){o(e),o(t)}function o(e){i.push(0,0,0),r.push(0,0,0),void 0===s[e]&&(s[e]=[]),s[e].push(i.length/3-1)}a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4"),t.setAttribute("position",new YF(i,3)),t.setAttribute("color",new YF(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();const l=new wF(16755200),c=new wF(16711680),u=new wF(43775),d=new wF(16777215),h=new wF(3355443);this.setColors(l,c,u,d,h)}setColors(e,t,n,i,r){const s=this.geometry.getAttribute("color");return s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,n.r,n.g,n.b),s.setXYZ(33,n.r,n.g,n.b),s.setXYZ(34,n.r,n.g,n.b),s.setXYZ(35,n.r,n.g,n.b),s.setXYZ(36,n.r,n.g,n.b),s.setXYZ(37,n.r,n.g,n.b),s.setXYZ(38,i.r,i.g,i.b),s.setXYZ(39,i.r,i.g,i.b),s.setXYZ(40,r.r,r.g,r.b),s.setXYZ(41,r.r,r.g,r.b),s.setXYZ(42,r.r,r.g,r.b),s.setXYZ(43,r.r,r.g,r.b),s.setXYZ(44,r.r,r.g,r.b),s.setXYZ(45,r.r,r.g,r.b),s.setXYZ(46,r.r,r.g,r.b),s.setXYZ(47,r.r,r.g,r.b),s.setXYZ(48,r.r,r.g,r.b),s.setXYZ(49,r.r,r.g,r.b),s.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap;let n,i;if(QW.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),!0===this.camera.reversedDepth)n=1,i=0;else if(this.camera.coordinateSystem===tO)n=-1,i=1;else{if(this.camera.coordinateSystem!==nO)throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);n=0,i=1}$W("c",t,e,QW,0,0,n),$W("t",t,e,QW,0,0,i),$W("n1",t,e,QW,-1,-1,n),$W("n2",t,e,QW,1,-1,n),$W("n3",t,e,QW,-1,1,n),$W("n4",t,e,QW,1,1,n),$W("f1",t,e,QW,-1,-1,i),$W("f2",t,e,QW,1,-1,i),$W("f3",t,e,QW,-1,1,i),$W("f4",t,e,QW,1,1,i),$W("u1",t,e,QW,.7,1.1,n),$W("u2",t,e,QW,-.7,1.1,n),$W("u3",t,e,QW,0,2,n),$W("cf1",t,e,QW,-1,0,i),$W("cf2",t,e,QW,1,0,i),$W("cf3",t,e,QW,0,-1,i),$W("cf4",t,e,QW,0,1,i),$W("cn1",t,e,QW,-1,0,n),$W("cn2",t,e,QW,1,0,n),$W("cn3",t,e,QW,0,-1,n),$W("cn4",t,e,QW,0,1,n),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function $W(e,t,n,i,r,s,a){JW.set(r,s,a).unproject(i);const o=t[e];if(void 0!==o){const e=n.getAttribute("position");for(let t=0,n=o.length;t<n;t++)e.setXYZ(o[t],JW.x,JW.y,JW.z)}}const ej=new sN;class tj extends mH{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new eB;r.setIndex(new FF(n,1)),r.setAttribute("position",new FF(i,3)),super(r,new iH({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(void 0!==this.object&&ej.setFromObject(this.object),ej.isEmpty())return;const e=ej.min,t=ej.max,n=this.geometry.attributes.position,i=n.array;i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=e.x,i[4]=t.y,i[5]=t.z,i[6]=e.x,i[7]=e.y,i[8]=t.z,i[9]=t.x,i[10]=e.y,i[11]=t.z,i[12]=t.x,i[13]=t.y,i[14]=e.z,i[15]=e.x,i[16]=t.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=t.x,i[22]=e.y,i[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class nj extends mH{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new eB;i.setIndex(new FF(n,1)),i.setAttribute("position",new YF([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(i,new iH({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class ij extends dH{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960,i=new eB;i.setAttribute("position",new YF([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),i.computeBoundingSphere(),super(i,new iH({color:n,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const r=new eB;r.setAttribute("position",new YF([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),r.computeBoundingSphere(),this.add(new hB(r,new CF({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const rj=new DO;let sj,aj;class oj extends sF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new DO(0,0,1),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new DO(0,0,0),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*n,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*r;super(),this.type="ArrowHelper",void 0===sj&&(sj=new eB,sj.setAttribute("position",new YF([0,0,0,0,1,0],3)),aj=new NH(.5,1,5,1),aj.translate(0,-.5,0)),this.position.copy(t),this.line=new dH(sj,new iH({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new hB(aj,new CF({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,s)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{rj.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(rj,t)}}setLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class lj extends mH{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new eB;n.setAttribute("position",new YF(t,3)),n.setAttribute("color",new YF([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new iH({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const i=new wF,r=this.geometry.attributes.color.array;return i.set(e),i.toArray(r,0),i.toArray(r,3),i.set(t),i.toArray(r,6),i.toArray(r,9),i.set(n),i.toArray(r,12),i.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class cj{constructor(){this.type="ShapePath",this.color=new wF,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new dz,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,r,s){return this.currentPath.bezierCurveTo(e,t,n,i,r,s),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(e,t){const n=t.length;let i=!1;for(let r=n-1,s=0;s<n;r=s++){let n=t[r],a=t[s],o=a.x-n.x,l=a.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=t[s],o=-o,a=t[r],l=-l),e.y<n.y||e.y>a.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=l*(e.x-n.x)-o*(e.y-n.y);if(0===t)return!0;if(t<0)continue;i=!i}}else{if(e.y!==n.y)continue;if(a.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=a.x)return!0}}return i}const n=Hz.isClockWise,i=this.subPaths;if(0===i.length)return[];let r,s,a;const o=[];if(1===i.length)return s=i[0],a=new hz,a.curves=s.curves,o.push(a),o;let l=!n(i[0].getPoints());l=e?!l:l;const c=[],u=[];let d,h,f=[],p=0;u[p]=void 0,f[p]=[];for(let m=0,g=i.length;m<g;m++)s=i[m],d=s.getPoints(),r=n(d),r=e?!r:r,r?(!l&&u[p]&&p++,u[p]={s:new hz,p:d},u[p].s.curves=s.curves,l&&p++,f[p]=[]):f[p].push({h:s,p:d[0]});if(!u[0])return function(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n],r=new hz;r.curves=i.curves,t.push(r)}return t}(i);if(u.length>1){let e=!1,n=0;for(let t=0,i=u.length;t<i;t++)c[t]=[];for(let i=0,r=u.length;i<r;i++){const r=f[i];for(let s=0;s<r.length;s++){const a=r[s];let o=!0;for(let r=0;r<u.length;r++)t(a.p,u[r].p)&&(i!==r&&n++,o?(o=!1,c[r].push(a)):e=!0);o&&c[i].push(a)}}n>0&&!1===e&&(f=c)}for(let m=0,g=u.length;m<g;m++){a=u[m].s,o.push(a),h=f[m];for(let e=0,t=h.length;e<t;e++)a.holes.push(h[e].h)}return o}}class uj extends _O{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){void 0!==e?(null!==this.domElement&&this.disconnect(),this.domElement=e):gO("Controls: connect() now requires an element.")}disconnect(){}dispose(){}update(){}}function dj(e,t,n,i){const r=function(e){switch(e){case XI:case KI:return{byteLength:1,components:1};case JI:case qI:case eD:return{byteLength:2,components:1};case tD:case nD:return{byteLength:2,components:4};case ZI:case QI:case $I:return{byteLength:4,components:1};case rD:case sD:return{byteLength:4,components:3}}throw new Error("Unknown texture type ".concat(e,"."))}(i);switch(n){case aD:return e*t;case dD:case hD:return e*t/r.components*r.byteLength;case fD:case pD:return e*t*2/r.components*r.byteLength;case oD:return e*t*3/r.components*r.byteLength;case lD:case gD:return e*t*4/r.components*r.byteLength;case vD:case yD:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case _D:case bD:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case SD:case wD:return Math.max(e,16)*Math.max(t,8)/4;case xD:case ED:return Math.max(e,8)*Math.max(t,8)/2;case TD:case MD:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case AD:case CD:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case RD:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case LD:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case PD:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case ID:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case DD:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case kD:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case OD:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case ND:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case FD:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case BD:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case UD:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case HD:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case zD:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case GD:case VD:case WD:return Math.ceil(e/4)*Math.ceil(t/4)*16;case jD:case YD:return Math.ceil(e/4)*Math.ceil(t/4)*8;case XD:case KD:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error("Unable to determine texture byte length for ".concat(n," format."))}class hj{static contain(e,t){return function(e,t){const n=e.image&&e.image.width?e.image.width/e.image.height:1;return n>t?(e.repeat.x=1,e.repeat.y=n/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2):(e.repeat.x=t/n,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0),e}(e,t)}static cover(e,t){return function(e,t){const n=e.image&&e.image.width?e.image.width/e.image.height:1;return n>t?(e.repeat.x=t/n,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0):(e.repeat.x=1,e.repeat.y=n/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2),e}(e,t)}static fill(e){return function(e){return e.repeat.x=1,e.repeat.y=1,e.offset.x=0,e.offset.y=0,e}(e)}static getByteLength(e,t,n,i){return dj(e,t,n,i)}}function fj(){let e=null,t=!1,n=null,i=null;function r(t,s){n(t,s),i=e.requestAnimationFrame(r)}return{start:function(){!0!==t&&null!==n&&(i=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function pj(e){const t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const i=t.get(n);i&&(e.deleteBuffer(i.buffer),t.delete(n))},update:function(n,i){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){const e=t.get(n);return void((!e||e.version<n.version)&&t.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}const r=t.get(n);if(void 0===r)t.set(n,function(t,n){const i=t.array,r=t.usage,s=i.byteLength,a=e.createBuffer();let o;if(e.bindBuffer(n,a),e.bufferData(n,i,r),t.onUploadCallback(),i instanceof Float32Array)o=e.FLOAT;else if("undefined"!==typeof Float16Array&&i instanceof Float16Array)o=e.HALF_FLOAT;else if(i instanceof Uint16Array)o=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(i instanceof Int16Array)o=e.SHORT;else if(i instanceof Uint32Array)o=e.UNSIGNED_INT;else if(i instanceof Int32Array)o=e.INT;else if(i instanceof Int8Array)o=e.BYTE;else if(i instanceof Uint8Array)o=e.UNSIGNED_BYTE;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);o=e.UNSIGNED_BYTE}return{buffer:a,type:o,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version,size:s}}(n,i));else if(r.version<n.version){if(r.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,n,i){const r=n.array,s=n.updateRanges;if(e.bindBuffer(i,t),0===s.length)e.bufferSubData(i,0,r);else{s.sort((e,t)=>e.start-t.start);let t=0;for(let e=1;e<s.length;e++){const n=s[t],i=s[e];i.start<=n.start+n.count+1?n.count=Math.max(n.count,i.start+i.count-n.start):(++t,s[t]=i)}s.length=t+1;for(let n=0,a=s.length;n<a;n++){const t=s[n];e.bufferSubData(i,t.start*r.BYTES_PER_ELEMENT,r,t.start,t.count)}n.clearUpdateRanges()}n.onUploadCallback()}(r.buffer,n,i),r.version=n.version}}}}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:xP}})),"undefined"!==typeof window&&(window.__THREE__?gO("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=xP);const mj={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"uniform sampler2D dfgLUT;\nstruct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transpose( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 uv = vec2( roughness, dotNV );\n\treturn texture2D( dfgLUT, uv ).rg;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nvec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 dfgV = DFGApprox( vec3(0.0, 0.0, 1.0), vec3(sqrt(1.0 - dotNV * dotNV), 0.0, dotNV), material.roughness );\n\tvec2 dfgL = DFGApprox( vec3(0.0, 0.0, 1.0), vec3(sqrt(1.0 - dotNL * dotNL), 0.0, dotNL), material.roughness );\n\tvec3 FssEss_V = material.specularColor * dfgV.x + material.specularF90 * dfgV.y;\n\tvec3 FssEss_L = material.specularColor * dfgL.x + material.specularF90 * dfgL.y;\n\tfloat Ess_V = dfgV.x + dfgV.y;\n\tfloat Ess_L = dfgL.x + dfgL.y;\n\tfloat Ems_V = 1.0 - Ess_V;\n\tfloat Ems_L = 1.0 - Ess_L;\n\tvec3 Favg = material.specularColor + ( 1.0 - material.specularColor ) * 0.047619;\n\tvec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg * Favg + EPSILON );\n\tfloat compensationFactor = Ems_V * Ems_L;\n\tvec3 multiScatter = Fms * compensationFactor;\n\treturn singleScatter + multiScatter;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\tfloat depth = unpackRGBAToDepth( texture2D( depths, uv ) );\n\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\treturn step( depth, compare );\n\t\t#else\n\t\t\treturn step( compare, depth );\n\t\t#endif\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow( sampler2D shadow, vec2 uv, float compare ) {\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\tfloat hard_shadow = step( distribution.x, compare );\n\t\t#else\n\t\t\tfloat hard_shadow = step( compare, distribution.x );\n\t\t#endif\n\t\tif ( hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\tfloat fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];\n\t#else\n\t\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;\n\t#endif\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},gj={common:{diffuse:{value:new wF(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new NO},alphaMap:{value:null},alphaMapTransform:{value:new NO},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new NO}},envmap:{envMap:{value:null},envMapRotation:{value:new NO},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new NO}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new NO}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new NO},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new NO},normalScale:{value:new PO(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new NO},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new NO}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new NO}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new NO}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new wF(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new wF(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new NO},alphaTest:{value:0},uvTransform:{value:new NO}},sprite:{diffuse:{value:new wF(16777215)},opacity:{value:1},center:{value:new PO(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new NO},alphaMap:{value:null},alphaMapTransform:{value:new NO},alphaTest:{value:0}}},vj={basic:{uniforms:gB([gj.common,gj.specularmap,gj.envmap,gj.aomap,gj.lightmap,gj.fog]),vertexShader:mj.meshbasic_vert,fragmentShader:mj.meshbasic_frag},lambert:{uniforms:gB([gj.common,gj.specularmap,gj.envmap,gj.aomap,gj.lightmap,gj.emissivemap,gj.bumpmap,gj.normalmap,gj.displacementmap,gj.fog,gj.lights,{emissive:{value:new wF(0)}}]),vertexShader:mj.meshlambert_vert,fragmentShader:mj.meshlambert_frag},phong:{uniforms:gB([gj.common,gj.specularmap,gj.envmap,gj.aomap,gj.lightmap,gj.emissivemap,gj.bumpmap,gj.normalmap,gj.displacementmap,gj.fog,gj.lights,{emissive:{value:new wF(0)},specular:{value:new wF(1118481)},shininess:{value:30}}]),vertexShader:mj.meshphong_vert,fragmentShader:mj.meshphong_frag},standard:{uniforms:gB([gj.common,gj.envmap,gj.aomap,gj.lightmap,gj.emissivemap,gj.bumpmap,gj.normalmap,gj.displacementmap,gj.roughnessmap,gj.metalnessmap,gj.fog,gj.lights,{emissive:{value:new wF(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:mj.meshphysical_vert,fragmentShader:mj.meshphysical_frag},toon:{uniforms:gB([gj.common,gj.aomap,gj.lightmap,gj.emissivemap,gj.bumpmap,gj.normalmap,gj.displacementmap,gj.gradientmap,gj.fog,gj.lights,{emissive:{value:new wF(0)}}]),vertexShader:mj.meshtoon_vert,fragmentShader:mj.meshtoon_frag},matcap:{uniforms:gB([gj.common,gj.bumpmap,gj.normalmap,gj.displacementmap,gj.fog,{matcap:{value:null}}]),vertexShader:mj.meshmatcap_vert,fragmentShader:mj.meshmatcap_frag},points:{uniforms:gB([gj.points,gj.fog]),vertexShader:mj.points_vert,fragmentShader:mj.points_frag},dashed:{uniforms:gB([gj.common,gj.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:mj.linedashed_vert,fragmentShader:mj.linedashed_frag},depth:{uniforms:gB([gj.common,gj.displacementmap]),vertexShader:mj.depth_vert,fragmentShader:mj.depth_frag},normal:{uniforms:gB([gj.common,gj.bumpmap,gj.normalmap,gj.displacementmap,{opacity:{value:1}}]),vertexShader:mj.meshnormal_vert,fragmentShader:mj.meshnormal_frag},sprite:{uniforms:gB([gj.sprite,gj.fog]),vertexShader:mj.sprite_vert,fragmentShader:mj.sprite_frag},background:{uniforms:{uvTransform:{value:new NO},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:mj.background_vert,fragmentShader:mj.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new NO}},vertexShader:mj.backgroundCube_vert,fragmentShader:mj.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:mj.cube_vert,fragmentShader:mj.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:mj.equirect_vert,fragmentShader:mj.equirect_frag},distanceRGBA:{uniforms:gB([gj.common,gj.displacementmap,{referencePosition:{value:new DO},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:mj.distanceRGBA_vert,fragmentShader:mj.distanceRGBA_frag},shadow:{uniforms:gB([gj.lights,gj.fog,{color:{value:new wF(0)},opacity:{value:1}}]),vertexShader:mj.shadow_vert,fragmentShader:mj.shadow_frag}};vj.physical={uniforms:gB([vj.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new NO},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new NO},clearcoatNormalScale:{value:new PO(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new NO},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new NO},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new NO},sheen:{value:0},sheenColor:{value:new wF(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new NO},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new NO},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new NO},transmissionSamplerSize:{value:new PO},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new NO},attenuationDistance:{value:0},attenuationColor:{value:new wF(0)},specularColor:{value:new wF(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new NO},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new NO},anisotropyVector:{value:new PO},anisotropyMap:{value:null},anisotropyMapTransform:{value:new NO}}]),vertexShader:mj.meshphysical_vert,fragmentShader:mj.meshphysical_frag};const yj={r:0,b:0,g:0},_j=new GN,bj=new IN;function xj(e,t,n,i,r,s,a){const o=new wF(0);let l,c,u=!0===s?0:1,d=null,h=0,f=null;function p(e){let i=!0===e.isScene?e.background:null;if(i&&i.isTexture){i=(e.backgroundBlurriness>0?n:t).get(i)}return i}function m(t,n){t.getRGB(yj,vB(e)),i.buffers.color.setClear(yj.r,yj.g,yj.b,n,a)}return{getClearColor:function(){return o},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;o.set(e),u=t,m(o,u)},getClearAlpha:function(){return u},setClearAlpha:function(e){u=e,m(o,u)},render:function(t){let n=!1;const r=p(t);null===r?m(o,u):r&&r.isColor&&(m(r,1),n=!0);const s=e.xr.getEnvironmentBlendMode();"additive"===s?i.buffers.color.setClear(0,0,0,1,a):"alpha-blend"===s&&i.buffers.color.setClear(0,0,0,0,a),(e.autoClear||n)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,n){const i=p(n);i&&(i.isCubeTexture||i.mapping===DI)?(void 0===c&&(c=new hB(new pB(1,1,1),new _B({name:"BackgroundCubeMaterial",uniforms:mB(vj.backgroundCube.uniforms),vertexShader:vj.backgroundCube.vertexShader,fragmentShader:vj.backgroundCube.fragmentShader,side:DP,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),_j.copy(n.backgroundRotation),_j.x*=-1,_j.y*=-1,_j.z*=-1,i.isCubeTexture&&!1===i.isRenderTargetTexture&&(_j.y*=-1,_j.z*=-1),c.material.uniforms.envMap.value=i,c.material.uniforms.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(bj.makeRotationFromEuler(_j)),c.material.toneMapped=zO.getTransfer(i.colorSpace)!==_k,d===i&&h===i.version&&f===e.toneMapping||(c.material.needsUpdate=!0,d=i,h=i.version,f=e.toneMapping),c.layers.enableAll(),t.unshift(c,c.geometry,c.material,0,0,null)):i&&i.isTexture&&(void 0===l&&(l=new hB(new Kz(2,2),new _B({name:"BackgroundMaterial",uniforms:mB(vj.background.uniforms),vertexShader:vj.background.vertexShader,fragmentShader:vj.background.fragmentShader,side:IP,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=i,l.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,l.material.toneMapped=zO.getTransfer(i.colorSpace)!==_k,!0===i.matrixAutoUpdate&&i.updateMatrix(),l.material.uniforms.uvTransform.value.copy(i.matrix),d===i&&h===i.version&&f===e.toneMapping||(l.material.needsUpdate=!0,d=i,h=i.version,f=e.toneMapping),l.layers.enableAll(),t.unshift(l,l.geometry,l.material,0,0,null))},dispose:function(){void 0!==c&&(c.geometry.dispose(),c.material.dispose(),c=void 0),void 0!==l&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}}}function Sj(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS),i={},r=c(null);let s=r,a=!1;function o(t){return e.bindVertexArray(t)}function l(t){return e.deleteVertexArray(t)}function c(e){const t=[],i=[],r=[];for(let s=0;s<n;s++)t[s]=0,i[s]=0,r[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:i,attributeDivisors:r,object:e,attributes:{},index:null}}function u(){const e=s.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function d(e){h(e,0)}function h(t,n){const i=s.newAttributes,r=s.enabledAttributes,a=s.attributeDivisors;i[t]=1,0===r[t]&&(e.enableVertexAttribArray(t),r[t]=1),a[t]!==n&&(e.vertexAttribDivisor(t,n),a[t]=n)}function f(){const t=s.newAttributes,n=s.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==t[i]&&(e.disableVertexAttribArray(i),n[i]=0)}function p(t,n,i,r,s,a,o){!0===o?e.vertexAttribIPointer(t,n,i,s,a):e.vertexAttribPointer(t,n,i,r,s,a)}function m(){g(),a=!0,s!==r&&(s=r,o(s.object))}function g(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:function(n,r,l,m,g){let v=!1;const y=function(t,n,r){const s=!0===r.wireframe;let a=i[t.id];void 0===a&&(a={},i[t.id]=a);let o=a[n.id];void 0===o&&(o={},a[n.id]=o);let l=o[s];void 0===l&&(l=c(e.createVertexArray()),o[s]=l);return l}(m,l,r);s!==y&&(s=y,o(s.object)),v=function(e,t,n,i){const r=s.attributes,a=t.attributes;let o=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){const t=r[s];let n=a[s];if(void 0===n&&("instanceMatrix"===s&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===s&&e.instanceColor&&(n=e.instanceColor)),void 0===t)return!0;if(t.attribute!==n)return!0;if(n&&t.data!==n.data)return!0;o++}}return s.attributesNum!==o||s.index!==i}(n,m,l,g),v&&function(e,t,n,i){const r={},a=t.attributes;let o=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){let t=a[s];void 0===t&&("instanceMatrix"===s&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===s&&e.instanceColor&&(t=e.instanceColor));const n={};n.attribute=t,t&&t.data&&(n.data=t.data),r[s]=n,o++}}s.attributes=r,s.attributesNum=o,s.index=i}(n,m,l,g),null!==g&&t.update(g,e.ELEMENT_ARRAY_BUFFER),(v||a)&&(a=!1,function(n,i,r,s){u();const a=s.attributes,o=r.getAttributes(),l=i.defaultAttributeValues;for(const c in o){const i=o[c];if(i.location>=0){let r=a[c];if(void 0===r&&("instanceMatrix"===c&&n.instanceMatrix&&(r=n.instanceMatrix),"instanceColor"===c&&n.instanceColor&&(r=n.instanceColor)),void 0!==r){const a=r.normalized,o=r.itemSize,l=t.get(r);if(void 0===l)continue;const c=l.buffer,u=l.type,f=l.bytesPerElement,m=u===e.INT||u===e.UNSIGNED_INT||r.gpuType===QI;if(r.isInterleavedBufferAttribute){const t=r.data,l=t.stride,g=r.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<i.locationSize;e++)h(i.location+e,t.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<i.locationSize;e++)d(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)p(i.location+e,o/i.locationSize,u,a,l*f,(g+o/i.locationSize*e)*f,m)}else{if(r.isInstancedBufferAttribute){for(let e=0;e<i.locationSize;e++)h(i.location+e,r.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=r.meshPerAttribute*r.count)}else for(let e=0;e<i.locationSize;e++)d(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)p(i.location+e,o/i.locationSize,u,a,o*f,o/i.locationSize*e*f,m)}}else if(void 0!==l){const t=l[c];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(i.location,t);break;case 3:e.vertexAttrib3fv(i.location,t);break;case 4:e.vertexAttrib4fv(i.location,t);break;default:e.vertexAttrib1fv(i.location,t)}}}}f()}(n,r,l,m),null!==g&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(g).buffer))},reset:m,resetDefaultState:g,dispose:function(){m();for(const e in i){const t=i[e];for(const e in t){const n=t[e];for(const e in n)l(n[e].object),delete n[e];delete t[e]}delete i[e]}},releaseStatesOfGeometry:function(e){if(void 0===i[e.id])return;const t=i[e.id];for(const n in t){const e=t[n];for(const t in e)l(e[t].object),delete e[t];delete t[n]}delete i[e.id]},releaseStatesOfProgram:function(e){for(const t in i){const n=i[t];if(void 0===n[e.id])continue;const r=n[e.id];for(const e in r)l(r[e].object),delete r[e];delete n[e.id]}},initAttributes:u,enableAttribute:d,disableUnusedAttributes:f}}function Ej(e,t,n){let i;function r(t,r,s){0!==s&&(e.drawArraysInstanced(i,t,r,s),n.update(r,i,s))}this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i,1)},this.renderInstances=r,this.renderMultiDraw=function(e,r,s){if(0===s)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,e,0,r,0,s);let a=0;for(let t=0;t<s;t++)a+=r[t];n.update(a,i,1)},this.renderMultiDrawInstances=function(e,s,a,o){if(0===a)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)r(e[t],s[t],o[t]);else{l.multiDrawArraysInstancedWEBGL(i,e,0,s,0,o,0,a);let t=0;for(let e=0;e<a;e++)t+=s[e]*o[e];n.update(t,i,1)}}}function wj(e,t,n,i){let r;function s(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let a=void 0!==n.precision?n.precision:"highp";const o=s(a);o!==a&&(gO("WebGLRenderer:",a,"not supported, using",o,"instead."),a=o);const l=!0===n.logarithmicDepthBuffer,c=!0===n.reversedDepthBuffer&&t.has("EXT_clip_control"),u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:s,textureFormatReadable:function(t){return t===lD||i.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const r=n===eD&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(n!==XI&&i.convert(n)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==$I&&!r)},precision:a,logarithmicDepthBuffer:l,reversedDepthBuffer:c,maxTextures:u,maxVertexTextures:d,maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubemapSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:e.getParameter(e.MAX_VERTEX_ATTRIBS),maxVertexUniforms:e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:e.getParameter(e.MAX_VARYING_VECTORS),maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:d>0,maxSamples:e.getParameter(e.MAX_SAMPLES)}}function Tj(e){const t=this;let n=null,i=0,r=!1,s=!1;const a=new LU,o=new NO,l={value:null,needsUpdate:!1};function c(e,n,i,r){const s=null!==e?e.length:0;let c=null;if(0!==s){if(c=l.value,!0!==r||null===c){const t=i+4*s,r=n.matrixWorldInverse;o.getNormalMatrix(r),(null===c||c.length<t)&&(c=new Float32Array(t));for(let n=0,l=i;n!==s;++n,l+=4)a.copy(e[n]).applyMatrix4(r,o),a.normal.toArray(c,l),c[l+3]=a.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const n=0!==e.length||t||0!==i||r;return r=t,i=e.length,n},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(e,t){n=c(e,t,0)},this.setState=function(a,o,u){const d=a.clippingPlanes,h=a.clipIntersection,f=a.clipShadows,p=e.get(a);if(!r||null===d||0===d.length||s&&!f)s?c(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=i>0);t.numPlanes=i,t.numIntersection=0}();else{const e=s?0:i,t=4*e;let r=p.clippingState||null;l.value=r,r=c(d,o,t,u);for(let i=0;i!==t;++i)r[i]=n[i];p.clippingState=r,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=e}}}function Mj(e){let t=new WeakMap;function n(e,t){return t===PI?e.mapping=RI:t===II&&(e.mapping=LI),e}function i(e){const n=e.target;n.removeEventListener("dispose",i);const r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping;if(s===PI||s===II){if(t.has(r)){return n(t.get(r).texture,r.mapping)}{const s=r.image;if(s&&s.height>0){const a=new CB(s.height);return a.fromEquirectangularTexture(e,r),t.set(r,a),r.addEventListener("dispose",i),n(a.texture,r.mapping)}return null}}}return r},dispose:function(){t=new WeakMap}}}const Aj=[.125,.215,.35,.446,.526,.582],Cj=20,Rj=new uV,Lj=new wF;let Pj=null,Ij=0,Dj=0,kj=!1;const Oj=new DO;class Nj{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const{size:s=256,position:a=Oj}=r;Pj=this._renderer.getRenderTarget(),Ij=this._renderer.getActiveCubeFace(),Dj=this._renderer.getActiveMipmapLevel(),kj=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(s);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,n,i,o,a),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Hj(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Uj(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose(),null!==this._backgroundBox&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._ggxMaterial&&this._ggxMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(Pj,Ij,Dj),this._renderer.xr.enabled=kj,e.scissorTest=!1,Bj(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===RI||e.mapping===LI?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Pj=this._renderer.getRenderTarget(),Ij=this._renderer.getActiveCubeFace(),Dj=this._renderer.getActiveMipmapLevel(),kj=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:GI,minFilter:GI,generateMipmaps:!1,type:eD,format:lD,colorSpace:vk,depthBuffer:!1},i=Fj(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Fj(e,t,n);const{_lodMax:i}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=function(e){const t=[],n=[],i=[];let r=e;const s=e-4+1+Aj.length;for(let a=0;a<s;a++){const s=Math.pow(2,r);t.push(s);let o=1/s;a>e-4?o=Aj[a-e+4-1]:0===a&&(o=0),n.push(o);const l=1/(s-2),c=-l,u=1+l,d=[c,c,u,c,u,u,c,c,u,u,c,u],h=6,f=6,p=3,m=2,g=1,v=new Float32Array(p*f*h),y=new Float32Array(m*f*h),_=new Float32Array(g*f*h);for(let e=0;e<h;e++){const t=e%3*2/3-1,n=e>2?0:-1,i=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];v.set(i,p*f*e),y.set(d,m*f*e);const r=[e,e,e,e,e,e];_.set(r,g*f*e)}const b=new eB;b.setAttribute("position",new FF(v,p)),b.setAttribute("uv",new FF(y,m)),b.setAttribute("faceIndex",new FF(_,g)),i.push(new hB(b,null)),r>4&&r--}return{lodMeshes:i,sizeLods:t,sigmas:n}}(i)),this._blurMaterial=function(e,t,n){const i=new Float32Array(Cj),r=new DO(0,1,0),s=new _B({name:"SphericalGaussianBlur",defines:{n:Cj,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:OP,depthTest:!1,depthWrite:!1});return s}(i,e,t),this._ggxMaterial=function(e,t,n){const i=new _B({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:256,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:'\n\n\t\t\tprecision highp float;\n\t\t\tprecision highp int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform float roughness;\n\t\t\tuniform float mipInt;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\t#define PI 3.14159265359\n\n\t\t\t// Van der Corput radical inverse\n\t\t\tfloat radicalInverse_VdC(uint bits) {\n\t\t\t\tbits = (bits << 16u) | (bits >> 16u);\n\t\t\t\tbits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);\n\t\t\t\tbits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);\n\t\t\t\tbits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);\n\t\t\t\tbits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);\n\t\t\t\treturn float(bits) * 2.3283064365386963e-10; // / 0x100000000\n\t\t\t}\n\n\t\t\t// Hammersley sequence\n\t\t\tvec2 hammersley(uint i, uint N) {\n\t\t\t\treturn vec2(float(i) / float(N), radicalInverse_VdC(i));\n\t\t\t}\n\n\t\t\t// GGX VNDF importance sampling (Eric Heitz 2018)\n\t\t\t// "Sampling the GGX Distribution of Visible Normals"\n\t\t\t// https://jcgt.org/published/0007/04/01/\n\t\t\tvec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {\n\t\t\t\tfloat alpha = roughness * roughness;\n\n\t\t\t\t// Section 3.2: Transform view direction to hemisphere configuration\n\t\t\t\tvec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));\n\n\t\t\t\t// Section 4.1: Orthonormal basis\n\t\t\t\tfloat lensq = Vh.x * Vh.x + Vh.y * Vh.y;\n\t\t\t\tvec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);\n\t\t\t\tvec3 T2 = cross(Vh, T1);\n\n\t\t\t\t// Section 4.2: Parameterization of projected area\n\t\t\t\tfloat r = sqrt(Xi.x);\n\t\t\t\tfloat phi = 2.0 * PI * Xi.y;\n\t\t\t\tfloat t1 = r * cos(phi);\n\t\t\t\tfloat t2 = r * sin(phi);\n\t\t\t\tfloat s = 0.5 * (1.0 + Vh.z);\n\t\t\t\tt2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;\n\n\t\t\t\t// Section 4.3: Reprojection onto hemisphere\n\t\t\t\tvec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;\n\n\t\t\t\t// Section 3.4: Transform back to ellipsoid configuration\n\t\t\t\treturn normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\tvec3 N = normalize(vOutputDirection);\n\t\t\t\tvec3 V = N; // Assume view direction equals normal for pre-filtering\n\n\t\t\t\tvec3 prefilteredColor = vec3(0.0);\n\t\t\t\tfloat totalWeight = 0.0;\n\n\t\t\t\t// For very low roughness, just sample the environment directly\n\t\t\t\tif (roughness < 0.001) {\n\t\t\t\t\tgl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Tangent space basis for VNDF sampling\n\t\t\t\tvec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n\t\t\t\tvec3 tangent = normalize(cross(up, N));\n\t\t\t\tvec3 bitangent = cross(N, tangent);\n\n\t\t\t\tfor(uint i = 0u; i < uint(GGX_SAMPLES); i++) {\n\t\t\t\t\tvec2 Xi = hammersley(i, uint(GGX_SAMPLES));\n\n\t\t\t\t\t// For PMREM, V = N, so in tangent space V is always (0, 0, 1)\n\t\t\t\t\tvec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);\n\n\t\t\t\t\t// Transform H back to world space\n\t\t\t\t\tvec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);\n\t\t\t\t\tvec3 L = normalize(2.0 * dot(V, H) * H - V);\n\n\t\t\t\t\tfloat NdotL = max(dot(N, L), 0.0);\n\n\t\t\t\t\tif(NdotL > 0.0) {\n\t\t\t\t\t\t// Sample environment at fixed mip level\n\t\t\t\t\t\t// VNDF importance sampling handles the distribution filtering\n\t\t\t\t\t\tvec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);\n\n\t\t\t\t\t\t// Weight by NdotL for the split-sum approximation\n\t\t\t\t\t\t// VNDF PDF naturally accounts for the visible microfacet distribution\n\t\t\t\t\t\tprefilteredColor += sampleColor * NdotL;\n\t\t\t\t\t\ttotalWeight += NdotL;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (totalWeight > 0.0) {\n\t\t\t\t\tprefilteredColor = prefilteredColor / totalWeight;\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = vec4(prefilteredColor, 1.0);\n\t\t\t}\n\t\t',blending:OP,depthTest:!1,depthWrite:!1});return i}(i,e,t)}return i}_compileMaterial(e){const t=new hB(new eB,e);this._renderer.compile(t,Rj)}_sceneToCubeUV(e,t,n,i,r){const s=new wB(90,1,t,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],l=this._renderer,c=l.autoClear,u=l.toneMapping;l.getClearColor(Lj),l.toneMapping=yI,l.autoClear=!1;l.state.buffers.depth.getReversed()&&(l.setRenderTarget(i),l.clearDepth(),l.setRenderTarget(null)),null===this._backgroundBox&&(this._backgroundBox=new hB(new pB,new CF({name:"PMREM.Background",side:DP,depthWrite:!1,depthTest:!1})));const d=this._backgroundBox,h=d.material;let f=!1;const p=e.background;p?p.isColor&&(h.color.copy(p),e.background=null,f=!0):(h.color.copy(Lj),f=!0);for(let m=0;m<6;m++){const t=m%3;0===t?(s.up.set(0,a[m],0),s.position.set(r.x,r.y,r.z),s.lookAt(r.x+o[m],r.y,r.z)):1===t?(s.up.set(0,0,a[m]),s.position.set(r.x,r.y,r.z),s.lookAt(r.x,r.y+o[m],r.z)):(s.up.set(0,a[m],0),s.position.set(r.x,r.y,r.z),s.lookAt(r.x,r.y,r.z+o[m]));const n=this._cubeSize;Bj(i,t*n,m>2?n:0,n,n),l.setRenderTarget(i),f&&l.render(d,s),l.render(e,s)}l.toneMapping=u,l.autoClear=c,e.background=p}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===RI||e.mapping===LI;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=Hj()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Uj());const r=i?this._cubemapMaterial:this._equirectMaterial,s=this._lodMeshes[0];s.material=r;r.uniforms.envMap.value=e;const a=this._cubeSize;Bj(t,0,0,3*a,2*a),n.setRenderTarget(t),n.render(s,Rj)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const i=this._lodMeshes.length;for(let r=1;r<i;r++)this._applyGGXFilter(e,r-1,r);t.autoClear=n}_applyGGXFilter(e,t,n){const i=this._renderer,r=this._pingPongRenderTarget,s=this._ggxMaterial,a=this._lodMeshes[n];a.material=s;const o=s.uniforms,l=n/(this._lodMeshes.length-1),c=t/(this._lodMeshes.length-1),u=Math.sqrt(l*l-c*c)*(.05+.95*l),{_lodMax:d}=this,h=this._sizeLods[n],f=3*h*(n>d-4?n-d+4:0),p=4*(this._cubeSize-h);o.envMap.value=e.texture,o.roughness.value=u,o.mipInt.value=d-t,Bj(r,f,p,3*h,2*h),i.setRenderTarget(r),i.render(a,Rj),o.envMap.value=r.texture,o.roughness.value=0,o.mipInt.value=d-n,Bj(e,f,p,3*h,2*h),i.setRenderTarget(e),i.render(a,Rj)}_blur(e,t,n,i,r){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,n,i,"latitudinal",r),this._halfBlur(s,e,n,n,i,"longitudinal",r)}_halfBlur(e,t,n,i,r,s,a){const o=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&vO("blur direction must be either latitudinal or longitudinal!");const c=this._lodMeshes[i];c.material=l;const u=l.uniforms,d=this._sizeLods[n]-1,h=isFinite(r)?Math.PI/(2*d):2*Math.PI/39,f=r/h,p=isFinite(r)?1+Math.floor(3*f):Cj;p>Cj&&gO("sigmaRadians, ".concat(r,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(Cj));const m=[];let g=0;for(let _=0;_<Cj;++_){const e=_/f,t=Math.exp(-e*e/2);m.push(t),0===_?g+=t:_<p&&(g+=2*t)}for(let _=0;_<m.length;_++)m[_]=m[_]/g;u.envMap.value=e.texture,u.samples.value=p,u.weights.value=m,u.latitudinal.value="latitudinal"===s,a&&(u.poleAxis.value=a);const{_lodMax:v}=this;u.dTheta.value=h,u.mipInt.value=v-n;const y=this._sizeLods[i];Bj(t,3*y*(i>v-4?i-v+4:0),4*(this._cubeSize-y),3*y,2*y),o.setRenderTarget(t),o.render(c,Rj)}}function Fj(e,t,n){const i=new eN(e,t,n);return i.texture.mapping=DI,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Bj(e,t,n,i,r){e.viewport.set(t,n,i,r),e.scissor.set(t,n,i,r)}function Uj(){return new _B({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:OP,depthTest:!1,depthWrite:!1})}function Hj(){return new _B({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:OP,depthTest:!1,depthWrite:!1})}function zj(e){let t=new WeakMap,n=null;function i(e){const n=e.target;n.removeEventListener("dispose",i);const r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping,a=s===PI||s===II,o=s===RI||s===LI;if(a||o){let s=t.get(r);const l=void 0!==s?s.texture.pmremVersion:0;if(r.isRenderTargetTexture&&r.pmremVersion!==l)return null===n&&(n=new Nj(e)),s=a?n.fromEquirectangular(r,s):n.fromCubemap(r,s),s.texture.pmremVersion=r.pmremVersion,t.set(r,s),s.texture;if(void 0!==s)return s.texture;{const l=r.image;return a&&l&&l.height>0||o&&l&&function(e){let t=0;const n=6;for(let i=0;i<n;i++)void 0!==e[i]&&t++;return t===n}(l)?(null===n&&(n=new Nj(e)),s=a?n.fromEquirectangular(r):n.fromCubemap(r),s.texture.pmremVersion=r.pmremVersion,t.set(r,s),r.addEventListener("dispose",i),s.texture):null}}}return r},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function Gj(e){const t={};function n(n){if(void 0!==t[n])return t[n];const i=e.getExtension(n);return t[n]=i,i}return{has:function(e){return null!==n(e)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(e){const t=n(e);return null===t&&yO("WebGLRenderer: "+e+" extension not supported."),t}}}function Vj(e,t,n,i){const r={},s=new WeakMap;function a(e){const o=e.target;null!==o.index&&t.remove(o.index);for(const n in o.attributes)t.remove(o.attributes[n]);o.removeEventListener("dispose",a),delete r[o.id];const l=s.get(o);l&&(t.remove(l),s.delete(o)),i.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,n.memory.geometries--}function o(e){const n=[],i=e.index,r=e.attributes.position;let a=0;if(null!==i){const e=i.array;a=i.version;for(let t=0,i=e.length;t<i;t+=3){const i=e[t+0],r=e[t+1],s=e[t+2];n.push(i,r,r,s,s,i)}}else{if(void 0===r)return;{const e=r.array;a=r.version;for(let t=0,i=e.length/3-1;t<i;t+=3){const e=t+0,i=t+1,r=t+2;n.push(e,i,i,r,r,e)}}}const o=new(aO(n)?WF:GF)(n,1);o.version=a;const l=s.get(e);l&&t.remove(l),s.set(e,o)}return{get:function(e,t){return!0===r[t.id]||(t.addEventListener("dispose",a),r[t.id]=!0,n.memory.geometries++),t},update:function(n){const i=n.attributes;for(const r in i)t.update(i[r],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){const t=s.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&o(e)}else o(e);return s.get(e)}}}function Wj(e,t,n){let i,r,s;function a(t,a,o){0!==o&&(e.drawElementsInstanced(i,a,r,t*s,o),n.update(a,i,o))}this.setMode=function(e){i=e},this.setIndex=function(e){r=e.type,s=e.bytesPerElement},this.render=function(t,a){e.drawElements(i,a,r,t*s),n.update(a,i,1)},this.renderInstances=a,this.renderMultiDraw=function(e,s,a){if(0===a)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,s,0,r,e,0,a);let o=0;for(let t=0;t<a;t++)o+=s[t];n.update(o,i,1)},this.renderMultiDrawInstances=function(e,o,l,c){if(0===l)return;const u=t.get("WEBGL_multi_draw");if(null===u)for(let t=0;t<e.length;t++)a(e[t]/s,o[t],c[t]);else{u.multiDrawElementsInstancedWEBGL(i,o,0,r,e,0,c,0,l);let t=0;for(let e=0;e<l;e++)t+=o[e]*c[e];n.update(t,i,1)}}}function jj(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,i,r){switch(t.calls++,i){case e.TRIANGLES:t.triangles+=r*(n/3);break;case e.LINES:t.lines+=r*(n/2);break;case e.LINE_STRIP:t.lines+=r*(n-1);break;case e.LINE_LOOP:t.lines+=r*n;break;case e.POINTS:t.points+=r*n;break;default:vO("WebGLInfo: Unknown draw mode:",i)}}}}function Yj(e,t,n){const i=new WeakMap,r=new ZO;return{update:function(s,a,o){const l=s.morphTargetInfluences,c=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,u=void 0!==c?c.length:0;let d=i.get(a);if(void 0===d||d.count!==u){void 0!==d&&d.texture.dispose();const h=void 0!==a.morphAttributes.position,f=void 0!==a.morphAttributes.normal,p=void 0!==a.morphAttributes.color,m=a.morphAttributes.position||[],g=a.morphAttributes.normal||[],v=a.morphAttributes.color||[];let y=0;!0===h&&(y=1),!0===f&&(y=2),!0===p&&(y=3);let _=a.attributes.position.count*y,b=1;_>t.maxTextureSize&&(b=Math.ceil(_/t.maxTextureSize),_=t.maxTextureSize);const x=new Float32Array(_*b*4*u),S=new tN(x,_,b,u);S.type=$I,S.needsUpdate=!0;const E=4*y;for(let T=0;T<u;T++){const M=m[T],A=g[T],C=v[T],R=_*b*4*T;for(let L=0;L<M.count;L++){const P=L*E;!0===h&&(r.fromBufferAttribute(M,L),x[R+P+0]=r.x,x[R+P+1]=r.y,x[R+P+2]=r.z,x[R+P+3]=0),!0===f&&(r.fromBufferAttribute(A,L),x[R+P+4]=r.x,x[R+P+5]=r.y,x[R+P+6]=r.z,x[R+P+7]=0),!0===p&&(r.fromBufferAttribute(C,L),x[R+P+8]=r.x,x[R+P+9]=r.y,x[R+P+10]=r.z,x[R+P+11]=4===C.itemSize?r.w:1)}}function w(){S.dispose(),i.delete(a),a.removeEventListener("dispose",w)}d={count:u,texture:S,size:new PO(_,b)},i.set(a,d),a.addEventListener("dispose",w)}if(!0===s.isInstancedMesh&&null!==s.morphTexture)o.getUniforms().setValue(e,"morphTexture",s.morphTexture,n);else{let I=0;for(let k=0;k<l.length;k++)I+=l[k];const D=a.morphTargetsRelative?1:1-I;o.getUniforms().setValue(e,"morphTargetBaseInfluence",D),o.getUniforms().setValue(e,"morphTargetInfluences",l)}o.getUniforms().setValue(e,"morphTargetsTexture",d.texture,n),o.getUniforms().setValue(e,"morphTargetsTextureSize",d.size)}}}function Xj(e,t,n,i){let r=new WeakMap;function s(e){const t=e.target;t.removeEventListener("dispose",s),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(a){const o=i.render.frame,l=a.geometry,c=t.get(a,l);if(r.get(c)!==o&&(t.update(c),r.set(c,o)),a.isInstancedMesh&&(!1===a.hasEventListener("dispose",s)&&a.addEventListener("dispose",s),r.get(a)!==o&&(n.update(a.instanceMatrix,e.ARRAY_BUFFER),null!==a.instanceColor&&n.update(a.instanceColor,e.ARRAY_BUFFER),r.set(a,o))),a.isSkinnedMesh){const e=a.skeleton;r.get(e)!==o&&(e.update(),r.set(e,o))}return c},dispose:function(){r=new WeakMap}}}const Kj=new QO,qj=new PH(1,1),Jj=new tN,Qj=new iN,Zj=new AB,$j=[],eY=[],tY=new Float32Array(16),nY=new Float32Array(9),iY=new Float32Array(4);function rY(e,t,n){const i=e[0];if(i<=0||i>0)return e;const r=t*n;let s=$j[r];if(void 0===s&&(s=new Float32Array(r),$j[r]=s),0!==t){i.toArray(s,0);for(let i=1,r=0;i!==t;++i)r+=n,e[i].toArray(s,r)}return s}function sY(e,t){if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function aY(e,t){for(let n=0,i=t.length;n<i;n++)e[n]=t[n]}function oY(e,t){let n=eY[t];void 0===n&&(n=new Int32Array(t),eY[t]=n);for(let i=0;i!==t;++i)n[i]=e.allocateTextureUnit();return n}function lY(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function cY(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(sY(n,t))return;e.uniform2fv(this.addr,t),aY(n,t)}}function uY(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(sY(n,t))return;e.uniform3fv(this.addr,t),aY(n,t)}}function dY(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(sY(n,t))return;e.uniform4fv(this.addr,t),aY(n,t)}}function hY(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(sY(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),aY(n,t)}else{if(sY(n,i))return;iY.set(i),e.uniformMatrix2fv(this.addr,!1,iY),aY(n,i)}}function fY(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(sY(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),aY(n,t)}else{if(sY(n,i))return;nY.set(i),e.uniformMatrix3fv(this.addr,!1,nY),aY(n,i)}}function pY(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(sY(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),aY(n,t)}else{if(sY(n,i))return;tY.set(i),e.uniformMatrix4fv(this.addr,!1,tY),aY(n,i)}}function mY(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function gY(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(sY(n,t))return;e.uniform2iv(this.addr,t),aY(n,t)}}function vY(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(sY(n,t))return;e.uniform3iv(this.addr,t),aY(n,t)}}function yY(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(sY(n,t))return;e.uniform4iv(this.addr,t),aY(n,t)}}function _Y(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function bY(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(sY(n,t))return;e.uniform2uiv(this.addr,t),aY(n,t)}}function xY(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(sY(n,t))return;e.uniform3uiv(this.addr,t),aY(n,t)}}function SY(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(sY(n,t))return;e.uniform4uiv(this.addr,t),aY(n,t)}}function EY(e,t,n){const i=this.cache,r=n.allocateTextureUnit();let s;i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),this.type===e.SAMPLER_2D_SHADOW?(qj.compareFunction=Uk,s=qj):s=Kj,n.setTexture2D(t||s,r)}function wY(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(t||Qj,r)}function TY(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(t||Zj,r)}function MY(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(t||Jj,r)}function AY(e,t){e.uniform1fv(this.addr,t)}function CY(e,t){const n=rY(t,this.size,2);e.uniform2fv(this.addr,n)}function RY(e,t){const n=rY(t,this.size,3);e.uniform3fv(this.addr,n)}function LY(e,t){const n=rY(t,this.size,4);e.uniform4fv(this.addr,n)}function PY(e,t){const n=rY(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function IY(e,t){const n=rY(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function DY(e,t){const n=rY(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function kY(e,t){e.uniform1iv(this.addr,t)}function OY(e,t){e.uniform2iv(this.addr,t)}function NY(e,t){e.uniform3iv(this.addr,t)}function FY(e,t){e.uniform4iv(this.addr,t)}function BY(e,t){e.uniform1uiv(this.addr,t)}function UY(e,t){e.uniform2uiv(this.addr,t)}function HY(e,t){e.uniform3uiv(this.addr,t)}function zY(e,t){e.uniform4uiv(this.addr,t)}function GY(e,t,n){const i=this.cache,r=t.length,s=oY(n,r);sY(i,s)||(e.uniform1iv(this.addr,s),aY(i,s));for(let a=0;a!==r;++a)n.setTexture2D(t[a]||Kj,s[a])}function VY(e,t,n){const i=this.cache,r=t.length,s=oY(n,r);sY(i,s)||(e.uniform1iv(this.addr,s),aY(i,s));for(let a=0;a!==r;++a)n.setTexture3D(t[a]||Qj,s[a])}function WY(e,t,n){const i=this.cache,r=t.length,s=oY(n,r);sY(i,s)||(e.uniform1iv(this.addr,s),aY(i,s));for(let a=0;a!==r;++a)n.setTextureCube(t[a]||Zj,s[a])}function jY(e,t,n){const i=this.cache,r=t.length,s=oY(n,r);sY(i,s)||(e.uniform1iv(this.addr,s),aY(i,s));for(let a=0;a!==r;++a)n.setTexture2DArray(t[a]||Jj,s[a])}class YY{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return lY;case 35664:return cY;case 35665:return uY;case 35666:return dY;case 35674:return hY;case 35675:return fY;case 35676:return pY;case 5124:case 35670:return mY;case 35667:case 35671:return gY;case 35668:case 35672:return vY;case 35669:case 35673:return yY;case 5125:return _Y;case 36294:return bY;case 36295:return xY;case 36296:return SY;case 35678:case 36198:case 36298:case 36306:case 35682:return EY;case 35679:case 36299:case 36307:return wY;case 35680:case 36300:case 36308:case 36293:return TY;case 36289:case 36303:case 36311:case 36292:return MY}}(t.type)}}class XY{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return AY;case 35664:return CY;case 35665:return RY;case 35666:return LY;case 35674:return PY;case 35675:return IY;case 35676:return DY;case 5124:case 35670:return kY;case 35667:case 35671:return OY;case 35668:case 35672:return NY;case 35669:case 35673:return FY;case 5125:return BY;case 36294:return UY;case 36295:return HY;case 36296:return zY;case 35678:case 36198:case 36298:case 36306:case 35682:return GY;case 35679:case 36299:case 36307:return VY;case 35680:case 36300:case 36308:case 36293:return WY;case 36289:case 36303:case 36311:case 36292:return jY}}(t.type)}}class KY{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const s=i[r];s.setValue(e,t[s.id],n)}}}const qY=/(\w+)(\])?(\[|\.)?/g;function JY(e,t){e.seq.push(t),e.map[t.id]=t}function QY(e,t,n){const i=e.name,r=i.length;for(qY.lastIndex=0;;){const s=qY.exec(i),a=qY.lastIndex;let o=s[1];const l="]"===s[2],c=s[3];if(l&&(o|=0),void 0===c||"["===c&&a+2===r){JY(n,void 0===c?new YY(o,e,t):new XY(o,e,t));break}{let e=n.map[o];void 0===e&&(e=new KY(o),JY(n,e)),n=e}}}class ZY{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const n=e.getActiveUniform(t,i);QY(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,i){const r=this.map[t];void 0!==r&&r.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];void 0!==i&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let r=0,s=t.length;r!==s;++r){const s=t[r],a=n[s.id];!1!==a.needsUpdate&&s.setValue(e,a.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,r=e.length;i!==r;++i){const r=e[i];r.id in t&&n.push(r)}return n}}function $Y(e,t,n){const i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),i}let eX=0;const tX=new NO;function nX(e,t,n){const i=e.getShaderParameter(t,e.COMPILE_STATUS),r=(e.getShaderInfoLog(t)||"").trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const i=parseInt(s[1]);return n.toUpperCase()+"\n\n"+r+"\n\n"+function(e,t){const n=e.split("\n"),i=[],r=Math.max(t-6,0),s=Math.min(t+6,n.length);for(let a=r;a<s;a++){const e=a+1;i.push("".concat(e===t?">":" "," ").concat(e,": ").concat(n[a]))}return i.join("\n")}(e.getShaderSource(t),i)}return r}function iX(e,t){const n=function(e){zO._getMatrix(tX,zO.workingColorSpace,e);const t="mat3( ".concat(tX.elements.map(e=>e.toFixed(4))," )");switch(zO.getTransfer(e)){case yk:return[t,"LinearTransferOETF"];case _k:return[t,"sRGBTransferOETF"];default:return gO("WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}(t);return["vec4 ".concat(e,"( vec4 value ) {"),"\treturn ".concat(n[1],"( vec4( value.rgb * ").concat(n[0],", value.a ) );"),"}"].join("\n")}function rX(e,t){let n;switch(t){case _I:n="Linear";break;case bI:n="Reinhard";break;case xI:n="Cineon";break;case SI:n="ACESFilmic";break;case wI:n="AgX";break;case TI:n="Neutral";break;case EI:n="Custom";break;default:gO("WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const sX=new DO;function aX(){zO.getLuminanceCoefficients(sX);const e=sX.x.toFixed(4),t=sX.y.toFixed(4),n=sX.z.toFixed(4);return["float luminance( const in vec3 rgb ) {","\tconst vec3 weights = vec3( ".concat(e,", ").concat(t,", ").concat(n," );"),"\treturn dot( weights, rgb );","}"].join("\n")}function oX(e){return""!==e}function lX(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function cX(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const uX=/^[ \t]*#include +<([\w\d./]+)>/gm;function dX(e){return e.replace(uX,fX)}const hX=new Map;function fX(e,t){let n=mj[t];if(void 0===n){const e=hX.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");n=mj[e],gO('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return dX(n)}const pX=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function mX(e){return e.replace(pX,gX)}function gX(e,t,n,i){let r="";for(let s=parseInt(t);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function vX(e){let t="precision ".concat(e.precision," float;\n\tprecision ").concat(e.precision," int;\n\tprecision ").concat(e.precision," sampler2D;\n\tprecision ").concat(e.precision," samplerCube;\n\tprecision ").concat(e.precision," sampler3D;\n\tprecision ").concat(e.precision," sampler2DArray;\n\tprecision ").concat(e.precision," sampler2DShadow;\n\tprecision ").concat(e.precision," samplerCubeShadow;\n\tprecision ").concat(e.precision," sampler2DArrayShadow;\n\tprecision ").concat(e.precision," isampler2D;\n\tprecision ").concat(e.precision," isampler3D;\n\tprecision ").concat(e.precision," isamplerCube;\n\tprecision ").concat(e.precision," isampler2DArray;\n\tprecision ").concat(e.precision," usampler2D;\n\tprecision ").concat(e.precision," usampler3D;\n\tprecision ").concat(e.precision," usamplerCube;\n\tprecision ").concat(e.precision," usampler2DArray;\n\t");return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function yX(e,t,n,i){const r=e.getContext(),s=n.defines;let a=n.vertexShader,o=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===RP?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===LP?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===PP&&(t="SHADOWMAP_TYPE_VSM"),t}(n),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case RI:case LI:t="ENVMAP_TYPE_CUBE";break;case DI:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),u=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===LI&&(t="ENVMAP_MODE_REFRACTION");return t}(n),d=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case mI:t="ENVMAP_BLENDING_MULTIPLY";break;case gI:t="ENVMAP_BLENDING_MIX";break;case vI:t="ENVMAP_BLENDING_ADD"}return t}(n),h=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),f=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(oX).join("\n")}(n),p=function(e){const t=[];for(const n in e){const i=e[n];!1!==i&&t.push("#define "+n+" "+i)}return t.join("\n")}(s),m=r.createProgram();let g,v,y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(oX).join("\n"),g.length>0&&(g+="\n"),v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(oX).join("\n"),v.length>0&&(v+="\n")):(g=[vX(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(oX).join("\n"),v=[vX(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==yI?"#define TONE_MAPPING":"",n.toneMapping!==yI?mj.tonemapping_pars_fragment:"",n.toneMapping!==yI?rX("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",mj.colorspace_pars_fragment,iX("linearToOutputTexel",n.outputColorSpace),aX(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(oX).join("\n")),a=dX(a),a=lX(a,n),a=cX(a,n),o=dX(o),o=lX(o,n),o=cX(o,n),a=mX(a),o=mX(o),!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",g=[f,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in",n.glslVersion===eO?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===eO?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const _=y+g+a,b=y+v+o,x=$Y(r,r.VERTEX_SHADER,_),S=$Y(r,r.FRAGMENT_SHADER,b);function E(t){if(e.debug.checkShaderErrors){const n=r.getProgramInfoLog(m)||"",i=r.getShaderInfoLog(x)||"",s=r.getShaderInfoLog(S)||"",a=n.trim(),o=i.trim(),l=s.trim();let c=!0,u=!0;if(!1===r.getProgramParameter(m,r.LINK_STATUS))if(c=!1,"function"===typeof e.debug.onShaderError)e.debug.onShaderError(r,m,x,S);else{const e=nX(r,x,"vertex"),n=nX(r,S,"fragment");vO("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,r.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+a+"\n"+e+"\n"+n)}else""!==a?gO("WebGLProgram: Program Info Log:",a):""!==o&&""!==l||(u=!1);u&&(t.diagnostics={runnable:c,programLog:a,vertexShader:{log:o,prefix:g},fragmentShader:{log:l,prefix:v}})}r.deleteShader(x),r.deleteShader(S),w=new ZY(r,m),T=function(e,t){const n={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const i=e.getActiveAttrib(t,r),s=i.name;let a=1;i.type===e.FLOAT_MAT2&&(a=2),i.type===e.FLOAT_MAT3&&(a=3),i.type===e.FLOAT_MAT4&&(a=4),n[s]={type:i.type,location:e.getAttribLocation(t,s),locationSize:a}}return n}(r,m)}let w,T;r.attachShader(m,x),r.attachShader(m,S),void 0!==n.index0AttributeName?r.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),this.getUniforms=function(){return void 0===w&&E(this),w},this.getAttributes=function(){return void 0===T&&E(this),T};let M=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===M&&(M=r.getProgramParameter(m,37297)),M},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=eX++,this.cacheKey=t,this.usedTimes=1,this.program=m,this.vertexShader=x,this.fragmentShader=S,this}let _X=0;class bX{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(e);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(r)&&(s.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new xX(e),t.set(e,n)),n}}class xX{constructor(e){this.id=_X++,this.code=e,this.usedTimes=0}}function SX(e,t,n,i,r,s,a){const o=new VN,l=new bX,c=new Set,u=[],d=r.logarithmicDepthBuffer,h=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(e){return c.add(e),0===e?"uv":"uv".concat(e)}return{getParameters:function(s,o,u,g,v){const y=g.fog,_=v.geometry,b=s.isMeshStandardMaterial?g.environment:null,x=(s.isMeshStandardMaterial?n:t).get(s.envMap||b),S=x&&x.mapping===DI?x.image.height:null,E=p[s.type];null!==s.precision&&(f=r.getMaxPrecision(s.precision),f!==s.precision&&gO("WebGLProgram.getParameters:",s.precision,"not supported, using",f,"instead."));const w=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,T=void 0!==w?w.length:0;let M,A,C,R,L=0;if(void 0!==_.morphAttributes.position&&(L=1),void 0!==_.morphAttributes.normal&&(L=2),void 0!==_.morphAttributes.color&&(L=3),E){const e=vj[E];M=e.vertexShader,A=e.fragmentShader}else M=s.vertexShader,A=s.fragmentShader,l.update(s),C=l.getVertexShaderID(s),R=l.getFragmentShaderID(s);const P=e.getRenderTarget(),I=e.state.buffers.depth.getReversed(),D=!0===v.isInstancedMesh,k=!0===v.isBatchedMesh,O=!!s.map,N=!!s.matcap,F=!!x,B=!!s.aoMap,U=!!s.lightMap,H=!!s.bumpMap,z=!!s.normalMap,G=!!s.displacementMap,V=!!s.emissiveMap,W=!!s.metalnessMap,j=!!s.roughnessMap,Y=s.anisotropy>0,X=s.clearcoat>0,K=s.dispersion>0,q=s.iridescence>0,J=s.sheen>0,Q=s.transmission>0,Z=Y&&!!s.anisotropyMap,$=X&&!!s.clearcoatMap,ee=X&&!!s.clearcoatNormalMap,te=X&&!!s.clearcoatRoughnessMap,ne=q&&!!s.iridescenceMap,ie=q&&!!s.iridescenceThicknessMap,re=J&&!!s.sheenColorMap,se=J&&!!s.sheenRoughnessMap,ae=!!s.specularMap,oe=!!s.specularColorMap,le=!!s.specularIntensityMap,ce=Q&&!!s.transmissionMap,ue=Q&&!!s.thicknessMap,de=!!s.gradientMap,he=!!s.alphaMap,fe=s.alphaTest>0,pe=!!s.alphaHash,me=!!s.extensions;let ge=yI;s.toneMapped&&(null!==P&&!0!==P.isXRRenderTarget||(ge=e.toneMapping));const ve={shaderID:E,shaderType:s.type,shaderName:s.name,vertexShader:M,fragmentShader:A,defines:s.defines,customVertexShaderID:C,customFragmentShaderID:R,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:f,batching:k,batchingColor:k&&null!==v._colorsTexture,instancing:D,instancingColor:D&&null!==v.instanceColor,instancingMorph:D&&null!==v.morphTexture,supportsVertexTextures:h,outputColorSpace:null===P?e.outputColorSpace:!0===P.isXRRenderTarget?P.texture.colorSpace:vk,alphaToCoverage:!!s.alphaToCoverage,map:O,matcap:N,envMap:F,envMapMode:F&&x.mapping,envMapCubeUVHeight:S,aoMap:B,lightMap:U,bumpMap:H,normalMap:z,displacementMap:h&&G,emissiveMap:V,normalMapObjectSpace:z&&s.normalMapType===pk,normalMapTangentSpace:z&&s.normalMapType===fk,metalnessMap:W,roughnessMap:j,anisotropy:Y,anisotropyMap:Z,clearcoat:X,clearcoatMap:$,clearcoatNormalMap:ee,clearcoatRoughnessMap:te,dispersion:K,iridescence:q,iridescenceMap:ne,iridescenceThicknessMap:ie,sheen:J,sheenColorMap:re,sheenRoughnessMap:se,specularMap:ae,specularColorMap:oe,specularIntensityMap:le,transmission:Q,transmissionMap:ce,thicknessMap:ue,gradientMap:de,opaque:!1===s.transparent&&s.blending===NP&&!1===s.alphaToCoverage,alphaMap:he,alphaTest:fe,alphaHash:pe,combine:s.combine,mapUv:O&&m(s.map.channel),aoMapUv:B&&m(s.aoMap.channel),lightMapUv:U&&m(s.lightMap.channel),bumpMapUv:H&&m(s.bumpMap.channel),normalMapUv:z&&m(s.normalMap.channel),displacementMapUv:G&&m(s.displacementMap.channel),emissiveMapUv:V&&m(s.emissiveMap.channel),metalnessMapUv:W&&m(s.metalnessMap.channel),roughnessMapUv:j&&m(s.roughnessMap.channel),anisotropyMapUv:Z&&m(s.anisotropyMap.channel),clearcoatMapUv:$&&m(s.clearcoatMap.channel),clearcoatNormalMapUv:ee&&m(s.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:te&&m(s.clearcoatRoughnessMap.channel),iridescenceMapUv:ne&&m(s.iridescenceMap.channel),iridescenceThicknessMapUv:ie&&m(s.iridescenceThicknessMap.channel),sheenColorMapUv:re&&m(s.sheenColorMap.channel),sheenRoughnessMapUv:se&&m(s.sheenRoughnessMap.channel),specularMapUv:ae&&m(s.specularMap.channel),specularColorMapUv:oe&&m(s.specularColorMap.channel),specularIntensityMapUv:le&&m(s.specularIntensityMap.channel),transmissionMapUv:ce&&m(s.transmissionMap.channel),thicknessMapUv:ue&&m(s.thicknessMap.channel),alphaMapUv:he&&m(s.alphaMap.channel),vertexTangents:!!_.attributes.tangent&&(z||Y),vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!_.attributes.color&&4===_.attributes.color.itemSize,pointsUvs:!0===v.isPoints&&!!_.attributes.uv&&(O||he),fog:!!y,useFog:!0===s.fog,fogExp2:!!y&&y.isFogExp2,flatShading:!0===s.flatShading&&!1===s.wireframe,sizeAttenuation:!0===s.sizeAttenuation,logarithmicDepthBuffer:d,reversedDepthBuffer:I,skinning:!0===v.isSkinnedMesh,morphTargets:void 0!==_.morphAttributes.position,morphNormals:void 0!==_.morphAttributes.normal,morphColors:void 0!==_.morphAttributes.color,morphTargetsCount:T,morphTextureStride:L,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numLightProbes:o.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:s.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.length>0,shadowMapType:e.shadowMap.type,toneMapping:ge,decodeVideoTexture:O&&!0===s.map.isVideoTexture&&zO.getTransfer(s.map.colorSpace)===_k,decodeVideoTextureEmissive:V&&!0===s.emissiveMap.isVideoTexture&&zO.getTransfer(s.emissiveMap.colorSpace)===_k,premultipliedAlpha:s.premultipliedAlpha,doubleSided:s.side===kP,flipSided:s.side===DP,useDepthPacking:s.depthPacking>=0,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionClipCullDistance:me&&!0===s.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(me&&!0===s.extensions.multiDraw||k)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:s.customProgramCacheKey()};return ve.vertexUv1s=c.has(1),ve.vertexUv2s=c.has(2),ve.vertexUv3s=c.has(3),c.clear(),ve},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){o.disableAll(),t.supportsVertexTextures&&o.enable(0);t.instancing&&o.enable(1);t.instancingColor&&o.enable(2);t.instancingMorph&&o.enable(3);t.matcap&&o.enable(4);t.envMap&&o.enable(5);t.normalMapObjectSpace&&o.enable(6);t.normalMapTangentSpace&&o.enable(7);t.clearcoat&&o.enable(8);t.iridescence&&o.enable(9);t.alphaTest&&o.enable(10);t.vertexColors&&o.enable(11);t.vertexAlphas&&o.enable(12);t.vertexUv1s&&o.enable(13);t.vertexUv2s&&o.enable(14);t.vertexUv3s&&o.enable(15);t.vertexTangents&&o.enable(16);t.anisotropy&&o.enable(17);t.alphaHash&&o.enable(18);t.batching&&o.enable(19);t.dispersion&&o.enable(20);t.batchingColor&&o.enable(21);t.gradientMap&&o.enable(22);e.push(o.mask),o.disableAll(),t.fog&&o.enable(0);t.useFog&&o.enable(1);t.flatShading&&o.enable(2);t.logarithmicDepthBuffer&&o.enable(3);t.reversedDepthBuffer&&o.enable(4);t.skinning&&o.enable(5);t.morphTargets&&o.enable(6);t.morphNormals&&o.enable(7);t.morphColors&&o.enable(8);t.premultipliedAlpha&&o.enable(9);t.shadowMapEnabled&&o.enable(10);t.doubleSided&&o.enable(11);t.flipSided&&o.enable(12);t.useDepthPacking&&o.enable(13);t.dithering&&o.enable(14);t.transmission&&o.enable(15);t.sheen&&o.enable(16);t.opaque&&o.enable(17);t.pointsUvs&&o.enable(18);t.decodeVideoTexture&&o.enable(19);t.decodeVideoTextureEmissive&&o.enable(20);t.alphaToCoverage&&o.enable(21);e.push(o.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=p[e.type];let n;if(t){const e=vj[t];n=yB.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let i;for(let e=0,r=u.length;e<r;e++){const t=u[e];if(t.cacheKey===n){i=t,++i.usedTimes;break}}return void 0===i&&(i=new yX(e,n,t,s),u.push(i)),i},releaseProgram:function(e){if(0===--e.usedTimes){const t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:u,dispose:function(){l.dispose()}}}function EX(){let e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,i){e.get(t)[n]=i},dispose:function(){e=new WeakMap}}}function wX(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function TX(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function MX(){const e=[];let t=0;const n=[],i=[],r=[];function s(n,i,r,s,a,o){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:i,material:r,groupOrder:s,renderOrder:n.renderOrder,z:a,group:o},e[t]=l):(l.id=n.id,l.object=n,l.geometry=i,l.material=r,l.groupOrder=s,l.renderOrder=n.renderOrder,l.z=a,l.group=o),t++,l}return{opaque:n,transmissive:i,transparent:r,init:function(){t=0,n.length=0,i.length=0,r.length=0},push:function(e,t,a,o,l,c){const u=s(e,t,a,o,l,c);a.transmission>0?i.push(u):!0===a.transparent?r.push(u):n.push(u)},unshift:function(e,t,a,o,l,c){const u=s(e,t,a,o,l,c);a.transmission>0?i.unshift(u):!0===a.transparent?r.unshift(u):n.unshift(u)},finish:function(){for(let n=t,i=e.length;n<i;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||wX),i.length>1&&i.sort(t||TX),r.length>1&&r.sort(t||TX)}}}function AX(){let e=new WeakMap;return{get:function(t,n){const i=e.get(t);let r;return void 0===i?(r=new MX,e.set(t,[r])):n>=i.length?(r=new MX,i.push(r)):r=i[n],r},dispose:function(){e=new WeakMap}}}function CX(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new DO,color:new wF};break;case"SpotLight":n={position:new DO,direction:new DO,color:new wF,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new DO,color:new wF,distance:0,decay:0};break;case"HemisphereLight":n={direction:new DO,skyColor:new wF,groundColor:new wF};break;case"RectAreaLight":n={color:new wF,position:new DO,halfWidth:new DO,halfHeight:new DO}}return e[t.id]=n,n}}}let RX=0;function LX(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function PX(e){const t=new CX,n=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new PO};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new PO,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let o=0;o<9;o++)i.probe.push(new DO);const r=new DO,s=new IN,a=new IN;return{setup:function(r){let s=0,a=0,o=0;for(let e=0;e<9;e++)i.probe[e].set(0,0,0);let l=0,c=0,u=0,d=0,h=0,f=0,p=0,m=0,g=0,v=0,y=0;r.sort(LX);for(let e=0,b=r.length;e<b;e++){const _=r[e],b=_.color,x=_.intensity,S=_.distance,E=_.shadow&&_.shadow.map?_.shadow.map.texture:null;if(_.isAmbientLight)s+=b.r*x,a+=b.g*x,o+=b.b*x;else if(_.isLightProbe){for(let e=0;e<9;e++)i.probe[e].addScaledVector(_.sh.coefficients[e],x);y++}else if(_.isDirectionalLight){const e=t.get(_);if(e.color.copy(_.color).multiplyScalar(_.intensity),_.castShadow){const e=_.shadow,t=n.get(_);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,i.directionalShadow[l]=t,i.directionalShadowMap[l]=E,i.directionalShadowMatrix[l]=_.shadow.matrix,f++}i.directional[l]=e,l++}else if(_.isSpotLight){const e=t.get(_);e.position.setFromMatrixPosition(_.matrixWorld),e.color.copy(b).multiplyScalar(x),e.distance=S,e.coneCos=Math.cos(_.angle),e.penumbraCos=Math.cos(_.angle*(1-_.penumbra)),e.decay=_.decay,i.spot[u]=e;const r=_.shadow;if(_.map&&(i.spotLightMap[g]=_.map,g++,r.updateMatrices(_),_.castShadow&&v++),i.spotLightMatrix[u]=r.matrix,_.castShadow){const e=n.get(_);e.shadowIntensity=r.intensity,e.shadowBias=r.bias,e.shadowNormalBias=r.normalBias,e.shadowRadius=r.radius,e.shadowMapSize=r.mapSize,i.spotShadow[u]=e,i.spotShadowMap[u]=E,m++}u++}else if(_.isRectAreaLight){const e=t.get(_);e.color.copy(b).multiplyScalar(x),e.halfWidth.set(.5*_.width,0,0),e.halfHeight.set(0,.5*_.height,0),i.rectArea[d]=e,d++}else if(_.isPointLight){const e=t.get(_);if(e.color.copy(_.color).multiplyScalar(_.intensity),e.distance=_.distance,e.decay=_.decay,_.castShadow){const e=_.shadow,t=n.get(_);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,i.pointShadow[c]=t,i.pointShadowMap[c]=E,i.pointShadowMatrix[c]=_.shadow.matrix,p++}i.point[c]=e,c++}else if(_.isHemisphereLight){const e=t.get(_);e.skyColor.copy(_.color).multiplyScalar(x),e.groundColor.copy(_.groundColor).multiplyScalar(x),i.hemi[h]=e,h++}}d>0&&(!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=gj.LTC_FLOAT_1,i.rectAreaLTC2=gj.LTC_FLOAT_2):(i.rectAreaLTC1=gj.LTC_HALF_1,i.rectAreaLTC2=gj.LTC_HALF_2)),i.ambient[0]=s,i.ambient[1]=a,i.ambient[2]=o;const _=i.hash;_.directionalLength===l&&_.pointLength===c&&_.spotLength===u&&_.rectAreaLength===d&&_.hemiLength===h&&_.numDirectionalShadows===f&&_.numPointShadows===p&&_.numSpotShadows===m&&_.numSpotMaps===g&&_.numLightProbes===y||(i.directional.length=l,i.spot.length=u,i.rectArea.length=d,i.point.length=c,i.hemi.length=h,i.directionalShadow.length=f,i.directionalShadowMap.length=f,i.pointShadow.length=p,i.pointShadowMap.length=p,i.spotShadow.length=m,i.spotShadowMap.length=m,i.directionalShadowMatrix.length=f,i.pointShadowMatrix.length=p,i.spotLightMatrix.length=m+g-v,i.spotLightMap.length=g,i.numSpotLightShadowsWithMaps=v,i.numLightProbes=y,_.directionalLength=l,_.pointLength=c,_.spotLength=u,_.rectAreaLength=d,_.hemiLength=h,_.numDirectionalShadows=f,_.numPointShadows=p,_.numSpotShadows=m,_.numSpotMaps=g,_.numLightProbes=y,i.version=RX++)},setupView:function(e,t){let n=0,o=0,l=0,c=0,u=0;const d=t.matrixWorldInverse;for(let h=0,f=e.length;h<f;h++){const t=e[h];if(t.isDirectionalLight){const e=i.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),r.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(r),e.direction.transformDirection(d),n++}else if(t.isSpotLight){const e=i.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(d),e.direction.setFromMatrixPosition(t.matrixWorld),r.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(r),e.direction.transformDirection(d),l++}else if(t.isRectAreaLight){const e=i.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(d),a.identity(),s.copy(t.matrixWorld),s.premultiply(d),a.extractRotation(s),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(a),e.halfHeight.applyMatrix4(a),c++}else if(t.isPointLight){const e=i.point[o];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(d),o++}else if(t.isHemisphereLight){const e=i.hemi[u];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(d),u++}}},state:i}}function IX(e){const t=new PX(e),n=[],i=[];const r={lightsArray:n,shadowsArray:i,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){r.camera=e,n.length=0,i.length=0},state:r,setupLights:function(){t.setup(n)},setupLightsView:function(e){t.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){i.push(e)}}}function DX(e){let t=new WeakMap;return{get:function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=t.get(n);let s;return void 0===r?(s=new IX(e),t.set(n,[s])):i>=r.length?(s=new IX(e),r.push(s)):s=r[i],s},dispose:function(){t=new WeakMap}}}function kX(e,t,n){let i=new kU;const r=new PO,s=new PO,a=new ZO,o=new fG({depthPacking:uk}),l=new pG,c={},u=n.maxTextureSize,d={[IP]:DP,[DP]:IP,[kP]:kP},h=new _B({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new PO},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const p=new eB;p.setAttribute("position",new FF(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new hB(p,h),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=RP;let v=this.type;function y(n,i){const s=t.update(m);h.defines.VSM_SAMPLES!==n.blurSamples&&(h.defines.VSM_SAMPLES=n.blurSamples,f.defines.VSM_SAMPLES=n.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new eN(r.x,r.y)),h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(i,null,s,h,m,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(i,null,s,f,m,null)}function _(t,n,i,r){let s=null;const a=!0===i.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==a)s=a;else if(s=!0===i.isPointLight?l:o,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0||!0===n.alphaToCoverage){const e=s.uuid,t=n.uuid;let i=c[e];void 0===i&&(i={},c[e]=i);let r=i[t];void 0===r&&(r=s.clone(),i[t]=r,n.addEventListener("dispose",x)),s=r}if(s.visible=n.visible,s.wireframe=n.wireframe,s.side=r===PP?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:d[n.side],s.alphaMap=n.alphaMap,s.alphaTest=!0===n.alphaToCoverage?.5:n.alphaTest,s.map=n.map,s.clipShadows=n.clipShadows,s.clippingPlanes=n.clippingPlanes,s.clipIntersection=n.clipIntersection,s.displacementMap=n.displacementMap,s.displacementScale=n.displacementScale,s.displacementBias=n.displacementBias,s.wireframeLinewidth=n.wireframeLinewidth,s.linewidth=n.linewidth,!0===i.isPointLight&&!0===s.isMeshDistanceMaterial){e.properties.get(s).light=i}return s}function b(n,r,s,a,o){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&o===PP)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);const i=t.update(n),l=n.material;if(Array.isArray(l)){const t=i.groups;for(let c=0,u=t.length;c<u;c++){const u=t[c],d=l[u.materialIndex];if(d&&d.visible){const t=_(n,d,a,o);n.onBeforeShadow(e,n,r,s,i,t,u),e.renderBufferDirect(s,null,i,t,n,u),n.onAfterShadow(e,n,r,s,i,t,u)}}}else if(l.visible){const t=_(n,l,a,o);n.onBeforeShadow(e,n,r,s,i,t,null),e.renderBufferDirect(s,null,i,t,n,null),n.onAfterShadow(e,n,r,s,i,t,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)b(l[e],r,s,a,o)}function x(e){e.target.removeEventListener("dispose",x);for(const t in c){const n=c[t],i=e.target.uuid;if(i in n){n[i].dispose(),delete n[i]}}}this.render=function(t,n,o){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),h=e.state;h.setBlending(OP),!0===h.buffers.depth.getReversed()?h.buffers.color.setClear(0,0,0,0):h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);const f=v!==PP&&this.type===PP,p=v===PP&&this.type!==PP;for(let m=0,g=t.length;m<g;m++){const l=t[m],c=l.shadow;if(void 0===c){gO("WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;r.copy(c.mapSize);const d=c.getFrameExtents();if(r.multiply(d),s.copy(c.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/d.x),r.x=s.x*d.x,c.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/d.y),r.y=s.y*d.y,c.mapSize.y=s.y)),null===c.map||!0===f||!0===p){const e=this.type!==PP?{minFilter:FI,magFilter:FI}:{};null!==c.map&&c.map.dispose(),c.map=new eN(r.x,r.y,e),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();const g=c.getViewportCount();for(let e=0;e<g;e++){const t=c.getViewport(e);a.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),h.viewport(a),c.updateMatrices(l,e),i=c.getFrustum(),b(n,o,c.camera,l,this.type)}!0!==c.isPointLightShadow&&this.type===PP&&y(c,o),c.needsUpdate=!1}v=this.type,g.needsUpdate=!1,e.setRenderTarget(l,c,d)}}const OX={[oI]:lI,[cI]:fI,[dI]:pI,[uI]:hI,[lI]:oI,[fI]:cI,[pI]:dI,[hI]:uI};function NX(e,t){const n=new function(){let t=!1;const n=new ZO;let i=null;const r=new ZO(0,0,0,0);return{setMask:function(n){i===n||t||(e.colorMask(n,n,n,n),i=n)},setLocked:function(e){t=e},setClear:function(t,i,s,a,o){!0===o&&(t*=a,i*=a,s*=a),n.set(t,i,s,a),!1===r.equals(n)&&(e.clearColor(t,i,s,a),r.copy(n))},reset:function(){t=!1,i=null,r.set(-1,0,0,0)}}},i=new function(){let n=!1,i=!1,r=null,s=null,a=null;return{setReversed:function(e){if(i!==e){const n=t.get("EXT_clip_control");e?n.clipControlEXT(n.LOWER_LEFT_EXT,n.ZERO_TO_ONE_EXT):n.clipControlEXT(n.LOWER_LEFT_EXT,n.NEGATIVE_ONE_TO_ONE_EXT),i=e;const r=a;a=null,this.setClear(r)}},getReversed:function(){return i},setTest:function(t){t?H(e.DEPTH_TEST):z(e.DEPTH_TEST)},setMask:function(t){r===t||n||(e.depthMask(t),r=t)},setFunc:function(t){if(i&&(t=OX[t]),s!==t){switch(t){case oI:e.depthFunc(e.NEVER);break;case lI:e.depthFunc(e.ALWAYS);break;case cI:e.depthFunc(e.LESS);break;case uI:e.depthFunc(e.LEQUAL);break;case dI:e.depthFunc(e.EQUAL);break;case hI:e.depthFunc(e.GEQUAL);break;case fI:e.depthFunc(e.GREATER);break;case pI:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}s=t}},setLocked:function(e){n=e},setClear:function(t){a!==t&&(i&&(t=1-t),e.clearDepth(t),a=t)},reset:function(){n=!1,r=null,s=null,a=null,i=!1}}},r=new function(){let t=!1,n=null,i=null,r=null,s=null,a=null,o=null,l=null,c=null;return{setTest:function(n){t||(n?H(e.STENCIL_TEST):z(e.STENCIL_TEST))},setMask:function(i){n===i||t||(e.stencilMask(i),n=i)},setFunc:function(t,n,a){i===t&&r===n&&s===a||(e.stencilFunc(t,n,a),i=t,r=n,s=a)},setOp:function(t,n,i){a===t&&o===n&&l===i||(e.stencilOp(t,n,i),a=t,o=n,l=i)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,i=null,r=null,s=null,a=null,o=null,l=null,c=null}}},s=new WeakMap,a=new WeakMap;let o={},l={},c=new WeakMap,u=[],d=null,h=!1,f=null,p=null,m=null,g=null,v=null,y=null,_=null,b=new wF(0,0,0),x=0,S=!1,E=null,w=null,T=null,M=null,A=null;const C=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let R=!1,L=0;const P=e.getParameter(e.VERSION);-1!==P.indexOf("WebGL")?(L=parseFloat(/^WebGL (\d)/.exec(P)[1]),R=L>=1):-1!==P.indexOf("OpenGL ES")&&(L=parseFloat(/^OpenGL ES (\d)/.exec(P)[1]),R=L>=2);let I=null,D={};const k=e.getParameter(e.SCISSOR_BOX),O=e.getParameter(e.VIEWPORT),N=(new ZO).fromArray(k),F=(new ZO).fromArray(O);function B(t,n,i,r){const s=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let o=0;o<i;o++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,r,0,e.RGBA,e.UNSIGNED_BYTE,s):e.texImage2D(n+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s);return a}const U={};function H(t){!0!==o[t]&&(e.enable(t),o[t]=!0)}function z(t){!1!==o[t]&&(e.disable(t),o[t]=!1)}U[e.TEXTURE_2D]=B(e.TEXTURE_2D,e.TEXTURE_2D,1),U[e.TEXTURE_CUBE_MAP]=B(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),U[e.TEXTURE_2D_ARRAY]=B(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),U[e.TEXTURE_3D]=B(e.TEXTURE_3D,e.TEXTURE_3D,1,1),n.setClear(0,0,0,1),i.setClear(1),r.setClear(0),H(e.DEPTH_TEST),i.setFunc(uI),j(!1),Y(TP),H(e.CULL_FACE),W(OP);const G={[zP]:e.FUNC_ADD,[GP]:e.FUNC_SUBTRACT,[VP]:e.FUNC_REVERSE_SUBTRACT};G[WP]=e.MIN,G[jP]=e.MAX;const V={[YP]:e.ZERO,[XP]:e.ONE,[KP]:e.SRC_COLOR,[JP]:e.SRC_ALPHA,[nI]:e.SRC_ALPHA_SATURATE,[eI]:e.DST_COLOR,[ZP]:e.DST_ALPHA,[qP]:e.ONE_MINUS_SRC_COLOR,[QP]:e.ONE_MINUS_SRC_ALPHA,[tI]:e.ONE_MINUS_DST_COLOR,[$P]:e.ONE_MINUS_DST_ALPHA,[iI]:e.CONSTANT_COLOR,[rI]:e.ONE_MINUS_CONSTANT_COLOR,[sI]:e.CONSTANT_ALPHA,[aI]:e.ONE_MINUS_CONSTANT_ALPHA};function W(t,n,i,r,s,a,o,l,c,u){if(t!==OP){if(!1===h&&(H(e.BLEND),h=!0),t===HP)s=s||n,a=a||i,o=o||r,n===p&&s===v||(e.blendEquationSeparate(G[n],G[s]),p=n,v=s),i===m&&r===g&&a===y&&o===_||(e.blendFuncSeparate(V[i],V[r],V[a],V[o]),m=i,g=r,y=a,_=o),!1!==l.equals(b)&&c===x||(e.blendColor(l.r,l.g,l.b,c),b.copy(l),x=c),f=t,S=!1;else if(t!==f||u!==S){if(p===zP&&v===zP||(e.blendEquation(e.FUNC_ADD),p=zP,v=zP),u)switch(t){case NP:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case FP:e.blendFunc(e.ONE,e.ONE);break;case BP:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case UP:e.blendFuncSeparate(e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ZERO,e.ONE);break;default:vO("WebGLState: Invalid blending: ",t)}else switch(t){case NP:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case FP:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE,e.ONE,e.ONE);break;case BP:vO("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case UP:vO("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:vO("WebGLState: Invalid blending: ",t)}m=null,g=null,y=null,_=null,b.set(0,0,0),x=0,f=t,S=u}}else!0===h&&(z(e.BLEND),h=!1)}function j(t){E!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),E=t)}function Y(t){t!==wP?(H(e.CULL_FACE),t!==w&&(t===TP?e.cullFace(e.BACK):t===MP?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):z(e.CULL_FACE),w=t}function X(t,n,i){t?(H(e.POLYGON_OFFSET_FILL),M===n&&A===i||(e.polygonOffset(n,i),M=n,A=i)):z(e.POLYGON_OFFSET_FILL)}return{buffers:{color:n,depth:i,stencil:r},enable:H,disable:z,bindFramebuffer:function(t,n){return l[t]!==n&&(e.bindFramebuffer(t,n),l[t]=n,t===e.DRAW_FRAMEBUFFER&&(l[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(l[e.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(t,n){let i=u,r=!1;if(t){i=c.get(n),void 0===i&&(i=[],c.set(n,i));const s=t.textures;if(i.length!==s.length||i[0]!==e.COLOR_ATTACHMENT0){for(let t=0,n=s.length;t<n;t++)i[t]=e.COLOR_ATTACHMENT0+t;i.length=s.length,r=!0}}else i[0]!==e.BACK&&(i[0]=e.BACK,r=!0);r&&e.drawBuffers(i)},useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:W,setMaterial:function(t,s){t.side===kP?z(e.CULL_FACE):H(e.CULL_FACE);let a=t.side===DP;s&&(a=!a),j(a),t.blending===NP&&!1===t.transparent?W(OP):W(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),i.setFunc(t.depthFunc),i.setTest(t.depthTest),i.setMask(t.depthWrite),n.setMask(t.colorWrite);const o=t.stencilWrite;r.setTest(o),o&&(r.setMask(t.stencilWriteMask),r.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),r.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),X(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?H(e.SAMPLE_ALPHA_TO_COVERAGE):z(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:j,setCullFace:Y,setLineWidth:function(t){t!==T&&(R&&e.lineWidth(t),T=t)},setPolygonOffset:X,setScissorTest:function(t){t?H(e.SCISSOR_TEST):z(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+C-1),I!==t&&(e.activeTexture(t),I=t)},bindTexture:function(t,n,i){void 0===i&&(i=null===I?e.TEXTURE0+C-1:I);let r=D[i];void 0===r&&(r={type:void 0,texture:void 0},D[i]=r),r.type===t&&r.texture===n||(I!==i&&(e.activeTexture(i),I=i),e.bindTexture(t,n||U[t]),r.type=t,r.texture=n)},unbindTexture:function(){const t=D[I];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D(...arguments)}catch(t){t("WebGLState:",t)}},compressedTexImage3D:function(){try{e.compressedTexImage3D(...arguments)}catch(t){t("WebGLState:",t)}},texImage2D:function(){try{e.texImage2D(...arguments)}catch(t){t("WebGLState:",t)}},texImage3D:function(){try{e.texImage3D(...arguments)}catch(t){t("WebGLState:",t)}},updateUBOMapping:function(t,n){let i=a.get(n);void 0===i&&(i=new WeakMap,a.set(n,i));let r=i.get(t);void 0===r&&(r=e.getUniformBlockIndex(n,t.name),i.set(t,r))},uniformBlockBinding:function(t,n){const i=a.get(n).get(t);s.get(n)!==i&&(e.uniformBlockBinding(n,i,t.__bindingPointIndex),s.set(n,i))},texStorage2D:function(){try{e.texStorage2D(...arguments)}catch(t){t("WebGLState:",t)}},texStorage3D:function(){try{e.texStorage3D(...arguments)}catch(t){t("WebGLState:",t)}},texSubImage2D:function(){try{e.texSubImage2D(...arguments)}catch(t){t("WebGLState:",t)}},texSubImage3D:function(){try{e.texSubImage3D(...arguments)}catch(t){t("WebGLState:",t)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D(...arguments)}catch(t){t("WebGLState:",t)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D(...arguments)}catch(t){t("WebGLState:",t)}},scissor:function(t){!1===N.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),N.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),i.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),o={},I=null,D={},l={},c=new WeakMap,u=[],d=null,h=!1,f=null,p=null,m=null,g=null,v=null,y=null,_=null,b=new wF(0,0,0),x=0,S=!1,E=null,w=null,T=null,M=null,A=null,N.set(0,0,e.canvas.width,e.canvas.height),F.set(0,0,e.canvas.width,e.canvas.height),n.reset(),i.reset(),r.reset()}}}function FX(e,t,n,i,r,s,a){const o=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,l="undefined"!==typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new PO,u=new WeakMap;let d;const h=new WeakMap;let f=!1;try{f="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(One){}function p(e,t){return f?new OffscreenCanvas(e,t):cO("canvas")}function m(e,t,n){let i=1;const r=V(e);if((r.width>n||r.height>n)&&(i=n/Math.max(r.width,r.height)),i<1){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof VideoFrame&&e instanceof VideoFrame){const n=Math.floor(i*r.width),s=Math.floor(i*r.height);void 0===d&&(d=p(n,s));const a=t?p(n,s):d;a.width=n,a.height=s;return a.getContext("2d").drawImage(e,0,0,n,s),gO("WebGLRenderer: Texture has been resized from ("+r.width+"x"+r.height+") to ("+n+"x"+s+")."),a}return"data"in e&&gO("WebGLRenderer: Image in DataTexture is too big ("+r.width+"x"+r.height+")."),e}return e}function g(e){return e.generateMipmaps}function v(t){e.generateMipmap(t)}function y(t){return t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:t.isWebGL3DRenderTarget?e.TEXTURE_3D:t.isWebGLArrayRenderTarget||t.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function _(n,i,r,s){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(null!==n){if(void 0!==e[n])return e[n];gO("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let o=i;if(i===e.RED&&(r===e.FLOAT&&(o=e.R32F),r===e.HALF_FLOAT&&(o=e.R16F),r===e.UNSIGNED_BYTE&&(o=e.R8)),i===e.RED_INTEGER&&(r===e.UNSIGNED_BYTE&&(o=e.R8UI),r===e.UNSIGNED_SHORT&&(o=e.R16UI),r===e.UNSIGNED_INT&&(o=e.R32UI),r===e.BYTE&&(o=e.R8I),r===e.SHORT&&(o=e.R16I),r===e.INT&&(o=e.R32I)),i===e.RG&&(r===e.FLOAT&&(o=e.RG32F),r===e.HALF_FLOAT&&(o=e.RG16F),r===e.UNSIGNED_BYTE&&(o=e.RG8)),i===e.RG_INTEGER&&(r===e.UNSIGNED_BYTE&&(o=e.RG8UI),r===e.UNSIGNED_SHORT&&(o=e.RG16UI),r===e.UNSIGNED_INT&&(o=e.RG32UI),r===e.BYTE&&(o=e.RG8I),r===e.SHORT&&(o=e.RG16I),r===e.INT&&(o=e.RG32I)),i===e.RGB_INTEGER&&(r===e.UNSIGNED_BYTE&&(o=e.RGB8UI),r===e.UNSIGNED_SHORT&&(o=e.RGB16UI),r===e.UNSIGNED_INT&&(o=e.RGB32UI),r===e.BYTE&&(o=e.RGB8I),r===e.SHORT&&(o=e.RGB16I),r===e.INT&&(o=e.RGB32I)),i===e.RGBA_INTEGER&&(r===e.UNSIGNED_BYTE&&(o=e.RGBA8UI),r===e.UNSIGNED_SHORT&&(o=e.RGBA16UI),r===e.UNSIGNED_INT&&(o=e.RGBA32UI),r===e.BYTE&&(o=e.RGBA8I),r===e.SHORT&&(o=e.RGBA16I),r===e.INT&&(o=e.RGBA32I)),i===e.RGB&&(r===e.UNSIGNED_INT_5_9_9_9_REV&&(o=e.RGB9_E5),r===e.UNSIGNED_INT_10F_11F_11F_REV&&(o=e.R11F_G11F_B10F)),i===e.RGBA){const t=a?yk:zO.getTransfer(s);r===e.FLOAT&&(o=e.RGBA32F),r===e.HALF_FLOAT&&(o=e.RGBA16F),r===e.UNSIGNED_BYTE&&(o=t===_k?e.SRGB8_ALPHA8:e.RGBA8),r===e.UNSIGNED_SHORT_4_4_4_4&&(o=e.RGBA4),r===e.UNSIGNED_SHORT_5_5_5_1&&(o=e.RGB5_A1)}return o!==e.R16F&&o!==e.R32F&&o!==e.RG16F&&o!==e.RG32F&&o!==e.RGBA16F&&o!==e.RGBA32F||t.get("EXT_color_buffer_float"),o}function b(t,n){let i;return t?null===n||n===ZI||n===iD?i=e.DEPTH24_STENCIL8:n===$I?i=e.DEPTH32F_STENCIL8:n===JI&&(i=e.DEPTH24_STENCIL8,gO("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===n||n===ZI||n===iD?i=e.DEPTH_COMPONENT24:n===$I?i=e.DEPTH_COMPONENT32F:n===JI&&(i=e.DEPTH_COMPONENT16),i}function x(e,t){return!0===g(e)||e.isFramebufferTexture&&e.minFilter!==FI&&e.minFilter!==GI?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function S(e){const t=e.target;t.removeEventListener("dispose",S),function(e){const t=i.get(e);if(void 0===t.__webglInit)return;const n=e.source,r=h.get(n);if(r){const i=r[t.__cacheKey];i.usedTimes--,0===i.usedTimes&&w(e),0===Object.keys(r).length&&h.delete(n)}i.remove(e)}(t),t.isVideoTexture&&u.delete(t)}function E(t){const n=t.target;n.removeEventListener("dispose",E),function(t){const n=i.get(t);t.depthTexture&&(t.depthTexture.dispose(),i.remove(t.depthTexture));if(t.isWebGLCubeRenderTarget)for(let i=0;i<6;i++){if(Array.isArray(n.__webglFramebuffer[i]))for(let t=0;t<n.__webglFramebuffer[i].length;t++)e.deleteFramebuffer(n.__webglFramebuffer[i][t]);else e.deleteFramebuffer(n.__webglFramebuffer[i]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[i])}else{if(Array.isArray(n.__webglFramebuffer))for(let t=0;t<n.__webglFramebuffer.length;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let t=0;t<n.__webglColorRenderbuffer.length;t++)n.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[t]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const r=t.textures;for(let s=0,o=r.length;s<o;s++){const t=i.get(r[s]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),a.memory.textures--),i.remove(r[s])}i.remove(t)}(n)}function w(t){const n=i.get(t);e.deleteTexture(n.__webglTexture);const r=t.source;delete h.get(r)[n.__cacheKey],a.memory.textures--}let T=0;function M(t,r){const s=i.get(t);if(t.isVideoTexture&&function(e){const t=a.render.frame;u.get(e)!==t&&(u.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&!0!==t.isExternalTexture&&t.version>0&&s.__version!==t.version){const e=t.image;if(null===e)gO("WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void D(s,t,r);gO("WebGLRenderer: Texture marked for update but image is incomplete")}}else t.isExternalTexture&&(s.__webglTexture=t.sourceTexture?t.sourceTexture:null);n.bindTexture(e.TEXTURE_2D,s.__webglTexture,e.TEXTURE0+r)}const A={[kI]:e.REPEAT,[OI]:e.CLAMP_TO_EDGE,[NI]:e.MIRRORED_REPEAT},C={[FI]:e.NEAREST,[BI]:e.NEAREST_MIPMAP_NEAREST,[HI]:e.NEAREST_MIPMAP_LINEAR,[GI]:e.LINEAR,[VI]:e.LINEAR_MIPMAP_NEAREST,[jI]:e.LINEAR_MIPMAP_LINEAR},R={[Nk]:e.NEVER,[Vk]:e.ALWAYS,[Fk]:e.LESS,[Uk]:e.LEQUAL,[Bk]:e.EQUAL,[Gk]:e.GEQUAL,[Hk]:e.GREATER,[zk]:e.NOTEQUAL};function L(n,s){if(s.type!==$I||!1!==t.has("OES_texture_float_linear")||s.magFilter!==GI&&s.magFilter!==VI&&s.magFilter!==HI&&s.magFilter!==jI&&s.minFilter!==GI&&s.minFilter!==VI&&s.minFilter!==HI&&s.minFilter!==jI||gO("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(n,e.TEXTURE_WRAP_S,A[s.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,A[s.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,A[s.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,C[s.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,C[s.minFilter]),s.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,R[s.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){if(s.magFilter===FI)return;if(s.minFilter!==HI&&s.minFilter!==jI)return;if(s.type===$I&&!1===t.has("OES_texture_float_linear"))return;if(s.anisotropy>1||i.get(s).__currentAnisotropy){const a=t.get("EXT_texture_filter_anisotropic");e.texParameterf(n,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy}}}function P(t,n){let i=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",S));const r=n.source;let s=h.get(r);void 0===s&&(s={},h.set(r,s));const o=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(o!==t.__cacheKey){void 0===s[o]&&(s[o]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,i=!0),s[o].usedTimes++;const r=s[t.__cacheKey];void 0!==r&&(s[t.__cacheKey].usedTimes--,0===r.usedTimes&&w(n)),t.__cacheKey=o,t.__webglTexture=s[o].texture}return i}function I(e,t,n){return Math.floor(Math.floor(e/n)/t)}function D(t,a,o){let l=e.TEXTURE_2D;(a.isDataArrayTexture||a.isCompressedArrayTexture)&&(l=e.TEXTURE_2D_ARRAY),a.isData3DTexture&&(l=e.TEXTURE_3D);const c=P(t,a),u=a.source;n.bindTexture(l,t.__webglTexture,e.TEXTURE0+o);const d=i.get(u);if(u.version!==d.__version||!0===c){n.activeTexture(e.TEXTURE0+o);const t=zO.getPrimaries(zO.workingColorSpace),i=a.colorSpace===mk?null:zO.getPrimaries(a.colorSpace),h=a.colorSpace===mk||t===i?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,a.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,a.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,h);let f=m(a.image,!1,r.maxTextureSize);f=G(a,f);const p=s.convert(a.format,a.colorSpace),y=s.convert(a.type);let S,E=_(a.internalFormat,p,y,a.colorSpace,a.isVideoTexture);L(l,a);const w=a.mipmaps,T=!0!==a.isVideoTexture,M=void 0===d.__version||!0===c,A=u.dataReady,C=x(a,f);if(a.isDepthTexture)E=b(a.format===uD,a.type),M&&(T?n.texStorage2D(e.TEXTURE_2D,1,E,f.width,f.height):n.texImage2D(e.TEXTURE_2D,0,E,f.width,f.height,0,p,y,null));else if(a.isDataTexture)if(w.length>0){T&&M&&n.texStorage2D(e.TEXTURE_2D,C,E,w[0].width,w[0].height);for(let t=0,i=w.length;t<i;t++)S=w[t],T?A&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,p,y,S.data):n.texImage2D(e.TEXTURE_2D,t,E,S.width,S.height,0,p,y,S.data);a.generateMipmaps=!1}else T?(M&&n.texStorage2D(e.TEXTURE_2D,C,E,f.width,f.height),A&&function(t,i,r,s){const a=t.updateRanges;if(0===a.length)n.texSubImage2D(e.TEXTURE_2D,0,0,0,i.width,i.height,r,s,i.data);else{a.sort((e,t)=>e.start-t.start);let o=0;for(let e=1;e<a.length;e++){const t=a[o],n=a[e],r=t.start+t.count,s=I(n.start,i.width,4),l=I(t.start,i.width,4);n.start<=r+1&&s===l&&I(n.start+n.count-1,i.width,4)===s?t.count=Math.max(t.count,n.start+n.count-t.start):(++o,a[o]=n)}a.length=o+1;const l=e.getParameter(e.UNPACK_ROW_LENGTH),c=e.getParameter(e.UNPACK_SKIP_PIXELS),u=e.getParameter(e.UNPACK_SKIP_ROWS);e.pixelStorei(e.UNPACK_ROW_LENGTH,i.width);for(let t=0,d=a.length;t<d;t++){const o=a[t],l=Math.floor(o.start/4),c=Math.ceil(o.count/4),u=l%i.width,d=Math.floor(l/i.width),h=c,f=1;e.pixelStorei(e.UNPACK_SKIP_PIXELS,u),e.pixelStorei(e.UNPACK_SKIP_ROWS,d),n.texSubImage2D(e.TEXTURE_2D,0,u,d,h,f,r,s,i.data)}t.clearUpdateRanges(),e.pixelStorei(e.UNPACK_ROW_LENGTH,l),e.pixelStorei(e.UNPACK_SKIP_PIXELS,c),e.pixelStorei(e.UNPACK_SKIP_ROWS,u)}}(a,f,p,y)):n.texImage2D(e.TEXTURE_2D,0,E,f.width,f.height,0,p,y,f.data);else if(a.isCompressedTexture)if(a.isCompressedArrayTexture){T&&M&&n.texStorage3D(e.TEXTURE_2D_ARRAY,C,E,w[0].width,w[0].height,f.depth);for(let t=0,i=w.length;t<i;t++)if(S=w[t],a.format!==lD)if(null!==p)if(T){if(A)if(a.layerUpdates.size>0){const i=dj(S.width,S.height,a.format,a.type);for(const r of a.layerUpdates){const s=S.data.subarray(r*i/S.data.BYTES_PER_ELEMENT,(r+1)*i/S.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,r,S.width,S.height,1,p,s)}a.clearLayerUpdates()}else n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,S.width,S.height,f.depth,p,S.data)}else n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,E,S.width,S.height,f.depth,0,S.data,0,0);else gO("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else T?A&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,S.width,S.height,f.depth,p,y,S.data):n.texImage3D(e.TEXTURE_2D_ARRAY,t,E,S.width,S.height,f.depth,0,p,y,S.data)}else{T&&M&&n.texStorage2D(e.TEXTURE_2D,C,E,w[0].width,w[0].height);for(let t=0,i=w.length;t<i;t++)S=w[t],a.format!==lD?null!==p?T?A&&n.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,p,S.data):n.compressedTexImage2D(e.TEXTURE_2D,t,E,S.width,S.height,0,S.data):gO("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):T?A&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,p,y,S.data):n.texImage2D(e.TEXTURE_2D,t,E,S.width,S.height,0,p,y,S.data)}else if(a.isDataArrayTexture)if(T){if(M&&n.texStorage3D(e.TEXTURE_2D_ARRAY,C,E,f.width,f.height,f.depth),A)if(a.layerUpdates.size>0){const t=dj(f.width,f.height,a.format,a.type);for(const i of a.layerUpdates){const r=f.data.subarray(i*t/f.data.BYTES_PER_ELEMENT,(i+1)*t/f.data.BYTES_PER_ELEMENT);n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,i,f.width,f.height,1,p,y,r)}a.clearLayerUpdates()}else n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,f.width,f.height,f.depth,p,y,f.data)}else n.texImage3D(e.TEXTURE_2D_ARRAY,0,E,f.width,f.height,f.depth,0,p,y,f.data);else if(a.isData3DTexture)T?(M&&n.texStorage3D(e.TEXTURE_3D,C,E,f.width,f.height,f.depth),A&&n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,f.width,f.height,f.depth,p,y,f.data)):n.texImage3D(e.TEXTURE_3D,0,E,f.width,f.height,f.depth,0,p,y,f.data);else if(a.isFramebufferTexture){if(M)if(T)n.texStorage2D(e.TEXTURE_2D,C,E,f.width,f.height);else{let t=f.width,i=f.height;for(let r=0;r<C;r++)n.texImage2D(e.TEXTURE_2D,r,E,t,i,0,p,y,null),t>>=1,i>>=1}}else if(w.length>0){if(T&&M){const t=V(w[0]);n.texStorage2D(e.TEXTURE_2D,C,E,t.width,t.height)}for(let t=0,i=w.length;t<i;t++)S=w[t],T?A&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,p,y,S):n.texImage2D(e.TEXTURE_2D,t,E,p,y,S);a.generateMipmaps=!1}else if(T){if(M){const t=V(f);n.texStorage2D(e.TEXTURE_2D,C,E,t.width,t.height)}A&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,p,y,f)}else n.texImage2D(e.TEXTURE_2D,0,E,p,y,f);g(a)&&v(l),d.__version=u.version,a.onUpdate&&a.onUpdate(a)}t.__version=a.version}function k(t,r,a,l,c,u){const d=s.convert(a.format,a.colorSpace),h=s.convert(a.type),f=_(a.internalFormat,d,h,a.colorSpace),p=i.get(r),m=i.get(a);if(m.__renderTarget=r,!p.__hasExternalTextures){const t=Math.max(1,r.width>>u),i=Math.max(1,r.height>>u);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?n.texImage3D(c,u,f,t,i,r.depth,0,d,h,null):n.texImage2D(c,u,f,t,i,0,d,h,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),z(r)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,l,c,m.__webglTexture,0,H(r)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,l,c,m.__webglTexture,u),n.bindFramebuffer(e.FRAMEBUFFER,null)}function O(t,n,i){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer){const r=n.depthTexture,s=r&&r.isDepthTexture?r.type:null,a=b(n.stencilBuffer,s),l=n.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=H(n);z(n)?o.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,a,n.width,n.height):i?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,a,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,a,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,l,e.RENDERBUFFER,t)}else{const t=n.textures;for(let r=0;r<t.length;r++){const a=t[r],l=s.convert(a.format,a.colorSpace),c=s.convert(a.type),u=_(a.internalFormat,l,c,a.colorSpace),d=H(n);i&&!1===z(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,d,u,n.width,n.height):z(n)?o.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,d,u,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,u,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function N(t,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const s=i.get(r.depthTexture);s.__renderTarget=r,s.__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),M(r.depthTexture,0);const a=s.__webglTexture,l=H(r);if(r.depthTexture.format===cD)z(r)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0,l):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0);else{if(r.depthTexture.format!==uD)throw new Error("Unknown depthTexture format");z(r)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0,l):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0)}}function F(t){const r=i.get(t),s=!0===t.isWebGLCubeRenderTarget;if(r.__boundDepthTexture!==t.depthTexture){const e=t.depthTexture;if(r.__depthDisposeCallback&&r.__depthDisposeCallback(),e){const t=()=>{delete r.__boundDepthTexture,delete r.__depthDisposeCallback,e.removeEventListener("dispose",t)};e.addEventListener("dispose",t),r.__depthDisposeCallback=t}r.__boundDepthTexture=e}if(t.depthTexture&&!r.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");const e=t.texture.mipmaps;e&&e.length>0?N(r.__webglFramebuffer[0],t):N(r.__webglFramebuffer,t)}else if(s){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)if(n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[i]),void 0===r.__webglDepthbuffer[i])r.__webglDepthbuffer[i]=e.createRenderbuffer(),O(r.__webglDepthbuffer[i],t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,s=r.__webglDepthbuffer[i];e.bindRenderbuffer(e.RENDERBUFFER,s),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,s)}}else{const i=t.texture.mipmaps;if(i&&i.length>0?n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[0]):n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer),void 0===r.__webglDepthbuffer)r.__webglDepthbuffer=e.createRenderbuffer(),O(r.__webglDepthbuffer,t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,i=r.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,i),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,i)}}n.bindFramebuffer(e.FRAMEBUFFER,null)}const B=[],U=[];function H(e){return Math.min(r.maxSamples,e.samples)}function z(e){const n=i.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function G(e,t){const n=e.colorSpace,i=e.format,r=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||n!==vk&&n!==mk&&(zO.getTransfer(n)===_k?i===lD&&r===XI||gO("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):vO("WebGLTextures: Unsupported texture color space:",n)),t}function V(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement?(c.width=e.naturalWidth||e.width,c.height=e.naturalHeight||e.height):"undefined"!==typeof VideoFrame&&e instanceof VideoFrame?(c.width=e.displayWidth,c.height=e.displayHeight):(c.width=e.width,c.height=e.height),c}this.allocateTextureUnit=function(){const e=T;return e>=r.maxTextures&&gO("WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+r.maxTextures),T+=1,e},this.resetTextureUnits=function(){T=0},this.setTexture2D=M,this.setTexture2DArray=function(t,r){const s=i.get(t);!1===t.isRenderTargetTexture&&t.version>0&&s.__version!==t.version?D(s,t,r):(t.isExternalTexture&&(s.__webglTexture=t.sourceTexture?t.sourceTexture:null),n.bindTexture(e.TEXTURE_2D_ARRAY,s.__webglTexture,e.TEXTURE0+r))},this.setTexture3D=function(t,r){const s=i.get(t);!1===t.isRenderTargetTexture&&t.version>0&&s.__version!==t.version?D(s,t,r):n.bindTexture(e.TEXTURE_3D,s.__webglTexture,e.TEXTURE0+r)},this.setTextureCube=function(t,a){const o=i.get(t);t.version>0&&o.__version!==t.version?function(t,a,o){if(6!==a.image.length)return;const l=P(t,a),c=a.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+o);const u=i.get(c);if(c.version!==u.__version||!0===l){n.activeTexture(e.TEXTURE0+o);const t=zO.getPrimaries(zO.workingColorSpace),i=a.colorSpace===mk?null:zO.getPrimaries(a.colorSpace),d=a.colorSpace===mk||t===i?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,a.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,a.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);const h=a.isCompressedTexture||a.image[0].isCompressedTexture,f=a.image[0]&&a.image[0].isDataTexture,p=[];for(let e=0;e<6;e++)p[e]=h||f?f?a.image[e].image:a.image[e]:m(a.image[e],!0,r.maxCubemapSize),p[e]=G(a,p[e]);const y=p[0],b=s.convert(a.format,a.colorSpace),S=s.convert(a.type),E=_(a.internalFormat,b,S,a.colorSpace),w=!0!==a.isVideoTexture,T=void 0===u.__version||!0===l,M=c.dataReady;let A,C=x(a,y);if(L(e.TEXTURE_CUBE_MAP,a),h){w&&T&&n.texStorage2D(e.TEXTURE_CUBE_MAP,C,E,y.width,y.height);for(let t=0;t<6;t++){A=p[t].mipmaps;for(let i=0;i<A.length;i++){const r=A[i];a.format!==lD?null!==b?w?M&&n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,0,0,r.width,r.height,b,r.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,E,r.width,r.height,0,r.data):gO("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):w?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,0,0,r.width,r.height,b,S,r.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,E,r.width,r.height,0,b,S,r.data)}}}else{if(A=a.mipmaps,w&&T){A.length>0&&C++;const t=V(p[0]);n.texStorage2D(e.TEXTURE_CUBE_MAP,C,E,t.width,t.height)}for(let t=0;t<6;t++)if(f){w?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,p[t].width,p[t].height,b,S,p[t].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,E,p[t].width,p[t].height,0,b,S,p[t].data);for(let i=0;i<A.length;i++){const r=A[i].image[t].image;w?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,0,0,r.width,r.height,b,S,r.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,E,r.width,r.height,0,b,S,r.data)}}else{w?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,b,S,p[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,E,b,S,p[t]);for(let i=0;i<A.length;i++){const r=A[i];w?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,0,0,b,S,r.image[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,E,b,S,r.image[t])}}}g(a)&&v(e.TEXTURE_CUBE_MAP),u.__version=c.version,a.onUpdate&&a.onUpdate(a)}t.__version=a.version}(o,t,a):n.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture,e.TEXTURE0+a)},this.rebindTextures=function(t,n,r){const s=i.get(t);void 0!==n&&k(s.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==r&&F(t)},this.setupRenderTarget=function(t){const r=t.texture,o=i.get(t),l=i.get(r);t.addEventListener("dispose",E);const c=t.textures,u=!0===t.isWebGLCubeRenderTarget,d=c.length>1;if(d||(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=r.version,a.memory.textures++),u){o.__webglFramebuffer=[];for(let t=0;t<6;t++)if(r.mipmaps&&r.mipmaps.length>0){o.__webglFramebuffer[t]=[];for(let n=0;n<r.mipmaps.length;n++)o.__webglFramebuffer[t][n]=e.createFramebuffer()}else o.__webglFramebuffer[t]=e.createFramebuffer()}else{if(r.mipmaps&&r.mipmaps.length>0){o.__webglFramebuffer=[];for(let t=0;t<r.mipmaps.length;t++)o.__webglFramebuffer[t]=e.createFramebuffer()}else o.__webglFramebuffer=e.createFramebuffer();if(d)for(let t=0,n=c.length;t<n;t++){const n=i.get(c[t]);void 0===n.__webglTexture&&(n.__webglTexture=e.createTexture(),a.memory.textures++)}if(t.samples>0&&!1===z(t)){o.__webglMultisampledFramebuffer=e.createFramebuffer(),o.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,o.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const i=c[n];o.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,o.__webglColorRenderbuffer[n]);const r=s.convert(i.format,i.colorSpace),a=s.convert(i.type),l=_(i.internalFormat,r,a,i.colorSpace,!0===t.isXRRenderTarget),u=H(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,u,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,o.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(o.__webglDepthRenderbuffer=e.createRenderbuffer(),O(o.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(u){n.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),L(e.TEXTURE_CUBE_MAP,r);for(let n=0;n<6;n++)if(r.mipmaps&&r.mipmaps.length>0)for(let i=0;i<r.mipmaps.length;i++)k(o.__webglFramebuffer[n][i],t,r,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i);else k(o.__webglFramebuffer[n],t,r,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);g(r)&&v(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(d){for(let r=0,s=c.length;r<s;r++){const s=c[r],a=i.get(s);let l=e.TEXTURE_2D;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(l,a.__webglTexture),L(l,s),k(o.__webglFramebuffer,t,s,e.COLOR_ATTACHMENT0+r,l,0),g(s)&&v(l)}n.unbindTexture()}else{let i=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(i=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(i,l.__webglTexture),L(i,r),r.mipmaps&&r.mipmaps.length>0)for(let n=0;n<r.mipmaps.length;n++)k(o.__webglFramebuffer[n],t,r,e.COLOR_ATTACHMENT0,i,n);else k(o.__webglFramebuffer,t,r,e.COLOR_ATTACHMENT0,i,0);g(r)&&v(i),n.unbindTexture()}t.depthBuffer&&F(t)},this.updateRenderTargetMipmap=function(e){const t=e.textures;for(let r=0,s=t.length;r<s;r++){const s=t[r];if(g(s)){const t=y(e),r=i.get(s).__webglTexture;n.bindTexture(t,r),v(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0)if(!1===z(t)){const r=t.textures,s=t.width,a=t.height;let o=e.COLOR_BUFFER_BIT;const c=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,u=i.get(t),d=r.length>1;if(d)for(let t=0;t<r.length;t++)n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer);const h=t.texture.mipmaps;h&&h.length>0?n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer[0]):n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let n=0;n<r.length;n++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(o|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(o|=e.STENCIL_BUFFER_BIT)),d){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,u.__webglColorRenderbuffer[n]);const t=i.get(r[n]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,s,a,0,0,s,a,o,e.NEAREST),!0===l&&(B.length=0,U.length=0,B.push(e.COLOR_ATTACHMENT0+n),t.depthBuffer&&!1===t.resolveDepthBuffer&&(B.push(c),U.push(c),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,U)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,B))}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),d)for(let t=0;t<r.length;t++){n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,u.__webglColorRenderbuffer[t]);const s=i.get(r[t]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,s,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&l){const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=F,this.setupFrameBufferTexture=k,this.useMultisampledRTT=z}function BX(e,t){return{convert:function(n){let i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mk;const s=zO.getTransfer(r);if(n===XI)return e.UNSIGNED_BYTE;if(n===tD)return e.UNSIGNED_SHORT_4_4_4_4;if(n===nD)return e.UNSIGNED_SHORT_5_5_5_1;if(n===rD)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===sD)return e.UNSIGNED_INT_10F_11F_11F_REV;if(n===KI)return e.BYTE;if(n===qI)return e.SHORT;if(n===JI)return e.UNSIGNED_SHORT;if(n===QI)return e.INT;if(n===ZI)return e.UNSIGNED_INT;if(n===$I)return e.FLOAT;if(n===eD)return e.HALF_FLOAT;if(n===aD)return e.ALPHA;if(n===oD)return e.RGB;if(n===lD)return e.RGBA;if(n===cD)return e.DEPTH_COMPONENT;if(n===uD)return e.DEPTH_STENCIL;if(n===dD)return e.RED;if(n===hD)return e.RED_INTEGER;if(n===fD)return e.RG;if(n===pD)return e.RG_INTEGER;if(n===gD)return e.RGBA_INTEGER;if(n===vD||n===yD||n===_D||n===bD)if(s===_k){if(i=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(n===vD)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===yD)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===_D)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===bD)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=t.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(n===vD)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===yD)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===_D)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===bD)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===xD||n===SD||n===ED||n===wD){if(i=t.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(n===xD)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===SD)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===ED)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===wD)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===TD||n===MD||n===AD){if(i=t.get("WEBGL_compressed_texture_etc"),null===i)return null;if(n===TD||n===MD)return s===_k?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===AD)return s===_k?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(n===CD||n===RD||n===LD||n===PD||n===ID||n===DD||n===kD||n===OD||n===ND||n===FD||n===BD||n===UD||n===HD||n===zD){if(i=t.get("WEBGL_compressed_texture_astc"),null===i)return null;if(n===CD)return s===_k?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===RD)return s===_k?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===LD)return s===_k?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===PD)return s===_k?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===ID)return s===_k?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===DD)return s===_k?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===kD)return s===_k?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===OD)return s===_k?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===ND)return s===_k?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===FD)return s===_k?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===BD)return s===_k?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===UD)return s===_k?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===HD)return s===_k?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===zD)return s===_k?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===GD||n===VD||n===WD){if(i=t.get("EXT_texture_compression_bptc"),null===i)return null;if(n===GD)return s===_k?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===VD)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===WD)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===jD||n===YD||n===XD||n===KD){if(i=t.get("EXT_texture_compression_rgtc"),null===i)return null;if(n===jD)return i.COMPRESSED_RED_RGTC1_EXT;if(n===YD)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===XD)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===KD)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===iD?e.UNSIGNED_INT_24_8:void 0!==e[n]?e[n]:null}}}class UX{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(null===this.texture){const n=new IH(e.texture);e.depthNear===t.depthNear&&e.depthFar===t.depthFar||(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,n=new _B({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new hB(new Kz(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class HX extends _O{constructor(e,t){super();const n=this;let i=null,r=1,s=null,a="local-floor",o=1,l=null,c=null,u=null,d=null,h=null,f=null;const p="undefined"!==typeof XRWebGLBinding,m=new UX,g={},v=t.getContextAttributes();let y=null,_=null;const b=[],x=[],S=new PO;let E=null;const w=new wB;w.viewport=new ZO;const T=new wB;T.viewport=new ZO;const M=[w,T],A=new kV;let C=null,R=null;function L(e){const t=x.indexOf(e.inputSource);if(-1===t)return;const n=b[t];void 0!==n&&(n.update(e.inputSource,e.frame,l||s),n.dispatchEvent({type:e.type,data:e.inputSource}))}function P(){i.removeEventListener("select",L),i.removeEventListener("selectstart",L),i.removeEventListener("selectend",L),i.removeEventListener("squeeze",L),i.removeEventListener("squeezestart",L),i.removeEventListener("squeezeend",L),i.removeEventListener("end",P),i.removeEventListener("inputsourceschange",I);for(let e=0;e<b.length;e++){const t=x[e];null!==t&&(x[e]=null,b[e].disconnect(t))}C=null,R=null,m.reset();for(const e in g)delete g[e];e.setRenderTarget(y),h=null,d=null,u=null,i=null,_=null,F.stop(),n.isPresenting=!1,e.setPixelRatio(E),e.setSize(S.width,S.height,!1),n.dispatchEvent({type:"sessionend"})}function I(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],i=x.indexOf(n);i>=0&&(x[i]=null,b[i].disconnect(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let i=x.indexOf(n);if(-1===i){for(let e=0;e<b.length;e++){if(e>=x.length){x.push(n),i=e;break}if(null===x[e]){x[e]=n,i=e;break}}if(-1===i)break}const r=b[i];r&&r.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=b[e];return void 0===t&&(t=new PB,b[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=b[e];return void 0===t&&(t=new PB,b[e]=t),t.getGripSpace()},this.getHand=function(e){let t=b[e];return void 0===t&&(t=new PB,b[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){r=e,!0===n.isPresenting&&gO("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){a=e,!0===n.isPresenting&&gO("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==d?d:h},this.getBinding=function(){return null===u&&p&&(u=new XRWebGLBinding(i,t)),u},this.getFrame=function(){return f},this.getSession=function(){return i},this.setSession=async function(c){if(i=c,null!==i){y=e.getRenderTarget(),i.addEventListener("select",L),i.addEventListener("selectstart",L),i.addEventListener("selectend",L),i.addEventListener("squeeze",L),i.addEventListener("squeezestart",L),i.addEventListener("squeezeend",L),i.addEventListener("end",P),i.addEventListener("inputsourceschange",I),!0!==v.xrCompatible&&await t.makeXRCompatible(),E=e.getPixelRatio(),e.getSize(S);if(p&&"createProjectionLayer"in XRWebGLBinding.prototype){let n=null,s=null,a=null;v.depth&&(a=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,n=v.stencil?uD:cD,s=v.stencil?iD:ZI);const o={colorFormat:t.RGBA8,depthFormat:a,scaleFactor:r};u=this.getBinding(),d=u.createProjectionLayer(o),i.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),_=new eN(d.textureWidth,d.textureHeight,{format:lD,type:XI,depthTexture:new PH(d.textureWidth,d.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:!1===d.ignoreDepthValues,resolveStencilBuffer:!1===d.ignoreDepthValues})}else{const n={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:r};h=new XRWebGLLayer(i,t,n),i.updateRenderState({baseLayer:h}),e.setPixelRatio(1),e.setSize(h.framebufferWidth,h.framebufferHeight,!1),_=new eN(h.framebufferWidth,h.framebufferHeight,{format:lD,type:XI,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil,resolveDepthBuffer:!1===h.ignoreDepthValues,resolveStencilBuffer:!1===h.ignoreDepthValues})}_.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await i.requestReferenceSpace(a),F.setContext(i),F.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==i)return i.environmentBlendMode},this.getDepthTexture=function(){return m.getDepthTexture()};const D=new DO,k=new DO;function O(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===i)return;let t=e.near,n=e.far;null!==m.texture&&(m.depthNear>0&&(t=m.depthNear),m.depthFar>0&&(n=m.depthFar)),A.near=T.near=w.near=t,A.far=T.far=w.far=n,C===A.near&&R===A.far||(i.updateRenderState({depthNear:A.near,depthFar:A.far}),C=A.near,R=A.far),A.layers.mask=6|e.layers.mask,w.layers.mask=3&A.layers.mask,T.layers.mask=5&A.layers.mask;const r=e.parent,s=A.cameras;O(A,r);for(let i=0;i<s.length;i++)O(s[i],r);2===s.length?function(e,t,n){D.setFromMatrixPosition(t.matrixWorld),k.setFromMatrixPosition(n.matrixWorld);const i=D.distanceTo(k),r=t.projectionMatrix.elements,s=n.projectionMatrix.elements,a=r[14]/(r[10]-1),o=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],u=(r[8]-1)/r[0],d=(s[8]+1)/s[0],h=a*u,f=a*d,p=i/(-u+d),m=p*-u;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===r[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{const t=a+p,n=o+p,r=h-m,s=f+(i-m),u=l*o/n*t,d=c*o/n*t;e.projectionMatrix.makePerspective(r,s,u,d,t,n),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(A,w,T):A.projectionMatrix.copy(w.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*EO*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,A,r)},this.getCamera=function(){return A},this.getFoveation=function(){if(null!==d||null!==h)return o},this.setFoveation=function(e){o=e,null!==d&&(d.fixedFoveation=e),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==m.texture},this.getDepthSensingMesh=function(){return m.getMesh(A)},this.getCameraTexture=function(e){return g[e]};let N=null;const F=new fj;F.setAnimationLoop(function(t,r){if(c=r.getViewerPose(l||s),f=r,null!==c){const t=c.views;null!==h&&(e.setRenderTargetFramebuffer(_,h.framebuffer),e.setRenderTarget(_));let r=!1;t.length!==A.cameras.length&&(A.cameras.length=0,r=!0);for(let n=0;n<t.length;n++){const i=t[n];let s=null;if(null!==h)s=h.getViewport(i);else{const t=u.getViewSubImage(d,i);s=t.viewport,0===n&&(e.setRenderTargetTextures(_,t.colorTexture,t.depthStencilTexture),e.setRenderTarget(_))}let a=M[n];void 0===a&&(a=new wB,a.layers.enable(n),a.viewport=new ZO,M[n]=a),a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),a.projectionMatrix.fromArray(i.projectionMatrix),a.projectionMatrixInverse.copy(a.projectionMatrix).invert(),a.viewport.set(s.x,s.y,s.width,s.height),0===n&&(A.matrix.copy(a.matrix),A.matrix.decompose(A.position,A.quaternion,A.scale)),!0===r&&A.cameras.push(a)}const s=i.enabledFeatures;if(s&&s.includes("depth-sensing")&&"gpu-optimized"==i.depthUsage&&p){u=n.getBinding();const e=u.getDepthInformation(t[0]);e&&e.isValid&&e.texture&&m.init(e,i.renderState)}if(s&&s.includes("camera-access")&&p){e.state.unbindTexture(),u=n.getBinding();for(let e=0;e<t.length;e++){const n=t[e].camera;if(n){let e=g[n];e||(e=new IH,g[n]=e);const t=u.getCameraImage(n);e.sourceTexture=t}}}}for(let e=0;e<b.length;e++){const t=x[e],n=b[e];null!==t&&void 0!==n&&n.update(t,r,l||s)}N&&N(t,r),r.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:r}),f=null}),this.setAnimationLoop=function(e){N=e},this.dispose=function(){}}}const zX=new GN,GX=new IN;function VX(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function i(e,i){e.opacity.value=i.opacity,i.color&&e.diffuse.value.copy(i.color),i.emissive&&e.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(e.map.value=i.map,n(i.map,e.mapTransform)),i.alphaMap&&(e.alphaMap.value=i.alphaMap,n(i.alphaMap,e.alphaMapTransform)),i.bumpMap&&(e.bumpMap.value=i.bumpMap,n(i.bumpMap,e.bumpMapTransform),e.bumpScale.value=i.bumpScale,i.side===DP&&(e.bumpScale.value*=-1)),i.normalMap&&(e.normalMap.value=i.normalMap,n(i.normalMap,e.normalMapTransform),e.normalScale.value.copy(i.normalScale),i.side===DP&&e.normalScale.value.negate()),i.displacementMap&&(e.displacementMap.value=i.displacementMap,n(i.displacementMap,e.displacementMapTransform),e.displacementScale.value=i.displacementScale,e.displacementBias.value=i.displacementBias),i.emissiveMap&&(e.emissiveMap.value=i.emissiveMap,n(i.emissiveMap,e.emissiveMapTransform)),i.specularMap&&(e.specularMap.value=i.specularMap,n(i.specularMap,e.specularMapTransform)),i.alphaTest>0&&(e.alphaTest.value=i.alphaTest);const r=t.get(i),s=r.envMap,a=r.envMapRotation;s&&(e.envMap.value=s,zX.copy(a),zX.x*=-1,zX.y*=-1,zX.z*=-1,s.isCubeTexture&&!1===s.isRenderTargetTexture&&(zX.y*=-1,zX.z*=-1),e.envMapRotation.value.setFromMatrix4(GX.makeRotationFromEuler(zX)),e.flipEnvMap.value=s.isCubeTexture&&!1===s.isRenderTargetTexture?-1:1,e.reflectivity.value=i.reflectivity,e.ior.value=i.ior,e.refractionRatio.value=i.refractionRatio),i.lightMap&&(e.lightMap.value=i.lightMap,e.lightMapIntensity.value=i.lightMapIntensity,n(i.lightMap,e.lightMapTransform)),i.aoMap&&(e.aoMap.value=i.aoMap,e.aoMapIntensity.value=i.aoMapIntensity,n(i.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,vB(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,r,s,a,o){r.isMeshBasicMaterial||r.isMeshLambertMaterial?i(e,r):r.isMeshToonMaterial?(i(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,r)):r.isMeshPhongMaterial?(i(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,r)):r.isMeshStandardMaterial?(i(e,r),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,n(t.metalnessMap,e.metalnessMapTransform));e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,n(t.roughnessMap,e.roughnessMapTransform));t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,r),r.isMeshPhysicalMaterial&&function(e,t,i){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),t.side===DP&&e.clearcoatNormalScale.value.negate()));t.dispersion>0&&(e.dispersion.value=t.dispersion);t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=i.texture,e.transmissionSamplerSize.value.set(i.width,i.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,r,o)):r.isMeshMatcapMaterial?(i(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,r)):r.isMeshDepthMaterial?i(e,r):r.isMeshDistanceMaterial?(i(e,r),function(e,n){const i=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(i.matrixWorld),e.nearDistance.value=i.shadow.camera.near,e.farDistance.value=i.shadow.camera.far}(e,r)):r.isMeshNormalMaterial?i(e,r):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,i,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*i,e.scale.value=.5*r,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,r,s,a):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function WX(e,t,n,i){let r={},s={},a=[];const o=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(e,t,n,i){const r=e.value,s=t+"_"+n;if(void 0===i[s])return i[s]="number"===typeof r||"boolean"===typeof r?r:r.clone(),!0;{const e=i[s];if("number"===typeof r||"boolean"===typeof r){if(e!==r)return i[s]=r,!0}else if(!1===e.equals(r))return e.copy(r),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"===typeof e||"boolean"===typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?gO("WebGLRenderer: Texture samplers can not be part of an uniforms group."):gO("WebGLRenderer: Unsupported uniform value type.",e),t}function u(t){const n=t.target;n.removeEventListener("dispose",u);const i=a.indexOf(n.__bindingPointIndex);a.splice(i,1),e.deleteBuffer(r[n.id]),delete r[n.id],delete s[n.id]}return{bind:function(e,t){const n=t.program;i.uniformBlockBinding(e,n)},update:function(n,d){let h=r[n.id];void 0===h&&(!function(e){const t=e.uniforms;let n=0;const i=16;for(let s=0,a=t.length;s<a;s++){const e=Array.isArray(t[s])?t[s]:[t[s]];for(let t=0,r=e.length;t<r;t++){const r=e[t],s=Array.isArray(r.value)?r.value:[r.value];for(let e=0,t=s.length;e<t;e++){const t=c(s[e]),a=n%i,o=a%t.boundary,l=a+o;n+=o,0!==l&&i-l<t.storage&&(n+=i-l),r.__data=new Float32Array(t.storage/Float32Array.BYTES_PER_ELEMENT),r.__offset=n,n+=t.storage}}}const r=n%i;r>0&&(n+=i-r);e.__size=n,e.__cache={}}(n),h=function(t){const n=function(){for(let e=0;e<o;e++)if(-1===a.indexOf(e))return a.push(e),e;return vO("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const i=e.createBuffer(),r=t.__size,s=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,i),e.bufferData(e.UNIFORM_BUFFER,r,s),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,i),i}(n),r[n.id]=h,n.addEventListener("dispose",u));const f=d.program;i.updateUBOMapping(n,f);const p=t.render.frame;s[n.id]!==p&&(!function(t){const n=r[t.id],i=t.uniforms,s=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let r=0,a=i.length;r<a;r++){const t=Array.isArray(i[r])?i[r]:[i[r]];for(let n=0,i=t.length;n<i;n++){const i=t[n];if(!0===l(i,r,n,s)){const t=i.__offset,n=Array.isArray(i.value)?i.value:[i.value];let r=0;for(let s=0;s<n.length;s++){const a=n[s],o=c(a);"number"===typeof a||"boolean"===typeof a?(i.__data[0]=a,e.bufferSubData(e.UNIFORM_BUFFER,t+r,i.__data)):a.isMatrix3?(i.__data[0]=a.elements[0],i.__data[1]=a.elements[1],i.__data[2]=a.elements[2],i.__data[3]=0,i.__data[4]=a.elements[3],i.__data[5]=a.elements[4],i.__data[6]=a.elements[5],i.__data[7]=0,i.__data[8]=a.elements[6],i.__data[9]=a.elements[7],i.__data[10]=a.elements[8],i.__data[11]=0):(a.toArray(i.__data,r),r+=o.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,i.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),s[n.id]=p)},dispose:function(){for(const t in r)e.deleteBuffer(r[t]);a=[],r={},s={}}}}const jX=new Uint16Array([11481,15204,11534,15171,11808,15015,12385,14843,12894,14716,13396,14600,13693,14483,13976,14366,14237,14171,14405,13961,14511,13770,14605,13598,14687,13444,14760,13305,14822,13066,14876,12857,14923,12675,14963,12517,14997,12379,15025,12230,15049,12023,15070,11843,15086,11687,15100,11551,15111,11433,15120,11330,15127,11217,15132,11060,15135,10922,15138,10801,15139,10695,15139,10600,13012,14923,13020,14917,13064,14886,13176,14800,13349,14666,13513,14526,13724,14398,13960,14230,14200,14020,14383,13827,14488,13651,14583,13491,14667,13348,14740,13132,14803,12908,14856,12713,14901,12542,14938,12394,14968,12241,14992,12017,15010,11822,15024,11654,15034,11507,15041,11380,15044,11269,15044,11081,15042,10913,15037,10764,15031,10635,15023,10520,15014,10419,15003,10330,13657,14676,13658,14673,13670,14660,13698,14622,13750,14547,13834,14442,13956,14317,14112,14093,14291,13889,14407,13704,14499,13538,14586,13389,14664,13201,14733,12966,14792,12758,14842,12577,14882,12418,14915,12272,14940,12033,14959,11826,14972,11646,14980,11490,14983,11355,14983,11212,14979,11008,14971,10830,14961,10675,14950,10540,14936,10420,14923,10315,14909,10204,14894,10041,14089,14460,14090,14459,14096,14452,14112,14431,14141,14388,14186,14305,14252,14130,14341,13941,14399,13756,14467,13585,14539,13430,14610,13272,14677,13026,14737,12808,14790,12617,14833,12449,14869,12303,14896,12065,14916,11845,14929,11655,14937,11490,14939,11347,14936,11184,14930,10970,14921,10783,14912,10621,14900,10480,14885,10356,14867,10247,14848,10062,14827,9894,14805,9745,14400,14208,14400,14206,14402,14198,14406,14174,14415,14122,14427,14035,14444,13913,14469,13767,14504,13613,14548,13463,14598,13324,14651,13082,14704,12858,14752,12658,14795,12483,14831,12330,14860,12106,14881,11875,14895,11675,14903,11501,14905,11351,14903,11178,14900,10953,14892,10757,14880,10589,14865,10442,14847,10313,14827,10162,14805,9965,14782,9792,14757,9642,14731,9507,14562,13883,14562,13883,14563,13877,14566,13862,14570,13830,14576,13773,14584,13689,14595,13582,14613,13461,14637,13336,14668,13120,14704,12897,14741,12695,14776,12516,14808,12358,14835,12150,14856,11910,14870,11701,14878,11519,14882,11361,14884,11187,14880,10951,14871,10748,14858,10572,14842,10418,14823,10286,14801,10099,14777,9897,14751,9722,14725,9567,14696,9430,14666,9309,14702,13604,14702,13604,14702,13600,14703,13591,14705,13570,14707,13533,14709,13477,14712,13400,14718,13305,14727,13106,14743,12907,14762,12716,14784,12539,14807,12380,14827,12190,14844,11943,14855,11727,14863,11539,14870,11376,14871,11204,14868,10960,14858,10748,14845,10565,14829,10406,14809,10269,14786,10058,14761,9852,14734,9671,14705,9512,14674,9374,14641,9253,14608,9076,14821,13366,14821,13365,14821,13364,14821,13358,14821,13344,14821,13320,14819,13252,14817,13145,14815,13011,14814,12858,14817,12698,14823,12539,14832,12389,14841,12214,14850,11968,14856,11750,14861,11558,14866,11390,14867,11226,14862,10972,14853,10754,14840,10565,14823,10401,14803,10259,14780,10032,14754,9820,14725,9635,14694,9473,14661,9333,14627,9203,14593,8988,14557,8798,14923,13014,14922,13014,14922,13012,14922,13004,14920,12987,14919,12957,14915,12907,14909,12834,14902,12738,14894,12623,14888,12498,14883,12370,14880,12203,14878,11970,14875,11759,14873,11569,14874,11401,14872,11243,14865,10986,14855,10762,14842,10568,14825,10401,14804,10255,14781,10017,14754,9799,14725,9611,14692,9445,14658,9301,14623,9139,14587,8920,14548,8729,14509,8562,15008,12672,15008,12672,15008,12671,15007,12667,15005,12656,15001,12637,14997,12605,14989,12556,14978,12490,14966,12407,14953,12313,14940,12136,14927,11934,14914,11742,14903,11563,14896,11401,14889,11247,14879,10992,14866,10767,14851,10570,14833,10400,14812,10252,14789,10007,14761,9784,14731,9592,14698,9424,14663,9279,14627,9088,14588,8868,14548,8676,14508,8508,14467,8360,15080,12386,15080,12386,15079,12385,15078,12383,15076,12378,15072,12367,15066,12347,15057,12315,15045,12253,15030,12138,15012,11998,14993,11845,14972,11685,14951,11530,14935,11383,14920,11228,14904,10981,14887,10762,14870,10567,14850,10397,14827,10248,14803,9997,14774,9771,14743,9578,14710,9407,14674,9259,14637,9048,14596,8826,14555,8632,14514,8464,14471,8317,14427,8182,15139,12008,15139,12008,15138,12008,15137,12007,15135,12003,15130,11990,15124,11969,15115,11929,15102,11872,15086,11794,15064,11693,15041,11581,15013,11459,14987,11336,14966,11170,14944,10944,14921,10738,14898,10552,14875,10387,14850,10239,14824,9983,14794,9758,14762,9563,14728,9392,14692,9244,14653,9014,14611,8791,14569,8597,14526,8427,14481,8281,14436,8110,14391,7885,15188,11617,15188,11617,15187,11617,15186,11618,15183,11617,15179,11612,15173,11601,15163,11581,15150,11546,15133,11495,15110,11427,15083,11346,15051,11246,15024,11057,14996,10868,14967,10687,14938,10517,14911,10362,14882,10206,14853,9956,14821,9737,14787,9543,14752,9375,14715,9228,14675,8980,14632,8760,14589,8565,14544,8395,14498,8248,14451,8049,14404,7824,14357,7630,15228,11298,15228,11298,15227,11299,15226,11301,15223,11303,15219,11302,15213,11299,15204,11290,15191,11271,15174,11217,15150,11129,15119,11015,15087,10886,15057,10744,15024,10599,14990,10455,14957,10318,14924,10143,14891,9911,14856,9701,14820,9516,14782,9352,14744,9200,14703,8946,14659,8725,14615,8533,14568,8366,14521,8220,14472,7992,14423,7770,14374,7578,14315,7408,15260,10819,15260,10819,15259,10822,15258,10826,15256,10832,15251,10836,15246,10841,15237,10838,15225,10821,15207,10788,15183,10734,15151,10660,15120,10571,15087,10469,15049,10359,15012,10249,14974,10041,14937,9837,14900,9647,14860,9475,14820,9320,14779,9147,14736,8902,14691,8688,14646,8499,14598,8335,14549,8189,14499,7940,14448,7720,14397,7529,14347,7363,14256,7218,15285,10410,15285,10411,15285,10413,15284,10418,15282,10425,15278,10434,15272,10442,15264,10449,15252,10445,15235,10433,15210,10403,15179,10358,15149,10301,15113,10218,15073,10059,15033,9894,14991,9726,14951,9565,14909,9413,14865,9273,14822,9073,14777,8845,14730,8641,14682,8459,14633,8300,14583,8129,14531,7883,14479,7670,14426,7482,14373,7321,14305,7176,14201,6939,15305,9939,15305,9940,15305,9945,15304,9955,15302,9967,15298,9989,15293,10010,15286,10033,15274,10044,15258,10045,15233,10022,15205,9975,15174,9903,15136,9808,15095,9697,15053,9578,15009,9451,14965,9327,14918,9198,14871,8973,14825,8766,14775,8579,14725,8408,14675,8259,14622,8058,14569,7821,14515,7615,14460,7435,14405,7276,14350,7108,14256,6866,14149,6653,15321,9444,15321,9445,15321,9448,15320,9458,15317,9470,15314,9490,15310,9515,15302,9540,15292,9562,15276,9579,15251,9577,15226,9559,15195,9519,15156,9463,15116,9389,15071,9304,15025,9208,14978,9023,14927,8838,14878,8661,14827,8496,14774,8344,14722,8206,14667,7973,14612,7749,14556,7555,14499,7382,14443,7229,14385,7025,14322,6791,14210,6588,14100,6409,15333,8920,15333,8921,15332,8927,15332,8943,15329,8965,15326,9002,15322,9048,15316,9106,15307,9162,15291,9204,15267,9221,15244,9221,15212,9196,15175,9134,15133,9043,15088,8930,15040,8801,14990,8665,14938,8526,14886,8391,14830,8261,14775,8087,14719,7866,14661,7664,14603,7482,14544,7322,14485,7178,14426,6936,14367,6713,14281,6517,14166,6348,14054,6198,15341,8360,15341,8361,15341,8366,15341,8379,15339,8399,15336,8431,15332,8473,15326,8527,15318,8585,15302,8632,15281,8670,15258,8690,15227,8690,15191,8664,15149,8612,15104,8543,15055,8456,15001,8360,14948,8259,14892,8122,14834,7923,14776,7734,14716,7558,14656,7397,14595,7250,14534,7070,14472,6835,14410,6628,14350,6443,14243,6283,14125,6135,14010,5889,15348,7715,15348,7717,15348,7725,15347,7745,15345,7780,15343,7836,15339,7905,15334,8e3,15326,8103,15310,8193,15293,8239,15270,8270,15240,8287,15204,8283,15163,8260,15118,8223,15067,8143,15014,8014,14958,7873,14899,7723,14839,7573,14778,7430,14715,7293,14652,7164,14588,6931,14524,6720,14460,6531,14396,6362,14330,6210,14207,6015,14086,5781,13969,5576,15352,7114,15352,7116,15352,7128,15352,7159,15350,7195,15348,7237,15345,7299,15340,7374,15332,7457,15317,7544,15301,7633,15280,7703,15251,7754,15216,7775,15176,7767,15131,7733,15079,7670,15026,7588,14967,7492,14906,7387,14844,7278,14779,7171,14714,6965,14648,6770,14581,6587,14515,6420,14448,6269,14382,6123,14299,5881,14172,5665,14049,5477,13929,5310,15355,6329,15355,6330,15355,6339,15355,6362,15353,6410,15351,6472,15349,6572,15344,6688,15337,6835,15323,6985,15309,7142,15287,7220,15260,7277,15226,7310,15188,7326,15142,7318,15090,7285,15036,7239,14976,7177,14914,7045,14849,6892,14782,6736,14714,6581,14645,6433,14576,6293,14506,6164,14438,5946,14369,5733,14270,5540,14140,5369,14014,5216,13892,5043,15357,5483,15357,5484,15357,5496,15357,5528,15356,5597,15354,5692,15351,5835,15347,6011,15339,6195,15328,6317,15314,6446,15293,6566,15268,6668,15235,6746,15197,6796,15152,6811,15101,6790,15046,6748,14985,6673,14921,6583,14854,6479,14785,6371,14714,6259,14643,6149,14571,5946,14499,5750,14428,5567,14358,5401,14242,5250,14109,5111,13980,4870,13856,4657,15359,4555,15359,4557,15358,4573,15358,4633,15357,4715,15355,4841,15353,5061,15349,5216,15342,5391,15331,5577,15318,5770,15299,5967,15274,6150,15243,6223,15206,6280,15161,6310,15111,6317,15055,6300,14994,6262,14928,6208,14860,6141,14788,5994,14715,5838,14641,5684,14566,5529,14492,5384,14418,5247,14346,5121,14216,4892,14079,4682,13948,4496,13822,4330,15359,3498,15359,3501,15359,3520,15359,3598,15358,3719,15356,3860,15355,4137,15351,4305,15344,4563,15334,4809,15321,5116,15303,5273,15280,5418,15250,5547,15214,5653,15170,5722,15120,5761,15064,5763,15002,5733,14935,5673,14865,5597,14792,5504,14716,5400,14640,5294,14563,5185,14486,5041,14410,4841,14335,4655,14191,4482,14051,4325,13918,4183,13790,4012,15360,2282,15360,2285,15360,2306,15360,2401,15359,2547,15357,2748,15355,3103,15352,3349,15345,3675,15336,4020,15324,4272,15307,4496,15285,4716,15255,4908,15220,5086,15178,5170,15128,5214,15072,5234,15010,5231,14943,5206,14871,5166,14796,5102,14718,4971,14639,4833,14559,4687,14480,4541,14402,4401,14315,4268,14167,4142,14025,3958,13888,3747,13759,3556,15360,923,15360,925,15360,946,15360,1052,15359,1214,15357,1494,15356,1892,15352,2274,15346,2663,15338,3099,15326,3393,15309,3679,15288,3980,15260,4183,15226,4325,15185,4437,15136,4517,15080,4570,15018,4591,14950,4581,14877,4545,14800,4485,14720,4411,14638,4325,14556,4231,14475,4136,14395,3988,14297,3803,14145,3628,13999,3465,13861,3314,13729,3177,15360,263,15360,264,15360,272,15360,325,15359,407,15358,548,15356,780,15352,1144,15347,1580,15339,2099,15328,2425,15312,2795,15292,3133,15264,3329,15232,3517,15191,3689,15143,3819,15088,3923,15025,3978,14956,3999,14882,3979,14804,3931,14722,3855,14639,3756,14554,3645,14470,3529,14388,3409,14279,3289,14124,3173,13975,3055,13834,2848,13701,2658,15360,49,15360,49,15360,52,15360,75,15359,111,15358,201,15356,283,15353,519,15348,726,15340,1045,15329,1415,15314,1795,15295,2173,15269,2410,15237,2649,15197,2866,15150,3054,15095,3140,15032,3196,14963,3228,14888,3236,14808,3224,14725,3191,14639,3146,14553,3088,14466,2976,14382,2836,14262,2692,14103,2549,13952,2409,13808,2278,13674,2154,15360,4,15360,4,15360,4,15360,13,15359,33,15358,59,15357,112,15353,199,15348,302,15341,456,15331,628,15316,827,15297,1082,15272,1332,15241,1601,15202,1851,15156,2069,15101,2172,15039,2256,14970,2314,14894,2348,14813,2358,14728,2344,14640,2311,14551,2263,14463,2203,14376,2133,14247,2059,14084,1915,13930,1761,13784,1609,13648,1464,15360,0,15360,0,15360,0,15360,3,15359,18,15358,26,15357,53,15354,80,15348,97,15341,165,15332,238,15318,326,15299,427,15275,529,15245,654,15207,771,15161,885,15108,994,15046,1089,14976,1170,14900,1229,14817,1266,14731,1284,14641,1282,14550,1260,14460,1223,14370,1174,14232,1116,14066,1050,13909,981,13761,910,13623,839]);let YX=null;class XX{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{canvas:t=uO(),context:n=null,depth:i=!0,stencil:r=!1,alpha:s=!1,antialias:a=!1,premultipliedAlpha:o=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:u=!1,reversedDepthBuffer:d=!1}=e;let h;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!==typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");h=n.getContextAttributes().alpha}else h=s;const f=new Set([gD,pD,hD]),p=new Set([XI,ZI,JI,iD,tD,nD]),m=new Uint32Array(4),g=new Int32Array(4);let v=null,y=null;const _=[],b=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=yI,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const x=this;let S=!1;this._outputColorSpace=gk;let E=0,w=0,T=null,M=-1,A=null;const C=new ZO,R=new ZO;let L=null;const P=new wF(0);let I=0,D=t.width,k=t.height,O=1,N=null,F=null;const B=new ZO(0,0,D,k),U=new ZO(0,0,D,k);let H=!1;const z=new kU;let G=!1,V=!1;const W=new IN,j=new DO,Y=new ZO,X={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let K=!1;function q(){return null===T?O:1}let J,Q,Z,$,ee,te,ne,ie,re,se,ae,oe,le,ce,ue,de,he,fe,pe,me,ge,ve,ye,_e,be=n;function xe(e,n){return t.getContext(e,n)}try{const e={alpha:!0,depth:i,stencil:r,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r".concat(xP)),t.addEventListener("webglcontextlost",we,!1),t.addEventListener("webglcontextrestored",Te,!1),t.addEventListener("webglcontextcreationerror",Me,!1),null===be){const t="webgl2";if(be=xe(t,e),null===be)throw xe(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(We){throw We("WebGLRenderer: "+We.message),We}function Se(){J=new Gj(be),J.init(),ve=new BX(be,J),Q=new wj(be,J,e,ve),Z=new NX(be,J),Q.reversedDepthBuffer&&d&&Z.buffers.depth.setReversed(!0),$=new jj(be),ee=new EX,te=new FX(be,J,Z,ee,Q,ve,$),ne=new Mj(x),ie=new zj(x),re=new pj(be),ye=new Sj(be,re),se=new Vj(be,re,$,ye),ae=new Xj(be,se,re,$),pe=new Yj(be,Q,te),de=new Tj(ee),oe=new SX(x,ne,ie,J,Q,ye,de),le=new VX(x,ee),ce=new AX,ue=new DX(J),fe=new xj(x,ne,ie,Z,ae,h,o),he=new kX(x,ae,Q),_e=new WX(be,$,Q,Z),me=new Ej(be,J,$),ge=new Wj(be,J,$),$.programs=oe.programs,x.capabilities=Q,x.extensions=J,x.properties=ee,x.renderLists=ce,x.shadowMap=he,x.state=Z,x.info=$}Se();const Ee=new HX(x,be);function we(e){e.preventDefault(),mO("WebGLRenderer: Context Lost."),S=!0}function Te(){mO("WebGLRenderer: Context Restored."),S=!1;const e=$.autoReset,t=he.enabled,n=he.autoUpdate,i=he.needsUpdate,r=he.type;Se(),$.autoReset=e,he.enabled=t,he.autoUpdate=n,he.needsUpdate=i,he.type=r}function Me(e){vO("WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Ae(e){const t=e.target;t.removeEventListener("dispose",Ae),function(e){(function(e){const t=ee.get(e).programs;void 0!==t&&(t.forEach(function(e){oe.releaseProgram(e)}),e.isShaderMaterial&&oe.releaseShaderCache(e))})(e),ee.remove(e)}(t)}function Ce(e,t,n){!0===e.transparent&&e.side===kP&&!1===e.forceSinglePass?(e.side=DP,e.needsUpdate=!0,Be(e,t,n),e.side=IP,e.needsUpdate=!0,Be(e,t,n),e.side=kP):Be(e,t,n)}this.xr=Ee,this.getContext=function(){return be},this.getContextAttributes=function(){return be.getContextAttributes()},this.forceContextLoss=function(){const e=J.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=J.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return O},this.setPixelRatio=function(e){void 0!==e&&(O=e,this.setSize(D,k,!1))},this.getSize=function(e){return e.set(D,k)},this.setSize=function(e,n){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Ee.isPresenting?gO("WebGLRenderer: Can't change size while VR device is presenting."):(D=e,k=n,t.width=Math.floor(e*O),t.height=Math.floor(n*O),!0===i&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(D*O,k*O).floor()},this.setDrawingBufferSize=function(e,n,i){D=e,k=n,O=i,t.width=Math.floor(e*i),t.height=Math.floor(n*i),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(C)},this.getViewport=function(e){return e.copy(B)},this.setViewport=function(e,t,n,i){e.isVector4?B.set(e.x,e.y,e.z,e.w):B.set(e,t,n,i),Z.viewport(C.copy(B).multiplyScalar(O).round())},this.getScissor=function(e){return e.copy(U)},this.setScissor=function(e,t,n,i){e.isVector4?U.set(e.x,e.y,e.z,e.w):U.set(e,t,n,i),Z.scissor(R.copy(U).multiplyScalar(O).round())},this.getScissorTest=function(){return H},this.setScissorTest=function(e){Z.setScissorTest(H=e)},this.setOpaqueSort=function(e){N=e},this.setTransparentSort=function(e){F=e},this.getClearColor=function(e){return e.copy(fe.getClearColor())},this.setClearColor=function(){fe.setClearColor(...arguments)},this.getClearAlpha=function(){return fe.getClearAlpha()},this.setClearAlpha=function(){fe.setClearAlpha(...arguments)},this.clear=function(){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){let e=!1;if(null!==T){const t=T.texture.format;e=f.has(t)}if(e){const e=T.texture.type,t=p.has(e),n=fe.getClearColor(),i=fe.getClearAlpha(),r=n.r,s=n.g,a=n.b;t?(m[0]=r,m[1]=s,m[2]=a,m[3]=i,be.clearBufferuiv(be.COLOR,0,m)):(g[0]=r,g[1]=s,g[2]=a,g[3]=i,be.clearBufferiv(be.COLOR,0,g))}else n|=be.COLOR_BUFFER_BIT}e&&(n|=be.DEPTH_BUFFER_BIT),t&&(n|=be.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),be.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",we,!1),t.removeEventListener("webglcontextrestored",Te,!1),t.removeEventListener("webglcontextcreationerror",Me,!1),fe.dispose(),ce.dispose(),ue.dispose(),ee.dispose(),ne.dispose(),ie.dispose(),ae.dispose(),ye.dispose(),_e.dispose(),oe.dispose(),Ee.dispose(),Ee.removeEventListener("sessionstart",Le),Ee.removeEventListener("sessionend",Pe),Ie.stop()},this.renderBufferDirect=function(e,t,n,i,r,s){null===t&&(t=X);const a=r.isMesh&&r.matrixWorld.determinant()<0,o=function(e,t,n,i,r){!0!==t.isScene&&(t=X);te.resetTextureUnits();const s=t.fog,a=i.isMeshStandardMaterial?t.environment:null,o=null===T?x.outputColorSpace:!0===T.isXRRenderTarget?T.texture.colorSpace:vk,l=(i.isMeshStandardMaterial?ie:ne).get(i.envMap||a),c=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!n.attributes.tangent&&(!!i.normalMap||i.anisotropy>0),d=!!n.morphAttributes.position,h=!!n.morphAttributes.normal,f=!!n.morphAttributes.color;let p=yI;i.toneMapped&&(null!==T&&!0!==T.isXRRenderTarget||(p=x.toneMapping));const m=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,g=void 0!==m?m.length:0,v=ee.get(i),_=y.state.lights;if(!0===G&&(!0===V||e!==A)){const t=e===A&&i.id===M;de.setState(i,e,t)}let b=!1;i.version===v.__version?v.needsLights&&v.lightsStateVersion!==_.state.version||v.outputColorSpace!==o||r.isBatchedMesh&&!1===v.batching?b=!0:r.isBatchedMesh||!0!==v.batching?r.isBatchedMesh&&!0===v.batchingColor&&null===r.colorTexture||r.isBatchedMesh&&!1===v.batchingColor&&null!==r.colorTexture||r.isInstancedMesh&&!1===v.instancing?b=!0:r.isInstancedMesh||!0!==v.instancing?r.isSkinnedMesh&&!1===v.skinning?b=!0:r.isSkinnedMesh||!0!==v.skinning?r.isInstancedMesh&&!0===v.instancingColor&&null===r.instanceColor||r.isInstancedMesh&&!1===v.instancingColor&&null!==r.instanceColor||r.isInstancedMesh&&!0===v.instancingMorph&&null===r.morphTexture||r.isInstancedMesh&&!1===v.instancingMorph&&null!==r.morphTexture||v.envMap!==l||!0===i.fog&&v.fog!==s?b=!0:void 0===v.numClippingPlanes||v.numClippingPlanes===de.numPlanes&&v.numIntersection===de.numIntersection?(v.vertexAlphas!==c||v.vertexTangents!==u||v.morphTargets!==d||v.morphNormals!==h||v.morphColors!==f||v.toneMapping!==p||v.morphTargetsCount!==g)&&(b=!0):b=!0:b=!0:b=!0:b=!0:(b=!0,v.__version=i.version);let S=v.currentProgram;!0===b&&(S=Be(i,t,r));let E=!1,w=!1,C=!1;const R=S.getUniforms(),L=v.uniforms;Z.useProgram(S.program)&&(E=!0,w=!0,C=!0);i.id!==M&&(M=i.id,w=!0);if(E||A!==e){Z.buffers.depth.getReversed()&&!0!==e.reversedDepth&&(e._reversedDepth=!0,e.updateProjectionMatrix()),R.setValue(be,"projectionMatrix",e.projectionMatrix),R.setValue(be,"viewMatrix",e.matrixWorldInverse);const t=R.map.cameraPosition;void 0!==t&&t.setValue(be,j.setFromMatrixPosition(e.matrixWorld)),Q.logarithmicDepthBuffer&&R.setValue(be,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&R.setValue(be,"isOrthographic",!0===e.isOrthographicCamera),A!==e&&(A=e,w=!0,C=!0)}if(r.isSkinnedMesh){R.setOptional(be,r,"bindMatrix"),R.setOptional(be,r,"bindMatrixInverse");const e=r.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),R.setValue(be,"boneTexture",e.boneTexture,te))}r.isBatchedMesh&&(R.setOptional(be,r,"batchingTexture"),R.setValue(be,"batchingTexture",r._matricesTexture,te),R.setOptional(be,r,"batchingIdTexture"),R.setValue(be,"batchingIdTexture",r._indirectTexture,te),R.setOptional(be,r,"batchingColorTexture"),null!==r._colorsTexture&&R.setValue(be,"batchingColorTexture",r._colorsTexture,te));const P=n.morphAttributes;void 0===P.position&&void 0===P.normal&&void 0===P.color||pe.update(r,n,S);(w||v.receiveShadow!==r.receiveShadow)&&(v.receiveShadow=r.receiveShadow,R.setValue(be,"receiveShadow",r.receiveShadow));i.isMeshGouraudMaterial&&null!==i.envMap&&(L.envMap.value=l,L.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);i.isMeshStandardMaterial&&null===i.envMap&&null!==t.environment&&(L.envMapIntensity.value=t.environmentIntensity);void 0!==L.dfgLUT&&(L.dfgLUT.value=(null===YX&&(YX=new pU(jX,32,32,fD,eD),YX.minFilter=GI,YX.magFilter=GI,YX.wrapS=OI,YX.wrapT=OI,YX.generateMipmaps=!1,YX.needsUpdate=!0),YX));w&&(R.setValue(be,"toneMappingExposure",x.toneMappingExposure),v.needsLights&&(D=C,(I=L).ambientLightColor.needsUpdate=D,I.lightProbe.needsUpdate=D,I.directionalLights.needsUpdate=D,I.directionalLightShadows.needsUpdate=D,I.pointLights.needsUpdate=D,I.pointLightShadows.needsUpdate=D,I.spotLights.needsUpdate=D,I.spotLightShadows.needsUpdate=D,I.rectAreaLights.needsUpdate=D,I.hemisphereLights.needsUpdate=D),s&&!0===i.fog&&le.refreshFogUniforms(L,s),le.refreshMaterialUniforms(L,i,O,k,y.state.transmissionRenderTarget[e.id]),ZY.upload(be,Ue(v),L,te));var I,D;i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(ZY.upload(be,Ue(v),L,te),i.uniformsNeedUpdate=!1);i.isSpriteMaterial&&R.setValue(be,"center",r.center);if(R.setValue(be,"modelViewMatrix",r.modelViewMatrix),R.setValue(be,"normalMatrix",r.normalMatrix),R.setValue(be,"modelMatrix",r.matrixWorld),i.isShaderMaterial||i.isRawShaderMaterial){const e=i.uniformsGroups;for(let t=0,n=e.length;t<n;t++){const n=e[t];_e.update(n,S),_e.bind(n,S)}}return S}(e,t,n,i,r);Z.setMaterial(i,a);let l=n.index,c=1;if(!0===i.wireframe){if(l=se.getWireframeAttribute(n),void 0===l)return;c=2}const u=n.drawRange,d=n.attributes.position;let h=u.start*c,f=(u.start+u.count)*c;null!==s&&(h=Math.max(h,s.start*c),f=Math.min(f,(s.start+s.count)*c)),null!==l?(h=Math.max(h,0),f=Math.min(f,l.count)):void 0!==d&&null!==d&&(h=Math.max(h,0),f=Math.min(f,d.count));const p=f-h;if(p<0||p===1/0)return;let m;ye.setup(r,i,o,n,l);let g=me;if(null!==l&&(m=re.get(l),g=ge,g.setIndex(m)),r.isMesh)!0===i.wireframe?(Z.setLineWidth(i.wireframeLinewidth*q()),g.setMode(be.LINES)):g.setMode(be.TRIANGLES);else if(r.isLine){let e=i.linewidth;void 0===e&&(e=1),Z.setLineWidth(e*q()),r.isLineSegments?g.setMode(be.LINES):r.isLineLoop?g.setMode(be.LINE_LOOP):g.setMode(be.LINE_STRIP)}else r.isPoints?g.setMode(be.POINTS):r.isSprite&&g.setMode(be.TRIANGLES);if(r.isBatchedMesh)if(null!==r._multiDrawInstances)yO("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),g.renderMultiDrawInstances(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount,r._multiDrawInstances);else if(J.get("WEBGL_multi_draw"))g.renderMultiDraw(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount);else{const e=r._multiDrawStarts,t=r._multiDrawCounts,n=r._multiDrawCount,s=l?re.get(l).bytesPerElement:1,a=ee.get(i).currentProgram.getUniforms();for(let i=0;i<n;i++)a.setValue(be,"_gl_DrawID",i),g.render(e[i]/s,t[i])}else if(r.isInstancedMesh)g.renderInstances(h,p,r.count);else if(n.isInstancedBufferGeometry){const e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);g.renderInstances(h,p,t)}else g.render(h,p)},this.compile=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===n&&(n=e),y=ue.get(n),y.init(t),b.push(y),n.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(y.pushLight(e),e.castShadow&&y.pushShadow(e))}),e!==n&&e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(y.pushLight(e),e.castShadow&&y.pushShadow(e))}),y.setupLights();const i=new Set;return e.traverse(function(e){if(!(e.isMesh||e.isPoints||e.isLine||e.isSprite))return;const t=e.material;if(t)if(Array.isArray(t))for(let r=0;r<t.length;r++){const s=t[r];Ce(s,n,e),i.add(s)}else Ce(t,n,e),i.add(t)}),y=b.pop(),i},this.compileAsync=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.compile(e,t,n);return new Promise(t=>{function n(){i.forEach(function(e){ee.get(e).currentProgram.isReady()&&i.delete(e)}),0!==i.size?setTimeout(n,10):t(e)}null!==J.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)})};let Re=null;function Le(){Ie.stop()}function Pe(){Ie.start()}const Ie=new fj;function De(e,t,n,i){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)y.pushLight(e),e.castShadow&&y.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||z.intersectsSprite(e)){i&&Y.setFromMatrixPosition(e.matrixWorld).applyMatrix4(W);const t=ae.update(e),r=e.material;r.visible&&v.push(e,t,r,n,Y.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||z.intersectsObject(e))){const t=ae.update(e),r=e.material;if(i&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),Y.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),Y.copy(t.boundingSphere.center)),Y.applyMatrix4(e.matrixWorld).applyMatrix4(W)),Array.isArray(r)){const i=t.groups;for(let s=0,a=i.length;s<a;s++){const a=i[s],o=r[a.materialIndex];o&&o.visible&&v.push(e,t,o,n,Y.z,a)}}else r.visible&&v.push(e,t,r,n,Y.z,null)}const r=e.children;for(let s=0,a=r.length;s<a;s++)De(r[s],t,n,i)}function ke(e,t,n,i){const{opaque:r,transmissive:s,transparent:a}=e;y.setupLightsView(n),!0===G&&de.setGlobalState(x.clippingPlanes,n),i&&Z.viewport(C.copy(i)),r.length>0&&Ne(r,t,n),s.length>0&&Ne(s,t,n),a.length>0&&Ne(a,t,n),Z.buffers.depth.setTest(!0),Z.buffers.depth.setMask(!0),Z.buffers.color.setMask(!0),Z.setPolygonOffset(!1)}function Oe(e,t,n,i){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===y.state.transmissionRenderTarget[i.id]&&(y.state.transmissionRenderTarget[i.id]=new eN(1,1,{generateMipmaps:!0,type:J.has("EXT_color_buffer_half_float")||J.has("EXT_color_buffer_float")?eD:XI,minFilter:jI,samples:4,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:zO.workingColorSpace}));const s=y.state.transmissionRenderTarget[i.id],a=i.viewport||C;s.setSize(a.z*x.transmissionResolutionScale,a.w*x.transmissionResolutionScale);const o=x.getRenderTarget(),l=x.getActiveCubeFace(),c=x.getActiveMipmapLevel();x.setRenderTarget(s),x.getClearColor(P),I=x.getClearAlpha(),I<1&&x.setClearColor(16777215,.5),x.clear(),K&&fe.render(n);const u=x.toneMapping;x.toneMapping=yI;const d=i.viewport;if(void 0!==i.viewport&&(i.viewport=void 0),y.setupLightsView(i),!0===G&&de.setGlobalState(x.clippingPlanes,i),Ne(e,n,i),te.updateMultisampleRenderTarget(s),te.updateRenderTargetMipmap(s),!1===J.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let r=0,s=t.length;r<s;r++){const s=t[r],{object:a,geometry:o,material:l,group:c}=s;if(l.side===kP&&a.layers.test(i.layers)){const t=l.side;l.side=DP,l.needsUpdate=!0,Fe(a,n,i,o,l,c),l.side=t,l.needsUpdate=!0,e=!0}}!0===e&&(te.updateMultisampleRenderTarget(s),te.updateRenderTargetMipmap(s))}x.setRenderTarget(o,l,c),x.setClearColor(P,I),void 0!==d&&(i.viewport=d),x.toneMapping=u}function Ne(e,t,n){const i=!0===t.isScene?t.overrideMaterial:null;for(let r=0,s=e.length;r<s;r++){const s=e[r],{object:a,geometry:o,group:l}=s;let c=s.material;!0===c.allowOverride&&null!==i&&(c=i),a.layers.test(n.layers)&&Fe(a,t,n,o,c,l)}}function Fe(e,t,n,i,r,s){e.onBeforeRender(x,t,n,i,r,s),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),r.onBeforeRender(x,t,n,i,e,s),!0===r.transparent&&r.side===kP&&!1===r.forceSinglePass?(r.side=DP,r.needsUpdate=!0,x.renderBufferDirect(n,t,i,r,e,s),r.side=IP,r.needsUpdate=!0,x.renderBufferDirect(n,t,i,r,e,s),r.side=kP):x.renderBufferDirect(n,t,i,r,e,s),e.onAfterRender(x,t,n,i,r,s)}function Be(e,t,n){!0!==t.isScene&&(t=X);const i=ee.get(e),r=y.state.lights,s=y.state.shadowsArray,a=r.state.version,o=oe.getParameters(e,r.state,s,t,n),l=oe.getProgramCacheKey(o);let c=i.programs;i.environment=e.isMeshStandardMaterial?t.environment:null,i.fog=t.fog,i.envMap=(e.isMeshStandardMaterial?ie:ne).get(e.envMap||i.environment),i.envMapRotation=null!==i.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===c&&(e.addEventListener("dispose",Ae),c=new Map,i.programs=c);let u=c.get(l);if(void 0!==u){if(i.currentProgram===u&&i.lightsStateVersion===a)return He(e,o),u}else o.uniforms=oe.getUniforms(e),e.onBeforeCompile(o,x),u=oe.acquireProgram(o,l),c.set(l,u),i.uniforms=o.uniforms;const d=i.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(d.clippingPlanes=de.uniform),He(e,o),i.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),i.lightsStateVersion=a,i.needsLights&&(d.ambientLightColor.value=r.state.ambient,d.lightProbe.value=r.state.probe,d.directionalLights.value=r.state.directional,d.directionalLightShadows.value=r.state.directionalShadow,d.spotLights.value=r.state.spot,d.spotLightShadows.value=r.state.spotShadow,d.rectAreaLights.value=r.state.rectArea,d.ltc_1.value=r.state.rectAreaLTC1,d.ltc_2.value=r.state.rectAreaLTC2,d.pointLights.value=r.state.point,d.pointLightShadows.value=r.state.pointShadow,d.hemisphereLights.value=r.state.hemi,d.directionalShadowMap.value=r.state.directionalShadowMap,d.directionalShadowMatrix.value=r.state.directionalShadowMatrix,d.spotShadowMap.value=r.state.spotShadowMap,d.spotLightMatrix.value=r.state.spotLightMatrix,d.spotLightMap.value=r.state.spotLightMap,d.pointShadowMap.value=r.state.pointShadowMap,d.pointShadowMatrix.value=r.state.pointShadowMatrix),i.currentProgram=u,i.uniformsList=null,u}function Ue(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=ZY.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function He(e,t){const n=ee.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.batchingColor=t.batchingColor,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.instancingMorph=t.instancingMorph,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}Ie.setAnimationLoop(function(e){Re&&Re(e)}),"undefined"!==typeof self&&Ie.setContext(self),this.setAnimationLoop=function(e){Re=e,Ee.setAnimationLoop(e),null===e?Ie.stop():Ie.start()},Ee.addEventListener("sessionstart",Le),Ee.addEventListener("sessionend",Pe),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void vO("WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===S)return;if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===Ee.enabled&&!0===Ee.isPresenting&&(!0===Ee.cameraAutoUpdate&&Ee.updateCamera(t),t=Ee.getCamera()),!0===e.isScene&&e.onBeforeRender(x,e,t,T),y=ue.get(e,b.length),y.init(t),b.push(y),W.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),z.setFromProjectionMatrix(W,tO,t.reversedDepth),V=this.localClippingEnabled,G=de.init(this.clippingPlanes,V),v=ce.get(e,_.length),v.init(),_.push(v),!0===Ee.enabled&&!0===Ee.isPresenting){const e=x.xr.getDepthSensingMesh();null!==e&&De(e,t,-1/0,x.sortObjects)}De(e,t,0,x.sortObjects),v.finish(),!0===x.sortObjects&&v.sort(N,F),K=!1===Ee.enabled||!1===Ee.isPresenting||!1===Ee.hasDepthSensing(),K&&fe.addToRenderList(v,e),this.info.render.frame++,!0===G&&de.beginShadows();const n=y.state.shadowsArray;he.render(n,e,t),!0===G&&de.endShadows(),!0===this.info.autoReset&&this.info.reset();const i=v.opaque,r=v.transmissive;if(y.setupLights(),t.isArrayCamera){const n=t.cameras;if(r.length>0)for(let t=0,s=n.length;t<s;t++){Oe(i,r,e,n[t])}K&&fe.render(e);for(let t=0,i=n.length;t<i;t++){const i=n[t];ke(v,e,i,i.viewport)}}else r.length>0&&Oe(i,r,e,t),K&&fe.render(e),ke(v,e,t);null!==T&&0===w&&(te.updateMultisampleRenderTarget(T),te.updateRenderTargetMipmap(T)),!0===e.isScene&&e.onAfterRender(x,e,t),ye.resetDefaultState(),M=-1,A=null,b.pop(),b.length>0?(y=b[b.length-1],!0===G&&de.setGlobalState(x.clippingPlanes,y.state.camera)):y=null,_.pop(),v=_.length>0?_[_.length-1]:null},this.getActiveCubeFace=function(){return E},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return T},this.setRenderTargetTextures=function(e,t,n){const i=ee.get(e);i.__autoAllocateDepthBuffer=!1===e.resolveDepthBuffer,!1===i.__autoAllocateDepthBuffer&&(i.__useRenderToTexture=!1),ee.get(e.texture).__webglTexture=t,ee.get(e.depthTexture).__webglTexture=i.__autoAllocateDepthBuffer?void 0:n,i.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(e,t){const n=ee.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t};const ze=be.createFramebuffer();this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;T=e,E=t,w=n;let i=!0,r=null,s=!1,a=!1;if(e){const o=ee.get(e);if(void 0!==o.__useDefaultFramebuffer)Z.bindFramebuffer(be.FRAMEBUFFER,null),i=!1;else if(void 0===o.__webglFramebuffer)te.setupRenderTarget(e);else if(o.__hasExternalTextures)te.rebindTextures(e,ee.get(e.texture).__webglTexture,ee.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){const t=e.depthTexture;if(o.__boundDepthTexture!==t){if(null!==t&&ee.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");te.setupDepthRenderbuffer(e)}}const l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(a=!0);const c=ee.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=Array.isArray(c[t])?c[t][n]:c[t],s=!0):r=e.samples>0&&!1===te.useMultisampledRTT(e)?ee.get(e).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,C.copy(e.viewport),R.copy(e.scissor),L=e.scissorTest}else C.copy(B).multiplyScalar(O).floor(),R.copy(U).multiplyScalar(O).floor(),L=H;0!==n&&(r=ze);if(Z.bindFramebuffer(be.FRAMEBUFFER,r)&&i&&Z.drawBuffers(e,r),Z.viewport(C),Z.scissor(R),Z.setScissorTest(L),s){const i=ee.get(e.texture);be.framebufferTexture2D(be.FRAMEBUFFER,be.COLOR_ATTACHMENT0,be.TEXTURE_CUBE_MAP_POSITIVE_X+t,i.__webglTexture,n)}else if(a){const i=t;for(let t=0;t<e.textures.length;t++){const r=ee.get(e.textures[t]);be.framebufferTextureLayer(be.FRAMEBUFFER,be.COLOR_ATTACHMENT0+t,r.__webglTexture,n,i)}}else if(null!==e&&0!==n){const t=ee.get(e.texture);be.framebufferTexture2D(be.FRAMEBUFFER,be.COLOR_ATTACHMENT0,be.TEXTURE_2D,t.__webglTexture,n)}M=-1},this.readRenderTargetPixels=function(e,t,n,i,r,s,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;if(!e||!e.isWebGLRenderTarget)return void vO("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=ee.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(l=l[a]),l){Z.bindFramebuffer(be.FRAMEBUFFER,l);try{const a=e.textures[o],l=a.format,c=a.type;if(!Q.textureFormatReadable(l))return void vO("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!Q.textureTypeReadable(c))return void vO("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r&&(e.textures.length>1&&be.readBuffer(be.COLOR_ATTACHMENT0+o),be.readPixels(t,n,i,r,ve.convert(l),ve.convert(c),s))}finally{const e=null!==T?ee.get(T).__webglFramebuffer:null;Z.bindFramebuffer(be.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,n,i,r,s,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=ee.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(l=l[a]),l){if(t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r){Z.bindFramebuffer(be.FRAMEBUFFER,l);const a=e.textures[o],c=a.format,u=a.type;if(!Q.textureFormatReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Q.textureTypeReadable(u))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const d=be.createBuffer();be.bindBuffer(be.PIXEL_PACK_BUFFER,d),be.bufferData(be.PIXEL_PACK_BUFFER,s.byteLength,be.STREAM_READ),e.textures.length>1&&be.readBuffer(be.COLOR_ATTACHMENT0+o),be.readPixels(t,n,i,r,ve.convert(c),ve.convert(u),0);const h=null!==T?ee.get(T).__webglFramebuffer:null;Z.bindFramebuffer(be.FRAMEBUFFER,h);const f=be.fenceSync(be.SYNC_GPU_COMMANDS_COMPLETE,0);return be.flush(),await function(e,t,n){return new Promise(function(i,r){setTimeout(function s(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:r();break;case e.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:i()}},n)})}(be,f,4),be.bindBuffer(be.PIXEL_PACK_BUFFER,d),be.getBufferSubData(be.PIXEL_PACK_BUFFER,0,s),be.deleteBuffer(d),be.deleteSync(f),s}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=Math.pow(2,-n),r=Math.floor(e.image.width*i),s=Math.floor(e.image.height*i),a=null!==t?t.x:0,o=null!==t?t.y:0;te.setTexture2D(e,0),be.copyTexSubImage2D(be.TEXTURE_2D,n,0,0,a,o,r,s),Z.unbindTexture()};const Ge=be.createFramebuffer(),Ve=be.createFramebuffer();this.copyTextureToTexture=function(e,t){let n,i,r,s,a,o,l,c,u,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;null===p&&(0!==f?(yO("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),p=f,f=0):p=0);const m=e.isCompressedTexture?e.mipmaps[p]:e.image;if(null!==d)n=d.max.x-d.min.x,i=d.max.y-d.min.y,r=d.isBox3?d.max.z-d.min.z:1,s=d.min.x,a=d.min.y,o=d.isBox3?d.min.z:0;else{const t=Math.pow(2,-f);n=Math.floor(m.width*t),i=Math.floor(m.height*t),r=e.isDataArrayTexture?m.depth:e.isData3DTexture?Math.floor(m.depth*t):1,s=0,a=0,o=0}null!==h?(l=h.x,c=h.y,u=h.z):(l=0,c=0,u=0);const g=ve.convert(t.format),v=ve.convert(t.type);let y;t.isData3DTexture?(te.setTexture3D(t,0),y=be.TEXTURE_3D):t.isDataArrayTexture||t.isCompressedArrayTexture?(te.setTexture2DArray(t,0),y=be.TEXTURE_2D_ARRAY):(te.setTexture2D(t,0),y=be.TEXTURE_2D),be.pixelStorei(be.UNPACK_FLIP_Y_WEBGL,t.flipY),be.pixelStorei(be.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),be.pixelStorei(be.UNPACK_ALIGNMENT,t.unpackAlignment);const _=be.getParameter(be.UNPACK_ROW_LENGTH),b=be.getParameter(be.UNPACK_IMAGE_HEIGHT),x=be.getParameter(be.UNPACK_SKIP_PIXELS),S=be.getParameter(be.UNPACK_SKIP_ROWS),E=be.getParameter(be.UNPACK_SKIP_IMAGES);be.pixelStorei(be.UNPACK_ROW_LENGTH,m.width),be.pixelStorei(be.UNPACK_IMAGE_HEIGHT,m.height),be.pixelStorei(be.UNPACK_SKIP_PIXELS,s),be.pixelStorei(be.UNPACK_SKIP_ROWS,a),be.pixelStorei(be.UNPACK_SKIP_IMAGES,o);const w=e.isDataArrayTexture||e.isData3DTexture,T=t.isDataArrayTexture||t.isData3DTexture;if(e.isDepthTexture){const d=ee.get(e),h=ee.get(t),m=ee.get(d.__renderTarget),g=ee.get(h.__renderTarget);Z.bindFramebuffer(be.READ_FRAMEBUFFER,m.__webglFramebuffer),Z.bindFramebuffer(be.DRAW_FRAMEBUFFER,g.__webglFramebuffer);for(let v=0;v<r;v++)w&&(be.framebufferTextureLayer(be.READ_FRAMEBUFFER,be.COLOR_ATTACHMENT0,ee.get(e).__webglTexture,f,o+v),be.framebufferTextureLayer(be.DRAW_FRAMEBUFFER,be.COLOR_ATTACHMENT0,ee.get(t).__webglTexture,p,u+v)),be.blitFramebuffer(s,a,n,i,l,c,n,i,be.DEPTH_BUFFER_BIT,be.NEAREST);Z.bindFramebuffer(be.READ_FRAMEBUFFER,null),Z.bindFramebuffer(be.DRAW_FRAMEBUFFER,null)}else if(0!==f||e.isRenderTargetTexture||ee.has(e)){const d=ee.get(e),h=ee.get(t);Z.bindFramebuffer(be.READ_FRAMEBUFFER,Ge),Z.bindFramebuffer(be.DRAW_FRAMEBUFFER,Ve);for(let e=0;e<r;e++)w?be.framebufferTextureLayer(be.READ_FRAMEBUFFER,be.COLOR_ATTACHMENT0,d.__webglTexture,f,o+e):be.framebufferTexture2D(be.READ_FRAMEBUFFER,be.COLOR_ATTACHMENT0,be.TEXTURE_2D,d.__webglTexture,f),T?be.framebufferTextureLayer(be.DRAW_FRAMEBUFFER,be.COLOR_ATTACHMENT0,h.__webglTexture,p,u+e):be.framebufferTexture2D(be.DRAW_FRAMEBUFFER,be.COLOR_ATTACHMENT0,be.TEXTURE_2D,h.__webglTexture,p),0!==f?be.blitFramebuffer(s,a,n,i,l,c,n,i,be.COLOR_BUFFER_BIT,be.NEAREST):T?be.copyTexSubImage3D(y,p,l,c,u+e,s,a,n,i):be.copyTexSubImage2D(y,p,l,c,s,a,n,i);Z.bindFramebuffer(be.READ_FRAMEBUFFER,null),Z.bindFramebuffer(be.DRAW_FRAMEBUFFER,null)}else T?e.isDataTexture||e.isData3DTexture?be.texSubImage3D(y,p,l,c,u,n,i,r,g,v,m.data):t.isCompressedArrayTexture?be.compressedTexSubImage3D(y,p,l,c,u,n,i,r,g,m.data):be.texSubImage3D(y,p,l,c,u,n,i,r,g,v,m):e.isDataTexture?be.texSubImage2D(be.TEXTURE_2D,p,l,c,n,i,g,v,m.data):e.isCompressedTexture?be.compressedTexSubImage2D(be.TEXTURE_2D,p,l,c,m.width,m.height,g,m.data):be.texSubImage2D(be.TEXTURE_2D,p,l,c,n,i,g,v,m);be.pixelStorei(be.UNPACK_ROW_LENGTH,_),be.pixelStorei(be.UNPACK_IMAGE_HEIGHT,b),be.pixelStorei(be.UNPACK_SKIP_PIXELS,x),be.pixelStorei(be.UNPACK_SKIP_ROWS,S),be.pixelStorei(be.UNPACK_SKIP_IMAGES,E),0===p&&t.generateMipmaps&&be.generateMipmap(y),Z.unbindTexture()},this.initRenderTarget=function(e){void 0===ee.get(e).__webglFramebuffer&&te.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?te.setTextureCube(e,0):e.isData3DTexture?te.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?te.setTexture2DArray(e,0):te.setTexture2D(e,0),Z.unbindTexture()},this.resetState=function(){E=0,w=0,T=null,Z.reset(),ye.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return tO}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=zO._getDrawingBufferColorSpace(e),t.unpackColorSpace=zO._getUnpackColorSpace()}}var KX=n(71);function qX(e){let t;const n=new Set,i=(e,i)=>{const r="function"===typeof e?e(t):e;if(r!==t){const e=t;t=i?r:Object.assign({},t,r),n.forEach(n=>n(t,e))}},r=()=>t,s={setState:i,getState:r,subscribe:(e,i,s)=>i||s?function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is;console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let a=i(t);function o(){const n=i(t);if(!s(a,n)){const t=a;e(a=n,t)}}return n.add(o),()=>n.delete(o)}(e,i,s):(n.add(e),()=>n.delete(e)),destroy:()=>n.clear()};return t=e(i,r,s),s}const JX="undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?t.useEffect:t.useLayoutEffect;const QX=[];function ZX(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;if(e===t)return!0;if(!e||!t)return!1;const i=e.length;if(t.length!==i)return!1;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function $X(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};null===t&&(t=[e]);for(const a of QX)if(ZX(t,a.keys,a.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(a,"error"))throw a.error;if(Object.prototype.hasOwnProperty.call(a,"response"))return i.lifespan&&i.lifespan>0&&(a.timeout&&clearTimeout(a.timeout),a.timeout=setTimeout(a.remove,i.lifespan)),a.response;if(!n)throw a.promise}const r={keys:t,equal:i.equal,remove:()=>{const e=QX.indexOf(r);-1!==e&&QX.splice(e,1)},promise:(s=e,"object"===typeof s&&"function"===typeof s.then?e:e(...t)).then(e=>{r.response=e,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))}).catch(e=>r.error=e)};var s;if(QX.push(r),!n)throw r.promise}var eK=n(350),tK=n.n(eK),nK=n(611);const iK=["args","attach"],rK=["args","children"],sK=["args","children"],aK=["children","key","ref"],oK=["children","key","ref"],lK=["params"];const cK={};var uK,dK;const hK=e=>"colorSpace"in e||"outputColorSpace"in e,fK=()=>{var e;return null!=(e=cK.ColorManagement)?e:null},pK=e=>e&&e.isOrthographicCamera,mK="undefined"!==typeof window&&(null!=(uK=window.document)&&uK.createElement||"ReactNative"===(null==(dK=window.navigator)?void 0:dK.product))?t.useLayoutEffect:t.useEffect;function gK(e){const n=t.useRef(e);return mK(()=>{n.current=e},[e]),n}function vK(e){let{set:t}=e;return mK(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class yK extends t.Component{constructor(){super(...arguments),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}yK.getDerivedStateFromError=()=>({error:!0});const _K="__default",bK=new Map,xK=e=>e&&!!e.memoized&&!!e.changes;function SK(e){var t;const n="undefined"!==typeof window?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}const EK=e=>{var t;return null==(t=e.__r3f)?void 0:t.root.getState()};function wK(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const TK={obj:e=>e===Object(e)&&!TK.arr(e)&&"function"!==typeof e,fun:e=>"function"===typeof e,str:e=>"string"===typeof e,num:e=>"number"===typeof e,boo:e=>"boolean"===typeof e,und:e=>void 0===e,arr:e=>Array.isArray(e),equ(e,t){let{arrays:n="shallow",objects:i="reference",strict:r=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(typeof e!==typeof t||!!e!==!!t)return!1;if(TK.str(e)||TK.num(e)||TK.boo(e))return e===t;const s=TK.obj(e);if(s&&"reference"===i)return e===t;const a=TK.arr(e);if(a&&"reference"===n)return e===t;if((a||s)&&e===t)return!0;let o;for(o in e)if(!(o in t))return!1;if(s&&"shallow"===n&&"shallow"===i){for(o in r?t:e)if(!TK.equ(e[o],t[o],{strict:r,objects:"reference"}))return!1}else for(o in r?t:e)if(e[o]!==t[o])return!1;if(TK.und(o)){if(a&&0===e.length&&0===t.length)return!0;if(s&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function MK(e){const t={nodes:{},materials:{}};return e&&e.traverse(e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)}),t}function AK(e,t){return e.__r3f=Cr({type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null},t),e}function CK(e,t){let n=e;if(t.includes("-")){const i=t.split("-"),r=i.pop();return n=i.reduce((e,t)=>e[t],e),{target:n,key:r}}return{target:n,key:t}}const RK=/-\d+$/;function LK(e,t,n){if(TK.str(n)){if(RK.test(n)){const t=n.replace(RK,""),{target:i,key:r}=CK(e,t);Array.isArray(i[r])||(i[r]=[])}const{target:i,key:r}=CK(e,n);t.__r3f.previousAttach=i[r],i[r]=t}else t.__r3f.previousAttach=n(e,t)}function PK(e,t,n){var i,r;if(TK.str(n)){const{target:i,key:r}=CK(e,n),s=t.__r3f.previousAttach;void 0===s?delete i[r]:i[r]=s}else null==(i=t.__r3f)||null==i.previousAttach||i.previousAttach(e,t);null==(r=t.__r3f)||delete r.previousAttach}function IK(e,t){let{children:n,key:i,ref:r}=t,s=d(t,aK),a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{children:o,key:l,ref:c}=a,u=d(a,oK),h=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const f=e.__r3f,p=Object.entries(s),m=[];if(h){const e=Object.keys(u);for(let t=0;t<e.length;t++)s.hasOwnProperty(e[t])||p.unshift([e[t],_K+"remove"])}p.forEach(t=>{let[n,i]=t;var r;if(null!=(r=e.__r3f)&&r.primitive&&"object"===n)return;if(TK.equ(i,u[n]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(n))return m.push([n,i,!0,[]]);let a=[];n.includes("-")&&(a=n.split("-")),m.push([n,i,!1,a]);for(const e in s){const t=s[e];e.startsWith("".concat(n,"-"))&&m.push([e,t,!1,e.split("-")])}});const g=Cr({},s);return null!=f&&f.memoizedProps&&null!=f&&f.memoizedProps.args&&(g.args=f.memoizedProps.args),null!=f&&f.memoizedProps&&null!=f&&f.memoizedProps.attach&&(g.attach=f.memoizedProps.attach),{memoized:g,changes:m}}const DK="undefined"!==typeof process&&!1;function kK(e,t){var n;const i=e.__r3f,r=null==i?void 0:i.root,s=null==r||null==r.getState?void 0:r.getState(),{memoized:a,changes:o}=xK(t)?t:IK(e,t),l=null==i?void 0:i.eventCount;e.__r3f&&(e.__r3f.memoizedProps=a);for(let d=0;d<o.length;d++){let[t,n,r,a]=o[d];if(hK(e)){const e=3001,i="srgb",r="srgb-linear";"encoding"===t?(t="colorSpace",n=n===e?i:r):"outputEncoding"===t&&(t="outputColorSpace",n=n===e?i:r)}let l=e,h=l[t];if(a.length&&(h=a.reduce((e,t)=>e[t],e),!h||!h.set)){const[n,...i]=a.reverse();l=i.reverse().reduce((e,t)=>e[t],e),t=n}if(n===_K+"remove")if(l.constructor){let e=bK.get(l.constructor);e||(e=new l.constructor,bK.set(l.constructor,e)),n=e[t]}else n=0;if(r&&i)n?i.handlers[t]=n:delete i.handlers[t],i.eventCount=Object.keys(i.handlers).length;else if(h&&h.set&&(h.copy||h instanceof VN)){if(Array.isArray(n))h.fromArray?h.fromArray(n):h.set(...n);else if(h.copy&&n&&n.constructor&&(DK?h.constructor.name===n.constructor.name:h.constructor===n.constructor))h.copy(n);else if(void 0!==n){var c;const e=null==(c=h)?void 0:c.isColor;!e&&h.setScalar?h.setScalar(n):h instanceof VN&&n instanceof VN?h.mask=n.mask:h.set(n),!fK()&&s&&!s.linear&&e&&h.convertSRGBToLinear()}}else{var u;if(l[t]=n,null!=(u=l[t])&&u.isTexture&&l[t].format===lD&&l[t].type===XI&&s){const e=l[t];hK(e)&&hK(s.gl)?e.colorSpace=s.gl.outputColorSpace:e.encoding=s.gl.outputEncoding}}OK(e)}if(i&&i.parent&&e.raycast&&l!==i.eventCount){const t=wK(e).getState().internal,n=t.interaction.indexOf(e);n>-1&&t.interaction.splice(n,1),i.eventCount&&t.interaction.push(e)}return!(1===o.length&&"onUpdate"===o[0][0])&&o.length&&null!=(n=e.__r3f)&&n.parent&&NK(e),e}function OK(e){var t,n;const i=null==(t=e.__r3f)||null==(n=t.root)||null==n.getState?void 0:n.getState();i&&0===i.internal.frames&&i.invalidate()}function NK(e){null==e.onUpdate||e.onUpdate(e)}function FK(e,t){e.manual||(pK(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function BK(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function UK(e,t,n,i){const r=n.get(t);r&&(n.delete(t),0===n.size&&(e.delete(i),r.target.releasePointerCapture(i)))}function HK(e){function t(e){return e.filter(e=>["Move","Over","Enter","Out","Leave"].some(t=>{var n;return null==(n=e.__r3f)?void 0:n.handlers["onPointer"+t]}))}function n(t){const{internal:n}=e.getState();for(const e of n.hovered.values())if(!t.length||!t.find(t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId)){const i=e.eventObject.__r3f,r=null==i?void 0:i.handlers;if(n.hovered.delete(BK(e)),null!=i&&i.eventCount){const n=Cr(Cr({},e),{},{intersections:t});null==r.onPointerOut||r.onPointerOut(n),null==r.onPointerLeave||r.onPointerLeave(n)}}}function i(e,t){for(let n=0;n<t.length;n++){const i=t[n].__r3f;null==i||null==i.handlers.onPointerMissed||i.handlers.onPointerMissed(e)}}return{handlePointer:function(r){switch(r){case"onPointerLeave":case"onPointerCancel":return()=>n([]);case"onLostPointerCapture":return t=>{const{internal:i}=e.getState();"pointerId"in t&&i.capturedMap.has(t.pointerId)&&requestAnimationFrame(()=>{i.capturedMap.has(t.pointerId)&&(i.capturedMap.delete(t.pointerId),n([]))})}}return function(s){const{onPointerMissed:a,internal:o}=e.getState();o.lastEvent.current=s;const l="onPointerMove"===r,c="onClick"===r||"onContextMenu"===r||"onDoubleClick"===r,u=function(t,n){const i=e.getState(),r=new Set,s=[],a=n?n(i.internal.interaction):i.internal.interaction;for(let e=0;e<a.length;e++){const t=EK(a[e]);t&&(t.raycaster.camera=void 0)}i.previousRoot||null==i.events.compute||i.events.compute(t,i);let o=a.flatMap(function(e){const n=EK(e);return n&&n.events.enabled&&null!==n.raycaster.camera?(void 0===n.raycaster.camera&&(null==n.events.compute||n.events.compute(t,n,null==(i=n.previousRoot)?void 0:i.getState()),void 0===n.raycaster.camera&&(n.raycaster.camera=null)),n.raycaster.camera?n.raycaster.intersectObject(e,!0):[]):[];var i}).sort((e,t)=>{const n=EK(e.object),i=EK(t.object);return n&&i&&i.events.priority-n.events.priority||e.distance-t.distance}).filter(e=>{const t=BK(e);return!r.has(t)&&(r.add(t),!0)});i.events.filter&&(o=i.events.filter(o,i));for(const e of o){let t=e.object;for(;t;){var l;null!=(l=t.__r3f)&&l.eventCount&&s.push(Cr(Cr({},e),{},{eventObject:t})),t=t.parent}}if("pointerId"in t&&i.internal.capturedMap.has(t.pointerId))for(let e of i.internal.capturedMap.get(t.pointerId).values())r.has(BK(e.intersection))||s.push(e.intersection);return s}(s,l?t:void 0),d=c?function(t){const{internal:n}=e.getState(),i=t.offsetX-n.initialClick[0],r=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(i*i+r*r))}(s):0;"onPointerDown"===r&&(o.initialClick=[s.offsetX,s.offsetY],o.initialHits=u.map(e=>e.eventObject)),c&&!u.length&&d<=2&&(i(s,o.interaction),a&&a(s)),l&&n(u),function(t,i,r,s){const a=e.getState();if(t.length){const e={stopped:!1};for(const o of t){const l=EK(o.object)||a,{raycaster:c,pointer:u,camera:d,internal:h}=l,f=new DO(u.x,u.y,0).unproject(d),p=e=>{var t,n;return null!=(t=null==(n=h.capturedMap.get(e))?void 0:n.has(o.eventObject))&&t},m=e=>{const t={intersection:o,target:i.target};h.capturedMap.has(e)?h.capturedMap.get(e).set(o.eventObject,t):h.capturedMap.set(e,new Map([[o.eventObject,t]])),i.target.setPointerCapture(e)},g=e=>{const t=h.capturedMap.get(e);t&&UK(h.capturedMap,o.eventObject,t,e)};let v={};for(let e in i){let t=i[e];"function"!==typeof t&&(v[e]=t)}let y=Cr(Cr(Cr({},o),v),{},{pointer:u,intersections:t,stopped:e.stopped,delta:r,unprojectedPoint:f,ray:c.ray,camera:d,stopPropagation(){const r="pointerId"in i&&h.capturedMap.get(i.pointerId);(!r||r.has(o.eventObject))&&(y.stopped=e.stopped=!0,h.hovered.size&&Array.from(h.hovered.values()).find(e=>e.eventObject===o.eventObject))&&n([...t.slice(0,t.indexOf(o)),o])},target:{hasPointerCapture:p,setPointerCapture:m,releasePointerCapture:g},currentTarget:{hasPointerCapture:p,setPointerCapture:m,releasePointerCapture:g},nativeEvent:i});if(s(y),!0===e.stopped)break}}}(u,s,d,function(e){const t=e.eventObject,n=t.__r3f,a=null==n?void 0:n.handlers;if(null!=n&&n.eventCount)if(l){if(a.onPointerOver||a.onPointerEnter||a.onPointerOut||a.onPointerLeave){const t=BK(e),n=o.hovered.get(t);n?n.stopped&&e.stopPropagation():(o.hovered.set(t,e),null==a.onPointerOver||a.onPointerOver(e),null==a.onPointerEnter||a.onPointerEnter(e))}null==a.onPointerMove||a.onPointerMove(e)}else{const n=a[r];n?c&&!o.initialHits.includes(t)||(i(s,o.interaction.filter(e=>!o.initialHits.includes(e))),n(e)):c&&o.initialHits.includes(t)&&i(s,o.interaction.filter(e=>!o.initialHits.includes(e)))}})}}}}const zK=e=>!(null==e||!e.render),GK=t.createContext(null),VK=(e,n)=>{const i=function(e){const n="function"===typeof e?qX(e):e,i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.getState,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is;const[,r]=(0,t.useReducer)(e=>e+1,0),s=n.getState(),a=(0,t.useRef)(s),o=(0,t.useRef)(e),l=(0,t.useRef)(i),c=(0,t.useRef)(!1),u=(0,t.useRef)();let d;void 0===u.current&&(u.current=e(s));let h=!1;(a.current!==s||o.current!==e||l.current!==i||c.current)&&(d=e(s),h=!i(u.current,d)),JX(()=>{h&&(u.current=d),a.current=s,o.current=e,l.current=i,c.current=!1});const f=(0,t.useRef)(s);JX(()=>{const e=()=>{try{const e=n.getState(),t=o.current(e);l.current(u.current,t)||(a.current=e,u.current=t,r())}catch(e){c.current=!0,r()}},t=n.subscribe(e);return n.getState()!==f.current&&e(),t},[]);const p=h?d:u.current;return(0,t.useDebugValue)(p),p};return Object.assign(i,n),i[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const e=[i,n];return{next(){const t=e.length<=0;return{value:e.shift(),done:t}}}},i}((i,r)=>{const s=new DO,a=new DO,o=new DO;function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r().camera,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r().size;const{width:i,height:l,top:c,left:u}=n,d=i/l;t.isVector3?o.copy(t):o.set(...t);const h=e.getWorldPosition(s).distanceTo(o);if(pK(e))return{width:i/e.zoom,height:l/e.zoom,top:c,left:u,factor:1,distance:h,aspect:d};{const t=e.fov*Math.PI/180,n=2*Math.tan(t/2)*h,r=n*(i/l);return{width:r,height:n,top:c,left:u,factor:i/r,distance:h,aspect:d}}}let c;const u=e=>i(t=>({performance:Cr(Cr({},t.performance),{},{current:e})})),d=new PO,h={set:i,get:r,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e(r(),t)},advance:(e,t)=>n(e,t,r()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new OV,pointer:d,mouse:d,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const e=r();c&&clearTimeout(c),e.performance.current!==e.performance.min&&u(e.performance.min),c=setTimeout(()=>u(r().performance.max),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:e=>i(t=>Cr(Cr({},t),{},{events:Cr(Cr({},t.events),e)})),setSize:(e,t,n,s,o)=>{const c=r().camera,u={width:e,height:t,top:s||0,left:o||0,updateStyle:n};i(e=>({size:u,viewport:Cr(Cr({},e.viewport),l(c,a,u))}))},setDpr:e=>i(t=>{const n=SK(e);return{viewport:Cr(Cr({},t.viewport),{},{dpr:n,initialDpr:t.viewport.initialDpr||n})}}),setFrameloop:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"always";const t=r().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),i(()=>({frameloop:e}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:t.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(e,t,n)=>{const i=r().internal;return i.priority=i.priority+(t>0?1:0),i.subscribers.push({ref:e,priority:t,store:n}),i.subscribers=i.subscribers.sort((e,t)=>e.priority-t.priority),()=>{const n=r().internal;null!=n&&n.subscribers&&(n.priority=n.priority-(t>0?1:0),n.subscribers=n.subscribers.filter(t=>t.ref!==e))}}}};return h}),r=i.getState();let s=r.size,a=r.viewport.dpr,o=r.camera;return i.subscribe(()=>{const{camera:e,size:t,viewport:n,gl:r,set:l}=i.getState();if(t.width!==s.width||t.height!==s.height||n.dpr!==a){var c;s=t,a=n.dpr,FK(e,t),r.setPixelRatio(n.dpr);const i=null!=(c=t.updateStyle)?c:"undefined"!==typeof HTMLCanvasElement&&r.domElement instanceof HTMLCanvasElement;r.setSize(t.width,t.height,i)}e!==o&&(o=e,l(t=>({viewport:Cr(Cr({},t.viewport),t.viewport.getCurrentViewport(e))})))}),i.subscribe(t=>e(t)),i};let WK,jK=new Set,YK=new Set,XK=new Set;function KK(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function qK(e,t){switch(e){case"before":return KK(jK,t);case"after":return KK(YK,t);case"tail":return KK(XK,t)}}let JK,QK;function ZK(e,t,n){let i=t.clock.getDelta();for("never"===t.frameloop&&"number"===typeof e&&(i=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),JK=t.internal.subscribers,WK=0;WK<JK.length;WK++)QK=JK[WK],QK.ref.current(QK.store.getState(),i,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function $K(){const e=t.useContext(GK);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function eq(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e,t=arguments.length>1?arguments[1]:void 0;return $K()(e,t)}const tq=new WeakMap;function nq(e,t){return function(n){let i=tq.get(n);i||(i=new n,tq.set(n,i)),e&&e(i);for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return Promise.all(s.map(e=>new Promise((n,r)=>i.load(e,e=>{e.scene&&Object.assign(e,MK(e.scene)),n(e)},t,t=>r(new Error("Could not load ".concat(e,": ").concat(null==t?void 0:t.message)))))))}}function iq(e,t,n,i){const r=Array.isArray(t)?t:[t],s=((e,t,n)=>$X(e,t,!1,n))(nq(n,i),[e,...r],{equal:TK.equ});return Array.isArray(t)?s:s[0]}iq.preload=function(e,t,n){const i=Array.isArray(t)?t:[t];return((e,t,n)=>{$X(e,t,!0,n)})(nq(n),[e,...i])},iq.clear=function(e,t){return(e=>{if(void 0===e||0===e.length)QX.splice(0,QX.length);else{const t=QX.find(t=>ZX(e,t.keys,t.equal));t&&t.remove()}})([e,...Array.isArray(t)?t:[t]])};const rq=new Map,{invalidate:sq,advance:aq}=function(e){let t,n,i,r=!1,s=!1;function a(o){n=requestAnimationFrame(a),r=!0,t=0,qK("before",o),s=!0;for(const n of e.values()){var l;i=n.store.getState(),!i.internal.active||!("always"===i.frameloop||i.internal.frames>0)||null!=(l=i.gl.xr)&&l.isPresenting||(t+=ZK(o,i))}if(s=!1,qK("after",o),0===t)return qK("tail",o),r=!1,cancelAnimationFrame(n)}return{loop:a,invalidate:function t(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;var o;if(!n)return e.forEach(e=>t(e.store.getState(),i));null!=(o=n.gl.xr)&&o.isPresenting||!n.internal.active||"never"===n.frameloop||(n.internal.frames=i>1?Math.min(60,n.internal.frames+i):s?2:1,r||(r=!0,requestAnimationFrame(a)))},advance:function(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(n&&qK("before",t),i)ZK(t,i,r);else for(const s of e.values())ZK(t,s.store.getState());n&&qK("after",t)}}}(rq),{reconciler:oq,applyProps:lq}=function(e,t){function n(e,t,n){let i,{args:r=[],attach:s}=t,a=d(t,iK),o="".concat(e[0].toUpperCase()).concat(e.slice(1));if("primitive"===e){if(void 0===a.object)throw new Error("R3F: Primitives without 'object' are invalid!");i=AK(a.object,{type:e,root:n,attach:s,primitive:!0})}else{const t=cK[o];if(!t)throw new Error("R3F: ".concat(o," is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively"));if(!Array.isArray(r))throw new Error("R3F: The args prop must be an array!");i=AK(new t(...r),{type:e,root:n,attach:s,memoizedProps:{args:r}})}return void 0===i.__r3f.attach&&(i.isBufferGeometry?i.__r3f.attach="geometry":i.isMaterial&&(i.__r3f.attach="material")),"inject"!==o&&kK(i,a),i}function i(e,t){let n=!1;var i,r;t&&(null!=(i=t.__r3f)&&i.attach?LK(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.add(t),n=!0),n||null==(r=e.__r3f)||r.objects.push(t),t.__r3f||AK(t,{}),t.__r3f.parent=e,NK(t),OK(t))}function r(e,t,n){let i=!1;if(t){var r,s;if(null!=(r=t.__r3f)&&r.attach)LK(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){t.parent=e,t.dispatchEvent({type:"added"}),e.dispatchEvent({type:"childadded",child:t});const r=e.children.filter(e=>e!==t),s=r.indexOf(n);e.children=[...r.slice(0,s),t,...r.slice(s)],i=!0}i||null==(s=e.__r3f)||s.objects.push(t),t.__r3f||AK(t,{}),t.__r3f.parent=e,NK(t),OK(t)}}function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&[...e].forEach(e=>a(t,e,n))}function a(e,t,n){if(t){var i,r,a;if(t.__r3f&&(t.__r3f.parent=null),null!=(i=e.__r3f)&&i.objects&&(e.__r3f.objects=e.__r3f.objects.filter(e=>e!==t)),null!=(r=t.__r3f)&&r.attach)PK(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){var o;e.remove(t),null!=(o=t.__r3f)&&o.root&&function(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(e=>e!==t),n.initialHits=n.initialHits.filter(e=>e!==t),n.hovered.forEach((e,i)=>{e.eventObject!==t&&e.object!==t||n.hovered.delete(i)}),n.capturedMap.forEach((e,i)=>{UK(n.capturedMap,t,e,i)})}(wK(t),t)}const c=null==(a=t.__r3f)?void 0:a.primitive,u=!c&&(void 0===n?null!==t.dispose:n);var l;if(!c)s(null==(l=t.__r3f)?void 0:l.objects,t,u),s(t.children,t,u);if(delete t.__r3f,u&&t.dispose&&"Scene"!==t.type){const e=()=>{try{t.dispose()}catch(kne){}};"undefined"===typeof IS_REACT_ACT_ENVIRONMENT?(0,nK.unstable_scheduleCallback)(nK.unstable_IdlePriority,e):e()}OK(e)}}const o=()=>{},l=tK()({createInstance:n,removeChild:a,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(e,t)=>{if(!t)return;const n=e.getState().scene;n.__r3f&&(n.__r3f.root=e,i(n,t))},removeChildFromContainer:(e,t)=>{t&&a(e.getState().scene,t)},insertInContainerBefore:(e,t,n)=>{if(!t||!n)return;const i=e.getState().scene;i.__r3f&&r(i,t,n)},getRootHostContext:()=>null,getChildHostContext:e=>e,finalizeInitialChildren(e){var t;const n=null!=(t=null==e?void 0:e.__r3f)?t:{};return Boolean(n.handlers)},prepareUpdate(e,t,n,i){var r;if((null!=(r=null==e?void 0:e.__r3f)?r:{}).primitive&&i.object&&i.object!==e)return[!0];{const{args:t=[],children:r}=i,s=d(i,rK),{args:a=[],children:o}=n,l=d(n,sK);if(!Array.isArray(t))throw new Error("R3F: the args prop must be an array!");if(t.some((e,t)=>e!==a[t]))return[!0];const c=IK(e,s,l,!0);return c.changes.length?[!1,c]:null}},commitUpdate(e,t,r,s,o,l){let[c,u]=t;c?function(e,t,r,s){var o;const l=null==(o=e.__r3f)?void 0:o.parent;if(!l)return;const c=n(t,r,e.__r3f.root);if(e.children){for(const t of e.children)t.__r3f&&i(c,t);e.children=e.children.filter(e=>!e.__r3f)}e.__r3f.objects.forEach(e=>i(c,e)),e.__r3f.objects=[],e.__r3f.autoRemovedBeforeAppend||a(l,e),c.parent&&(c.__r3f.autoRemovedBeforeAppend=!0),i(l,c),c.raycast&&c.__r3f.eventCount&&wK(c).getState().internal.interaction.push(c);[s,s.alternate].forEach(e=>{null!==e&&(e.stateNode=c,e.ref&&("function"===typeof e.ref?e.ref(c):e.ref.current=c))})}(e,r,o,l):kK(e,u)},commitMount(e,t,n,i){var r;const s=null!=(r=e.__r3f)?r:{};e.raycast&&s.handlers&&s.eventCount&&wK(e).getState().internal.interaction.push(e)},getPublicInstance:e=>e,prepareForCommit:()=>null,preparePortalMount:e=>AK(e.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(e){var t;const{attach:n,parent:i}=null!=(t=e.__r3f)?t:{};n&&i&&PK(i,e,n),e.isObject3D&&(e.visible=!1),OK(e)},unhideInstance(e,t){var n;const{attach:i,parent:r}=null!=(n=e.__r3f)?n:{};i&&r&&LK(r,e,i),(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0),OK(e)},createTextInstance:o,hideTextInstance:o,unhideTextInstance:o,getCurrentEventPriority:()=>t?t():KX.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:"undefined"!==typeof performance&&TK.fun(performance.now)?performance.now:TK.fun(Date.now)?Date.now:()=>0,scheduleTimeout:TK.fun(setTimeout)?setTimeout:void 0,cancelTimeout:TK.fun(clearTimeout)?clearTimeout:void 0});return{reconciler:l,applyProps:kK}}(0,function(){var e;const t="undefined"!==typeof self&&self||"undefined"!==typeof window&&window;if(!t)return KX.DefaultEventPriority;switch(null==(e=t.event)?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return KX.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return KX.ContinuousEventPriority;default:return KX.DefaultEventPriority}}),cq={objects:"shallow",strict:!1},uq=(e,t)=>{const n="function"===typeof e?e(t):e;return zK(n)?n:new XX(Cr({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0},e))};function dq(e){const t=rq.get(e),n=null==t?void 0:t.fiber,i=null==t?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const r="function"===typeof reportError?reportError:console.error,s=i||VK(sq,aq),a=n||oq.createContainer(s,KX.ConcurrentRoot,null,!1,null,"",r,null);let o;t||rq.set(e,{fiber:a,store:s});let l,c=!1;return{configure(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{gl:n,size:i,scene:r,events:a,onCreated:u,shadows:h=!1,linear:f=!1,flat:p=!1,legacy:m=!1,orthographic:g=!1,frameloop:v="always",dpr:y=[1,2],performance:_,raycaster:b,camera:x,onPointerMissed:S}=t,E=s.getState(),w=E.gl;E.gl||E.set({gl:w=uq(n,e)});let T=E.raycaster;T||E.set({raycaster:T=new pW});const M=b||{},{params:A}=M,C=d(M,lK);if(TK.equ(C,T,cq)||lq(T,Cr({},C)),TK.equ(A,T.params,cq)||lq(T,{params:Cr(Cr({},T.params),A)}),!E.camera||E.camera===l&&!TK.equ(l,x,cq)){l=x;const e=x instanceof bB,t=e?x:g?new uV(0,0,0,0,.1,1e3):new wB(75,0,.1,1e3);e||(t.position.z=5,x&&(lq(t,x),("aspect"in x||"left"in x||"right"in x||"bottom"in x||"top"in x)&&(t.manual=!0,t.updateProjectionMatrix())),E.camera||null!=x&&x.rotation||t.lookAt(0,0,0)),E.set({camera:t}),T.camera=t}if(!E.scene){let e;null!=r&&r.isScene?e=r:(e=new kB,r&&lq(e,r)),E.set({scene:AK(e)})}if(!E.xr){var R;const e=(e,t)=>{const n=s.getState();"never"!==n.frameloop&&aq(e,!0,n,t)},t=()=>{const t=s.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||sq(t)},n={connect(){const e=s.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){const e=s.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};"function"===typeof(null==(R=w.xr)?void 0:R.addEventListener)&&n.connect(),E.set({xr:n})}if(w.shadowMap){const e=w.shadowMap.enabled,t=w.shadowMap.type;if(w.shadowMap.enabled=!!h,TK.boo(h))w.shadowMap.type=LP;else if(TK.str(h)){var L;const e={basic:CP,percentage:RP,soft:LP,variance:PP};w.shadowMap.type=null!=(L=e[h])?L:LP}else TK.obj(h)&&Object.assign(w.shadowMap,h);e===w.shadowMap.enabled&&t===w.shadowMap.type||(w.shadowMap.needsUpdate=!0)}const P=fK();if(P&&("enabled"in P?P.enabled=!m:"legacyMode"in P&&(P.legacyMode=m)),!c){lq(w,{outputEncoding:f?3e3:3001,toneMapping:p?yI:SI})}E.legacy!==m&&E.set(()=>({legacy:m})),E.linear!==f&&E.set(()=>({linear:f})),E.flat!==p&&E.set(()=>({flat:p})),!n||TK.fun(n)||zK(n)||TK.equ(n,w,cq)||lq(w,n),a&&!E.events.handlers&&E.set({events:a(s)});const I=function(e,t){const n="undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement;if(t){const{width:e,height:i,top:r,left:s,updateStyle:a=n}=t;return{width:e,height:i,top:r,left:s,updateStyle:a}}if("undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:t,height:i,top:r,left:s}=e.parentElement.getBoundingClientRect();return{width:t,height:i,top:r,left:s,updateStyle:n}}return"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0,updateStyle:n}:{width:0,height:0,top:0,left:0}}(e,i);return TK.equ(I,E.size,cq)||E.setSize(I.width,I.height,I.updateStyle,I.top,I.left),y&&E.viewport.dpr!==SK(y)&&E.setDpr(y),E.frameloop!==v&&E.setFrameloop(v),E.onPointerMissed||E.set({onPointerMissed:S}),_&&!TK.equ(_,E.performance,cq)&&E.set(e=>({performance:Cr(Cr({},e.performance),_)})),o=u,c=!0,this},render(t){return c||this.configure(),oq.updateContainer((0,p.jsx)(hq,{store:s,children:t,onCreated:o,rootElement:e}),a,null,()=>{}),s},unmount(){fq(e)}}}function hq(e){let{store:t,children:n,onCreated:i,rootElement:r}=e;return mK(()=>{const e=t.getState();e.set(e=>({internal:Cr(Cr({},e.internal),{},{active:!0})})),i&&i(e),t.getState().events.connected||null==e.events.connect||e.events.connect(r)},[]),(0,p.jsx)(GK.Provider,{value:t,children:n})}function fq(e,t){const n=rq.get(e),i=null==n?void 0:n.fiber;if(i){const r=null==n?void 0:n.store.getState();r&&(r.internal.active=!1),oq.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var n,i,s,a;null==r.events.disconnect||r.events.disconnect(),null==(n=r.gl)||null==(i=n.renderLists)||null==i.dispose||i.dispose(),null==(s=r.gl)||null==s.forceContextLoss||s.forceContextLoss(),null!=(a=r.gl)&&a.xr&&r.xr.disconnect(),function(e){e.dispose&&"Scene"!==e.type&&e.dispose();for(const t in e)null==t.dispose||t.dispose(),delete e[t]}(r),rq.delete(e),t&&t(e)}catch(kne){}},500)})}}oq.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:t.version});t.unstable_act;const pq={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function mq(e){const{handlePointer:t}=HK(e);return{priority:1,enabled:!0,compute(e,t,n){t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(pq).reduce((e,n)=>Cr(Cr({},e),{},{[n]:t(n)}),{}),update:()=>{var t;const{events:n,internal:i}=e.getState();null!=(t=i.lastEvent)&&t.current&&n.handlers&&n.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var n;const{set:i,events:r}=e.getState();null==r.disconnect||r.disconnect(),i(e=>({events:Cr(Cr({},e.events),{},{connected:t})})),Object.entries(null!=(n=r.handlers)?n:[]).forEach(e=>{let[n,i]=e;const[r,s]=pq[n];t.addEventListener(r,i,{passive:s})})},disconnect:()=>{const{set:t,events:n}=e.getState();var i;n.connected&&(Object.entries(null!=(i=n.handlers)?i:[]).forEach(e=>{let[t,i]=e;if(n&&n.connected instanceof HTMLElement){const[e]=pq[t];n.connected.removeEventListener(e,i)}}),t(e=>({events:Cr(Cr({},e.events),{},{connected:void 0})})))}}}function gq(e,t){let n;return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];window.clearTimeout(n),n=window.setTimeout(()=>e(...r),t)}}function vq(){let{debounce:e,scroll:n,polyfill:i,offsetSize:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{debounce:0,scroll:!1,offsetSize:!1};const s=i||("undefined"==typeof window?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[a,o]=(0,t.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=(0,t.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a,orientationHandler:null}),c=e?"number"==typeof e?e:e.scroll:null,u=e?"number"==typeof e?e:e.resize:null,d=(0,t.useRef)(!1);(0,t.useEffect)(()=>(d.current=!0,()=>{d.current=!1}));const[h,f,p]=(0,t.useMemo)(()=>{const e=()=>{if(!l.current.element)return;const{left:e,top:t,width:n,height:i,bottom:s,right:a,x:c,y:u}=l.current.element.getBoundingClientRect(),h={left:e,top:t,width:n,height:i,bottom:s,right:a,x:c,y:u};l.current.element instanceof HTMLElement&&r&&(h.height=l.current.element.offsetHeight,h.width=l.current.element.offsetWidth),Object.freeze(h),d.current&&!bq(l.current.lastBounds,h)&&o(l.current.lastBounds=h)};return[e,u?gq(e,u):e,c?gq(e,c):e]},[o,r,c,u]);function m(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(e=>e.removeEventListener("scroll",p,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null),l.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",l.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",l.current.orientationHandler))}function g(){l.current.element&&(l.current.resizeObserver=new s(p),l.current.resizeObserver.observe(l.current.element),n&&l.current.scrollContainers&&l.current.scrollContainers.forEach(e=>e.addEventListener("scroll",p,{capture:!0,passive:!0})),l.current.orientationHandler=()=>{p()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",l.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",l.current.orientationHandler))}return function(e,n){(0,t.useEffect)(()=>{if(n){const t=e;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}},[e,n])}(p,!!n),function(e){(0,t.useEffect)(()=>{const t=e;return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[e])}(f),(0,t.useEffect)(()=>{m(),g()},[n,p,f]),(0,t.useEffect)(()=>m,[]),[e=>{!e||e===l.current.element||(m(),l.current.element=e,l.current.scrollContainers=yq(e),g())},a,h]}function yq(e){const t=[];if(!e||e===document.body)return t;const{overflow:n,overflowX:i,overflowY:r}=window.getComputedStyle(e);return[n,i,r].some(e=>"auto"===e||"scroll"===e)&&t.push(e),[...t,...yq(e.parentElement)]}const _q=["x","y","top","bottom","left","right","width","height"],bq=(e,t)=>_q.every(n=>e[n]===t[n]);var xq,Sq,Eq=Object.defineProperty,wq=Object.defineProperties,Tq=Object.getOwnPropertyDescriptors,Mq=Object.getOwnPropertySymbols,Aq=Object.prototype.hasOwnProperty,Cq=Object.prototype.propertyIsEnumerable,Rq=(e,t,n)=>t in e?Eq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Lq=(e,t)=>{for(var n in t||(t={}))Aq.call(t,n)&&Rq(e,n,t[n]);if(Mq)for(var n of Mq(t))Cq.call(t,n)&&Rq(e,n,t[n]);return e};"undefined"===typeof window||!(null==(xq=window.document)?void 0:xq.createElement)&&"ReactNative"!==(null==(Sq=window.navigator)?void 0:Sq.product)?t.useEffect:t.useLayoutEffect;function Pq(e,t,n){if(!e)return;if(!0===n(e))return e;let i=t?e.return:e.child;for(;i;){const e=Pq(i,t,n);if(e)return e;i=t?null:i.sibling}}function Iq(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch(t){return e}}const Dq=console.error;console.error=function(){const e=[...arguments].join("");if(!(null==e?void 0:e.startsWith("Warning:"))||!e.includes("useContext"))return Dq.apply(this,arguments);console.error=Dq};const kq=Iq(t.createContext(null));class Oq extends t.Component{render(){return t.createElement(kq.Provider,{value:this._reactInternals},this.props.children)}}function Nq(){const e=t.useContext(kq);if(null===e)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const n=t.useId();return t.useMemo(()=>{for(const t of[e,null==e?void 0:e.alternate]){if(!t)continue;const e=Pq(t,!1,e=>{let t=e.memoizedState;for(;t;){if(t.memoizedState===n)return!0;t=t.next}});if(e)return e}},[e,n])}function Fq(){const e=function(){const e=Nq(),[n]=t.useState(()=>new Map);n.clear();let i=e;for(;i;){if(i.type&&"object"===typeof i.type){const e=void 0===i.type._context&&i.type.Provider===i.type?i.type:i.type._context;e&&e!==kq&&!n.has(e)&&n.set(e,t.useContext(Iq(e)))}i=i.return}return n}();return t.useMemo(()=>Array.from(e.keys()).reduce((n,i)=>r=>{return t.createElement(n,null,t.createElement(i.Provider,(s=Lq({},r),a={value:e.get(i)},wq(s,Tq(a)))));var s,a},e=>t.createElement(Oq,Lq({},e))),[e])}const Bq=["children","fallback","resize","style","gl","events","eventSource","eventPrefix","shadows","linear","flat","legacy","orthographic","frameloop","dpr","performance","raycaster","camera","scene","onPointerMissed","onCreated"],Uq=t.forwardRef(function(n,i){let{children:r,fallback:s,resize:a,style:o,gl:l,events:c=mq,eventSource:u,eventPrefix:h,shadows:f,linear:m,flat:g,legacy:v,orthographic:y,frameloop:_,dpr:b,performance:x,raycaster:S,camera:E,scene:w,onPointerMissed:T,onCreated:M}=n,A=d(n,Bq);t.useMemo(()=>{return t=e,void Object.assign(cK,t);var t},[]);const C=Fq(),[R,L]=vq(Cr({scroll:!0,debounce:{scroll:50,resize:0}},a)),P=t.useRef(null),I=t.useRef(null);t.useImperativeHandle(i,()=>P.current);const D=gK(T),[k,O]=t.useState(!1),[N,F]=t.useState(!1);if(k)throw k;if(N)throw N;const B=t.useRef(null);mK(()=>{const e=P.current;L.width>0&&L.height>0&&e&&(B.current||(B.current=dq(e)),B.current.configure({gl:l,events:c,shadows:f,linear:m,flat:g,legacy:v,orthographic:y,frameloop:_,dpr:b,performance:x,raycaster:S,camera:E,scene:w,size:L,onPointerMissed:function(){return null==D.current?void 0:D.current(...arguments)},onCreated:e=>{var t;null==e.events.connect||e.events.connect(u?(t=u)&&t.hasOwnProperty("current")?u.current:u:I.current),h&&e.setEvents({compute:(e,t)=>{const n=e[h+"X"],i=e[h+"Y"];t.pointer.set(n/t.size.width*2-1,-i/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==M||M(e)}}),B.current.render((0,p.jsx)(C,{children:(0,p.jsx)(yK,{set:F,children:(0,p.jsx)(t.Suspense,{fallback:(0,p.jsx)(vK,{set:O}),children:null!=r?r:null})})})))}),t.useEffect(()=>{const e=P.current;if(e)return()=>fq(e)},[]);const U=u?"none":"auto";return(0,p.jsx)("div",Cr(Cr({ref:I,style:Cr({position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:U},o)},A),{},{children:(0,p.jsx)("div",{ref:R,style:{width:"100%",height:"100%"},children:(0,p.jsx)("canvas",{ref:P,style:{display:"block"},children:s})})}))}),Hq=t.forwardRef(function(e,t){return(0,p.jsx)(Oq,{children:(0,p.jsx)(Uq,Cr(Cr({},e),{},{ref:t}))})});function zq(){return zq=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},zq.apply(null,arguments)}var Gq=Object.defineProperty,Vq=(e,t,n)=>(((e,t,n)=>{t in e?Gq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!==typeof t?t+"":t,n),n);class Wq{constructor(){Vq(this,"_listeners")}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,i=n.length;t<i;t++)n[t].call(this,e);e.target=null}}}var jq=Object.defineProperty,Yq=(e,t,n)=>(((e,t,n)=>{t in e?jq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!==typeof t?t+"":t,n),n);const Xq=new PN,Kq=new LU,qq=Math.cos(Math.PI/180*70),Jq=(e,t)=>(e%t+t)%t;class Qq extends Wq{constructor(e,t){super(),Yq(this,"object"),Yq(this,"domElement"),Yq(this,"enabled",!0),Yq(this,"target",new DO),Yq(this,"minDistance",0),Yq(this,"maxDistance",1/0),Yq(this,"minZoom",0),Yq(this,"maxZoom",1/0),Yq(this,"minPolarAngle",0),Yq(this,"maxPolarAngle",Math.PI),Yq(this,"minAzimuthAngle",-1/0),Yq(this,"maxAzimuthAngle",1/0),Yq(this,"enableDamping",!1),Yq(this,"dampingFactor",.05),Yq(this,"enableZoom",!0),Yq(this,"zoomSpeed",1),Yq(this,"enableRotate",!0),Yq(this,"rotateSpeed",1),Yq(this,"enablePan",!0),Yq(this,"panSpeed",1),Yq(this,"screenSpacePanning",!0),Yq(this,"keyPanSpeed",7),Yq(this,"zoomToCursor",!1),Yq(this,"autoRotate",!1),Yq(this,"autoRotateSpeed",2),Yq(this,"reverseOrbit",!1),Yq(this,"reverseHorizontalOrbit",!1),Yq(this,"reverseVerticalOrbit",!1),Yq(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Yq(this,"mouseButtons",{LEFT:SP.ROTATE,MIDDLE:SP.DOLLY,RIGHT:SP.PAN}),Yq(this,"touches",{ONE:EP.ROTATE,TWO:EP.DOLLY_PAN}),Yq(this,"target0"),Yq(this,"position0"),Yq(this,"zoom0"),Yq(this,"_domElementKeyEvents",null),Yq(this,"getPolarAngle"),Yq(this,"getAzimuthalAngle"),Yq(this,"setPolarAngle"),Yq(this,"setAzimuthalAngle"),Yq(this,"getDistance"),Yq(this,"getZoomScale"),Yq(this,"listenToKeyEvents"),Yq(this,"stopListenToKeyEvents"),Yq(this,"saveState"),Yq(this,"reset"),Yq(this,"update"),Yq(this,"connect"),Yq(this,"dispose"),Yq(this,"dollyIn"),Yq(this,"dollyOut"),Yq(this,"getScale"),Yq(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>c.phi,this.getAzimuthalAngle=()=>c.theta,this.setPolarAngle=e=>{let t=Jq(e,2*Math.PI),i=c.phi;i<0&&(i+=2*Math.PI),t<0&&(t+=2*Math.PI);let r=Math.abs(t-i);2*Math.PI-r<r&&(t<i?t+=2*Math.PI:i+=2*Math.PI),u.phi=t-i,n.update()},this.setAzimuthalAngle=e=>{let t=Jq(e,2*Math.PI),i=c.theta;i<0&&(i+=2*Math.PI),t<0&&(t+=2*Math.PI);let r=Math.abs(t-i);2*Math.PI-r<r&&(t<i?t+=2*Math.PI:i+=2*Math.PI),u.theta=t-i,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",J),this._domElementKeyEvents=e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",J),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(i),n.update(),o=a.NONE},this.update=(()=>{const t=new DO,r=new DO(0,1,0),s=(new IO).setFromUnitVectors(e.up,r),f=s.clone().invert(),p=new DO,m=new IO,g=2*Math.PI;return function(){const v=n.object.position;s.setFromUnitVectors(e.up,r),f.copy(s).invert(),t.copy(v).sub(n.target),t.applyQuaternion(s),c.setFromVector3(t),n.autoRotate&&o===a.NONE&&C(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(c.theta+=u.theta*n.dampingFactor,c.phi+=u.phi*n.dampingFactor):(c.theta+=u.theta,c.phi+=u.phi);let y=n.minAzimuthAngle,_=n.maxAzimuthAngle;isFinite(y)&&isFinite(_)&&(y<-Math.PI?y+=g:y>Math.PI&&(y-=g),_<-Math.PI?_+=g:_>Math.PI&&(_-=g),c.theta=y<=_?Math.max(y,Math.min(_,c.theta)):c.theta>(y+_)/2?Math.max(y,c.theta):Math.min(_,c.theta)),c.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,c.phi)),c.makeSafe(),!0===n.enableDamping?n.target.addScaledVector(h,n.dampingFactor):n.target.add(h),n.zoomToCursor&&w||n.object.isOrthographicCamera?c.radius=F(c.radius):c.radius=F(c.radius*d),t.setFromSpherical(c),t.applyQuaternion(f),v.copy(n.target).add(t),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),!0===n.enableDamping?(u.theta*=1-n.dampingFactor,u.phi*=1-n.dampingFactor,h.multiplyScalar(1-n.dampingFactor)):(u.set(0,0,0),h.set(0,0,0));let b=!1;if(n.zoomToCursor&&w){let i=null;if(n.object instanceof wB&&n.object.isPerspectiveCamera){const e=t.length();i=F(e*d);const r=e-i;n.object.position.addScaledVector(S,r),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const e=new DO(E.x,E.y,0);e.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/d)),n.object.updateProjectionMatrix(),b=!0;const r=new DO(E.x,E.y,0);r.unproject(n.object),n.object.position.sub(r).add(e),n.object.updateMatrixWorld(),i=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;null!==i&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(i).add(n.object.position):(Xq.origin.copy(n.object.position),Xq.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Xq.direction))<qq?e.lookAt(n.target):(Kq.setFromNormalAndCoplanarPoint(n.object.up,n.target),Xq.intersectPlane(Kq,n.target))))}else n.object instanceof uV&&n.object.isOrthographicCamera&&(b=1!==d,b&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/d)),n.object.updateProjectionMatrix()));return d=1,w=!1,!!(b||p.distanceToSquared(n.object.position)>l||8*(1-m.dot(n.object.quaternion))>l)&&(n.dispatchEvent(i),p.copy(n.object.position),m.copy(n.object.quaternion),b=!1,!0)}})(),this.connect=e=>{n.domElement=e,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Q),n.domElement.addEventListener("pointerdown",Y),n.domElement.addEventListener("pointercancel",K),n.domElement.addEventListener("wheel",q)},this.dispose=()=>{var e,t,i,r,s,a;n.domElement&&(n.domElement.style.touchAction="auto"),null==(e=n.domElement)||e.removeEventListener("contextmenu",Q),null==(t=n.domElement)||t.removeEventListener("pointerdown",Y),null==(i=n.domElement)||i.removeEventListener("pointercancel",K),null==(r=n.domElement)||r.removeEventListener("wheel",q),null==(s=n.domElement)||s.ownerDocument.removeEventListener("pointermove",X),null==(a=n.domElement)||a.ownerDocument.removeEventListener("pointerup",K),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",J)};const n=this,i={type:"change"},r={type:"start"},s={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=a.NONE;const l=1e-6,c=new _W,u=new _W;let d=1;const h=new DO,f=new PO,p=new PO,m=new PO,g=new PO,v=new PO,y=new PO,_=new PO,b=new PO,x=new PO,S=new DO,E=new PO;let w=!1;const T=[],M={};function A(){return Math.pow(.95,n.zoomSpeed)}function C(e){n.reverseOrbit||n.reverseHorizontalOrbit?u.theta+=e:u.theta-=e}function R(e){n.reverseOrbit||n.reverseVerticalOrbit?u.phi+=e:u.phi-=e}const L=(()=>{const e=new DO;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),h.add(e)}})(),P=(()=>{const e=new DO;return function(t,i){!0===n.screenSpacePanning?e.setFromMatrixColumn(i,1):(e.setFromMatrixColumn(i,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),h.add(e)}})(),I=(()=>{const e=new DO;return function(t,i){const r=n.domElement;if(r&&n.object instanceof wB&&n.object.isPerspectiveCamera){const s=n.object.position;e.copy(s).sub(n.target);let a=e.length();a*=Math.tan(n.object.fov/2*Math.PI/180),L(2*t*a/r.clientHeight,n.object.matrix),P(2*i*a/r.clientHeight,n.object.matrix)}else r&&n.object instanceof uV&&n.object.isOrthographicCamera?(L(t*(n.object.right-n.object.left)/n.object.zoom/r.clientWidth,n.object.matrix),P(i*(n.object.top-n.object.bottom)/n.object.zoom/r.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function D(e){n.object instanceof wB&&n.object.isPerspectiveCamera||n.object instanceof uV&&n.object.isOrthographicCamera?d=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function k(e){D(d/e)}function O(e){D(d*e)}function N(e){if(!n.zoomToCursor||!n.domElement)return;w=!0;const t=n.domElement.getBoundingClientRect(),i=e.clientX-t.left,r=e.clientY-t.top,s=t.width,a=t.height;E.x=i/s*2-1,E.y=-r/a*2+1,S.set(E.x,E.y,1).unproject(n.object).sub(n.object.position).normalize()}function F(e){return Math.max(n.minDistance,Math.min(n.maxDistance,e))}function B(e){f.set(e.clientX,e.clientY)}function U(e){g.set(e.clientX,e.clientY)}function H(){if(1==T.length)f.set(T[0].pageX,T[0].pageY);else{const e=.5*(T[0].pageX+T[1].pageX),t=.5*(T[0].pageY+T[1].pageY);f.set(e,t)}}function z(){if(1==T.length)g.set(T[0].pageX,T[0].pageY);else{const e=.5*(T[0].pageX+T[1].pageX),t=.5*(T[0].pageY+T[1].pageY);g.set(e,t)}}function G(){const e=T[0].pageX-T[1].pageX,t=T[0].pageY-T[1].pageY,n=Math.sqrt(e*e+t*t);_.set(0,n)}function V(e){if(1==T.length)p.set(e.pageX,e.pageY);else{const t=$(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);p.set(n,i)}m.subVectors(p,f).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(C(2*Math.PI*m.x/t.clientHeight),R(2*Math.PI*m.y/t.clientHeight)),f.copy(p)}function W(e){if(1==T.length)v.set(e.pageX,e.pageY);else{const t=$(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);v.set(n,i)}y.subVectors(v,g).multiplyScalar(n.panSpeed),I(y.x,y.y),g.copy(v)}function j(e){const t=$(e),i=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(i*i+r*r);b.set(0,s),x.set(0,Math.pow(b.y/_.y,n.zoomSpeed)),k(x.y),_.copy(b)}function Y(e){var t,i;!1!==n.enabled&&(0===T.length&&(null==(t=n.domElement)||t.ownerDocument.addEventListener("pointermove",X),null==(i=n.domElement)||i.ownerDocument.addEventListener("pointerup",K)),function(e){T.push(e)}(e),"touch"===e.pointerType?function(e){switch(Z(e),T.length){case 1:switch(n.touches.ONE){case EP.ROTATE:if(!1===n.enableRotate)return;H(),o=a.TOUCH_ROTATE;break;case EP.PAN:if(!1===n.enablePan)return;z(),o=a.TOUCH_PAN;break;default:o=a.NONE}break;case 2:switch(n.touches.TWO){case EP.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&G(),n.enablePan&&z(),o=a.TOUCH_DOLLY_PAN;break;case EP.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&G(),n.enableRotate&&H(),o=a.TOUCH_DOLLY_ROTATE;break;default:o=a.NONE}break;default:o=a.NONE}o!==a.NONE&&n.dispatchEvent(r)}(e):function(e){let t;switch(e.button){case 0:t=n.mouseButtons.LEFT;break;case 1:t=n.mouseButtons.MIDDLE;break;case 2:t=n.mouseButtons.RIGHT;break;default:t=-1}switch(t){case SP.DOLLY:if(!1===n.enableZoom)return;!function(e){N(e),_.set(e.clientX,e.clientY)}(e),o=a.DOLLY;break;case SP.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;U(e),o=a.PAN}else{if(!1===n.enableRotate)return;B(e),o=a.ROTATE}break;case SP.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;B(e),o=a.ROTATE}else{if(!1===n.enablePan)return;U(e),o=a.PAN}break;default:o=a.NONE}o!==a.NONE&&n.dispatchEvent(r)}(e))}function X(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){switch(Z(e),o){case a.TOUCH_ROTATE:if(!1===n.enableRotate)return;V(e),n.update();break;case a.TOUCH_PAN:if(!1===n.enablePan)return;W(e),n.update();break;case a.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;!function(e){n.enableZoom&&j(e),n.enablePan&&W(e)}(e),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;!function(e){n.enableZoom&&j(e),n.enableRotate&&V(e)}(e),n.update();break;default:o=a.NONE}}(e):function(e){if(!1===n.enabled)return;switch(o){case a.ROTATE:if(!1===n.enableRotate)return;!function(e){p.set(e.clientX,e.clientY),m.subVectors(p,f).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(C(2*Math.PI*m.x/t.clientHeight),R(2*Math.PI*m.y/t.clientHeight)),f.copy(p),n.update()}(e);break;case a.DOLLY:if(!1===n.enableZoom)return;!function(e){b.set(e.clientX,e.clientY),x.subVectors(b,_),x.y>0?k(A()):x.y<0&&O(A()),_.copy(b),n.update()}(e);break;case a.PAN:if(!1===n.enablePan)return;!function(e){v.set(e.clientX,e.clientY),y.subVectors(v,g).multiplyScalar(n.panSpeed),I(y.x,y.y),g.copy(v),n.update()}(e)}}(e))}function K(e){var t,i,r;!function(e){delete M[e.pointerId];for(let t=0;t<T.length;t++)if(T[t].pointerId==e.pointerId)return void T.splice(t,1)}(e),0===T.length&&(null==(t=n.domElement)||t.releasePointerCapture(e.pointerId),null==(i=n.domElement)||i.ownerDocument.removeEventListener("pointermove",X),null==(r=n.domElement)||r.ownerDocument.removeEventListener("pointerup",K)),n.dispatchEvent(s),o=a.NONE}function q(e){!1===n.enabled||!1===n.enableZoom||o!==a.NONE&&o!==a.ROTATE||(e.preventDefault(),n.dispatchEvent(r),function(e){N(e),e.deltaY<0?O(A()):e.deltaY>0&&k(A()),n.update()}(e),n.dispatchEvent(s))}function J(e){!1!==n.enabled&&!1!==n.enablePan&&function(e){let t=!1;switch(e.code){case n.keys.UP:I(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:I(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:I(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:I(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function Q(e){!1!==n.enabled&&e.preventDefault()}function Z(e){let t=M[e.pointerId];void 0===t&&(t=new PO,M[e.pointerId]=t),t.set(e.pageX,e.pageY)}function $(e){const t=e.pointerId===T[0].pointerId?T[1]:T[0];return M[t.pointerId]}this.dollyIn=function(){O(arguments.length>0&&void 0!==arguments[0]?arguments[0]:A()),n.update()},this.dollyOut=function(){k(arguments.length>0&&void 0!==arguments[0]?arguments[0]:A()),n.update()},this.getScale=()=>d,this.setScale=e=>{D(e),n.update()},this.getZoomScale=()=>A(),void 0!==t&&this.connect(t),this.update()}}const Zq=["makeDefault","camera","regress","domElement","enableDamping","keyEvents","onChange","onStart","onEnd"],$q=t.forwardRef((e,n)=>{let{makeDefault:i,camera:r,regress:s,domElement:a,enableDamping:o=!0,keyEvents:l=!1,onChange:c,onStart:u,onEnd:h}=e,f=d(e,Zq);const p=eq(e=>e.invalidate),m=eq(e=>e.camera),g=eq(e=>e.gl),v=eq(e=>e.events),y=eq(e=>e.setEvents),_=eq(e=>e.set),b=eq(e=>e.get),x=eq(e=>e.performance),S=r||m,E=a||v.connected||g.domElement,w=t.useMemo(()=>new Qq(S),[S]);return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=$K(),i=n.getState().internal.subscribe,r=gK(e);mK(()=>i(r,t,n),[t,i,n])}(()=>{w.enabled&&w.update()},-1),t.useEffect(()=>(l&&w.connect(!0===l?E:l),w.connect(E),()=>{w.dispose()}),[l,E,s,w,p]),t.useEffect(()=>{const e=e=>{p(),s&&x.regress(),c&&c(e)},t=e=>{u&&u(e)},n=e=>{h&&h(e)};return w.addEventListener("change",e),w.addEventListener("start",t),w.addEventListener("end",n),()=>{w.removeEventListener("start",t),w.removeEventListener("end",n),w.removeEventListener("change",e)}},[c,u,h,w,p,y]),t.useEffect(()=>{if(i){const e=b().controls;return _({controls:w}),()=>_({controls:e})}},[i,w]),t.createElement("primitive",zq({ref:n,object:w,enableDamping:o},f))}),eJ=new WeakMap;class tJ extends HG{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,i){const r=new VG(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,e=>{const n={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,n).then(t).catch(i)},n,i)}decodeDracoFile(e,t,n,i){const r={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){for(const o in t.attributeTypes){const e=t.attributeTypes[o];void 0!==e.BYTES_PER_ELEMENT&&(t.attributeTypes[o]=e.name)}const n=JSON.stringify(t);if(eJ.has(e)){const t=eJ.get(e);if(t.key===n)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const r=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(r,s).then(n=>(i=n,new Promise((n,s)=>{i._callbacks[r]={resolve:n,reject:s},i.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return a.catch(()=>!0).then(()=>{i&&r&&this._releaseTask(i,r)}),eJ.set(e,{key:n,promise:a}),a}_createGeometry(e){const t=new eB;e.index&&t.setIndex(new FF(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const i=e.attributes[n],r=i.name,s=i.array,a=i.itemSize;t.setAttribute(r,new FF(s,a))}return t}_loadLibrary(e,t){const n=new VG(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((t,i)=>{n.load(e,t,void 0,i)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!==typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(t=>{const n=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const i=nJ.toString(),r=["/* draco decoder */",n,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([r]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const n=t.data;switch(n.type){case"decode":e._callbacks[n.id].resolve(n);break;case"error":e._callbacks[n.id].reject(n);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+n.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function nJ(){let e,t;function n(e,t,n,i,r,s){const a=s.num_components(),o=n.num_points()*a,l=o*r.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,r),u=e._malloc(l);t.GetAttributeDataArrayForAllPoints(n,s,c,l,u);const d=new r(e.HEAPF32.buffer,u,o).slice();return e._free(u),{name:i,array:d,itemSize:a}}onmessage=function(i){const r=i.data;switch(r.type){case"init":e=r.decoderConfig,t=new Promise(function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)});break;case"decode":const i=r.buffer,s=r.taskConfig;t.then(e=>{const t=e.draco,a=new t.Decoder,o=new t.DecoderBuffer;o.Init(new Int8Array(i),i.byteLength);try{const e=function(e,t,i,r){const s=r.attributeIDs,a=r.attributeTypes;let o,l;const c=t.GetEncodedGeometryType(i);if(c===e.TRIANGULAR_MESH)o=new e.Mesh,l=t.DecodeBufferToMesh(i,o);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");o=new e.PointCloud,l=t.DecodeBufferToPointCloud(i,o)}if(!l.ok()||0===o.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+l.error_msg());const u={index:null,attributes:[]};for(const d in s){const i=self[a[d]];let l,c;if(r.useUniqueIDs)c=s[d],l=t.GetAttributeByUniqueId(o,c);else{if(c=t.GetAttributeId(o,e[s[d]]),-1===c)continue;l=t.GetAttribute(o,c)}u.attributes.push(n(e,t,o,d,i,l))}c===e.TRIANGULAR_MESH&&(u.index=function(e,t,n){const i=n.num_faces(),r=3*i,s=4*r,a=e._malloc(s);t.GetTrianglesUInt32Array(n,s,a);const o=new Uint32Array(e.HEAPF32.buffer,a,r).slice();return e._free(a),{array:o,itemSize:1}}(e,t,o));return e.destroy(o),u}(t,a,o,s),i=e.attributes.map(e=>e.array.buffer);e.index&&i.push(e.index.array.buffer),self.postMessage({type:"decode",id:r.id,geometry:e},i)}catch(l){console.error(l),self.postMessage({type:"error",id:r.id,error:l.message})}finally{t.destroy(o),t.destroy(a)}})}}}let iJ;const rJ=()=>{if(iJ)return iJ;const e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),t=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if("object"!==typeof WebAssembly)return{supported:!1};let n,i="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB";WebAssembly.validate(e)&&(i="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB");const r=WebAssembly.instantiate(function(e){const n=new Uint8Array(e.length);for(let t=0;t<e.length;++t){const i=e.charCodeAt(t);n[t]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let i=0;for(let r=0;r<e.length;++r)n[i++]=n[r]<60?t[n[r]]:64*(n[r]-60)+n[++r];return n.buffer.slice(0,i)}(i),{}).then(e=>{n=e.instance,n.exports.__wasm_call_ctors()});function s(e,t,i,r,s,a){const o=n.exports.sbrk,l=i+3&-4,c=o(l*r),u=o(s.length),d=new Uint8Array(n.exports.memory.buffer);d.set(s,u);const h=e(c,i,r,u,s.length);if(0===h&&a&&a(c,l,r),t.set(d.subarray(c,c+i*r)),o(c-o(0)),0!==h)throw new Error("Malformed buffer data: ".concat(h))}const a={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},o={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return iJ={ready:r,supported:!0,decodeVertexBuffer(e,t,i,r,o){s(n.exports.meshopt_decodeVertexBuffer,e,t,i,r,n.exports[a[o]])},decodeIndexBuffer(e,t,i,r){s(n.exports.meshopt_decodeIndexBuffer,e,t,i,r)},decodeIndexSequence(e,t,i,r){s(n.exports.meshopt_decodeIndexSequence,e,t,i,r)},decodeGltfBuffer(e,t,i,r,l,c){s(n.exports[o[l]],e,t,i,r,n.exports[a[c]])}},iJ};function sJ(e,t){if(t===ak)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===lk||t===ok){let n=e.getIndex();if(null===n){const t=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<i.count;e++)t.push(e);e.setIndex(t),n=e.getIndex()}const i=n.count-2,r=[];if(n)if(t===lk)for(let e=1;e<=i;e++)r.push(n.getX(0)),r.push(n.getX(e)),r.push(n.getX(e+1));else for(let e=0;e<i;e++)e%2===0?(r.push(n.getX(e)),r.push(n.getX(e+1)),r.push(n.getX(e+2))):(r.push(n.getX(e+2)),r.push(n.getX(e+1)),r.push(n.getX(e)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=e.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}const aJ=(()=>parseInt(xP.replace(/\D+/g,"")))();function oJ(e){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(kne){return t}}const lJ="srgb",cJ="srgb-linear";class uJ extends HG{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new gJ(e)}),this.register(function(e){return new vJ(e)}),this.register(function(e){return new MJ(e)}),this.register(function(e){return new AJ(e)}),this.register(function(e){return new CJ(e)}),this.register(function(e){return new _J(e)}),this.register(function(e){return new bJ(e)}),this.register(function(e){return new xJ(e)}),this.register(function(e){return new SJ(e)}),this.register(function(e){return new mJ(e)}),this.register(function(e){return new EJ(e)}),this.register(function(e){return new yJ(e)}),this.register(function(e){return new TJ(e)}),this.register(function(e){return new wJ(e)}),this.register(function(e){return new fJ(e)}),this.register(function(e){return new RJ(e)}),this.register(function(e){return new LJ(e)})}load(e,t,n,i){const r=this;let s;if(""!==this.resourcePath)s=this.resourcePath;else if(""!==this.path){const t=yV.extractUrlBase(e);s=yV.resolveURL(t,this.path)}else s=yV.extractUrlBase(e);this.manager.itemStart(e);const a=function(t){i?i(t):console.error(t),r.manager.itemError(e),r.manager.itemEnd(e)},o=new VG(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(n){try{r.parse(n,s,function(n){t(n),r.manager.itemEnd(e)},a)}catch(kne){a(kne)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,i){let r;const s={},a={};if("string"===typeof e)r=JSON.parse(e);else if(e instanceof ArrayBuffer){if(oJ(new Uint8Array(e.slice(0,4)))===PJ){try{s[hJ.KHR_BINARY_GLTF]=new kJ(e)}catch(l){return void(i&&i(l))}r=JSON.parse(s[hJ.KHR_BINARY_GLTF].content)}else r=JSON.parse(oJ(new Uint8Array(e)))}else r=e;if(void 0===r.asset||r.asset.version[0]<2)return void(i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const o=new aQ(r,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});o.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const e=this.pluginCallbacks[c](o);e.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[e.name]=e,s[e.name]=!0}if(r.extensionsUsed)for(let c=0;c<r.extensionsUsed.length;++c){const e=r.extensionsUsed[c],t=r.extensionsRequired||[];switch(e){case hJ.KHR_MATERIALS_UNLIT:s[e]=new pJ;break;case hJ.KHR_DRACO_MESH_COMPRESSION:s[e]=new OJ(r,this.dracoLoader);break;case hJ.KHR_TEXTURE_TRANSFORM:s[e]=new NJ;break;case hJ.KHR_MESH_QUANTIZATION:s[e]=new FJ;break;default:t.indexOf(e)>=0&&void 0===a[e]&&console.warn('THREE.GLTFLoader: Unknown extension "'+e+'".')}}o.setExtensions(s),o.setPlugins(a),o.parse(n,i)}parseAsync(e,t){const n=this;return new Promise(function(i,r){n.parse(e,t,i,r)})}}function dJ(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const hJ={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class fJ{constructor(e){this.parser=e,this.name=hJ.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,i=t.length;n<i;n++){const i=t[n];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let i=t.cache.get(n);if(i)return i;const r=t.json,s=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let a;const o=new wF(16777215);void 0!==s.color&&o.setRGB(s.color[0],s.color[1],s.color[2],cJ);const l=void 0!==s.range?s.range:0;switch(s.type){case"directional":a=new hV(o),a.target.position.set(0,0,-1),a.add(a.target);break;case"point":a=new cV(o),a.distance=l;break;case"spot":a=new rV(o),a.distance=l,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,a.angle=s.spot.outerConeAngle,a.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return a.position.set(0,0,0),a.decay=2,eQ(a,s),void 0!==s.intensity&&(a.intensity=s.intensity),a.name=t.createUniqueName(s.name||"light_"+e),i=Promise.resolve(a),t.cache.add(n,i),i}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,i=n.json.nodes[e],r=(i.extensions&&i.extensions[this.name]||{}).light;return void 0===r?null:this._loadLight(r).then(function(e){return n._getNodeRef(t.cache,r,e)})}}class pJ{constructor(){this.name=hJ.KHR_MATERIALS_UNLIT}getMaterialType(){return CF}extendParams(e,t,n){const i=[];e.color=new wF(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const t=r.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],cJ),e.opacity=t[3]}void 0!==r.baseColorTexture&&i.push(n.assignTexture(e,"map",r.baseColorTexture,lJ))}return Promise.all(i)}}class mJ{constructor(e){this.parser=e,this.name=hJ.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=n.extensions[this.name].emissiveStrength;return void 0!==i&&(t.emissiveIntensity=i),Promise.resolve()}}class gJ{constructor(e){this.parser=e,this.name=hJ.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?lG:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];if(void 0!==s.clearcoatFactor&&(t.clearcoat=s.clearcoatFactor),void 0!==s.clearcoatTexture&&r.push(n.assignTexture(t,"clearcoatMap",s.clearcoatTexture)),void 0!==s.clearcoatRoughnessFactor&&(t.clearcoatRoughness=s.clearcoatRoughnessFactor),void 0!==s.clearcoatRoughnessTexture&&r.push(n.assignTexture(t,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),void 0!==s.clearcoatNormalTexture&&(r.push(n.assignTexture(t,"clearcoatNormalMap",s.clearcoatNormalTexture)),void 0!==s.clearcoatNormalTexture.scale)){const e=s.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new PO(e,e)}return Promise.all(r)}}class vJ{constructor(e){this.parser=e,this.name=hJ.KHR_MATERIALS_DISPERSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?lG:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=n.extensions[this.name];return t.dispersion=void 0!==i.dispersion?i.dispersion:0,Promise.resolve()}}class yJ{constructor(e){this.parser=e,this.name=hJ.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?lG:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];return void 0!==s.iridescenceFactor&&(t.iridescence=s.iridescenceFactor),void 0!==s.iridescenceTexture&&r.push(n.assignTexture(t,"iridescenceMap",s.iridescenceTexture)),void 0!==s.iridescenceIor&&(t.iridescenceIOR=s.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==s.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=s.iridescenceThicknessMinimum),void 0!==s.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=s.iridescenceThicknessMaximum),void 0!==s.iridescenceThicknessTexture&&r.push(n.assignTexture(t,"iridescenceThicknessMap",s.iridescenceThicknessTexture)),Promise.all(r)}}class _J{constructor(e){this.parser=e,this.name=hJ.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?lG:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new wF(0,0,0),t.sheenRoughness=0,t.sheen=1;const s=i.extensions[this.name];if(void 0!==s.sheenColorFactor){const e=s.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],cJ)}return void 0!==s.sheenRoughnessFactor&&(t.sheenRoughness=s.sheenRoughnessFactor),void 0!==s.sheenColorTexture&&r.push(n.assignTexture(t,"sheenColorMap",s.sheenColorTexture,lJ)),void 0!==s.sheenRoughnessTexture&&r.push(n.assignTexture(t,"sheenRoughnessMap",s.sheenRoughnessTexture)),Promise.all(r)}}class bJ{constructor(e){this.parser=e,this.name=hJ.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?lG:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];return void 0!==s.transmissionFactor&&(t.transmission=s.transmissionFactor),void 0!==s.transmissionTexture&&r.push(n.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(r)}}class xJ{constructor(e){this.parser=e,this.name=hJ.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?lG:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];t.thickness=void 0!==s.thicknessFactor?s.thicknessFactor:0,void 0!==s.thicknessTexture&&r.push(n.assignTexture(t,"thicknessMap",s.thicknessTexture)),t.attenuationDistance=s.attenuationDistance||1/0;const a=s.attenuationColor||[1,1,1];return t.attenuationColor=(new wF).setRGB(a[0],a[1],a[2],cJ),Promise.all(r)}}class SJ{constructor(e){this.parser=e,this.name=hJ.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?lG:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const i=n.extensions[this.name];return t.ior=void 0!==i.ior?i.ior:1.5,Promise.resolve()}}class EJ{constructor(e){this.parser=e,this.name=hJ.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?lG:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];t.specularIntensity=void 0!==s.specularFactor?s.specularFactor:1,void 0!==s.specularTexture&&r.push(n.assignTexture(t,"specularIntensityMap",s.specularTexture));const a=s.specularColorFactor||[1,1,1];return t.specularColor=(new wF).setRGB(a[0],a[1],a[2],cJ),void 0!==s.specularColorTexture&&r.push(n.assignTexture(t,"specularColorMap",s.specularColorTexture,lJ)),Promise.all(r)}}class wJ{constructor(e){this.parser=e,this.name=hJ.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?lG:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];return t.bumpScale=void 0!==s.bumpFactor?s.bumpFactor:1,void 0!==s.bumpTexture&&r.push(n.assignTexture(t,"bumpMap",s.bumpTexture)),Promise.all(r)}}class TJ{constructor(e){this.parser=e,this.name=hJ.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?lG:null}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];return void 0!==s.anisotropyStrength&&(t.anisotropy=s.anisotropyStrength),void 0!==s.anisotropyRotation&&(t.anisotropyRotation=s.anisotropyRotation),void 0!==s.anisotropyTexture&&r.push(n.assignTexture(t,"anisotropyMap",s.anisotropyTexture)),Promise.all(r)}}class MJ{constructor(e){this.parser=e,this.name=hJ.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,i=n.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const r=i.extensions[this.name],s=t.options.ktx2Loader;if(!s){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,r.source,s)}}class AJ{constructor(e){this.parser=e,this.name=hJ.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,r=i.textures[e];if(!r.extensions||!r.extensions[t])return null;const s=r.extensions[t],a=i.images[s.source];let o=n.textureLoader;if(a.uri){const e=n.options.manager.getHandler(a.uri);null!==e&&(o=e)}return this.detectSupport().then(function(r){if(r)return n.loadTextureImage(e,s.source,o);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class CJ{constructor(e){this.parser=e,this.name=hJ.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,r=i.textures[e];if(!r.extensions||!r.extensions[t])return null;const s=r.extensions[t],a=i.images[s.source];let o=n.textureLoader;if(a.uri){const e=n.options.manager.getHandler(a.uri);null!==e&&(o=e)}return this.detectSupport().then(function(r){if(r)return n.loadTextureImage(e,s.source,o);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class RJ{constructor(e){this.name=hJ.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const e=n.extensions[this.name],i=this.parser.getDependency("buffer",e.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return i.then(function(t){const n=e.byteOffset||0,i=e.byteLength||0,s=e.count,a=e.byteStride,o=new Uint8Array(t,n,i);return r.decodeGltfBufferAsync?r.decodeGltfBufferAsync(s,a,o,e.mode,e.filter).then(function(e){return e.buffer}):r.ready.then(function(){const t=new ArrayBuffer(s*a);return r.decodeGltfBuffer(new Uint8Array(t),s,a,o,e.mode,e.filter),t})})}return null}}class LJ{constructor(e){this.name=hJ.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const i=t.meshes[n.mesh];for(const o of i.primitives)if(o.mode!==zJ.TRIANGLES&&o.mode!==zJ.TRIANGLE_STRIP&&o.mode!==zJ.TRIANGLE_FAN&&void 0!==o.mode)return null;const r=n.extensions[this.name].attributes,s=[],a={};for(const o in r)s.push(this.parser.getDependency("accessor",r[o]).then(e=>(a[o]=e,a[o])));return s.length<1?null:(s.push(this.parser.createNodeMesh(e)),Promise.all(s).then(e=>{const t=e.pop(),n=t.isGroup?t.children:[t],i=e[0].count,r=[];for(const s of n){const e=new IN,t=new DO,n=new IO,o=new DO(1,1,1),l=new MU(s.geometry,s.material,i);for(let r=0;r<i;r++)a.TRANSLATION&&t.fromBufferAttribute(a.TRANSLATION,r),a.ROTATION&&n.fromBufferAttribute(a.ROTATION,r),a.SCALE&&o.fromBufferAttribute(a.SCALE,r),l.setMatrixAt(r,e.compose(t,n,o));for(const i in a)if("_COLOR_0"===i){const e=a[i];l.instanceColor=new yU(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==i&&"ROTATION"!==i&&"SCALE"!==i&&s.geometry.setAttribute(i,a[i]);sF.prototype.copy.call(l,s),this.parser.assignFinalMaterial(l),r.push(l)}return t.isGroup?(t.clear(),t.add(...r),t):r[0]}))}}const PJ="glTF",IJ=1313821514,DJ=5130562;class kJ{constructor(e){this.name=hJ.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:oJ(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==PJ)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,i=new DataView(e,12);let r=0;for(;r<n;){const t=i.getUint32(r,!0);r+=4;const n=i.getUint32(r,!0);if(r+=4,n===IJ){const n=new Uint8Array(e,12+r,t);this.content=oJ(n)}else if(n===DJ){const n=12+r;this.body=e.slice(n,n+t)}r+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class OJ{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=hJ.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,i=this.dracoLoader,r=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,a={},o={},l={};for(const c in s){const e=YJ[c]||c.toLowerCase();a[e]=s[c]}for(const c in e.attributes){const t=YJ[c]||c.toLowerCase();if(void 0!==s[c]){const i=n.accessors[e.attributes[c]],r=GJ[i.componentType];l[t]=r.name,o[t]=!0===i.normalized}}return t.getDependency("bufferView",r).then(function(e){return new Promise(function(t,n){i.decodeDracoFile(e,function(e){for(const t in e.attributes){const n=e.attributes[t],i=o[t];void 0!==i&&(n.normalized=i)}t(e)},a,l,cJ,n)})})}}class NJ{constructor(){this.name=hJ.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&t.texCoord!==e.channel||void 0!==t.offset||void 0!==t.rotation||void 0!==t.scale?(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0,e):e}}class FJ{constructor(){this.name=hJ.KHR_MESH_QUANTIZATION}}class BJ extends EG{constructor(e,t,n,i){super(e,t,n,i)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i*3+i;for(let s=0;s!==i;s++)t[s]=n[r+s];return t}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=2*a,l=3*a,c=i-t,u=(n-t)/c,d=u*u,h=d*u,f=e*l,p=f-l,m=-2*h+3*d,g=h-d,v=1-m,y=g-d+u;for(let _=0;_!==a;_++){const e=s[p+_+a],t=s[p+_+o]*c,n=s[f+_+a],i=s[f+_]*c;r[_]=v*e+y*t+m*n+g*i}return r}}const UJ=new IO;class HJ extends BJ{interpolate_(e,t,n,i){const r=super.interpolate_(e,t,n,i);return UJ.fromArray(r).normalize().toArray(r),r}}const zJ={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},GJ={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},VJ={9728:FI,9729:GI,9984:BI,9985:VI,9986:HI,9987:jI},WJ={33071:OI,33648:NI,10497:kI},jJ={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},YJ=Cr(Cr({POSITION:"position",NORMAL:"normal",TANGENT:"tangent"},aJ>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"}),{},{COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"}),XJ={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},KJ={CUBICSPLINE:void 0,LINEAR:$D,STEP:ZD},qJ="OPAQUE",JJ="MASK",QJ="BLEND";function ZJ(e){return void 0===e.DefaultMaterial&&(e.DefaultMaterial=new oG({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:IP})),e.DefaultMaterial}function $J(e,t,n){for(const i in n.extensions)void 0===e[i]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[i]=n.extensions[i])}function eQ(e,t){void 0!==t.extras&&("object"===typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function tQ(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let n=0,i=t.weights.length;n<i;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){const n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let t=0,i=n.length;t<i;t++)e.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function nQ(e){let t;const n=e.extensions&&e.extensions[hJ.KHR_DRACO_MESH_COMPRESSION];if(t=n?"draco:"+n.bufferView+":"+n.indices+":"+iQ(n.attributes):e.indices+":"+iQ(e.attributes)+":"+e.mode,void 0!==e.targets)for(let i=0,r=e.targets.length;i<r;i++)t+=":"+iQ(e.targets[i]);return t}function iQ(e){let t="";const n=Object.keys(e).sort();for(let i=0,r=n.length;i<r;i++)t+=n[i]+":"+e[n[i]]+";";return t}function rQ(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const sQ=new IN;class aQ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new dJ,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,i=!1,r=-1;"undefined"!==typeof navigator&&"undefined"!==typeof navigator.userAgent&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),i=navigator.userAgent.indexOf("Firefox")>-1,r=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"===typeof createImageBitmap||n||i&&r<98?this.textureLoader=new JG(this.options.manager):this.textureLoader=new MV(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new VG(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,i=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(t){const s={scene:t[0][i.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:i.asset,parser:n,userData:{}};return $J(r,s,i),eQ(s,i),Promise.all(n._invokeAll(function(e){return e.afterRoot&&e.afterRoot(s)})).then(function(){for(const e of s.scenes)e.updateMatrixWorld();e(s)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let i=0,r=t.length;i<r;i++){const n=t[i].joints;for(let t=0,i=n.length;t<i;t++)e[n[t]].isBone=!0}for(let i=0,r=e.length;i<r;i++){const t=e[i];void 0!==t.mesh&&(this._addNodeRef(this.meshCache,t.mesh),void 0!==t.skin&&(n[t.mesh].isSkinnedMesh=!0)),void 0!==t.camera&&this._addNodeRef(this.cameraCache,t.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const i=n.clone(),r=(e,t)=>{const n=this.associations.get(e);null!=n&&this.associations.set(t,n);for(const[i,s]of e.children.entries())r(s,t.children[i])};return r(n,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const i=e(t[n]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let i=0;i<t.length;i++){const r=e(t[i]);r&&n.push(r)}return n}getDependency(e,t){const n=e+":"+t;let i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(e){return e.loadNode&&e.loadNode(t)});break;case"mesh":i=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(n){return n!=this&&n.getDependency&&n.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e)}this.cache.add(n,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,i=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(i.map(function(t,i){return n.getDependency(e,i)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[hJ.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(e,r){n.load(yV.resolveURL(t.uri,i.path),e,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){const n=t.byteLength||0,i=t.byteOffset||0;return e.slice(i,i+n)})}loadAccessor(e){const t=this,n=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse){const e=jJ[i.type],t=GJ[i.componentType],n=!0===i.normalized,r=new t(i.count*e);return Promise.resolve(new FF(r,e,n))}const r=[];return void 0!==i.bufferView?r.push(this.getDependency("bufferView",i.bufferView)):r.push(null),void 0!==i.sparse&&(r.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(r).then(function(e){const r=e[0],s=jJ[i.type],a=GJ[i.componentType],o=a.BYTES_PER_ELEMENT,l=o*s,c=i.byteOffset||0,u=void 0!==i.bufferView?n.bufferViews[i.bufferView].byteStride:void 0,d=!0===i.normalized;let h,f;if(u&&u!==l){const e=Math.floor(c/u),n="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+e+":"+i.count;let l=t.cache.get(n);l||(h=new a(r,e*u,i.count*u/o),l=new OB(h,u/o),t.cache.add(n,l)),f=new FB(l,s,c%u/o,d)}else h=null===r?new a(i.count*s):new a(r,c,i.count*s),f=new FF(h,s,d);if(void 0!==i.sparse){const t=jJ.SCALAR,n=GJ[i.sparse.indices.componentType],o=i.sparse.indices.byteOffset||0,l=i.sparse.values.byteOffset||0,c=new n(e[1],o,i.sparse.count*t),u=new a(e[2],l,i.sparse.count*s);null!==r&&(f=new FF(f.array.slice(),f.itemSize,f.normalized));for(let e=0,i=c.length;e<i;e++){const t=c[e];if(f.setX(t,u[e*s]),s>=2&&f.setY(t,u[e*s+1]),s>=3&&f.setZ(t,u[e*s+2]),s>=4&&f.setW(t,u[e*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return f})}loadTexture(e){const t=this.json,n=this.options,i=t.textures[e].source,r=t.images[i];let s=this.textureLoader;if(r.uri){const e=n.manager.getHandler(r.uri);null!==e&&(s=e)}return this.loadTextureImage(e,i,s)}loadTextureImage(e,t,n){const i=this,r=this.json,s=r.textures[e],a=r.images[t],o=(a.uri||a.bufferView)+":"+s.sampler;if(this.textureCache[o])return this.textureCache[o];const l=this.loadImageSource(t,n).then(function(t){t.flipY=!1,t.name=s.name||a.name||"",""===t.name&&"string"===typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(t.name=a.uri);const n=(r.samplers||{})[s.sampler]||{};return t.magFilter=VJ[n.magFilter]||GI,t.minFilter=VJ[n.minFilter]||jI,t.wrapS=WJ[n.wrapS]||kI,t.wrapT=WJ[n.wrapT]||kI,i.associations.set(t,{textures:e}),t}).catch(function(){return null});return this.textureCache[o]=l,l}loadImageSource(e,t){const n=this,i=this.json,r=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());const s=i.images[e],a=self.URL||self.webkitURL;let o=s.uri||"",l=!1;if(void 0!==s.bufferView)o=n.getDependency("bufferView",s.bufferView).then(function(e){l=!0;const t=new Blob([e],{type:s.mimeType});return o=a.createObjectURL(t),o});else if(void 0===s.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const c=Promise.resolve(o).then(function(e){return new Promise(function(n,i){let s=n;!0===t.isImageBitmapLoader&&(s=function(e){const t=new QO(e);t.needsUpdate=!0,n(t)}),t.load(yV.resolveURL(e,r.path),s,void 0,i)})}).then(function(e){var t;return!0===l&&a.revokeObjectURL(o),eQ(e,s),e.userData.mimeType=s.mimeType||((t=s.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e}).catch(function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),e});return this.sourceCache[e]=c,c}assignTexture(e,t,n,i){const r=this;return this.getDependency("texture",n.index).then(function(s){if(!s)return null;if(void 0!==n.texCoord&&n.texCoord>0&&((s=s.clone()).channel=n.texCoord),r.extensions[hJ.KHR_TEXTURE_TRANSFORM]){const e=void 0!==n.extensions?n.extensions[hJ.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=r.associations.get(s);s=r.extensions[hJ.KHR_TEXTURE_TRANSFORM].extendTexture(s,e),r.associations.set(s,t)}}return void 0!==i&&("number"===typeof i&&(i=3001===i?lJ:cJ),"colorSpace"in s?s.colorSpace=i:s.encoding=i===lJ?3001:3e3),e[t]=s,s})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const i=void 0===t.attributes.tangent,r=void 0!==t.attributes.color,s=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new vH,AF.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,t.sizeAttenuation=!1,this.cache.add(e,t)),n=t}else if(e.isLine){const e="LineBasicMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new iH,AF.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,this.cache.add(e,t)),n=t}if(i||r||s){let e="ClonedMaterial:"+n.uuid+":";i&&(e+="derivative-tangents:"),r&&(e+="vertex-colors:"),s&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=n.clone(),r&&(t.vertexColors=!0),s&&(t.flatShading=!0),i&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(n))),n=t}e.material=n}getMaterialType(){return oG}loadMaterial(e){const t=this,n=this.json,i=this.extensions,r=n.materials[e];let s;const a={},o=[];if((r.extensions||{})[hJ.KHR_MATERIALS_UNLIT]){const e=i[hJ.KHR_MATERIALS_UNLIT];s=e.getMaterialType(),o.push(e.extendParams(a,r,t))}else{const n=r.pbrMetallicRoughness||{};if(a.color=new wF(1,1,1),a.opacity=1,Array.isArray(n.baseColorFactor)){const e=n.baseColorFactor;a.color.setRGB(e[0],e[1],e[2],cJ),a.opacity=e[3]}void 0!==n.baseColorTexture&&o.push(t.assignTexture(a,"map",n.baseColorTexture,lJ)),a.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,a.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(o.push(t.assignTexture(a,"metalnessMap",n.metallicRoughnessTexture)),o.push(t.assignTexture(a,"roughnessMap",n.metallicRoughnessTexture))),s=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),o.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,a)})))}!0===r.doubleSided&&(a.side=kP);const l=r.alphaMode||qJ;if(l===QJ?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,l===JJ&&(a.alphaTest=void 0!==r.alphaCutoff?r.alphaCutoff:.5)),void 0!==r.normalTexture&&s!==CF&&(o.push(t.assignTexture(a,"normalMap",r.normalTexture)),a.normalScale=new PO(1,1),void 0!==r.normalTexture.scale)){const e=r.normalTexture.scale;a.normalScale.set(e,e)}if(void 0!==r.occlusionTexture&&s!==CF&&(o.push(t.assignTexture(a,"aoMap",r.occlusionTexture)),void 0!==r.occlusionTexture.strength&&(a.aoMapIntensity=r.occlusionTexture.strength)),void 0!==r.emissiveFactor&&s!==CF){const e=r.emissiveFactor;a.emissive=(new wF).setRGB(e[0],e[1],e[2],cJ)}return void 0!==r.emissiveTexture&&s!==CF&&o.push(t.assignTexture(a,"emissiveMap",r.emissiveTexture,lJ)),Promise.all(o).then(function(){const n=new s(a);return r.name&&(n.name=r.name),eQ(n,r),t.associations.set(n,{materials:e}),r.extensions&&$J(i,n,r),n})}createUniqueName(e){const t=nW.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,i=this.primitiveCache;function r(e){return n[hJ.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(n){return oQ(n,e,t)})}const s=[];for(let a=0,o=e.length;a<o;a++){const n=e[a],o=nQ(n),l=i[o];if(l)s.push(l.promise);else{let e;e=n.extensions&&n.extensions[hJ.KHR_DRACO_MESH_COMPRESSION]?r(n):oQ(new eB,n,t),i[o]={primitive:n,promise:e},s.push(e)}}return Promise.all(s)}loadMesh(e){const t=this,n=this.json,i=this.extensions,r=n.meshes[e],s=r.primitives,a=[];for(let o=0,l=s.length;o<l;o++){const e=void 0===s[o].material?ZJ(this.cache):this.getDependency("material",s[o].material);a.push(e)}return a.push(t.loadGeometries(s)),Promise.all(a).then(function(n){const a=n.slice(0,n.length-1),o=n[n.length-1],l=[];for(let u=0,d=o.length;u<d;u++){const n=o[u],c=s[u];let d;const h=a[u];if(c.mode===zJ.TRIANGLES||c.mode===zJ.TRIANGLE_STRIP||c.mode===zJ.TRIANGLE_FAN||void 0===c.mode)d=!0===r.isSkinnedMesh?new hU(n,h):new hB(n,h),!0===d.isSkinnedMesh&&d.normalizeSkinWeights(),c.mode===zJ.TRIANGLE_STRIP?d.geometry=sJ(d.geometry,ok):c.mode===zJ.TRIANGLE_FAN&&(d.geometry=sJ(d.geometry,lk));else if(c.mode===zJ.LINES)d=new mH(n,h);else if(c.mode===zJ.LINE_STRIP)d=new dH(n,h);else if(c.mode===zJ.LINE_LOOP)d=new gH(n,h);else{if(c.mode!==zJ.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+c.mode);d=new SH(n,h)}Object.keys(d.geometry.morphAttributes).length>0&&tQ(d,r),d.name=t.createUniqueName(r.name||"mesh_"+e),eQ(d,r),c.extensions&&$J(i,d,c),t.assignFinalMaterial(d),l.push(d)}for(let i=0,r=l.length;i<r;i++)t.associations.set(l[i],{meshes:e,primitives:i});if(1===l.length)return r.extensions&&$J(i,l[0],r),l[0];const c=new RB;r.extensions&&$J(i,c,r),t.associations.set(c,{meshes:e});for(let e=0,t=l.length;e<t;e++)c.add(l[e]);return c})}loadCamera(e){let t;const n=this.json.cameras[e],i=n[n.type];if(i)return"perspective"===n.type?t=new wB(LO.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===n.type&&(t=new uV(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),eQ(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let i=0,r=t.joints.length;i<r;i++)n.push(this._loadNodeShallow(t.joints[i]));return void 0!==t.inverseBindMatrices?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(e){const n=e.pop(),i=e,r=[],s=[];for(let a=0,o=i.length;a<o;a++){const e=i[a];if(e){r.push(e);const t=new IN;null!==n&&t.fromArray(n.array,16*a),s.push(t)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[a])}return new vU(r,s)})}loadAnimation(e){const t=this.json,n=this,i=t.animations[e],r=i.name?i.name:"animation_"+e,s=[],a=[],o=[],l=[],c=[];for(let u=0,d=i.channels.length;u<d;u++){const e=i.channels[u],t=i.samplers[e.sampler],n=e.target,r=n.node,d=void 0!==i.parameters?i.parameters[t.input]:t.input,h=void 0!==i.parameters?i.parameters[t.output]:t.output;void 0!==n.node&&(s.push(this.getDependency("node",r)),a.push(this.getDependency("accessor",d)),o.push(this.getDependency("accessor",h)),l.push(t),c.push(n))}return Promise.all([Promise.all(s),Promise.all(a),Promise.all(o),Promise.all(l),Promise.all(c)]).then(function(e){const t=e[0],i=e[1],s=e[2],a=e[3],o=e[4],l=[];for(let r=0,c=t.length;r<c;r++){const e=t[r],c=i[r],u=s[r],d=a[r],h=o[r];if(void 0===e)continue;e.updateMatrix&&e.updateMatrix();const f=n._createAnimationTracks(e,c,u,d,h);if(f)for(let t=0;t<f.length;t++)l.push(f[t])}return new OG(r,void 0,l)})}createNodeMesh(e){const t=this.json,n=this,i=t.nodes[e];return void 0===i.mesh?null:n.getDependency("mesh",i.mesh).then(function(e){const t=n._getNodeRef(n.meshCache,i.mesh,e);return void 0!==i.weights&&t.traverse(function(e){if(e.isMesh)for(let t=0,n=i.weights.length;t<n;t++)e.morphTargetInfluences[t]=i.weights[t]}),t})}loadNode(e){const t=this,n=this.json.nodes[e],i=t._loadNodeShallow(e),r=[],s=n.children||[];for(let o=0,l=s.length;o<l;o++)r.push(t.getDependency("node",s[o]));const a=void 0===n.skin?Promise.resolve(null):t.getDependency("skin",n.skin);return Promise.all([i,Promise.all(r),a]).then(function(e){const t=e[0],n=e[1],i=e[2];null!==i&&t.traverse(function(e){e.isSkinnedMesh&&e.bind(i,sQ)});for(let r=0,s=n.length;r<s;r++)t.add(n[r]);return t})}_loadNodeShallow(e){const t=this.json,n=this.extensions,i=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const r=t.nodes[e],s=r.name?i.createUniqueName(r.name):"",a=[],o=i._invokeOne(function(t){return t.createNodeMesh&&t.createNodeMesh(e)});return o&&a.push(o),void 0!==r.camera&&a.push(i.getDependency("camera",r.camera).then(function(e){return i._getNodeRef(i.cameraCache,r.camera,e)})),i._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)}).forEach(function(e){a.push(e)}),this.nodeCache[e]=Promise.all(a).then(function(t){let a;if(a=!0===r.isBone?new fU:t.length>1?new RB:1===t.length?t[0]:new sF,a!==t[0])for(let e=0,n=t.length;e<n;e++)a.add(t[e]);if(r.name&&(a.userData.name=r.name,a.name=s),eQ(a,r),r.extensions&&$J(n,a,r),void 0!==r.matrix){const e=new IN;e.fromArray(r.matrix),a.applyMatrix4(e)}else void 0!==r.translation&&a.position.fromArray(r.translation),void 0!==r.rotation&&a.quaternion.fromArray(r.rotation),void 0!==r.scale&&a.scale.fromArray(r.scale);return i.associations.has(a)||i.associations.set(a,{}),i.associations.get(a).nodes=e,a}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],i=this,r=new RB;n.name&&(r.name=i.createUniqueName(n.name)),eQ(r,n),n.extensions&&$J(t,r,n);const s=n.nodes||[],a=[];for(let o=0,l=s.length;o<l;o++)a.push(i.getDependency("node",s[o]));return Promise.all(a).then(function(e){for(let t=0,n=e.length;t<n;t++)r.add(e[t]);return i.associations=(e=>{const t=new Map;for(const[n,r]of i.associations)(n instanceof AF||n instanceof QO)&&t.set(n,r);return e.traverse(e=>{const n=i.associations.get(e);null!=n&&t.set(e,n)}),t})(r),r})}_createAnimationTracks(e,t,n,i,r){const s=[],a=e.name?e.name:e.uuid,o=[];let l;switch(XJ[r.path]===XJ.weights?e.traverse(function(e){e.morphTargetInfluences&&o.push(e.name?e.name:e.uuid)}):o.push(a),XJ[r.path]){case XJ.weights:l=LG;break;case XJ.rotation:l=IG;break;case XJ.position:case XJ.scale:l=kG;break;default:if(1===n.itemSize)l=LG;else l=kG}const c=void 0!==i.interpolation?KJ[i.interpolation]:$D,u=this._getArrayFromAccessor(n);for(let d=0,h=o.length;d<h;d++){const e=new l(o[d]+"."+XJ[r.path],t.array,u,c);"CUBICSPLINE"===i.interpolation&&this._createCubicSplineTrackInterpolant(e),s.push(e)}return s}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const e=rQ(t.constructor),n=new Float32Array(t.length);for(let i=0,r=t.length;i<r;i++)n[i]=t[i]*e;t=n}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof IG?HJ:BJ)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function oQ(e,t,n){const i=t.attributes,r=[];function s(t,i){return n.getDependency("accessor",t).then(function(t){e.setAttribute(i,t)})}for(const a in i){const t=YJ[a]||a.toLowerCase();t in e.attributes||r.push(s(i[a],t))}if(void 0!==t.indices&&!e.index){const i=n.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});r.push(i)}return eQ(e,t),function(e,t,n){const i=t.attributes,r=new sN;if(void 0===i.POSITION)return;{const e=n.json.accessors[i.POSITION],t=e.min,s=e.max;if(void 0===t||void 0===s)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new DO(t[0],t[1],t[2]),new DO(s[0],s[1],s[2])),e.normalized){const t=rQ(GJ[e.componentType]);r.min.multiplyScalar(t),r.max.multiplyScalar(t)}}const s=t.targets;if(void 0!==s){const e=new DO,t=new DO;for(let i=0,r=s.length;i<r;i++){const r=s[i];if(void 0!==r.POSITION){const i=n.json.accessors[r.POSITION],s=i.min,a=i.max;if(void 0!==s&&void 0!==a){if(t.setX(Math.max(Math.abs(s[0]),Math.abs(a[0]))),t.setY(Math.max(Math.abs(s[1]),Math.abs(a[1]))),t.setZ(Math.max(Math.abs(s[2]),Math.abs(a[2]))),i.normalized){const e=rQ(GJ[i.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(e)}e.boundingBox=r;const a=new EN;r.getCenter(a.center),a.radius=r.min.distanceTo(r.max)/2,e.boundingSphere=a}(e,t,n),Promise.all(r).then(function(){return void 0!==t.targets?function(e,t,n){let i=!1,r=!1,s=!1;for(let c=0,u=t.length;c<u;c++){const e=t[c];if(void 0!==e.POSITION&&(i=!0),void 0!==e.NORMAL&&(r=!0),void 0!==e.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(e);const a=[],o=[],l=[];for(let c=0,u=t.length;c<u;c++){const u=t[c];if(i){const t=void 0!==u.POSITION?n.getDependency("accessor",u.POSITION):e.attributes.position;a.push(t)}if(r){const t=void 0!==u.NORMAL?n.getDependency("accessor",u.NORMAL):e.attributes.normal;o.push(t)}if(s){const t=void 0!==u.COLOR_0?n.getDependency("accessor",u.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(l)]).then(function(t){const n=t[0],a=t[1],o=t[2];return i&&(e.morphAttributes.position=n),r&&(e.morphAttributes.normal=a),s&&(e.morphAttributes.color=o),e.morphTargetsRelative=!0,e})}(e,t.targets,n):e})}let lQ=null,cQ="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function uQ(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;return i=>{n&&n(i),e&&(lQ||(lQ=new tJ),lQ.setDecoderPath("string"===typeof e?e:cQ),i.setDRACOLoader(lQ)),t&&i.setMeshoptDecoder(rJ())}}const dQ=(e,t,n,i)=>iq(uJ,e,uQ(t,n,i));dQ.preload=(e,t,n,i)=>iq.preload(uJ,e,uQ(t,n,i)),dQ.clear=e=>iq.clear(uJ,e),dQ.setDecoderPath=e=>{cQ=e};const hQ=(0,t.createContext)([null,()=>{}]);function fQ(e){let{url:n}=e;const{scene:i}=dQ(n),r=(0,t.useRef)(null),{raycaster:s,mouse:a,camera:o}=eq(),l=(0,t.useContext)(hQ),[c,u]=(0,t.useState)(null),d=(0,t.useRef)(null),h=(0,t.useRef)(null),f=(0,t.useRef)(null),m=(0,t.useRef)(null),g=(0,t.useRef)(null);return(0,t.useEffect)(()=>{i.traverse(e=>{e instanceof hB&&(e.castShadow=!0,e.receiveShadow=!0)})},[i]),(0,t.useEffect)(()=>{if(c&&d.current&&h.current&&m.current&&f.current&&g.current){const e=(new sN).setFromObject(c),t=new DO;e.getSize(t);const n=new DO;e.getCenter(n);const i=(new GN).setFromQuaternion(c.quaternion),r=.35,s=1;d.current.position.set(n.x,n.y+s,n.z),h.current.position.set(n.x+r*Math.cos(i.y),0,n.z+r*Math.sin(-i.y)),m.current.position.set(n.x+r*Math.cos(i.y+Math.PI),0,n.z+r*Math.sin(-(i.y+Math.PI))),f.current.position.set(n.x+r*Math.cos(i.y+Math.PI/2),0,n.z+r*Math.sin(-(i.y+Math.PI/2))),g.current.position.set(n.x+r*Math.cos(i.y-Math.PI/2),0,n.z+r*Math.sin(-(i.y-Math.PI/2))),d.current.target=c,h.current.target=c,m.current.target=c,f.current.target=c,g.current.target=c,d.current.visible=!0,h.current.visible=!0,m.current.visible=!0,f.current.visible=!0,g.current.visible=!0}else d.current&&h.current&&m.current&&f.current&&g.current&&(d.current.visible=!1,h.current.visible=!1,m.current.visible=!1,f.current.visible=!1,g.current.visible=!1)},[c]),(0,p.jsxs)("group",{ref:r,children:[(0,p.jsx)("primitive",{object:i,onClick:e=>{e.stopPropagation();const t=e.object;l[1](t?t.name:null),u(t)},onPointerOver:()=>document.body.style.cursor="pointer",onPointerOut:()=>document.body.style.cursor="default"}),(0,p.jsx)("spotLight",{ref:d,color:16765594,intensity:2,distance:50,angle:Math.PI/9,penumbra:.1,decay:2,visible:!1,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-bias":-1e-4,"shadow-camera-near":.1,"shadow-camera-far":50}),(0,p.jsx)("spotLight",{ref:h,color:16765594,intensity:1,distance:50,angle:Math.PI/3.5,penumbra:.1,decay:1.5,visible:!1,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-bias":-1e-4,"shadow-camera-near":.1,"shadow-camera-far":50}),(0,p.jsx)("spotLight",{ref:m,color:16765594,intensity:1,distance:50,angle:Math.PI/3.5,penumbra:.1,decay:1.5,visible:!1,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-bias":-1e-4,"shadow-camera-near":.1,"shadow-camera-far":50}),(0,p.jsx)("spotLight",{ref:f,color:16765594,intensity:1,distance:50,angle:Math.PI/3.5,penumbra:.1,decay:1.5,visible:!1,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-bias":-1e-4,"shadow-camera-near":.1,"shadow-camera-far":50}),(0,p.jsx)("spotLight",{ref:g,color:16765594,intensity:1,distance:50,angle:Math.PI/3.5,penumbra:.1,decay:1.5,visible:!1,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-bias":-1e-4,"shadow-camera-near":.1,"shadow-camera-far":50})]})}const pQ=[{id:"Building1",number:1,name:"\u0421\u0410\u0425\u0410\u0420\u041e\u0412",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u0410\u043d\u0434\u0440\u0435\u044f \u0414\u043c\u0438\u0442\u0440\u0438\u0435\u0432\u0438\u0447\u0430 \u0421\u0430\u0445\u0430\u0440\u043e\u0432\u0430 (1921-1989) - \u0432\u044b\u0434\u0430\u044e\u0449\u0435\u0433\u043e\u0441\u044f \u0444\u0438\u0437\u0438\u043a\u0430-\u0442\u0435\u043e\u0440\u0435\u0442\u0438\u043a\u0430, \u0430\u043a\u0430\u0434\u0435\u043c\u0438\u043a\u0430, \u0441\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044f \u0441\u043e\u0432\u0435\u0442\u0441\u043a\u043e\u0439 \u0432\u043e\u0434\u043e\u0440\u043e\u0434\u043d\u043e\u0439 \u0431\u043e\u043c\u0431\u044b, \u043b\u0430\u0443\u0440\u0435\u0430\u0442\u0430 \u041d\u043e\u0431\u0435\u043b\u0435\u0432\u0441\u043a\u043e\u0439 \u043f\u0440\u0435\u043c\u0438\u0438 \u043c\u0438\u0440\u0430 \u0437\u0430 1975 \u0433\u043e\u0434. \u0421\u0438\u043c\u0432\u043e\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u043d\u0430\u0443\u0447\u043d\u0443\u044e \u043c\u043e\u0449\u044c \u0438 \u0433\u0440\u0430\u0436\u0434\u0430\u043d\u0441\u043a\u0443\u044e \u043f\u043e\u0437\u0438\u0446\u0438\u044e.",places:"\u041f\u0435\u0440\u0432\u044b\u0439 \u043a\u043e\u0440\u043f\u0443\u0441 \u043f\u0440\u0438\u0437\u0432\u0430\u043d \u043d\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u044f, \u043d\u043e \u0438 \u0434\u043b\u044f \u0432\u0441\u0442\u0440\u0435\u0447\u0438 \u043d\u0430\u0448\u0438\u0445 \u0433\u043e\u0441\u0442\u0435\u0439, \u0437\u0434\u0435\u0441\u044c \u0431\u0443\u0434\u0443\u0449\u0438\u0435 \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u044b \u0441\u043c\u043e\u0433\u0443\u0442 \u043f\u0440\u043e\u0439\u0442\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u0443\u044e \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044e \u0438 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0432\u0445\u043e\u0434\u0430 \u0432\u043e \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u044b \u0433\u043e\u0441\u0442\u0438\u043d\u0438\u0446\u044b \u043a\u0430\u043c\u043f\u0443\u0441\u0430 \u041d\u0435\u0439\u043c\u0430\u0440\u043a"},{id:"Building2",number:2,name:"\u0411\u0415\u0422\u0410\u041d\u041a\u0423\u0420",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u0410\u0432\u0433\u0443\u0441\u0442\u0438\u043d\u0430 \u0434\u0435 \u0411\u0435\u0442\u0430\u043d\u043a\u0443\u0440\u0430 (1758-1824) - \u0438\u0441\u043f\u0430\u043d\u043e-\u0440\u0443\u0441\u0441\u043a\u043e\u0433\u043e \u0443\u0447\u0435\u043d\u043e\u0433\u043e, \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u0430 \u0438 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u043e\u0440\u0430, \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0442\u043e\u0440\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0432\u044b\u0441\u0448\u0435\u0433\u043e \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u043d\u043e\u0433\u043e \u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0432 \u0420\u043e\u0441\u0441\u0438\u0438. \u041e\u043b\u0438\u0446\u0435\u0442\u0432\u043e\u0440\u044f\u0435\u0442 \u0438\u043d\u0436\u0435\u043d\u0435\u0440\u043d\u044b\u0439 \u0433\u0435\u043d\u0438\u0439 \u0438 \u043f\u0440\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u043d\u0430\u0443\u043a\u0443.",places:'\u0414\u043b\u044f \u0436\u0438\u0442\u0435\u043b\u0435\u0439 \u0432\u0442\u043e\u0440\u043e\u0433\u043e \u043a\u043e\u0440\u043f\u0443\u0441\u0430 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0442\u0441\u044f \u0431\u0443\u043a\u0432\u0430\u043b\u044c\u043d\u043e \u043c\u0438\u043d\u0443\u0442\u043d\u0430\u044f \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0441\u0435\u0442\u0438\u0442\u044c \u043d\u0430 \u043f\u0435\u0440\u0432\u043e\u043c \u044d\u0442\u0430\u0436\u0435 \u043e\u0434\u043d\u043e \u0438\u0437 \u043f\u0435\u0440\u0432\u044b\u0445 \u043e\u0442\u043a\u0440\u044b\u0432\u0448\u0438\u0445\u0441\u044f \u043c\u0435\u0441\u0442 \u0432 \u0433\u043e\u0441\u0442\u0438\u043d\u0438\u0446\u0435 - \u0432\u043a\u0443\u0441\u043d\u0435\u0439\u0448\u0430\u044f "\u0411\u043b\u0438\u043d\u043d\u0430\u044f", \u0437\u0430\u043f\u0430\u0445 \u0430\u0440\u043e\u043c\u0430\u0442\u043d\u044b\u0445 \u0431\u043b\u0438\u043d\u043e\u0432 \u043d\u0435 \u043e\u0441\u0442\u0430\u0432\u0438\u0442 \u0440\u0430\u0432\u043d\u043e\u0434\u0443\u0448\u043d\u044b\u043c\u0438 \u0436\u0438\u0442\u0435\u043b\u0435\u0439 \u043a\u043e\u0440\u043f\u0443\u0441\u0430 "\u0425\u0430\u0440\u0438\u0442\u043e\u043d"'},{id:"Building3",number:3,name:"\u041b\u041e\u0411\u0410\u0427\u0415\u0412\u0421\u041a\u0418\u0419",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u041d\u0438\u043a\u043e\u043b\u0430\u044f \u0418\u0432\u0430\u043d\u043e\u0432\u0438\u0447\u0430 \u041b\u043e\u0431\u0430\u0447\u0435\u0432\u0441\u043a\u043e\u0433\u043e (1792-1856) - \u0432\u0435\u043b\u0438\u043a\u043e\u0433\u043e \u0440\u0443\u0441\u0441\u043a\u043e\u0433\u043e \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u043a\u0430, \u0441\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044f \u043d\u0435\u0435\u0432\u043a\u043b\u0438\u0434\u043e\u0432\u043e\u0439 \u0433\u0435\u043e\u043c\u0435\u0442\u0440\u0438\u0438. \u0412\u043e\u043f\u043b\u043e\u0449\u0430\u0435\u0442 \u0440\u0435\u0432\u043e\u043b\u044e\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0438\u0434\u0435\u0438 \u0438 \u0441\u043c\u0435\u043b\u043e\u0441\u0442\u044c \u043d\u0430\u0443\u0447\u043d\u043e\u0439 \u043c\u044b\u0441\u043b\u0438.",places:'\u041e\u0434\u043d\u0430 \u0438\u0437 \u0441\u0430\u043c\u044b\u0445 \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0445 \u043a\u043e\u0444\u0435\u0439\u043d \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0431\u0443\u043a\u0432\u0430\u043b\u044c\u043d\u043e \u0432 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u044d\u0442\u0430\u0436\u0430\u0445 \u043e\u0442 \u0436\u0438\u0442\u0435\u043b\u0435\u0439 \u043a\u043e\u0440\u043f\u0443\u0441\u0430 "\u041b\u043e\u0431\u0430\u0447\u0435\u0432\u0441\u043a\u0438\u0439", \u0432 Starbucks \u043c\u043e\u0436\u043d\u043e \u0443\u044e\u0442\u043d\u043e \u043e\u0442\u0434\u043e\u0445\u043d\u0443\u0442\u044c \u0437\u0430 \u043a\u0440\u0443\u0436\u043a\u043e\u0439 \u043a\u043e\u0444\u0435'},{id:"Building4",number:4,name:"\u041a\u0410\u041b\u0410\u0428\u041d\u0418\u041a\u041e\u0412",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u041c\u0438\u0445\u0430\u0438\u043b\u0430 \u0422\u0438\u043c\u043e\u0444\u0435\u0435\u0432\u0438\u0447\u0430 \u041a\u0430\u043b\u0430\u0448\u043d\u0438\u043a\u043e\u0432\u0430 (1919-2013) - \u0437\u043d\u0430\u043c\u0435\u043d\u0438\u0442\u043e\u0433\u043e \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440\u0430-\u043e\u0440\u0443\u0436\u0435\u0439\u043d\u0438\u043a\u0430, \u0441\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0430 \u041a\u0430\u043b\u0430\u0448\u043d\u0438\u043a\u043e\u0432\u0430. \u0421\u0438\u043c\u0432\u043e\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0438\u043d\u043d\u043e\u0432\u0430\u0446\u0438\u0438 \u0438 \u043d\u0430\u0434\u0435\u0436\u043d\u043e\u0441\u0442\u044c.",places:"\u0416\u0438\u0442\u0435\u043b\u044f\u043c \u044d\u0442\u043e\u0433\u043e \u043a\u043e\u0440\u043f\u0443\u0441\u0430 \u0432 \u043c\u0438\u043d\u0443\u0442\u043d\u043e\u0439 \u0431\u043b\u0438\u0437\u043e\u0441\u0442\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0444\u0440\u0443\u043a\u0442\u043e\u0432\u044b\u0439 \u043c\u0430\u0433\u0430\u0437\u0438\u043d, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043c\u043e\u0436\u043d\u043e \u0437\u0430\u0431\u0435\u0436\u0430\u0442\u044c \u043f\u043e\u0441\u043b\u0435 \u0433\u0440\u0443\u043f\u043f\u043e\u0432\u044b\u0445 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u043a, \u043f\u043e\u0441\u0435\u0449\u0435\u043d\u0438\u0435 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u0442\u0430\u043a\u0436\u0435 \u043d\u0430 \u043f\u0435\u0440\u0432\u043e\u043c \u044d\u0442\u0430\u0436\u0435"},{id:"Building5",number:5,name:"\u041b\u042f\u041f\u0423\u041d\u041e\u0412",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440\u0430 \u041c\u0438\u0445\u0430\u0439\u043b\u043e\u0432\u0438\u0447\u0430 \u041b\u044f\u043f\u0443\u043d\u043e\u0432\u0430 (1857-1918) - \u0432\u044b\u0434\u0430\u044e\u0449\u0435\u0433\u043e\u0441\u044f \u0440\u0443\u0441\u0441\u043a\u043e\u0433\u043e \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u043a\u0430 \u0438 \u043c\u0435\u0445\u0430\u043d\u0438\u043a\u0430, \u0441\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044f \u0442\u0435\u043e\u0440\u0438\u0438 \u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u043e\u0441\u0442\u0438. \u041e\u043b\u0438\u0446\u0435\u0442\u0432\u043e\u0440\u044f\u0435\u0442 \u0441\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0438 \u0444\u0443\u043d\u0434\u0430\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c.",places:'\u041a\u043e\u0440\u043f\u0443\u0441 "\u041b\u044f\u043f\u0443\u043d\u043e\u0432" \u043d\u0430 \u043f\u0435\u0440\u0432\u043e\u043c \u044d\u0442\u0430\u0436\u0435 \u043e\u0442\u043a\u0440\u044b\u043b \u0444\u043e\u0442\u043e\u0441\u0442\u0443\u0434\u0438\u044e, \u043d\u0435 \u0437\u0430\u0431\u0443\u0434\u044c\u0442\u0435 \u0432 \u043d\u0435\u0435 \u0437\u0430\u0433\u043b\u044f\u043d\u0443\u0442\u044c, \u0431\u0435\u0437 \u043f\u043e\u0442\u0440\u044f\u0441\u0430\u044e\u0449\u0438\u0445 \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0439 \u0432\u044b \u043d\u0435 \u043e\u0441\u0442\u0430\u043d\u0438\u0442\u0435\u0441\u044c'},{id:"Building6",number:6,name:"\u0421\u0422\u0415\u041a\u041b\u041e\u0412",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u0412\u043b\u0430\u0434\u0438\u043c\u0438\u0440\u0430 \u0410\u043d\u0434\u0440\u0435\u0435\u0432\u0438\u0447\u0430 \u0421\u0442\u0435\u043a\u043b\u043e\u0432\u0430 (1864-1926) - \u0440\u0443\u0441\u0441\u043a\u043e\u0433\u043e \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u043a\u0430 \u0438 \u043c\u0435\u0445\u0430\u043d\u0438\u043a\u0430, \u043e\u0441\u043d\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0424\u0438\u0437\u0438\u043a\u043e-\u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0438\u043d\u0441\u0442\u0438\u0442\u0443\u0442\u0430 \u0420\u0410\u041d. \u0421\u0438\u043c\u0432\u043e\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0430\u043a\u0430\u0434\u0435\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0442\u0440\u0430\u0434\u0438\u0446\u0438\u0438.",places:'\u041b\u044e\u0431\u0438\u0442\u0435 \u0438\u0433\u0440\u043e\u0432\u044b\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0438\u043b\u0438 \u0442\u0443\u0440\u043d\u0438\u0440\u044b \u043e\u043d\u043b\u0430\u0439\u043d \u0448\u0443\u0442\u0435\u0440\u043e\u0432? \u0422\u043e\u0433\u0434\u0430 \u043a\u043e\u0440\u043f\u0443\u0441 "\u0421\u0442\u0435\u043a\u043b\u043e\u0432" \u0432\u0430\u043c \u0432 \u044d\u0442\u043e\u043c \u043f\u043e\u043c\u043e\u0436\u0435\u0442, \u0432\u0435\u0434\u044c \u043d\u0430 \u043f\u0435\u0440\u0432\u043e\u043c \u044d\u0442\u0430\u0436\u0435 \u044d\u0442\u043e\u0433\u043e \u043a\u043e\u0440\u043f\u0443\u0441\u0430 \u0440\u0430\u0441\u043f\u043e\u043b\u0430\u0433\u0430\u0435\u0442\u0441\u044f \u0433\u0440\u043e\u043c\u0430\u0434\u043d\u044b\u0439 \u0438\u0433\u0440\u043e\u0432\u043e\u0439 \u0446\u0435\u043d\u0442\u0440!'},{id:"Building7",number:7,name:"\u0411\u0420\u0410\u0419\u0426\u0415\u0412",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u0421\u0435\u0440\u0433\u0435\u044f \u0412\u0430\u043b\u0435\u0440\u044c\u044f\u043d\u043e\u0432\u0438\u0447\u0430 \u0411\u0440\u0430\u0439\u0446\u0435\u0432\u0430 (1903-1975) - \u0441\u043e\u0432\u0435\u0442\u0441\u043a\u043e\u0433\u043e \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u043e\u0440\u0430-\u0440\u0435\u0441\u0442\u0430\u0432\u0440\u0430\u0442\u043e\u0440\u0430, \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0432\u0448\u0435\u0433\u043e \u043c\u043d\u043e\u0433\u0438\u0435 \u043f\u0430\u043c\u044f\u0442\u043d\u0438\u043a\u0438 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b \u043f\u043e\u0441\u043b\u0435 \u0432\u043e\u0439\u043d\u044b. \u0412\u043e\u043f\u043b\u043e\u0449\u0430\u0435\u0442 \u0433\u0430\u0440\u043c\u043e\u043d\u0438\u044e \u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435.",places:'\u041a\u043e\u0440\u043f\u0443\u0441 "\u0411\u0440\u0430\u0439\u0446\u0435\u0432" \u0433\u0440\u0430\u043c\u043e\u0442\u043d\u043e \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043b \u0432 \u0441\u0435\u0431\u0435 \u0441\u0430\u043c\u044b\u0435 \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u043c\u0430\u0440\u043a\u0435\u0442\u043f\u043b\u0435\u0439\u0441\u044b: \u042f\u043d\u0434\u0435\u043a\u0441 \u041c\u0430\u0440\u043a\u0435\u0442, Wildberries, \u0432\u0441\u0435 \u0441\u0430\u043c\u043e\u0435 \u043d\u0443\u0436\u043d\u043e\u0435 \u0442\u0435\u043f\u0435\u0440\u044c \u0432 \u0434\u0432\u0443\u0445 \u0448\u0430\u0433\u0430\u0445!'},{id:"Building8",number:8,name:"\u0413\u0410\u041b\u041e\u041d\u041e\u0412-\u0413\u0420\u0415\u0425\u041e\u0412",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u0410\u043d\u0434\u0440\u0435\u044f \u0412\u0438\u043a\u0442\u043e\u0440\u043e\u0432\u0438\u0447\u0430 \u0413\u0430\u043f\u043e\u043d\u043e\u0432\u0430-\u0413\u0440\u0435\u0445\u043e\u0432\u0430 (1926-2023) - \u0441\u043e\u0432\u0435\u0442\u0441\u043a\u043e\u0433\u043e \u0438 \u0440\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u043e\u0433\u043e \u0444\u0438\u0437\u0438\u043a\u0430, \u0430\u043a\u0430\u0434\u0435\u043c\u0438\u043a\u0430, \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0441\u0442\u0430 \u0432 \u043e\u0431\u043b\u0430\u0441\u0442\u0438 \u0440\u0430\u0434\u0438\u043e\u0444\u0438\u0437\u0438\u043a\u0438 \u0438 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u0438\u043a\u0438. \u0421\u0438\u043c\u0432\u043e\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0441\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438.",places:"\u042d\u0442\u043e\u0442 \u043a\u043e\u0440\u043f\u0443\u0441 \u0442\u043e\u0436\u0435 \u043d\u0435 \u043e\u0442\u0441\u0442\u0430\u0435\u0442 \u043e\u0442 \u0442\u0440\u0435\u043d\u0434\u043e\u0432, \u0437\u0434\u0435\u0441\u044c \u0442\u0430\u043a\u0436\u0435 \u043c\u043e\u0436\u043d\u043e \u043d\u0430\u0439\u0442\u0438 \u043d\u0430 \u043f\u0435\u0440\u0432\u043e\u043c \u044d\u0442\u0430\u0436\u0435 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043d\u044b\u0439 \u043a\u043b\u0443\u0431, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043c\u043e\u0436\u043d\u043e \u043d\u0430\u0441\u043b\u0430\u0434\u0438\u0442\u0441\u044f \u043a\u0430\u0442\u043a\u043e\u0439 \u0437\u0430 \u043b\u044e\u0431\u0438\u043c\u044b\u043c\u0438 \u0438\u0433\u0440\u0430\u043c\u0438"},{id:"Building9",number:9,name:"\u0410\u041d\u0414\u0420\u041e\u041d\u041e\u0412",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440\u0430 \u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440\u043e\u0432\u0438\u0447\u0430 \u0410\u043d\u0434\u0440\u043e\u043d\u043e\u0432\u0430 (1901-1952) - \u0441\u043e\u0432\u0435\u0442\u0441\u043a\u043e\u0433\u043e \u0444\u0438\u0437\u0438\u043a\u0430 \u0438 \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u043a\u0430, \u043e\u0441\u043d\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0442\u0435\u043e\u0440\u0438\u0438 \u043d\u0435\u043b\u0438\u043d\u0435\u0439\u043d\u044b\u0445 \u043a\u043e\u043b\u0435\u0431\u0430\u043d\u0438\u0439. \u041e\u043b\u0438\u0446\u0435\u0442\u0432\u043e\u0440\u044f\u0435\u0442 \u0440\u0438\u0442\u043c \u0438 \u0433\u0430\u0440\u043c\u043e\u043d\u0438\u044e.",places:'\u041a\u043e\u043d\u0435\u0447\u043d\u043e \u0436\u0435, \u043a\u0443\u0434\u0430 \u0431\u0435\u0437 \u043b\u044e\u0431\u0438\u043c\u044b\u0445 \u043c\u0435\u0441\u0442 \u043e\u0442\u0434\u044b\u0445\u0430? \u0412 \u043a\u043e\u0440\u043f\u0443\u0441\u0435 "\u0410\u043d\u0434\u0440\u043e\u043d\u043e\u0432" \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0441\u0430\u043c\u0430\u044f \u0431\u043e\u043b\u044c\u0448\u0430\u044f \u0433\u043e\u0441\u0442\u0438\u043d\u043d\u0430\u044f, \u0433\u0434\u0435 \u043c\u043e\u0436\u043d\u043e \u043e\u0442\u0434\u043e\u0445\u043d\u0443\u0442\u044c \u0437\u0430 \u043a\u0440\u0443\u0436\u0435\u0447\u043a\u043e\u0439 \u0433\u043e\u0440\u044f\u0447\u0435\u0433\u043e \u0447\u0430\u0439 \u0438 \u043f\u043e\u0431\u0435\u0441\u0435\u0434\u043e\u0432\u0430\u0442\u044c \u0441 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438'},{id:"Building10",number:10,name:"\u0425\u0410\u0420\u0418\u0422\u041e\u041d",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u042e\u043b\u0438\u044f \u0411\u043e\u0440\u0438\u0441\u043e\u0432\u0438\u0447\u0430 \u0425\u0430\u0440\u0438\u0442\u043e\u043d\u0430 (1904-1996) - \u0432\u044b\u0434\u0430\u044e\u0449\u0435\u0433\u043e\u0441\u044f \u0444\u0438\u0437\u0438\u043a\u0430, \u043d\u0430\u0443\u0447\u043d\u043e\u0433\u043e \u0440\u0443\u043a\u043e\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u0441\u043e\u0432\u0435\u0442\u0441\u043a\u043e\u0433\u043e \u0430\u0442\u043e\u043c\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0430, \u0442\u0440\u0438\u0436\u0434\u044b \u0413\u0435\u0440\u043e\u044f \u0421\u043e\u0446\u0438\u0430\u043b\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0422\u0440\u0443\u0434\u0430. \u0412\u043e\u043f\u043b\u043e\u0449\u0430\u0435\u0442 \u043d\u0430\u0443\u0447\u043d\u0443\u044e \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u0438 \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u044c.",places:'"\u0425\u0430\u0440\u0438\u0442\u043e\u043d" \u043d\u0435 \u043e\u0441\u0442\u0430\u0432\u0438\u0442 \u0432\u0430\u0441 \u0431\u0435\u0437 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c, \u043d\u043e \u043d\u0435 \u0431\u0443\u043c\u0430\u0436\u043d\u044b\u0445 \u043b\u0438\u0441\u0442\u043e\u0432, \u0430 \u0441\u0430\u043c\u044b\u0445 \u0440\u0430\u0437\u043d\u044b\u0445 \u0444\u0438\u0433\u0443\u0440\u043e\u043a \u0432 3\u0434 \u0444\u043e\u0440\u043c\u0430\u0442\u0435, \u043a\u043e\u0442\u043e\u0440\u0435 \u0432\u044b \u0442\u043e\u043b\u044c\u043a\u043e \u043c\u043e\u0436\u0435\u0442\u0435 \u0441\u0435\u0431\u0435 \u043d\u0430\u0432\u043e\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c!'},{id:"Building11",number:11,name:"\u0411\u041e\u0413\u041e\u041b\u042e\u0411\u041e\u0412",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u041d\u0438\u043a\u043e\u043b\u0430\u044f \u041d\u0438\u043a\u043e\u043b\u0430\u0435\u0432\u0438\u0447\u0430 \u0411\u043e\u0433\u043e\u043b\u044e\u0431\u043e\u0432\u0430 (1909-1992) - \u0441\u043e\u0432\u0435\u0442\u0441\u043a\u043e\u0433\u043e \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u043a\u0430 \u0438 \u0444\u0438\u0437\u0438\u043a\u0430-\u0442\u0435\u043e\u0440\u0435\u0442\u0438\u043a\u0430, \u0430\u043a\u0430\u0434\u0435\u043c\u0438\u043a\u0430, \u043e\u0441\u043d\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043d\u0430\u0443\u0447\u043d\u044b\u0445 \u0448\u043a\u043e\u043b \u043f\u043e \u043d\u0435\u043b\u0438\u043d\u0435\u0439\u043d\u043e\u0439 \u043c\u0435\u0445\u0430\u043d\u0438\u043a\u0435 \u0438 \u043a\u0432\u0430\u043d\u0442\u043e\u0432\u043e\u0439 \u0442\u0435\u043e\u0440\u0438\u0438 \u043f\u043e\u043b\u044f. \u0421\u0438\u043c\u0432\u043e\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0433\u043b\u0443\u0431\u0438\u043d\u0443 \u043d\u0430\u0443\u0447\u043d\u043e\u0433\u043e \u043f\u043e\u0437\u043d\u0430\u043d\u0438\u044f.",places:'\u041d\u0435 \u0432\u0430\u0436\u043d\u043e \u0441\u0435\u0431\u044f \u043f\u043e\u0447\u0443\u0432\u0441\u0432\u0442\u0432\u043e\u0432\u0430\u043b\u0438? \u0425\u043e\u0442\u0435 \u043f\u043e\u0433\u043e\u0432\u043e\u0440\u0438\u0442\u044c? \u0412 \u044d\u0442\u043e\u043c \u0432\u0430\u043c \u043f\u043e\u043c\u043e\u0436\u0435\u0442 \u0446\u0435\u043d\u0442\u0440 \u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u043d\u0430 \u043f\u0435\u0440\u0432\u043e\u043c \u044d\u0442\u0430\u0436\u0435 \u043a\u043e\u0440\u043f\u0443\u0441\u0430 "\u0411\u043e\u0433\u043e\u043b\u044e\u0431\u043e\u0432"'},{id:"Building12",number:12,name:"\u0410\u0424\u0420\u0418\u041a\u0410\u041d\u041e\u0412",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u0418\u0433\u043e\u0440\u044f \u0410\u0444\u0440\u0438\u043a\u0430\u043d\u043e\u0432\u0430 - \u0441\u043e\u0432\u0435\u0442\u0441\u043a\u043e\u0433\u043e \u0438 \u0440\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u043e\u0433\u043e \u0443\u0447\u0435\u043d\u043e\u0433\u043e \u0432 \u043e\u0431\u043b\u0430\u0441\u0442\u0438 \u044f\u0434\u0435\u0440\u043d\u043e\u0439 \u0444\u0438\u0437\u0438\u043a\u0438 \u0438 \u044d\u043d\u0435\u0440\u0433\u0435\u0442\u0438\u043a\u0438. \u041e\u043b\u0438\u0446\u0435\u0442\u0432\u043e\u0440\u044f\u0435\u0442 \u044d\u043d\u0435\u0440\u0433\u0435\u0442\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u043c\u043e\u0449\u044c \u0438 \u0438\u043d\u043d\u043e\u0432\u0430\u0446\u0438\u0438.",places:'\u0422-\u0431\u0430\u043d\u043a \u0440\u0435\u0448\u0438\u043b \u043f\u043e\u043c\u043e\u0447\u044c \u0440\u0430\u0437\u0432\u0438\u0442\u0438\u044e \u043d\u0430\u0448\u0438\u0445 \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u043e\u0432 \u0432 IT \u0441\u0444\u0435\u0440\u0435, \u0432\u0435\u0434\u044c \u043f\u0440\u044f\u043c\u043e \u0432 \u043a\u043e\u0440\u043f\u0443\u0441\u0435 "\u0410\u0444\u0440\u0438\u043a\u0430\u043d\u043e\u0432" \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u0441\u0435\u0442\u0438\u0442\u044c "IT-\u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438"!'},{id:"Building13",number:13,name:"\u0410\u041b\u0415\u041a\u0421\u0415\u0415\u0412",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u0420\u043e\u0441\u0442\u0438\u0441\u043b\u0430\u0432\u0430 \u0415\u0432\u0433\u0435\u043d\u044c\u0435\u0432\u0438\u0447\u0430 \u0410\u043b\u0435\u043a\u0441\u0435\u0435\u0432\u0430 (1916-1980) - \u0441\u043e\u0432\u0435\u0442\u0441\u043a\u043e\u0433\u043e \u043a\u043e\u0440\u0430\u0431\u043b\u0435\u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044f, \u0441\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044f \u0441\u0443\u0434\u043e\u0432 \u043d\u0430 \u043f\u043e\u0434\u0432\u043e\u0434\u043d\u044b\u0445 \u043a\u0440\u044b\u043b\u044c\u044f\u0445 \u0438 \u044d\u043a\u0440\u0430\u043d\u043e\u043f\u043b\u0430\u043d\u043e\u0432. \u0412\u043e\u043f\u043b\u043e\u0449\u0430\u0435\u0442 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0438 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441.",places:'\u0417\u0430\u043b \u0435\u0434\u0438\u043d\u043e\u0431\u043e\u0440\u0441\u0442\u0432, \u043f\u0430\u0440\u0438\u043a\u043c\u0430\u0445\u0435\u0440\u0441\u043a\u0430\u044f \u0438\u043b\u0438 \u043a\u043d\u0438\u0436\u043d\u044b\u0439 \u0434\u043e\u043c, \u0432\u0441\u0435 \u044d\u0442\u043e \u043f\u0440\u044f\u043c\u043e \u043d\u0430 \u043f\u0435hd\u043e\u043c \u044d\u0442\u0430\u0436\u0435 \u043a\u043e\u0440\u043f\u0443\u0441\u0430 "\u0410\u043b\u0435\u043a\u0441\u0435\u0435\u0432", \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0432\u044b \u0441\u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u0434\u043e\u0431\u0440\u0430\u0442\u044c \u043b\u044e\u0431\u0438\u043c\u043e\u0435 \u0437\u0430\u043d\u044f\u0442\u0438\u0435 \u0438\u043b\u0438 \u043f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0432\u0441\u0435 \u0441\u0440\u0430\u0437\u0443!'},{id:"Building14",number:14,name:"\u0413\u0418\u041d\u0417\u0411\u0423\u0420\u0413",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u0412\u0438\u0442\u0430\u043b\u0438\u044f \u041b\u0430\u0437\u0430\u0440\u0435\u0432\u0438\u0447\u0430 \u0413\u0438\u043d\u0437\u0431\u0443\u0440\u0433\u0430 (1916-2009) - \u0441\u043e\u0432\u0435\u0442\u0441\u043a\u043e\u0433\u043e \u0438 \u0440\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u043e\u0433\u043e \u0444\u0438\u0437\u0438\u043a\u0430-\u0442\u0435\u043e\u0440\u0435\u0442\u0438\u043a\u0430, \u0430\u043a\u0430\u0434\u0435\u043c\u0438\u043a\u0430, \u043b\u0430\u0443\u0440\u0435\u0430\u0442\u0430 \u041d\u043e\u0431\u0435\u043b\u0435\u0432\u0441\u043a\u043e\u0439 \u043f\u0440\u0435\u043c\u0438\u0438 \u043f\u043e \u0444\u0438\u0437\u0438\u043a\u0435 2003 \u0433\u043e\u0434\u0430. \u0421\u0438\u043c\u0432\u043e\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u043d\u0430\u0443\u0447\u043d\u043e\u0435 \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435.",places:""},{id:"Building15",number:15,name:"\u041d\u0415\u0419\u041c\u0410\u0420\u041a",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u042e\u043b\u0438\u044f \u0418\u0441\u0430\u0430\u043a\u043e\u0432\u0438\u0447\u0430 \u041d\u0435\u0439\u043c\u0430\u0440\u043a\u0430 (1920-2011) - \u0441\u043e\u0432\u0435\u0442\u0441\u043a\u043e\u0433\u043e \u0438 \u0440\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u043e\u0433\u043e \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u043a\u0430, \u043e\u0441\u043d\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043d\u0430\u0443\u0447\u043d\u043e\u0439 \u0448\u043a\u043e\u043b\u044b \u043f\u043e \u0442\u0435\u043e\u0440\u0438\u0438 \u043a\u043e\u043b\u0435\u0431\u0430\u043d\u0438\u0439 \u0438 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u043c. \u041e\u043b\u0438\u0446\u0435\u0442\u0432\u043e\u0440\u044f\u0435\u0442 \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u044d\u043b\u0435\u0433\u0430\u043d\u0442\u043d\u043e\u0441\u0442\u044c.",places:'\u041a\u043e\u0440\u043f\u0443\u0441 "\u041d\u0435\u0439\u043c\u0430\u0440\u043a" \u043d\u043e\u0441\u0438\u0442 \u0440\u043e\u0432\u043d\u043e \u0442\u0430\u043a\u043e\u0435 \u0436\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0447\u0442\u043e \u0438 \u043d\u0430\u0448 \u043a\u0430\u043c\u043f\u0443\u0441, \u043d\u043e \u043a\u0430\u043a \u0438 \u0432\u0441\u0435 \u043a\u043e\u0440\u043f\u0443\u0441\u044b \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d \u043d\u0430 \u0443\u043b\u0443\u0447\u0448\u0435\u043d\u0438\u0435 \u0436\u0438\u0437\u043d\u0438 \u043d\u0430\u0448\u0438\u0445 \u0436\u0438\u0442\u0438\u043b\u0435\u0439, \u0437\u0434\u0435\u0441\u044c \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043d\u0430\u0439\u0442\u0438 \u0434\u043b\u044f \u0441\u0435\u0431\u044f \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0441\u0442\u0440\u0438\u0436\u043a\u0438 \u0432 \u0431\u0430\u0440\u0431\u0435\u0440\u0448\u043e\u043f, \u0438\u043b\u0438 \u043f\u043e\u0447\u0435\u0442\u0438\u0442\u044c \u043e\u0434\u043d\u0443 \u0438\u0437 \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0445 \u043a\u043e\u0444\u0435\u0439\u043d Coffee Like'},{id:"Building16",number:16,name:"\u0411\u0410\u0422\u0410\u041b\u041e\u0412\u0410",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u0413\u0430\u043b\u0438\u043d\u044b \u042f\u043a\u043e\u0432\u043b\u0435\u0432\u043d\u044b \u0411\u0430\u0442\u0430\u043b\u043e\u0432\u043e\u0439 (\u0440\u043e\u0434. 1935) - \u0441\u043e\u0432\u0435\u0442\u0441\u043a\u043e\u0439 \u0438 \u0440\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u043e\u0439 \u0442\u0435\u043d\u043d\u0438\u0441\u0438\u0441\u0442\u043a\u0438, \u043c\u043d\u043e\u0433\u043e\u043a\u0440\u0430\u0442\u043d\u043e\u0439 \u0447\u0435\u043c\u043f\u0438\u043e\u043d\u043a\u0438 \u0421\u0421\u0421\u0420, \u0437\u0430\u0441\u043b\u0443\u0436\u0435\u043d\u043d\u043e\u0433\u043e \u043c\u0430\u0441\u0442\u0435\u0440\u0430 \u0441\u043f\u043e\u0440\u0442\u0430. \u0412\u043e\u043f\u043b\u043e\u0449\u0430\u0435\u0442 \u0441\u043f\u043e\u0440\u0442\u0438\u0432\u043d\u044b\u0439 \u0434\u0443\u0445 \u0438 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u044f.",places:'\u041a\u043e\u0440\u043f\u0443\u0441 "\u0411\u0430\u0442\u0430\u043b\u043e\u0432\u0430" \u043d\u0430 \u043f\u0435\u0440\u0432\u043e\u043c \u044d\u0442\u0430\u0436\u0435 \u043e\u0442\u043a\u0440\u044b\u043b \u0432\u044b\u0441\u0442\u0430\u0432\u043a\u0443 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0439, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0442\u0430\u043a\u0436\u0435 \u043f\u043e\u0433\u0440\u0443\u0436\u0430\u0435\u0442 \u043b\u044e\u0431\u043e\u0433\u043e \u0436\u0435\u043b\u0430\u044e\u0449\u0435\u0433\u043e \u0432 IT-\u0430\u0442\u043c\u043e\u0441\u0444\u0435\u0440\u0443, \u043a\u0442\u043e \u0435\u0435 \u043f\u043e\u0441\u0435\u0442\u0438\u0442'},{id:"Building17",number:17,name:"\u0421\u0410\u0425\u0410\u0420\u041e\u0412",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u0410\u043d\u0434\u0440\u0435\u044f \u0414\u043c\u0438\u0442\u0440\u0438\u0435\u0432\u0438\u0447\u0430 \u0421\u0430\u0445\u0430\u0440\u043e\u0432\u0430 (1921-1989) - \u0432\u044b\u0434\u0430\u044e\u0449\u0435\u0433\u043e\u0441\u044f \u0444\u0438\u0437\u0438\u043a\u0430-\u0442\u0435\u043e\u0440\u0435\u0442\u0438\u043a\u0430, \u0430\u043a\u0430\u0434\u0435\u043c\u0438\u043a\u0430, \u0441\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044f \u0441\u043e\u0432\u0435\u0442\u0441\u043a\u043e\u0439 \u0432\u043e\u0434\u043e\u0440\u043e\u0434\u043d\u043e\u0439 \u0431\u043e\u043c\u0431\u044b, \u043b\u0430\u0443\u0440\u0435\u0430\u0442\u0430 \u041d\u043e\u0431\u0435\u043b\u0435\u0432\u0441\u043a\u043e\u0439 \u043f\u0440\u0435\u043c\u0438\u0438 \u043c\u0438\u0440\u0430 \u0437\u0430 1975 \u0433\u043e\u0434. \u0421\u0438\u043c\u0432\u043e\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u043d\u0430\u0443\u0447\u043d\u0443\u044e \u043c\u043e\u0449\u044c \u0438 \u0433\u0440\u0430\u0436\u0434\u0430\u043d\u0441\u043a\u0443\u044e \u043f\u043e\u0437\u0438\u0446\u0438\u044e.",places:'\u0422-\u0431\u0430\u043d\u043a \u0440\u0435\u0448\u0438\u043b \u043f\u043e\u043c\u043e\u0447\u044c \u0440\u0430\u0437\u0432\u0438\u0442\u0438\u044e \u043d\u0430\u0448\u0438\u0445 \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u043e\u0432 \u0432 IT \u0441\u0444\u0435\u0440\u0435, \u0432\u0435\u0434\u044c \u043f\u0440\u044f\u043c\u043e \u0432 \u043a\u043e\u0440\u043f\u0443\u0441\u0435 "\u0410\u0444\u0440\u0438\u043a\u0430\u043d\u043e\u0432" \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u0441\u0435\u0442\u0438\u0442\u044c "IT-\u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438"!'},{id:"Building18",number:18,name:"\u0410\u0424\u0420\u0410\u0419\u041c\u041e\u0412\u0418\u0427",description:"\u041d\u0430\u0437\u0432\u0430\u043d \u0432 \u0447\u0435\u0441\u0442\u044c \u0412\u0438\u043a\u0442\u043e\u0440\u0430 \u0421\u0430\u043c\u0443\u0438\u043b\u043e\u0432\u0438\u0447\u0430 \u0410\u0444\u0440\u0430\u0439\u043c\u043e\u0432\u0438\u0447\u0430 (1945-2018) - \u0441\u043e\u0432\u0435\u0442\u0441\u043a\u043e\u0433\u043e \u0438 \u0440\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u043e\u0433\u043e \u0444\u0438\u0437\u0438\u043a\u0430 \u0438 \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u043a\u0430, \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0441\u0442\u0430 \u0432 \u043e\u0431\u043b\u0430\u0441\u0442\u0438 \u0442\u0435\u043e\u0440\u0438\u0438 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0441\u0438\u0441\u0442\u0435\u043c \u0438 \u0445\u0430\u043e\u0441\u0430. \u0421\u0438\u043c\u0432\u043e\u043b\u0438\u0437\u0438\u0440\u0443\u0435\u0442 \u0441\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0438 \u043a\u0440\u0430\u0441\u043e\u0442\u0443 \u043d\u0435\u043b\u0438\u043d\u0435\u0439\u043d\u044b\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432.",places:""}],mQ=e=>{var n,i,r,s,a;let{scrollerRef:o}=e;const l=(0,t.useRef)(null),c=(0,t.useRef)(null),u=(0,t.useContext)(hQ),d=Ns();(0,t.useEffect)(()=>{u[0]&&(Er.from(".".concat(bP.description_right),{y:"100%",opacity:0,duration:.5,ease:"power1.inOut"}),Er.to(".".concat(bP.description_right),{y:"0",opacity:1,duration:.5,ease:"power1.inOut"}))},[u[0]]),(0,t.useEffect)(()=>{o.current&&(Er.timeline({scrollTrigger:{trigger:l.current,scroller:o.current,start:"top 30%",scrub:!1,once:!0}}).from(".".concat(bP.text_header_animated),{x:"100vw",opacity:0,stagger:.01,duration:.01}).to(".".concat(bP.text_header_animated),{x:0,opacity:1,stagger:.01,duration:.7}),Er.timeline({scrollTrigger:{trigger:l.current,scroller:o.current,start:"top 30%",scrub:!1,once:!0}}).from(".".concat(bP.description_not_building),{x:"100vw",opacity:0,stagger:.01,duration:.01}).to(".".concat(bP.description_not_building),{x:0,opacity:1,stagger:.01,duration:.7}))},[o]);return(0,p.jsx)("section",{ref:l,className:bP.main,children:(0,p.jsxs)("div",{ref:c,className:bP.description_section,children:[(0,p.jsx)("span",{className:bP.hint_span,children:"\u0413\u041e\u0421\u0422\u0418\u041d\u0418\u0426\u0410"}),(0,p.jsx)("h1",{className:bP.header_about,children:"\u0412\u0417\u0413\u041b\u042f\u041d\u0418\u0422\u0415 \u041d\u0410 \u0420\u0410\u0421\u041f\u041e\u041b\u041e\u0416\u0415\u041d\u0418\u0415 \u041d\u0410\u0428\u0418\u0425 \u041a\u041e\u0420\u041f\u0423\u0421\u041e\u0412".split(" ").map((e,t)=>(0,p.jsxs)("span",{className:bP.word,children:[e.split("").map((e,t)=>(0,p.jsx)("span",{className:bP.text_header_animated,children:e},t)),(0,p.jsx)("span",{className:bP.space,children:"\xa0"})]},t))}),(0,p.jsxs)("div",{className:bP.content,children:[(0,p.jsx)("div",{className:bP.content_left,children:(0,p.jsx)(Hq,{shadows:!0,camera:{position:[5,5,5]},children:(0,p.jsxs)(t.Suspense,{fallback:null,children:[(0,p.jsx)("ambientLight",{intensity:1}),(0,p.jsx)(fQ,{url:"/glb/neimark-hotel.glb"}),(0,p.jsx)($q,{enableZoom:!0,minDistance:3,maxDistance:5,minPolarAngle:Math.PI/8,maxPolarAngle:8*Math.PI/18,enablePan:!1,enableRotate:!0})]})})}),(0,p.jsx)("div",{className:bP.content_right,children:u[0]&&pQ.find(e=>e.id===u[0])?(0,p.jsxs)("div",{className:bP.description_right,children:[(0,p.jsxs)("div",{children:["\u041a\u043e\u0440\u043f\u0443\u0441 \u2116","".concat(null===(n=pQ.find(e=>e.id===u[0]))||void 0===n?void 0:n.number,', "').concat(null===(i=pQ.find(e=>e.id===u[0]))||void 0===i?void 0:i.name,'"')]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:bP.description_header,children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),(0,p.jsx)("div",{className:bP.description_text,children:null===(r=pQ.find(e=>e.id===u[0]))||void 0===r?void 0:r.description})]}),(null===(s=pQ.find(e=>e.id===u[0]))||void 0===s?void 0:s.places)&&(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:bP.description_header,children:"\u041e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435"}),(0,p.jsx)("div",{className:bP.description_text,children:null===(a=pQ.find(e=>e.id===u[0]))||void 0===a?void 0:a.places})]}),(0,p.jsx)(zM,{className:bP.button,title:"\u0417\u0430\u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043d\u043e\u043c\u0435\u0440 \u0432 \u044d\u0442\u043e\u043c \u043a\u043e\u0440\u043f\u0443\u0441\u0435",onClick:()=>d("/room")})]}):(0,p.jsxs)("div",{className:bP.description_not_building,children:["\u0412\u0441\u0435 \u043a\u043e\u0440\u043f\u0443\u0441\u0430 \u0433\u043e\u0441\u0442\u0438\u043d\u0438\u0446\u044b \u041d\u0435\u0439\u043c\u0430\u0440\u043a \u043e\u0442\u0432\u0435\u0447\u0430\u044e\u0442 \u0441\u0430\u043c\u044b\u043c \u0441\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u043c \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u0430\u043c, \u0440\u0430\u0439\u043e\u043d \u0433\u043e\u0441\u0442\u0438\u043d\u0438\u0446\u044b \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u043d\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u043a\u043e\u0440\u043f\u0443\u0441\u0430 \u0434\u043b\u044f \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u044f, \u043d\u043e \u0438 \u0431\u043b\u0438\u0437\u043a\u043e\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435 \u0441\u0430\u043c\u044b\u0445 \u0440\u0430\u0437\u043d\u044b\u0445 \u0437\u0430\u0432\u0435\u0434\u0435\u043d\u0438\u0439, \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 \u0438 \u043d\u0435 \u0442\u043e\u043b\u044c\u043a\u043e. ",(0,p.jsx)("span",{className:"".concat(bP.description_not_building_white),children:"\u041d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u0437\u043d\u0430\u043a\u043e\u043c\u0438\u0442\u044c\u0441\u044f \u0441 \u043a\u0430\u0436\u0434\u044b\u043c \u043a\u043e\u0440\u043f\u0443\u0441\u043e\u043c \u043f\u043e\u0431\u043b\u0438\u0436\u0435"})]})})]})]})})},gQ=e=>{let{children:n}=e;const i=(0,t.useState)(null);return(0,p.jsx)(hQ.Provider,{value:i,children:n})},vQ=e=>{Object.assign({},(ja(e),e));const n=(0,t.useContext)(S),i=(0,t.useContext)(x),r=(0,t.useContext)(E),s=(0,t.useRef)(null),a=(0,t.useRef)(null),o=(0,t.useRef)(null),l=(0,t.useRef)(null),c=(0,t.useRef)(null),u=(0,t.useRef)(null);(0,t.useEffect)(()=>{switch("home"===r[0]?i[1]("hidden"):i[1]("home"),r[0]){case"home":{const e=a.current.getBoundingClientRect().top-a.current.parentElement.getBoundingClientRect().top;Er.to(a.current.parentElement,{scrollTop:a.current.parentElement.scrollTop+e,duration:.4,ease:"power2.inOut"})}break;case"about":{const e=o.current.getBoundingClientRect().top-o.current.parentElement.getBoundingClientRect().top;Er.to(o.current.parentElement,{scrollTop:o.current.parentElement.scrollTop+e,duration:.4,ease:"power2.inOut"})}break;case"price":{const e=c.current.getBoundingClientRect().top-c.current.parentElement.getBoundingClientRect().top;Er.to(c.current.parentElement,{scrollTop:c.current.parentElement.scrollTop+e,duration:.4,ease:"power2.inOut"})}break;case"acco":{const e=l.current.getBoundingClientRect().top-l.current.parentElement.getBoundingClientRect().top;Er.to(l.current.parentElement,{scrollTop:l.current.parentElement.scrollTop+e,duration:.4,ease:"power2.inOut"})}break;case"news":{const e=u.current.getBoundingClientRect().top-u.current.parentElement.getBoundingClientRect().top;Er.to(u.current.parentElement,{scrollTop:u.current.parentElement.scrollTop+e,duration:.4,ease:"power2.inOut"})}}},[r]);return(0,p.jsx)("main",{className:Ya,children:(0,p.jsxs)("div",{ref:s,className:Xa,onScroll:e=>{a.current.getBoundingClientRect().top,e.currentTarget.getBoundingClientRect().top;const t=o.current.getBoundingClientRect().top-e.currentTarget.getBoundingClientRect().top,i=l.current.getBoundingClientRect().top-e.currentTarget.getBoundingClientRect().top,r=c.current.getBoundingClientRect().top-e.currentTarget.getBoundingClientRect().top;u.current.getBoundingClientRect().top-e.currentTarget.getBoundingClientRect().top<400?n[1]("news"):r<400?n[1]("price"):i<400?n[1]("acco"):t<400?n[1]("about"):n[1]("home")},children:[(0,p.jsx)("div",{ref:a,className:Ka}),(0,p.jsx)(lR,{scrollerRef:s}),(0,p.jsx)("div",{ref:o,className:Ka}),(0,p.jsx)(pR,{scrollerRef:s}),(0,p.jsx)("div",{ref:l,className:Ka}),(0,p.jsx)(AR,{scrollerRef:s}),(0,p.jsx)("div",{ref:c,className:Ka}),(0,p.jsx)(RL,{scrollerRef:s}),(0,p.jsx)(jL,{scrollerRef:s}),(0,p.jsx)(gQ,{children:(0,p.jsx)(mQ,{scrollerRef:s})}),(0,p.jsx)("div",{ref:u,className:Ka}),(0,p.jsx)(hP,{scrollerRef:s}),(0,p.jsx)(_P,{})]})})},yQ=e=>{let{children:n}=e;const i=(0,t.useState)("hidden");return(0,p.jsx)(x.Provider,{value:i,children:n})},_Q=e=>{let{children:n}=e;const i=(0,t.useState)("home");return(0,p.jsx)(S.Provider,{value:i,children:n})},bQ=e=>{let{children:n}=e;const i=(0,t.useState)("home");return(0,p.jsx)(E.Provider,{value:i,children:n})},xQ="RoomPageComponent_main__DgYZO",SQ="RoomPageComponent_description__B9KNQ",EQ="RoomPageComponent_image__dqhL9",wQ="RoomPageComponent_view__HgBBg",TQ="RoomPageComponent_overlay_blur__mSoGo",MQ="RoomPageComponent_switch__V0UeK",AQ="RoomPageComponent_layout__DmJHZ",CQ="RoomPageComponent_header__b2GuY",RQ="RoomPageComponent_balcony__Wqe1K",LQ="RoomPageComponent_title__dOLOA",PQ="RoomPageComponent_price_container__-5vRr",IQ="RoomPageComponent_price__yG-hu",DQ="RoomPageComponent_description_about__hvB+f",kQ="RoomPageComponent_description_text__yEG7A",OQ="RoomPageComponent_button_container__BULef",NQ="RoomPageComponent_button__a40pq",FQ="RoomPageComponent_active__F75u8";const BQ=n.p+"static/media/room-alpha.1c15eb69d05a2772d53648af4117558e.svg",UQ=n.p+"static/media/room1.f642d27cb6667a8c2bad.jpg",HQ=n.p+"static/media/room2.df3144dc139f3652b155.jpg",zQ=n.p+"static/media/room3.0a5191bb3a403ad9369d.jpg";const GQ=n.p+"static/media/marker.30f75dde91b93fc2b372b5925522e32b.svg";function VQ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function WQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jQ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function YQ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jQ(Object(n),!0).forEach(function(t){WQ(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jQ(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function XQ(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=s.call(n)).done)&&(o.push(i.value),o.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return VQ(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?VQ(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function KQ(e){return KQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},KQ(e)}const qQ="179",JQ=0,QQ=1,ZQ=2,$Q=100,eZ=101,tZ=102,nZ=200,iZ=201,rZ=202,sZ=203,aZ=204,oZ=205,lZ=206,cZ=207,uZ=208,dZ=209,hZ=210,fZ=211,pZ=212,mZ=213,gZ=214,vZ=0,yZ=1,_Z=2,bZ=3,xZ=4,SZ=5,EZ=6,wZ=7,TZ=301,MZ=302,AZ=303,CZ=304,RZ=306,LZ=1e3,PZ=1001,IZ=1002,DZ=1003,kZ=1004,OZ=1005,NZ=1006,FZ=1007,BZ=1008,UZ=1009,HZ=1010,zZ=1011,GZ=1012,VZ=1013,WZ=1014,jZ=1015,YZ=1016,XZ=1017,KZ=1018,qZ=1020,JZ=35902,QZ=1023,ZZ=1026,$Z=1027,e$=1028,t$=1029,n$=1031,i$=1033,r$=33776,s$=33777,a$=33778,o$=33779,l$=35840,c$=35841,u$=35842,d$=35843,h$=36196,f$=37492,p$=37496,m$=37808,g$=37809,v$=37810,y$=37811,_$=37812,b$=37813,x$=37814,S$=37815,E$=37816,w$=37817,T$=37818,M$=37819,A$=37820,C$=37821,R$=36492,L$=36494,P$=36495,I$=36284,D$=36285,k$=36286,O$=2300,N$=2301,F$=2302,B$=2400,U$=2401,H$=2402,z$="",G$="srgb",V$="srgb-linear",W$="linear",j$="srgb",Y$=7680,X$=512,K$=513,q$=514,J$=515,Q$=516,Z$=517,$$=518,e0=519,t0=35044,n0="300 es",i0=2e3,r0=2001;class s0{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return void 0!==n&&(void 0!==n[e]&&-1!==n[e].indexOf(t))}removeEventListener(e,t){const n=this._listeners;if(void 0===n)return;const i=n[e];if(void 0!==i){const e=i.indexOf(t);-1!==e&&i.splice(e,1)}}dispatchEvent(e){const t=this._listeners;if(void 0===t)return;const n=t[e.type];if(void 0!==n){e.target=this;const t=n.slice(0);for(let n=0,i=t.length;n<i;n++)t[n].call(this,e);e.target=null}}}const a0=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let o0=1234567;const l0=Math.PI/180,c0=180/Math.PI;function u0(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(a0[255&e]+a0[e>>8&255]+a0[e>>16&255]+a0[e>>24&255]+"-"+a0[255&t]+a0[t>>8&255]+"-"+a0[t>>16&15|64]+a0[t>>24&255]+"-"+a0[63&n|128]+a0[n>>8&255]+"-"+a0[n>>16&255]+a0[n>>24&255]+a0[255&i]+a0[i>>8&255]+a0[i>>16&255]+a0[i>>24&255]).toLowerCase()}function d0(e,t,n){return Math.max(t,Math.min(n,e))}function h0(e,t){return(e%t+t)%t}function f0(e,t,n){return(1-n)*e+n*t}function p0(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function m0(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const g0={DEG2RAD:l0,RAD2DEG:c0,generateUUID:u0,clamp:d0,euclideanModulo:h0,mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:f0,damp:function(e,t,n,i){return f0(e,t,1-Math.exp(-n*i))},pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(h0(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(o0=e);let t=o0+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*l0},radToDeg:function(e){return e*c0},isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,i,r){const s=Math.cos,a=Math.sin,o=s(n/2),l=a(n/2),c=s((t+i)/2),u=a((t+i)/2),d=s((t-i)/2),h=a((t-i)/2),f=s((i-t)/2),p=a((i-t)/2);switch(r){case"XYX":e.set(o*u,l*d,l*h,o*c);break;case"YZY":e.set(l*h,o*u,l*d,o*c);break;case"ZXZ":e.set(l*d,l*h,o*u,o*c);break;case"XZX":e.set(o*u,l*p,l*f,o*c);break;case"YXY":e.set(l*f,o*u,l*p,o*c);break;case"ZYZ":e.set(l*p,l*f,o*u,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:m0,denormalize:p0};class v0{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;v0.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=d0(this.x,e.x,t.x),this.y=d0(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=d0(this.x,e,t),this.y=d0(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(d0(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(d0(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*n-s*i+e.x,this.y=r*i+s*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class y0{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,r,s,a){let o=n[i+0],l=n[i+1],c=n[i+2],u=n[i+3];const d=r[s+0],h=r[s+1],f=r[s+2],p=r[s+3];if(0===a)return e[t+0]=o,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===a)return e[t+0]=d,e[t+1]=h,e[t+2]=f,void(e[t+3]=p);if(u!==p||o!==d||l!==h||c!==f){let e=1-a;const t=o*d+l*h+c*f+u*p,n=t>=0?1:-1,i=1-t*t;if(i>Number.EPSILON){const r=Math.sqrt(i),s=Math.atan2(r,t*n);e=Math.sin(e*s)/r,a=Math.sin(a*s)/r}const r=a*n;if(o=o*e+d*r,l=l*e+h*r,c=c*e+f*r,u=u*e+p*r,e===1-a){const e=1/Math.sqrt(o*o+l*l+c*c+u*u);o*=e,l*=e,c*=e,u*=e}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,i,r,s){const a=n[i],o=n[i+1],l=n[i+2],c=n[i+3],u=r[s],d=r[s+1],h=r[s+2],f=r[s+3];return e[t]=a*f+c*u+o*h-l*d,e[t+1]=o*f+c*d+l*u-a*h,e[t+2]=l*f+c*h+a*d-o*u,e[t+3]=c*f-a*u-o*d-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e._x,i=e._y,r=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(n/2),c=a(i/2),u=a(r/2),d=o(n/2),h=o(i/2),f=o(r/2);switch(s){case"XYZ":this._x=d*c*u+l*h*f,this._y=l*h*u-d*c*f,this._z=l*c*f+d*h*u,this._w=l*c*u-d*h*f;break;case"YXZ":this._x=d*c*u+l*h*f,this._y=l*h*u-d*c*f,this._z=l*c*f-d*h*u,this._w=l*c*u+d*h*f;break;case"ZXY":this._x=d*c*u-l*h*f,this._y=l*h*u+d*c*f,this._z=l*c*f+d*h*u,this._w=l*c*u-d*h*f;break;case"ZYX":this._x=d*c*u-l*h*f,this._y=l*h*u+d*c*f,this._z=l*c*f-d*h*u,this._w=l*c*u+d*h*f;break;case"YZX":this._x=d*c*u+l*h*f,this._y=l*h*u+d*c*f,this._z=l*c*f-d*h*u,this._w=l*c*u-d*h*f;break;case"XZY":this._x=d*c*u-l*h*f,this._y=l*h*u-d*c*f,this._z=l*c*f+d*h*u,this._w=l*c*u+d*h*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],r=t[8],s=t[1],a=t[5],o=t[9],l=t[2],c=t[6],u=t[10],d=n+a+u;if(d>0){const e=.5/Math.sqrt(d+1);this._w=.25/e,this._x=(c-o)*e,this._y=(r-l)*e,this._z=(s-i)*e}else if(n>a&&n>u){const e=2*Math.sqrt(1+n-a-u);this._w=(c-o)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(r+l)/e}else if(a>u){const e=2*Math.sqrt(1+a-n-u);this._w=(r-l)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(o+c)/e}else{const e=2*Math.sqrt(1+u-n-a);this._w=(s-i)/e,this._x=(r+l)/e,this._y=(o+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(d0(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,r=e._z,s=e._w,a=t._x,o=t._y,l=t._z,c=t._w;return this._x=n*c+s*a+i*l-r*o,this._y=i*c+s*o+r*a-n*l,this._z=r*c+s*l+n*o-i*a,this._w=s*c-n*a-i*o-r*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,i=this._y,r=this._z,s=this._w;let a=s*e._w+n*e._x+i*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;const o=1-a*a;if(o<=Number.EPSILON){const e=1-t;return this._w=e*s+t*this._w,this._x=e*n+t*this._x,this._y=e*i+t*this._y,this._z=e*r+t*this._z,this.normalize(),this}const l=Math.sqrt(o),c=Math.atan2(l,a),u=Math.sin((1-t)*c)/l,d=Math.sin(t*c)/l;return this._w=s*u+this._w*d,this._x=n*u+this._x*d,this._y=i*u+this._y*d,this._z=r*u+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(i*Math.sin(e),i*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class _0{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;_0.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(x0.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(x0.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=e.elements,s=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,r=e.x,s=e.y,a=e.z,o=e.w,l=2*(s*i-a*n),c=2*(a*t-r*i),u=2*(r*n-s*t);return this.x=t+o*l+s*u-a*c,this.y=n+o*c+a*l-r*u,this.z=i+o*u+r*c-s*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=d0(this.x,e.x,t.x),this.y=d0(this.y,e.y,t.y),this.z=d0(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=d0(this.x,e,t),this.y=d0(this.y,e,t),this.z=d0(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(d0(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,r=e.z,s=t.x,a=t.y,o=t.z;return this.x=i*o-r*a,this.y=r*s-n*o,this.z=n*a-i*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return b0.copy(this).projectOnVector(e),this.sub(b0)}reflect(e){return this.sub(b0.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(d0(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const b0=new _0,x0=new y0;class S0{constructor(e,t,n,i,r,s,a,o,l){S0.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,i,r,s,a,o,l)}set(e,t,n,i,r,s,a,o,l){const c=this.elements;return c[0]=e,c[1]=i,c[2]=a,c[3]=t,c[4]=r,c[5]=o,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],a=n[3],o=n[6],l=n[1],c=n[4],u=n[7],d=n[2],h=n[5],f=n[8],p=i[0],m=i[3],g=i[6],v=i[1],y=i[4],_=i[7],b=i[2],x=i[5],S=i[8];return r[0]=s*p+a*v+o*b,r[3]=s*m+a*y+o*x,r[6]=s*g+a*_+o*S,r[1]=l*p+c*v+u*b,r[4]=l*m+c*y+u*x,r[7]=l*g+c*_+u*S,r[2]=d*p+h*v+f*b,r[5]=d*m+h*y+f*x,r[8]=d*g+h*_+f*S,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*s*c-t*a*l-n*r*c+n*a*o+i*r*l-i*s*o}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=c*s-a*l,d=a*o-c*r,h=l*r-s*o,f=t*u+n*d+i*h;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const p=1/f;return e[0]=u*p,e[1]=(i*l-c*n)*p,e[2]=(a*n-i*s)*p,e[3]=d*p,e[4]=(c*t-i*o)*p,e[5]=(i*r-a*t)*p,e[6]=h*p,e[7]=(n*o-l*t)*p,e[8]=(s*t-n*r)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,r,s,a){const o=Math.cos(r),l=Math.sin(r);return this.set(n*o,n*l,-n*(o*s+l*a)+s+e,-i*l,i*o,-i*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(E0.makeScale(e,t)),this}rotate(e){return this.premultiply(E0.makeRotation(-e)),this}translate(e,t){return this.premultiply(E0.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const E0=new S0;function w0(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function T0(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function M0(){const e=T0("canvas");return e.style.display="block",e}const A0={};function C0(e){e in A0||(A0[e]=!0,console.warn(e))}const R0=(new S0).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),L0=(new S0).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function P0(){const e={enabled:!0,workingColorSpace:V$,spaces:{},convert:function(e,t,n){return!1!==this.enabled&&t!==n&&t&&n?(this.spaces[t].transfer===j$&&(e.r=D0(e.r),e.g=D0(e.g),e.b=D0(e.b)),this.spaces[t].primaries!==this.spaces[n].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===j$&&(e.r=k0(e.r),e.g=k0(e.g),e.b=k0(e.b)),e):e},workingToColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},colorSpaceToWorking:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return e===z$?W$:this.spaces[e].transfer},getLuminanceCoefficients:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.workingColorSpace;return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,n){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.workingColorSpace;return this.spaces[e].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(t,n){return C0("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),e.workingToColorSpace(t,n)},toWorkingColorSpace:function(t,n){return C0("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),e.colorSpaceToWorking(t,n)}},t=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],i=[.3127,.329];return e.define({[V$]:{primaries:t,whitePoint:i,transfer:W$,toXYZ:R0,fromXYZ:L0,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:G$},outputColorSpaceConfig:{drawingBufferColorSpace:G$}},[G$]:{primaries:t,whitePoint:i,transfer:j$,toXYZ:R0,fromXYZ:L0,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:G$}}}),e}const I0=P0();function D0(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function k0(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let O0;class N0{static getDataURL(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png";if(/^data:/i.test(e.src))return e.src;if("undefined"===typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===O0&&(O0=T0("canvas")),O0.width=e.width,O0.height=e.height;const n=O0.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=O0}return t.toDataURL(n)}static sRGBToLinear(e){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){const t=T0("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),r=i.data;for(let e=0;e<r.length;e++)r[e]=255*D0(r[e]/255);return n.putImageData(i,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*D0(t[e]/255)):t[e]=D0(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let F0=0;class B0{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,Object.defineProperty(this,"id",{value:F0++}),this.uuid=u0(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):null!==t?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)i[t].isDataTexture?e.push(U0(i[t].image)):e.push(U0(i[t]))}else e=U0(i);n.url=e}return t||(e.images[this.uuid]=n),n}}function U0(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?N0.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let H0=0;const z0=new _0;class G0 extends s0{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G0.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G0.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:PZ,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:PZ,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:NZ,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:BZ,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:QZ,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:UZ,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:G0.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:z$;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:H0++}),this.uuid=u0(),this.name="",this.source=new B0(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new v0(0,0),this.repeat=new v0(1,1),this.center=new v0(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new S0,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(z0).x}get height(){return this.source.getSize(z0).y}get depth(){return this.source.getSize(z0).z}get image(){return this.source.data}set image(e){void 0===e&&(e=null),this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Texture.setValues(): parameter '".concat(t,"' has value of undefined."));continue}const i=this[t];void 0!==i?i&&n&&i.isVector2&&n.isVector2||i&&n&&i.isVector3&&n.isVector3||i&&n&&i.isMatrix3&&n.isMatrix3?i.copy(n):this[t]=n:console.warn("THREE.Texture.setValues(): property '".concat(t,"' does not exist."))}}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case LZ:e.x=e.x-Math.floor(e.x);break;case PZ:e.x=e.x<0?0:1;break;case IZ:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case LZ:e.y=e.y-Math.floor(e.y);break;case PZ:e.y=e.y<0?0:1;break;case IZ:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}G0.DEFAULT_IMAGE=null,G0.DEFAULT_MAPPING=300,G0.DEFAULT_ANISOTROPY=1;class V0{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;V0.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*t+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*t+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*t+s[7]*n+s[11]*i+s[15]*r,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,r;const s=.01,a=.1,o=e.elements,l=o[0],c=o[4],u=o[8],d=o[1],h=o[5],f=o[9],p=o[2],m=o[6],g=o[10];if(Math.abs(c-d)<s&&Math.abs(u-p)<s&&Math.abs(f-m)<s){if(Math.abs(c+d)<a&&Math.abs(u+p)<a&&Math.abs(f+m)<a&&Math.abs(l+h+g-3)<a)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,o=(h+1)/2,v=(g+1)/2,y=(c+d)/4,_=(u+p)/4,b=(f+m)/4;return e>o&&e>v?e<s?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(e),i=y/n,r=_/n):o>v?o<s?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(o),n=y/i,r=b/i):v<s?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(v),n=_/r,i=b/r),this.set(n,i,r,t),this}let v=Math.sqrt((m-f)*(m-f)+(u-p)*(u-p)+(d-c)*(d-c));return Math.abs(v)<.001&&(v=1),this.x=(m-f)/v,this.y=(u-p)/v,this.z=(d-c)/v,this.w=Math.acos((l+h+g-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=d0(this.x,e.x,t.x),this.y=d0(this.y,e.y,t.y),this.z=d0(this.z,e.z,t.z),this.w=d0(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=d0(this.x,e,t),this.y=d0(this.y,e,t),this.z=d0(this.z,e,t),this.w=d0(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(d0(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class W0 extends s0{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:NZ,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new V0(0,0,e,t),this.scissorTest=!1,this.viewport=new V0(0,0,e,t);const i={width:e,height:t,depth:n.depth},r=new G0(i);this.textures=[];const s=n.count;for(let a=0;a<s;a++)this.textures[a]=r.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={minFilter:NZ,generateMipmaps:!1,flipY:!1,internalFormat:null};void 0!==e.mapping&&(t.mapping=e.mapping),void 0!==e.wrapS&&(t.wrapS=e.wrapS),void 0!==e.wrapT&&(t.wrapT=e.wrapT),void 0!==e.wrapR&&(t.wrapR=e.wrapR),void 0!==e.magFilter&&(t.magFilter=e.magFilter),void 0!==e.minFilter&&(t.minFilter=e.minFilter),void 0!==e.format&&(t.format=e.format),void 0!==e.type&&(t.type=e.type),void 0!==e.anisotropy&&(t.anisotropy=e.anisotropy),void 0!==e.colorSpace&&(t.colorSpace=e.colorSpace),void 0!==e.flipY&&(t.flipY=e.flipY),void 0!==e.generateMipmaps&&(t.generateMipmaps=e.generateMipmaps),void 0!==e.internalFormat&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++){this.textures[n].setValues(t)}}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,r=this.textures.length;i<r;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=n,this.textures[i].isArrayTexture=this.textures[i].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const n=Object.assign({},e.textures[t].image);this.textures[t].source=new B0(n)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class j0 extends W0{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.isWebGLRenderTarget=!0}}class Y0 extends G0{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=DZ,this.minFilter=DZ,this.wrapR=PZ,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class X0 extends G0{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=DZ,this.minFilter=DZ,this.wrapR=PZ,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class K0{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _0(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _0(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(J0.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(J0.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=J0.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const i=n.getAttribute("position");if(!0===t&&void 0!==i&&!0!==e.isInstancedMesh)for(let t=0,n=i.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,J0):J0.fromBufferAttribute(i,t),J0.applyMatrix4(e.matrixWorld),this.expandByPoint(J0);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),Q0.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),Q0.copy(n.boundingBox)),Q0.applyMatrix4(e.matrixWorld),this.union(Q0)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,J0),J0.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(r1),s1.subVectors(this.max,r1),Z0.subVectors(e.a,r1),$0.subVectors(e.b,r1),e1.subVectors(e.c,r1),t1.subVectors($0,Z0),n1.subVectors(e1,$0),i1.subVectors(Z0,e1);let t=[0,-t1.z,t1.y,0,-n1.z,n1.y,0,-i1.z,i1.y,t1.z,0,-t1.x,n1.z,0,-n1.x,i1.z,0,-i1.x,-t1.y,t1.x,0,-n1.y,n1.x,0,-i1.y,i1.x,0];return!!l1(t,Z0,$0,e1,s1)&&(t=[1,0,0,0,1,0,0,0,1],!!l1(t,Z0,$0,e1,s1)&&(a1.crossVectors(t1,n1),t=[a1.x,a1.y,a1.z],l1(t,Z0,$0,e1,s1)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,J0).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(J0).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(q0[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),q0[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),q0[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),q0[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),q0[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),q0[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),q0[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),q0[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(q0)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const q0=[new _0,new _0,new _0,new _0,new _0,new _0,new _0,new _0],J0=new _0,Q0=new K0,Z0=new _0,$0=new _0,e1=new _0,t1=new _0,n1=new _0,i1=new _0,r1=new _0,s1=new _0,a1=new _0,o1=new _0;function l1(e,t,n,i,r){for(let s=0,a=e.length-3;s<=a;s+=3){o1.fromArray(e,s);const a=r.x*Math.abs(o1.x)+r.y*Math.abs(o1.y)+r.z*Math.abs(o1.z),o=t.dot(o1),l=n.dot(o1),c=i.dot(o1);if(Math.max(-Math.max(o,l,c),Math.min(o,l,c))>a)return!1}return!0}const c1=new K0,u1=new _0,d1=new _0;class h1{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):c1.setFromPoints(e).getCenter(n);let i=0;for(let r=0,s=e.length;r<s;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;u1.subVectors(e,this.center);const t=u1.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(u1,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(d1.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(u1.copy(e.center).add(d1)),this.expandByPoint(u1.copy(e.center).sub(d1))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const f1=new _0,p1=new _0,m1=new _0,g1=new _0,v1=new _0,y1=new _0,_1=new _0;class b1{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _0(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,f1)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=f1.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(f1.copy(this.origin).addScaledVector(this.direction,t),f1.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){p1.copy(e).add(t).multiplyScalar(.5),m1.copy(t).sub(e).normalize(),g1.copy(this.origin).sub(p1);const r=.5*e.distanceTo(t),s=-this.direction.dot(m1),a=g1.dot(this.direction),o=-g1.dot(m1),l=g1.lengthSq(),c=Math.abs(1-s*s);let u,d,h,f;if(c>0)if(u=s*o-a,d=s*a-o,f=r*c,u>=0)if(d>=-f)if(d<=f){const e=1/c;u*=e,d*=e,h=u*(u+s*d+2*a)+d*(s*u+d+2*o)+l}else d=r,u=Math.max(0,-(s*d+a)),h=-u*u+d*(d+2*o)+l;else d=-r,u=Math.max(0,-(s*d+a)),h=-u*u+d*(d+2*o)+l;else d<=-f?(u=Math.max(0,-(-s*r+a)),d=u>0?-r:Math.min(Math.max(-r,-o),r),h=-u*u+d*(d+2*o)+l):d<=f?(u=0,d=Math.min(Math.max(-r,-o),r),h=d*(d+2*o)+l):(u=Math.max(0,-(s*r+a)),d=u>0?r:Math.min(Math.max(-r,-o),r),h=-u*u+d*(d+2*o)+l);else d=s>0?-r:r,u=Math.max(0,-(s*d+a)),h=-u*u+d*(d+2*o)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,u),i&&i.copy(p1).addScaledVector(m1,d),h}intersectSphere(e,t){f1.subVectors(e.center,this.origin);const n=f1.dot(this.direction),i=f1.dot(f1)-n*n,r=e.radius*e.radius;if(i>r)return null;const s=Math.sqrt(r-i),a=n-s,o=n+s;return o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return!(e.radius<0)&&this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,r,s,a,o;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,d=this.origin;return l>=0?(n=(e.min.x-d.x)*l,i=(e.max.x-d.x)*l):(n=(e.max.x-d.x)*l,i=(e.min.x-d.x)*l),c>=0?(r=(e.min.y-d.y)*c,s=(e.max.y-d.y)*c):(r=(e.max.y-d.y)*c,s=(e.min.y-d.y)*c),n>s||r>i?null:((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),u>=0?(a=(e.min.z-d.z)*u,o=(e.max.z-d.z)*u):(a=(e.max.z-d.z)*u,o=(e.min.z-d.z)*u),n>o||a>i?null:((a>n||n!==n)&&(n=a),(o<i||i!==i)&&(i=o),i<0?null:this.at(n>=0?n:i,t)))}intersectsBox(e){return null!==this.intersectBox(e,f1)}intersectTriangle(e,t,n,i,r){v1.subVectors(t,e),y1.subVectors(n,e),_1.crossVectors(v1,y1);let s,a=this.direction.dot(_1);if(a>0){if(i)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}g1.subVectors(this.origin,e);const o=s*this.direction.dot(y1.crossVectors(g1,y1));if(o<0)return null;const l=s*this.direction.dot(v1.cross(g1));if(l<0)return null;if(o+l>a)return null;const c=-s*g1.dot(_1);return c<0?null:this.at(c/a,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class x1{constructor(e,t,n,i,r,s,a,o,l,c,u,d,h,f,p,m){x1.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,i,r,s,a,o,l,c,u,d,h,f,p,m)}set(e,t,n,i,r,s,a,o,l,c,u,d,h,f,p,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=r,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=c,g[10]=u,g[14]=d,g[3]=h,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new x1).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/S1.setFromMatrixColumn(e,0).length(),r=1/S1.setFromMatrixColumn(e,1).length(),s=1/S1.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*s,t[9]=n[9]*s,t[10]=n[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,r=e.z,s=Math.cos(n),a=Math.sin(n),o=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if("XYZ"===e.order){const e=s*c,n=s*u,i=a*c,r=a*u;t[0]=o*c,t[4]=-o*u,t[8]=l,t[1]=n+i*l,t[5]=e-r*l,t[9]=-a*o,t[2]=r-e*l,t[6]=i+n*l,t[10]=s*o}else if("YXZ"===e.order){const e=o*c,n=o*u,i=l*c,r=l*u;t[0]=e+r*a,t[4]=i*a-n,t[8]=s*l,t[1]=s*u,t[5]=s*c,t[9]=-a,t[2]=n*a-i,t[6]=r+e*a,t[10]=s*o}else if("ZXY"===e.order){const e=o*c,n=o*u,i=l*c,r=l*u;t[0]=e-r*a,t[4]=-s*u,t[8]=i+n*a,t[1]=n+i*a,t[5]=s*c,t[9]=r-e*a,t[2]=-s*l,t[6]=a,t[10]=s*o}else if("ZYX"===e.order){const e=s*c,n=s*u,i=a*c,r=a*u;t[0]=o*c,t[4]=i*l-n,t[8]=e*l+r,t[1]=o*u,t[5]=r*l+e,t[9]=n*l-i,t[2]=-l,t[6]=a*o,t[10]=s*o}else if("YZX"===e.order){const e=s*o,n=s*l,i=a*o,r=a*l;t[0]=o*c,t[4]=r-e*u,t[8]=i*u+n,t[1]=u,t[5]=s*c,t[9]=-a*c,t[2]=-l*c,t[6]=n*u+i,t[10]=e-r*u}else if("XZY"===e.order){const e=s*o,n=s*l,i=a*o,r=a*l;t[0]=o*c,t[4]=-u,t[8]=l*c,t[1]=e*u+r,t[5]=s*c,t[9]=n*u-i,t[2]=i*u-n,t[6]=a*c,t[10]=r*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(w1,e,T1)}lookAt(e,t,n){const i=this.elements;return C1.subVectors(e,t),0===C1.lengthSq()&&(C1.z=1),C1.normalize(),M1.crossVectors(n,C1),0===M1.lengthSq()&&(1===Math.abs(n.z)?C1.x+=1e-4:C1.z+=1e-4,C1.normalize(),M1.crossVectors(n,C1)),M1.normalize(),A1.crossVectors(C1,M1),i[0]=M1.x,i[4]=A1.x,i[8]=C1.x,i[1]=M1.y,i[5]=A1.y,i[9]=C1.y,i[2]=M1.z,i[6]=A1.z,i[10]=C1.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],a=n[4],o=n[8],l=n[12],c=n[1],u=n[5],d=n[9],h=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],b=n[15],x=i[0],S=i[4],E=i[8],w=i[12],T=i[1],M=i[5],A=i[9],C=i[13],R=i[2],L=i[6],P=i[10],I=i[14],D=i[3],k=i[7],O=i[11],N=i[15];return r[0]=s*x+a*T+o*R+l*D,r[4]=s*S+a*M+o*L+l*k,r[8]=s*E+a*A+o*P+l*O,r[12]=s*w+a*C+o*I+l*N,r[1]=c*x+u*T+d*R+h*D,r[5]=c*S+u*M+d*L+h*k,r[9]=c*E+u*A+d*P+h*O,r[13]=c*w+u*C+d*I+h*N,r[2]=f*x+p*T+m*R+g*D,r[6]=f*S+p*M+m*L+g*k,r[10]=f*E+p*A+m*P+g*O,r[14]=f*w+p*C+m*I+g*N,r[3]=v*x+y*T+_*R+b*D,r[7]=v*S+y*M+_*L+b*k,r[11]=v*E+y*A+_*P+b*O,r[15]=v*w+y*C+_*I+b*N,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],s=e[1],a=e[5],o=e[9],l=e[13],c=e[2],u=e[6],d=e[10],h=e[14];return e[3]*(+r*o*u-i*l*u-r*a*d+n*l*d+i*a*h-n*o*h)+e[7]*(+t*o*h-t*l*d+r*s*d-i*s*h+i*l*c-r*o*c)+e[11]*(+t*l*u-t*a*h-r*s*u+n*s*h+r*a*c-n*l*c)+e[15]*(-i*a*c-t*o*u+t*a*d+i*s*u-n*s*d+n*o*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=e[9],d=e[10],h=e[11],f=e[12],p=e[13],m=e[14],g=e[15],v=u*m*l-p*d*l+p*o*h-a*m*h-u*o*g+a*d*g,y=f*d*l-c*m*l-f*o*h+s*m*h+c*o*g-s*d*g,_=c*p*l-f*u*l+f*a*h-s*p*h-c*a*g+s*u*g,b=f*u*o-c*p*o-f*a*d+s*p*d+c*a*m-s*u*m,x=t*v+n*y+i*_+r*b;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const S=1/x;return e[0]=v*S,e[1]=(p*d*r-u*m*r-p*i*h+n*m*h+u*i*g-n*d*g)*S,e[2]=(a*m*r-p*o*r+p*i*l-n*m*l-a*i*g+n*o*g)*S,e[3]=(u*o*r-a*d*r-u*i*l+n*d*l+a*i*h-n*o*h)*S,e[4]=y*S,e[5]=(c*m*r-f*d*r+f*i*h-t*m*h-c*i*g+t*d*g)*S,e[6]=(f*o*r-s*m*r-f*i*l+t*m*l+s*i*g-t*o*g)*S,e[7]=(s*d*r-c*o*r+c*i*l-t*d*l-s*i*h+t*o*h)*S,e[8]=_*S,e[9]=(f*u*r-c*p*r-f*n*h+t*p*h+c*n*g-t*u*g)*S,e[10]=(s*p*r-f*a*r+f*n*l-t*p*l-s*n*g+t*a*g)*S,e[11]=(c*a*r-s*u*r-c*n*l+t*u*l+s*n*h-t*a*h)*S,e[12]=b*S,e[13]=(c*p*i-f*u*i+f*n*d-t*p*d-c*n*m+t*u*m)*S,e[14]=(f*a*i-s*p*i-f*n*o+t*p*o+s*n*m-t*a*m)*S,e[15]=(s*u*i-c*a*i+c*n*o-t*u*o-s*n*d+t*a*d)*S,this}scale(e){const t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),r=1-n,s=e.x,a=e.y,o=e.z,l=r*s,c=r*a;return this.set(l*s+n,l*a-i*o,l*o+i*a,0,l*a+i*o,c*a+n,c*o-i*s,0,l*o-i*a,c*o+i*s,r*o*o+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,r,s){return this.set(1,n,r,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,r=t._x,s=t._y,a=t._z,o=t._w,l=r+r,c=s+s,u=a+a,d=r*l,h=r*c,f=r*u,p=s*c,m=s*u,g=a*u,v=o*l,y=o*c,_=o*u,b=n.x,x=n.y,S=n.z;return i[0]=(1-(p+g))*b,i[1]=(h+_)*b,i[2]=(f-y)*b,i[3]=0,i[4]=(h-_)*x,i[5]=(1-(d+g))*x,i[6]=(m+v)*x,i[7]=0,i[8]=(f+y)*S,i[9]=(m-v)*S,i[10]=(1-(d+p))*S,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let r=S1.set(i[0],i[1],i[2]).length();const s=S1.set(i[4],i[5],i[6]).length(),a=S1.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],E1.copy(this);const o=1/r,l=1/s,c=1/a;return E1.elements[0]*=o,E1.elements[1]*=o,E1.elements[2]*=o,E1.elements[4]*=l,E1.elements[5]*=l,E1.elements[6]*=l,E1.elements[8]*=c,E1.elements[9]*=c,E1.elements[10]*=c,t.setFromRotationMatrix(E1),n.x=r,n.y=s,n.z=a,this}makePerspective(e,t,n,i,r,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:i0,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=this.elements,c=2*r/(t-e),u=2*r/(n-i),d=(t+e)/(t-e),h=(n+i)/(n-i);let f,p;if(o)f=r/(s-r),p=s*r/(s-r);else if(a===i0)f=-(s+r)/(s-r),p=-2*s*r/(s-r);else{if(a!==r0)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);f=-s/(s-r),p=-s*r/(s-r)}return l[0]=c,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=u,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,i,r,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:i0,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=this.elements,c=2/(t-e),u=2/(n-i),d=-(t+e)/(t-e),h=-(n+i)/(n-i);let f,p;if(o)f=1/(s-r),p=s/(s-r);else if(a===i0)f=-2/(s-r),p=-(s+r)/(s-r);else{if(a!==r0)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);f=-1/(s-r),p=-r/(s-r)}return l[0]=c,l[4]=0,l[8]=0,l[12]=d,l[1]=0,l[5]=u,l[9]=0,l[13]=h,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const S1=new _0,E1=new x1,w1=new _0(0,0,0),T1=new _0(1,1,1),M1=new _0,A1=new _0,C1=new _0,R1=new x1,L1=new y0;class P1{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:P1.DEFAULT_ORDER;this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=e.elements,r=i[0],s=i[4],a=i[8],o=i[1],l=i[5],c=i[9],u=i[2],d=i[6],h=i[10];switch(t){case"XYZ":this._y=Math.asin(d0(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-d0(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,h),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(d0(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,h),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,r));break;case"ZYX":this._y=Math.asin(-d0(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,h),this._z=Math.atan2(o,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(d0(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(a,h));break;case"XZY":this._z=Math.asin(-d0(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-c,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return R1.makeRotationFromQuaternion(e),this.setFromRotationMatrix(R1,t,n)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return L1.setFromEuler(this),this.setFromQuaternion(L1,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}P1.DEFAULT_ORDER="XYZ";class I1{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&1<<e)}}let D1=0;const k1=new _0,O1=new y0,N1=new x1,F1=new _0,B1=new _0,U1=new _0,H1=new y0,z1=new _0(1,0,0),G1=new _0(0,1,0),V1=new _0(0,0,1),W1={type:"added"},j1={type:"removed"},Y1={type:"childadded",child:null},X1={type:"childremoved",child:null};class K1 extends s0{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:D1++}),this.uuid=u0(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=K1.DEFAULT_UP.clone();const e=new _0,t=new P1,n=new y0,i=new _0(1,1,1);t._onChange(function(){n.setFromEuler(t,!1)}),n._onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new x1},normalMatrix:{value:new S0}}),this.matrix=new x1,this.matrixWorld=new x1,this.matrixAutoUpdate=K1.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=K1.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new I1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return O1.setFromAxisAngle(e,t),this.quaternion.multiply(O1),this}rotateOnWorldAxis(e,t){return O1.setFromAxisAngle(e,t),this.quaternion.premultiply(O1),this}rotateX(e){return this.rotateOnAxis(z1,e)}rotateY(e){return this.rotateOnAxis(G1,e)}rotateZ(e){return this.rotateOnAxis(V1,e)}translateOnAxis(e,t){return k1.copy(e).applyQuaternion(this.quaternion),this.position.add(k1.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(z1,e)}translateY(e){return this.translateOnAxis(G1,e)}translateZ(e){return this.translateOnAxis(V1,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(N1.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?F1.copy(e):F1.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),B1.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?N1.lookAt(B1,F1,this.up):N1.lookAt(F1,B1,this.up),this.quaternion.setFromRotationMatrix(N1),i&&(N1.extractRotation(i.matrixWorld),O1.setFromRotationMatrix(N1),this.quaternion.premultiply(O1.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(W1),Y1.child=e,this.dispatchEvent(Y1),Y1.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(j1),X1.child=e,this.dispatchEvent(X1),X1.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),N1.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),N1.multiply(e.parent.matrixWorld)),e.applyMatrix4(N1),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(W1),Y1.child=e,this.dispatchEvent(Y1),Y1.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}getObjectsByProperty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[e]===t&&n.push(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(B1,e,U1),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(B1,H1,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++){t[n].updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){e[t].updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const i={};function r(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map(e=>Cr(Cr({},e),{},{boundingBox:e.boundingBox?e.boundingBox.toJSON():void 0,boundingSphere:e.boundingSphere?e.boundingSphere.toJSON():void 0})),i.instanceInfo=this._instanceInfo.map(e=>Cr({},e)),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(e),i.indirectTexture=this._indirectTexture.toJSON(e),null!==this._colorsTexture&&(i.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(i.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(i.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const i=n[t];r(e.shapes,i)}else r(e.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,i=this.material.length;n<i;n++)t.push(r(e.materials,this.material[n]));i.material=t}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];i.animations.push(r(e.animations,n))}}if(t){const t=s(e.geometries),i=s(e.materials),r=s(e.textures),a=s(e.images),o=s(e.shapes),l=s(e.skeletons),c=s(e.animations),u=s(e.nodes);t.length>0&&(n.geometries=t),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),a.length>0&&(n.images=a),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=i,n;function s(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}K1.DEFAULT_UP=new _0(0,1,0),K1.DEFAULT_MATRIX_AUTO_UPDATE=!0,K1.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const q1=new _0,J1=new _0,Q1=new _0,Z1=new _0,$1=new _0,e2=new _0,t2=new _0,n2=new _0,i2=new _0,r2=new _0,s2=new V0,a2=new V0,o2=new V0;class l2{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new _0;this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),q1.subVectors(e,t),i.cross(q1);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(e,t,n,i,r){q1.subVectors(i,t),J1.subVectors(n,t),Q1.subVectors(e,t);const s=q1.dot(q1),a=q1.dot(J1),o=q1.dot(Q1),l=J1.dot(J1),c=J1.dot(Q1),u=s*l-a*a;if(0===u)return r.set(0,0,0),null;const d=1/u,h=(l*o-a*c)*d,f=(s*c-a*o)*d;return r.set(1-h-f,f,h)}static containsPoint(e,t,n,i){return null!==this.getBarycoord(e,t,n,i,Z1)&&(Z1.x>=0&&Z1.y>=0&&Z1.x+Z1.y<=1)}static getInterpolation(e,t,n,i,r,s,a,o){return null===this.getBarycoord(e,t,n,i,Z1)?(o.x=0,o.y=0,"z"in o&&(o.z=0),"w"in o&&(o.w=0),null):(o.setScalar(0),o.addScaledVector(r,Z1.x),o.addScaledVector(s,Z1.y),o.addScaledVector(a,Z1.z),o)}static getInterpolatedAttribute(e,t,n,i,r,s){return s2.setScalar(0),a2.setScalar(0),o2.setScalar(0),s2.fromBufferAttribute(e,t),a2.fromBufferAttribute(e,n),o2.fromBufferAttribute(e,i),s.setScalar(0),s.addScaledVector(s2,r.x),s.addScaledVector(a2,r.y),s.addScaledVector(o2,r.z),s}static isFrontFacing(e,t,n,i){return q1.subVectors(n,t),J1.subVectors(e,t),q1.cross(J1).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return q1.subVectors(this.c,this.b),J1.subVectors(this.a,this.b),.5*q1.cross(J1).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return l2.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return l2.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,i,r){return l2.getInterpolation(e,this.a,this.b,this.c,t,n,i,r)}containsPoint(e){return l2.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return l2.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,r=this.c;let s,a;$1.subVectors(i,n),e2.subVectors(r,n),n2.subVectors(e,n);const o=$1.dot(n2),l=e2.dot(n2);if(o<=0&&l<=0)return t.copy(n);i2.subVectors(e,i);const c=$1.dot(i2),u=e2.dot(i2);if(c>=0&&u<=c)return t.copy(i);const d=o*u-c*l;if(d<=0&&o>=0&&c<=0)return s=o/(o-c),t.copy(n).addScaledVector($1,s);r2.subVectors(e,r);const h=$1.dot(r2),f=e2.dot(r2);if(f>=0&&h<=f)return t.copy(r);const p=h*l-o*f;if(p<=0&&l>=0&&f<=0)return a=l/(l-f),t.copy(n).addScaledVector(e2,a);const m=c*f-h*u;if(m<=0&&u-c>=0&&h-f>=0)return t2.subVectors(r,i),a=(u-c)/(u-c+(h-f)),t.copy(i).addScaledVector(t2,a);const g=1/(m+p+d);return s=p*g,a=d*g,t.copy(n).addScaledVector($1,s).addScaledVector(e2,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const c2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},u2={h:0,s:0,l:0},d2={h:0,s:0,l:0};function h2(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class f2{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G$;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,I0.colorSpaceToWorking(this,t),this}setRGB(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I0.workingColorSpace;return this.r=e,this.g=t,this.b=n,I0.colorSpaceToWorking(this,i),this}setHSL(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I0.workingColorSpace;if(e=h0(e,1),t=d0(t,0,1),n=d0(n,0,1),0===t)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=h2(r,i,e+1/3),this.g=h2(r,i,e),this.b=h2(r,i,e-1/3)}return I0.colorSpaceToWorking(this,i),this}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G$;function i(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const s=t[1],a=t[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,n);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,n);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=t[1],r=i.length;if(3===r)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,n);if(6===r)return this.setHex(parseInt(i,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G$;const n=c2[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=D0(e.r),this.g=D0(e.g),this.b=D0(e.b),this}copyLinearToSRGB(e){return this.r=k0(e.r),this.g=k0(e.g),this.b=k0(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G$;return I0.workingToColorSpace(p2.copy(this),e),65536*Math.round(d0(255*p2.r,0,255))+256*Math.round(d0(255*p2.g,0,255))+Math.round(d0(255*p2.b,0,255))}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G$;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I0.workingColorSpace;I0.workingToColorSpace(p2.copy(this),t);const n=p2.r,i=p2.g,r=p2.b,s=Math.max(n,i,r),a=Math.min(n,i,r);let o,l;const c=(a+s)/2;if(a===s)o=0,l=0;else{const e=s-a;switch(l=c<=.5?e/(s+a):e/(2-s-a),s){case n:o=(i-r)/e+(i<r?6:0);break;case i:o=(r-n)/e+2;break;case r:o=(n-i)/e+4}o/=6}return e.h=o,e.s=l,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I0.workingColorSpace;return I0.workingToColorSpace(p2.copy(this),t),e.r=p2.r,e.g=p2.g,e.b=p2.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G$;I0.workingToColorSpace(p2.copy(this),e);const t=p2.r,n=p2.g,i=p2.b;return e!==G$?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(i.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*n),",").concat(Math.round(255*i),")")}offsetHSL(e,t,n){return this.getHSL(u2),this.setHSL(u2.h+e,u2.s+t,u2.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(u2),e.getHSL(d2);const n=f0(u2.h,d2.h,t),i=f0(u2.s,d2.s,t),r=f0(u2.l,d2.l,t);return this.setHSL(n,i,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,i=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*i,this.g=r[1]*t+r[4]*n+r[7]*i,this.b=r[2]*t+r[5]*n+r[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const p2=new f2;f2.NAMES=c2;let m2=0;class g2 extends s0{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:m2++}),this.uuid=u0(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=$Q,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new f2(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Y$,this.stencilZFail=Y$,this.stencilZPass=Y$,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!==e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."));continue}const i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."))}}toJSON(e){const t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};function i(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),204!==this.blendSrc&&(n.blendSrc=this.blendSrc),205!==this.blendDst&&(n.blendDst=this.blendDst),this.blendEquation!==$Q&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Y$&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Y$&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Y$&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=i(e.textures),r=i(e.images);t.length>0&&(n.textures=t),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let i=0;i!==e;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class v2 extends g2{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new f2(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new P1,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const y2=new _0,_2=new v0;let b2=0;class x2{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:b2++}),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=t0,this.updateRanges=[],this.gpuType=jZ,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)_2.fromBufferAttribute(this,t),_2.applyMatrix3(e),this.setXY(t,_2.x,_2.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)y2.fromBufferAttribute(this,t),y2.applyMatrix3(e),this.setXYZ(t,y2.x,y2.y,y2.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)y2.fromBufferAttribute(this,t),y2.applyMatrix4(e),this.setXYZ(t,y2.x,y2.y,y2.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)y2.fromBufferAttribute(this,t),y2.applyNormalMatrix(e),this.setXYZ(t,y2.x,y2.y,y2.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)y2.fromBufferAttribute(this,t),y2.transformDirection(e),this.setXYZ(t,y2.x,y2.y,y2.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=p0(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=m0(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=p0(t,this.array)),t}setX(e,t){return this.normalized&&(t=m0(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=p0(t,this.array)),t}setY(e,t){return this.normalized&&(t=m0(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=p0(t,this.array)),t}setZ(e,t){return this.normalized&&(t=m0(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=p0(t,this.array)),t}setW(e,t){return this.normalized&&(t=m0(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=m0(t,this.array),n=m0(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=m0(t,this.array),n=m0(n,this.array),i=m0(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=m0(t,this.array),n=m0(n,this.array),i=m0(i,this.array),r=m0(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==t0&&(e.usage=this.usage),e}}class S2 extends x2{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class E2 extends x2{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class w2 extends x2{constructor(e,t,n){super(new Float32Array(e),t,n)}}let T2=0;const M2=new x1,A2=new K1,C2=new _0,R2=new K0,L2=new K0,P2=new _0;class I2 extends s0{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:T2++}),this.uuid=u0(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(w0(e)?E2:S2)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new S0).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return M2.makeRotationFromQuaternion(e),this.applyMatrix4(M2),this}rotateX(e){return M2.makeRotationX(e),this.applyMatrix4(M2),this}rotateY(e){return M2.makeRotationY(e),this.applyMatrix4(M2),this}rotateZ(e){return M2.makeRotationZ(e),this.applyMatrix4(M2),this}translate(e,t,n){return M2.makeTranslation(e,t,n),this.applyMatrix4(M2),this}scale(e,t,n){return M2.makeScale(e,t,n),this.applyMatrix4(M2),this}lookAt(e){return A2.lookAt(e),A2.updateMatrix(),this.applyMatrix4(A2.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(C2).negate(),this.translate(C2.x,C2.y,C2.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];t.push(i.x,i.y,i.z||0)}this.setAttribute("position",new w2(t,3))}else{const n=Math.min(e.length,t.count);for(let i=0;i<n;i++){const n=e[i];t.setXYZ(i,n.x,n.y,n.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new K0);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new _0(-1/0,-1/0,-1/0),new _0(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const e=t[n];R2.setFromBufferAttribute(e),this.morphTargetsRelative?(P2.addVectors(this.boundingBox.min,R2.min),this.boundingBox.expandByPoint(P2),P2.addVectors(this.boundingBox.max,R2.max),this.boundingBox.expandByPoint(P2)):(this.boundingBox.expandByPoint(R2.min),this.boundingBox.expandByPoint(R2.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new h1);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new _0,1/0);if(e){const n=this.boundingSphere.center;if(R2.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){const n=t[e];L2.setFromBufferAttribute(n),this.morphTargetsRelative?(P2.addVectors(R2.min,L2.min),R2.expandByPoint(P2),P2.addVectors(R2.max,L2.max),R2.expandByPoint(P2)):(R2.expandByPoint(L2.min),R2.expandByPoint(L2.max))}R2.getCenter(n);let i=0;for(let t=0,r=e.count;t<r;t++)P2.fromBufferAttribute(e,t),i=Math.max(i,n.distanceToSquared(P2));if(t)for(let r=0,s=t.length;r<s;r++){const s=t[r],a=this.morphTargetsRelative;for(let t=0,r=s.count;t<r;t++)P2.fromBufferAttribute(s,t),a&&(C2.fromBufferAttribute(e,t),P2.add(C2)),i=Math.max(i,n.distanceToSquared(P2))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.position,i=t.normal,r=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new x2(new Float32Array(4*n.count),4));const s=this.getAttribute("tangent"),a=[],o=[];for(let E=0;E<n.count;E++)a[E]=new _0,o[E]=new _0;const l=new _0,c=new _0,u=new _0,d=new v0,h=new v0,f=new v0,p=new _0,m=new _0;function g(e,t,i){l.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),u.fromBufferAttribute(n,i),d.fromBufferAttribute(r,e),h.fromBufferAttribute(r,t),f.fromBufferAttribute(r,i),c.sub(l),u.sub(l),h.sub(d),f.sub(d);const s=1/(h.x*f.y-f.x*h.y);isFinite(s)&&(p.copy(c).multiplyScalar(f.y).addScaledVector(u,-h.y).multiplyScalar(s),m.copy(u).multiplyScalar(h.x).addScaledVector(c,-f.x).multiplyScalar(s),a[e].add(p),a[t].add(p),a[i].add(p),o[e].add(m),o[t].add(m),o[i].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:e.count}]);for(let E=0,w=v.length;E<w;++E){const t=v[E],n=t.start;for(let i=n,r=n+t.count;i<r;i+=3)g(e.getX(i+0),e.getX(i+1),e.getX(i+2))}const y=new _0,_=new _0,b=new _0,x=new _0;function S(e){b.fromBufferAttribute(i,e),x.copy(b);const t=a[e];y.copy(t),y.sub(b.multiplyScalar(b.dot(t))).normalize(),_.crossVectors(x,t);const n=_.dot(o[e])<0?-1:1;s.setXYZW(e,y.x,y.y,y.z,n)}for(let E=0,w=v.length;E<w;++E){const t=v[E],n=t.start;for(let i=n,r=n+t.count;i<r;i+=3)S(e.getX(i+0)),S(e.getX(i+1)),S(e.getX(i+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new x2(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const i=new _0,r=new _0,s=new _0,a=new _0,o=new _0,l=new _0,c=new _0,u=new _0;if(e)for(let d=0,h=e.count;d<h;d+=3){const h=e.getX(d+0),f=e.getX(d+1),p=e.getX(d+2);i.fromBufferAttribute(t,h),r.fromBufferAttribute(t,f),s.fromBufferAttribute(t,p),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),a.fromBufferAttribute(n,h),o.fromBufferAttribute(n,f),l.fromBufferAttribute(n,p),a.add(c),o.add(c),l.add(c),n.setXYZ(h,a.x,a.y,a.z),n.setXYZ(f,o.x,o.y,o.z),n.setXYZ(p,l.x,l.y,l.z)}else for(let e=0,d=t.count;e<d;e+=3)i.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)P2.fromBufferAttribute(e,t),P2.normalize(),e.setXYZ(t,P2.x,P2.y,P2.z)}toNonIndexed(){function e(e,t){const n=e.array,i=e.itemSize,r=e.normalized,s=new n.constructor(t.length*i);let a=0,o=0;for(let l=0,c=t.length;l<c;l++){a=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*i;for(let e=0;e<i;e++)s[o++]=n[a++]}return new x2(s,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new I2,n=this.index.array,i=this.attributes;for(const a in i){const r=e(i[a],n);t.setAttribute(a,r)}const r=this.morphAttributes;for(const a in r){const i=[],s=r[a];for(let t=0,r=s.length;t<r;t++){const r=e(s[t],n);i.push(r)}t.morphAttributes[a]=i}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,o=s.length;a<o;a++){const e=s[a];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const o in n){const t=n[o];e.data.attributes[o]=t.toJSON(e.data)}const i={};let r=!1;for(const o in this.morphAttributes){const t=this.morphAttributes[o],n=[];for(let i=0,r=t.length;i<r;i++){const r=t[i];n.push(r.toJSON(e.data))}n.length>0&&(i[o]=n,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere=a.toJSON()),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone());const i=e.attributes;for(const l in i){const e=i[l];this.setAttribute(l,e.clone(t))}const r=e.morphAttributes;for(const l in r){const e=[],n=r[l];for(let i=0,r=n.length;i<r;i++)e.push(n[i].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let l=0,c=s.length;l<c;l++){const e=s[l];this.addGroup(e.start,e.count,e.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const D2=new x1,k2=new b1,O2=new h1,N2=new _0,F2=new _0,B2=new _0,U2=new _0,H2=new _0,z2=new _0,G2=new _0,V2=new _0;class W2 extends K1{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new I2,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new v2;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const a=this.morphTargetInfluences;if(r&&a){z2.set(0,0,0);for(let n=0,i=r.length;n<i;n++){const i=a[n],o=r[n];0!==i&&(H2.fromBufferAttribute(o,e),s?z2.addScaledVector(H2,i):z2.addScaledVector(H2.sub(t),i))}t.add(z2)}return t}raycast(e,t){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0!==i){if(null===n.boundingSphere&&n.computeBoundingSphere(),O2.copy(n.boundingSphere),O2.applyMatrix4(r),k2.copy(e.ray).recast(e.near),!1===O2.containsPoint(k2.origin)){if(null===k2.intersectSphere(O2,N2))return;if(k2.origin.distanceToSquared(N2)>(e.far-e.near)**2)return}D2.copy(r).invert(),k2.copy(e.ray).applyMatrix4(D2),null!==n.boundingBox&&!1===k2.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,k2)}}_computeIntersections(e,t,n){let i;const r=this.geometry,s=this.material,a=r.index,o=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv1,u=r.attributes.normal,d=r.groups,h=r.drawRange;if(null!==a)if(Array.isArray(s))for(let f=0,p=d.length;f<p;f++){const r=d[f],o=s[r.materialIndex];for(let s=Math.max(r.start,h.start),d=Math.min(a.count,Math.min(r.start+r.count,h.start+h.count));s<d;s+=3){i=j2(this,o,e,n,l,c,u,a.getX(s),a.getX(s+1),a.getX(s+2)),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,t.push(i))}}else{for(let r=Math.max(0,h.start),o=Math.min(a.count,h.start+h.count);r<o;r+=3){i=j2(this,s,e,n,l,c,u,a.getX(r),a.getX(r+1),a.getX(r+2)),i&&(i.faceIndex=Math.floor(r/3),t.push(i))}}else if(void 0!==o)if(Array.isArray(s))for(let f=0,p=d.length;f<p;f++){const r=d[f],a=s[r.materialIndex];for(let s=Math.max(r.start,h.start),d=Math.min(o.count,Math.min(r.start+r.count,h.start+h.count));s<d;s+=3){i=j2(this,a,e,n,l,c,u,s,s+1,s+2),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,t.push(i))}}else{for(let r=Math.max(0,h.start),a=Math.min(o.count,h.start+h.count);r<a;r+=3){i=j2(this,s,e,n,l,c,u,r,r+1,r+2),i&&(i.faceIndex=Math.floor(r/3),t.push(i))}}}}function j2(e,t,n,i,r,s,a,o,l,c){e.getVertexPosition(o,F2),e.getVertexPosition(l,B2),e.getVertexPosition(c,U2);const u=function(e,t,n,i,r,s,a,o){let l;if(l=1===t.side?i.intersectTriangle(a,s,r,!0,o):i.intersectTriangle(r,s,a,0===t.side,o),null===l)return null;V2.copy(o),V2.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(V2);return c<n.near||c>n.far?null:{distance:c,point:V2.clone(),object:e}}(e,t,n,i,F2,B2,U2,G2);if(u){const e=new _0;l2.getBarycoord(G2,F2,B2,U2,e),r&&(u.uv=l2.getInterpolatedAttribute(r,o,l,c,e,new v0)),s&&(u.uv1=l2.getInterpolatedAttribute(s,o,l,c,e,new v0)),a&&(u.normal=l2.getInterpolatedAttribute(a,o,l,c,e,new _0),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const t={a:o,b:l,c:c,normal:new _0,materialIndex:0};l2.getNormal(F2,B2,U2,t.normal),u.face=t,u.barycoord=e}return u}class Y2 extends I2{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};const a=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);const o=[],l=[],c=[],u=[];let d=0,h=0;function f(e,t,n,i,r,s,f,p,m,g,v){const y=s/m,_=f/g,b=s/2,x=f/2,S=p/2,E=m+1,w=g+1;let T=0,M=0;const A=new _0;for(let a=0;a<w;a++){const s=a*_-x;for(let o=0;o<E;o++){const d=o*y-b;A[e]=d*i,A[t]=s*r,A[n]=S,l.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[n]=p>0?1:-1,c.push(A.x,A.y,A.z),u.push(o/m),u.push(1-a/g),T+=1}}for(let a=0;a<g;a++)for(let e=0;e<m;e++){const t=d+e+E*a,n=d+e+E*(a+1),i=d+(e+1)+E*(a+1),r=d+(e+1)+E*a;o.push(t,n,r),o.push(n,i,r),M+=6}a.addGroup(h,M,v),h+=M,d+=T}f("z","y","x",-1,-1,n,t,e,s,r,0),f("z","y","x",1,-1,n,t,-e,s,r,1),f("x","z","y",1,1,e,n,t,i,s,2),f("x","z","y",1,-1,e,n,-t,i,s,3),f("x","y","z",1,-1,e,t,n,i,r,4),f("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(o),this.setAttribute("position",new w2(l,3)),this.setAttribute("normal",new w2(c,3)),this.setAttribute("uv",new w2(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Y2(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function X2(e){const t={};for(const n in e){t[n]={};for(const i in e[n]){const r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][i]=null):t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}}return t}function K2(e){const t={};for(let n=0;n<e.length;n++){const i=X2(e[n]);for(const e in i)t[e]=i[e]}return t}function q2(e){const t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:I0.workingColorSpace}const J2={clone:X2,merge:K2};class Q2 extends g2{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=X2(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Z2 extends K1{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new x1,this.projectionMatrix=new x1,this.projectionMatrixInverse=new x1,this.coordinateSystem=i0,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const $2=new _0,e3=new v0,t3=new v0;class n3 extends Z2{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*c0*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*l0*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*c0*Math.atan(Math.tan(.5*l0*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){$2.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set($2.x,$2.y).multiplyScalar(-e/$2.z),$2.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set($2.x,$2.y).multiplyScalar(-e/$2.z)}getViewSize(e,t){return this.getViewBounds(e,e3,t3),t.subVectors(t3,e3)}setViewOffset(e,t,n,i,r,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*l0*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i;const s=this.view;if(null!==this.view&&this.view.enabled){const e=s.fullWidth,a=s.fullHeight;r+=s.offsetX*i/e,t-=s.offsetY*n/a,i*=s.width/e,n*=s.height/a}const a=this.filmOffset;0!==a&&(r+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const i3=-90;class r3 extends K1{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new n3(i3,1,e,t);i.layers=this.layers,this.add(i);const r=new n3(i3,1,e,t);r.layers=this.layers,this.add(r);const s=new n3(i3,1,e,t);s.layers=this.layers,this.add(s);const a=new n3(i3,1,e,t);a.layers=this.layers,this.add(a);const o=new n3(i3,1,e,t);o.layers=this.layers,this.add(o);const l=new n3(i3,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,i,r,s,a,o]=t;for(const l of t)this.remove(l);if(e===i0)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else{if(e!==r0)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,s,a,o,l,c]=this.children,u=e.getRenderTarget(),d=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),f=e.xr.enabled;e.xr.enabled=!1;const p=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,i),e.render(t,r),e.setRenderTarget(n,1,i),e.render(t,s),e.setRenderTarget(n,2,i),e.render(t,a),e.setRenderTarget(n,3,i),e.render(t,o),e.setRenderTarget(n,4,i),e.render(t,l),n.texture.generateMipmaps=p,e.setRenderTarget(n,5,i),e.render(t,c),e.setRenderTarget(u,d,h),e.xr.enabled=f,n.texture.needsPMREMUpdate=!0}}class s3 extends G0{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],arguments.length>1&&void 0!==arguments[1]?arguments[1]:TZ,arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0,arguments.length>9?arguments[9]:void 0),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class a3 extends j0{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new s3(i),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={tEquirect:{value:null}},i="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new Y2(5,5,5),a=new Q2({name:"CubemapFromEquirect",uniforms:X2(n),vertexShader:i,fragmentShader:r,side:1,blending:0});a.uniforms.tEquirect.value=t;const o=new W2(s,a),l=t.minFilter;t.minFilter===BZ&&(t.minFilter=NZ);return new r3(1,10,this).update(e,o),t.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,n,i);e.setRenderTarget(r)}}class o3 extends K1{constructor(){super(),this.isGroup=!0,this.type="Group"}}const l3={type:"move"};class c3{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new o3,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new o3,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new _0,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new _0),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new o3,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new _0,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new _0),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let i=null,r=null,s=null;const a=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){s=!0;for(const s of e.hand.values()){const e=t.getJointPose(s,n),i=this._getHandJoint(l,s);null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.matrixWorldNeedsUpdate=!0,i.jointRadius=e.radius),i.visible=null!==e}const i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],a=i.position.distanceTo(r.position),o=.02,c=.005;l.inputState.pinching&&a>o+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&a<=o-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1));null!==a&&(i=t.getPose(e.targetRaySpace,n),null===i&&null!==r&&(i=r),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(l3)))}return null!==a&&(a.visible=null!==i),null!==o&&(o.visible=null!==r),null!==l&&(l.visible=null!==s),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new o3;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class u3 extends K1{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new P1,this.environmentIntensity=1,this.environmentRotation=new P1,this.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}const d3=new _0,h3=new _0,f3=new S0;class p3{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _0(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=d3.subVectors(n,t).cross(h3.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(d3),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||f3.getNormalMatrix(e),i=this.coplanarPoint(d3).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const m3=new h1,g3=new v0(.5,.5),v3=new _0;class y3{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new p3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new p3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new p3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new p3,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new p3,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new p3;this.planes=[e,t,n,i,r,s]}set(e,t,n,i,r,s){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(s),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.planes,r=e.elements,s=r[0],a=r[1],o=r[2],l=r[3],c=r[4],u=r[5],d=r[6],h=r[7],f=r[8],p=r[9],m=r[10],g=r[11],v=r[12],y=r[13],_=r[14],b=r[15];if(i[0].setComponents(l-s,h-c,g-f,b-v).normalize(),i[1].setComponents(l+s,h+c,g+f,b+v).normalize(),i[2].setComponents(l+a,h+u,g+p,b+y).normalize(),i[3].setComponents(l-a,h-u,g-p,b-y).normalize(),n)i[4].setComponents(o,d,m,_).normalize(),i[5].setComponents(l-o,h-d,g-m,b-_).normalize();else if(i[4].setComponents(l-o,h-d,g-m,b-_).normalize(),t===i0)i[5].setComponents(l+o,h+d,g+m,b+_).normalize();else{if(t!==r0)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(o,d,m,_).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),m3.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),m3.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(m3)}intersectsSprite(e){m3.center.set(0,0,0);const t=g3.distanceTo(e.center);return m3.radius=.7071067811865476+t,m3.applyMatrix4(e.matrixWorld),this.intersectsSphere(m3)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let r=0;r<6;r++){if(t[r].distanceToPoint(n)<i)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(v3.x=i.normal.x>0?e.max.x:e.min.x,v3.y=i.normal.y>0?e.max.y:e.min.y,v3.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(v3)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class _3 extends G0{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:WZ,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:DZ,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:DZ,l=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:ZZ,u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1;if(c!==ZZ&&c!==$Z)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:e,height:t,depth:u},i,r,s,a,o,c,n,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new B0(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class b3 extends I2{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const r=e/2,s=t/2,a=Math.floor(n),o=Math.floor(i),l=a+1,c=o+1,u=e/a,d=t/o,h=[],f=[],p=[],m=[];for(let g=0;g<c;g++){const e=g*d-s;for(let t=0;t<l;t++){const n=t*u-r;f.push(n,-e,0),p.push(0,0,1),m.push(t/a),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let e=0;e<a;e++){const t=e+l*g,n=e+l*(g+1),i=e+1+l*(g+1),r=e+1+l*g;h.push(t,n,r),h.push(n,i,r)}this.setIndex(h),this.setAttribute("position",new w2(f,3)),this.setAttribute("normal",new w2(p,3)),this.setAttribute("uv",new w2(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new b3(e.width,e.height,e.widthSegments,e.heightSegments)}}class x3 extends I2{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const o=Math.min(s+a,Math.PI);let l=0;const c=[],u=new _0,d=new _0,h=[],f=[],p=[],m=[];for(let g=0;g<=n;g++){const h=[],v=g/n;let y=0;0===g&&0===s?y=.5/t:g===n&&o===Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const o=n/t;u.x=-e*Math.cos(i+o*r)*Math.sin(s+v*a),u.y=e*Math.cos(s+v*a),u.z=e*Math.sin(i+o*r)*Math.sin(s+v*a),f.push(u.x,u.y,u.z),d.copy(u).normalize(),p.push(d.x,d.y,d.z),m.push(o+y,1-v),h.push(l++)}c.push(h)}for(let g=0;g<n;g++)for(let e=0;e<t;e++){const t=c[g][e+1],i=c[g][e],r=c[g+1][e],a=c[g+1][e+1];(0!==g||s>0)&&h.push(t,i,a),(g!==n-1||o<Math.PI)&&h.push(i,r,a)}this.setIndex(h),this.setAttribute("position",new w2(f,3)),this.setAttribute("normal",new w2(p,3)),this.setAttribute("uv",new w2(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new x3(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class S3 extends g2{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class E3 extends g2{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function w3(e,t){return e&&e.constructor!==t?"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e}function T3(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}class M3{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let s;n:{i:if(!(e<i)){for(let s=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(r=i,i=t[++n],e<i)break t}s=t.length;break n}if(!(e>=r)){const a=t[1];e<a&&(n=2,r=a);for(let s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(n===s)break;if(i=r,r=t[--n-1],e>=r)break t}s=n,n=0;break n}break e}for(;n<s;){const i=n+s>>>1;e<t[i]?s=i:n=i+1}if(i=t[n],r=t[n-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let s=0;s!==i;++s)t[s]=n[r+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class A3 extends M3{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:B$,endingEnd:B$}}intervalChanged_(e,t,n){const i=this.parameterPositions;let r=e-2,s=e+1,a=i[r],o=i[s];if(void 0===a)switch(this.getSettings_().endingStart){case U$:r=e,a=2*t-n;break;case H$:r=i.length-2,a=t+i[r]-i[r+1];break;default:r=e,a=n}if(void 0===o)switch(this.getSettings_().endingEnd){case U$:s=e,o=2*n-t;break;case H$:s=1,o=n+i[1]-i[0];break;default:s=e-1,o=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-n),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=this._offsetPrev,u=this._offsetNext,d=this._weightPrev,h=this._weightNext,f=(n-t)/(i-t),p=f*f,m=p*f,g=-d*m+2*d*p-d*f,v=(1+d)*m+(-1.5-2*d)*p+(-.5+d)*f+1,y=(-1-h)*m+(1.5+h)*p+.5*f,_=h*m-h*p;for(let b=0;b!==a;++b)r[b]=g*s[c+b]+v*s[l+b]+y*s[o+b]+_*s[u+b];return r}}class C3 extends M3{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=(n-t)/(i-t),u=1-c;for(let d=0;d!==a;++d)r[d]=s[l+d]*u+s[o+d]*c;return r}}class R3 extends M3{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class L3{constructor(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=w3(t,this.TimeBufferType),this.values=w3(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:w3(e.times,Array),values:w3(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new R3(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new C3(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new A3(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case O$:t=this.InterpolantFactoryMethodDiscrete;break;case N$:t=this.InterpolantFactoryMethodLinear;break;case F$:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return O$;case this.InterpolantFactoryMethodLinear:return N$;case this.InterpolantFactoryMethodSmooth:return F$}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let r=0,s=i-1;for(;r!==i&&n[r]<e;)++r;for(;-1!==s&&n[s]>t;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);const e=this.getValueSize();this.times=n.slice(r,s),this.values=this.values.slice(r*e,s*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==r;a++){const t=n[a];if("number"===typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,t),e=!1;break}if(null!==s&&s>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,t,s),e=!1;break}s=t}if(void 0!==i&&T3(i))for(let a=0,o=i.length;a!==o;++a){const t=i[a];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,t),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===F$,r=e.length-1;let s=1;for(let a=1;a<r;++a){let r=!1;const o=e[a];if(o!==e[a+1]&&(1!==a||o!==e[0]))if(i)r=!0;else{const e=a*n,i=e-n,s=e+n;for(let a=0;a!==n;++a){const n=t[e+a];if(n!==t[i+a]||n!==t[s+a]){r=!0;break}}}if(r){if(a!==s){e[s]=e[a];const i=a*n,r=s*n;for(let e=0;e!==n;++e)t[r+e]=t[i+e]}++s}}if(r>0){e[s]=e[r];for(let e=r*n,i=s*n,a=0;a!==n;++a)t[i+a]=t[e+a];++s}return s!==e.length?(this.times=e.slice(0,s),this.values=t.slice(0,s*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}L3.prototype.ValueTypeName="",L3.prototype.TimeBufferType=Float32Array,L3.prototype.ValueBufferType=Float32Array,L3.prototype.DefaultInterpolation=N$;class P3 extends L3{constructor(e,t,n){super(e,t,n)}}P3.prototype.ValueTypeName="bool",P3.prototype.ValueBufferType=Array,P3.prototype.DefaultInterpolation=O$,P3.prototype.InterpolantFactoryMethodLinear=void 0,P3.prototype.InterpolantFactoryMethodSmooth=void 0;class I3 extends L3{constructor(e,t,n,i){super(e,t,n,i)}}I3.prototype.ValueTypeName="color";class D3 extends L3{constructor(e,t,n,i){super(e,t,n,i)}}D3.prototype.ValueTypeName="number";class k3 extends M3{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(n-t)/(i-t);let l=e*a;for(let c=l+a;l!==c;l+=4)y0.slerpFlat(r,0,s,l-a,s,l,o);return r}}class O3 extends L3{constructor(e,t,n,i){super(e,t,n,i)}InterpolantFactoryMethodLinear(e){return new k3(this.times,this.values,this.getValueSize(),e)}}O3.prototype.ValueTypeName="quaternion",O3.prototype.InterpolantFactoryMethodSmooth=void 0;class N3 extends L3{constructor(e,t,n){super(e,t,n)}}N3.prototype.ValueTypeName="string",N3.prototype.ValueBufferType=Array,N3.prototype.DefaultInterpolation=O$,N3.prototype.InterpolantFactoryMethodLinear=void 0,N3.prototype.InterpolantFactoryMethodSmooth=void 0;class F3 extends L3{constructor(e,t,n,i){super(e,t,n,i)}}F3.prototype.ValueTypeName="vector";const B3={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class U3{constructor(e,t,n){const i=this;let r,s=!1,a=0,o=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.abortController=new AbortController,this.itemStart=function(e){o++,!1===s&&void 0!==i.onStart&&i.onStart(e,a,o),s=!0},this.itemEnd=function(e){a++,void 0!==i.onProgress&&i.onProgress(e,a,o),a===o&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return r?r(e):e},this.setURLModifier=function(e){return r=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],i=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return i}return null},this.abort=function(){return this.abortController.abort(),this.abortController=new AbortController,this}}}const H3=new U3;class z3{constructor(e){this.manager=void 0!==e?e:H3,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(i,r){n.load(e,i,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}z3.DEFAULT_MATERIAL_NAME="__DEFAULT";const G3={};class V3 extends Error{constructor(e,t){super(e),this.response=t}}class W3 extends z3{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=B3.get("file:".concat(e));if(void 0!==r)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(void 0!==G3[e])return void G3[e].push({onLoad:t,onProgress:n,onError:i});G3[e]=[],G3[e].push({onLoad:t,onProgress:n,onError:i});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:"function"===typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),a=this.mimeType,o=this.responseType;fetch(s).then(t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const n=G3[e],i=t.body.getReader(),r=t.headers.get("X-File-Size")||t.headers.get("Content-Length"),s=r?parseInt(r):0,a=0!==s;let o=0;const l=new ReadableStream({start(e){!function t(){i.read().then(i=>{let{done:r,value:l}=i;if(r)e.close();else{o+=l.byteLength;const i=new ProgressEvent("progress",{lengthComputable:a,loaded:o,total:s});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(i)}e.enqueue(l),t()}},t=>{e.error(t)})}()}});return new Response(l)}throw new V3('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)}).then(e=>{switch(o){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then(e=>(new DOMParser).parseFromString(e,a));case"json":return e.json();default:if(""===a)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(a),n=t&&t[1]?t[1].toLowerCase():void 0,i=new TextDecoder(n);return e.arrayBuffer().then(e=>i.decode(e))}}}).then(t=>{B3.add("file:".concat(e),t);const n=G3[e];delete G3[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onLoad&&i.onLoad(t)}}).catch(t=>{const n=G3[e];if(void 0===n)throw this.manager.itemError(e),t;delete G3[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onError&&i.onError(t)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}const j3=new WeakMap;class Y3 extends z3{constructor(e){super(e)}load(e,t,n,i){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,s=B3.get("image:".concat(e));if(void 0!==s){if(!0===s.complete)r.manager.itemStart(e),setTimeout(function(){t&&t(s),r.manager.itemEnd(e)},0);else{let e=j3.get(s);void 0===e&&(e=[],j3.set(s,e)),e.push({onLoad:t,onError:i})}return s}const a=T0("img");function o(){c(),t&&t(this);const n=j3.get(this)||[];for(let e=0;e<n.length;e++){const t=n[e];t.onLoad&&t.onLoad(this)}j3.delete(this),r.manager.itemEnd(e)}function l(t){c(),i&&i(t),B3.remove("image:".concat(e));const n=j3.get(this)||[];for(let e=0;e<n.length;e++){const i=n[e];i.onError&&i.onError(t)}j3.delete(this),r.manager.itemError(e),r.manager.itemEnd(e)}function c(){a.removeEventListener("load",o,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),B3.add("image:".concat(e),a),r.manager.itemStart(e),a.src=e,a}}class X3 extends Z2{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-e,s=n+e,a=i+t,o=i-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,s=r+e*this.view.width,a-=t*this.view.offsetY,o=a-t*this.view.height}this.projectionMatrix.makeOrthographic(r,s,a,o,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}new WeakMap;class K3 extends n3{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}const q3="\\[\\]\\.:\\/",J3=new RegExp("["+q3+"]","g"),Q3="[^"+q3+"]",Z3="[^"+q3.replace("\\.","")+"]",$3=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Q3)+/(WCOD+)?/.source.replace("WCOD",Z3)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Q3)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Q3)+"$"),e4=["material","materials","bones","map"];class t4{constructor(e,t,n){this.path=t,this.parsedPath=n||t4.parseTrackName(t),this.node=t4.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new t4.Composite(e,t,n):new t4(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(J3,"")}static parseTrackName(e){const t=$3.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const e=n.nodeName.substring(i+1);-1!==e4.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let i=0;i<e.length;i++){const r=e[i];if(r.name===t||r.uuid===t)return r;const s=n(r.children);if(s)return s}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let r=t.propertyIndex;if(e||(e=t4.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(n){let i=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===i){i=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}const s=e[i];if(void 0===s){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",e)}let a=this.Versioning.None;this.targetObject=e,!0===e.isMaterial?a=this.Versioning.NeedsUpdate:!0===e.isObject3D&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}t4.Composite=class{constructor(e,t,n){const i=n||t4.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},t4.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},t4.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},t4.prototype.GetterByBindingType=[t4.prototype._getValue_direct,t4.prototype._getValue_array,t4.prototype._getValue_arrayElement,t4.prototype._getValue_toArray],t4.prototype.SetterByBindingTypeAndVersioning=[[t4.prototype._setValue_direct,t4.prototype._setValue_direct_setNeedsUpdate,t4.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[t4.prototype._setValue_array,t4.prototype._setValue_array_setNeedsUpdate,t4.prototype._setValue_array_setMatrixWorldNeedsUpdate],[t4.prototype._setValue_arrayElement,t4.prototype._setValue_arrayElement_setNeedsUpdate,t4.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[t4.prototype._setValue_fromArray,t4.prototype._setValue_fromArray_setNeedsUpdate,t4.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);const n4=new x1;class i4{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new b1(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new I1,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return n4.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(n4),this}intersectObject(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return s4(e,this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),t.sort(r4),t}intersectObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let i=0,r=e.length;i<r;i++)s4(e[i],this,n,t);return n.sort(r4),n}}function r4(e,t){return e.distance-t.distance}function s4(e,t,n,i){let r=!0;if(e.layers.test(t.layers)){!1===e.raycast(t,n)&&(r=!1)}if(!0===r&&!0===i){const i=e.children;for(let e=0,r=i.length;e<r;e++)s4(i[e],t,n,!0)}}function a4(e,t,n,i){const r=function(e){switch(e){case UZ:case HZ:return{byteLength:1,components:1};case GZ:case zZ:case YZ:return{byteLength:2,components:1};case XZ:case KZ:return{byteLength:2,components:4};case WZ:case VZ:case jZ:return{byteLength:4,components:1};case JZ:return{byteLength:4,components:3}}throw new Error("Unknown texture type ".concat(e,"."))}(i);switch(n){case 1021:return e*t;case e$:case t$:return e*t/r.components*r.byteLength;case 1030:case n$:return e*t*2/r.components*r.byteLength;case 1022:return e*t*3/r.components*r.byteLength;case QZ:case i$:return e*t*4/r.components*r.byteLength;case r$:case s$:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case a$:case o$:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case c$:case d$:return Math.max(e,16)*Math.max(t,8)/4;case l$:case u$:return Math.max(e,8)*Math.max(t,8)/2;case h$:case f$:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case p$:case m$:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case g$:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case v$:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case y$:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case _$:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case b$:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case x$:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case S$:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case E$:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case w$:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case T$:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case M$:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case A$:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case C$:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case R$:case L$:case P$:return Math.ceil(e/4)*Math.ceil(t/4)*16;case 36283:case I$:return Math.ceil(e/4)*Math.ceil(t/4)*8;case D$:case k$:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error("Unable to determine texture byte length for ".concat(n," format."))}function o4(){let e=null,t=!1,n=null,i=null;function r(t,s){n(t,s),i=e.requestAnimationFrame(r)}return{start:function(){!0!==t&&null!==n&&(i=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function l4(e){const t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const i=t.get(n);i&&(e.deleteBuffer(i.buffer),t.delete(n))},update:function(n,i){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){const e=t.get(n);return void((!e||e.version<n.version)&&t.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}const r=t.get(n);if(void 0===r)t.set(n,function(t,n){const i=t.array,r=t.usage,s=i.byteLength,a=e.createBuffer();let o;if(e.bindBuffer(n,a),e.bufferData(n,i,r),t.onUploadCallback(),i instanceof Float32Array)o=e.FLOAT;else if("undefined"!==typeof Float16Array&&i instanceof Float16Array)o=e.HALF_FLOAT;else if(i instanceof Uint16Array)o=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(i instanceof Int16Array)o=e.SHORT;else if(i instanceof Uint32Array)o=e.UNSIGNED_INT;else if(i instanceof Int32Array)o=e.INT;else if(i instanceof Int8Array)o=e.BYTE;else if(i instanceof Uint8Array)o=e.UNSIGNED_BYTE;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);o=e.UNSIGNED_BYTE}return{buffer:a,type:o,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version,size:s}}(n,i));else if(r.version<n.version){if(r.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,n,i){const r=n.array,s=n.updateRanges;if(e.bindBuffer(i,t),0===s.length)e.bufferSubData(i,0,r);else{s.sort((e,t)=>e.start-t.start);let t=0;for(let e=1;e<s.length;e++){const n=s[t],i=s[e];i.start<=n.start+n.count+1?n.count=Math.max(n.count,i.start+i.count-n.start):(++t,s[t]=i)}s.length=t+1;for(let n=0,a=s.length;n<a;n++){const t=s[n];e.bufferSubData(i,t.start*r.BYTES_PER_ELEMENT,r,t.start,t.count)}n.clearUpdateRanges()}n.onUploadCallback()}(r.buffer,n,i),r.version=n.version}}}}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:qQ}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=qQ);const c4={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\tfloat depth = unpackRGBAToDepth( texture2D( depths, uv ) );\n\t\t#ifdef USE_REVERSEDEPTHBUF\n\t\t\treturn step( depth, compare );\n\t\t#else\n\t\t\treturn step( compare, depth );\n\t\t#endif\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\t#ifdef USE_REVERSEDEPTHBUF\n\t\t\tfloat hard_shadow = step( distribution.x, compare );\n\t\t#else\n\t\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\t#endif\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_REVERSEDEPTHBUF\n\t\tfloat fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];\n\t#else\n\t\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;\n\t#endif\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},u4={common:{diffuse:{value:new f2(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new S0},alphaMap:{value:null},alphaMapTransform:{value:new S0},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new S0}},envmap:{envMap:{value:null},envMapRotation:{value:new S0},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new S0}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new S0}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new S0},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new S0},normalScale:{value:new v0(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new S0},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new S0}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new S0}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new S0}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new f2(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new f2(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new S0},alphaTest:{value:0},uvTransform:{value:new S0}},sprite:{diffuse:{value:new f2(16777215)},opacity:{value:1},center:{value:new v0(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new S0},alphaMap:{value:null},alphaMapTransform:{value:new S0},alphaTest:{value:0}}},d4={basic:{uniforms:K2([u4.common,u4.specularmap,u4.envmap,u4.aomap,u4.lightmap,u4.fog]),vertexShader:c4.meshbasic_vert,fragmentShader:c4.meshbasic_frag},lambert:{uniforms:K2([u4.common,u4.specularmap,u4.envmap,u4.aomap,u4.lightmap,u4.emissivemap,u4.bumpmap,u4.normalmap,u4.displacementmap,u4.fog,u4.lights,{emissive:{value:new f2(0)}}]),vertexShader:c4.meshlambert_vert,fragmentShader:c4.meshlambert_frag},phong:{uniforms:K2([u4.common,u4.specularmap,u4.envmap,u4.aomap,u4.lightmap,u4.emissivemap,u4.bumpmap,u4.normalmap,u4.displacementmap,u4.fog,u4.lights,{emissive:{value:new f2(0)},specular:{value:new f2(1118481)},shininess:{value:30}}]),vertexShader:c4.meshphong_vert,fragmentShader:c4.meshphong_frag},standard:{uniforms:K2([u4.common,u4.envmap,u4.aomap,u4.lightmap,u4.emissivemap,u4.bumpmap,u4.normalmap,u4.displacementmap,u4.roughnessmap,u4.metalnessmap,u4.fog,u4.lights,{emissive:{value:new f2(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:c4.meshphysical_vert,fragmentShader:c4.meshphysical_frag},toon:{uniforms:K2([u4.common,u4.aomap,u4.lightmap,u4.emissivemap,u4.bumpmap,u4.normalmap,u4.displacementmap,u4.gradientmap,u4.fog,u4.lights,{emissive:{value:new f2(0)}}]),vertexShader:c4.meshtoon_vert,fragmentShader:c4.meshtoon_frag},matcap:{uniforms:K2([u4.common,u4.bumpmap,u4.normalmap,u4.displacementmap,u4.fog,{matcap:{value:null}}]),vertexShader:c4.meshmatcap_vert,fragmentShader:c4.meshmatcap_frag},points:{uniforms:K2([u4.points,u4.fog]),vertexShader:c4.points_vert,fragmentShader:c4.points_frag},dashed:{uniforms:K2([u4.common,u4.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:c4.linedashed_vert,fragmentShader:c4.linedashed_frag},depth:{uniforms:K2([u4.common,u4.displacementmap]),vertexShader:c4.depth_vert,fragmentShader:c4.depth_frag},normal:{uniforms:K2([u4.common,u4.bumpmap,u4.normalmap,u4.displacementmap,{opacity:{value:1}}]),vertexShader:c4.meshnormal_vert,fragmentShader:c4.meshnormal_frag},sprite:{uniforms:K2([u4.sprite,u4.fog]),vertexShader:c4.sprite_vert,fragmentShader:c4.sprite_frag},background:{uniforms:{uvTransform:{value:new S0},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:c4.background_vert,fragmentShader:c4.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new S0}},vertexShader:c4.backgroundCube_vert,fragmentShader:c4.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:c4.cube_vert,fragmentShader:c4.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:c4.equirect_vert,fragmentShader:c4.equirect_frag},distanceRGBA:{uniforms:K2([u4.common,u4.displacementmap,{referencePosition:{value:new _0},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:c4.distanceRGBA_vert,fragmentShader:c4.distanceRGBA_frag},shadow:{uniforms:K2([u4.lights,u4.fog,{color:{value:new f2(0)},opacity:{value:1}}]),vertexShader:c4.shadow_vert,fragmentShader:c4.shadow_frag}};d4.physical={uniforms:K2([d4.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new S0},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new S0},clearcoatNormalScale:{value:new v0(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new S0},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new S0},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new S0},sheen:{value:0},sheenColor:{value:new f2(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new S0},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new S0},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new S0},transmissionSamplerSize:{value:new v0},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new S0},attenuationDistance:{value:0},attenuationColor:{value:new f2(0)},specularColor:{value:new f2(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new S0},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new S0},anisotropyVector:{value:new v0},anisotropyMap:{value:null},anisotropyMapTransform:{value:new S0}}]),vertexShader:c4.meshphysical_vert,fragmentShader:c4.meshphysical_frag};const h4={r:0,b:0,g:0},f4=new P1,p4=new x1;function m4(e,t,n,i,r,s,a){const o=new f2(0);let l,c,u=!0===s?0:1,d=null,h=0,f=null;function p(e){let i=!0===e.isScene?e.background:null;if(i&&i.isTexture){i=(e.backgroundBlurriness>0?n:t).get(i)}return i}function m(t,n){t.getRGB(h4,q2(e)),i.buffers.color.setClear(h4.r,h4.g,h4.b,n,a)}return{getClearColor:function(){return o},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;o.set(e),u=t,m(o,u)},getClearAlpha:function(){return u},setClearAlpha:function(e){u=e,m(o,u)},render:function(t){let n=!1;const r=p(t);null===r?m(o,u):r&&r.isColor&&(m(r,1),n=!0);const s=e.xr.getEnvironmentBlendMode();"additive"===s?i.buffers.color.setClear(0,0,0,1,a):"alpha-blend"===s&&i.buffers.color.setClear(0,0,0,0,a),(e.autoClear||n)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,n){const i=p(n);i&&(i.isCubeTexture||i.mapping===RZ)?(void 0===c&&(c=new W2(new Y2(1,1,1),new Q2({name:"BackgroundCubeMaterial",uniforms:X2(d4.backgroundCube.uniforms),vertexShader:d4.backgroundCube.vertexShader,fragmentShader:d4.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),f4.copy(n.backgroundRotation),f4.x*=-1,f4.y*=-1,f4.z*=-1,i.isCubeTexture&&!1===i.isRenderTargetTexture&&(f4.y*=-1,f4.z*=-1),c.material.uniforms.envMap.value=i,c.material.uniforms.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(p4.makeRotationFromEuler(f4)),c.material.toneMapped=I0.getTransfer(i.colorSpace)!==j$,d===i&&h===i.version&&f===e.toneMapping||(c.material.needsUpdate=!0,d=i,h=i.version,f=e.toneMapping),c.layers.enableAll(),t.unshift(c,c.geometry,c.material,0,0,null)):i&&i.isTexture&&(void 0===l&&(l=new W2(new b3(2,2),new Q2({name:"BackgroundMaterial",uniforms:X2(d4.background.uniforms),vertexShader:d4.background.vertexShader,fragmentShader:d4.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=i,l.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,l.material.toneMapped=I0.getTransfer(i.colorSpace)!==j$,!0===i.matrixAutoUpdate&&i.updateMatrix(),l.material.uniforms.uvTransform.value.copy(i.matrix),d===i&&h===i.version&&f===e.toneMapping||(l.material.needsUpdate=!0,d=i,h=i.version,f=e.toneMapping),l.layers.enableAll(),t.unshift(l,l.geometry,l.material,0,0,null))},dispose:function(){void 0!==c&&(c.geometry.dispose(),c.material.dispose(),c=void 0),void 0!==l&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}}}function g4(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS),i={},r=c(null);let s=r,a=!1;function o(t){return e.bindVertexArray(t)}function l(t){return e.deleteVertexArray(t)}function c(e){const t=[],i=[],r=[];for(let s=0;s<n;s++)t[s]=0,i[s]=0,r[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:i,attributeDivisors:r,object:e,attributes:{},index:null}}function u(){const e=s.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function d(e){h(e,0)}function h(t,n){const i=s.newAttributes,r=s.enabledAttributes,a=s.attributeDivisors;i[t]=1,0===r[t]&&(e.enableVertexAttribArray(t),r[t]=1),a[t]!==n&&(e.vertexAttribDivisor(t,n),a[t]=n)}function f(){const t=s.newAttributes,n=s.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==t[i]&&(e.disableVertexAttribArray(i),n[i]=0)}function p(t,n,i,r,s,a,o){!0===o?e.vertexAttribIPointer(t,n,i,s,a):e.vertexAttribPointer(t,n,i,r,s,a)}function m(){g(),a=!0,s!==r&&(s=r,o(s.object))}function g(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:function(n,r,l,m,g){let v=!1;const y=function(t,n,r){const s=!0===r.wireframe;let a=i[t.id];void 0===a&&(a={},i[t.id]=a);let o=a[n.id];void 0===o&&(o={},a[n.id]=o);let l=o[s];void 0===l&&(l=c(e.createVertexArray()),o[s]=l);return l}(m,l,r);s!==y&&(s=y,o(s.object)),v=function(e,t,n,i){const r=s.attributes,a=t.attributes;let o=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){const t=r[s];let n=a[s];if(void 0===n&&("instanceMatrix"===s&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===s&&e.instanceColor&&(n=e.instanceColor)),void 0===t)return!0;if(t.attribute!==n)return!0;if(n&&t.data!==n.data)return!0;o++}}return s.attributesNum!==o||s.index!==i}(n,m,l,g),v&&function(e,t,n,i){const r={},a=t.attributes;let o=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){let t=a[s];void 0===t&&("instanceMatrix"===s&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===s&&e.instanceColor&&(t=e.instanceColor));const n={};n.attribute=t,t&&t.data&&(n.data=t.data),r[s]=n,o++}}s.attributes=r,s.attributesNum=o,s.index=i}(n,m,l,g),null!==g&&t.update(g,e.ELEMENT_ARRAY_BUFFER),(v||a)&&(a=!1,function(n,i,r,s){u();const a=s.attributes,o=r.getAttributes(),l=i.defaultAttributeValues;for(const c in o){const i=o[c];if(i.location>=0){let r=a[c];if(void 0===r&&("instanceMatrix"===c&&n.instanceMatrix&&(r=n.instanceMatrix),"instanceColor"===c&&n.instanceColor&&(r=n.instanceColor)),void 0!==r){const a=r.normalized,o=r.itemSize,l=t.get(r);if(void 0===l)continue;const c=l.buffer,u=l.type,f=l.bytesPerElement,m=u===e.INT||u===e.UNSIGNED_INT||r.gpuType===VZ;if(r.isInterleavedBufferAttribute){const t=r.data,l=t.stride,g=r.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<i.locationSize;e++)h(i.location+e,t.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<i.locationSize;e++)d(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)p(i.location+e,o/i.locationSize,u,a,l*f,(g+o/i.locationSize*e)*f,m)}else{if(r.isInstancedBufferAttribute){for(let e=0;e<i.locationSize;e++)h(i.location+e,r.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=r.meshPerAttribute*r.count)}else for(let e=0;e<i.locationSize;e++)d(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)p(i.location+e,o/i.locationSize,u,a,o*f,o/i.locationSize*e*f,m)}}else if(void 0!==l){const t=l[c];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(i.location,t);break;case 3:e.vertexAttrib3fv(i.location,t);break;case 4:e.vertexAttrib4fv(i.location,t);break;default:e.vertexAttrib1fv(i.location,t)}}}}f()}(n,r,l,m),null!==g&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(g).buffer))},reset:m,resetDefaultState:g,dispose:function(){m();for(const e in i){const t=i[e];for(const e in t){const n=t[e];for(const e in n)l(n[e].object),delete n[e];delete t[e]}delete i[e]}},releaseStatesOfGeometry:function(e){if(void 0===i[e.id])return;const t=i[e.id];for(const n in t){const e=t[n];for(const t in e)l(e[t].object),delete e[t];delete t[n]}delete i[e.id]},releaseStatesOfProgram:function(e){for(const t in i){const n=i[t];if(void 0===n[e.id])continue;const r=n[e.id];for(const e in r)l(r[e].object),delete r[e];delete n[e.id]}},initAttributes:u,enableAttribute:d,disableUnusedAttributes:f}}function v4(e,t,n){let i;function r(t,r,s){0!==s&&(e.drawArraysInstanced(i,t,r,s),n.update(r,i,s))}this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i,1)},this.renderInstances=r,this.renderMultiDraw=function(e,r,s){if(0===s)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,e,0,r,0,s);let a=0;for(let t=0;t<s;t++)a+=r[t];n.update(a,i,1)},this.renderMultiDrawInstances=function(e,s,a,o){if(0===a)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)r(e[t],s[t],o[t]);else{l.multiDrawArraysInstancedWEBGL(i,e,0,s,0,o,0,a);let t=0;for(let e=0;e<a;e++)t+=s[e]*o[e];n.update(t,i,1)}}}function y4(e,t,n,i){let r;function s(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let a=void 0!==n.precision?n.precision:"highp";const o=s(a);o!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",o,"instead."),a=o);const l=!0===n.logarithmicDepthBuffer,c=!0===n.reversedDepthBuffer&&t.has("EXT_clip_control"),u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:s,textureFormatReadable:function(t){return t===QZ||i.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const r=n===YZ&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(n!==UZ&&i.convert(n)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==jZ&&!r)},precision:a,logarithmicDepthBuffer:l,reversedDepthBuffer:c,maxTextures:u,maxVertexTextures:d,maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubemapSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:e.getParameter(e.MAX_VERTEX_ATTRIBS),maxVertexUniforms:e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:e.getParameter(e.MAX_VARYING_VECTORS),maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:d>0,maxSamples:e.getParameter(e.MAX_SAMPLES)}}function _4(e){const t=this;let n=null,i=0,r=!1,s=!1;const a=new p3,o=new S0,l={value:null,needsUpdate:!1};function c(e,n,i,r){const s=null!==e?e.length:0;let c=null;if(0!==s){if(c=l.value,!0!==r||null===c){const t=i+4*s,r=n.matrixWorldInverse;o.getNormalMatrix(r),(null===c||c.length<t)&&(c=new Float32Array(t));for(let n=0,l=i;n!==s;++n,l+=4)a.copy(e[n]).applyMatrix4(r,o),a.normal.toArray(c,l),c[l+3]=a.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const n=0!==e.length||t||0!==i||r;return r=t,i=e.length,n},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(e,t){n=c(e,t,0)},this.setState=function(a,o,u){const d=a.clippingPlanes,h=a.clipIntersection,f=a.clipShadows,p=e.get(a);if(!r||null===d||0===d.length||s&&!f)s?c(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=i>0);t.numPlanes=i,t.numIntersection=0}();else{const e=s?0:i,t=4*e;let r=p.clippingState||null;l.value=r,r=c(d,o,t,u);for(let i=0;i!==t;++i)r[i]=n[i];p.clippingState=r,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=e}}}function b4(e){let t=new WeakMap;function n(e,t){return t===AZ?e.mapping=TZ:t===CZ&&(e.mapping=MZ),e}function i(e){const n=e.target;n.removeEventListener("dispose",i);const r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping;if(s===AZ||s===CZ){if(t.has(r)){return n(t.get(r).texture,r.mapping)}{const s=r.image;if(s&&s.height>0){const a=new a3(s.height);return a.fromEquirectangularTexture(e,r),t.set(r,a),r.addEventListener("dispose",i),n(a.texture,r.mapping)}return null}}}return r},dispose:function(){t=new WeakMap}}}const x4=[.125,.215,.35,.446,.526,.582],S4=20,E4=new X3,w4=new f2;let T4=null,M4=0,A4=0,C4=!1;const R4=(1+Math.sqrt(5))/2,L4=1/R4,P4=[new _0(-R4,L4,0),new _0(R4,L4,0),new _0(-L4,0,R4),new _0(L4,0,R4),new _0(0,R4,-L4),new _0(0,R4,L4),new _0(-1,1,-1),new _0(1,1,-1),new _0(-1,1,1),new _0(1,1,1)],I4=new _0;class D4{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const{size:s=256,position:a=I4}=r;T4=this._renderer.getRenderTarget(),M4=this._renderer.getActiveCubeFace(),A4=this._renderer.getActiveMipmapLevel(),C4=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(s);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,n,i,o,a),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=F4(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=N4(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(T4,M4,A4),this._renderer.xr.enabled=C4,e.scissorTest=!1,O4(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===TZ||e.mapping===MZ?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),T4=this._renderer.getRenderTarget(),M4=this._renderer.getActiveCubeFace(),A4=this._renderer.getActiveMipmapLevel(),C4=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:NZ,minFilter:NZ,generateMipmaps:!1,type:YZ,format:QZ,colorSpace:V$,depthBuffer:!1},i=k4(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=k4(e,t,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],n=[],i=[];let r=e;const s=e-4+1+x4.length;for(let a=0;a<s;a++){const s=Math.pow(2,r);n.push(s);let o=1/s;a>e-4?o=x4[a-e+4-1]:0===a&&(o=0),i.push(o);const l=1/(s-2),c=-l,u=1+l,d=[c,c,u,c,u,u,c,c,u,u,c,u],h=6,f=6,p=3,m=2,g=1,v=new Float32Array(p*f*h),y=new Float32Array(m*f*h),_=new Float32Array(g*f*h);for(let e=0;e<h;e++){const t=e%3*2/3-1,n=e>2?0:-1,i=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];v.set(i,p*f*e),y.set(d,m*f*e);const r=[e,e,e,e,e,e];_.set(r,g*f*e)}const b=new I2;b.setAttribute("position",new x2(v,p)),b.setAttribute("uv",new x2(y,m)),b.setAttribute("faceIndex",new x2(_,g)),t.push(b),r>4&&r--}return{lodPlanes:t,sizeLods:n,sigmas:i}}(i)),this._blurMaterial=function(e,t,n){const i=new Float32Array(S4),r=new _0(0,1,0),s=new Q2({name:"SphericalGaussianBlur",defines:{n:S4,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return s}(i,e,t)}return i}_compileMaterial(e){const t=new W2(this._lodPlanes[0],e);this._renderer.compile(t,E4)}_sceneToCubeUV(e,t,n,i,r){const s=new n3(90,1,t,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],l=this._renderer,c=l.autoClear,u=l.toneMapping;l.getClearColor(w4),l.toneMapping=0,l.autoClear=!1;l.state.buffers.depth.getReversed()&&(l.setRenderTarget(i),l.clearDepth(),l.setRenderTarget(null));const d=new v2({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),h=new W2(new Y2,d);let f=!1;const p=e.background;p?p.isColor&&(d.color.copy(p),e.background=null,f=!0):(d.color.copy(w4),f=!0);for(let m=0;m<6;m++){const t=m%3;0===t?(s.up.set(0,a[m],0),s.position.set(r.x,r.y,r.z),s.lookAt(r.x+o[m],r.y,r.z)):1===t?(s.up.set(0,0,a[m]),s.position.set(r.x,r.y,r.z),s.lookAt(r.x,r.y+o[m],r.z)):(s.up.set(0,a[m],0),s.position.set(r.x,r.y,r.z),s.lookAt(r.x,r.y,r.z+o[m]));const n=this._cubeSize;O4(i,t*n,m>2?n:0,n,n),l.setRenderTarget(i),f&&l.render(h,s),l.render(e,s)}h.geometry.dispose(),h.material.dispose(),l.toneMapping=u,l.autoClear=c,e.background=p}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===TZ||e.mapping===MZ;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=F4()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=N4());const r=i?this._cubemapMaterial:this._equirectMaterial,s=new W2(this._lodPlanes[0],r);r.uniforms.envMap.value=e;const a=this._cubeSize;O4(t,0,0,3*a,2*a),n.setRenderTarget(t),n.render(s,E4)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const i=this._lodPlanes.length;for(let r=1;r<i;r++){const t=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),n=P4[(i-r-1)%P4.length];this._blur(e,r-1,r,t,n)}t.autoClear=n}_blur(e,t,n,i,r){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,n,i,"latitudinal",r),this._halfBlur(s,e,n,n,i,"longitudinal",r)}_halfBlur(e,t,n,i,r,s,a){const o=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new W2(this._lodPlanes[i],l),u=l.uniforms,d=this._sizeLods[n]-1,h=isFinite(r)?Math.PI/(2*d):2*Math.PI/39,f=r/h,p=isFinite(r)?1+Math.floor(3*f):S4;p>S4&&console.warn("sigmaRadians, ".concat(r,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(S4));const m=[];let g=0;for(let _=0;_<S4;++_){const e=_/f,t=Math.exp(-e*e/2);m.push(t),0===_?g+=t:_<p&&(g+=2*t)}for(let _=0;_<m.length;_++)m[_]=m[_]/g;u.envMap.value=e.texture,u.samples.value=p,u.weights.value=m,u.latitudinal.value="latitudinal"===s,a&&(u.poleAxis.value=a);const{_lodMax:v}=this;u.dTheta.value=h,u.mipInt.value=v-n;const y=this._sizeLods[i];O4(t,3*y*(i>v-4?i-v+4:0),4*(this._cubeSize-y),3*y,2*y),o.setRenderTarget(t),o.render(c,E4)}}function k4(e,t,n){const i=new j0(e,t,n);return i.texture.mapping=RZ,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function O4(e,t,n,i,r){e.viewport.set(t,n,i,r),e.scissor.set(t,n,i,r)}function N4(){return new Q2({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function F4(){return new Q2({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function B4(e){let t=new WeakMap,n=null;function i(e){const n=e.target;n.removeEventListener("dispose",i);const r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping,a=s===AZ||s===CZ,o=s===TZ||s===MZ;if(a||o){let s=t.get(r);const l=void 0!==s?s.texture.pmremVersion:0;if(r.isRenderTargetTexture&&r.pmremVersion!==l)return null===n&&(n=new D4(e)),s=a?n.fromEquirectangular(r,s):n.fromCubemap(r,s),s.texture.pmremVersion=r.pmremVersion,t.set(r,s),s.texture;if(void 0!==s)return s.texture;{const l=r.image;return a&&l&&l.height>0||o&&l&&function(e){let t=0;const n=6;for(let i=0;i<n;i++)void 0!==e[i]&&t++;return t===n}(l)?(null===n&&(n=new D4(e)),s=a?n.fromEquirectangular(r):n.fromCubemap(r),s.texture.pmremVersion=r.pmremVersion,t.set(r,s),r.addEventListener("dispose",i),s.texture):null}}}return r},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function U4(e){const t={};function n(n){if(void 0!==t[n])return t[n];let i;switch(n){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return t[n]=i,i}return{has:function(e){return null!==n(e)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(e){const t=n(e);return null===t&&C0("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function H4(e,t,n,i){const r={},s=new WeakMap;function a(e){const o=e.target;null!==o.index&&t.remove(o.index);for(const n in o.attributes)t.remove(o.attributes[n]);o.removeEventListener("dispose",a),delete r[o.id];const l=s.get(o);l&&(t.remove(l),s.delete(o)),i.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,n.memory.geometries--}function o(e){const n=[],i=e.index,r=e.attributes.position;let a=0;if(null!==i){const e=i.array;a=i.version;for(let t=0,i=e.length;t<i;t+=3){const i=e[t+0],r=e[t+1],s=e[t+2];n.push(i,r,r,s,s,i)}}else{if(void 0===r)return;{const e=r.array;a=r.version;for(let t=0,i=e.length/3-1;t<i;t+=3){const e=t+0,i=t+1,r=t+2;n.push(e,i,i,r,r,e)}}}const o=new(w0(n)?E2:S2)(n,1);o.version=a;const l=s.get(e);l&&t.remove(l),s.set(e,o)}return{get:function(e,t){return!0===r[t.id]||(t.addEventListener("dispose",a),r[t.id]=!0,n.memory.geometries++),t},update:function(n){const i=n.attributes;for(const r in i)t.update(i[r],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){const t=s.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&o(e)}else o(e);return s.get(e)}}}function z4(e,t,n){let i,r,s;function a(t,a,o){0!==o&&(e.drawElementsInstanced(i,a,r,t*s,o),n.update(a,i,o))}this.setMode=function(e){i=e},this.setIndex=function(e){r=e.type,s=e.bytesPerElement},this.render=function(t,a){e.drawElements(i,a,r,t*s),n.update(a,i,1)},this.renderInstances=a,this.renderMultiDraw=function(e,s,a){if(0===a)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,s,0,r,e,0,a);let o=0;for(let t=0;t<a;t++)o+=s[t];n.update(o,i,1)},this.renderMultiDrawInstances=function(e,o,l,c){if(0===l)return;const u=t.get("WEBGL_multi_draw");if(null===u)for(let t=0;t<e.length;t++)a(e[t]/s,o[t],c[t]);else{u.multiDrawElementsInstancedWEBGL(i,o,0,r,e,0,c,0,l);let t=0;for(let e=0;e<l;e++)t+=o[e]*c[e];n.update(t,i,1)}}}function G4(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,i,r){switch(t.calls++,i){case e.TRIANGLES:t.triangles+=r*(n/3);break;case e.LINES:t.lines+=r*(n/2);break;case e.LINE_STRIP:t.lines+=r*(n-1);break;case e.LINE_LOOP:t.lines+=r*n;break;case e.POINTS:t.points+=r*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i)}}}}function V4(e,t,n){const i=new WeakMap,r=new V0;return{update:function(s,a,o){const l=s.morphTargetInfluences,c=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,u=void 0!==c?c.length:0;let d=i.get(a);if(void 0===d||d.count!==u){void 0!==d&&d.texture.dispose();const h=void 0!==a.morphAttributes.position,f=void 0!==a.morphAttributes.normal,p=void 0!==a.morphAttributes.color,m=a.morphAttributes.position||[],g=a.morphAttributes.normal||[],v=a.morphAttributes.color||[];let y=0;!0===h&&(y=1),!0===f&&(y=2),!0===p&&(y=3);let _=a.attributes.position.count*y,b=1;_>t.maxTextureSize&&(b=Math.ceil(_/t.maxTextureSize),_=t.maxTextureSize);const x=new Float32Array(_*b*4*u),S=new Y0(x,_,b,u);S.type=jZ,S.needsUpdate=!0;const E=4*y;for(let T=0;T<u;T++){const M=m[T],A=g[T],C=v[T],R=_*b*4*T;for(let L=0;L<M.count;L++){const P=L*E;!0===h&&(r.fromBufferAttribute(M,L),x[R+P+0]=r.x,x[R+P+1]=r.y,x[R+P+2]=r.z,x[R+P+3]=0),!0===f&&(r.fromBufferAttribute(A,L),x[R+P+4]=r.x,x[R+P+5]=r.y,x[R+P+6]=r.z,x[R+P+7]=0),!0===p&&(r.fromBufferAttribute(C,L),x[R+P+8]=r.x,x[R+P+9]=r.y,x[R+P+10]=r.z,x[R+P+11]=4===C.itemSize?r.w:1)}}function w(){S.dispose(),i.delete(a),a.removeEventListener("dispose",w)}d={count:u,texture:S,size:new v0(_,b)},i.set(a,d),a.addEventListener("dispose",w)}if(!0===s.isInstancedMesh&&null!==s.morphTexture)o.getUniforms().setValue(e,"morphTexture",s.morphTexture,n);else{let I=0;for(let k=0;k<l.length;k++)I+=l[k];const D=a.morphTargetsRelative?1:1-I;o.getUniforms().setValue(e,"morphTargetBaseInfluence",D),o.getUniforms().setValue(e,"morphTargetInfluences",l)}o.getUniforms().setValue(e,"morphTargetsTexture",d.texture,n),o.getUniforms().setValue(e,"morphTargetsTextureSize",d.size)}}}function W4(e,t,n,i){let r=new WeakMap;function s(e){const t=e.target;t.removeEventListener("dispose",s),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(a){const o=i.render.frame,l=a.geometry,c=t.get(a,l);if(r.get(c)!==o&&(t.update(c),r.set(c,o)),a.isInstancedMesh&&(!1===a.hasEventListener("dispose",s)&&a.addEventListener("dispose",s),r.get(a)!==o&&(n.update(a.instanceMatrix,e.ARRAY_BUFFER),null!==a.instanceColor&&n.update(a.instanceColor,e.ARRAY_BUFFER),r.set(a,o))),a.isSkinnedMesh){const e=a.skeleton;r.get(e)!==o&&(e.update(),r.set(e,o))}return c},dispose:function(){r=new WeakMap}}}const j4=new G0,Y4=new _3(1,1),X4=new Y0,K4=new X0,q4=new s3,J4=[],Q4=[],Z4=new Float32Array(16),$4=new Float32Array(9),e5=new Float32Array(4);function t5(e,t,n){const i=e[0];if(i<=0||i>0)return e;const r=t*n;let s=J4[r];if(void 0===s&&(s=new Float32Array(r),J4[r]=s),0!==t){i.toArray(s,0);for(let i=1,r=0;i!==t;++i)r+=n,e[i].toArray(s,r)}return s}function n5(e,t){if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function i5(e,t){for(let n=0,i=t.length;n<i;n++)e[n]=t[n]}function r5(e,t){let n=Q4[t];void 0===n&&(n=new Int32Array(t),Q4[t]=n);for(let i=0;i!==t;++i)n[i]=e.allocateTextureUnit();return n}function s5(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function a5(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(n5(n,t))return;e.uniform2fv(this.addr,t),i5(n,t)}}function o5(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(n5(n,t))return;e.uniform3fv(this.addr,t),i5(n,t)}}function l5(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(n5(n,t))return;e.uniform4fv(this.addr,t),i5(n,t)}}function c5(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(n5(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),i5(n,t)}else{if(n5(n,i))return;e5.set(i),e.uniformMatrix2fv(this.addr,!1,e5),i5(n,i)}}function u5(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(n5(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),i5(n,t)}else{if(n5(n,i))return;$4.set(i),e.uniformMatrix3fv(this.addr,!1,$4),i5(n,i)}}function d5(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(n5(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),i5(n,t)}else{if(n5(n,i))return;Z4.set(i),e.uniformMatrix4fv(this.addr,!1,Z4),i5(n,i)}}function h5(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function f5(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(n5(n,t))return;e.uniform2iv(this.addr,t),i5(n,t)}}function p5(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(n5(n,t))return;e.uniform3iv(this.addr,t),i5(n,t)}}function m5(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(n5(n,t))return;e.uniform4iv(this.addr,t),i5(n,t)}}function g5(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function v5(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(n5(n,t))return;e.uniform2uiv(this.addr,t),i5(n,t)}}function y5(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(n5(n,t))return;e.uniform3uiv(this.addr,t),i5(n,t)}}function _5(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(n5(n,t))return;e.uniform4uiv(this.addr,t),i5(n,t)}}function b5(e,t,n){const i=this.cache,r=n.allocateTextureUnit();let s;i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),this.type===e.SAMPLER_2D_SHADOW?(Y4.compareFunction=515,s=Y4):s=j4,n.setTexture2D(t||s,r)}function x5(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(t||K4,r)}function S5(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(t||q4,r)}function E5(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(t||X4,r)}function w5(e,t){e.uniform1fv(this.addr,t)}function T5(e,t){const n=t5(t,this.size,2);e.uniform2fv(this.addr,n)}function M5(e,t){const n=t5(t,this.size,3);e.uniform3fv(this.addr,n)}function A5(e,t){const n=t5(t,this.size,4);e.uniform4fv(this.addr,n)}function C5(e,t){const n=t5(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function R5(e,t){const n=t5(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function L5(e,t){const n=t5(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function P5(e,t){e.uniform1iv(this.addr,t)}function I5(e,t){e.uniform2iv(this.addr,t)}function D5(e,t){e.uniform3iv(this.addr,t)}function k5(e,t){e.uniform4iv(this.addr,t)}function O5(e,t){e.uniform1uiv(this.addr,t)}function N5(e,t){e.uniform2uiv(this.addr,t)}function F5(e,t){e.uniform3uiv(this.addr,t)}function B5(e,t){e.uniform4uiv(this.addr,t)}function U5(e,t,n){const i=this.cache,r=t.length,s=r5(n,r);n5(i,s)||(e.uniform1iv(this.addr,s),i5(i,s));for(let a=0;a!==r;++a)n.setTexture2D(t[a]||j4,s[a])}function H5(e,t,n){const i=this.cache,r=t.length,s=r5(n,r);n5(i,s)||(e.uniform1iv(this.addr,s),i5(i,s));for(let a=0;a!==r;++a)n.setTexture3D(t[a]||K4,s[a])}function z5(e,t,n){const i=this.cache,r=t.length,s=r5(n,r);n5(i,s)||(e.uniform1iv(this.addr,s),i5(i,s));for(let a=0;a!==r;++a)n.setTextureCube(t[a]||q4,s[a])}function G5(e,t,n){const i=this.cache,r=t.length,s=r5(n,r);n5(i,s)||(e.uniform1iv(this.addr,s),i5(i,s));for(let a=0;a!==r;++a)n.setTexture2DArray(t[a]||X4,s[a])}class V5{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return s5;case 35664:return a5;case 35665:return o5;case 35666:return l5;case 35674:return c5;case 35675:return u5;case 35676:return d5;case 5124:case 35670:return h5;case 35667:case 35671:return f5;case 35668:case 35672:return p5;case 35669:case 35673:return m5;case 5125:return g5;case 36294:return v5;case 36295:return y5;case 36296:return _5;case 35678:case 36198:case 36298:case 36306:case 35682:return b5;case 35679:case 36299:case 36307:return x5;case 35680:case 36300:case 36308:case 36293:return S5;case 36289:case 36303:case 36311:case 36292:return E5}}(t.type)}}class W5{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return w5;case 35664:return T5;case 35665:return M5;case 35666:return A5;case 35674:return C5;case 35675:return R5;case 35676:return L5;case 5124:case 35670:return P5;case 35667:case 35671:return I5;case 35668:case 35672:return D5;case 35669:case 35673:return k5;case 5125:return O5;case 36294:return N5;case 36295:return F5;case 36296:return B5;case 35678:case 36198:case 36298:case 36306:case 35682:return U5;case 35679:case 36299:case 36307:return H5;case 35680:case 36300:case 36308:case 36293:return z5;case 36289:case 36303:case 36311:case 36292:return G5}}(t.type)}}class j5{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const s=i[r];s.setValue(e,t[s.id],n)}}}const Y5=/(\w+)(\])?(\[|\.)?/g;function X5(e,t){e.seq.push(t),e.map[t.id]=t}function K5(e,t,n){const i=e.name,r=i.length;for(Y5.lastIndex=0;;){const s=Y5.exec(i),a=Y5.lastIndex;let o=s[1];const l="]"===s[2],c=s[3];if(l&&(o|=0),void 0===c||"["===c&&a+2===r){X5(n,void 0===c?new V5(o,e,t):new W5(o,e,t));break}{let e=n.map[o];void 0===e&&(e=new j5(o),X5(n,e)),n=e}}}class q5{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const n=e.getActiveUniform(t,i);K5(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,i){const r=this.map[t];void 0!==r&&r.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];void 0!==i&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let r=0,s=t.length;r!==s;++r){const s=t[r],a=n[s.id];!1!==a.needsUpdate&&s.setValue(e,a.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,r=e.length;i!==r;++i){const r=e[i];r.id in t&&n.push(r)}return n}}function J5(e,t,n){const i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),i}let Q5=0;const Z5=new S0;function $5(e,t,n){const i=e.getShaderParameter(t,e.COMPILE_STATUS),r=(e.getShaderInfoLog(t)||"").trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const i=parseInt(s[1]);return n.toUpperCase()+"\n\n"+r+"\n\n"+function(e,t){const n=e.split("\n"),i=[],r=Math.max(t-6,0),s=Math.min(t+6,n.length);for(let a=r;a<s;a++){const e=a+1;i.push("".concat(e===t?">":" "," ").concat(e,": ").concat(n[a]))}return i.join("\n")}(e.getShaderSource(t),i)}return r}function e6(e,t){const n=function(e){I0._getMatrix(Z5,I0.workingColorSpace,e);const t="mat3( ".concat(Z5.elements.map(e=>e.toFixed(4))," )");switch(I0.getTransfer(e)){case W$:return[t,"LinearTransferOETF"];case j$:return[t,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}(t);return["vec4 ".concat(e,"( vec4 value ) {"),"\treturn ".concat(n[1],"( vec4( value.rgb * ").concat(n[0],", value.a ) );"),"}"].join("\n")}function t6(e,t){let n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Cineon";break;case 4:n="ACESFilmic";break;case 6:n="AgX";break;case 7:n="Neutral";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const n6=new _0;function i6(){I0.getLuminanceCoefficients(n6);const e=n6.x.toFixed(4),t=n6.y.toFixed(4),n=n6.z.toFixed(4);return["float luminance( const in vec3 rgb ) {","\tconst vec3 weights = vec3( ".concat(e,", ").concat(t,", ").concat(n," );"),"\treturn dot( weights, rgb );","}"].join("\n")}function r6(e){return""!==e}function s6(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function a6(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const o6=/^[ \t]*#include +<([\w\d./]+)>/gm;function l6(e){return e.replace(o6,u6)}const c6=new Map;function u6(e,t){let n=c4[t];if(void 0===n){const e=c6.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");n=c4[e],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return l6(n)}const d6=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function h6(e){return e.replace(d6,f6)}function f6(e,t,n,i){let r="";for(let s=parseInt(t);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function p6(e){let t="precision ".concat(e.precision," float;\n\tprecision ").concat(e.precision," int;\n\tprecision ").concat(e.precision," sampler2D;\n\tprecision ").concat(e.precision," samplerCube;\n\tprecision ").concat(e.precision," sampler3D;\n\tprecision ").concat(e.precision," sampler2DArray;\n\tprecision ").concat(e.precision," sampler2DShadow;\n\tprecision ").concat(e.precision," samplerCubeShadow;\n\tprecision ").concat(e.precision," sampler2DArrayShadow;\n\tprecision ").concat(e.precision," isampler2D;\n\tprecision ").concat(e.precision," isampler3D;\n\tprecision ").concat(e.precision," isamplerCube;\n\tprecision ").concat(e.precision," isampler2DArray;\n\tprecision ").concat(e.precision," usampler2D;\n\tprecision ").concat(e.precision," usampler3D;\n\tprecision ").concat(e.precision," usamplerCube;\n\tprecision ").concat(e.precision," usampler2DArray;\n\t");return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function m6(e,t,n,i){const r=e.getContext(),s=n.defines;let a=n.vertexShader,o=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case TZ:case MZ:t="ENVMAP_TYPE_CUBE";break;case RZ:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),u=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===MZ&&(t="ENVMAP_MODE_REFRACTION");return t}(n),d=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),h=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),f=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(r6).join("\n")}(n),p=function(e){const t=[];for(const n in e){const i=e[n];!1!==i&&t.push("#define "+n+" "+i)}return t.join("\n")}(s),m=r.createProgram();let g,v,y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(r6).join("\n"),g.length>0&&(g+="\n"),v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(r6).join("\n"),v.length>0&&(v+="\n")):(g=[p6(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reversedDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(r6).join("\n"),v=[p6(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reversedDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?c4.tonemapping_pars_fragment:"",0!==n.toneMapping?t6("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",c4.colorspace_pars_fragment,e6("linearToOutputTexel",n.outputColorSpace),i6(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(r6).join("\n")),a=l6(a),a=s6(a,n),a=a6(a,n),o=l6(o),o=s6(o,n),o=a6(o,n),a=h6(a),o=h6(o),!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",g=[f,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in",n.glslVersion===n0?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===n0?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const _=y+g+a,b=y+v+o,x=J5(r,r.VERTEX_SHADER,_),S=J5(r,r.FRAGMENT_SHADER,b);function E(t){if(e.debug.checkShaderErrors){const n=r.getProgramInfoLog(m)||"",i=r.getShaderInfoLog(x)||"",s=r.getShaderInfoLog(S)||"",a=n.trim(),o=i.trim(),l=s.trim();let c=!0,u=!0;if(!1===r.getProgramParameter(m,r.LINK_STATUS))if(c=!1,"function"===typeof e.debug.onShaderError)e.debug.onShaderError(r,m,x,S);else{const e=$5(r,x,"vertex"),n=$5(r,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,r.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+a+"\n"+e+"\n"+n)}else""!==a?console.warn("THREE.WebGLProgram: Program Info Log:",a):""!==o&&""!==l||(u=!1);u&&(t.diagnostics={runnable:c,programLog:a,vertexShader:{log:o,prefix:g},fragmentShader:{log:l,prefix:v}})}r.deleteShader(x),r.deleteShader(S),w=new q5(r,m),T=function(e,t){const n={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const i=e.getActiveAttrib(t,r),s=i.name;let a=1;i.type===e.FLOAT_MAT2&&(a=2),i.type===e.FLOAT_MAT3&&(a=3),i.type===e.FLOAT_MAT4&&(a=4),n[s]={type:i.type,location:e.getAttribLocation(t,s),locationSize:a}}return n}(r,m)}let w,T;r.attachShader(m,x),r.attachShader(m,S),void 0!==n.index0AttributeName?r.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),this.getUniforms=function(){return void 0===w&&E(this),w},this.getAttributes=function(){return void 0===T&&E(this),T};let M=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===M&&(M=r.getProgramParameter(m,37297)),M},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=Q5++,this.cacheKey=t,this.usedTimes=1,this.program=m,this.vertexShader=x,this.fragmentShader=S,this}let g6=0;class v6{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(e);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(r)&&(s.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new y6(e),t.set(e,n)),n}}class y6{constructor(e){this.id=g6++,this.code=e,this.usedTimes=0}}function _6(e,t,n,i,r,s,a){const o=new I1,l=new v6,c=new Set,u=[],d=r.logarithmicDepthBuffer,h=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(e){return c.add(e),0===e?"uv":"uv".concat(e)}return{getParameters:function(s,o,u,g,v){const y=g.fog,_=v.geometry,b=s.isMeshStandardMaterial?g.environment:null,x=(s.isMeshStandardMaterial?n:t).get(s.envMap||b),S=x&&x.mapping===RZ?x.image.height:null,E=p[s.type];null!==s.precision&&(f=r.getMaxPrecision(s.precision),f!==s.precision&&console.warn("THREE.WebGLProgram.getParameters:",s.precision,"not supported, using",f,"instead."));const w=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,T=void 0!==w?w.length:0;let M,A,C,R,L=0;if(void 0!==_.morphAttributes.position&&(L=1),void 0!==_.morphAttributes.normal&&(L=2),void 0!==_.morphAttributes.color&&(L=3),E){const e=d4[E];M=e.vertexShader,A=e.fragmentShader}else M=s.vertexShader,A=s.fragmentShader,l.update(s),C=l.getVertexShaderID(s),R=l.getFragmentShaderID(s);const P=e.getRenderTarget(),I=e.state.buffers.depth.getReversed(),D=!0===v.isInstancedMesh,k=!0===v.isBatchedMesh,O=!!s.map,N=!!s.matcap,F=!!x,B=!!s.aoMap,U=!!s.lightMap,H=!!s.bumpMap,z=!!s.normalMap,G=!!s.displacementMap,V=!!s.emissiveMap,W=!!s.metalnessMap,j=!!s.roughnessMap,Y=s.anisotropy>0,X=s.clearcoat>0,K=s.dispersion>0,q=s.iridescence>0,J=s.sheen>0,Q=s.transmission>0,Z=Y&&!!s.anisotropyMap,$=X&&!!s.clearcoatMap,ee=X&&!!s.clearcoatNormalMap,te=X&&!!s.clearcoatRoughnessMap,ne=q&&!!s.iridescenceMap,ie=q&&!!s.iridescenceThicknessMap,re=J&&!!s.sheenColorMap,se=J&&!!s.sheenRoughnessMap,ae=!!s.specularMap,oe=!!s.specularColorMap,le=!!s.specularIntensityMap,ce=Q&&!!s.transmissionMap,ue=Q&&!!s.thicknessMap,de=!!s.gradientMap,he=!!s.alphaMap,fe=s.alphaTest>0,pe=!!s.alphaHash,me=!!s.extensions;let ge=0;s.toneMapped&&(null!==P&&!0!==P.isXRRenderTarget||(ge=e.toneMapping));const ve={shaderID:E,shaderType:s.type,shaderName:s.name,vertexShader:M,fragmentShader:A,defines:s.defines,customVertexShaderID:C,customFragmentShaderID:R,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:f,batching:k,batchingColor:k&&null!==v._colorsTexture,instancing:D,instancingColor:D&&null!==v.instanceColor,instancingMorph:D&&null!==v.morphTexture,supportsVertexTextures:h,outputColorSpace:null===P?e.outputColorSpace:!0===P.isXRRenderTarget?P.texture.colorSpace:V$,alphaToCoverage:!!s.alphaToCoverage,map:O,matcap:N,envMap:F,envMapMode:F&&x.mapping,envMapCubeUVHeight:S,aoMap:B,lightMap:U,bumpMap:H,normalMap:z,displacementMap:h&&G,emissiveMap:V,normalMapObjectSpace:z&&1===s.normalMapType,normalMapTangentSpace:z&&0===s.normalMapType,metalnessMap:W,roughnessMap:j,anisotropy:Y,anisotropyMap:Z,clearcoat:X,clearcoatMap:$,clearcoatNormalMap:ee,clearcoatRoughnessMap:te,dispersion:K,iridescence:q,iridescenceMap:ne,iridescenceThicknessMap:ie,sheen:J,sheenColorMap:re,sheenRoughnessMap:se,specularMap:ae,specularColorMap:oe,specularIntensityMap:le,transmission:Q,transmissionMap:ce,thicknessMap:ue,gradientMap:de,opaque:!1===s.transparent&&1===s.blending&&!1===s.alphaToCoverage,alphaMap:he,alphaTest:fe,alphaHash:pe,combine:s.combine,mapUv:O&&m(s.map.channel),aoMapUv:B&&m(s.aoMap.channel),lightMapUv:U&&m(s.lightMap.channel),bumpMapUv:H&&m(s.bumpMap.channel),normalMapUv:z&&m(s.normalMap.channel),displacementMapUv:G&&m(s.displacementMap.channel),emissiveMapUv:V&&m(s.emissiveMap.channel),metalnessMapUv:W&&m(s.metalnessMap.channel),roughnessMapUv:j&&m(s.roughnessMap.channel),anisotropyMapUv:Z&&m(s.anisotropyMap.channel),clearcoatMapUv:$&&m(s.clearcoatMap.channel),clearcoatNormalMapUv:ee&&m(s.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:te&&m(s.clearcoatRoughnessMap.channel),iridescenceMapUv:ne&&m(s.iridescenceMap.channel),iridescenceThicknessMapUv:ie&&m(s.iridescenceThicknessMap.channel),sheenColorMapUv:re&&m(s.sheenColorMap.channel),sheenRoughnessMapUv:se&&m(s.sheenRoughnessMap.channel),specularMapUv:ae&&m(s.specularMap.channel),specularColorMapUv:oe&&m(s.specularColorMap.channel),specularIntensityMapUv:le&&m(s.specularIntensityMap.channel),transmissionMapUv:ce&&m(s.transmissionMap.channel),thicknessMapUv:ue&&m(s.thicknessMap.channel),alphaMapUv:he&&m(s.alphaMap.channel),vertexTangents:!!_.attributes.tangent&&(z||Y),vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!_.attributes.color&&4===_.attributes.color.itemSize,pointsUvs:!0===v.isPoints&&!!_.attributes.uv&&(O||he),fog:!!y,useFog:!0===s.fog,fogExp2:!!y&&y.isFogExp2,flatShading:!0===s.flatShading&&!1===s.wireframe,sizeAttenuation:!0===s.sizeAttenuation,logarithmicDepthBuffer:d,reversedDepthBuffer:I,skinning:!0===v.isSkinnedMesh,morphTargets:void 0!==_.morphAttributes.position,morphNormals:void 0!==_.morphAttributes.normal,morphColors:void 0!==_.morphAttributes.color,morphTargetsCount:T,morphTextureStride:L,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numLightProbes:o.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:s.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.length>0,shadowMapType:e.shadowMap.type,toneMapping:ge,decodeVideoTexture:O&&!0===s.map.isVideoTexture&&I0.getTransfer(s.map.colorSpace)===j$,decodeVideoTextureEmissive:V&&!0===s.emissiveMap.isVideoTexture&&I0.getTransfer(s.emissiveMap.colorSpace)===j$,premultipliedAlpha:s.premultipliedAlpha,doubleSided:2===s.side,flipSided:1===s.side,useDepthPacking:s.depthPacking>=0,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionClipCullDistance:me&&!0===s.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(me&&!0===s.extensions.multiDraw||k)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:s.customProgramCacheKey()};return ve.vertexUv1s=c.has(1),ve.vertexUv2s=c.has(2),ve.vertexUv3s=c.has(3),c.clear(),ve},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){o.disableAll(),t.supportsVertexTextures&&o.enable(0);t.instancing&&o.enable(1);t.instancingColor&&o.enable(2);t.instancingMorph&&o.enable(3);t.matcap&&o.enable(4);t.envMap&&o.enable(5);t.normalMapObjectSpace&&o.enable(6);t.normalMapTangentSpace&&o.enable(7);t.clearcoat&&o.enable(8);t.iridescence&&o.enable(9);t.alphaTest&&o.enable(10);t.vertexColors&&o.enable(11);t.vertexAlphas&&o.enable(12);t.vertexUv1s&&o.enable(13);t.vertexUv2s&&o.enable(14);t.vertexUv3s&&o.enable(15);t.vertexTangents&&o.enable(16);t.anisotropy&&o.enable(17);t.alphaHash&&o.enable(18);t.batching&&o.enable(19);t.dispersion&&o.enable(20);t.batchingColor&&o.enable(21);t.gradientMap&&o.enable(22);e.push(o.mask),o.disableAll(),t.fog&&o.enable(0);t.useFog&&o.enable(1);t.flatShading&&o.enable(2);t.logarithmicDepthBuffer&&o.enable(3);t.reversedDepthBuffer&&o.enable(4);t.skinning&&o.enable(5);t.morphTargets&&o.enable(6);t.morphNormals&&o.enable(7);t.morphColors&&o.enable(8);t.premultipliedAlpha&&o.enable(9);t.shadowMapEnabled&&o.enable(10);t.doubleSided&&o.enable(11);t.flipSided&&o.enable(12);t.useDepthPacking&&o.enable(13);t.dithering&&o.enable(14);t.transmission&&o.enable(15);t.sheen&&o.enable(16);t.opaque&&o.enable(17);t.pointsUvs&&o.enable(18);t.decodeVideoTexture&&o.enable(19);t.decodeVideoTextureEmissive&&o.enable(20);t.alphaToCoverage&&o.enable(21);e.push(o.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=p[e.type];let n;if(t){const e=d4[t];n=J2.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let i;for(let e=0,r=u.length;e<r;e++){const t=u[e];if(t.cacheKey===n){i=t,++i.usedTimes;break}}return void 0===i&&(i=new m6(e,n,t,s),u.push(i)),i},releaseProgram:function(e){if(0===--e.usedTimes){const t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:u,dispose:function(){l.dispose()}}}function b6(){let e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,i){e.get(t)[n]=i},dispose:function(){e=new WeakMap}}}function x6(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function S6(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function E6(){const e=[];let t=0;const n=[],i=[],r=[];function s(n,i,r,s,a,o){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:i,material:r,groupOrder:s,renderOrder:n.renderOrder,z:a,group:o},e[t]=l):(l.id=n.id,l.object=n,l.geometry=i,l.material=r,l.groupOrder=s,l.renderOrder=n.renderOrder,l.z=a,l.group=o),t++,l}return{opaque:n,transmissive:i,transparent:r,init:function(){t=0,n.length=0,i.length=0,r.length=0},push:function(e,t,a,o,l,c){const u=s(e,t,a,o,l,c);a.transmission>0?i.push(u):!0===a.transparent?r.push(u):n.push(u)},unshift:function(e,t,a,o,l,c){const u=s(e,t,a,o,l,c);a.transmission>0?i.unshift(u):!0===a.transparent?r.unshift(u):n.unshift(u)},finish:function(){for(let n=t,i=e.length;n<i;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||x6),i.length>1&&i.sort(t||S6),r.length>1&&r.sort(t||S6)}}}function w6(){let e=new WeakMap;return{get:function(t,n){const i=e.get(t);let r;return void 0===i?(r=new E6,e.set(t,[r])):n>=i.length?(r=new E6,i.push(r)):r=i[n],r},dispose:function(){e=new WeakMap}}}function T6(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new _0,color:new f2};break;case"SpotLight":n={position:new _0,direction:new _0,color:new f2,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new _0,color:new f2,distance:0,decay:0};break;case"HemisphereLight":n={direction:new _0,skyColor:new f2,groundColor:new f2};break;case"RectAreaLight":n={color:new f2,position:new _0,halfWidth:new _0,halfHeight:new _0}}return e[t.id]=n,n}}}let M6=0;function A6(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function C6(e){const t=new T6,n=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new v0};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new v0,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let o=0;o<9;o++)i.probe.push(new _0);const r=new _0,s=new x1,a=new x1;return{setup:function(r){let s=0,a=0,o=0;for(let e=0;e<9;e++)i.probe[e].set(0,0,0);let l=0,c=0,u=0,d=0,h=0,f=0,p=0,m=0,g=0,v=0,y=0;r.sort(A6);for(let e=0,b=r.length;e<b;e++){const _=r[e],b=_.color,x=_.intensity,S=_.distance,E=_.shadow&&_.shadow.map?_.shadow.map.texture:null;if(_.isAmbientLight)s+=b.r*x,a+=b.g*x,o+=b.b*x;else if(_.isLightProbe){for(let e=0;e<9;e++)i.probe[e].addScaledVector(_.sh.coefficients[e],x);y++}else if(_.isDirectionalLight){const e=t.get(_);if(e.color.copy(_.color).multiplyScalar(_.intensity),_.castShadow){const e=_.shadow,t=n.get(_);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,i.directionalShadow[l]=t,i.directionalShadowMap[l]=E,i.directionalShadowMatrix[l]=_.shadow.matrix,f++}i.directional[l]=e,l++}else if(_.isSpotLight){const e=t.get(_);e.position.setFromMatrixPosition(_.matrixWorld),e.color.copy(b).multiplyScalar(x),e.distance=S,e.coneCos=Math.cos(_.angle),e.penumbraCos=Math.cos(_.angle*(1-_.penumbra)),e.decay=_.decay,i.spot[u]=e;const r=_.shadow;if(_.map&&(i.spotLightMap[g]=_.map,g++,r.updateMatrices(_),_.castShadow&&v++),i.spotLightMatrix[u]=r.matrix,_.castShadow){const e=n.get(_);e.shadowIntensity=r.intensity,e.shadowBias=r.bias,e.shadowNormalBias=r.normalBias,e.shadowRadius=r.radius,e.shadowMapSize=r.mapSize,i.spotShadow[u]=e,i.spotShadowMap[u]=E,m++}u++}else if(_.isRectAreaLight){const e=t.get(_);e.color.copy(b).multiplyScalar(x),e.halfWidth.set(.5*_.width,0,0),e.halfHeight.set(0,.5*_.height,0),i.rectArea[d]=e,d++}else if(_.isPointLight){const e=t.get(_);if(e.color.copy(_.color).multiplyScalar(_.intensity),e.distance=_.distance,e.decay=_.decay,_.castShadow){const e=_.shadow,t=n.get(_);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,i.pointShadow[c]=t,i.pointShadowMap[c]=E,i.pointShadowMatrix[c]=_.shadow.matrix,p++}i.point[c]=e,c++}else if(_.isHemisphereLight){const e=t.get(_);e.skyColor.copy(_.color).multiplyScalar(x),e.groundColor.copy(_.groundColor).multiplyScalar(x),i.hemi[h]=e,h++}}d>0&&(!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=u4.LTC_FLOAT_1,i.rectAreaLTC2=u4.LTC_FLOAT_2):(i.rectAreaLTC1=u4.LTC_HALF_1,i.rectAreaLTC2=u4.LTC_HALF_2)),i.ambient[0]=s,i.ambient[1]=a,i.ambient[2]=o;const _=i.hash;_.directionalLength===l&&_.pointLength===c&&_.spotLength===u&&_.rectAreaLength===d&&_.hemiLength===h&&_.numDirectionalShadows===f&&_.numPointShadows===p&&_.numSpotShadows===m&&_.numSpotMaps===g&&_.numLightProbes===y||(i.directional.length=l,i.spot.length=u,i.rectArea.length=d,i.point.length=c,i.hemi.length=h,i.directionalShadow.length=f,i.directionalShadowMap.length=f,i.pointShadow.length=p,i.pointShadowMap.length=p,i.spotShadow.length=m,i.spotShadowMap.length=m,i.directionalShadowMatrix.length=f,i.pointShadowMatrix.length=p,i.spotLightMatrix.length=m+g-v,i.spotLightMap.length=g,i.numSpotLightShadowsWithMaps=v,i.numLightProbes=y,_.directionalLength=l,_.pointLength=c,_.spotLength=u,_.rectAreaLength=d,_.hemiLength=h,_.numDirectionalShadows=f,_.numPointShadows=p,_.numSpotShadows=m,_.numSpotMaps=g,_.numLightProbes=y,i.version=M6++)},setupView:function(e,t){let n=0,o=0,l=0,c=0,u=0;const d=t.matrixWorldInverse;for(let h=0,f=e.length;h<f;h++){const t=e[h];if(t.isDirectionalLight){const e=i.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),r.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(r),e.direction.transformDirection(d),n++}else if(t.isSpotLight){const e=i.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(d),e.direction.setFromMatrixPosition(t.matrixWorld),r.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(r),e.direction.transformDirection(d),l++}else if(t.isRectAreaLight){const e=i.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(d),a.identity(),s.copy(t.matrixWorld),s.premultiply(d),a.extractRotation(s),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(a),e.halfHeight.applyMatrix4(a),c++}else if(t.isPointLight){const e=i.point[o];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(d),o++}else if(t.isHemisphereLight){const e=i.hemi[u];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(d),u++}}},state:i}}function R6(e){const t=new C6(e),n=[],i=[];const r={lightsArray:n,shadowsArray:i,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){r.camera=e,n.length=0,i.length=0},state:r,setupLights:function(){t.setup(n)},setupLightsView:function(e){t.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){i.push(e)}}}function L6(e){let t=new WeakMap;return{get:function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=t.get(n);let s;return void 0===r?(s=new R6(e),t.set(n,[s])):i>=r.length?(s=new R6(e),r.push(s)):s=r[i],s},dispose:function(){t=new WeakMap}}}function P6(e,t,n){let i=new y3;const r=new v0,s=new v0,a=new V0,o=new S3({depthPacking:3201}),l=new E3,c={},u=n.maxTextureSize,d={[JQ]:1,[QQ]:0,[ZQ]:2},h=new Q2({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new v0},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const p=new I2;p.setAttribute("position",new x2(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new W2(p,h),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let v=this.type;function y(n,i){const s=t.update(m);h.defines.VSM_SAMPLES!==n.blurSamples&&(h.defines.VSM_SAMPLES=n.blurSamples,f.defines.VSM_SAMPLES=n.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new j0(r.x,r.y)),h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(i,null,s,h,m,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(i,null,s,f,m,null)}function _(t,n,i,r){let s=null;const a=!0===i.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==a)s=a;else if(s=!0===i.isPointLight?l:o,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0||!0===n.alphaToCoverage){const e=s.uuid,t=n.uuid;let i=c[e];void 0===i&&(i={},c[e]=i);let r=i[t];void 0===r&&(r=s.clone(),i[t]=r,n.addEventListener("dispose",x)),s=r}if(s.visible=n.visible,s.wireframe=n.wireframe,s.side=3===r?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:d[n.side],s.alphaMap=n.alphaMap,s.alphaTest=!0===n.alphaToCoverage?.5:n.alphaTest,s.map=n.map,s.clipShadows=n.clipShadows,s.clippingPlanes=n.clippingPlanes,s.clipIntersection=n.clipIntersection,s.displacementMap=n.displacementMap,s.displacementScale=n.displacementScale,s.displacementBias=n.displacementBias,s.wireframeLinewidth=n.wireframeLinewidth,s.linewidth=n.linewidth,!0===i.isPointLight&&!0===s.isMeshDistanceMaterial){e.properties.get(s).light=i}return s}function b(n,r,s,a,o){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===o)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);const i=t.update(n),l=n.material;if(Array.isArray(l)){const t=i.groups;for(let c=0,u=t.length;c<u;c++){const u=t[c],d=l[u.materialIndex];if(d&&d.visible){const t=_(n,d,a,o);n.onBeforeShadow(e,n,r,s,i,t,u),e.renderBufferDirect(s,null,i,t,n,u),n.onAfterShadow(e,n,r,s,i,t,u)}}}else if(l.visible){const t=_(n,l,a,o);n.onBeforeShadow(e,n,r,s,i,t,null),e.renderBufferDirect(s,null,i,t,n,null),n.onAfterShadow(e,n,r,s,i,t,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)b(l[e],r,s,a,o)}function x(e){e.target.removeEventListener("dispose",x);for(const t in c){const n=c[t],i=e.target.uuid;if(i in n){n[i].dispose(),delete n[i]}}}this.render=function(t,n,o){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),h=e.state;h.setBlending(0),h.buffers.depth.getReversed()?h.buffers.color.setClear(0,0,0,0):h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);const f=3!==v&&3===this.type,p=3===v&&3!==this.type;for(let m=0,g=t.length;m<g;m++){const l=t[m],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;r.copy(c.mapSize);const d=c.getFrameExtents();if(r.multiply(d),s.copy(c.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/d.x),r.x=s.x*d.x,c.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/d.y),r.y=s.y*d.y,c.mapSize.y=s.y)),null===c.map||!0===f||!0===p){const e=3!==this.type?{minFilter:DZ,magFilter:DZ}:{};null!==c.map&&c.map.dispose(),c.map=new j0(r.x,r.y,e),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();const g=c.getViewportCount();for(let e=0;e<g;e++){const t=c.getViewport(e);a.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),h.viewport(a),c.updateMatrices(l,e),i=c.getFrustum(),b(n,o,c.camera,l,this.type)}!0!==c.isPointLightShadow&&3===this.type&&y(c,o),c.needsUpdate=!1}v=this.type,g.needsUpdate=!1,e.setRenderTarget(l,c,d)}}const I6={[vZ]:1,[_Z]:6,[xZ]:7,[bZ]:5,[yZ]:0,[EZ]:2,[wZ]:4,[SZ]:3};function D6(e,t){const n=new function(){let t=!1;const n=new V0;let i=null;const r=new V0(0,0,0,0);return{setMask:function(n){i===n||t||(e.colorMask(n,n,n,n),i=n)},setLocked:function(e){t=e},setClear:function(t,i,s,a,o){!0===o&&(t*=a,i*=a,s*=a),n.set(t,i,s,a),!1===r.equals(n)&&(e.clearColor(t,i,s,a),r.copy(n))},reset:function(){t=!1,i=null,r.set(-1,0,0,0)}}},i=new function(){let n=!1,i=!1,r=null,s=null,a=null;return{setReversed:function(e){if(i!==e){const n=t.get("EXT_clip_control");e?n.clipControlEXT(n.LOWER_LEFT_EXT,n.ZERO_TO_ONE_EXT):n.clipControlEXT(n.LOWER_LEFT_EXT,n.NEGATIVE_ONE_TO_ONE_EXT),i=e;const r=a;a=null,this.setClear(r)}},getReversed:function(){return i},setTest:function(t){t?H(e.DEPTH_TEST):z(e.DEPTH_TEST)},setMask:function(t){r===t||n||(e.depthMask(t),r=t)},setFunc:function(t){if(i&&(t=I6[t]),s!==t){switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:default:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL)}s=t}},setLocked:function(e){n=e},setClear:function(t){a!==t&&(i&&(t=1-t),e.clearDepth(t),a=t)},reset:function(){n=!1,r=null,s=null,a=null,i=!1}}},r=new function(){let t=!1,n=null,i=null,r=null,s=null,a=null,o=null,l=null,c=null;return{setTest:function(n){t||(n?H(e.STENCIL_TEST):z(e.STENCIL_TEST))},setMask:function(i){n===i||t||(e.stencilMask(i),n=i)},setFunc:function(t,n,a){i===t&&r===n&&s===a||(e.stencilFunc(t,n,a),i=t,r=n,s=a)},setOp:function(t,n,i){a===t&&o===n&&l===i||(e.stencilOp(t,n,i),a=t,o=n,l=i)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,i=null,r=null,s=null,a=null,o=null,l=null,c=null}}},s=new WeakMap,a=new WeakMap;let o={},l={},c=new WeakMap,u=[],d=null,h=!1,f=null,p=null,m=null,g=null,v=null,y=null,_=null,b=new f2(0,0,0),x=0,S=!1,E=null,w=null,T=null,M=null,A=null;const C=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let R=!1,L=0;const P=e.getParameter(e.VERSION);-1!==P.indexOf("WebGL")?(L=parseFloat(/^WebGL (\d)/.exec(P)[1]),R=L>=1):-1!==P.indexOf("OpenGL ES")&&(L=parseFloat(/^OpenGL ES (\d)/.exec(P)[1]),R=L>=2);let I=null,D={};const k=e.getParameter(e.SCISSOR_BOX),O=e.getParameter(e.VIEWPORT),N=(new V0).fromArray(k),F=(new V0).fromArray(O);function B(t,n,i,r){const s=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let o=0;o<i;o++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,r,0,e.RGBA,e.UNSIGNED_BYTE,s):e.texImage2D(n+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s);return a}const U={};function H(t){!0!==o[t]&&(e.enable(t),o[t]=!0)}function z(t){!1!==o[t]&&(e.disable(t),o[t]=!1)}U[e.TEXTURE_2D]=B(e.TEXTURE_2D,e.TEXTURE_2D,1),U[e.TEXTURE_CUBE_MAP]=B(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),U[e.TEXTURE_2D_ARRAY]=B(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),U[e.TEXTURE_3D]=B(e.TEXTURE_3D,e.TEXTURE_3D,1,1),n.setClear(0,0,0,1),i.setClear(1),r.setClear(0),H(e.DEPTH_TEST),i.setFunc(3),j(!1),Y(1),H(e.CULL_FACE),W(0);const G={[$Q]:e.FUNC_ADD,[eZ]:e.FUNC_SUBTRACT,[tZ]:e.FUNC_REVERSE_SUBTRACT};G[103]=e.MIN,G[104]=e.MAX;const V={[nZ]:e.ZERO,[iZ]:e.ONE,[rZ]:e.SRC_COLOR,[aZ]:e.SRC_ALPHA,[hZ]:e.SRC_ALPHA_SATURATE,[uZ]:e.DST_COLOR,[lZ]:e.DST_ALPHA,[sZ]:e.ONE_MINUS_SRC_COLOR,[oZ]:e.ONE_MINUS_SRC_ALPHA,[dZ]:e.ONE_MINUS_DST_COLOR,[cZ]:e.ONE_MINUS_DST_ALPHA,[fZ]:e.CONSTANT_COLOR,[pZ]:e.ONE_MINUS_CONSTANT_COLOR,[mZ]:e.CONSTANT_ALPHA,[gZ]:e.ONE_MINUS_CONSTANT_ALPHA};function W(t,n,i,r,s,a,o,l,c,u){if(0!==t){if(!1===h&&(H(e.BLEND),h=!0),5===t)s=s||n,a=a||i,o=o||r,n===p&&s===v||(e.blendEquationSeparate(G[n],G[s]),p=n,v=s),i===m&&r===g&&a===y&&o===_||(e.blendFuncSeparate(V[i],V[r],V[a],V[o]),m=i,g=r,y=a,_=o),!1!==l.equals(b)&&c===x||(e.blendColor(l.r,l.g,l.b,c),b.copy(l),x=c),f=t,S=!1;else if(t!==f||u!==S){if(p===$Q&&v===$Q||(e.blendEquation(e.FUNC_ADD),p=$Q,v=$Q),u)switch(t){case 1:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFuncSeparate(e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ZERO,e.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE,e.ONE,e.ONE);break;case 3:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case 4:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}m=null,g=null,y=null,_=null,b.set(0,0,0),x=0,f=t,S=u}}else!0===h&&(z(e.BLEND),h=!1)}function j(t){E!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),E=t)}function Y(t){0!==t?(H(e.CULL_FACE),t!==w&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):z(e.CULL_FACE),w=t}function X(t,n,i){t?(H(e.POLYGON_OFFSET_FILL),M===n&&A===i||(e.polygonOffset(n,i),M=n,A=i)):z(e.POLYGON_OFFSET_FILL)}return{buffers:{color:n,depth:i,stencil:r},enable:H,disable:z,bindFramebuffer:function(t,n){return l[t]!==n&&(e.bindFramebuffer(t,n),l[t]=n,t===e.DRAW_FRAMEBUFFER&&(l[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(l[e.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(t,n){let i=u,r=!1;if(t){i=c.get(n),void 0===i&&(i=[],c.set(n,i));const s=t.textures;if(i.length!==s.length||i[0]!==e.COLOR_ATTACHMENT0){for(let t=0,n=s.length;t<n;t++)i[t]=e.COLOR_ATTACHMENT0+t;i.length=s.length,r=!0}}else i[0]!==e.BACK&&(i[0]=e.BACK,r=!0);r&&e.drawBuffers(i)},useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:W,setMaterial:function(t,s){2===t.side?z(e.CULL_FACE):H(e.CULL_FACE);let a=1===t.side;s&&(a=!a),j(a),1===t.blending&&!1===t.transparent?W(0):W(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),i.setFunc(t.depthFunc),i.setTest(t.depthTest),i.setMask(t.depthWrite),n.setMask(t.colorWrite);const o=t.stencilWrite;r.setTest(o),o&&(r.setMask(t.stencilWriteMask),r.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),r.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),X(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?H(e.SAMPLE_ALPHA_TO_COVERAGE):z(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:j,setCullFace:Y,setLineWidth:function(t){t!==T&&(R&&e.lineWidth(t),T=t)},setPolygonOffset:X,setScissorTest:function(t){t?H(e.SCISSOR_TEST):z(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+C-1),I!==t&&(e.activeTexture(t),I=t)},bindTexture:function(t,n,i){void 0===i&&(i=null===I?e.TEXTURE0+C-1:I);let r=D[i];void 0===r&&(r={type:void 0,texture:void 0},D[i]=r),r.type===t&&r.texture===n||(I!==i&&(e.activeTexture(i),I=i),e.bindTexture(t,n||U[t]),r.type=t,r.texture=n)},unbindTexture:function(){const t=D[I];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexImage3D:function(){try{e.compressedTexImage3D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},updateUBOMapping:function(t,n){let i=a.get(n);void 0===i&&(i=new WeakMap,a.set(n,i));let r=i.get(t);void 0===r&&(r=e.getUniformBlockIndex(n,t.name),i.set(t,r))},uniformBlockBinding:function(t,n){const i=a.get(n).get(t);s.get(n)!==i&&(e.uniformBlockBinding(n,i,t.__bindingPointIndex),s.set(n,i))},texStorage2D:function(){try{e.texStorage2D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{e.texStorage3D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{e.texSubImage2D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{e.texSubImage3D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===N.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),N.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),i.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),o={},I=null,D={},l={},c=new WeakMap,u=[],d=null,h=!1,f=null,p=null,m=null,g=null,v=null,y=null,_=null,b=new f2(0,0,0),x=0,S=!1,E=null,w=null,T=null,M=null,A=null,N.set(0,0,e.canvas.width,e.canvas.height),F.set(0,0,e.canvas.width,e.canvas.height),n.reset(),i.reset(),r.reset()}}}function k6(e,t,n,i,r,s,a){const o=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,l="undefined"!==typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new v0,u=new WeakMap;let d;const h=new WeakMap;let f=!1;try{f="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(One){}function p(e,t){return f?new OffscreenCanvas(e,t):T0("canvas")}function m(e,t,n){let i=1;const r=V(e);if((r.width>n||r.height>n)&&(i=n/Math.max(r.width,r.height)),i<1){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof VideoFrame&&e instanceof VideoFrame){const n=Math.floor(i*r.width),s=Math.floor(i*r.height);void 0===d&&(d=p(n,s));const a=t?p(n,s):d;a.width=n,a.height=s;return a.getContext("2d").drawImage(e,0,0,n,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+r.width+"x"+r.height+") to ("+n+"x"+s+")."),a}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+r.width+"x"+r.height+")."),e}return e}function g(e){return e.generateMipmaps}function v(t){e.generateMipmap(t)}function y(t){return t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:t.isWebGL3DRenderTarget?e.TEXTURE_3D:t.isWebGLArrayRenderTarget||t.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function _(n,i,r,s){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let o=i;if(i===e.RED&&(r===e.FLOAT&&(o=e.R32F),r===e.HALF_FLOAT&&(o=e.R16F),r===e.UNSIGNED_BYTE&&(o=e.R8)),i===e.RED_INTEGER&&(r===e.UNSIGNED_BYTE&&(o=e.R8UI),r===e.UNSIGNED_SHORT&&(o=e.R16UI),r===e.UNSIGNED_INT&&(o=e.R32UI),r===e.BYTE&&(o=e.R8I),r===e.SHORT&&(o=e.R16I),r===e.INT&&(o=e.R32I)),i===e.RG&&(r===e.FLOAT&&(o=e.RG32F),r===e.HALF_FLOAT&&(o=e.RG16F),r===e.UNSIGNED_BYTE&&(o=e.RG8)),i===e.RG_INTEGER&&(r===e.UNSIGNED_BYTE&&(o=e.RG8UI),r===e.UNSIGNED_SHORT&&(o=e.RG16UI),r===e.UNSIGNED_INT&&(o=e.RG32UI),r===e.BYTE&&(o=e.RG8I),r===e.SHORT&&(o=e.RG16I),r===e.INT&&(o=e.RG32I)),i===e.RGB_INTEGER&&(r===e.UNSIGNED_BYTE&&(o=e.RGB8UI),r===e.UNSIGNED_SHORT&&(o=e.RGB16UI),r===e.UNSIGNED_INT&&(o=e.RGB32UI),r===e.BYTE&&(o=e.RGB8I),r===e.SHORT&&(o=e.RGB16I),r===e.INT&&(o=e.RGB32I)),i===e.RGBA_INTEGER&&(r===e.UNSIGNED_BYTE&&(o=e.RGBA8UI),r===e.UNSIGNED_SHORT&&(o=e.RGBA16UI),r===e.UNSIGNED_INT&&(o=e.RGBA32UI),r===e.BYTE&&(o=e.RGBA8I),r===e.SHORT&&(o=e.RGBA16I),r===e.INT&&(o=e.RGBA32I)),i===e.RGB&&r===e.UNSIGNED_INT_5_9_9_9_REV&&(o=e.RGB9_E5),i===e.RGBA){const t=a?W$:I0.getTransfer(s);r===e.FLOAT&&(o=e.RGBA32F),r===e.HALF_FLOAT&&(o=e.RGBA16F),r===e.UNSIGNED_BYTE&&(o=t===j$?e.SRGB8_ALPHA8:e.RGBA8),r===e.UNSIGNED_SHORT_4_4_4_4&&(o=e.RGBA4),r===e.UNSIGNED_SHORT_5_5_5_1&&(o=e.RGB5_A1)}return o!==e.R16F&&o!==e.R32F&&o!==e.RG16F&&o!==e.RG32F&&o!==e.RGBA16F&&o!==e.RGBA32F||t.get("EXT_color_buffer_float"),o}function b(t,n){let i;return t?null===n||n===WZ||n===qZ?i=e.DEPTH24_STENCIL8:n===jZ?i=e.DEPTH32F_STENCIL8:n===GZ&&(i=e.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===n||n===WZ||n===qZ?i=e.DEPTH_COMPONENT24:n===jZ?i=e.DEPTH_COMPONENT32F:n===GZ&&(i=e.DEPTH_COMPONENT16),i}function x(e,t){return!0===g(e)||e.isFramebufferTexture&&e.minFilter!==DZ&&e.minFilter!==NZ?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function S(e){const t=e.target;t.removeEventListener("dispose",S),function(e){const t=i.get(e);if(void 0===t.__webglInit)return;const n=e.source,r=h.get(n);if(r){const i=r[t.__cacheKey];i.usedTimes--,0===i.usedTimes&&w(e),0===Object.keys(r).length&&h.delete(n)}i.remove(e)}(t),t.isVideoTexture&&u.delete(t)}function E(t){const n=t.target;n.removeEventListener("dispose",E),function(t){const n=i.get(t);t.depthTexture&&(t.depthTexture.dispose(),i.remove(t.depthTexture));if(t.isWebGLCubeRenderTarget)for(let i=0;i<6;i++){if(Array.isArray(n.__webglFramebuffer[i]))for(let t=0;t<n.__webglFramebuffer[i].length;t++)e.deleteFramebuffer(n.__webglFramebuffer[i][t]);else e.deleteFramebuffer(n.__webglFramebuffer[i]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[i])}else{if(Array.isArray(n.__webglFramebuffer))for(let t=0;t<n.__webglFramebuffer.length;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let t=0;t<n.__webglColorRenderbuffer.length;t++)n.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[t]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const r=t.textures;for(let s=0,o=r.length;s<o;s++){const t=i.get(r[s]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),a.memory.textures--),i.remove(r[s])}i.remove(t)}(n)}function w(t){const n=i.get(t);e.deleteTexture(n.__webglTexture);const r=t.source;delete h.get(r)[n.__cacheKey],a.memory.textures--}let T=0;function M(t,r){const s=i.get(t);if(t.isVideoTexture&&function(e){const t=a.render.frame;u.get(e)!==t&&(u.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&!0!==t.isExternalTexture&&t.version>0&&s.__version!==t.version){const e=t.image;if(null===e)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void D(s,t,r);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}else t.isExternalTexture&&(s.__webglTexture=t.sourceTexture?t.sourceTexture:null);n.bindTexture(e.TEXTURE_2D,s.__webglTexture,e.TEXTURE0+r)}const A={[LZ]:e.REPEAT,[PZ]:e.CLAMP_TO_EDGE,[IZ]:e.MIRRORED_REPEAT},C={[DZ]:e.NEAREST,[kZ]:e.NEAREST_MIPMAP_NEAREST,[OZ]:e.NEAREST_MIPMAP_LINEAR,[NZ]:e.LINEAR,[FZ]:e.LINEAR_MIPMAP_NEAREST,[BZ]:e.LINEAR_MIPMAP_LINEAR},R={[X$]:e.NEVER,[e0]:e.ALWAYS,[K$]:e.LESS,[J$]:e.LEQUAL,[q$]:e.EQUAL,[$$]:e.GEQUAL,[Q$]:e.GREATER,[Z$]:e.NOTEQUAL};function L(n,s){if(s.type!==jZ||!1!==t.has("OES_texture_float_linear")||s.magFilter!==NZ&&s.magFilter!==FZ&&s.magFilter!==OZ&&s.magFilter!==BZ&&s.minFilter!==NZ&&s.minFilter!==FZ&&s.minFilter!==OZ&&s.minFilter!==BZ||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(n,e.TEXTURE_WRAP_S,A[s.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,A[s.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,A[s.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,C[s.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,C[s.minFilter]),s.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,R[s.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){if(s.magFilter===DZ)return;if(s.minFilter!==OZ&&s.minFilter!==BZ)return;if(s.type===jZ&&!1===t.has("OES_texture_float_linear"))return;if(s.anisotropy>1||i.get(s).__currentAnisotropy){const a=t.get("EXT_texture_filter_anisotropic");e.texParameterf(n,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy}}}function P(t,n){let i=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",S));const r=n.source;let s=h.get(r);void 0===s&&(s={},h.set(r,s));const o=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(o!==t.__cacheKey){void 0===s[o]&&(s[o]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,i=!0),s[o].usedTimes++;const r=s[t.__cacheKey];void 0!==r&&(s[t.__cacheKey].usedTimes--,0===r.usedTimes&&w(n)),t.__cacheKey=o,t.__webglTexture=s[o].texture}return i}function I(e,t,n){return Math.floor(Math.floor(e/n)/t)}function D(t,a,o){let l=e.TEXTURE_2D;(a.isDataArrayTexture||a.isCompressedArrayTexture)&&(l=e.TEXTURE_2D_ARRAY),a.isData3DTexture&&(l=e.TEXTURE_3D);const c=P(t,a),u=a.source;n.bindTexture(l,t.__webglTexture,e.TEXTURE0+o);const d=i.get(u);if(u.version!==d.__version||!0===c){n.activeTexture(e.TEXTURE0+o);const t=I0.getPrimaries(I0.workingColorSpace),i=a.colorSpace===z$?null:I0.getPrimaries(a.colorSpace),h=a.colorSpace===z$||t===i?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,a.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,a.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,h);let f=m(a.image,!1,r.maxTextureSize);f=G(a,f);const p=s.convert(a.format,a.colorSpace),y=s.convert(a.type);let S,E=_(a.internalFormat,p,y,a.colorSpace,a.isVideoTexture);L(l,a);const w=a.mipmaps,T=!0!==a.isVideoTexture,M=void 0===d.__version||!0===c,A=u.dataReady,C=x(a,f);if(a.isDepthTexture)E=b(a.format===$Z,a.type),M&&(T?n.texStorage2D(e.TEXTURE_2D,1,E,f.width,f.height):n.texImage2D(e.TEXTURE_2D,0,E,f.width,f.height,0,p,y,null));else if(a.isDataTexture)if(w.length>0){T&&M&&n.texStorage2D(e.TEXTURE_2D,C,E,w[0].width,w[0].height);for(let t=0,i=w.length;t<i;t++)S=w[t],T?A&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,p,y,S.data):n.texImage2D(e.TEXTURE_2D,t,E,S.width,S.height,0,p,y,S.data);a.generateMipmaps=!1}else T?(M&&n.texStorage2D(e.TEXTURE_2D,C,E,f.width,f.height),A&&function(t,i,r,s){const a=t.updateRanges;if(0===a.length)n.texSubImage2D(e.TEXTURE_2D,0,0,0,i.width,i.height,r,s,i.data);else{a.sort((e,t)=>e.start-t.start);let o=0;for(let e=1;e<a.length;e++){const t=a[o],n=a[e],r=t.start+t.count,s=I(n.start,i.width,4),l=I(t.start,i.width,4);n.start<=r+1&&s===l&&I(n.start+n.count-1,i.width,4)===s?t.count=Math.max(t.count,n.start+n.count-t.start):(++o,a[o]=n)}a.length=o+1;const l=e.getParameter(e.UNPACK_ROW_LENGTH),c=e.getParameter(e.UNPACK_SKIP_PIXELS),u=e.getParameter(e.UNPACK_SKIP_ROWS);e.pixelStorei(e.UNPACK_ROW_LENGTH,i.width);for(let t=0,d=a.length;t<d;t++){const o=a[t],l=Math.floor(o.start/4),c=Math.ceil(o.count/4),u=l%i.width,d=Math.floor(l/i.width),h=c,f=1;e.pixelStorei(e.UNPACK_SKIP_PIXELS,u),e.pixelStorei(e.UNPACK_SKIP_ROWS,d),n.texSubImage2D(e.TEXTURE_2D,0,u,d,h,f,r,s,i.data)}t.clearUpdateRanges(),e.pixelStorei(e.UNPACK_ROW_LENGTH,l),e.pixelStorei(e.UNPACK_SKIP_PIXELS,c),e.pixelStorei(e.UNPACK_SKIP_ROWS,u)}}(a,f,p,y)):n.texImage2D(e.TEXTURE_2D,0,E,f.width,f.height,0,p,y,f.data);else if(a.isCompressedTexture)if(a.isCompressedArrayTexture){T&&M&&n.texStorage3D(e.TEXTURE_2D_ARRAY,C,E,w[0].width,w[0].height,f.depth);for(let t=0,i=w.length;t<i;t++)if(S=w[t],a.format!==QZ)if(null!==p)if(T){if(A)if(a.layerUpdates.size>0){const i=a4(S.width,S.height,a.format,a.type);for(const r of a.layerUpdates){const s=S.data.subarray(r*i/S.data.BYTES_PER_ELEMENT,(r+1)*i/S.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,r,S.width,S.height,1,p,s)}a.clearLayerUpdates()}else n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,S.width,S.height,f.depth,p,S.data)}else n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,E,S.width,S.height,f.depth,0,S.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else T?A&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,S.width,S.height,f.depth,p,y,S.data):n.texImage3D(e.TEXTURE_2D_ARRAY,t,E,S.width,S.height,f.depth,0,p,y,S.data)}else{T&&M&&n.texStorage2D(e.TEXTURE_2D,C,E,w[0].width,w[0].height);for(let t=0,i=w.length;t<i;t++)S=w[t],a.format!==QZ?null!==p?T?A&&n.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,p,S.data):n.compressedTexImage2D(e.TEXTURE_2D,t,E,S.width,S.height,0,S.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):T?A&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,p,y,S.data):n.texImage2D(e.TEXTURE_2D,t,E,S.width,S.height,0,p,y,S.data)}else if(a.isDataArrayTexture)if(T){if(M&&n.texStorage3D(e.TEXTURE_2D_ARRAY,C,E,f.width,f.height,f.depth),A)if(a.layerUpdates.size>0){const t=a4(f.width,f.height,a.format,a.type);for(const i of a.layerUpdates){const r=f.data.subarray(i*t/f.data.BYTES_PER_ELEMENT,(i+1)*t/f.data.BYTES_PER_ELEMENT);n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,i,f.width,f.height,1,p,y,r)}a.clearLayerUpdates()}else n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,f.width,f.height,f.depth,p,y,f.data)}else n.texImage3D(e.TEXTURE_2D_ARRAY,0,E,f.width,f.height,f.depth,0,p,y,f.data);else if(a.isData3DTexture)T?(M&&n.texStorage3D(e.TEXTURE_3D,C,E,f.width,f.height,f.depth),A&&n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,f.width,f.height,f.depth,p,y,f.data)):n.texImage3D(e.TEXTURE_3D,0,E,f.width,f.height,f.depth,0,p,y,f.data);else if(a.isFramebufferTexture){if(M)if(T)n.texStorage2D(e.TEXTURE_2D,C,E,f.width,f.height);else{let t=f.width,i=f.height;for(let r=0;r<C;r++)n.texImage2D(e.TEXTURE_2D,r,E,t,i,0,p,y,null),t>>=1,i>>=1}}else if(w.length>0){if(T&&M){const t=V(w[0]);n.texStorage2D(e.TEXTURE_2D,C,E,t.width,t.height)}for(let t=0,i=w.length;t<i;t++)S=w[t],T?A&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,p,y,S):n.texImage2D(e.TEXTURE_2D,t,E,p,y,S);a.generateMipmaps=!1}else if(T){if(M){const t=V(f);n.texStorage2D(e.TEXTURE_2D,C,E,t.width,t.height)}A&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,p,y,f)}else n.texImage2D(e.TEXTURE_2D,0,E,p,y,f);g(a)&&v(l),d.__version=u.version,a.onUpdate&&a.onUpdate(a)}t.__version=a.version}function k(t,r,a,l,c,u){const d=s.convert(a.format,a.colorSpace),h=s.convert(a.type),f=_(a.internalFormat,d,h,a.colorSpace),p=i.get(r),m=i.get(a);if(m.__renderTarget=r,!p.__hasExternalTextures){const t=Math.max(1,r.width>>u),i=Math.max(1,r.height>>u);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?n.texImage3D(c,u,f,t,i,r.depth,0,d,h,null):n.texImage2D(c,u,f,t,i,0,d,h,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),z(r)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,l,c,m.__webglTexture,0,H(r)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,l,c,m.__webglTexture,u),n.bindFramebuffer(e.FRAMEBUFFER,null)}function O(t,n,i){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer){const r=n.depthTexture,s=r&&r.isDepthTexture?r.type:null,a=b(n.stencilBuffer,s),l=n.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=H(n);z(n)?o.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,a,n.width,n.height):i?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,a,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,a,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,l,e.RENDERBUFFER,t)}else{const t=n.textures;for(let r=0;r<t.length;r++){const a=t[r],l=s.convert(a.format,a.colorSpace),c=s.convert(a.type),u=_(a.internalFormat,l,c,a.colorSpace),d=H(n);i&&!1===z(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,d,u,n.width,n.height):z(n)?o.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,d,u,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,u,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function N(t,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const s=i.get(r.depthTexture);s.__renderTarget=r,s.__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),M(r.depthTexture,0);const a=s.__webglTexture,l=H(r);if(r.depthTexture.format===ZZ)z(r)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0,l):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0);else{if(r.depthTexture.format!==$Z)throw new Error("Unknown depthTexture format");z(r)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0,l):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0)}}function F(t){const r=i.get(t),s=!0===t.isWebGLCubeRenderTarget;if(r.__boundDepthTexture!==t.depthTexture){const e=t.depthTexture;if(r.__depthDisposeCallback&&r.__depthDisposeCallback(),e){const t=()=>{delete r.__boundDepthTexture,delete r.__depthDisposeCallback,e.removeEventListener("dispose",t)};e.addEventListener("dispose",t),r.__depthDisposeCallback=t}r.__boundDepthTexture=e}if(t.depthTexture&&!r.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");const e=t.texture.mipmaps;e&&e.length>0?N(r.__webglFramebuffer[0],t):N(r.__webglFramebuffer,t)}else if(s){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)if(n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[i]),void 0===r.__webglDepthbuffer[i])r.__webglDepthbuffer[i]=e.createRenderbuffer(),O(r.__webglDepthbuffer[i],t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,s=r.__webglDepthbuffer[i];e.bindRenderbuffer(e.RENDERBUFFER,s),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,s)}}else{const i=t.texture.mipmaps;if(i&&i.length>0?n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[0]):n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer),void 0===r.__webglDepthbuffer)r.__webglDepthbuffer=e.createRenderbuffer(),O(r.__webglDepthbuffer,t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,i=r.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,i),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,i)}}n.bindFramebuffer(e.FRAMEBUFFER,null)}const B=[],U=[];function H(e){return Math.min(r.maxSamples,e.samples)}function z(e){const n=i.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function G(e,t){const n=e.colorSpace,i=e.format,r=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||n!==V$&&n!==z$&&(I0.getTransfer(n)===j$?i===QZ&&r===UZ||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",n)),t}function V(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement?(c.width=e.naturalWidth||e.width,c.height=e.naturalHeight||e.height):"undefined"!==typeof VideoFrame&&e instanceof VideoFrame?(c.width=e.displayWidth,c.height=e.displayHeight):(c.width=e.width,c.height=e.height),c}this.allocateTextureUnit=function(){const e=T;return e>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+r.maxTextures),T+=1,e},this.resetTextureUnits=function(){T=0},this.setTexture2D=M,this.setTexture2DArray=function(t,r){const s=i.get(t);!1===t.isRenderTargetTexture&&t.version>0&&s.__version!==t.version?D(s,t,r):n.bindTexture(e.TEXTURE_2D_ARRAY,s.__webglTexture,e.TEXTURE0+r)},this.setTexture3D=function(t,r){const s=i.get(t);!1===t.isRenderTargetTexture&&t.version>0&&s.__version!==t.version?D(s,t,r):n.bindTexture(e.TEXTURE_3D,s.__webglTexture,e.TEXTURE0+r)},this.setTextureCube=function(t,a){const o=i.get(t);t.version>0&&o.__version!==t.version?function(t,a,o){if(6!==a.image.length)return;const l=P(t,a),c=a.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+o);const u=i.get(c);if(c.version!==u.__version||!0===l){n.activeTexture(e.TEXTURE0+o);const t=I0.getPrimaries(I0.workingColorSpace),i=a.colorSpace===z$?null:I0.getPrimaries(a.colorSpace),d=a.colorSpace===z$||t===i?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,a.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,a.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);const h=a.isCompressedTexture||a.image[0].isCompressedTexture,f=a.image[0]&&a.image[0].isDataTexture,p=[];for(let e=0;e<6;e++)p[e]=h||f?f?a.image[e].image:a.image[e]:m(a.image[e],!0,r.maxCubemapSize),p[e]=G(a,p[e]);const y=p[0],b=s.convert(a.format,a.colorSpace),S=s.convert(a.type),E=_(a.internalFormat,b,S,a.colorSpace),w=!0!==a.isVideoTexture,T=void 0===u.__version||!0===l,M=c.dataReady;let A,C=x(a,y);if(L(e.TEXTURE_CUBE_MAP,a),h){w&&T&&n.texStorage2D(e.TEXTURE_CUBE_MAP,C,E,y.width,y.height);for(let t=0;t<6;t++){A=p[t].mipmaps;for(let i=0;i<A.length;i++){const r=A[i];a.format!==QZ?null!==b?w?M&&n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,0,0,r.width,r.height,b,r.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,E,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):w?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,0,0,r.width,r.height,b,S,r.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,E,r.width,r.height,0,b,S,r.data)}}}else{if(A=a.mipmaps,w&&T){A.length>0&&C++;const t=V(p[0]);n.texStorage2D(e.TEXTURE_CUBE_MAP,C,E,t.width,t.height)}for(let t=0;t<6;t++)if(f){w?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,p[t].width,p[t].height,b,S,p[t].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,E,p[t].width,p[t].height,0,b,S,p[t].data);for(let i=0;i<A.length;i++){const r=A[i].image[t].image;w?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,0,0,r.width,r.height,b,S,r.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,E,r.width,r.height,0,b,S,r.data)}}else{w?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,b,S,p[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,E,b,S,p[t]);for(let i=0;i<A.length;i++){const r=A[i];w?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,0,0,b,S,r.image[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,E,b,S,r.image[t])}}}g(a)&&v(e.TEXTURE_CUBE_MAP),u.__version=c.version,a.onUpdate&&a.onUpdate(a)}t.__version=a.version}(o,t,a):n.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture,e.TEXTURE0+a)},this.rebindTextures=function(t,n,r){const s=i.get(t);void 0!==n&&k(s.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==r&&F(t)},this.setupRenderTarget=function(t){const r=t.texture,o=i.get(t),l=i.get(r);t.addEventListener("dispose",E);const c=t.textures,u=!0===t.isWebGLCubeRenderTarget,d=c.length>1;if(d||(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=r.version,a.memory.textures++),u){o.__webglFramebuffer=[];for(let t=0;t<6;t++)if(r.mipmaps&&r.mipmaps.length>0){o.__webglFramebuffer[t]=[];for(let n=0;n<r.mipmaps.length;n++)o.__webglFramebuffer[t][n]=e.createFramebuffer()}else o.__webglFramebuffer[t]=e.createFramebuffer()}else{if(r.mipmaps&&r.mipmaps.length>0){o.__webglFramebuffer=[];for(let t=0;t<r.mipmaps.length;t++)o.__webglFramebuffer[t]=e.createFramebuffer()}else o.__webglFramebuffer=e.createFramebuffer();if(d)for(let t=0,n=c.length;t<n;t++){const n=i.get(c[t]);void 0===n.__webglTexture&&(n.__webglTexture=e.createTexture(),a.memory.textures++)}if(t.samples>0&&!1===z(t)){o.__webglMultisampledFramebuffer=e.createFramebuffer(),o.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,o.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const i=c[n];o.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,o.__webglColorRenderbuffer[n]);const r=s.convert(i.format,i.colorSpace),a=s.convert(i.type),l=_(i.internalFormat,r,a,i.colorSpace,!0===t.isXRRenderTarget),u=H(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,u,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,o.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(o.__webglDepthRenderbuffer=e.createRenderbuffer(),O(o.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(u){n.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),L(e.TEXTURE_CUBE_MAP,r);for(let n=0;n<6;n++)if(r.mipmaps&&r.mipmaps.length>0)for(let i=0;i<r.mipmaps.length;i++)k(o.__webglFramebuffer[n][i],t,r,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i);else k(o.__webglFramebuffer[n],t,r,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);g(r)&&v(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(d){for(let r=0,s=c.length;r<s;r++){const s=c[r],a=i.get(s);let l=e.TEXTURE_2D;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(l,a.__webglTexture),L(l,s),k(o.__webglFramebuffer,t,s,e.COLOR_ATTACHMENT0+r,l,0),g(s)&&v(l)}n.unbindTexture()}else{let i=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(i=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(i,l.__webglTexture),L(i,r),r.mipmaps&&r.mipmaps.length>0)for(let n=0;n<r.mipmaps.length;n++)k(o.__webglFramebuffer[n],t,r,e.COLOR_ATTACHMENT0,i,n);else k(o.__webglFramebuffer,t,r,e.COLOR_ATTACHMENT0,i,0);g(r)&&v(i),n.unbindTexture()}t.depthBuffer&&F(t)},this.updateRenderTargetMipmap=function(e){const t=e.textures;for(let r=0,s=t.length;r<s;r++){const s=t[r];if(g(s)){const t=y(e),r=i.get(s).__webglTexture;n.bindTexture(t,r),v(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0)if(!1===z(t)){const r=t.textures,s=t.width,a=t.height;let o=e.COLOR_BUFFER_BIT;const c=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,u=i.get(t),d=r.length>1;if(d)for(let t=0;t<r.length;t++)n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer);const h=t.texture.mipmaps;h&&h.length>0?n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer[0]):n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let n=0;n<r.length;n++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(o|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(o|=e.STENCIL_BUFFER_BIT)),d){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,u.__webglColorRenderbuffer[n]);const t=i.get(r[n]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,s,a,0,0,s,a,o,e.NEAREST),!0===l&&(B.length=0,U.length=0,B.push(e.COLOR_ATTACHMENT0+n),t.depthBuffer&&!1===t.resolveDepthBuffer&&(B.push(c),U.push(c),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,U)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,B))}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),d)for(let t=0;t<r.length;t++){n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,u.__webglColorRenderbuffer[t]);const s=i.get(r[t]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,s,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&l){const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=F,this.setupFrameBufferTexture=k,this.useMultisampledRTT=z}function O6(e,t){return{convert:function(n){let i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:z$;const s=I0.getTransfer(r);if(n===UZ)return e.UNSIGNED_BYTE;if(n===XZ)return e.UNSIGNED_SHORT_4_4_4_4;if(n===KZ)return e.UNSIGNED_SHORT_5_5_5_1;if(n===JZ)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===HZ)return e.BYTE;if(n===zZ)return e.SHORT;if(n===GZ)return e.UNSIGNED_SHORT;if(n===VZ)return e.INT;if(n===WZ)return e.UNSIGNED_INT;if(n===jZ)return e.FLOAT;if(n===YZ)return e.HALF_FLOAT;if(1021===n)return e.ALPHA;if(1022===n)return e.RGB;if(n===QZ)return e.RGBA;if(n===ZZ)return e.DEPTH_COMPONENT;if(n===$Z)return e.DEPTH_STENCIL;if(n===e$)return e.RED;if(n===t$)return e.RED_INTEGER;if(1030===n)return e.RG;if(n===n$)return e.RG_INTEGER;if(n===i$)return e.RGBA_INTEGER;if(n===r$||n===s$||n===a$||n===o$)if(s===j$){if(i=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(n===r$)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===s$)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===a$)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===o$)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=t.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(n===r$)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===s$)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===a$)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===o$)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===l$||n===c$||n===u$||n===d$){if(i=t.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(n===l$)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===c$)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===u$)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===d$)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===h$||n===f$||n===p$){if(i=t.get("WEBGL_compressed_texture_etc"),null===i)return null;if(n===h$||n===f$)return s===j$?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===p$)return s===j$?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(n===m$||n===g$||n===v$||n===y$||n===_$||n===b$||n===x$||n===S$||n===E$||n===w$||n===T$||n===M$||n===A$||n===C$){if(i=t.get("WEBGL_compressed_texture_astc"),null===i)return null;if(n===m$)return s===j$?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===g$)return s===j$?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===v$)return s===j$?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===y$)return s===j$?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===_$)return s===j$?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===b$)return s===j$?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===x$)return s===j$?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===S$)return s===j$?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===E$)return s===j$?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===w$)return s===j$?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===T$)return s===j$?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===M$)return s===j$?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===A$)return s===j$?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===C$)return s===j$?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===R$||n===L$||n===P$){if(i=t.get("EXT_texture_compression_bptc"),null===i)return null;if(n===R$)return s===j$?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===L$)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===P$)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===n||n===I$||n===D$||n===k$){if(i=t.get("EXT_texture_compression_rgtc"),null===i)return null;if(n===R$)return i.COMPRESSED_RED_RGTC1_EXT;if(n===I$)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===D$)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===k$)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===qZ?e.UNSIGNED_INT_24_8:void 0!==e[n]?e[n]:null}}}class N6 extends G0{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.sourceTexture=e,this.isExternalTexture=!0}}class F6{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(null===this.texture){const n=new N6(e.texture);e.depthNear===t.depthNear&&e.depthFar===t.depthFar||(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,n=new Q2({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new W2(new b3(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class B6 extends s0{constructor(e,t){super();const n=this;let i=null,r=1,s=null,a="local-floor",o=1,l=null,c=null,u=null,d=null,h=null,f=null;const p=new F6,m={},g=t.getContextAttributes();let v=null,y=null;const _=[],b=[],x=new v0;let S=null;const E=new n3;E.viewport=new V0;const w=new n3;w.viewport=new V0;const T=[E,w],M=new K3;let A=null,C=null;function R(e){const t=b.indexOf(e.inputSource);if(-1===t)return;const n=_[t];void 0!==n&&(n.update(e.inputSource,e.frame,l||s),n.dispatchEvent({type:e.type,data:e.inputSource}))}function L(){i.removeEventListener("select",R),i.removeEventListener("selectstart",R),i.removeEventListener("selectend",R),i.removeEventListener("squeeze",R),i.removeEventListener("squeezestart",R),i.removeEventListener("squeezeend",R),i.removeEventListener("end",L),i.removeEventListener("inputsourceschange",P);for(let e=0;e<_.length;e++){const t=b[e];null!==t&&(b[e]=null,_[e].disconnect(t))}A=null,C=null,p.reset();for(const e in m)delete m[e];e.setRenderTarget(v),h=null,d=null,u=null,i=null,y=null,N.stop(),n.isPresenting=!1,e.setPixelRatio(S),e.setSize(x.width,x.height,!1),n.dispatchEvent({type:"sessionend"})}function P(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],i=b.indexOf(n);i>=0&&(b[i]=null,_[i].disconnect(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let i=b.indexOf(n);if(-1===i){for(let e=0;e<_.length;e++){if(e>=b.length){b.push(n),i=e;break}if(null===b[e]){b[e]=n,i=e;break}}if(-1===i)break}const r=_[i];r&&r.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=_[e];return void 0===t&&(t=new c3,_[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=_[e];return void 0===t&&(t=new c3,_[e]=t),t.getGripSpace()},this.getHand=function(e){let t=_[e];return void 0===t&&(t=new c3,_[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){r=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){a=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==d?d:h},this.getBinding=function(){return u},this.getFrame=function(){return f},this.getSession=function(){return i},this.setSession=async function(c){if(i=c,null!==i){v=e.getRenderTarget(),i.addEventListener("select",R),i.addEventListener("selectstart",R),i.addEventListener("selectend",R),i.addEventListener("squeeze",R),i.addEventListener("squeezestart",R),i.addEventListener("squeezeend",R),i.addEventListener("end",L),i.addEventListener("inputsourceschange",P),!0!==g.xrCompatible&&await t.makeXRCompatible(),S=e.getPixelRatio(),e.getSize(x),"undefined"!==typeof XRWebGLBinding&&(u=new XRWebGLBinding(i,t));if(null!==u&&"createProjectionLayer"in XRWebGLBinding.prototype){let n=null,s=null,a=null;g.depth&&(a=g.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,n=g.stencil?$Z:ZZ,s=g.stencil?qZ:WZ);const o={colorFormat:t.RGBA8,depthFormat:a,scaleFactor:r};d=u.createProjectionLayer(o),i.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),y=new j0(d.textureWidth,d.textureHeight,{format:QZ,type:UZ,depthTexture:new _3(d.textureWidth,d.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:g.stencil,colorSpace:e.outputColorSpace,samples:g.antialias?4:0,resolveDepthBuffer:!1===d.ignoreDepthValues,resolveStencilBuffer:!1===d.ignoreDepthValues})}else{const n={antialias:g.antialias,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:r};h=new XRWebGLLayer(i,t,n),i.updateRenderState({baseLayer:h}),e.setPixelRatio(1),e.setSize(h.framebufferWidth,h.framebufferHeight,!1),y=new j0(h.framebufferWidth,h.framebufferHeight,{format:QZ,type:UZ,colorSpace:e.outputColorSpace,stencilBuffer:g.stencil,resolveDepthBuffer:!1===h.ignoreDepthValues,resolveStencilBuffer:!1===h.ignoreDepthValues})}y.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await i.requestReferenceSpace(a),N.setContext(i),N.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==i)return i.environmentBlendMode},this.getDepthTexture=function(){return p.getDepthTexture()};const I=new _0,D=new _0;function k(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===i)return;let t=e.near,n=e.far;null!==p.texture&&(p.depthNear>0&&(t=p.depthNear),p.depthFar>0&&(n=p.depthFar)),M.near=w.near=E.near=t,M.far=w.far=E.far=n,A===M.near&&C===M.far||(i.updateRenderState({depthNear:M.near,depthFar:M.far}),A=M.near,C=M.far),M.layers.mask=6|e.layers.mask,E.layers.mask=3&M.layers.mask,w.layers.mask=5&M.layers.mask;const r=e.parent,s=M.cameras;k(M,r);for(let i=0;i<s.length;i++)k(s[i],r);2===s.length?function(e,t,n){I.setFromMatrixPosition(t.matrixWorld),D.setFromMatrixPosition(n.matrixWorld);const i=I.distanceTo(D),r=t.projectionMatrix.elements,s=n.projectionMatrix.elements,a=r[14]/(r[10]-1),o=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],u=(r[8]-1)/r[0],d=(s[8]+1)/s[0],h=a*u,f=a*d,p=i/(-u+d),m=p*-u;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===r[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{const t=a+p,n=o+p,r=h-m,s=f+(i-m),u=l*o/n*t,d=c*o/n*t;e.projectionMatrix.makePerspective(r,s,u,d,t,n),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(M,E,w):M.projectionMatrix.copy(E.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*c0*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,M,r)},this.getCamera=function(){return M},this.getFoveation=function(){if(null!==d||null!==h)return o},this.setFoveation=function(e){o=e,null!==d&&(d.fixedFoveation=e),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==p.texture},this.getDepthSensingMesh=function(){return p.getMesh(M)},this.getCameraTexture=function(e){return m[e]};let O=null;const N=new o4;N.setAnimationLoop(function(t,r){if(c=r.getViewerPose(l||s),f=r,null!==c){const t=c.views;null!==h&&(e.setRenderTargetFramebuffer(y,h.framebuffer),e.setRenderTarget(y));let n=!1;t.length!==M.cameras.length&&(M.cameras.length=0,n=!0);for(let i=0;i<t.length;i++){const r=t[i];let s=null;if(null!==h)s=h.getViewport(r);else{const t=u.getViewSubImage(d,r);s=t.viewport,0===i&&(e.setRenderTargetTextures(y,t.colorTexture,t.depthStencilTexture),e.setRenderTarget(y))}let a=T[i];void 0===a&&(a=new n3,a.layers.enable(i),a.viewport=new V0,T[i]=a),a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),a.projectionMatrix.fromArray(r.projectionMatrix),a.projectionMatrixInverse.copy(a.projectionMatrix).invert(),a.viewport.set(s.x,s.y,s.width,s.height),0===i&&(M.matrix.copy(a.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),!0===n&&M.cameras.push(a)}const r=i.enabledFeatures;if(r&&r.includes("depth-sensing")&&"gpu-optimized"==i.depthUsage&&u){const e=u.getDepthInformation(t[0]);e&&e.isValid&&e.texture&&p.init(e,i.renderState)}if(r&&r.includes("camera-access")&&(e.state.unbindTexture(),u))for(let e=0;e<t.length;e++){const n=t[e].camera;if(n){let e=m[n];e||(e=new N6,m[n]=e);const t=u.getCameraImage(n);e.sourceTexture=t}}}for(let e=0;e<_.length;e++){const t=b[e],n=_[e];null!==t&&void 0!==n&&n.update(t,r,l||s)}O&&O(t,r),r.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:r}),f=null}),this.setAnimationLoop=function(e){O=e},this.dispose=function(){}}}const U6=new P1,H6=new x1;function z6(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function i(e,i){e.opacity.value=i.opacity,i.color&&e.diffuse.value.copy(i.color),i.emissive&&e.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(e.map.value=i.map,n(i.map,e.mapTransform)),i.alphaMap&&(e.alphaMap.value=i.alphaMap,n(i.alphaMap,e.alphaMapTransform)),i.bumpMap&&(e.bumpMap.value=i.bumpMap,n(i.bumpMap,e.bumpMapTransform),e.bumpScale.value=i.bumpScale,1===i.side&&(e.bumpScale.value*=-1)),i.normalMap&&(e.normalMap.value=i.normalMap,n(i.normalMap,e.normalMapTransform),e.normalScale.value.copy(i.normalScale),1===i.side&&e.normalScale.value.negate()),i.displacementMap&&(e.displacementMap.value=i.displacementMap,n(i.displacementMap,e.displacementMapTransform),e.displacementScale.value=i.displacementScale,e.displacementBias.value=i.displacementBias),i.emissiveMap&&(e.emissiveMap.value=i.emissiveMap,n(i.emissiveMap,e.emissiveMapTransform)),i.specularMap&&(e.specularMap.value=i.specularMap,n(i.specularMap,e.specularMapTransform)),i.alphaTest>0&&(e.alphaTest.value=i.alphaTest);const r=t.get(i),s=r.envMap,a=r.envMapRotation;s&&(e.envMap.value=s,U6.copy(a),U6.x*=-1,U6.y*=-1,U6.z*=-1,s.isCubeTexture&&!1===s.isRenderTargetTexture&&(U6.y*=-1,U6.z*=-1),e.envMapRotation.value.setFromMatrix4(H6.makeRotationFromEuler(U6)),e.flipEnvMap.value=s.isCubeTexture&&!1===s.isRenderTargetTexture?-1:1,e.reflectivity.value=i.reflectivity,e.ior.value=i.ior,e.refractionRatio.value=i.refractionRatio),i.lightMap&&(e.lightMap.value=i.lightMap,e.lightMapIntensity.value=i.lightMapIntensity,n(i.lightMap,e.lightMapTransform)),i.aoMap&&(e.aoMap.value=i.aoMap,e.aoMapIntensity.value=i.aoMapIntensity,n(i.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,q2(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,r,s,a,o){r.isMeshBasicMaterial||r.isMeshLambertMaterial?i(e,r):r.isMeshToonMaterial?(i(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,r)):r.isMeshPhongMaterial?(i(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,r)):r.isMeshStandardMaterial?(i(e,r),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,n(t.metalnessMap,e.metalnessMapTransform));e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,n(t.roughnessMap,e.roughnessMapTransform));t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,r),r.isMeshPhysicalMaterial&&function(e,t,i){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),1===t.side&&e.clearcoatNormalScale.value.negate()));t.dispersion>0&&(e.dispersion.value=t.dispersion);t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=i.texture,e.transmissionSamplerSize.value.set(i.width,i.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,r,o)):r.isMeshMatcapMaterial?(i(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,r)):r.isMeshDepthMaterial?i(e,r):r.isMeshDistanceMaterial?(i(e,r),function(e,n){const i=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(i.matrixWorld),e.nearDistance.value=i.shadow.camera.near,e.farDistance.value=i.shadow.camera.far}(e,r)):r.isMeshNormalMaterial?i(e,r):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,i,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*i,e.scale.value=.5*r,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,r,s,a):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function G6(e,t,n,i){let r={},s={},a=[];const o=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(e,t,n,i){const r=e.value,s=t+"_"+n;if(void 0===i[s])return i[s]="number"===typeof r||"boolean"===typeof r?r:r.clone(),!0;{const e=i[s];if("number"===typeof r||"boolean"===typeof r){if(e!==r)return i[s]=r,!0}else if(!1===e.equals(r))return e.copy(r),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"===typeof e||"boolean"===typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function u(t){const n=t.target;n.removeEventListener("dispose",u);const i=a.indexOf(n.__bindingPointIndex);a.splice(i,1),e.deleteBuffer(r[n.id]),delete r[n.id],delete s[n.id]}return{bind:function(e,t){const n=t.program;i.uniformBlockBinding(e,n)},update:function(n,d){let h=r[n.id];void 0===h&&(!function(e){const t=e.uniforms;let n=0;const i=16;for(let s=0,a=t.length;s<a;s++){const e=Array.isArray(t[s])?t[s]:[t[s]];for(let t=0,r=e.length;t<r;t++){const r=e[t],s=Array.isArray(r.value)?r.value:[r.value];for(let e=0,t=s.length;e<t;e++){const t=c(s[e]),a=n%i,o=a%t.boundary,l=a+o;n+=o,0!==l&&i-l<t.storage&&(n+=i-l),r.__data=new Float32Array(t.storage/Float32Array.BYTES_PER_ELEMENT),r.__offset=n,n+=t.storage}}}const r=n%i;r>0&&(n+=i-r);e.__size=n,e.__cache={}}(n),h=function(t){const n=function(){for(let e=0;e<o;e++)if(-1===a.indexOf(e))return a.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const i=e.createBuffer(),r=t.__size,s=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,i),e.bufferData(e.UNIFORM_BUFFER,r,s),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,i),i}(n),r[n.id]=h,n.addEventListener("dispose",u));const f=d.program;i.updateUBOMapping(n,f);const p=t.render.frame;s[n.id]!==p&&(!function(t){const n=r[t.id],i=t.uniforms,s=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let r=0,a=i.length;r<a;r++){const t=Array.isArray(i[r])?i[r]:[i[r]];for(let n=0,i=t.length;n<i;n++){const i=t[n];if(!0===l(i,r,n,s)){const t=i.__offset,n=Array.isArray(i.value)?i.value:[i.value];let r=0;for(let s=0;s<n.length;s++){const a=n[s],o=c(a);"number"===typeof a||"boolean"===typeof a?(i.__data[0]=a,e.bufferSubData(e.UNIFORM_BUFFER,t+r,i.__data)):a.isMatrix3?(i.__data[0]=a.elements[0],i.__data[1]=a.elements[1],i.__data[2]=a.elements[2],i.__data[3]=0,i.__data[4]=a.elements[3],i.__data[5]=a.elements[4],i.__data[6]=a.elements[5],i.__data[7]=0,i.__data[8]=a.elements[6],i.__data[9]=a.elements[7],i.__data[10]=a.elements[8],i.__data[11]=0):(a.toArray(i.__data,r),r+=o.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,i.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),s[n.id]=p)},dispose:function(){for(const t in r)e.deleteBuffer(r[t]);a=[],r={},s={}}}}class V6{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{canvas:t=M0(),context:n=null,depth:i=!0,stencil:r=!1,alpha:s=!1,antialias:a=!1,premultipliedAlpha:o=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:u=!1,reversedDepthBuffer:d=!1}=e;let h;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!==typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");h=n.getContextAttributes().alpha}else h=s;const f=new Uint32Array(4),p=new Int32Array(4);let m=null,g=null;const v=[],y=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=0,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const _=this;let b=!1;this._outputColorSpace=G$;let x=0,S=0,E=null,w=-1,T=null;const M=new V0,A=new V0;let C=null;const R=new f2(0);let L=0,P=t.width,I=t.height,D=1,k=null,O=null;const N=new V0(0,0,P,I),F=new V0(0,0,P,I);let B=!1;const U=new y3;let H=!1,z=!1;const G=new x1,V=new _0,W=new V0,j={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Y=!1;function X(){return null===E?D:1}let K,q,J,Q,Z,$,ee,te,ne,ie,re,se,ae,oe,le,ce,ue,de,he,fe,pe,me,ge,ve,ye=n;function _e(e,n){return t.getContext(e,n)}try{const e={alpha:!0,depth:i,stencil:r,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r".concat(qQ)),t.addEventListener("webglcontextlost",Se,!1),t.addEventListener("webglcontextrestored",Ee,!1),t.addEventListener("webglcontextcreationerror",we,!1),null===ye){const t="webgl2";if(ye=_e(t,e),null===ye)throw _e(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Ge){throw console.error("THREE.WebGLRenderer: "+Ge.message),Ge}function be(){K=new U4(ye),K.init(),me=new O6(ye,K),q=new y4(ye,K,e,me),J=new D6(ye,K),q.reversedDepthBuffer&&d&&J.buffers.depth.setReversed(!0),Q=new G4(ye),Z=new b6,$=new k6(ye,K,J,Z,q,me,Q),ee=new b4(_),te=new B4(_),ne=new l4(ye),ge=new g4(ye,ne),ie=new H4(ye,ne,Q,ge),re=new W4(ye,ie,ne,Q),he=new V4(ye,q,$),ce=new _4(Z),se=new _6(_,ee,te,K,q,ge,ce),ae=new z6(_,Z),oe=new w6,le=new L6(K),de=new m4(_,ee,te,J,re,h,o),ue=new P6(_,re,q),ve=new G6(ye,Q,q,J),fe=new v4(ye,K,Q),pe=new z4(ye,K,Q),Q.programs=se.programs,_.capabilities=q,_.extensions=K,_.properties=Z,_.renderLists=oe,_.shadowMap=ue,_.state=J,_.info=Q}be();const xe=new B6(_,ye);function Se(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),b=!0}function Ee(){console.log("THREE.WebGLRenderer: Context Restored."),b=!1;const e=Q.autoReset,t=ue.enabled,n=ue.autoUpdate,i=ue.needsUpdate,r=ue.type;be(),Q.autoReset=e,ue.enabled=t,ue.autoUpdate=n,ue.needsUpdate=i,ue.type=r}function we(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Te(e){const t=e.target;t.removeEventListener("dispose",Te),function(e){(function(e){const t=Z.get(e).programs;void 0!==t&&(t.forEach(function(e){se.releaseProgram(e)}),e.isShaderMaterial&&se.releaseShaderCache(e))})(e),Z.remove(e)}(t)}function Me(e,t,n){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=1,e.needsUpdate=!0,Ne(e,t,n),e.side=0,e.needsUpdate=!0,Ne(e,t,n),e.side=2):Ne(e,t,n)}this.xr=xe,this.getContext=function(){return ye},this.getContextAttributes=function(){return ye.getContextAttributes()},this.forceContextLoss=function(){const e=K.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=K.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return D},this.setPixelRatio=function(e){void 0!==e&&(D=e,this.setSize(P,I,!1))},this.getSize=function(e){return e.set(P,I)},this.setSize=function(e,n){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];xe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(P=e,I=n,t.width=Math.floor(e*D),t.height=Math.floor(n*D),!0===i&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(P*D,I*D).floor()},this.setDrawingBufferSize=function(e,n,i){P=e,I=n,D=i,t.width=Math.floor(e*i),t.height=Math.floor(n*i),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(M)},this.getViewport=function(e){return e.copy(N)},this.setViewport=function(e,t,n,i){e.isVector4?N.set(e.x,e.y,e.z,e.w):N.set(e,t,n,i),J.viewport(M.copy(N).multiplyScalar(D).round())},this.getScissor=function(e){return e.copy(F)},this.setScissor=function(e,t,n,i){e.isVector4?F.set(e.x,e.y,e.z,e.w):F.set(e,t,n,i),J.scissor(A.copy(F).multiplyScalar(D).round())},this.getScissorTest=function(){return B},this.setScissorTest=function(e){J.setScissorTest(B=e)},this.setOpaqueSort=function(e){k=e},this.setTransparentSort=function(e){O=e},this.getClearColor=function(e){return e.copy(de.getClearColor())},this.setClearColor=function(){de.setClearColor(...arguments)},this.getClearAlpha=function(){return de.getClearAlpha()},this.setClearAlpha=function(){de.setClearAlpha(...arguments)},this.clear=function(){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){let e=!1;if(null!==E){const t=E.texture.format;e=t===i$||t===n$||t===t$}if(e){const e=E.texture.type,t=e===UZ||e===WZ||e===GZ||e===qZ||e===XZ||e===KZ,n=de.getClearColor(),i=de.getClearAlpha(),r=n.r,s=n.g,a=n.b;t?(f[0]=r,f[1]=s,f[2]=a,f[3]=i,ye.clearBufferuiv(ye.COLOR,0,f)):(p[0]=r,p[1]=s,p[2]=a,p[3]=i,ye.clearBufferiv(ye.COLOR,0,p))}else n|=ye.COLOR_BUFFER_BIT}e&&(n|=ye.DEPTH_BUFFER_BIT),t&&(n|=ye.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ye.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Se,!1),t.removeEventListener("webglcontextrestored",Ee,!1),t.removeEventListener("webglcontextcreationerror",we,!1),de.dispose(),oe.dispose(),le.dispose(),Z.dispose(),ee.dispose(),te.dispose(),re.dispose(),ge.dispose(),ve.dispose(),se.dispose(),xe.dispose(),xe.removeEventListener("sessionstart",Ce),xe.removeEventListener("sessionend",Re),Le.stop()},this.renderBufferDirect=function(e,t,n,i,r,s){null===t&&(t=j);const a=r.isMesh&&r.matrixWorld.determinant()<0,o=function(e,t,n,i,r){!0!==t.isScene&&(t=j);$.resetTextureUnits();const s=t.fog,a=i.isMeshStandardMaterial?t.environment:null,o=null===E?_.outputColorSpace:!0===E.isXRRenderTarget?E.texture.colorSpace:V$,l=(i.isMeshStandardMaterial?te:ee).get(i.envMap||a),c=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!n.attributes.tangent&&(!!i.normalMap||i.anisotropy>0),d=!!n.morphAttributes.position,h=!!n.morphAttributes.normal,f=!!n.morphAttributes.color;let p=0;i.toneMapped&&(null!==E&&!0!==E.isXRRenderTarget||(p=_.toneMapping));const m=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==m?m.length:0,y=Z.get(i),b=g.state.lights;if(!0===H&&(!0===z||e!==T)){const t=e===T&&i.id===w;ce.setState(i,e,t)}let x=!1;i.version===y.__version?y.needsLights&&y.lightsStateVersion!==b.state.version||y.outputColorSpace!==o||r.isBatchedMesh&&!1===y.batching?x=!0:r.isBatchedMesh||!0!==y.batching?r.isBatchedMesh&&!0===y.batchingColor&&null===r.colorTexture||r.isBatchedMesh&&!1===y.batchingColor&&null!==r.colorTexture||r.isInstancedMesh&&!1===y.instancing?x=!0:r.isInstancedMesh||!0!==y.instancing?r.isSkinnedMesh&&!1===y.skinning?x=!0:r.isSkinnedMesh||!0!==y.skinning?r.isInstancedMesh&&!0===y.instancingColor&&null===r.instanceColor||r.isInstancedMesh&&!1===y.instancingColor&&null!==r.instanceColor||r.isInstancedMesh&&!0===y.instancingMorph&&null===r.morphTexture||r.isInstancedMesh&&!1===y.instancingMorph&&null!==r.morphTexture||y.envMap!==l||!0===i.fog&&y.fog!==s?x=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===ce.numPlanes&&y.numIntersection===ce.numIntersection?(y.vertexAlphas!==c||y.vertexTangents!==u||y.morphTargets!==d||y.morphNormals!==h||y.morphColors!==f||y.toneMapping!==p||y.morphTargetsCount!==v)&&(x=!0):x=!0:x=!0:x=!0:x=!0:(x=!0,y.__version=i.version);let S=y.currentProgram;!0===x&&(S=Ne(i,t,r));let M=!1,A=!1,C=!1;const R=S.getUniforms(),L=y.uniforms;J.useProgram(S.program)&&(M=!0,A=!0,C=!0);i.id!==w&&(w=i.id,A=!0);if(M||T!==e){J.buffers.depth.getReversed()&&!0!==e.reversedDepth&&(e._reversedDepth=!0,e.updateProjectionMatrix()),R.setValue(ye,"projectionMatrix",e.projectionMatrix),R.setValue(ye,"viewMatrix",e.matrixWorldInverse);const t=R.map.cameraPosition;void 0!==t&&t.setValue(ye,V.setFromMatrixPosition(e.matrixWorld)),q.logarithmicDepthBuffer&&R.setValue(ye,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&R.setValue(ye,"isOrthographic",!0===e.isOrthographicCamera),T!==e&&(T=e,A=!0,C=!0)}if(r.isSkinnedMesh){R.setOptional(ye,r,"bindMatrix"),R.setOptional(ye,r,"bindMatrixInverse");const e=r.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),R.setValue(ye,"boneTexture",e.boneTexture,$))}r.isBatchedMesh&&(R.setOptional(ye,r,"batchingTexture"),R.setValue(ye,"batchingTexture",r._matricesTexture,$),R.setOptional(ye,r,"batchingIdTexture"),R.setValue(ye,"batchingIdTexture",r._indirectTexture,$),R.setOptional(ye,r,"batchingColorTexture"),null!==r._colorsTexture&&R.setValue(ye,"batchingColorTexture",r._colorsTexture,$));const P=n.morphAttributes;void 0===P.position&&void 0===P.normal&&void 0===P.color||he.update(r,n,S);(A||y.receiveShadow!==r.receiveShadow)&&(y.receiveShadow=r.receiveShadow,R.setValue(ye,"receiveShadow",r.receiveShadow));i.isMeshGouraudMaterial&&null!==i.envMap&&(L.envMap.value=l,L.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);i.isMeshStandardMaterial&&null===i.envMap&&null!==t.environment&&(L.envMapIntensity.value=t.environmentIntensity);A&&(R.setValue(ye,"toneMappingExposure",_.toneMappingExposure),y.needsLights&&(O=C,(k=L).ambientLightColor.needsUpdate=O,k.lightProbe.needsUpdate=O,k.directionalLights.needsUpdate=O,k.directionalLightShadows.needsUpdate=O,k.pointLights.needsUpdate=O,k.pointLightShadows.needsUpdate=O,k.spotLights.needsUpdate=O,k.spotLightShadows.needsUpdate=O,k.rectAreaLights.needsUpdate=O,k.hemisphereLights.needsUpdate=O),s&&!0===i.fog&&ae.refreshFogUniforms(L,s),ae.refreshMaterialUniforms(L,i,D,I,g.state.transmissionRenderTarget[e.id]),q5.upload(ye,Fe(y),L,$));var k,O;i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(q5.upload(ye,Fe(y),L,$),i.uniformsNeedUpdate=!1);i.isSpriteMaterial&&R.setValue(ye,"center",r.center);if(R.setValue(ye,"modelViewMatrix",r.modelViewMatrix),R.setValue(ye,"normalMatrix",r.normalMatrix),R.setValue(ye,"modelMatrix",r.matrixWorld),i.isShaderMaterial||i.isRawShaderMaterial){const e=i.uniformsGroups;for(let t=0,n=e.length;t<n;t++){const n=e[t];ve.update(n,S),ve.bind(n,S)}}return S}(e,t,n,i,r);J.setMaterial(i,a);let l=n.index,c=1;if(!0===i.wireframe){if(l=ie.getWireframeAttribute(n),void 0===l)return;c=2}const u=n.drawRange,d=n.attributes.position;let h=u.start*c,f=(u.start+u.count)*c;null!==s&&(h=Math.max(h,s.start*c),f=Math.min(f,(s.start+s.count)*c)),null!==l?(h=Math.max(h,0),f=Math.min(f,l.count)):void 0!==d&&null!==d&&(h=Math.max(h,0),f=Math.min(f,d.count));const p=f-h;if(p<0||p===1/0)return;let m;ge.setup(r,i,o,n,l);let v=fe;if(null!==l&&(m=ne.get(l),v=pe,v.setIndex(m)),r.isMesh)!0===i.wireframe?(J.setLineWidth(i.wireframeLinewidth*X()),v.setMode(ye.LINES)):v.setMode(ye.TRIANGLES);else if(r.isLine){let e=i.linewidth;void 0===e&&(e=1),J.setLineWidth(e*X()),r.isLineSegments?v.setMode(ye.LINES):r.isLineLoop?v.setMode(ye.LINE_LOOP):v.setMode(ye.LINE_STRIP)}else r.isPoints?v.setMode(ye.POINTS):r.isSprite&&v.setMode(ye.TRIANGLES);if(r.isBatchedMesh)if(null!==r._multiDrawInstances)C0("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),v.renderMultiDrawInstances(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount,r._multiDrawInstances);else if(K.get("WEBGL_multi_draw"))v.renderMultiDraw(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount);else{const e=r._multiDrawStarts,t=r._multiDrawCounts,n=r._multiDrawCount,s=l?ne.get(l).bytesPerElement:1,a=Z.get(i).currentProgram.getUniforms();for(let i=0;i<n;i++)a.setValue(ye,"_gl_DrawID",i),v.render(e[i]/s,t[i])}else if(r.isInstancedMesh)v.renderInstances(h,p,r.count);else if(n.isInstancedBufferGeometry){const e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);v.renderInstances(h,p,t)}else v.render(h,p)},this.compile=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===n&&(n=e),g=le.get(n),g.init(t),y.push(g),n.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(g.pushLight(e),e.castShadow&&g.pushShadow(e))}),e!==n&&e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(g.pushLight(e),e.castShadow&&g.pushShadow(e))}),g.setupLights();const i=new Set;return e.traverse(function(e){if(!(e.isMesh||e.isPoints||e.isLine||e.isSprite))return;const t=e.material;if(t)if(Array.isArray(t))for(let r=0;r<t.length;r++){const s=t[r];Me(s,n,e),i.add(s)}else Me(t,n,e),i.add(t)}),g=y.pop(),i},this.compileAsync=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.compile(e,t,n);return new Promise(t=>{function n(){i.forEach(function(e){Z.get(e).currentProgram.isReady()&&i.delete(e)}),0!==i.size?setTimeout(n,10):t(e)}null!==K.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)})};let Ae=null;function Ce(){Le.stop()}function Re(){Le.start()}const Le=new o4;function Pe(e,t,n,i){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)g.pushLight(e),e.castShadow&&g.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||U.intersectsSprite(e)){i&&W.setFromMatrixPosition(e.matrixWorld).applyMatrix4(G);const t=re.update(e),r=e.material;r.visible&&m.push(e,t,r,n,W.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||U.intersectsObject(e))){const t=re.update(e),r=e.material;if(i&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),W.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),W.copy(t.boundingSphere.center)),W.applyMatrix4(e.matrixWorld).applyMatrix4(G)),Array.isArray(r)){const i=t.groups;for(let s=0,a=i.length;s<a;s++){const a=i[s],o=r[a.materialIndex];o&&o.visible&&m.push(e,t,o,n,W.z,a)}}else r.visible&&m.push(e,t,r,n,W.z,null)}const r=e.children;for(let s=0,a=r.length;s<a;s++)Pe(r[s],t,n,i)}function Ie(e,t,n,i){const r=e.opaque,s=e.transmissive,a=e.transparent;g.setupLightsView(n),!0===H&&ce.setGlobalState(_.clippingPlanes,n),i&&J.viewport(M.copy(i)),r.length>0&&ke(r,t,n),s.length>0&&ke(s,t,n),a.length>0&&ke(a,t,n),J.buffers.depth.setTest(!0),J.buffers.depth.setMask(!0),J.buffers.color.setMask(!0),J.setPolygonOffset(!1)}function De(e,t,n,i){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===g.state.transmissionRenderTarget[i.id]&&(g.state.transmissionRenderTarget[i.id]=new j0(1,1,{generateMipmaps:!0,type:K.has("EXT_color_buffer_half_float")||K.has("EXT_color_buffer_float")?YZ:UZ,minFilter:BZ,samples:4,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:I0.workingColorSpace}));const s=g.state.transmissionRenderTarget[i.id],a=i.viewport||M;s.setSize(a.z*_.transmissionResolutionScale,a.w*_.transmissionResolutionScale);const o=_.getRenderTarget(),l=_.getActiveCubeFace(),c=_.getActiveMipmapLevel();_.setRenderTarget(s),_.getClearColor(R),L=_.getClearAlpha(),L<1&&_.setClearColor(16777215,.5),_.clear(),Y&&de.render(n);const u=_.toneMapping;_.toneMapping=0;const d=i.viewport;if(void 0!==i.viewport&&(i.viewport=void 0),g.setupLightsView(i),!0===H&&ce.setGlobalState(_.clippingPlanes,i),ke(e,n,i),$.updateMultisampleRenderTarget(s),$.updateRenderTargetMipmap(s),!1===K.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let r=0,s=t.length;r<s;r++){const s=t[r],a=s.object,o=s.geometry,l=s.material,c=s.group;if(2===l.side&&a.layers.test(i.layers)){const t=l.side;l.side=1,l.needsUpdate=!0,Oe(a,n,i,o,l,c),l.side=t,l.needsUpdate=!0,e=!0}}!0===e&&($.updateMultisampleRenderTarget(s),$.updateRenderTargetMipmap(s))}_.setRenderTarget(o,l,c),_.setClearColor(R,L),void 0!==d&&(i.viewport=d),_.toneMapping=u}function ke(e,t,n){const i=!0===t.isScene?t.overrideMaterial:null;for(let r=0,s=e.length;r<s;r++){const s=e[r],a=s.object,o=s.geometry,l=s.group;let c=s.material;!0===c.allowOverride&&null!==i&&(c=i),a.layers.test(n.layers)&&Oe(a,t,n,o,c,l)}}function Oe(e,t,n,i,r,s){e.onBeforeRender(_,t,n,i,r,s),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),r.onBeforeRender(_,t,n,i,e,s),!0===r.transparent&&2===r.side&&!1===r.forceSinglePass?(r.side=1,r.needsUpdate=!0,_.renderBufferDirect(n,t,i,r,e,s),r.side=0,r.needsUpdate=!0,_.renderBufferDirect(n,t,i,r,e,s),r.side=2):_.renderBufferDirect(n,t,i,r,e,s),e.onAfterRender(_,t,n,i,r,s)}function Ne(e,t,n){!0!==t.isScene&&(t=j);const i=Z.get(e),r=g.state.lights,s=g.state.shadowsArray,a=r.state.version,o=se.getParameters(e,r.state,s,t,n),l=se.getProgramCacheKey(o);let c=i.programs;i.environment=e.isMeshStandardMaterial?t.environment:null,i.fog=t.fog,i.envMap=(e.isMeshStandardMaterial?te:ee).get(e.envMap||i.environment),i.envMapRotation=null!==i.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===c&&(e.addEventListener("dispose",Te),c=new Map,i.programs=c);let u=c.get(l);if(void 0!==u){if(i.currentProgram===u&&i.lightsStateVersion===a)return Be(e,o),u}else o.uniforms=se.getUniforms(e),e.onBeforeCompile(o,_),u=se.acquireProgram(o,l),c.set(l,u),i.uniforms=o.uniforms;const d=i.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(d.clippingPlanes=ce.uniform),Be(e,o),i.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),i.lightsStateVersion=a,i.needsLights&&(d.ambientLightColor.value=r.state.ambient,d.lightProbe.value=r.state.probe,d.directionalLights.value=r.state.directional,d.directionalLightShadows.value=r.state.directionalShadow,d.spotLights.value=r.state.spot,d.spotLightShadows.value=r.state.spotShadow,d.rectAreaLights.value=r.state.rectArea,d.ltc_1.value=r.state.rectAreaLTC1,d.ltc_2.value=r.state.rectAreaLTC2,d.pointLights.value=r.state.point,d.pointLightShadows.value=r.state.pointShadow,d.hemisphereLights.value=r.state.hemi,d.directionalShadowMap.value=r.state.directionalShadowMap,d.directionalShadowMatrix.value=r.state.directionalShadowMatrix,d.spotShadowMap.value=r.state.spotShadowMap,d.spotLightMatrix.value=r.state.spotLightMatrix,d.spotLightMap.value=r.state.spotLightMap,d.pointShadowMap.value=r.state.pointShadowMap,d.pointShadowMatrix.value=r.state.pointShadowMatrix),i.currentProgram=u,i.uniformsList=null,u}function Fe(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=q5.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function Be(e,t){const n=Z.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.batchingColor=t.batchingColor,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.instancingMorph=t.instancingMorph,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}Le.setAnimationLoop(function(e){Ae&&Ae(e)}),"undefined"!==typeof self&&Le.setContext(self),this.setAnimationLoop=function(e){Ae=e,xe.setAnimationLoop(e),null===e?Le.stop():Le.start()},xe.addEventListener("sessionstart",Ce),xe.addEventListener("sessionend",Re),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===b)return;if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===xe.enabled&&!0===xe.isPresenting&&(!0===xe.cameraAutoUpdate&&xe.updateCamera(t),t=xe.getCamera()),!0===e.isScene&&e.onBeforeRender(_,e,t,E),g=le.get(e,y.length),g.init(t),y.push(g),G.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),U.setFromProjectionMatrix(G,i0,t.reversedDepth),z=this.localClippingEnabled,H=ce.init(this.clippingPlanes,z),m=oe.get(e,v.length),m.init(),v.push(m),!0===xe.enabled&&!0===xe.isPresenting){const e=_.xr.getDepthSensingMesh();null!==e&&Pe(e,t,-1/0,_.sortObjects)}Pe(e,t,0,_.sortObjects),m.finish(),!0===_.sortObjects&&m.sort(k,O),Y=!1===xe.enabled||!1===xe.isPresenting||!1===xe.hasDepthSensing(),Y&&de.addToRenderList(m,e),this.info.render.frame++,!0===H&&ce.beginShadows();const n=g.state.shadowsArray;ue.render(n,e,t),!0===H&&ce.endShadows(),!0===this.info.autoReset&&this.info.reset();const i=m.opaque,r=m.transmissive;if(g.setupLights(),t.isArrayCamera){const n=t.cameras;if(r.length>0)for(let t=0,s=n.length;t<s;t++){De(i,r,e,n[t])}Y&&de.render(e);for(let t=0,i=n.length;t<i;t++){const i=n[t];Ie(m,e,i,i.viewport)}}else r.length>0&&De(i,r,e,t),Y&&de.render(e),Ie(m,e,t);null!==E&&0===S&&($.updateMultisampleRenderTarget(E),$.updateRenderTargetMipmap(E)),!0===e.isScene&&e.onAfterRender(_,e,t),ge.resetDefaultState(),w=-1,T=null,y.pop(),y.length>0?(g=y[y.length-1],!0===H&&ce.setGlobalState(_.clippingPlanes,g.state.camera)):g=null,v.pop(),m=v.length>0?v[v.length-1]:null},this.getActiveCubeFace=function(){return x},this.getActiveMipmapLevel=function(){return S},this.getRenderTarget=function(){return E},this.setRenderTargetTextures=function(e,t,n){const i=Z.get(e);i.__autoAllocateDepthBuffer=!1===e.resolveDepthBuffer,!1===i.__autoAllocateDepthBuffer&&(i.__useRenderToTexture=!1),Z.get(e.texture).__webglTexture=t,Z.get(e.depthTexture).__webglTexture=i.__autoAllocateDepthBuffer?void 0:n,i.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(e,t){const n=Z.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t};const Ue=ye.createFramebuffer();this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;E=e,x=t,S=n;let i=!0,r=null,s=!1,a=!1;if(e){const o=Z.get(e);if(void 0!==o.__useDefaultFramebuffer)J.bindFramebuffer(ye.FRAMEBUFFER,null),i=!1;else if(void 0===o.__webglFramebuffer)$.setupRenderTarget(e);else if(o.__hasExternalTextures)$.rebindTextures(e,Z.get(e.texture).__webglTexture,Z.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){const t=e.depthTexture;if(o.__boundDepthTexture!==t){if(null!==t&&Z.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");$.setupDepthRenderbuffer(e)}}const l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(a=!0);const c=Z.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=Array.isArray(c[t])?c[t][n]:c[t],s=!0):r=e.samples>0&&!1===$.useMultisampledRTT(e)?Z.get(e).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,M.copy(e.viewport),A.copy(e.scissor),C=e.scissorTest}else M.copy(N).multiplyScalar(D).floor(),A.copy(F).multiplyScalar(D).floor(),C=B;0!==n&&(r=Ue);if(J.bindFramebuffer(ye.FRAMEBUFFER,r)&&i&&J.drawBuffers(e,r),J.viewport(M),J.scissor(A),J.setScissorTest(C),s){const i=Z.get(e.texture);ye.framebufferTexture2D(ye.FRAMEBUFFER,ye.COLOR_ATTACHMENT0,ye.TEXTURE_CUBE_MAP_POSITIVE_X+t,i.__webglTexture,n)}else if(a){const i=t;for(let t=0;t<e.textures.length;t++){const r=Z.get(e.textures[t]);ye.framebufferTextureLayer(ye.FRAMEBUFFER,ye.COLOR_ATTACHMENT0+t,r.__webglTexture,n,i)}}else if(null!==e&&0!==n){const t=Z.get(e.texture);ye.framebufferTexture2D(ye.FRAMEBUFFER,ye.COLOR_ATTACHMENT0,ye.TEXTURE_2D,t.__webglTexture,n)}w=-1},this.readRenderTargetPixels=function(e,t,n,i,r,s,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=Z.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(l=l[a]),l){J.bindFramebuffer(ye.FRAMEBUFFER,l);try{const a=e.textures[o],l=a.format,c=a.type;if(!q.textureFormatReadable(l))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!q.textureTypeReadable(c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r&&(e.textures.length>1&&ye.readBuffer(ye.COLOR_ATTACHMENT0+o),ye.readPixels(t,n,i,r,me.convert(l),me.convert(c),s))}finally{const e=null!==E?Z.get(E).__webglFramebuffer:null;J.bindFramebuffer(ye.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,n,i,r,s,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=Z.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(l=l[a]),l){if(t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r){J.bindFramebuffer(ye.FRAMEBUFFER,l);const a=e.textures[o],c=a.format,u=a.type;if(!q.textureFormatReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!q.textureTypeReadable(u))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const d=ye.createBuffer();ye.bindBuffer(ye.PIXEL_PACK_BUFFER,d),ye.bufferData(ye.PIXEL_PACK_BUFFER,s.byteLength,ye.STREAM_READ),e.textures.length>1&&ye.readBuffer(ye.COLOR_ATTACHMENT0+o),ye.readPixels(t,n,i,r,me.convert(c),me.convert(u),0);const h=null!==E?Z.get(E).__webglFramebuffer:null;J.bindFramebuffer(ye.FRAMEBUFFER,h);const f=ye.fenceSync(ye.SYNC_GPU_COMMANDS_COMPLETE,0);return ye.flush(),await function(e,t,n){return new Promise(function(i,r){setTimeout(function s(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:r();break;case e.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:i()}},n)})}(ye,f,4),ye.bindBuffer(ye.PIXEL_PACK_BUFFER,d),ye.getBufferSubData(ye.PIXEL_PACK_BUFFER,0,s),ye.deleteBuffer(d),ye.deleteSync(f),s}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=Math.pow(2,-n),r=Math.floor(e.image.width*i),s=Math.floor(e.image.height*i),a=null!==t?t.x:0,o=null!==t?t.y:0;$.setTexture2D(e,0),ye.copyTexSubImage2D(ye.TEXTURE_2D,n,0,0,a,o,r,s),J.unbindTexture()};const He=ye.createFramebuffer(),ze=ye.createFramebuffer();this.copyTextureToTexture=function(e,t){let n,i,r,s,a,o,l,c,u,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;null===p&&(0!==f?(C0("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),p=f,f=0):p=0);const m=e.isCompressedTexture?e.mipmaps[p]:e.image;if(null!==d)n=d.max.x-d.min.x,i=d.max.y-d.min.y,r=d.isBox3?d.max.z-d.min.z:1,s=d.min.x,a=d.min.y,o=d.isBox3?d.min.z:0;else{const t=Math.pow(2,-f);n=Math.floor(m.width*t),i=Math.floor(m.height*t),r=e.isDataArrayTexture?m.depth:e.isData3DTexture?Math.floor(m.depth*t):1,s=0,a=0,o=0}null!==h?(l=h.x,c=h.y,u=h.z):(l=0,c=0,u=0);const g=me.convert(t.format),v=me.convert(t.type);let y;t.isData3DTexture?($.setTexture3D(t,0),y=ye.TEXTURE_3D):t.isDataArrayTexture||t.isCompressedArrayTexture?($.setTexture2DArray(t,0),y=ye.TEXTURE_2D_ARRAY):($.setTexture2D(t,0),y=ye.TEXTURE_2D),ye.pixelStorei(ye.UNPACK_FLIP_Y_WEBGL,t.flipY),ye.pixelStorei(ye.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),ye.pixelStorei(ye.UNPACK_ALIGNMENT,t.unpackAlignment);const _=ye.getParameter(ye.UNPACK_ROW_LENGTH),b=ye.getParameter(ye.UNPACK_IMAGE_HEIGHT),x=ye.getParameter(ye.UNPACK_SKIP_PIXELS),S=ye.getParameter(ye.UNPACK_SKIP_ROWS),E=ye.getParameter(ye.UNPACK_SKIP_IMAGES);ye.pixelStorei(ye.UNPACK_ROW_LENGTH,m.width),ye.pixelStorei(ye.UNPACK_IMAGE_HEIGHT,m.height),ye.pixelStorei(ye.UNPACK_SKIP_PIXELS,s),ye.pixelStorei(ye.UNPACK_SKIP_ROWS,a),ye.pixelStorei(ye.UNPACK_SKIP_IMAGES,o);const w=e.isDataArrayTexture||e.isData3DTexture,T=t.isDataArrayTexture||t.isData3DTexture;if(e.isDepthTexture){const d=Z.get(e),h=Z.get(t),m=Z.get(d.__renderTarget),g=Z.get(h.__renderTarget);J.bindFramebuffer(ye.READ_FRAMEBUFFER,m.__webglFramebuffer),J.bindFramebuffer(ye.DRAW_FRAMEBUFFER,g.__webglFramebuffer);for(let v=0;v<r;v++)w&&(ye.framebufferTextureLayer(ye.READ_FRAMEBUFFER,ye.COLOR_ATTACHMENT0,Z.get(e).__webglTexture,f,o+v),ye.framebufferTextureLayer(ye.DRAW_FRAMEBUFFER,ye.COLOR_ATTACHMENT0,Z.get(t).__webglTexture,p,u+v)),ye.blitFramebuffer(s,a,n,i,l,c,n,i,ye.DEPTH_BUFFER_BIT,ye.NEAREST);J.bindFramebuffer(ye.READ_FRAMEBUFFER,null),J.bindFramebuffer(ye.DRAW_FRAMEBUFFER,null)}else if(0!==f||e.isRenderTargetTexture||Z.has(e)){const d=Z.get(e),h=Z.get(t);J.bindFramebuffer(ye.READ_FRAMEBUFFER,He),J.bindFramebuffer(ye.DRAW_FRAMEBUFFER,ze);for(let e=0;e<r;e++)w?ye.framebufferTextureLayer(ye.READ_FRAMEBUFFER,ye.COLOR_ATTACHMENT0,d.__webglTexture,f,o+e):ye.framebufferTexture2D(ye.READ_FRAMEBUFFER,ye.COLOR_ATTACHMENT0,ye.TEXTURE_2D,d.__webglTexture,f),T?ye.framebufferTextureLayer(ye.DRAW_FRAMEBUFFER,ye.COLOR_ATTACHMENT0,h.__webglTexture,p,u+e):ye.framebufferTexture2D(ye.DRAW_FRAMEBUFFER,ye.COLOR_ATTACHMENT0,ye.TEXTURE_2D,h.__webglTexture,p),0!==f?ye.blitFramebuffer(s,a,n,i,l,c,n,i,ye.COLOR_BUFFER_BIT,ye.NEAREST):T?ye.copyTexSubImage3D(y,p,l,c,u+e,s,a,n,i):ye.copyTexSubImage2D(y,p,l,c,s,a,n,i);J.bindFramebuffer(ye.READ_FRAMEBUFFER,null),J.bindFramebuffer(ye.DRAW_FRAMEBUFFER,null)}else T?e.isDataTexture||e.isData3DTexture?ye.texSubImage3D(y,p,l,c,u,n,i,r,g,v,m.data):t.isCompressedArrayTexture?ye.compressedTexSubImage3D(y,p,l,c,u,n,i,r,g,m.data):ye.texSubImage3D(y,p,l,c,u,n,i,r,g,v,m):e.isDataTexture?ye.texSubImage2D(ye.TEXTURE_2D,p,l,c,n,i,g,v,m.data):e.isCompressedTexture?ye.compressedTexSubImage2D(ye.TEXTURE_2D,p,l,c,m.width,m.height,g,m.data):ye.texSubImage2D(ye.TEXTURE_2D,p,l,c,n,i,g,v,m);ye.pixelStorei(ye.UNPACK_ROW_LENGTH,_),ye.pixelStorei(ye.UNPACK_IMAGE_HEIGHT,b),ye.pixelStorei(ye.UNPACK_SKIP_PIXELS,x),ye.pixelStorei(ye.UNPACK_SKIP_ROWS,S),ye.pixelStorei(ye.UNPACK_SKIP_IMAGES,E),0===p&&t.generateMipmaps&&ye.generateMipmap(y),J.unbindTexture()},this.copyTextureToTexture3D=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return C0('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(e,t,n,i,r)},this.initRenderTarget=function(e){void 0===Z.get(e).__webglFramebuffer&&$.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?$.setTextureCube(e,0):e.isData3DTexture?$.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?$.setTexture2DArray(e,0):$.setTexture2D(e,0),J.unbindTexture()},this.resetState=function(){x=0,S=0,E=null,J.reset(),ge.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return i0}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=I0._getDrawingBufferColorSpace(e),t.unpackColorSpace=I0._getUnpackColorSpace()}}var W6=Object.defineProperty,j6=(e,t)=>{for(var n in t)W6(e,n,{get:t[n],enumerable:!0})},Y6={};j6(Y6,{ACTIONS:()=>i8,ANIMATION_MIN_DURATION:()=>K6,CAPTURE_EVENTS_CLASS:()=>n8,CTRLZOOM_TIMEOUT:()=>$6,DBLCLICK_DELAY:()=>J6,EASINGS:()=>o8,ICONS:()=>a8,IDS:()=>r8,KEY_CODES:()=>s8,LONGTOUCH_DELAY:()=>Q6,MOVE_THRESHOLD:()=>q6,SPHERE_RADIUS:()=>e8,TWOFINGERSOVERLAY_DELAY:()=>Z6,VIEWER_DATA:()=>t8});var X6,K6=500,q6=4,J6=300,Q6=500,Z6=100,$6=2e3,e8=10,t8="photoSphereViewer",n8="psv--capture-event",i8=(e=>(e.ROTATE_UP="ROTATE_UP",e.ROTATE_DOWN="ROTATE_DOWN",e.ROTATE_RIGHT="ROTATE_RIGHT",e.ROTATE_LEFT="ROTATE_LEFT",e.ZOOM_IN="ZOOM_IN",e.ZOOM_OUT="ZOOM_OUT",e))(i8||{}),r8={MENU:"menu",TWO_FINGERS:"twoFingers",CTRL_ZOOM:"ctrlZoom",ERROR:"error",DESCRIPTION:"description"},s8={Enter:"Enter",Control:"Control",Escape:"Escape",Space:" ",PageUp:"PageUp",PageDown:"PageDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Delete:"Delete",Plus:"+",Minus:"-"},a8={arrow:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="40 40 432 432"><g transform="rotate(0, 256, 256)"><path fill="currentColor" d="M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z"/></g>\x3c!-- Created by Flatart from the Noun Project --\x3e</svg>\n',close:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g fill="currentColor" transform=" translate(50, 50) rotate(45)"><rect x="-5" y="-65" width="10" height="130"/><rect x="-65" y="-5" width="130" height="10"/></g></svg>',download:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path fill="currentColor" d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/>\x3c!--Created by Michael Zenaty from the Noun Project--\x3e</svg>\n',fullscreenIn:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/>\x3c!--Created by Garrett Knoll from the Noun Project--\x3e</svg>\n',fullscreenOut:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/>\x3c!--Created by Garrett Knoll from the Noun Project--\x3e</svg>\n',info:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="currentColor" d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle fill="currentColor" cx="39.3" cy="9.2" r="8.2"/>\x3c!--Created by Arafat Uddin from the Noun Project--\x3e</svg>\n',menu:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 80 80"><g fill="currentColor"><circle r="10" cx="20" cy="20"/><circle r="10" cx="50" cy="20"/><circle r="10" cx="80" cy="20"/><circle r="10" cx="20" cy="50"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="80" cy="50"/><circle r="10" cx="20" cy="80"/><circle r="10" cx="50" cy="80"/><circle r="10" cx="80" cy="80"/></g>\x3c!-- Created by Richard Kun\xe1k from the Noun Project--\x3e</svg>\n',zoomIn:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/>\x3c!--Created by Ryan Canning from the Noun Project--\x3e</svg>\n',zoomOut:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M4.006 6.746h7.459V8.73H4.006z"/>\x3c!--Created by Ryan Canning from the Noun Project--\x3e</svg>\n'},o8={linear:e=>e,inQuad:e=>e*e,outQuad:e=>e*(2-e),inOutQuad:e=>e<.5?2*e*e:(4-2*e)*e-1,inCubic:e=>e*e*e,outCubic:e=>--e*e*e+1,inOutCubic:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,inQuart:e=>e*e*e*e,outQuart:e=>1- --e*e*e*e,inOutQuart:e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e,inQuint:e=>e*e*e*e*e,outQuint:e=>1+--e*e*e*e*e,inOutQuint:e=>e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e,inSine:e=>1-Math.cos(e*(Math.PI/2)),outSine:e=>Math.sin(e*(Math.PI/2)),inOutSine:e=>.5-.5*Math.cos(Math.PI*e),inExpo:e=>Math.pow(2,10*(e-1)),outExpo:e=>1-Math.pow(2,-10*e),inOutExpo:e=>(e=2*e-1)<0?.5*Math.pow(2,10*e):1-.5*Math.pow(2,-10*e),inCirc:e=>1-Math.sqrt(1-e*e),outCirc:e=>Math.sqrt(1-(e-1)*(e-1)),inOutCirc:e=>(e*=2)<1?.5-.5*Math.sqrt(1-e*e):.5+.5*Math.sqrt(1-(e-=2)*e)},l8={};function c8(e,t){let n=e%t;return n<0&&(n+=t),n}function u8(e){return e.reduce((e,t)=>e+t,0)}function d8(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function h8(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}function f8(e,t){return[0,2*Math.PI,2*-Math.PI].reduce((n,i)=>{const r=t-e+i;return Math.abs(r)<Math.abs(n)?r:n},1/0)}function p8(e,t){return Math.acos(Math.cos(e.pitch)*Math.cos(t.pitch)*Math.cos(e.yaw-t.yaw)+Math.sin(e.pitch)*Math.sin(t.pitch))}function m8(e,t){let[n,i]=e,[r,s]=t;n-r>Math.PI?n-=2*Math.PI:n-r<-Math.PI&&(n+=2*Math.PI);const a=(r-n)*Math.cos((i+s)/2),o=s-i;return Math.sqrt(a*a+o*o)}function g8(e){return"string"===typeof e?e.match(/^[a-z]/i)?document.getElementById(e):document.querySelector(e):e}function v8(e,t,n){void 0===n?e.classList.toggle(t):n?e.classList.add(t):n||e.classList.remove(t)}function y8(e,t){e.classList.add(...t.split(" ").filter(e=>!!e))}function _8(e,t){e.classList.remove(...t.split(" ").filter(e=>!!e))}function b8(e,t){let n=e;do{if(n===t)return!0;n=n.parentElement}while(n);return!1}function x8(e,t){if(null===e||void 0===e||!e.matches)return null;let n=e;do{if(n.matches(t))return n;n=n.parentElement}while(n);return null}function S8(e){return(null===e||void 0===e?void 0:e.composedPath()[0])||null}function E8(e,t){return e?e.composedPath().find(e=>(e instanceof HTMLElement||e instanceof SVGElement)&&e.matches(t)):null}function w8(e){let t=0,n=0,i=e;for(;i;)t+=i.offsetLeft-i.scrollLeft+i.clientLeft,n+=i.offsetTop-i.scrollTop+i.clientTop,i=i.offsetParent;return t-=window.scrollX,n-=window.scrollY,{x:t,y:n}}function T8(e,t){return window.getComputedStyle(e).getPropertyValue(t)}function M8(e){if(e.touches.length<2)return null;const t={x:e.touches[0].clientX,y:e.touches[0].clientY},n={x:e.touches[1].clientX,y:e.touches[1].clientY};return{distance:d8(t,n),angle:h8(t,n),center:{x:(t.x+n.x)/2,y:(t.y+n.y)/2}}}function A8(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e===X6:document.fullscreenElement===e}function C8(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(X6=e,e.classList.add("psv-fullscreen-emulation"),document.dispatchEvent(new Event("fullscreenchange"))):e.requestFullscreen()}function R8(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(X6.classList.remove("psv-fullscreen-emulation"),X6=null,document.dispatchEvent(new Event("fullscreenchange"))):document.exitFullscreen()}function L8(e,t){let n,i=!1,r=!1,s=!1,a=!1;return"+"===t?n=t:t.split("+").forEach(e=>{switch(e){case"Shift":i=!0;break;case"Ctrl":r=!0;break;case"Alt":s=!0;break;case"Meta":a=!0;break;case"Plus":n="+";break;case"Minus":n="-";break;default:n=e}}),i===e.shiftKey&&r===e.ctrlKey&&s===e.altKey&&a===e.metaKey&&n===e.key}function P8(e){return e.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,(e,t)=>(t>0?"-":"")+e.toLowerCase())}function I8(e,t){let n=!1;return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];n||(n=!0,setTimeout(()=>{e.apply(this,r),n=!1},t))}}function D8(e){if("object"!==typeof e||null===e||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function k8(e,t){const n=t;return function e(t,i){return Array.isArray(i)?(t&&Array.isArray(t)?t.length=0:t=[],i.forEach((n,i)=>{t[i]=e(null,n)})):"object"===typeof i?(t&&!Array.isArray(t)||(t={}),Object.keys(i).forEach(r=>{"__proto__"!==r&&("object"===typeof i[r]&&i[r]&&D8(i[r])?i[r]!==n&&(t[r]?e(t[r],i[r]):t[r]=e(null,i[r])):t[r]=i[r])})):t=i,t}(e,t)}function O8(e){return k8(null,e)}function N8(e){return!e||0===Object.keys(e).length&&e.constructor===Object}function F8(e){return null===e||void 0===e}function B8(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const i of t)if(!F8(i))return i;return null}function U8(e,t){if(e===t)return!0;if(H8(e)&&H8(t)){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n of Object.keys(e))if(!U8(e[n],t[n]))return!1;return!0}return!1}function H8(e){return"object"===typeof e&&null!==e}j6(l8,{Animation:()=>p9,Dynamic:()=>m9,MultiDynamic:()=>g9,PressHandler:()=>v9,Slider:()=>_9,SliderDirection:()=>y9,addClasses:()=>y8,angle:()=>h8,applyEulerInverse:()=>l9,checkClosedShadowDom:()=>h9,checkStylesheet:()=>u9,checkVersion:()=>d9,cleanCssPosition:()=>t9,clone:()=>O8,createTexture:()=>a9,cssPositionIsOrdered:()=>n9,dasherize:()=>P8,deepEqual:()=>U8,deepmerge:()=>k8,distance:()=>d8,exitFullscreen:()=>R8,firstNonNull:()=>B8,getAbortError:()=>W8,getAngle:()=>p8,getClosest:()=>x8,getConfigParser:()=>c9,getElement:()=>g8,getEventTarget:()=>S8,getMatchingTarget:()=>E8,getPosition:()=>w8,getShortestArc:()=>f8,getStyleProperty:()=>T8,getTouchData:()=>M8,getXMPValue:()=>K8,greatArcDistance:()=>m8,hasParent:()=>b8,invertResolvableBoolean:()=>V8,isAbortError:()=>j8,isEmpty:()=>N8,isExtendedPosition:()=>X8,isFullscreenEnabled:()=>A8,isNil:()=>F8,isPlainObject:()=>D8,keyPressMatch:()=>L8,logWarn:()=>Y8,mergePanoData:()=>f9,parseAngle:()=>s9,parsePoint:()=>e9,parseSpeed:()=>i9,removeClasses:()=>_8,requestFullscreen:()=>C8,resolveBoolean:()=>G8,speedToDuration:()=>r9,sum:()=>u8,throttle:()=>I8,toggleClass:()=>v8,wrap:()=>c8});var z8=class e extends Error{constructor(t,n){var i;super(n&&n instanceof Error?"".concat(t,": ").concat(n.message):t),this.name="PSVError",null===(i=Error.captureStackTrace)||void 0===i||i.call(Error,this,e)}};function G8(e,t){D8(e)?(t(e.initial,!0),e.promise.then(e=>t(e,!1))):t(e,!0)}function V8(e){return{initial:!e.initial,promise:e.promise.then(e=>!e)}}function W8(){const e=new Error("Loading was aborted.");return e.name="AbortError",e}function j8(e){return"AbortError"===(null===e||void 0===e?void 0:e.name)}function Y8(e){console.warn("PhotoSphereViewer: ".concat(e))}function X8(e){return!(!e||Array.isArray(e))&&[["textureX","textureY"],["yaw","pitch"]].some(t=>{let[n,i]=t;return void 0!==e[n]&&void 0!==e[i]})}function K8(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e.match("<GPano:"+t+">(.*)</GPano:"+t+">");if(null!==i){const e=n?parseInt(i[1],10):parseFloat(i[1]);return isNaN(e)?null:e}if(i=e.match("GPano:"+t+'="(.*?)"'),null!==i){const e=n?parseInt(i[1],10):parseFloat(i[1]);return isNaN(e)?null:e}return null}var q8={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},J8=["left","center","right"],Q8=["top","center","bottom"],Z8=[...J8,...Q8],$8="center";function e9(e){if(!e)return{x:.5,y:.5};if("object"===typeof e)return e;let t=e.toLocaleLowerCase().split(" ").slice(0,2);1===t.length&&(t=q8[t[0]]?[t[0],$8]:[t[0],t[0]]);const n="left"!==t[1]&&"right"!==t[1]&&"top"!==t[0]&&"bottom"!==t[0];t=t.map(e=>q8[e]||e),n||t.reverse();const i=t.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return i?{x:parseFloat(i[1])/100,y:parseFloat(i[2])/100}:{x:.5,y:.5}}function t9(e){let{allowCenter:t,cssOrder:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{allowCenter:!0,cssOrder:!0};return e?("string"===typeof e&&(e=e.split(" ")),1===e.length&&(e[0]===$8?e=[$8,$8]:-1!==J8.indexOf(e[0])?e=[$8,e[0]]:-1!==Q8.indexOf(e[0])&&(e=[e[0],$8])),2!==e.length||-1===Z8.indexOf(e[0])||-1===Z8.indexOf(e[1])?(Y8("Unparsable position ".concat(e)),null):t||e[0]!==$8||e[1]!==$8?(n&&!n9(e)&&(e=[e[1],e[0]]),e[1]===$8&&-1!==J8.indexOf(e[0])&&(e=[$8,e[0]]),e[0]===$8&&-1!==Q8.indexOf(e[1])&&(e=[e[1],$8]),e):(Y8("Invalid position center center"),null)):null}function n9(e){return-1!==Q8.indexOf(e[0])&&-1!==J8.indexOf(e[1])}function i9(e){let t;if("string"===typeof e){const n=e.toString().trim();let i=parseFloat(n.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));const r=n.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(r.match(/(pm|per minute)$/)&&(i/=60),r){case"dpm":case"degrees per minute":case"dps":case"degrees per second":t=g0.degToRad(i);break;case"rdpm":case"radians per minute":case"rdps":case"radians per second":t=i;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":t=i*Math.PI*2;break;default:throw new z8('Unknown speed unit "'.concat(r,'"'))}}else t=e;return t}function r9(e,t){if("number"!==typeof e){const n=i9(e);return t/Math.abs(n)*1e3}return Math.abs(e)}function s9(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;if("string"===typeof e){const n=e.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!n)throw new z8('Unknown angle "'.concat(e,'"'));const i=parseFloat(n[1]),r=n[2];if(r)switch(r){case"deg":case"degs":t=g0.degToRad(i);break;case"rad":case"rads":t=i;break;default:throw new z8('Unknown angle unit "'.concat(r,'"'))}else t=i}else{if("number"!==typeof e||isNaN(e))throw new z8('Unknown angle "'.concat(e,'"'));t=e}return t=c8(n?t+Math.PI:t,2*Math.PI),n?g0.clamp(t-Math.PI,-Math.PI/(i?2:1),Math.PI/(i?2:1)):t}function a9(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new G0(e);return n.needsUpdate=!0,n.minFilter=t?BZ:NZ,n.generateMipmaps=t,n.anisotropy=t?2:1,n}var o9=new y0;function l9(e,t){o9.setFromEuler(t).invert(),e.applyQuaternion(o9)}function c9(e,t){const n=function(n){const i=O8(Cr(Cr({},e),n)),r={};for(let[s,a]of Object.entries(i)){if(t&&s in t)a=t[s](a,{rawConfig:i,defValue:e[s]});else if(!(s in e)){Y8("Unknown option ".concat(s));continue}r[s]=a}return r};return n.defaults=e,n.parsers=t||{},n}function u9(e,t){"true"!==T8(e,"--psv-".concat(t,"-loaded"))&&console.error('PhotoSphereViewer: stylesheet "@photo-sphere-viewer/'.concat(t,'/index.css" is not loaded'))}function d9(e,t,n){t&&t!==n&&console.error("PhotoSphereViewer: @photo-sphere-viewer/".concat(e," is in version ").concat(t," but @photo-sphere-viewer/core is in version ").concat(n))}function h9(e){do{if(e instanceof ShadowRoot&&"closed"===e.mode)return void console.error("PhotoSphereViewer: closed shadow DOM detected, the viewer might not work as expected");e=e.parentNode}while(e)}function f9(e,t,n,i){const r={isEquirectangular:!0,fullWidth:B8(null===n||void 0===n?void 0:n.fullWidth,null===i||void 0===i?void 0:i.fullWidth),fullHeight:B8(null===n||void 0===n?void 0:n.fullHeight,null===i||void 0===i?void 0:i.fullHeight),croppedWidth:e,croppedHeight:t,croppedX:B8(null===n||void 0===n?void 0:n.croppedX,null===i||void 0===i?void 0:i.croppedX),croppedY:B8(null===n||void 0===n?void 0:n.croppedY,null===i||void 0===i?void 0:i.croppedY),poseHeading:B8(null===n||void 0===n?void 0:n.poseHeading,null===i||void 0===i?void 0:i.poseHeading,0),posePitch:B8(null===n||void 0===n?void 0:n.posePitch,null===i||void 0===i?void 0:i.posePitch,0),poseRoll:B8(null===n||void 0===n?void 0:n.poseRoll,null===i||void 0===i?void 0:i.poseRoll,0),initialHeading:null===i||void 0===i?void 0:i.initialHeading,initialPitch:null===i||void 0===i?void 0:i.initialPitch,initialFov:null===i||void 0===i?void 0:i.initialFov};return r.fullWidth||r.fullHeight||(r.fullWidth=Math.max(e,2*t),r.fullHeight=Math.round(r.fullWidth/2)),r.fullWidth||(r.fullWidth=2*r.fullHeight),r.fullHeight||(r.fullHeight=Math.round(r.fullWidth/2)),null===r.croppedX&&(r.croppedX=Math.round((r.fullWidth-e)/2)),null===r.croppedY&&(r.croppedY=Math.round((r.fullHeight-t)/2)),Math.abs(r.fullWidth-2*r.fullHeight)>1&&(Y8("Invalid panoData, fullWidth should be twice fullHeight"),r.fullHeight=Math.round(r.fullWidth/2)),r.croppedX+r.croppedWidth>r.fullWidth&&(Y8("Invalid panoData, croppedX + croppedWidth > fullWidth"),r.croppedX=r.fullWidth-r.croppedWidth),r.croppedY+r.croppedHeight>r.fullHeight&&(Y8("Invalid panoData, croppedY + croppedHeight > fullHeight"),r.croppedY=r.fullHeight-r.croppedHeight),r.croppedX<0&&(Y8("Invalid panoData, croppedX < 0"),r.croppedX=0),r.croppedY<0&&(Y8("Invalid panoData, croppedY < 0"),r.croppedY=0),r}var p9=class{constructor(e){this.easing=o8.linear,this.callbacks=[],this.resolved=!1,this.cancelled=!1,this.options=e,e?(e.easing&&(this.easing="function"===typeof e.easing?e.easing:o8[e.easing]||o8.linear),this.delayTimeout=setTimeout(()=>{this.delayTimeout=void 0,this.animationFrame=window.requestAnimationFrame(e=>this.__run(e))},e.delay||0)):this.resolved=!0}__run(e){if(this.cancelled)return;this.start||(this.start=e);const t=(e-this.start)/this.options.duration,n={};if(t<1){for(const[e,i]of Object.entries(this.options.properties))if(i){const r=i.start+(i.end-i.start)*this.easing(t);n[e]=r}this.options.onTick(n,t),this.animationFrame=window.requestAnimationFrame(e=>this.__run(e))}else{for(const[e,t]of Object.entries(this.options.properties))t&&(n[e]=t.end);this.options.onTick(n,1),this.__resolve(!0),this.animationFrame=void 0}}__resolve(e){e?this.resolved=!0:this.cancelled=!0,this.callbacks.forEach(t=>t(e)),this.callbacks.length=0}then(e){return this.resolved||this.cancelled?Promise.resolve(this.resolved).then(e):new Promise(e=>{this.callbacks.push(e)}).then(e)}cancel(){this.cancelled||this.resolved||(this.__resolve(!1),this.delayTimeout&&(window.clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0))}},m9=class{constructor(e,t){if(this.fn=e,this.mode=0,this.speed=0,this.speedMult=0,this.currentSpeed=0,this.target=0,this.__current=0,this.min=t.min,this.max=t.max,this.wrap=t.wrap,this.current=t.defaultValue,this.wrap&&0!==this.min)throw new z8("invalid config");this.fn&&this.fn(this.current)}get current(){return this.__current}set current(e){this.__current=e}setSpeed(e){this.speed=e}goto(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.mode=2,this.target=this.wrap?c8(e,this.max):g0.clamp(e,this.min,this.max),this.speedMult=t}step(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;0===t?this.setValue(this.current+e):(2!==this.mode&&(this.target=this.current),this.goto(this.target+e,t))}roll(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.mode=1,this.target=e?-1/0:1/0,this.speedMult=t}stop(){this.mode=0}setValue(e){return this.target=this.wrap?c8(e,this.max):g0.clamp(e,this.min,this.max),this.mode=0,this.currentSpeed=0,this.target!==this.current&&(this.current=this.target,this.fn&&this.fn(this.current),!0)}update(e){if(2===this.mode){this.wrap&&Math.abs(this.target-this.current)>this.max/2&&(this.current=this.current<this.target?this.current+this.max:this.current-this.max);const e=this.currentSpeed*this.currentSpeed/(this.speed*this.speedMult*4);Math.abs(this.target-this.current)<=e&&(this.mode=0)}let t=0===this.mode?0:this.speed*this.speedMult;this.target<this.current&&(t=-t),this.currentSpeed<t?this.currentSpeed=Math.min(t,this.currentSpeed+e/1e3*this.speed*this.speedMult*2):this.currentSpeed>t&&(this.currentSpeed=Math.max(t,this.currentSpeed-e/1e3*this.speed*this.speedMult*2));let n=null;return this.current>this.target&&this.currentSpeed?n=Math.max(this.target,this.current+this.currentSpeed*e/1e3):this.current<this.target&&this.currentSpeed&&(n=Math.min(this.target,this.current+this.currentSpeed*e/1e3)),null!==n&&(n=this.wrap?c8(n,this.max):g0.clamp(n,this.min,this.max),n!==this.current)&&(this.current=n,this.fn&&this.fn(this.current),!0)}},g9=class{constructor(e,t){this.fn=e,this.dynamics=t,this.fn&&this.fn(this.current)}get current(){return Object.entries(this.dynamics).reduce((e,t)=>{let[n,i]=t;return e[n]=i.current,e},{})}setSpeed(e){for(const t of Object.values(this.dynamics))t.setSpeed(e)}goto(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;for(const[n,i]of Object.entries(e))this.dynamics[n].goto(i,t)}step(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(0===t)this.setValue(Object.keys(e).reduce((t,n)=>(t[n]=e[n]+this.dynamics[n].current,t),{}));else for(const[n,i]of Object.entries(e))this.dynamics[n].step(i,t)}roll(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;for(const[n,i]of Object.entries(e))this.dynamics[n].roll(i,t)}stop(){for(const e of Object.values(this.dynamics))e.stop()}setValue(e){let t=!1;for(const[n,i]of Object.entries(e))t=this.dynamics[n].setValue(i)||t;return t&&this.fn&&this.fn(this.current),t}update(e){let t=!1;for(const n of Object.values(this.dynamics))t=n.update(e)||t;return t&&this.fn&&this.fn(this.current),t}},v9=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200;this.delay=e,this.time=0,this.delay=e}get pending(){return 0!==this.time}down(e){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.time=(new Date).getTime(),this.data=e}up(e){if(!this.time)return;Date.now()-this.time<this.delay?this.timeout=setTimeout(()=>{e(this.data),this.timeout=void 0,this.time=0,this.data=void 0},this.delay):(e(this.data),this.time=0,this.data=void 0)}},y9=(e=>(e.VERTICAL="VERTICAL",e.HORIZONTAL="HORIZONTAL",e))(y9||{}),_9=class{constructor(e,t,n){this.container=e,this.direction=t,this.listener=n,this.mousedown=!1,this.mouseover=!1,this.container.addEventListener("click",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("touchmove",this,!0),window.addEventListener("mouseup",this),window.addEventListener("touchend",this)}get isVertical(){return"VERTICAL"===this.direction}get isHorizontal(){return"HORIZONTAL"===this.direction}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this)}handleEvent(e){switch(e.type){case"click":e.stopPropagation();break;case"mousedown":this.__onMouseDown(e);break;case"mouseenter":this.__onMouseEnter(e);break;case"mouseleave":this.__onMouseLeave(e);break;case"touchstart":this.__onTouchStart(e);break;case"mousemove":this.__onMouseMove(e);break;case"touchmove":this.__onTouchMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchend":this.__onTouchEnd(e)}}__onMouseDown(e){this.mousedown=!0,this.__update(e.clientX,e.clientY,!0)}__onMouseEnter(e){this.mouseover=!0,this.__update(e.clientX,e.clientY,!0)}__onTouchStart(e){this.mouseover=!0,this.mousedown=!0;const t=e.changedTouches[0];this.__update(t.clientX,t.clientY,!0)}__onMouseMove(e){(this.mousedown||this.mouseover)&&(e.stopPropagation(),this.__update(e.clientX,e.clientY,!0))}__onTouchMove(e){if(this.mousedown||this.mouseover){e.stopPropagation();const t=e.changedTouches[0];this.__update(t.clientX,t.clientY,!0)}}__onMouseUp(e){this.mousedown&&(this.mousedown=!1,this.__update(e.clientX,e.clientY,!1))}__onMouseLeave(e){this.mouseover&&(this.mouseover=!1,this.__update(e.clientX,e.clientY,!0))}__onTouchEnd(e){if(this.mousedown){this.mouseover=!1,this.mousedown=!1;const t=e.changedTouches[0];this.__update(t.clientX,t.clientY,!1)}}__update(e,t,n){const i=this.container.getBoundingClientRect();let r;r=this.isVertical?g0.clamp((i.bottom-t)/i.height,0,1):g0.clamp((e-i.left)/i.width,0,1),this.listener({value:r,click:!n,mousedown:this.mousedown,mouseover:this.mouseover,cursor:{clientX:e,clientY:t}})}},b9={};j6(b9,{BeforeAnimateEvent:()=>T9,BeforeRenderEvent:()=>A9,BeforeRotateEvent:()=>R9,ClickEvent:()=>P9,ConfigChangedEvent:()=>D9,DoubleClickEvent:()=>O9,FullscreenEvent:()=>F9,HideNotificationEvent:()=>U9,HideOverlayEvent:()=>z9,HidePanelEvent:()=>V9,HideTooltipEvent:()=>j9,KeypressEvent:()=>X9,LoadProgressEvent:()=>q9,ObjectEnterEvent:()=>C7,ObjectEvent:()=>M7,ObjectHoverEvent:()=>I7,ObjectLeaveEvent:()=>L7,PanoramaErrorEvent:()=>t7,PanoramaLoadEvent:()=>Q9,PanoramaLoadedEvent:()=>$9,PositionUpdatedEvent:()=>s7,ReadyEvent:()=>c7,RenderEvent:()=>d7,RollUpdatedEvent:()=>o7,ShowNotificationEvent:()=>f7,ShowOverlayEvent:()=>m7,ShowPanelEvent:()=>v7,ShowTooltipEvent:()=>_7,SizeUpdatedEvent:()=>x7,StopAllEvent:()=>E7,TransitionDoneEvent:()=>i7,ViewerEvent:()=>E9,ZoomUpdatedEvent:()=>T7});var x9=class extends Event{constructor(e){super(e,{cancelable:arguments.length>1&&void 0!==arguments[1]&&arguments[1]})}},S9=class extends EventTarget{dispatchEvent(e){return super.dispatchEvent(e)}addEventListener(e,t,n){super.addEventListener(e,t,n)}removeEventListener(e,t,n){super.removeEventListener(e,t,n)}},E9=class extends x9{},w9=class e extends E9{constructor(t,n){super(e.type,!0),this.position=t,this.zoomLevel=n}};w9.type="before-animate";var T9=w9,M9=class e extends E9{constructor(t,n){super(e.type),this.timestamp=t,this.elapsed=n}};M9.type="before-render";var A9=M9,C9=class e extends E9{constructor(t){super(e.type,!0),this.position=t}};C9.type="before-rotate";var R9=C9,L9=class e extends E9{constructor(t){super(e.type),this.data=t}};L9.type="click";var P9=L9,I9=class e extends E9{constructor(t){super(e.type),this.options=t}containsOptions(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(e=>this.options.includes(e))}};I9.type="config-changed";var D9=I9,k9=class e extends E9{constructor(t){super(e.type),this.data=t}};k9.type="dblclick";var O9=k9,N9=class e extends E9{constructor(t){super(e.type),this.fullscreenEnabled=t}};N9.type="fullscreen";var F9=N9,B9=class e extends E9{constructor(t){super(e.type),this.notificationId=t}};B9.type="hide-notification";var U9=B9,H9=class e extends E9{constructor(t){super(e.type),this.overlayId=t}};H9.type="hide-overlay";var z9=H9,G9=class e extends E9{constructor(t){super(e.type),this.panelId=t}};G9.type="hide-panel";var V9=G9,W9=class e extends E9{constructor(t){super(e.type),this.tooltipData=t}};W9.type="hide-tooltip";var j9=W9,Y9=class e extends E9{constructor(t,n){super(e.type,!0),this.key=t,this.originalEvent=n}matches(e){return L8(this.originalEvent,e)}};Y9.type="key-press";var X9=Y9,K9=class e extends E9{constructor(t){super(e.type),this.progress=t}};K9.type="load-progress";var q9=K9,J9=class e extends E9{constructor(t){super(e.type),this.panorama=t}};J9.type="panorama-load";var Q9=J9,Z9=class e extends E9{constructor(t){super(e.type),this.data=t}};Z9.type="panorama-loaded";var $9=Z9,e7=class e extends E9{constructor(t,n){super(e.type),this.panorama=t,this.error=n}};e7.type="panorama-error";var t7=e7,n7=class e extends E9{constructor(t){super(e.type),this.completed=t}};n7.type="transition-done";var i7=n7,r7=class e extends E9{constructor(t){super(e.type),this.position=t}};r7.type="position-updated";var s7=r7,a7=class e extends E9{constructor(t){super(e.type),this.roll=t}};a7.type="roll-updated";var o7=a7,l7=class e extends E9{constructor(){super(e.type)}};l7.type="ready";var c7=l7,u7=class e extends E9{constructor(){super(e.type)}};u7.type="render";var d7=u7,h7=class e extends E9{constructor(t){super(e.type),this.notificationId=t}};h7.type="show-notification";var f7=h7,p7=class e extends E9{constructor(t){super(e.type),this.overlayId=t}};p7.type="show-overlay";var m7=p7,g7=class e extends E9{constructor(t){super(e.type),this.panelId=t}};g7.type="show-panel";var v7=g7,y7=class e extends E9{constructor(t,n){super(e.type),this.tooltip=t,this.tooltipData=n}};y7.type="show-tooltip";var _7=y7,b7=class e extends E9{constructor(t){super(e.type),this.size=t}};b7.type="size-updated";var x7=b7,S7=class e extends E9{constructor(){super(e.type)}};S7.type="stop-all";var E7=S7,w7=class e extends E9{constructor(t){super(e.type),this.zoomLevel=t}};w7.type="zoom-updated";var T7=w7,M7=class extends E9{constructor(e,t,n,i,r){super(e),this.originalEvent=t,this.object=n,this.viewerPoint=i,this.userDataKey=r}},A7=class e extends M7{constructor(t,n,i,r){super(e.type,t,n,i,r)}};A7.type="enter-object";var C7=A7,R7=class e extends M7{constructor(t,n,i,r){super(e.type,t,n,i,r)}};R7.type="leave-object";var L7=R7,P7=class e extends M7{constructor(t,n,i,r){super(e.type,t,n,i,r)}};P7.type="hover-object";var I7=P7,D7=class{constructor(e){this.viewer=e}init(){}destroy(){}supportsTransition(e){return!1}supportsPreload(e){return!1}textureCoordsToSphericalCoords(e,t){throw new z8("Current adapter does not support texture coordinates.")}sphericalCoordsToTextureCoords(e,t){throw new z8("Current adapter does not support texture coordinates.")}};function k7(e){if(e)for(const[,t]of[["_",e],...Object.entries(e)])if(t.prototype instanceof D7)return d9(t.id,t.VERSION,"5.14.0"),t;return null}D7.supportsDownload=!1;var O7="".concat(t8,"_touchSupport"),N7={loaded:!1,pixelRatio:1,isWebGLSupported:!1,maxTextureWidth:0,isTouchEnabled:null,__maxCanvasWidth:null,isIphone:!1,get maxCanvasWidth(){return null===this.__maxCanvasWidth&&(this.__maxCanvasWidth=function(e){let t=e,n=!1;const i=document.createElement("canvas"),r=i.getContext("2d");i.width=1,i.height=1;for(;t>1024&&!n;){const e=document.createElement("canvas"),i=e.getContext("2d");e.width=t,e.height=t/2;try{i.fillStyle="white",i.fillRect(t-1,t/2-1,1,1),r.drawImage(e,t-1,t/2-1,1,1,0,0,1,1),r.getImageData(0,0,1,1).data[0]>0&&(n=!0)}catch(s){}e.width=0,e.height=0,n||(t/=2)}if(n)return t;throw new z8("Unable to detect system capabilities")}(this.maxTextureWidth)),this.__maxCanvasWidth},load(){if(!this.loaded){const e=function(){try{return document.createElement("canvas").getContext("webgl2")}catch(e){return null}}();this.pixelRatio=window.devicePixelRatio||1,this.isWebGLSupported=!!e,this.maxTextureWidth=e?e.getParameter(e.MAX_TEXTURE_SIZE):0,this.isTouchEnabled=function(){let e="ontouchstart"in window||navigator.maxTouchPoints>0;O7 in localStorage&&(e="true"===localStorage[O7]);const t=new Promise(t=>{const n=()=>{window.removeEventListener("mousedown",i),window.removeEventListener("touchstart",r),clearTimeout(a)},i=()=>{n(),localStorage[O7]=!1,t(!1)},r=()=>{n(),localStorage[O7]=!0,t(!0)},s=()=>{n(),localStorage[O7]=e,t(e)};window.addEventListener("mousedown",i,!1),window.addEventListener("touchstart",r,!1);const a=setTimeout(s,1e4)});return{initial:e,promise:t}}(),this.isIphone=/iPhone/i.test(navigator.userAgent),this.loaded=!0}if(!N7.isWebGLSupported)throw new z8("WebGL 2 is not supported.");if(0===N7.maxTextureWidth)throw new z8("Unable to detect system capabilities")}};var F7=c9({resolution:64,useXmpData:!0,blur:!1},{resolution:e=>{if(!e||!g0.isPowerOfTwo(e))throw new z8("EquirectangularAdapter resolution must be power of two.");return e}}),B7=class e extends D7{static withConfig(t){return[e,t]}constructor(e,t){super(e),this.config=F7(t),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2}supportsTransition(){return!0}supportsPreload(){return!0}textureCoordsToSphericalCoords(e,t){if(F8(e.textureX)||F8(e.textureY))throw new z8("Texture position is missing 'textureX' or 'textureY'");const n=(e.textureX+t.croppedX)/t.fullWidth*Math.PI*2,i=(e.textureY+t.croppedY)/t.fullHeight*Math.PI;return{yaw:n>=Math.PI?n-Math.PI:n+Math.PI,pitch:Math.PI/2-i}}sphericalCoordsToTextureCoords(e,t){const n=e.yaw/Math.PI/2*t.fullWidth,i=e.pitch/Math.PI*t.fullHeight;let r=Math.round(e.yaw<Math.PI?n+t.fullWidth/2:n-t.fullWidth/2)-t.croppedX,s=Math.round(t.fullHeight/2-i)-t.croppedY;return(r<0||r>t.croppedWidth||s<0||s>t.croppedHeight)&&(r=s=void 0),{textureX:r,textureY:s}}async loadTexture(e){let t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.config.useXmpData;if("string"!==typeof e&&("object"!==typeof e||!e.path))return Promise.reject(new z8("Invalid panorama url, are you using the right adapter?"));t="string"===typeof e?{path:e,data:i}:Cr({data:i},e);const s=await this.viewer.textureLoader.loadFile(t.path,n?e=>this.viewer.textureLoader.dispatchProgress(e):null,t.path),a=r?await this.loadXMP(s):null,o=await this.viewer.textureLoader.blobToImage(s);"function"===typeof t.data&&(t.data=t.data(o,a));const l=f9(o.width,o.height,t.data,a);return{panorama:e,texture:this.createEquirectangularTexture(o),panoData:l,cacheKey:t.path}}async loadXMP(e){const t=await this.loadBlobAsString(e),n=t.indexOf("<x:xmpmeta");if(-1===n)return null;const i=t.indexOf("</x:xmpmeta>",n);if(-1===i)return null;const r=t.substring(n,i);return r.includes("GPano:")?{fullWidth:K8(r,"FullPanoWidthPixels"),fullHeight:K8(r,"FullPanoHeightPixels"),croppedWidth:K8(r,"CroppedAreaImageWidthPixels"),croppedHeight:K8(r,"CroppedAreaImageHeightPixels"),croppedX:K8(r,"CroppedAreaLeftPixels"),croppedY:K8(r,"CroppedAreaTopPixels"),poseHeading:K8(r,"PoseHeadingDegrees",!1),posePitch:K8(r,"PosePitchDegrees",!1),poseRoll:K8(r,"PoseRollDegrees",!1),initialHeading:K8(r,"InitialViewHeadingDegrees",!1),initialPitch:K8(r,"InitialViewPitchDegrees",!1),initialFov:K8(r,"InitialHorizontalFOVDegrees",!1)}:null}loadBlobAsString(e){return new Promise((t,n)=>{const i=new FileReader;i.onload=()=>t(i.result),i.onerror=n,i.readAsText(e)})}createEquirectangularTexture(e){if(this.config.blur||e.width>N7.maxTextureWidth){const t=Math.min(1,N7.maxCanvasWidth/e.width),n=new OffscreenCanvas(Math.floor(e.width*t),Math.floor(e.height*t)),i=n.getContext("2d");return this.config.blur&&(i.filter="blur(".concat(n.width/2048,"px)")),i.drawImage(e,0,0,n.width,n.height),a9(n)}return a9(e)}createMesh(e){const t=e.croppedX/e.fullWidth*2*Math.PI,n=e.croppedWidth/e.fullWidth*2*Math.PI,i=e.croppedY/e.fullHeight*Math.PI,r=e.croppedHeight/e.fullHeight*Math.PI,s=new x3(e8,Math.round(this.SPHERE_SEGMENTS/(2*Math.PI)*n),Math.round(this.SPHERE_HORIZONTAL_SEGMENTS/Math.PI*r),-Math.PI/2+t,n,i,r).scale(-1,1,1),a=new v2({depthTest:!1,depthWrite:!1});return new W2(s,a)}setTexture(e,t){e.material.map=t.texture}setTextureOpacity(e,t){e.material.opacity=t,e.material.transparent=t<1}disposeTexture(e){let{texture:t}=e;t.dispose()}disposeMesh(e){e.geometry.dispose(),e.material.dispose()}};B7.id="equirectangular",B7.VERSION="5.14.0",B7.supportsDownload=!0;var U7=B7,H7=class e extends U7{static withConfig(t){return[e,t]}constructor(e,t){var n;super(e,{resolution:null!==(n=null===t||void 0===t?void 0:t.resolution)&&void 0!==n?n:64,useXmpData:!1})}async loadTexture(e,t){const n=await super.loadTexture(e,t,null,!1);return n.panoData=null,n}createMesh(){const e=new x3(e8,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS).scale(-1,1,1).toNonIndexed(),t=e.getAttribute("uv"),n=e.getAttribute("normal");for(let r=0;r<t.count;r++)for(let e=0;e<3;e++){const i=3*r+e,s=n.getX(i),a=n.getY(i),o=n.getZ(i),l=.947;if(r<t.count/6){const e=0===s&&0===o?1:Math.acos(a)/Math.sqrt(s*s+o*o)*(2/Math.PI);t.setXY(i,s*(l/4)*e+1/4,o*(l/2)*e+.5)}else{const e=0===s&&0===o?1:Math.acos(-a)/Math.sqrt(s*s+o*o)*(2/Math.PI);t.setXY(i,l/4*-s*e+3/4,o*(l/2)*e+.5)}}e.rotateX(-Math.PI/2),e.rotateY(Math.PI);const i=new v2({depthTest:!1,depthWrite:!1});return new W2(e,i)}};H7.id="dual-fisheye",H7.VERSION="5.14.0";var z7=class e{constructor(t,n){var i;this.parent=t,this.children=[],this.state={visible:!0},this.viewer=t instanceof e?t.viewer:t,this.container=document.createElement(null!==(i=n.tagName)&&void 0!==i?i:"div"),this.container.className=n.className||"",this.parent.children.push(this),this.parent.container.appendChild(this.container)}destroy(){this.parent.container.removeChild(this.container);const e=this.parent.children.indexOf(this);-1!==e&&this.parent.children.splice(e,1),this.children.slice().forEach(e=>e.destroy()),this.children.length=0}toggle(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.isVisible())?this.show():this.hide()}hide(e){this.container.style.display="none",this.state.visible=!1}show(e){this.container.style.display="",this.state.visible=!0}isVisible(){return this.state.visible}},G7=c9({id:null,tagName:null,className:null,title:null,hoverScale:!1,collapsable:!1,tabbable:!0,icon:null,iconActive:null}),V7=class extends z7{constructor(e,t){var n;(super(e,{tagName:t.tagName,className:"psv-button ".concat(t.hoverScale?"psv-button--hover-scale":""," ").concat(t.className||"")}),this.state={visible:!0,enabled:!0,supported:!0,collapsed:!1,active:!1,width:0},this.config=G7(t),t.id||(this.config.id=this.constructor.id),t.icon&&this.__setIcon(t.icon),this.state.width=this.container.offsetWidth,this.config.title)?this.container.title=null!==(n=this.viewer.config.lang[this.config.title])&&void 0!==n?n:this.config.title:this.id&&this.id in this.viewer.config.lang&&(this.container.title=this.viewer.config.lang[this.id]);t.tabbable&&(this.container.tabIndex=0),this.container.addEventListener("click",e=>{this.state.enabled&&this.onClick(),e.stopPropagation()}),this.container.addEventListener("keydown",e=>{e.key===s8.Enter&&this.state.enabled&&(this.onClick(),e.stopPropagation())})}get id(){return this.config.id}get title(){return this.container.title}get content(){return this.container.innerHTML}get width(){return this.state.width}get collapsable(){return this.config.collapsable}show(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isVisible()||(this.state.visible=!0,this.state.collapsed||(this.container.style.display=""),e&&this.viewer.navbar.autoSize())}hide(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isVisible()&&(this.state.visible=!1,this.container.style.display="none",e&&this.viewer.navbar.autoSize())}checkSupported(){G8(this.isSupported(),(e,t)=>{this.state&&(this.state.supported=e,t?e||this.hide():this.toggle(e))})}autoSize(){}isSupported(){return!0}toggleActive(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.state.active;e!==this.state.active&&(this.state.active=e,v8(this.container,"psv-button--active",this.state.active),this.config.iconActive&&this.__setIcon(this.state.active?this.config.iconActive:this.config.icon))}disable(){this.container.classList.add("psv-button--disabled"),this.state.enabled=!1}enable(){this.container.classList.remove("psv-button--disabled"),this.state.enabled=!0}collapse(){this.state.collapsed=!0,this.container.style.display="none"}uncollapse(){this.state.collapsed=!1,this.state.visible&&(this.container.style.display="")}__setIcon(e){this.container.innerHTML=e,y8(this.container.querySelector("svg"),"psv-button-svg")}},W7=class extends V7{constructor(e,t){var n,i,r;(super(e,{id:null!==(n=t.id)&&void 0!==n?n:"psvButton-".concat(Math.random().toString(36).substring(2)),className:"psv-custom-button ".concat(t.className||""),hoverScale:!1,collapsable:!1!==t.collapsable,tabbable:!1!==t.tabbable,title:t.title}),this.customOnClick=t.onClick,t.content)&&("string"===typeof t.content?this.container.innerHTML=t.content:(this.container.classList.add("psv-custom-button--no-padding"),t.content.style.height="100%",null===(i=(r=t.content).attachViewer)||void 0===i||i.call(r,this.viewer),this.container.appendChild(t.content)));this.state.width=this.container.offsetWidth,t.disabled&&this.disable(),!1===t.visible&&this.hide()}onClick(){var e;null===(e=this.customOnClick)||void 0===e||e.call(this,this.viewer)}},j7=class extends V7{constructor(e){super(e,{className:"psv-description-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:a8.info}),this.mode=0,this.viewer.addEventListener(U9.type,this),this.viewer.addEventListener(f7.type,this),this.viewer.addEventListener(V9.type,this),this.viewer.addEventListener(v7.type,this),this.viewer.addEventListener(D9.type,this)}destroy(){this.viewer.removeEventListener(U9.type,this),this.viewer.removeEventListener(f7.type,this),this.viewer.removeEventListener(V9.type,this),this.viewer.removeEventListener(v7.type,this),this.viewer.removeEventListener(D9.type,this),super.destroy()}handleEvent(e){if(e instanceof D9)return void(e.containsOptions("description")&&this.autoSize(!0));if(!this.mode)return;let t=!1;e instanceof U9?t=1===this.mode:e instanceof f7?t=1===this.mode&&e.notificationId!==r8.DESCRIPTION:e instanceof V9?t=2===this.mode:e instanceof v7&&(t=2===this.mode&&e.panelId!==r8.DESCRIPTION),t&&(this.toggleActive(!1),this.mode=0)}onClick(){this.mode?this.__close():this.__open()}hide(e){super.hide(e),this.mode&&this.__close()}autoSize(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]){const e=this.viewer.navbar.getButton("caption",!1),t=e&&!e.isVisible(),n=!!this.viewer.config.description;t||n?this.show(!1):this.hide(!1)}}__close(){switch(this.mode){case 1:this.viewer.notification.hide(r8.DESCRIPTION);break;case 2:this.viewer.panel.hide(r8.DESCRIPTION)}}__open(){this.toggleActive(!0),this.viewer.config.description?(this.mode=2,this.viewer.panel.show({id:r8.DESCRIPTION,content:"".concat(this.viewer.config.caption?"<p>".concat(this.viewer.config.caption,"</p>"):"").concat(this.viewer.config.description)})):(this.mode=1,this.viewer.notification.show({id:r8.DESCRIPTION,content:this.viewer.config.caption}))}};j7.id="description";var Y7=class extends V7{constructor(e){super(e,{tagName:"a",className:"psv-download-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:a8.download}),this.viewer.addEventListener(D9.type,this),this.viewer.addEventListener($9.type,this)}destroy(){this.viewer.removeEventListener(D9.type,this),this.viewer.removeEventListener($9.type,this),super.destroy()}handleEvent(e){e instanceof D9?(e.containsOptions("downloadUrl")&&this.checkSupported(),e.containsOptions("downloadUrl","downloadName")&&this.__update()):e instanceof $9&&this.__update()}onClick(){}checkSupported(){this.viewer.adapter.constructor.supportsDownload||this.viewer.config.downloadUrl?this.show():this.hide()}__update(){const e=this.container;e.href=this.viewer.config.downloadUrl||this.viewer.config.panorama,e.target="_blank",e.href.startsWith("data:")&&!this.viewer.config.downloadName?e.download="panorama."+e.href.substring(0,e.href.indexOf(";")).split("/").pop():e.download=this.viewer.config.downloadName||e.href.split("/").pop()}};Y7.id="download";var X7=class extends V7{constructor(e){super(e,{className:"psv-fullscreen-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:a8.fullscreenIn,iconActive:a8.fullscreenOut}),this.viewer.addEventListener(F9.type,this)}destroy(){this.viewer.removeEventListener(F9.type,this),super.destroy()}handleEvent(e){e instanceof F9&&this.toggleActive(e.fullscreenEnabled)}onClick(){this.viewer.toggleFullscreen()}};X7.id="fullscreen";var K7=class extends V7{constructor(e){super(e,{className:"psv-menu-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:a8.menu}),this.viewer.addEventListener(v7.type,this),this.viewer.addEventListener(V9.type,this),super.hide()}destroy(){this.viewer.removeEventListener(v7.type,this),this.viewer.removeEventListener(V9.type,this),super.destroy()}handleEvent(e){e instanceof v7?this.toggleActive(e.panelId===r8.MENU):e instanceof V9&&this.toggleActive(!1)}onClick(){this.state.active?this.__hideMenu():this.__showMenu()}hide(e){super.hide(e),this.__hideMenu()}show(e){super.show(e),this.state.active&&this.__showMenu()}__showMenu(){var e,t;this.viewer.panel.show({id:r8.MENU,content:(e=this.viewer.navbar.collapsed,t=this.viewer.config.lang.menu,'\n<div class="psv-panel-menu psv-panel-menu--stripped">\n  <h1 class="psv-panel-menu-title">'.concat(a8.menu," ").concat(t,'</h1>\n  <ul class="psv-panel-menu-list">\n    ').concat(e.map(e=>'\n    <li data-psv-button="'.concat(e.id,'" class="psv-panel-menu-item" tabindex="0">\n      <span class="psv-panel-menu-item-icon">').concat(e.content,'</span>\n      <span class="psv-panel-menu-item-label">').concat(e.title,"</span>\n    </li>\n    ")).join(""),"\n  </ul>\n</div>\n")),noMargin:!0,clickHandler:e=>{const t=e?x8(e,".psv-panel-menu-item"):void 0,n=t?t.dataset.psvButton:void 0;n&&(this.viewer.navbar.getButton(n).onClick(),this.__hideMenu())}})}__hideMenu(){this.viewer.panel.hide(r8.MENU)}};function q7(e){let t=0;switch(e){case 0:t=90;break;case 1:t=-90;break;case 3:t=180;break;default:t=0}return a8.arrow.replace("rotate(0","rotate(".concat(t))}K7.id="menu";var J7=class extends V7{constructor(e,t){super(e,{className:"psv-move-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:q7(t)}),this.direction=t,this.handler=new v9,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(e){switch(e.type){case"mousedown":this.__onMouseDown();break;case"mouseup":case"touchend":this.__onMouseUp();break;case"keydown":e.key===s8.Enter&&this.__onMouseDown();break;case"keyup":e.key===s8.Enter&&this.__onMouseUp()}}onClick(){}isSupported(){return V8(N7.isTouchEnabled)}__onMouseDown(){if(!this.state.enabled)return;const e={};switch(this.direction){case 0:e.pitch=!1;break;case 1:e.pitch=!0;break;case 3:e.yaw=!1;break;default:e.yaw=!0}this.viewer.stopAll(),this.viewer.dynamics.position.roll(e),this.handler.down()}__onMouseUp(){this.state.enabled&&this.handler.up(()=>{this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer()})}};J7.groupId="move";var Q7=class extends J7{constructor(e){super(e,1)}};Q7.id="moveDown";var Z7=class extends J7{constructor(e){super(e,2)}};Z7.id="moveLeft";var $7=class extends J7{constructor(e){super(e,3)}};$7.id="moveRight";var eee=class extends J7{constructor(e){super(e,0)}};eee.id="moveUp";var tee=class extends V7{constructor(e,t,n){super(e,{className:"psv-zoom-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:t}),this.direction=n,this.handler=new v9,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(e){switch(e.type){case"mousedown":this.__onMouseDown();break;case"mouseup":case"touchend":this.__onMouseUp();break;case"keydown":e.key===s8.Enter&&this.__onMouseDown();break;case"keyup":e.key===s8.Enter&&this.__onMouseUp()}}onClick(){}isSupported(){return V8(N7.isTouchEnabled)}__onMouseDown(){this.state.enabled&&(this.viewer.dynamics.zoom.roll(1===this.direction),this.handler.down())}__onMouseUp(){this.state.enabled&&this.handler.up(()=>this.viewer.dynamics.zoom.stop())}};tee.groupId="zoom";var nee=class extends tee{constructor(e){super(e,a8.zoomIn,0)}};nee.id="zoomIn";var iee=class extends tee{constructor(e){super(e,a8.zoomOut,1)}};iee.id="zoomOut";var ree=class extends V7{constructor(e){super(e,{className:"psv-zoom-range",hoverScale:!1,collapsable:!1,tabbable:!1}),this.zoomRange=document.createElement("div"),this.zoomRange.className="psv-zoom-range-line",this.container.appendChild(this.zoomRange),this.zoomValue=document.createElement("div"),this.zoomValue.className="psv-zoom-range-handle",this.zoomRange.appendChild(this.zoomValue),this.slider=new _9(this.container,"HORIZONTAL",e=>this.__onSliderUpdate(e)),this.mediaMinWidth=parseInt(T8(this.container,"max-width"),10),this.viewer.addEventListener(T7.type,this),this.viewer.state.ready?this.__moveZoomValue(this.viewer.getZoomLevel()):this.viewer.addEventListener(c7.type,this)}destroy(){this.slider.destroy(),this.viewer.removeEventListener(T7.type,this),this.viewer.removeEventListener(c7.type,this),super.destroy()}handleEvent(e){e instanceof T7?this.__moveZoomValue(e.zoomLevel):e instanceof c7&&this.__moveZoomValue(this.viewer.getZoomLevel())}onClick(){}isSupported(){return V8(N7.isTouchEnabled)}autoSize(){this.state.supported&&(this.viewer.state.size.width<=this.mediaMinWidth&&this.state.visible?this.hide(!1):this.viewer.state.size.width>this.mediaMinWidth&&!this.state.visible&&this.show(!1))}__moveZoomValue(e){this.zoomValue.style.left=e/100*this.zoomRange.offsetWidth-this.zoomValue.offsetWidth/2+"px"}__onSliderUpdate(e){e.mousedown&&this.viewer.zoom(100*e.value)}};ree.id="zoomRange",ree.groupId="zoom";var see=class extends S9{constructor(e){super(),this.viewer=e}init(){}destroy(){}},aee=class extends see{constructor(e,t){super(e),this.config=this.constructor.configParser(t)}setOption(e,t){this.setOptions({[e]:t})}setOptions(e){const t=Cr(Cr({},this.config),e),n=this.constructor,i=n.configParser,r=n.readonlyOptions,s=n.id;for(let[a,o]of Object.entries(e))a in i.defaults?r.includes(a)?Y8("".concat(s,': Option "').concat(a,'" cannot be updated')):(a in i.parsers&&(o=i.parsers[a](o,{rawConfig:t,defValue:i.defaults[a]})),this.config[a]=o):Y8("".concat(s,': Unknown option "').concat(a,'"'))}};function oee(e){if(e)for(const[,t]of[["_",e],...Object.entries(e)])if(t.prototype instanceof see)return d9(t.id,t.VERSION,"5.14.0"),t;return null}aee.readonlyOptions=[];var lee={panorama:null,container:null,adapter:[U7,null],plugins:[],caption:null,description:null,downloadUrl:null,downloadName:null,loadingImg:null,loadingTxt:"",size:null,fisheye:0,minFov:30,maxFov:90,defaultZoomLvl:50,defaultYaw:0,defaultPitch:0,sphereCorrection:null,moveSpeed:1,zoomSpeed:1,moveInertia:.8,mousewheel:!0,mousemove:!0,mousewheelCtrlKey:!1,touchmoveTwoFingers:!1,panoData:null,requestHeaders:null,canvasBackground:"#000",defaultTransition:{speed:1500,rotation:!0,effect:"fade"},rendererParameters:{alpha:!0,antialias:!0},withCredentials:()=>!1,navbar:["zoom","move","download","description","caption","fullscreen"],lang:{zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",moveUp:"Move up",moveDown:"Move down",moveLeft:"Move left",moveRight:"Move right",description:"Description",download:"Download",fullscreen:"Fullscreen",loading:"Loading...",menu:"Menu",close:"Close",twoFingers:"Use two fingers to navigate",ctrlZoom:"Use ctrl + scroll to zoom the image",loadError:"The panorama cannot be loaded",webglError:"Your browser does not seem to support WebGL"},keyboard:"fullscreen",keyboardActions:{[s8.ArrowUp]:"ROTATE_UP",[s8.ArrowDown]:"ROTATE_DOWN",[s8.ArrowRight]:"ROTATE_RIGHT",[s8.ArrowLeft]:"ROTATE_LEFT",[s8.PageUp]:"ZOOM_IN",[s8.PageDown]:"ZOOM_OUT",[s8.Plus]:"ZOOM_IN",[s8.Minus]:"ZOOM_OUT"}},cee={panorama:"Use setPanorama method to change the panorama",panoData:"Use setPanorama method to change the panorama",container:"Cannot change viewer container",adapter:"Cannot change adapter",plugins:"Cannot change plugins"},uee={container:e=>{if(!e)throw new z8("No value given for container.");return e},adapter:(e,t)=>{let{defValue:n}=t;if(!(e=e?Array.isArray(e)?[k7(e[0]),e[1]]:[k7(e),null]:n)[0])throw new z8("An undefined value was given for adapter.");if(!e[0].id)throw new z8("Adapter has no id.");return e},defaultYaw:e=>s9(e),defaultPitch:e=>s9(e,!0),defaultZoomLvl:e=>g0.clamp(e,0,100),minFov:(e,t)=>{let{rawConfig:n}=t;return n.maxFov<e&&(Y8("maxFov cannot be lower than minFov"),e=n.maxFov),g0.clamp(e,1,179)},maxFov:(e,t)=>{let{rawConfig:n}=t;return e<n.minFov&&(e=n.minFov),g0.clamp(e,1,179)},moveInertia:(e,t)=>{let{defValue:n}=t;return!0===e?n:!1===e?0:e},lang:e=>Cr(Cr({},lee.lang),e),fisheye:e=>!0===e?1:!1===e?0:e,requestHeaders:e=>e&&"object"===typeof e?()=>e:"function"===typeof e?e:null,withCredentials:e=>"boolean"===typeof e?()=>e:"function"===typeof e?e:()=>!1,defaultTransition:(e,t)=>{let{defValue:n}=t;return null===e||0===e.speed?null:Cr(Cr({},n),e)},rendererParameters:(e,t)=>{let{defValue:n}=t;return Cr(Cr({},e),n)},plugins:e=>e.map((e,t)=>{if(!(e=Array.isArray(e)?[oee(e[0]),e[1]]:[oee(e),null])[0])throw new z8("An undefined value was given for plugin ".concat(t,"."));if(!e[0].id)throw new z8("Plugin ".concat(t," has no id."));return e}),navbar:e=>!1===e?null:!0===e?O8(lee.navbar):"string"===typeof e?e.split(/[ ,]/):e},dee=c9(lee,uee),hee=class extends V7{constructor(e){super(e,{className:"psv-caption",hoverScale:!1,collapsable:!1,tabbable:!0}),this.contentWidth=0,this.state.width=0,this.contentElt=document.createElement("div"),this.contentElt.className="psv-caption-content",this.container.appendChild(this.contentElt),this.setCaption(this.viewer.config.caption)}hide(){this.contentElt.style.display="none",this.state.visible=!1}show(){this.contentElt.style.display="",this.state.visible=!0}onClick(){}setCaption(e){this.show(),this.contentElt.innerHTML=null!==e&&void 0!==e?e:"",this.contentElt.innerHTML?this.contentWidth=this.contentElt.offsetWidth:this.contentWidth=0,this.autoSize()}autoSize(){this.toggle(this.container.offsetWidth>=this.contentWidth),this.__refreshButton()}__refreshButton(){var e;null===(e=this.viewer.navbar.getButton(j7.id,!1))||void 0===e||e.autoSize(!0)}};hee.id="caption";var fee={},pee={};function mee(e,t){if(!e.id)throw new z8("Button id is required");if(fee[e.id]=e,e.groupId&&(pee[e.groupId]=pee[e.groupId]||[]).push(e),t){const n=lee.navbar;switch(t){case"start":n.unshift(e.id);break;case"end":n.push(e.id);break;default:{const[i,r]=t.split(":"),s=n.indexOf(i);if(!i||!r||-1===s)throw new z8("Invalid defaultPosition ".concat(t));n.splice(s+("right"===r?1:0),0,e.id)}}}}[iee,ree,nee,j7,hee,Y7,X7,Z7,$7,eee,Q7].forEach(e=>mee(e));var gee=class extends z7{constructor(e){super(e,{className:"psv-navbar ".concat(n8)}),this.collapsed=[],this.state.visible=!1}show(){this.viewer.container.classList.add("psv--has-navbar"),this.container.classList.add("psv-navbar--open"),this.state.visible=!0}hide(){this.viewer.container.classList.remove("psv--has-navbar"),this.container.classList.remove("psv-navbar--open"),this.state.visible=!1}setButtons(e){this.children.slice().forEach(e=>e.destroy()),this.children.length=0,-1!==e.indexOf(hee.id)&&-1===e.indexOf(j7.id)&&e.splice(e.indexOf(hee.id),0,j7.id),e.forEach(e=>{"object"===typeof e?new W7(this,e):fee[e]?new fee[e](this):pee[e]?pee[e].forEach(e=>{new e(this)}):Y8("Unknown button ".concat(e))}),new K7(this),this.children.forEach(e=>{e instanceof V7&&e.checkSupported()}),this.autoSize()}setCaption(e){this.children.some(t=>t instanceof hee&&(t.setCaption(e),!0))}getButton(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.children.find(t=>t instanceof V7&&t.id===e);return!n&&t&&Y8('button "'.concat(e,'" not found in the navbar')),n}focusButton(e){var t,n;this.isVisible()&&(null===(t=(null===(n=this.getButton(e,!1))||void 0===n?void 0:n.container)||this.container.firstElementChild)||void 0===t||t.focus())}autoSize(){var e;this.children.forEach(e=>{e instanceof V7&&e.autoSize()});const t=this.container.offsetWidth;let n=0;const i=[];this.children.forEach(e=>{e.isVisible()&&e instanceof V7&&(n+=e.width,e.collapsable&&i.push(e))}),0!==n&&(t<n&&i.length>0?(i.forEach(e=>e.collapse()),this.collapsed=i,this.getButton(K7.id).show(!1)):t>=n&&this.collapsed.length>0&&(this.collapsed.forEach(e=>e.uncollapse()),this.collapsed=[],this.getButton(K7.id).hide(!1)),null===(e=this.getButton(hee.id,!1))||void 0===e||e.autoSize())}};B3.enabled=!1;var vee={enabled:!0,maxItems:10,ttl:600,items:{},purgeInterval:null,init(){B3.enabled&&(Y8("ThreeJS cache should be disabled"),B3.enabled=!1),!this.purgeInterval&&this.enabled&&(this.purgeInterval=setInterval(()=>this.purge(),6e4))},add(e,t,n){var i;this.enabled&&t&&(this.items[t]=null!==(i=this.items[t])&&void 0!==i?i:{files:{},lastAccess:null},this.items[t].files[e]=n,this.items[t].lastAccess=Date.now())},get(e,t){if(this.enabled&&t&&this.items[t])return this.items[t].lastAccess=Date.now(),this.items[t].files[e]},remove(e,t){this.enabled&&t&&this.items[t]&&(delete this.items[t].files[e],0===Object.keys(this.items[t].files).length&&delete this.items[t])},purge(){Object.entries(this.items).sort((e,t)=>{let[,n]=e,[,i]=t;return i.lastAccess-n.lastAccess}).forEach((e,t)=>{let[n,{lastAccess:i}]=e;t>0&&(Date.now()-i>=1e3*this.ttl||t>=this.maxItems)&&delete this.items[n]})}},yee=class extends z7{constructor(e){super(e,{className:"psv-loader-container"}),this.loader=document.createElement("div"),this.loader.className="psv-loader",this.container.appendChild(this.loader),this.size=this.loader.offsetWidth,this.canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.canvas.setAttribute("class","psv-loader-canvas"),this.canvas.setAttribute("viewBox","0 0 ".concat(this.size," ").concat(this.size)),this.loader.appendChild(this.canvas),this.textColor=T8(this.loader,"color"),this.color=T8(this.canvas,"color"),this.border=parseInt(T8(this.loader,"--psv-loader-border"),10),this.thickness=parseInt(T8(this.loader,"--psv-loader-tickness"),10);const t=this.size/2;this.canvas.innerHTML='\n            <circle cx="'.concat(t,'" cy="').concat(t,'" r="').concat(t,'" fill="').concat(this.color,'"/>\n            <path d="" fill="none" stroke="').concat(this.textColor,'" stroke-width="').concat(this.thickness,'" stroke-linecap="round"/>\n        '),this.viewer.addEventListener(D9.type,this),this.__updateContent(),this.hide()}destroy(){this.viewer.removeEventListener(D9.type,this),super.destroy()}handleEvent(e){e instanceof D9&&e.containsOptions("loadingImg","loadingTxt","lang")&&this.__updateContent()}setProgress(e){this.container.classList.remove("psv-loader--undefined");const t=g0.clamp(e,0,99.999)/100*Math.PI*2,n=this.size/2,i=n,r=this.thickness/2+this.border,s=(this.size-this.thickness)/2-this.border,a=Math.sin(t)*s+n,o=-Math.cos(t)*s+n,l=e>50?"1":"0";this.canvas.querySelector("path").setAttributeNS(null,"d","M ".concat(i," ").concat(r," A ").concat(s," ").concat(s," 0 ").concat(l," 1 ").concat(a," ").concat(o))}showUndefined(){this.show(),this.setProgress(25),this.container.classList.add("psv-loader--undefined")}__updateContent(){const e=this.loader.querySelector(".psv-loader-image, .psv-loader-text");let t;if(e&&this.loader.removeChild(e),this.viewer.config.loadingImg?(t=document.createElement("img"),t.className="psv-loader-image",t.src=this.viewer.config.loadingImg):null!==this.viewer.config.loadingTxt&&(t=document.createElement("div"),t.className="psv-loader-text",t.innerHTML=this.viewer.config.loadingTxt||this.viewer.config.lang.loading),t){const e=Math.round(Math.sqrt(2*Math.pow(this.size/2-this.thickness/2-this.border,2)));t.style.maxWidth=e+"px",t.style.maxHeight=e+"px",this.loader.appendChild(t)}}},_ee=class extends z7{constructor(e){super(e,{className:"psv-notification"}),this.state={visible:!1,contentId:null,timeout:null},this.content=document.createElement("div"),this.content.className="psv-notification-content",this.container.appendChild(this.content),this.content.addEventListener("click",()=>this.hide())}isVisible(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}toggle(){throw new z8("Notification cannot be toggled")}show(e){this.state.timeout&&(clearTimeout(this.state.timeout),this.state.timeout=null),"string"===typeof e&&(e={content:e}),this.state.contentId=e.id||null,this.content.innerHTML=e.content,this.container.classList.add("psv-notification--visible"),this.state.visible=!0,this.viewer.dispatchEvent(new f7(this.state.contentId)),e.timeout&&(this.state.timeout=setTimeout(()=>this.hide(this.state.contentId),e.timeout))}hide(e){if(this.isVisible(e)){const e=this.state.contentId;this.container.classList.remove("psv-notification--visible"),this.state.visible=!1,this.state.contentId=null,this.viewer.dispatchEvent(new U9(e))}}},bee=class extends z7{constructor(e){super(e,{className:"psv-overlay ".concat(n8)}),this.state={visible:!1,contentId:null,dismissible:!0},this.image=document.createElement("div"),this.image.className="psv-overlay-image",this.container.appendChild(this.image),this.title=document.createElement("div"),this.title.className="psv-overlay-title",this.container.appendChild(this.title),this.text=document.createElement("div"),this.text.className="psv-overlay-text",this.container.appendChild(this.text),this.container.addEventListener("click",this),this.viewer.addEventListener(X9.type,this),super.hide()}destroy(){this.viewer.removeEventListener(X9.type,this),super.destroy()}handleEvent(e){"click"===e.type?this.isVisible()&&this.state.dismissible&&(this.hide(),e.stopPropagation()):e instanceof X9&&this.isVisible()&&this.state.dismissible&&e.matches(s8.Escape)&&(this.hide(),e.preventDefault())}isVisible(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}toggle(){throw new z8("Overlay cannot be toggled")}show(e){"string"===typeof e&&(e={title:e}),this.state.contentId=e.id||null,this.state.dismissible=!1!==e.dismissible,this.image.innerHTML=e.image||"",this.title.innerHTML=e.title||"",this.text.innerHTML=e.text||"",super.show(),this.viewer.dispatchEvent(new m7(this.state.contentId))}hide(e){if(this.isVisible(e)){const e=this.state.contentId;super.hide(),this.state.contentId=null,this.viewer.dispatchEvent(new z9(e))}}},xee="psv-panel-content--no-interaction",See=class extends z7{constructor(e){super(e,{className:"psv-panel ".concat(n8)}),this.state={visible:!1,contentId:null,mouseX:0,mouseY:0,mousedown:!1,clickHandler:null,keyHandler:null,width:{}};const t=document.createElement("div");t.className="psv-panel-resizer",this.container.appendChild(t);const n=document.createElement("div");n.className="psv-panel-close-button",n.innerHTML=a8.close,n.title=e.config.lang.close,this.container.appendChild(n),this.content=document.createElement("div"),this.content.className="psv-panel-content",this.container.appendChild(this.content),n.addEventListener("click",()=>this.hide()),t.addEventListener("mousedown",this),t.addEventListener("touchstart",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this),this.viewer.container.addEventListener("mousemove",this),this.viewer.container.addEventListener("touchmove",this),this.viewer.addEventListener(X9.type,this)}destroy(){this.viewer.removeEventListener(X9.type,this),this.viewer.container.removeEventListener("mousemove",this),this.viewer.container.removeEventListener("touchmove",this),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(e){switch(e.type){case"mousedown":this.__onMouseDown(e);break;case"touchstart":this.__onTouchStart(e);break;case"mousemove":this.__onMouseMove(e);break;case"touchmove":this.__onTouchMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchend":this.__onTouchEnd(e);break;case X9.type:this.__onKeyPress(e)}}isVisible(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}toggle(){throw new z8("Panel cannot be toggled")}show(e){"string"===typeof e&&(e={content:e});const t=this.isVisible(e.id);this.state.contentId=e.id||null,this.state.visible=!0,this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),e.id&&this.state.width[e.id]?this.container.style.width=this.state.width[e.id]:e.width?this.container.style.width=e.width:this.container.style.width=null,this.content.innerHTML=e.content,this.content.scrollTop=0,this.container.classList.add("psv-panel--open"),v8(this.content,"psv-panel-content--no-margin",!0===e.noMargin),e.clickHandler&&(this.state.clickHandler=t=>{e.clickHandler(S8(t))},this.state.keyHandler=t=>{t.key===s8.Enter&&e.clickHandler(S8(t))},this.content.addEventListener("click",this.state.clickHandler),this.content.addEventListener("keydown",this.state.keyHandler),t||setTimeout(()=>{var e;null===(e=this.content.querySelector("a,button,[tabindex]"))||void 0===e||e.focus()},300)),this.viewer.dispatchEvent(new v7(this.state.contentId))}hide(e){if(this.isVisible(e)){const e=this.state.contentId;this.state.visible=!1,this.state.contentId=null,this.content.innerHTML=null,this.container.classList.remove("psv-panel--open"),this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),this.viewer.dispatchEvent(new V9(e))}}__onMouseDown(e){e.stopPropagation(),this.__startResize(e.clientX,e.clientY)}__onTouchStart(e){if(e.stopPropagation(),1===e.touches.length){const t=e.touches[0];this.__startResize(t.clientX,t.clientY)}}__onMouseUp(e){this.state.mousedown&&(e.stopPropagation(),this.state.mousedown=!1,this.content.classList.remove(xee))}__onTouchEnd(e){this.state.mousedown&&(e.stopPropagation(),0===e.touches.length&&(this.state.mousedown=!1,this.content.classList.remove(xee)))}__onMouseMove(e){this.state.mousedown&&(e.stopPropagation(),this.__resize(e.clientX,e.clientY))}__onTouchMove(e){if(this.state.mousedown){const t=e.touches[0];this.__resize(t.clientX,t.clientY)}}__onKeyPress(e){this.isVisible()&&e.matches(s8.Escape)&&(this.hide(),e.preventDefault())}__startResize(e,t){this.state.mouseX=e,this.state.mouseY=t,this.state.mousedown=!0,this.content.classList.add(xee)}__resize(e,t){const n=e,i=t,r=Math.max(200,this.container.offsetWidth-(n-this.state.mouseX))+"px";this.state.contentId&&(this.state.width[this.state.contentId]=r),this.container.style.width=r,this.state.mouseX=n,this.state.mouseY=i}},Eee=class extends z7{constructor(e,t){super(e,{className:"psv-tooltip"}),this.state={visible:!0,arrow:0,border:0,state:0,width:0,height:0,pos:"",config:null,data:null,hideTimeout:null},this.content=document.createElement("div"),this.content.className="psv-tooltip-content",this.container.appendChild(this.content),this.arrow=document.createElement("div"),this.arrow.className="psv-tooltip-arrow",this.container.appendChild(this.arrow),this.container.addEventListener("transitionend",this),this.container.addEventListener("touchdown",e=>e.stopPropagation()),this.container.addEventListener("mousedown",e=>e.stopPropagation()),this.container.style.top="-1000px",this.container.style.left="-1000px",this.show(t)}handleEvent(e){"transitionend"===e.type&&this.__onTransitionEnd(e)}destroy(){clearTimeout(this.state.hideTimeout),delete this.state.data,super.destroy()}toggle(){throw new z8("Tooltip cannot be toggled")}show(e){if(0!==this.state.state)throw new z8("Initialized tooltip cannot be re-initialized");e.className&&y8(this.container,e.className),e.style&&Object.assign(this.container.style,e.style),this.state.state=3,this.update(e.content,e),this.state.data=e.data,this.state.state=1,this.viewer.dispatchEvent(new _7(this,this.state.data)),this.__waitImages()}update(e,t){this.content.innerHTML=e;const n=this.container.getBoundingClientRect();this.state.width=n.right-n.left,this.state.height=n.bottom-n.top,this.state.arrow=parseInt(T8(this.arrow,"border-top-width"),10),this.state.border=parseInt(T8(this.container,"border-top-left-radius"),10),this.move(null!==t&&void 0!==t?t:this.state.config),this.__waitImages()}move(e){var t,n,i;if(1!==this.state.state&&3!==this.state.state)throw new z8("Uninitialized tooltip cannot be moved");e.box=null!==(t=null!==(n=e.box)&&void 0!==n?n:null===(i=this.state.config)||void 0===i?void 0:i.box)&&void 0!==t?t:{width:0,height:0},this.state.config=e;const r=this.container,s=this.arrow,a={posClass:t9(e.position,{allowCenter:!1,cssOrder:!1})||["top","center"],width:this.state.width,height:this.state.height,top:0,left:0,arrowTop:0,arrowLeft:0};this.__computeTooltipPosition(a,e);let o=null,l=null;if(a.top<0?o="bottom":a.top+a.height>this.viewer.state.size.height&&(o="top"),a.left<0?l="right":a.left+a.width>this.viewer.state.size.width&&(l="left"),l||o){const t=n9(a.posClass);o&&(a.posClass[t?0:1]=o),l&&(a.posClass[t?1:0]=l),this.__computeTooltipPosition(a,e)}r.style.top=a.top+"px",r.style.left=a.left+"px",s.style.top=a.arrowTop+"px",s.style.left=a.arrowLeft+"px";const c=a.posClass.join("-");c!==this.state.pos&&(r.classList.remove("psv-tooltip--".concat(this.state.pos)),this.state.pos=c,r.classList.add("psv-tooltip--".concat(this.state.pos)))}hide(){this.container.classList.remove("psv-tooltip--visible"),this.state.state=2,this.viewer.dispatchEvent(new j9(this.state.data));const e=parseFloat(T8(this.container,"transition-duration"));this.state.hideTimeout=setTimeout(()=>{this.destroy()},2*e)}__onTransitionEnd(e){if("transform"===e.propertyName)switch(this.state.state){case 1:this.container.classList.add("psv-tooltip--visible"),this.state.state=3;break;case 2:this.state.state=0,this.destroy()}}__computeTooltipPosition(e,t){const n=this.state.arrow,i=t.top,r=e.height,s=t.left,a=e.width,o=n+this.state.border,l=t.box.width/2+2*n,c=t.box.height/2+2*n;switch(e.posClass.join("-")){case"top-left":e.top=i-c-r,e.left=s+o-a,e.arrowTop=r,e.arrowLeft=a-o-n;break;case"top-center":e.top=i-c-r,e.left=s-a/2,e.arrowTop=r,e.arrowLeft=a/2-n;break;case"top-right":e.top=i-c-r,e.left=s-o,e.arrowTop=r,e.arrowLeft=n;break;case"bottom-left":e.top=i+c,e.left=s+o-a,e.arrowTop=2*-n,e.arrowLeft=a-o-n;break;case"bottom-center":e.top=i+c,e.left=s-a/2,e.arrowTop=2*-n,e.arrowLeft=a/2-n;break;case"bottom-right":e.top=i+c,e.left=s-o,e.arrowTop=2*-n,e.arrowLeft=n;break;case"left-top":e.top=i+o-r,e.left=s-l-a,e.arrowTop=r-o-n,e.arrowLeft=a;break;case"center-left":e.top=i-r/2,e.left=s-l-a,e.arrowTop=r/2-n,e.arrowLeft=a;break;case"left-bottom":e.top=i-o,e.left=s-l-a,e.arrowTop=n,e.arrowLeft=a;break;case"right-top":e.top=i+o-r,e.left=s+l,e.arrowTop=r-o-n,e.arrowLeft=2*-n;break;case"center-right":e.top=i-r/2,e.left=s+l,e.arrowTop=r/2-n,e.arrowLeft=2*-n;break;case"right-bottom":e.top=i-o,e.left=s+l,e.arrowTop=n,e.arrowLeft=2*-n}}__waitImages(){const e=this.content.querySelectorAll("img");if(e.length>0){const t=[];e.forEach(e=>{e.complete||t.push(new Promise(t=>{e.onload=t,e.onerror=t}))}),t.length&&Promise.all(t).then(()=>{if(1===this.state.state||3===this.state.state){const e=this.container.getBoundingClientRect();this.state.width=e.right-e.left,this.state.height=e.bottom-e.top,this.move(this.state.config)}})}}},wee=class{constructor(e){this.viewer=e,this.config=e.config,this.state=e.state}destroy(){}},Tee=new _0,Mee=new P1(0,0,0,"ZXY"),Aee=class extends wee{constructor(e){super(e)}fovToZoomLevel(e){const t=Math.round((e-this.config.minFov)/(this.config.maxFov-this.config.minFov)*100);return g0.clamp(t-2*(t-50),0,100)}zoomLevelToFov(e){return this.config.maxFov+e/100*(this.config.minFov-this.config.maxFov)}vFovToHFov(e){return g0.radToDeg(2*Math.atan(Math.tan(g0.degToRad(e)/2)*this.state.aspect))}hFovToVFov(e){return g0.radToDeg(2*Math.atan(Math.tan(g0.degToRad(e)/2)/this.state.aspect))}getAnimationProperties(e,t,n){const i=!F8(t),r=!F8(n),s={};let a=null;if(i){const n=this.viewer.getPosition(),i=f8(n.yaw,t.yaw);s.yaw={start:n.yaw,end:n.yaw+i},s.pitch={start:n.pitch,end:t.pitch},a=r9(e,p8(n,t))}if(r){const t=this.viewer.getZoomLevel(),i=Math.abs(n-t);s.zoom={start:t,end:n},null===a&&(a=r9(e,Math.PI/4*i/100))}return a=null===a?"number"===typeof e?e:K6:Math.max(K6,a),{duration:a,properties:s}}getTransitionOptions(e){var t;let n;const i=null!==(t=this.config.defaultTransition)&&void 0!==t?t:lee.defaultTransition;return n=!1===e.transition||null===e.transition?null:!0===e.transition?Cr({},i):"object"===typeof e.transition?Cr(Cr({},i),e.transition):this.config.defaultTransition,n}textureCoordsToSphericalCoords(e){var t;if(null===(t=this.state.textureData)||void 0===t||!t.panoData)throw new z8("Current adapter does not support texture coordinates or no texture has been loaded");const n=this.viewer.adapter.textureCoordsToSphericalCoords(e,this.state.textureData.panoData);return Mee.equals(this.viewer.renderer.panoramaPose)&&Mee.equals(this.viewer.renderer.sphereCorrection)?n:(this.sphericalCoordsToVector3(n,Tee),Tee.applyEuler(this.viewer.renderer.panoramaPose),Tee.applyEuler(this.viewer.renderer.sphereCorrection),this.vector3ToSphericalCoords(Tee))}sphericalCoordsToTextureCoords(e){var t;if(null===(t=this.state.textureData)||void 0===t||!t.panoData)throw new z8("Current adapter does not support texture coordinates or no texture has been loaded");return Mee.equals(this.viewer.renderer.panoramaPose)&&Mee.equals(this.viewer.renderer.sphereCorrection)||(this.sphericalCoordsToVector3(e,Tee),l9(Tee,this.viewer.renderer.sphereCorrection),l9(Tee,this.viewer.renderer.panoramaPose),e=this.vector3ToSphericalCoords(Tee)),this.viewer.adapter.sphericalCoordsToTextureCoords(e,this.state.textureData.panoData)}sphericalCoordsToVector3(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e8;return t||(t=new _0),t.x=n*-Math.cos(e.pitch)*Math.sin(e.yaw),t.y=n*Math.sin(e.pitch),t.z=n*Math.cos(e.pitch)*Math.cos(e.yaw),t}vector3ToSphericalCoords(e){const t=Math.acos(e.y/Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)),n=Math.atan2(e.x,e.z);return{yaw:n<0?-n:2*Math.PI-n,pitch:Math.PI/2-t}}viewerCoordsToVector3(e){const t=this.viewer.renderer.getIntersections(e).filter(e=>e.object.userData[t8]);return t.length?t[0].point:null}viewerCoordsToSphericalCoords(e){const t=this.viewerCoordsToVector3(e);return t?this.vector3ToSphericalCoords(t):null}vector3ToViewerCoords(e){const t=e.clone();return t.project(this.viewer.renderer.camera),{x:Math.round((t.x+1)/2*this.state.size.width),y:Math.round((1-t.y)/2*this.state.size.height)}}sphericalCoordsToViewerCoords(e){return this.sphericalCoordsToVector3(e,Tee),this.vector3ToViewerCoords(Tee)}isPointVisible(e){let t,n;if(e instanceof _0)t=e,n=this.vector3ToViewerCoords(e);else{if(!X8(e))return!1;t=this.sphericalCoordsToVector3(e,Tee),n=this.vector3ToViewerCoords(t)}return t.dot(this.viewer.state.direction)>0&&n.x>=0&&n.x<=this.viewer.state.size.width&&n.y>=0&&n.y<=this.viewer.state.size.height}cleanPosition(e){if("yaw"in e||"pitch"in e){if(!("yaw"in e)||!("pitch"in e))throw new z8("Position is missing 'yaw' or 'pitch'");return{yaw:s9(e.yaw),pitch:s9(e.pitch,!0)}}return this.textureCoordsToSphericalCoords(e)}cleanSphereCorrection(e){return{pan:s9((null===e||void 0===e?void 0:e.pan)||0),tilt:s9((null===e||void 0===e?void 0:e.tilt)||0,!0),roll:s9((null===e||void 0===e?void 0:e.roll)||0,!0,!1)}}cleanPanoramaPose(e){return{pan:g0.degToRad((null===e||void 0===e?void 0:e.poseHeading)||0),tilt:g0.degToRad((null===e||void 0===e?void 0:e.posePitch)||0),roll:g0.degToRad((null===e||void 0===e?void 0:e.poseRoll)||0)}}cleanPanoramaOptions(e,t){return null!==t&&void 0!==t&&t.isEquirectangular?(F8(e.zoom)&&!F8(t.initialFov)&&(e=Cr(Cr({},e),{},{zoom:this.fovToZoomLevel(this.hFovToVFov(t.initialFov))})),!F8(e.position)||F8(t.initialHeading)||F8(t.initialPitch)||(e=Cr(Cr({},e),{},{position:{yaw:s9(t.initialHeading),pitch:s9(t.initialPitch,!0)}})),e):e}},Cee=class e{constructor(){this.$=e.IDLE}is(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(e=>this.$&e)}set(e){this.$=e}add(e){this.$|=e}remove(e){this.$&=~e}};Cee.IDLE=0,Cee.CLICK=1,Cee.MOVING=2;var Ree=Cee,Lee=class extends wee{constructor(e){super(e),this.data={startMouseX:0,startMouseY:0,mouseX:0,mouseY:0,pinchDist:0,moveDelta:{yaw:0,pitch:0,zoom:0},accumulatorFactor:0,ctrlKeyDown:!1,dblclickData:null,dblclickTimeout:null,longtouchTimeout:null,twofingersTimeout:null,ctrlZoomTimeout:null},this.step=new Ree,this.keyHandler=new v9,this.resizeObserver=new ResizeObserver(I8(()=>this.viewer.autoSize(),50)),this.moveThreshold=q6*N7.pixelRatio}init(){window.addEventListener("keydown",this,{passive:!1}),window.addEventListener("keyup",this),this.viewer.container.addEventListener("mousedown",this),window.addEventListener("mousemove",this,{passive:!1}),window.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchstart",this,{passive:!1}),window.addEventListener("touchmove",this,{passive:!1}),window.addEventListener("touchend",this,{passive:!1}),this.viewer.container.addEventListener("wheel",this,{passive:!1}),document.addEventListener("fullscreenchange",this),this.resizeObserver.observe(this.viewer.container),this.viewer.addEventListener(A9.type,this),this.viewer.addEventListener(E7.type,this)}destroy(){window.removeEventListener("keydown",this),window.removeEventListener("keyup",this),this.viewer.container.removeEventListener("mousedown",this),window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchstart",this),window.removeEventListener("touchmove",this),window.removeEventListener("touchend",this),this.viewer.container.removeEventListener("wheel",this),document.removeEventListener("fullscreenchange",this),this.resizeObserver.disconnect(),this.viewer.removeEventListener(A9.type,this),this.viewer.removeEventListener(E7.type,this),clearTimeout(this.data.dblclickTimeout),clearTimeout(this.data.longtouchTimeout),clearTimeout(this.data.twofingersTimeout),clearTimeout(this.data.ctrlZoomTimeout),super.destroy()}handleEvent(e){switch(e.type){case"keydown":this.__onKeyDown(e);break;case"keyup":this.__onKeyUp();break;case"mousemove":this.__onMouseMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchmove":this.__onTouchMove(e);break;case"touchend":this.__onTouchEnd(e);break;case"fullscreenchange":this.__onFullscreenChange();break;case A9.type:this.__applyMoveDelta();break;case E7.type:this.__clearMoveDelta()}if(!E8(e,"."+n8))switch(e.type){case"mousedown":this.__onMouseDown(e);break;case"touchstart":this.__onTouchStart(e);break;case"wheel":this.__onMouseWheel(e)}}__onKeyDown(e){if(this.config.mousewheelCtrlKey&&(this.data.ctrlKeyDown=e.key===s8.Control,this.data.ctrlKeyDown&&(clearTimeout(this.data.ctrlZoomTimeout),this.viewer.overlay.hide(r8.CTRL_ZOOM))),this.viewer.dispatchEvent(new X9(e.key,e))&&this.state.keyboardEnabled&&this.config.keyboardActions&&!this.keyHandler.pending)for(const[t,n]of Object.entries(this.config.keyboardActions))if(L8(e,t)){if("function"===typeof n)n(this.viewer,e);else{switch("ZOOM_IN"!==n&&"ZOOM_OUT"!==n&&this.viewer.stopAll(),n){case"ROTATE_UP":this.viewer.dynamics.position.roll({pitch:!1});break;case"ROTATE_DOWN":this.viewer.dynamics.position.roll({pitch:!0});break;case"ROTATE_RIGHT":this.viewer.dynamics.position.roll({yaw:!1});break;case"ROTATE_LEFT":this.viewer.dynamics.position.roll({yaw:!0});break;case"ZOOM_IN":this.viewer.dynamics.zoom.roll(!1);break;case"ZOOM_OUT":this.viewer.dynamics.zoom.roll(!0)}this.keyHandler.down(n)}return void e.preventDefault()}}__onKeyUp(){this.data.ctrlKeyDown=!1,this.state.keyboardEnabled&&this.keyHandler.up(e=>{"ZOOM_IN"===e||"ZOOM_OUT"===e?this.viewer.dynamics.zoom.stop():(this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer())})}__onMouseDown(e){this.step.add(Ree.CLICK),this.data.startMouseX=e.clientX,this.data.startMouseY=e.clientY,this.config.mousemove&&e.preventDefault()}__onMouseUp(e){this.step.is(Ree.CLICK,Ree.MOVING)&&this.__stopMove(e.clientX,e.clientY,e,2===e.button)}__onMouseMove(e){this.config.mousemove&&this.step.is(Ree.CLICK,Ree.MOVING)&&(e.preventDefault(),this.__doMove(e.clientX,e.clientY)),this.__handleObjectsEvents(e)}__onTouchStart(e){1===e.touches.length?(this.step.add(Ree.CLICK),this.data.startMouseX=e.touches[0].clientX,this.data.startMouseY=e.touches[0].clientY,this.data.longtouchTimeout||(this.data.longtouchTimeout=setTimeout(()=>{const t=e.touches[0];this.__stopMove(t.clientX,t.clientY,e,!0),this.data.longtouchTimeout=null},Q6))):2===e.touches.length&&(this.step.set(Ree.IDLE),this.__cancelLongTouch(),this.config.mousemove&&(this.__cancelTwoFingersOverlay(),this.__startMoveZoom(e),e.preventDefault()))}__onTouchEnd(e){if(this.__cancelLongTouch(),this.step.is(Ree.CLICK,Ree.MOVING))if(e.preventDefault(),this.__cancelTwoFingersOverlay(),1===e.touches.length)this.__stopMove(this.data.mouseX,this.data.mouseY);else if(0===e.touches.length){const t=e.changedTouches[0];this.__stopMove(t.clientX,t.clientY,e)}}__onTouchMove(e){if(this.__cancelLongTouch(),this.config.mousemove)if(1===e.touches.length){if(this.config.touchmoveTwoFingers)this.step.is(Ree.CLICK)&&!this.data.twofingersTimeout&&(this.data.twofingersTimeout=setTimeout(()=>{this.viewer.overlay.show({id:r8.TWO_FINGERS,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z"/>\x3c!--Created by AomAm from the Noun Project--\x3e</svg>\n',title:this.config.lang.twoFingers})},Z6));else if(this.step.is(Ree.CLICK,Ree.MOVING)){e.preventDefault();const t=e.touches[0];this.__doMove(t.clientX,t.clientY)}}else this.__doMoveZoom(e),this.__cancelTwoFingersOverlay()}__cancelLongTouch(){this.data.longtouchTimeout&&(clearTimeout(this.data.longtouchTimeout),this.data.longtouchTimeout=null)}__cancelTwoFingersOverlay(){this.config.touchmoveTwoFingers&&(this.data.twofingersTimeout&&(clearTimeout(this.data.twofingersTimeout),this.data.twofingersTimeout=null),this.viewer.overlay.hide(r8.TWO_FINGERS))}__onMouseWheel(e){if(!this.config.mousewheel||!e.deltaY)return;if(this.config.mousewheelCtrlKey&&!this.data.ctrlKeyDown)return this.viewer.overlay.show({id:r8.CTRL_ZOOM,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 17 79 79"><path fill="currentColor" d="M38.1 29.27c-.24 0-.44.2-.44.45v10.7a.45.45 0 00.9 0v-10.7c0-.25-.2-.45-.45-.45zm10.2 26.66a11.54 11.54 0 01-8.48-6.14.45.45 0 10-.8.41 12.45 12.45 0 009.22 6.62.45.45 0 00.07-.9zm24.55-13.08a23.04 23.04 0 00-22.56-23v7.07l-.01.05a2.83 2.83 0 012.39 2.78v14.03l.09-.02h8.84v-9.22a.45.45 0 11.9 0v9.22h10.35v-.9zm0 27.33V44.66H62.5c-.02 2.01-.52 4-1.47 5.76a.45.45 0 01-.61.18.45.45 0 01-.19-.61 11.54 11.54 0 001.36-5.33h-8.83l-.1-.01a2.83 2.83 0 01-2.83 2.84h-.04-.04a2.83 2.83 0 01-2.83-2.83v-14.9a2.82 2.82 0 012.47-2.8v-7.11a23.04 23.04 0 00-22.57 23v.91h14.72V29.88a8.2 8.2 0 015.02-7.57c.22-.1.5.01.59.24.1.23-.01.5-.24.6a7.3 7.3 0 00-4.47 6.73v13.88h3.9a.45.45 0 110 .9h-3.9v.15a7.32 7.32 0 0011.23 6.17.45.45 0 01.49.76 8.22 8.22 0 01-12.62-6.93v-.15H26.82v25.52a23.04 23.04 0 0023.01 23.01 23.04 23.04 0 0023.02-23.01zm1.8-27.33v27.33A24.85 24.85 0 0149.84 95a24.85 24.85 0 01-24.82-24.82V42.85a24.85 24.85 0 0124.82-24.82 24.85 24.85 0 0124.83 24.82zM57.98 29.88v9.36a.45.45 0 11-.9 0v-9.36a7.28 7.28 0 00-3.4-6.17.45.45 0 01.49-.76 8.18 8.18 0 013.8 6.93z"/>\x3c!-- Created by Icon Island from the Noun Project --\x3e</svg>\n',title:this.config.lang.ctrlZoom}),clearTimeout(this.data.ctrlZoomTimeout),void(this.data.ctrlZoomTimeout=setTimeout(()=>this.viewer.overlay.hide(r8.CTRL_ZOOM),$6));e.preventDefault(),e.stopPropagation();const t=e.deltaY/Math.abs(e.deltaY)*5*this.config.zoomSpeed;0!==t&&this.viewer.dynamics.zoom.step(-t,5)}__onFullscreenChange(){const e=this.viewer.isFullscreenEnabled();"fullscreen"===this.config.keyboard&&(e?this.viewer.startKeyboardControl():this.viewer.stopKeyboardControl()),this.viewer.dispatchEvent(new F9(e))}__resetMove(){this.step.set(Ree.IDLE),this.data.mouseX=0,this.data.mouseY=0,this.data.startMouseX=0,this.data.startMouseY=0}__startMoveZoom(e){this.viewer.stopAll(),this.__resetMove();const t=M8(e);this.step.set(Ree.MOVING),this.data.accumulatorFactor=this.config.moveInertia,({distance:this.data.pinchDist,center:{x:this.data.mouseX,y:this.data.mouseY}}=t)}__stopMove(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.step.is(Ree.CLICK)&&!this.__moveThresholdReached(e,t)&&this.__doClick(e,t,n,i),this.config.moveInertia&&(this.data.accumulatorFactor=Math.pow(this.config.moveInertia,.5)),this.__resetMove(),this.viewer.resetIdleTimer()}__doClick(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=this.viewer.container.getBoundingClientRect(),s=e-r.left,a=t-r.top,o=this.viewer.renderer.getIntersections({x:s,y:a}),l=o.find(e=>e.object.userData[t8]);if(l){const r=this.viewer.dataHelper.vector3ToSphericalCoords(l.point),u={rightclick:i,originalEvent:n,target:S8(n),clientX:e,clientY:t,viewerX:s,viewerY:a,yaw:r.yaw,pitch:r.pitch,objects:o.map(e=>e.object).filter(e=>!e.userData[t8])};try{const e=this.viewer.dataHelper.sphericalCoordsToTextureCoords(u);Object.assign(u,e)}catch(c){}this.data.dblclickTimeout?(Math.abs(this.data.dblclickData.clientX-u.clientX)<this.moveThreshold&&Math.abs(this.data.dblclickData.clientY-u.clientY)<this.moveThreshold&&this.viewer.dispatchEvent(new O9(this.data.dblclickData)),clearTimeout(this.data.dblclickTimeout),this.data.dblclickTimeout=null,this.data.dblclickData=null):(this.viewer.dispatchEvent(new P9(u)),this.data.dblclickData=O8(u),this.data.dblclickTimeout=setTimeout(()=>{this.data.dblclickTimeout=null,this.data.dblclickData=null},J6))}}__handleObjectsEvents(e){if(!N8(this.state.objectsObservers)&&e.composedPath().includes(this.viewer.container)){const t=w8(this.viewer.container),n={x:e.clientX-t.x,y:e.clientY-t.y},i=this.viewer.renderer.getIntersections(n),r=(t,i,r)=>{this.viewer.dispatchEvent(new r(e,t,n,i))};for(const[e,s]of Object.entries(this.state.objectsObservers)){const t=i.find(t=>t.object.userData[e]);t?(s&&t.object!==s&&(r(s,e,L7),this.state.objectsObservers[e]=null),s?r(t.object,e,I7):(this.state.objectsObservers[e]=t.object,r(t.object,e,C7))):s&&(r(s,e,L7),this.state.objectsObservers[e]=null)}}}__doMove(e,t){if(this.step.is(Ree.CLICK)&&this.__moveThresholdReached(e,t))this.viewer.stopAll(),this.__resetMove(),this.step.set(Ree.MOVING),this.data.mouseX=e,this.data.mouseY=t,this.data.accumulatorFactor=this.config.moveInertia;else if(this.step.is(Ree.MOVING)){const n=(e-this.data.mouseX)*Math.cos(this.state.roll)-(t-this.data.mouseY)*Math.sin(this.state.roll),i=(t-this.data.mouseY)*Math.cos(this.state.roll)+(e-this.data.mouseX)*Math.sin(this.state.roll),r={yaw:this.config.moveSpeed*(n/this.state.size.width)*g0.degToRad(this.state.hFov),pitch:this.config.moveSpeed*(i/this.state.size.height)*g0.degToRad(this.state.vFov)};this.data.moveDelta.yaw+=r.yaw,this.data.moveDelta.pitch+=r.pitch,this.data.mouseX=e,this.data.mouseY=t}}__moveThresholdReached(e,t){return Math.abs(e-this.data.startMouseX)>=this.moveThreshold||Math.abs(t-this.data.startMouseY)>=this.moveThreshold}__doMoveZoom(e){if(this.step.is(Ree.MOVING)){e.preventDefault();const t=M8(e);this.__doMove(t.center.x,t.center.y),this.data.moveDelta.zoom+=this.config.zoomSpeed*((t.distance-this.data.pinchDist)/N7.pixelRatio),this.data.pinchDist=t.distance}}__applyMoveDelta(){const e=.001;if(Math.abs(this.data.moveDelta.yaw)>0||Math.abs(this.data.moveDelta.pitch)>0){const t=this.viewer.getPosition();this.viewer.rotate({yaw:t.yaw-this.data.moveDelta.yaw*(1-this.config.moveInertia),pitch:t.pitch+this.data.moveDelta.pitch*(1-this.config.moveInertia)}),this.data.moveDelta.yaw*=this.data.accumulatorFactor,this.data.moveDelta.pitch*=this.data.accumulatorFactor,Math.abs(this.data.moveDelta.yaw)<=e&&(this.data.moveDelta.yaw=0),Math.abs(this.data.moveDelta.pitch)<=e&&(this.data.moveDelta.pitch=0)}if(Math.abs(this.data.moveDelta.zoom)>0){const t=this.viewer.getZoomLevel();this.viewer.zoom(t+this.data.moveDelta.zoom*(1-this.config.moveInertia)),this.data.moveDelta.zoom*=this.config.moveInertia,Math.abs(this.data.moveDelta.zoom)<=e&&(this.data.moveDelta.zoom=0)}}__clearMoveDelta(){this.data.moveDelta.yaw=0,this.data.moveDelta.pitch=0,this.data.moveDelta.zoom=0}};I0.enabled=!1;var Pee=new v0,Iee=new x1,Dee=new K0,kee=class extends wee{constructor(e){super(e),this.frustumNeedsUpdate=!0,this.renderer=new V6(this.config.rendererParameters),this.renderer.setPixelRatio(N7.pixelRatio),this.renderer.outputColorSpace=V$,this.renderer.toneMapping=1,this.renderer.domElement.className="psv-canvas",this.renderer.domElement.style.background=this.config.canvasBackground,this.scene=new u3,this.camera=new n3(50,16/9,.1,2*e8),this.camera.matrixAutoUpdate=!1;const t=new W2(new x3(e8).scale(-1,1,1),new v2({opacity:0,transparent:!0,depthTest:!1,depthWrite:!1}));t.userData={[t8]:!0},this.scene.add(t),this.raycaster=new i4,this.frustum=new y3,this.container=document.createElement("div"),this.container.className="psv-canvas-container",this.container.appendChild(this.renderer.domElement),this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",e=>e.preventDefault()),this.viewer.addEventListener(x7.type,this),this.viewer.addEventListener(T7.type,this),this.viewer.addEventListener(s7.type,this),this.viewer.addEventListener(o7.type,this),this.viewer.addEventListener(D9.type,this),this.hide()}get panoramaPose(){return this.mesh.rotation}get sphereCorrection(){return this.meshContainer.rotation}init(){this.show(),this.renderer.setAnimationLoop(e=>this.__renderLoop(e))}destroy(){this.renderer.setAnimationLoop(null),this.cleanScene(this.scene),this.renderer.dispose(),this.viewer.container.removeChild(this.container),this.viewer.removeEventListener(x7.type,this),this.viewer.removeEventListener(T7.type,this),this.viewer.removeEventListener(s7.type,this),this.viewer.removeEventListener(o7.type,this),this.viewer.removeEventListener(D9.type,this),super.destroy()}handleEvent(e){switch(e.type){case x7.type:this.__onSizeUpdated();break;case T7.type:this.__onZoomUpdated();break;case s7.type:case o7.type:this.__onPositionUpdated();break;case D9.type:e.containsOptions("fisheye")&&this.__onPositionUpdated(),e.containsOptions("canvasBackground")&&(this.renderer.domElement.style.background=this.config.canvasBackground)}}hide(){this.container.style.opacity="0"}show(){this.container.style.opacity="1"}setCustomRenderer(e){this.customRenderer=e?e(this.renderer):null,this.viewer.needsUpdate()}__onSizeUpdated(){this.renderer.setSize(this.state.size.width,this.state.size.height),this.camera.aspect=this.state.aspect,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onZoomUpdated(){this.camera.fov=this.state.vFov,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onPositionUpdated(){this.camera.position.set(0,0,0),this.camera.lookAt(this.state.direction),this.config.fisheye&&this.camera.position.copy(this.state.direction).multiplyScalar(this.config.fisheye/2).negate(),this.camera.rotateZ(-this.state.roll),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__renderLoop(e){const t=this.timestamp?e-this.timestamp:0;this.timestamp=e,this.viewer.dispatchEvent(new A9(e,t)),this.viewer.dynamics.update(t),(this.state.needsUpdate||this.state.continuousUpdateCount>0)&&(this.state.needsUpdate=!1,(this.customRenderer||this.renderer).render(this.scene,this.camera),this.viewer.dispatchEvent(new d7))}setTexture(e){this.meshContainer||(this.meshContainer=new o3,this.scene.add(this.meshContainer)),this.state.textureData&&this.viewer.adapter.disposeTexture(this.state.textureData),this.mesh&&(this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh)),this.mesh=this.viewer.adapter.createMesh(e.panoData),this.viewer.adapter.setTexture(this.mesh,e,!1),this.meshContainer.add(this.mesh),this.state.textureData=e,this.viewer.needsUpdate()}setPanoramaPose(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.mesh;const n=this.viewer.dataHelper.cleanPanoramaPose(e);t.rotation.set(n.tilt,n.pan,n.roll,"YXZ")}setSphereCorrection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.meshContainer;const n=this.viewer.dataHelper.cleanSphereCorrection(e);t.rotation.set(n.tilt,n.pan,n.roll,"YXZ")}transition(e,t,n){const i="fade"===n.effect||n.rotation,r=!F8(t.position),s=!F8(t.zoom),a=new T9(r?this.viewer.dataHelper.cleanPosition(t.position):void 0,t.zoom);this.viewer.dispatchEvent(a);const o=new o3,l=this.viewer.adapter.createMesh(e.panoData);if(this.viewer.adapter.setTexture(l,e,!0),this.viewer.adapter.setTextureOpacity(l,0),this.setPanoramaPose(e.panoData,l),this.setSphereCorrection(t.sphereCorrection,o),r&&!n.rotation){const e=this.viewer.getPosition(),t=new _0(0,1,0);o.rotateOnWorldAxis(t,a.position.yaw-e.yaw);const n=new _0(0,1,0).cross(this.camera.getWorldDirection(new _0)).normalize();o.rotateOnWorldAxis(n,a.position.pitch-e.pitch)}o.add(l),this.scene.add(o),this.renderer.setRenderTarget(new j0),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null);const{duration:c,properties:u}=this.viewer.dataHelper.getAnimationProperties(n.speed,n.rotation?a.position:null,i?a.zoomLevel:null),d=new p9({properties:Cr(Cr({},u),{},{opacity:{start:0,end:1}}),duration:c,easing:"inOutCubic",onTick:e=>{switch(n.effect){case"fade":this.viewer.adapter.setTextureOpacity(l,e.opacity);break;case"black":case"white":e.opacity<.5?this.renderer.toneMappingExposure="black"===n.effect?g0.mapLinear(e.opacity,0,.5,1,0):g0.mapLinear(e.opacity,0,.5,1,5):(this.renderer.toneMappingExposure="black"===n.effect?g0.mapLinear(e.opacity,.5,1,0,1):g0.mapLinear(e.opacity,.5,1,5,1),this.mesh.visible=!1,this.viewer.adapter.setTextureOpacity(l,1),s&&!i&&this.viewer.dynamics.zoom.setValue(a.zoomLevel))}r&&n.rotation&&this.viewer.dynamics.position.setValue({yaw:e.yaw,pitch:e.pitch}),s&&i&&this.viewer.dynamics.zoom.setValue(e.zoom),this.viewer.needsUpdate()}});return d.then(i=>{o.remove(l),this.scene.remove(o),i?(this.viewer.adapter.disposeTexture(this.state.textureData),this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh),this.mesh=l,this.meshContainer.add(l),this.state.textureData=e,this.setPanoramaPose(e.panoData),this.setSphereCorrection(t.sphereCorrection),r&&!n.rotation&&this.viewer.rotate(t.position)):(this.viewer.adapter.disposeTexture(e),this.viewer.adapter.disposeMesh(l))}),d}getIntersections(e){var t;Pee.x=2*e.x/this.state.size.width-1,Pee.y=-2*e.y/this.state.size.height+1,this.raycaster.setFromCamera(Pee,this.camera);const n=this.raycaster.intersectObjects(this.scene.children,!0).filter(e=>e.object.visible).filter(e=>e.object.isMesh&&!!e.object.userData);return null!==(t=this.customRenderer)&&void 0!==t&&t.getIntersections&&n.push(...this.customRenderer.getIntersections(this.raycaster,Pee)),n}isObjectVisible(e){if(!e)return!1;if(this.frustumNeedsUpdate&&(Iee.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.frustum.setFromProjectionMatrix(Iee),this.frustumNeedsUpdate=!1),e.isVector3)return this.frustum.containsPoint(e);if(e.isMesh&&e.geometry){const t=e;return t.geometry.boundingBox||t.geometry.computeBoundingBox(),Dee.copy(t.geometry.boundingBox).applyMatrix4(t.matrixWorld),this.frustum.intersectsBox(Dee)}return!!e.isObject3D&&this.frustum.intersectsObject(e)}addObject(e){this.scene.add(e)}removeObject(e){this.scene.remove(e)}cleanScene(e){const t=e=>{var t;null===(t=e.map)||void 0===t||t.dispose(),e.uniforms&&Object.values(e.uniforms).forEach(e=>{var t,n;null===(t=e.value)||void 0===t||null===(n=t.dispose)||void 0===n||n.call(t)}),e.dispose()};e.traverse(n=>{var i,r;(null===(i=n.geometry)||void 0===i||i.dispose(),n.material&&(Array.isArray(n.material)?n.material.forEach(e=>{t(e)}):t(n.material)),n instanceof u3)||(null===(r=n.dispose)||void 0===r||r.call(n));n!==e&&this.cleanScene(n)})}},Oee=class extends Y3{constructor(){super(...arguments),this._abortController=new AbortController}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}load(e,t,n,i){const r=this._abortController.signal,s=super.load(e,e=>{o(),t(e)},n,e=>{if(o(),r.aborted){const e=new Error;e.name="AbortError",e.message="The operation was aborted.",i(e)}else i(e)});function a(){s.src=""}function o(){r.removeEventListener("abort",a,!1)}return r.addEventListener("abort",a,!1),s}},Nee=class extends wee{constructor(e){super(e),this.fileLoader=new W3,this.fileLoader.setResponseType("blob"),this.imageLoader=new Oee}destroy(){this.abortLoading(),super.destroy()}abortLoading(){var e,t;null===(e=(t=this.fileLoader).abort)||void 0===e||e.call(t),this.imageLoader.abort()}loadFile(e,t,n){const i=vee.get(e,n);if(i){if(i instanceof Blob)return null===t||void 0===t||t(100),Promise.resolve(i);vee.remove(e,n)}this.config.requestHeaders&&this.fileLoader.setRequestHeader(this.config.requestHeaders(e)),this.fileLoader.setWithCredentials(this.config.withCredentials(e));let r=0;return null===t||void 0===t||t(r),this.fileLoader.loadAsync(e,e=>{if(e.lengthComputable){const n=e.loaded/e.total*100;n>r&&(r=n,null===t||void 0===t||t(r))}}).then(i=>(r=100,null===t||void 0===t||t(r),vee.add(e,n,i),i))}loadImage(e,t,n){const i=vee.get(e,n);return i?(null===t||void 0===t||t(100),i instanceof Blob?this.blobToImage(i):Promise.resolve(i)):t||this.config.requestHeaders?this.loadFile(e,t,n).then(e=>this.blobToImage(e)):(this.imageLoader.setWithCredentials(this.config.withCredentials(e)),this.imageLoader.loadAsync(e).then(t=>(vee.add(e,n,t),t)))}blobToImage(e){return new Promise((t,n)=>{const i=document.createElement("img");i.onload=()=>{URL.revokeObjectURL(i.src),t(i)},i.onerror=n,i.src=URL.createObjectURL(e)})}preloadPanorama(e){return this.viewer.adapter.supportsPreload(e)?this.viewer.adapter.loadTexture(e,!1):Promise.reject(new z8("Current adapter does not support preload"))}dispatchProgress(e){this.viewer.loader.setProgress(e),this.viewer.dispatchEvent(new q9(Math.round(e)))}},Fee=class extends wee{constructor(e){super(e),this.zoom=new m9(e=>{this.viewer.state.vFov=this.viewer.dataHelper.zoomLevelToFov(e),this.viewer.state.hFov=this.viewer.dataHelper.vFovToHFov(this.viewer.state.vFov),this.viewer.dispatchEvent(new T7(e))},{defaultValue:this.viewer.config.defaultZoomLvl,min:0,max:100,wrap:!1}),this.position=new g9(e=>{this.viewer.dataHelper.sphericalCoordsToVector3(e,this.viewer.state.direction),this.viewer.dispatchEvent(new s7(e))},{yaw:new m9(null,{defaultValue:this.config.defaultYaw,min:0,max:2*Math.PI,wrap:!0}),pitch:new m9(null,{defaultValue:this.config.defaultPitch,min:-Math.PI/2,max:Math.PI/2,wrap:!1})}),this.roll=new m9(e=>{this.viewer.state.roll=e,this.viewer.dispatchEvent(new o7(e))},{defaultValue:0,min:-Math.PI,max:Math.PI,wrap:!1}),this.updateSpeeds()}updateSpeeds(){this.zoom.setSpeed(50*this.config.zoomSpeed),this.position.setSpeed(g0.degToRad(50*this.config.moveSpeed)),this.roll.setSpeed(g0.degToRad(50*this.config.moveSpeed))}update(e){this.zoom.update(e),this.position.update(e),this.roll.update(e)}},Bee=class{constructor(){this.ready=!1,this.needsUpdate=!1,this.continuousUpdateCount=0,this.keyboardEnabled=!1,this.direction=new _0(0,0,e8),this.roll=0,this.vFov=60,this.hFov=60,this.aspect=1,this.animation=null,this.transitionAnimation=null,this.loadingPromise=null,this.idleTime=-1,this.objectsObservers={},this.size={width:0,height:0}}},Uee=class extends S9{constructor(e){var t,n;if(super(),this.plugins={},this.children=[],this.parent=g8(e.container),!this.parent)throw new z8('"container" element not found.');this.parent[t8]=this,this.container=document.createElement("div"),this.container.classList.add("psv-container"),this.parent.appendChild(this.container),h9(this.parent),u9(this.container,"core"),this.state=new Bee,this.config=dee(e),this.__setSize(this.config.size),this.overlay=new bee(this);try{N7.load()}catch(One){return console.error(One),void this.showError(this.config.lang.webglError)}vee.init(),this.adapter=new this.config.adapter[0](this,this.config.adapter[1]),this.renderer=new kee(this),this.textureLoader=new Nee(this),this.eventsHandler=new Lee(this),this.dataHelper=new Aee(this),this.dynamics=new Fee(this),null===(t=(n=this.adapter).init)||void 0===t||t.call(n),this.loader=new yee(this),this.navbar=new gee(this),this.panel=new See(this),this.notification=new _ee(this),this.autoSize(),this.setCursor(null),G8(N7.isTouchEnabled,e=>{v8(this.container,"psv--is-touch",e)}),this.config.plugins.forEach(e=>{let[t,n]=e;this.plugins[t.id]=new t(this,n)});for(const r of Object.values(this.plugins)){var i;null===(i=r.init)||void 0===i||i.call(r)}this.config.navbar&&this.navbar.setButtons(this.config.navbar),this.state.loadingPromise||(this.config.panorama?this.setPanorama(this.config.panorama,{sphereCorrection:this.config.sphereCorrection,panoData:this.config.panoData}):this.loader.show())}destroy(){var e,t,n,i,r,s;this.stopAll(),this.stopKeyboardControl(),this.exitFullscreen();for(const[a,o]of Object.entries(this.plugins))o.destroy(),delete this.plugins[a];this.children.slice().forEach(e=>e.destroy()),this.children.length=0,null===(e=this.eventsHandler)||void 0===e||e.destroy(),null===(t=this.renderer)||void 0===t||t.destroy(),null===(n=this.textureLoader)||void 0===n||n.destroy(),null===(i=this.dataHelper)||void 0===i||i.destroy(),null===(r=this.adapter)||void 0===r||r.destroy(),null===(s=this.dynamics)||void 0===s||s.destroy(),this.parent.removeChild(this.container),delete this.parent[t8]}init(){this.eventsHandler.init(),this.renderer.init(),this.config.navbar&&this.navbar.show(),"always"===this.config.keyboard&&this.startKeyboardControl(),this.resetIdleTimer(),this.state.ready=!0,this.dispatchEvent(new c7)}resetIdleTimer(){this.state.idleTime=performance.now()}disableIdleTimer(){this.state.idleTime=-1}getPlugin(e){if("string"===typeof e)return this.plugins[e];{const t=oee(e);return t?this.plugins[t.id]:null}}getPosition(){return this.dataHelper.cleanPosition(this.dynamics.position.current)}getZoomLevel(){return this.dynamics.zoom.current}getSize(){return Cr({},this.state.size)}isFullscreenEnabled(){return A8(this.parent,N7.isIphone)}needsUpdate(){this.state.needsUpdate=!0}needsContinuousUpdate(e){e?this.state.continuousUpdateCount++:this.state.continuousUpdateCount>0&&this.state.continuousUpdateCount--}autoSize(){this.container.clientWidth===this.state.size.width&&this.container.clientHeight===this.state.size.height||(this.state.size.width=Math.round(this.container.clientWidth),this.state.size.height=Math.round(this.container.clientHeight),this.state.aspect=this.state.size.width/this.state.size.height,this.state.hFov=this.dataHelper.vFovToHFov(this.state.vFov),this.dispatchEvent(new x7(this.getSize())),this.navbar.autoSize())}setPanorama(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.textureLoader.abortLoading(),null===(t=this.state.transitionAnimation)||void 0===t||t.cancel();const i=this.dataHelper.getTransitionOptions(n);void 0===n.showLoader&&(n.showLoader=!0),void 0===n.caption&&(n.caption=this.config.caption),void 0===n.description&&(n.description=this.config.description),n.panoData||"function"!==typeof this.config.panoData||(n.panoData=this.config.panoData),this.hideError(),this.resetIdleTimer(),this.config.panorama=e,this.config.caption=n.caption,this.config.description=n.description,this.config.sphereCorrection=n.sphereCorrection,"function"===typeof this.config.panoData&&"function"!==typeof n.panoData||(this.config.panoData=n.panoData);const r=t=>{if(j8(t))return!1;if(this.loader.hide(),this.state.loadingPromise=null,t)throw this.navbar.setCaption(null),this.showError(this.config.lang.loadError),console.error(t),this.dispatchEvent(new t7(e,t)),t;return this.navbar.setCaption(this.config.caption),!0};this.navbar.setCaption("<em>".concat(this.config.lang.loading,"</em>")),!n.showLoader&&this.state.ready||this.loader.show(),this.dispatchEvent(new Q9(e));const s=this.adapter.loadTexture(this.config.panorama,!0,n.panoData).then(e=>{if(e.panorama!==this.config.panorama)throw this.adapter.disposeTexture(e),W8();const t=this.dataHelper.cleanPanoramaOptions(n,e.panoData);return F8(t.zoom)&&F8(t.position)||this.stopAll(),{textureData:e,cleanOptions:t}});return i&&this.state.ready&&this.adapter.supportsTransition(this.config.panorama)?this.state.loadingPromise=s.then(e=>{let{textureData:t,cleanOptions:n}=e;return this.loader.hide(),this.dispatchEvent(new $9(t)),this.state.transitionAnimation=this.renderer.transition(t,n,i),this.state.transitionAnimation}).then(e=>{if(this.state.transitionAnimation=null,this.dispatchEvent(new i7(e)),!e)throw W8()}).then(()=>r(),e=>r(e)):this.state.loadingPromise=s.then(e=>{let{textureData:t,cleanOptions:i}=e;this.renderer.show(),this.renderer.setTexture(t),this.renderer.setPanoramaPose(t.panoData),this.renderer.setSphereCorrection(n.sphereCorrection),this.state.ready||this.init(),this.dispatchEvent(new $9(t)),F8(i.zoom)||this.zoom(i.zoom),F8(i.position)||this.rotate(i.position)}).then(()=>r(),e=>r(e)),this.state.loadingPromise}setOptions(e){const t=Cr(Cr({},this.config),e);for(let[n,i]of Object.entries(e))if(n in lee)if(n in cee)Y8(cee[n]);else switch(n in uee&&(i=uee[n](i,{rawConfig:t,defValue:lee[n]})),this.config[n]=i,n){case"mousemove":this.state.cursorOverride||this.setCursor(null);break;case"caption":this.navbar.setCaption(this.config.caption);break;case"size":this.resize(this.config.size);break;case"sphereCorrection":this.renderer.setSphereCorrection(this.config.sphereCorrection);break;case"navbar":case"lang":this.navbar.setButtons(this.config.navbar);break;case"moveSpeed":case"zoomSpeed":this.dynamics.updateSpeeds();break;case"minFov":case"maxFov":this.dynamics.zoom.setValue(this.dataHelper.fovToZoomLevel(this.state.vFov)),this.dispatchEvent(new T7(this.getZoomLevel()));break;case"keyboard":"always"===this.config.keyboard?this.startKeyboardControl():this.stopKeyboardControl()}else Y8("Unknown option ".concat(n));this.needsUpdate(),this.dispatchEvent(new D9(Object.keys(e)))}setOption(e,t){this.setOptions({[e]:t})}showError(e){this.overlay.show({id:r8.ERROR,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="15 15 70 70"><path fill="currentColor" d="M50,16.2c-18.6,0-33.8,15.1-33.8,33.8S31.4,83.7,50,83.7S83.8,68.6,83.8,50S68.6,16.2,50,16.2z M50,80.2c-16.7,0-30.2-13.6-30.2-30.2S33.3,19.7,50,19.7S80.3,33.3,80.3,50S66.7,80.2,50,80.2z"/><rect fill="currentColor" x="48" y="31.7" width="4" height="28"/><rect fill="currentColor" x="48" y="63.2" width="4" height="5"/>\x3c!--Created by Shastry from the Noun Project--\x3e</svg>\n',title:e,dismissible:!1})}hideError(){this.overlay.hide(r8.ERROR)}rotate(e){const t=new R9(this.dataHelper.cleanPosition(e));this.dispatchEvent(t),t.defaultPrevented||this.dynamics.position.setValue(t.position)}zoom(e){this.dynamics.zoom.setValue(e)}zoomIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.dynamics.zoom.step(e)}zoomOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.dynamics.zoom.step(-e)}animate(e){const t=X8(e),n=!F8(e.zoom),i=new T9(t?this.dataHelper.cleanPosition(e):void 0,e.zoom);if(this.dispatchEvent(i),i.defaultPrevented)return;this.stopAll();const{duration:r,properties:s}=this.dataHelper.getAnimationProperties(e.speed,i.position,i.zoomLevel);return r?(this.state.animation=new p9({properties:s,duration:r,easing:e.easing||"inOutSine",onTick:e=>{t&&this.dynamics.position.setValue({yaw:e.yaw,pitch:e.pitch}),n&&this.dynamics.zoom.setValue(e.zoom)}}),this.state.animation.then(()=>{this.state.animation=null,this.resetIdleTimer()}),this.state.animation):(t&&this.rotate(i.position),n&&this.zoom(i.zoomLevel),new p9(null))}stopAnimation(){return this.state.animation?(this.state.animation.cancel(),this.state.animation):Promise.resolve()}resize(e){this.__setSize(e),this.autoSize()}__setSize(e){["width","height"].forEach(t=>{null!==e&&void 0!==e&&e[t]&&(/^[0-9.]+$/.test(e[t])&&(e[t]+="px"),this.parent.style[t]=e[t])})}enterFullscreen(){this.isFullscreenEnabled()||C8(this.parent,N7.isIphone)}exitFullscreen(){this.isFullscreenEnabled()&&R8(N7.isIphone)}toggleFullscreen(){this.isFullscreenEnabled()?this.exitFullscreen():this.enterFullscreen()}startKeyboardControl(){this.state.keyboardEnabled=!0}stopKeyboardControl(){this.state.keyboardEnabled=!1}createTooltip(e){return new Eee(this,e)}setCursor(e){this.state.cursorOverride=e,this.container.style.cursor=e||(this.config.mousemove?"move":"default")}observeObjects(e){this.state.objectsObservers[e]||(this.state.objectsObservers[e]=null)}unobserveObjects(e){delete this.state.objectsObservers[e]}stopAll(){return this.dispatchEvent(new E7),this.disableIdleTimer(),this.stopAnimation()}};function Hee(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zee={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,i,s,a){if("function"!==typeof i)throw new TypeError("The listener must be a function");var o=new r(i,s||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new i:delete e._events[t]}function o(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},o.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,a=new Array(s);r<s;r++)a[r]=i[r].fn;return a},o.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},o.prototype.emit=function(e,t,i,r,s,a){var o=n?n+e:e;if(!this._events[o])return!1;var l,c,u=this._events[o],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,r),!0;case 5:return u.fn.call(u.context,t,i,r,s),!0;case 6:return u.fn.call(u.context,t,i,r,s,a),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,f=u.length;for(c=0;c<f;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,i);break;case 4:u[c].fn.call(u[c].context,t,i,r);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},o.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,i,r){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||r&&!o.once||i&&o.context!==i||a(this,s);else{for(var l=0,c=[],u=o.length;l<u;l++)(o[l].fn!==t||r&&!o[l].once||i&&o[l].context!==i)&&c.push(o[l]);c.length?this._events[s]=1===c.length?c[0]:c:a(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(zee);var Gee=new(Hee(zee.exports)),Vee={on:function(e,t){return Gee.on(e,t)},once:function(e,t){return Gee.once(e,t)},off:function(e,t){return Gee.off(e,t)},emit:function(e,t){return Gee.emit(e,t)}};Object.freeze(Vee);var Wee=["src","height","width","hideNavbarButton","containerClass","littlePlanet","onPositionChange","onZoomChange","onClick","onDblclick","onReady"],jee=["zoom","fullscreen"];function Yee(e){return null==e?jee:Array.isArray(e)?e:"string"===typeof e?""!==e&&[e]:!!e&&jee}var Xee=(0,t.forwardRef)(function(e,n){var i=function(){var e=XQ((0,t.useState)(),2),n=e[0],i=e[1],r=(0,t.useCallback)(function(e){e&&e!==n&&i(e)},[n]);return[n,r]}(),r=XQ(i,2),s=r[0],a=r[1],o=(0,t.useMemo)(function(){return e},[e.panorama,e.src,e.size,e.canvasBackground,e.navbar,e.height,e.width,e.containerClass,e.hideNavbarButton||!0,e.littlePlanet,e.fishEye,e.lang,e.onPositionChange,e.onZoomChange,e.onClick,e.onDblclick,e.onReady,e.moveSpeed,e.zoomSpeed,e.moveInertia,e.mousewheel,e.mousemove,e.mousewheelCtrlKey,e.touchmoveTwoFingers,e.panoData,e.requestHeaders,e.withCredentials,e.keyboard,e.keyboardActions,e.plugins,e.adapter,e.sphereCorrection,e.minFov,e.maxFov,e.defaultZoomLvl,e.defaultYaw,e.defaultPitch,e.caption,e.description,e.downloadUrl,e.downloadName,e.loadingImg,e.loadingTxt,e.rendererParameters,e.defaultTransition]),l=(0,t.useRef)(null),c=130,u=XQ((0,t.useState)(-90),1)[0],d=XQ((0,t.useState)(2),1)[0],h=XQ((0,t.useState)(0),1)[0],f=XQ((0,t.useState)(jee),2),p=f[0],m=f[1],g=(0,t.useRef)(!0);(0,t.useEffect)(function(){function e(){var e,t,n=window.innerWidth/window.innerHeight;c=Math.floor((n-(e=.5))*(115-(t=140))/(1.8-e)+t)}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}},[]),(0,t.useEffect)(function(){if(s&&!l.current){var t,n,i,r,a,f,p,v,y,_=new Uee(YQ(YQ({},function(e){var t=YQ({},e);for(var n in t)Wee.includes(n)&&delete t[n];return t}(o)),{},{container:s,panorama:o.panorama||o.src,size:{height:o.height,width:o.width||"100px"},fisheye:o.littlePlanet?d:o.fisheye||!1,minFov:null!==(t=o.minFov)&&void 0!==t?t:30,maxFov:o.littlePlanet?c:null!==(n=o.maxFov)&&void 0!==n?n:90,defaultZoomLvl:o.littlePlanet?h:null!==(i=o.defaultZoomLvl)&&void 0!==i?i:50,defaultYaw:null!==(r=o.defaultYaw)&&void 0!==r?r:0,defaultPitch:o.littlePlanet?u:null!==(a=o.defaultPitch)&&void 0!==a?a:0,sphereCorrection:o.sphereCorrection||{pan:0,tilt:0,roll:0},moveSpeed:o.moveSpeed||1,zoomSpeed:o.zoomSpeed||1,moveInertia:null===(f=o.moveInertia)||void 0===f||f,mousewheel:!o.littlePlanet&&(null===(p=o.mousewheel)||void 0===p||p),mousemove:null===(v=o.mousemove)||void 0===v||v,mousewheelCtrlKey:o.mousewheelCtrlKey||!1,touchmoveTwoFingers:o.touchmoveTwoFingers||!1,panoData:o.panoData||void 0,requestHeaders:o.requestHeaders||void 0,withCredentials:o.withCredentials||!1,navbar:Yee(o.navbar),lang:o.lang||{},keyboard:o.keyboard||"fullscreen",plugins:null!==(y=o.plugins)&&void 0!==y?y:[]}));_.addEventListener("ready",function(){o.onReady&&o.onReady(_)},{once:!0}),_.addEventListener("click",function(e){o.onClick&&o.onClick(e,_),o.littlePlanet&&g.current&&(g.current=!1,_.animate({yaw:0,pitch:u,zoom:75,speed:"3rpm"}).then(function(){_.animate({yaw:0,pitch:0,zoom:90,speed:"10rpm"}).then(function(){var e;_.setOption("maxFov",o.maxFov||70),_.setOption("mousewheel",null===(e=o.mousewheel)||void 0===e||e)})}))}),_.addEventListener("dblclick",function(e){o.onDblclick&&o.onDblclick(e,_)}),_.addEventListener("zoom-updated",function(e){o.onZoomChange&&o.onZoomChange(e,_)}),_.addEventListener("position-updated",function(e){o.onPositionChange&&o.onPositionChange(e.position.pitch,e.position.yaw,_)});var b=Yee(o.navbar);if(o.littlePlanet){var x,S,E={id:"resetLittlePlanetButton",content:(null===(x=e.lang)||void 0===x?void 0:x.littlePlanetIcon)||'<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="none">\n                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 20C16.4183 20 20 16.4183 20 12C20 11.8805 19.9974 11.7615 19.9922 11.6433C20.2479 11.4141 20.4882 11.1864 20.7118 10.9611C21.0037 10.6672 21.002 10.1923 20.708 9.90049C20.4336 9.628 20.0014 9.61143 19.7077 9.84972C19.4023 8.75248 18.8688 7.75024 18.1616 6.89725C18.4607 6.84611 18.7436 6.8084 19.0087 6.784C19.4212 6.74604 19.7247 6.38089 19.6868 5.96842C19.6488 5.55595 19.2837 5.25235 18.8712 5.29032C18.4474 5.32932 17.9972 5.39638 17.5262 5.48921C17.3267 5.52851 17.1614 5.64353 17.0543 5.79852C15.6765 4.67424 13.917 4 12 4C7.58172 4 4 7.58172 4 12C4 12.2776 4.01414 12.552 4.04175 12.8223C3.78987 12.7532 3.50899 12.8177 3.31137 13.0159C2.97651 13.3517 2.67596 13.6846 2.415 14.0113C2.15647 14.3349 2.20924 14.8069 2.53287 15.0654C2.8565 15.3239 3.32843 15.2711 3.58696 14.9475C3.78866 14.695 4.02466 14.4302 4.2938 14.1557C4.60754 15.2796 5.16056 16.3037 5.8945 17.1697C5.66824 17.3368 5.54578 17.6248 5.60398 17.919C5.68437 18.3253 6.07894 18.5896 6.48528 18.5092C6.7024 18.4662 6.92455 18.4177 7.15125 18.3637C8.49656 19.3903 10.1771 20 12 20ZM7.15125 18.3637C6.69042 18.012 6.26891 17.6114 5.8945 17.1697C5.98073 17.106 6.08204 17.0599 6.19417 17.0377C7.19089 16.8405 8.33112 16.5084 9.55581 16.0486C9.94359 15.903 10.376 16.0994 10.5216 16.4872C10.6671 16.8749 10.4708 17.3073 10.083 17.4529C9.05325 17.8395 8.0653 18.1459 7.15125 18.3637ZM19.7077 9.84972C19.6869 9.86663 19.6667 9.88483 19.6474 9.90431C18.9609 10.5957 18.0797 11.3337 17.0388 12.0753C16.7014 12.3157 16.6228 12.784 16.8631 13.1213C17.1035 13.4587 17.5718 13.5373 17.9091 13.297C18.6809 12.7471 19.3806 12.1912 19.9922 11.6433C19.965 11.0246 19.8676 10.4241 19.7077 9.84972ZM20.9366 5.37924C20.5336 5.28378 20.1294 5.53313 20.034 5.93619C19.9385 6.33925 20.1879 6.74339 20.5909 6.83886C20.985 6.93219 21.1368 7.07125 21.1932 7.16142C21.2565 7.26269 21.3262 7.52732 21.0363 8.10938C20.8516 8.48014 21.0025 8.93042 21.3732 9.1151C21.744 9.29979 22.1943 9.14894 22.379 8.77818C22.7566 8.02003 22.9422 7.12886 22.4648 6.36582C22.1206 5.81574 21.5416 5.52252 20.9366 5.37924ZM2.81481 16.2501C2.94057 15.8555 2.72259 15.4336 2.32793 15.3078C1.93327 15.1821 1.51138 15.4 1.38562 15.7947C1.19392 16.3963 1.17354 17.0573 1.53488 17.6349C1.98775 18.3587 2.84153 18.6413 3.68907 18.7224C4.1014 18.7619 4.46765 18.4596 4.50712 18.0473C4.54658 17.635 4.24432 17.2687 3.83199 17.2293C3.13763 17.1628 2.88355 16.9624 2.80651 16.8393C2.75679 16.7598 2.70479 16.5954 2.81481 16.2501ZM15.7504 14.704C16.106 14.4915 16.2218 14.0309 16.0093 13.6754C15.7967 13.3199 15.3362 13.204 14.9807 13.4166C14.4991 13.7045 13.9974 13.9881 13.4781 14.2648C12.9445 14.5491 12.4132 14.8149 11.8883 15.0615C11.5134 15.2376 11.3522 15.6843 11.5283 16.0592C11.7044 16.4341 12.1511 16.5953 12.526 16.4192C13.0739 16.1618 13.6277 15.8847 14.1834 15.5887C14.7242 15.3005 15.2474 15.0048 15.7504 14.704Z" fill="rgba(255,255,255,.7)"/>\n                </svg>',title:(null===(S=e.lang)||void 0===S?void 0:S.littlePlanetButton)||"Reset Little Planet",className:"resetLittlePlanetButton",onClick:function(){g.current=!0,_.setOption("maxFov",c),_.setOption("mousewheel",!1),_.animate({yaw:0,pitch:u,zoom:h,speed:"10rpm"})}};!1===b||b.find(function(e){return"object"===KQ(e)&&"resetLittlePlanetButton"===(null===e||void 0===e?void 0:e.id)})||b.splice(1,0,E)}if(o.hideNavbarButton){var w={id:"hideNavbarButton",content:'<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="none">\n                            <g clip-path="url(#clip0_429_11083)">\n                            <path d="M7 7.00006L17 17.0001M7 17.0001L17 7.00006" stroke="rgba(255,255,255,.7)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>\n                            </g>\n                            <defs>\n                            <clipPath id="clip0_429_11083">\n                            <rect width="24" height="24" fill="white"/>\n                            </clipPath>\n                            </defs>\n                            </svg>',title:"Hide Navbar",className:"hideNavbarButton",onClick:function(){_.navbar.hide();var e=document.createElement("a");e.className="showNavbarButton",e.innerHTML='<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 26 26" style="enable-background:new 0 0 26 26;" xml:space="preserve" class="icon icon-back-to-top">\n                                        <g>\n                                        <path d="M13.8,1.3L21.6,9c0.1,0.1,0.1,0.3,0.2,0.4c0.1,0.1,0.1,0.3,0.1,0.4s0,0.3-0.1,0.4c-0.1,0.1-0.1,0.3-0.3,0.4\n                                            c-0.1,0.1-0.2,0.2-0.4,0.3c-0.2,0.1-0.3,0.1-0.4,0.1c-0.1,0-0.3,0-0.4-0.1c-0.2-0.1-0.3-0.2-0.4-0.3L14.2,5l0,19.1\n                                            c0,0.2-0.1,0.3-0.1,0.5c0,0.1-0.1,0.3-0.3,0.4c-0.1,0.1-0.2,0.2-0.4,0.3c-0.1,0.1-0.3,0.1-0.5,0.1c-0.1,0-0.3,0-0.4-0.1\n                                            c-0.1-0.1-0.3-0.1-0.4-0.3c-0.1-0.1-0.2-0.2-0.3-0.4c-0.1-0.1-0.1-0.3-0.1-0.5l0-19.1l-5.7,5.7C6,10.8,5.8,10.9,5.7,11\n                                            c-0.1,0.1-0.3,0.1-0.4,0.1c-0.2,0-0.3,0-0.4-0.1c-0.1-0.1-0.3-0.2-0.4-0.3c-0.1-0.1-0.1-0.2-0.2-0.4C4.1,10.2,4,10.1,4.1,9.9\n                                            c0-0.1,0-0.3,0.1-0.4c0-0.1,0.1-0.3,0.3-0.4l7.7-7.8c0.1,0,0.2-0.1,0.2-0.1c0,0,0.1-0.1,0.2-0.1c0.1,0,0.2,0,0.2-0.1\n                                            c0.1,0,0.1,0,0.2,0c0,0,0.1,0,0.2,0c0.1,0,0.2,0,0.2,0.1c0.1,0,0.1,0.1,0.2,0.1C13.7,1.2,13.8,1.2,13.8,1.3z"></path>\n                                        </g>\n                                        </svg>',e.title="Show Navbar",e.onclick=function(t){t.preventDefault(),_.navbar.show(),e.remove()},document.body.appendChild(e)}};!1===b||b.find(function(e){return"object"===KQ(e)&&"hideNavbarButton"===(null===e||void 0===e?void 0:e.id)})||b.push(w)}!1!==b?(_.setOption("navbar",b),m(b)):_.navbar.hide(),Vee.on("animate",function(e){_.animate(e)}).on("stop-animation",function(){_.stopAnimation()}).on("destroy",function(){_.destroy()}).on("rotate",function(e){_.rotate(e)}).on("setOption",function(e){var t=e.option,n=e.value;_.setOption(t,n)}).on("setOptions",function(e){_.setOptions(e)}).on("zoom",function(e){_.zoom(e)}).on("zoomIn",function(e){_.zoomIn(e)}).on("zoomOut",function(e){_.zoomOut(e)}).on("resize",function(e){_.resize(e)}).on("enterFullscreen",function(){_.enterFullscreen()}).on("exitFullscreen",function(){_.exitFullscreen()}).on("toggleFullscreen",function(){_.toggleFullscreen()}).on("needsContinuousUpdate",function(e){_.needsContinuousUpdate(e)}).on("observeObjects",function(e){_.observeObjects(e)}).on("unobserveObjects",function(e){_.unobserveObjects(e)}).on("setCursor",function(e){_.setCursor(e)}).on("setPanorama",function(e){_.setPanorama(e.path,e.options)}).on("showError",function(e){_.showError(e)}).on("hideError",function(){_.hideError()}).on("startKeyboardControl",function(){_.startKeyboardControl()}).on("stopKeyboardControl",function(){_.stopKeyboardControl()}),l.current=_}},[s,o]),(0,t.useEffect)(function(){var e,t,n,i,r=l.current;r&&r.container&&r.container.parentNode&&(r&&r.container&&r.container.parentNode&&(null===(e=r.renderer)||void 0===e||null===(t=e.renderer)||void 0===t||t.dispose(),null===(n=r.renderer)||void 0===n||null===(i=n.renderer)||void 0===i||i.forceContextLoss(),r.destroy()))},[l]),(0,t.useEffect)(function(){var e,t=null!==(e=o.panorama)&&void 0!==e?e:o.src;l.current&&t&&l.current.setPanorama(t,{})},[o.src,o.panorama]);return(0,t.useImperativeHandle)(n,function(){return{animate:function(e){Vee.emit("animate",e)},destroy:function(){Vee.emit("destroy",{})},createTooltip:function(e){var t;return null===(t=l.current)||void 0===t?void 0:t.createTooltip(e)},needsContinuousUpdate:function(e){Vee.emit("needsContinuousUpdate",e)},observeObjects:function(e){Vee.emit("observeObjects",e)},unobserveObjects:function(e){Vee.emit("unobserveObjects",e)},setCursor:function(e){Vee.emit("setCursor",e)},stopAnimation:function(){Vee.emit("stop-animation",{})},rotate:function(e){Vee.emit("rotate",e)},setOption:function(e,t){Vee.emit("setOption",{option:e,value:t})},setOptions:function(e){var t;return null===(t=l.current)||void 0===t?void 0:t.setOptions(e)},getCurrentNavbar:function(){return p},zoom:function(e){Vee.emit("zoom",e)},zoomIn:function(e){Vee.emit("zoomIn",{step:e})},zoomOut:function(e){Vee.emit("zoomOut",{step:e})},resize:function(e){var t;return null===(t=l.current)||void 0===t?void 0:t.resize(e)},enterFullscreen:function(){var e;return null===(e=l.current)||void 0===e?void 0:e.enterFullscreen()},exitFullscreen:function(){var e;return null===(e=l.current)||void 0===e?void 0:e.exitFullscreen()},toggleFullscreen:function(){var e;return null===(e=l.current)||void 0===e?void 0:e.toggleFullscreen()},isFullscreenEnabled:function(){var e;return null===(e=l.current)||void 0===e?void 0:e.isFullscreenEnabled()},getPlugin:function(e){var t;return null===(t=l.current)||void 0===t?void 0:t.getPlugin(e)},getPosition:function(){var e;return null===(e=l.current)||void 0===e?void 0:e.getPosition()},getZoomLevel:function(){var e;return null===(e=l.current)||void 0===e?void 0:e.getZoomLevel()},getSize:function(){var e;return null===(e=l.current)||void 0===e?void 0:e.getSize()},needsUpdate:function(){var e;return null===(e=l.current)||void 0===e?void 0:e.needsUpdate()},autoSize:function(){var e;return null===(e=l.current)||void 0===e?void 0:e.autoSize()},setPanorama:function(e,t){var n;return null===(n=l.current)||void 0===n?void 0:n.setPanorama(e,t)},showError:function(e){var t;return null===(t=l.current)||void 0===t?void 0:t.showError(e)},hideError:function(){var e;return null===(e=l.current)||void 0===e?void 0:e.hideError()},startKeyboardControl:function(){var e;return null===(e=l.current)||void 0===e?void 0:e.startKeyboardControl()},stopKeyboardControl:function(){var e;return null===(e=l.current)||void 0===e?void 0:e.stopKeyboardControl()}}},[l.current,s,o,n]),t.createElement("div",{className:o.containerClass||"view-container",ref:a})});Xee.displayName="ReactPhotoSphereViewer";var Kee=Object.defineProperty;((e,t)=>{for(var n in t)Kee(e,n,{get:t[n],enumerable:!0})})({},{EnterMarkerEvent:()=>ite,GotoMarkerDoneEvent:()=>$ee,HideMarkersEvent:()=>dte,LeaveMarkerEvent:()=>tte,MarkerVisibilityEvent:()=>Qee,MarkersPluginEvent:()=>qee,RenderMarkersListEvent:()=>vte,SelectMarkerEvent:()=>ste,SelectMarkerListEvent:()=>ote,SetMarkersEvent:()=>fte,ShowMarkersEvent:()=>mte,UnselectMarkerEvent:()=>cte});var qee=class extends x9{},Jee=class e extends qee{constructor(t,n){super(e.type),this.marker=t,this.visible=n}};Jee.type="marker-visibility";var Qee=Jee,Zee=class e extends qee{constructor(t){super(e.type),this.marker=t}};Zee.type="goto-marker-done";var $ee=Zee,ete=class e extends qee{constructor(t){super(e.type),this.marker=t}};ete.type="leave-marker";var tte=ete,nte=class e extends qee{constructor(t){super(e.type),this.marker=t}};nte.type="enter-marker";var ite=nte,rte=class e extends qee{constructor(t,n,i){super(e.type),this.marker=t,this.doubleClick=n,this.rightClick=i}};rte.type="select-marker";var ste=rte,ate=class e extends qee{constructor(t){super(e.type),this.marker=t}};ate.type="select-marker-list";var ote=ate,lte=class e extends qee{constructor(t){super(e.type),this.marker=t}};lte.type="unselect-marker";var cte=lte,ute=class e extends qee{constructor(){super(e.type)}};ute.type="hide-markers";var dte=ute,hte=class e extends qee{constructor(t){super(e.type),this.markers=t}};hte.type="set-markers";var fte=hte,pte=class e extends qee{constructor(){super(e.type)}};pte.type="show-markers";var mte=pte,gte=class e extends qee{constructor(t){super(e.type),this.markers=t}};gte.type="render-markers-list";var vte=gte,yte=class extends V7{constructor(e){super(e,{className:"psv-markers-button",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 9 81 81"><path fill="currentColor" d="M50.5 90S22.9 51.9 22.9 36.6 35.2 9 50.5 9s27.6 12.4 27.6 27.6S50.5 90 50.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11z"/>\x3c!--Created by Rohith M S from the Noun Project--\x3e</svg>\n',hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.plugin.addEventListener(mte.type,this),this.plugin.addEventListener(dte.type,this),this.toggleActive(!0))}destroy(){this.plugin&&(this.plugin.removeEventListener(mte.type,this),this.plugin.removeEventListener(dte.type,this)),super.destroy()}isSupported(){return!!this.plugin}handleEvent(e){e instanceof mte?this.toggleActive(!0):e instanceof dte&&this.toggleActive(!1)}onClick(){this.plugin.toggleAllMarkers()}};yte.id="markers";var _te='<svg xmlns="http://www.w3.org/2000/svg" viewBox="9 9 81 81"><path fill="currentColor" d="M37.5 90S9.9 51.9 9.9 36.6 22.2 9 37.5 9s27.6 12.4 27.6 27.6S37.5 90 37.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11zM86.7 55H70c-1.8 0-3.3-1.5-3.3-3.3s1.5-3.3 3.3-3.3h16.7c1.8 0 3.3 1.5 3.3 3.3S88.5 55 86.7 55zm0-25h-15a3.3 3.3 0 0 1-3.3-3.3c0-1.8 1.5-3.3 3.3-3.3h15c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3zM56.5 73h30c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3h-30a3.3 3.3 0 0 1-3.3-3.3 3.2 3.2 0 0 1 3.3-3.3z"/>\x3c!--Created by Rohith M S from the Noun Project--\x3e</svg>\n',bte="http://www.w3.org/2000/svg",xte="psvMarker",Ste=l8.dasherize(xte),Ete="marker",wte="markersList",Tte={amount:2,duration:100,easing:"linear"},Mte=(e,t)=>'\n<div class="psv-panel-menu psv-panel-menu--stripped">\n    <h1 class="psv-panel-menu-title">'.concat(_te," ").concat(t,'</h1>\n    <ul class="psv-panel-menu-list">\n    ').concat(e.map(e=>"\n        <li data-".concat(Ste,'="').concat(e.id,'" class="psv-panel-menu-item" tabindex="0">\n          ').concat("image"===e.type?'<span class="psv-panel-menu-item-icon"><img src="'.concat(e.definition,'"/></span>'):"",'\n          <span class="psv-panel-menu-item-label">').concat(e.getListContent(),"</span>\n        </li>\n    ")).join(""),"\n    </ul>\n</div>\n"),Ate=class extends V7{constructor(e){super(e,{className:" psv-markers-list-button",icon:_te,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.viewer.addEventListener(b9.ShowPanelEvent.type,this),this.viewer.addEventListener(b9.HidePanelEvent.type,this))}destroy(){this.viewer.removeEventListener(b9.ShowPanelEvent.type,this),this.viewer.removeEventListener(b9.HidePanelEvent.type,this),super.destroy()}isSupported(){return!!this.plugin}handleEvent(e){e instanceof b9.ShowPanelEvent?this.toggleActive(e.panelId===wte):e instanceof b9.HidePanelEvent&&this.toggleActive(!1)}onClick(){this.plugin.toggleMarkersList()}};Ate.id="markersList";var Cte=new DO,Rte=new IO,Lte=new DO,Pte=class extends sF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.createElement("div");super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof e.element.ownerDocument.defaultView.Element&&null!==e.element.parentNode&&e.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}},Ite=new IN,Dte=new IN,kte=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this;let n,i,r,s;const a={camera:{style:""},objects:new WeakMap},o=void 0!==e.element?e.element:document.createElement("div");o.style.overflow="hidden",this.domElement=o;const l=document.createElement("div");l.style.transformOrigin="0 0",l.style.pointerEvents="none",o.appendChild(l);const c=document.createElement("div");function u(e){return Math.abs(e)<1e-10?0:e}function d(e){const t=e.elements;return"matrix3d("+u(t[0])+","+u(-t[1])+","+u(t[2])+","+u(t[3])+","+u(t[4])+","+u(-t[5])+","+u(t[6])+","+u(t[7])+","+u(t[8])+","+u(-t[9])+","+u(t[10])+","+u(t[11])+","+u(t[12])+","+u(-t[13])+","+u(t[14])+","+u(t[15])+")"}function h(e){const t=e.elements;return"translate(-50%,-50%)"+("matrix3d("+u(t[0])+","+u(t[1])+","+u(t[2])+","+u(t[3])+","+u(-t[4])+","+u(-t[5])+","+u(-t[6])+","+u(-t[7])+","+u(t[8])+","+u(t[9])+","+u(t[10])+","+u(t[11])+","+u(t[12])+","+u(t[13])+","+u(t[14])+","+u(t[15])+")")}function f(e){e.isCSS3DObject&&(e.element.style.display="none");for(let t=0,n=e.children.length;t<n;t++)f(e.children[t])}function p(e,n,i,r){if(!1!==e.visible){if(e.isCSS3DObject){const r=!0===e.layers.test(i.layers),s=e.element;if(s.style.display=!0===r?"":"none",!0===r){let r;e.onBeforeRender(t,n,i),e.isCSS3DSprite?(Ite.copy(i.matrixWorldInverse),Ite.transpose(),0!==e.rotation2D&&Ite.multiply(Dte.makeRotationZ(e.rotation2D)),e.matrixWorld.decompose(Cte,Rte,Lte),Ite.setPosition(Cte),Ite.scale(Lte),Ite.elements[3]=0,Ite.elements[7]=0,Ite.elements[11]=0,Ite.elements[15]=1,r=h(Ite)):r=h(e.matrixWorld);const o=a.objects.get(e);if(void 0===o||o.style!==r){s.style.transform=r;const t={style:r};a.objects.set(e,t)}s.parentNode!==c&&c.appendChild(s),e.onAfterRender(t,n,i)}}for(let t=0,s=e.children.length;t<s;t++)p(e.children[t],n,i,r)}else f(e)}c.style.transformStyle="preserve-3d",l.appendChild(c),this.getSize=function(){return{width:n,height:i}},this.render=function(e,t){const o=t.projectionMatrix.elements[5]*s;let h,f;t.view&&t.view.enabled?(l.style.transform="translate( ".concat(-t.view.offsetX*(n/t.view.width),"px, ").concat(-t.view.offsetY*(i/t.view.height),"px )"),l.style.transform+="scale( ".concat(t.view.fullWidth/t.view.width,", ").concat(t.view.fullHeight/t.view.height," )")):l.style.transform="",!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),t.isOrthographicCamera&&(h=-(t.right+t.left)/2,f=(t.top+t.bottom)/2);const m=t.view&&t.view.enabled?t.view.height/t.view.fullHeight:1,g=t.isOrthographicCamera?"scale( ".concat(m," )scale(")+o+")translate("+u(h)+"px,"+u(f)+"px)"+d(t.matrixWorldInverse):"scale( ".concat(m," )translateZ(")+o+"px)"+d(t.matrixWorldInverse),v=(t.isPerspectiveCamera?"perspective("+o+"px) ":"")+g+"translate("+r+"px,"+s+"px)";a.camera.style!==v&&(c.style.transform=v,a.camera.style=v),p(e,e,t,g)},this.setSize=function(e,t){n=e,i=t,r=n/2,s=i/2,o.style.width=e+"px",o.style.height=t+"px",l.style.width=e+"px",l.style.height=t+"px",c.style.width=e+"px",c.style.height=t+"px"}}},Ote=class{constructor(e){this.viewer=e,this.element=document.createElement("div"),this.element.className="psv-markers-css3d-container",this.renderer=new kte({element:this.element}),this.scene=new kB,this.intersectionObserver=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target[xte];t.config.visible&&(t.viewportIntersection=e.isIntersecting)})},{root:this.element}),e.addEventListener(b9.ReadyEvent.type,this,{once:!0}),e.addEventListener(b9.SizeUpdatedEvent.type,this),e.addEventListener(b9.RenderEvent.type,this)}handleEvent(e){switch(e.type){case b9.ReadyEvent.type:case b9.SizeUpdatedEvent.type:this.updateSize();break;case b9.RenderEvent.type:this.render()}}destroy(){this.viewer.removeEventListener(b9.ReadyEvent.type,this),this.viewer.removeEventListener(b9.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(b9.RenderEvent.type,this),this.intersectionObserver.disconnect()}updateSize(){const e=this.viewer.getSize();this.renderer.setSize(e.width,e.height)}render(){this.renderer.render(this.scene,this.viewer.renderer.camera)}addObject(e){this.scene.add(e.threeElement),this.intersectionObserver.observe(e.domElement)}removeObject(e){this.scene.remove(e.threeElement),this.intersectionObserver.unobserve(e.domElement)}},Nte=(e=>(e.image="image",e.html="html",e.element="element",e.imageLayer="imageLayer",e.videoLayer="videoLayer",e.elementLayer="elementLayer",e.polygon="polygon",e.polygonPixels="polygonPixels",e.polyline="polyline",e.polylinePixels="polylinePixels",e.square="square",e.rect="rect",e.circle="circle",e.ellipse="ellipse",e.path="path",e))(Nte||{});function Fte(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[];if(Object.keys(Nte).forEach(t=>{e[t]&&n.push(t)}),0===n.length&&!t)throw new z8("missing marker content, either ".concat(Object.keys(Nte).join(", ")));if(n.length>1)throw new z8("multiple marker content, either ".concat(Object.keys(Nte).join(", ")));return n[0]}var Bte=class{constructor(e,t,n){if(this.viewer=e,this.plugin=t,this.state={anchor:null,visible:!1,staticTooltip:!1,position:null,position2D:null,positions3D:null,size:null},!n.id)throw new z8("missing marker id");this.type=Fte(n),this.createElement(),this.update(n)}get id(){return this.config.id}get data(){return this.config.data}get domElement(){return null}get threeElement(){return null}get video(){return null}destroy(){delete this.viewer,delete this.plugin,delete this.element,this.hideTooltip()}is3d(){return!1}isNormal(){return!1}isPoly(){return!1}isSvg(){return!1}isCss3d(){return!1}update(e){const t=Fte(e,!0);if(void 0!==t&&t!==this.type)throw new z8("cannot change marker ".concat(e.id," type"));if(this.config=l8.deepmerge(this.config,e),"string"===typeof this.config.tooltip&&(this.config.tooltip={content:this.config.tooltip}),this.config.tooltip&&!this.config.tooltip.trigger&&(this.config.tooltip.trigger="hover"),l8.isNil(this.config.visible)&&(this.config.visible=!0),l8.isNil(this.config.zIndex)&&(this.config.zIndex=1),l8.isNil(this.config.opacity)&&(this.config.opacity=1),this.config.rotation){const e=this.config.rotation;this.config.rotation="object"===typeof e?{yaw:e.yaw?l8.parseAngle(e.yaw,!0,!1):0,pitch:e.pitch?l8.parseAngle(e.pitch,!0,!1):0,roll:e.roll?l8.parseAngle(e.roll,!0,!1):0}:{yaw:0,pitch:0,roll:l8.parseAngle(e,!0,!1)}}else this.config.rotation={yaw:0,pitch:0,roll:0};this.state.anchor=l8.parsePoint(this.config.anchor)}getListContent(){var e;return this.config.listContent?this.config.listContent:null!==(e=this.config.tooltip)&&void 0!==e&&e.content?this.config.tooltip.content:this.config.html?this.config.html:this.id}showTooltip(e,t){var n;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.state.visible&&null!==(n=this.config.tooltip)&&void 0!==n&&n.content&&this.state.position2D){const n=Cr(Cr({},this.config.tooltip),{},{style:{pointerEvents:this.state.staticTooltip?"auto":"none"},data:this,top:0,left:0});if(this.isPoly()||this.is3d()||this.isCss3d())if(e||t){const i=l8.getPosition(this.viewer.container);n.top=t-i.y+10,n.left=e-i.x,n.box={width:20,height:20}}else n.top=this.state.position2D.y,n.left=this.state.position2D.x;else{const e=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);let t=this.state.size.width,i=this.state.size.height;this.config.hoverScale&&!this.state.staticTooltip&&(t*=this.config.hoverScale.amount,i*=this.config.hoverScale.amount),n.top=e.y-i*this.state.anchor.y+i/2,n.left=e.x-t*this.state.anchor.x+t/2,n.box={width:t,height:i}}this.tooltip?i?this.tooltip.update(this.config.tooltip.content,n):this.tooltip.move(n):this.tooltip=this.viewer.createTooltip(n)}}hideTooltip(){this.tooltip&&(this.tooltip.hide(),this.tooltip=null)}},Ute=class extends Bte{get domElement(){return this.element}constructor(e,t,n){super(e,t,n)}afterCreateElement(){this.element[xte]=this}destroy(){delete this.element[xte],super.destroy()}update(e){super.update(e);const t=this.domElement;t.id="psv-marker-".concat(this.config.id),t.setAttribute("class","psv-marker"),this.state.visible&&t.classList.add("psv-marker--visible"),this.config.tooltip&&t.classList.add("psv-marker--has-tooltip"),this.config.content&&t.classList.add("psv-marker--has-content"),this.config.className&&l8.addClasses(t,this.config.className),t.style.opacity="".concat(this.config.opacity),t.style.zIndex="".concat(30+this.config.zIndex),this.config.style&&Object.assign(t.style,this.config.style)}},Hte=class extends Ute{constructor(e,t,n){super(e,t,n)}afterCreateElement(){super.afterCreateElement(),this.domElement.addEventListener("transitionend",()=>{this.domElement.style.transition=""})}render(e){let{viewerPosition:t,zoomLevel:n,hoveringMarker:i}=e;this.__updateSize();const r=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);r.x-=this.state.size.width*this.state.anchor.x,r.y-=this.state.size.height*this.state.anchor.y;return this.state.positions3D[0].dot(this.viewer.state.direction)>0&&r.x+this.state.size.width>=0&&r.x-this.state.size.width<=this.viewer.state.size.width&&r.y+this.state.size.height>=0&&r.y-this.state.size.height<=this.viewer.state.size.height?(this.domElement.style.translate="".concat(r.x,"px ").concat(r.y,"px 0px"),this.applyScale({zoomLevel:n,viewerPosition:t,mouseover:this===i}),r):null}update(e){if(super.update(e),!l8.isExtendedPosition(this.config.position))throw new z8("missing marker ".concat(this.id," position"));try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(kne){throw new z8("invalid marker ".concat(this.id," position"),kne)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const t=this.domElement;t.classList.add("psv-marker--normal"),this.config.scale&&Array.isArray(this.config.scale)&&(this.config.scale={zoom:this.config.scale}),"boolean"===typeof this.config.hoverScale?this.config.hoverScale=this.config.hoverScale?this.plugin.config.defaultHoverScale||Tte:null:"number"===typeof this.config.hoverScale?this.config.hoverScale={amount:this.config.hoverScale}:this.config.hoverScale||(this.config.hoverScale=this.plugin.config.defaultHoverScale),this.config.hoverScale&&(this.config.hoverScale=Cr(Cr({},this.plugin.config.defaultHoverScale),this.config.hoverScale)),t.style.rotate=0!==this.config.rotation.roll?LO.radToDeg(this.config.rotation.roll)+"deg":null,t.style.transformOrigin="".concat(100*this.state.anchor.x,"% ").concat(100*this.state.anchor.y,"%")}__updateSize(){if(!this.needsUpdateSize)return;const e=this.domElement,t=!this.state.visible||!this.state.size;if(t&&e.classList.add("psv-marker--transparent"),this.isSvg()){const t=e.firstElementChild.getBoundingClientRect();this.state.size={width:t.width,height:t.height}}else this.state.size={width:e.offsetWidth,height:e.offsetHeight};t&&e.classList.remove("psv-marker--transparent"),this.isSvg()&&(e.style.width=this.state.size.width+"px",e.style.height=this.state.size.height+"px"),"element"!==this.type&&(this.needsUpdateSize=!1)}applyScale(e){let{zoomLevel:t,viewerPosition:n,mouseover:i}=e;null!==i&&this.config.hoverScale&&(this.domElement.style.transition="scale ".concat(this.config.hoverScale.duration,"ms ").concat(this.config.hoverScale.easing));let r=1;if("function"===typeof this.config.scale)r=this.config.scale(t,n);else if(this.config.scale){if(Array.isArray(this.config.scale.zoom)){const[e,n]=this.config.scale.zoom;r*=e+(n-e)*Y6.EASINGS.inQuad(t/100)}if(Array.isArray(this.config.scale.yaw)){const[e,t]=this.config.scale.yaw,i=LO.degToRad(this.viewer.state.hFov)/2,s=Math.abs(l8.getShortestArc(this.state.position.yaw,n.yaw));r*=t+(e-t)*Y6.EASINGS.outQuad(Math.max(0,(i-s)/i))}}i&&this.config.hoverScale&&(r*=this.config.hoverScale.amount),this.domElement.style.scale="".concat(r)}},zte=class extends _B{get map(){return this.uniforms.map.value}set map(e){this.uniforms.map.value=e}set alpha(e){this.uniforms.alpha.value=e}get offset(){return this.uniforms.offset.value}get repeat(){return this.uniforms.repeat.value}set chromaKey(e){if(this.uniforms.keying.value=!0===(null===e||void 0===e?void 0:e.enabled),null!==e&&void 0!==e&&e.enabled){var t,n,i;if("object"===typeof e.color&&"r"in e.color)this.uniforms.color.value.set(e.color.r/255,e.color.g/255,e.color.b/255);else this.uniforms.color.value.set(null!==(i=e.color)&&void 0!==i?i:65280);this.uniforms.similarity.value=null!==(t=e.similarity)&&void 0!==t?t:.2,this.uniforms.smoothness.value=null!==(n=e.smoothness)&&void 0!==n?n:.2}}constructor(e){var t;super({transparent:!0,depthTest:!1,depthWrite:!1,uniforms:{map:{value:null===e||void 0===e?void 0:e.map},repeat:{value:new PO(1,1)},offset:{value:new PO(0,0)},alpha:{value:null!==(t=null===e||void 0===e?void 0:e.alpha)&&void 0!==t?t:1},keying:{value:!1},color:{value:new wF(65280)},similarity:{value:.2},smoothness:{value:.2},spill:{value:.1}},vertexShader:"varying vec2 vUv;\nuniform vec2 repeat;\nuniform vec2 offset;\n\nvoid main() {\n    vUv = uv * repeat + offset;\n    gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );\n}\n",fragmentShader:"// https://www.8thwall.com/playground/chromakey-threejs\n\nuniform sampler2D map;\nuniform float alpha;\nuniform bool keying;\nuniform vec3 color;\nuniform float similarity;\nuniform float smoothness;\nuniform float spill;\n\nvarying vec2 vUv;\n\nvec2 RGBtoUV(vec3 rgb) {\n    return vec2(\n        rgb.r * -0.169 + rgb.g * -0.331 + rgb.b *  0.5    + 0.5,\n        rgb.r *  0.5   + rgb.g * -0.419 + rgb.b * -0.081  + 0.5\n    );\n}\n\nvoid main(void) {\n    gl_FragColor = texture2D(map, vUv);\n\n    if (keying) {\n        float chromaDist = distance(RGBtoUV(gl_FragColor.rgb), RGBtoUV(color));\n\n        float baseMask = chromaDist - similarity;\n        float fullMask = pow(clamp(baseMask / smoothness, 0., 1.), 1.5);\n        gl_FragColor.a *= fullMask * alpha;\n\n        float spillVal = pow(clamp(baseMask / spill, 0., 1.), 1.5);\n        float desat = clamp(gl_FragColor.r * 0.2126 + gl_FragColor.g * 0.7152 + gl_FragColor.b * 0.0722, 0., 1.);\n        gl_FragColor.rgb = mix(vec3(desat, desat, desat), gl_FragColor.rgb, spillVal);\n    } else {\n        gl_FragColor.a *= alpha;\n    }\n}\n"}),this.chromaKey=null===e||void 0===e?void 0:e.chromaKey}};function Gte(e,t,n){const[i,r]=e,[s,a]=t,o=l8.greatArcDistance(e,t),l=Math.sin((1-n)*o)/Math.sin(o),c=Math.sin(n*o)/Math.sin(o),u=l*Math.cos(r)*Math.cos(i)+c*Math.cos(a)*Math.cos(s),d=l*Math.cos(r)*Math.sin(i)+c*Math.cos(a)*Math.sin(s),h=l*Math.sin(r)+c*Math.sin(a);return[Math.atan2(d,u),Math.atan2(h,Math.sqrt(u*u+d*d))]}function Vte(e){return e.reduce((e,t)=>e.add(t),new DO).normalize()}function Wte(e){const t=function(e){const t=[e[0]];let n=0;for(let i=1;i<e.length;i++){const r=e[i-1][0]-e[i][0];r>Math.PI?n+=1:r<-Math.PI&&(n-=1),t.push([e[i][0]+2*n*Math.PI,e[i][1]])}return t}(e);let n=0;const i=[];for(let s=0;s<t.length-1;s++){const e=l8.greatArcDistance(t[s],t[s+1])*Y6.SPHERE_RADIUS;i.push(e),n+=e}let r=0;for(let s=0;s<t.length-1;s++){if(r+i[s]>n/2){const e=(n/2-r)/i[s];return Gte(t[s],t[s+1],e)}r+=i[s]}return t[Math.round(t.length/2)]}var jte=new DO,Yte=new DO,Xte=new DO,Kte=new DO,qte=new DO,Jte=new DO;function Qte(e,t,n){jte.copy(n).normalize(),Yte.crossVectors(e,t).normalize(),Xte.crossVectors(Yte,e).normalize(),Kte.copy(e).multiplyScalar(-jte.dot(Xte)),qte.copy(Xte).multiplyScalar(jte.dot(e));const i=(new DO).addVectors(Kte,qte).normalize();return Jte.crossVectors(i,jte),i.applyAxisAngle(Jte,.01).multiplyScalar(Y6.SPHERE_RADIUS)}var Zte=class extends Bte{get threeElement(){return this.element}get threeMesh(){return this.threeElement.children[0]}get video(){return"videoLayer"===this.type?this.threeMesh.material.map.image:null}constructor(e,t,n){super(e,t,n)}is3d(){return!0}createElement(){const e=new zte({alpha:0}),t=new Kz(1,1),n=new hB(t,e);n.userData={[xte]:this},Object.defineProperty(n,"visible",{enumerable:!0,get:function(){return this.userData[xte].config.visible},set:function(e){this.userData[xte].config.visible=e}}),this.element=(new RB).add(n),"videoLayer"===this.type&&this.viewer.needsContinuousUpdate(!0)}destroy(){delete this.threeMesh.userData[xte],"videoLayer"===this.type&&(this.video.pause(),this.viewer.needsContinuousUpdate(!1)),super.destroy()}render(){return this.viewer.renderer.isObjectVisible(this.threeMesh)?this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position):null}update(e){super.update(e);const t=this.threeMesh,n=t.parent,i=t.material;if(l8.isExtendedPosition(this.config.position)){try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(kne){throw new z8("invalid marker ".concat(this.id," position"),kne)}if(!this.config.size)throw new z8("missing marker ".concat(this.id," size"));this.state.size=this.config.size,t.scale.set(this.config.size.width/100,this.config.size.height/100,1),t.position.set(t.scale.x*(.5-this.state.anchor.x),t.scale.y*(this.state.anchor.y-.5),0),t.rotation.set(0,0,0),this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position,n.position),n.lookAt(0,n.position.y,0),t.rotateY(-this.config.rotation.yaw),t.rotateX(-this.config.rotation.pitch),t.rotateZ(-this.config.rotation.roll);const e=t.geometry.getAttribute("position");this.state.positions3D=[0,1,3,2].map(n=>{const i=new DO;return i.fromBufferAttribute(e,n),t.localToWorld(i)})}else{var r;if(4!==(null===(r=this.config.position)||void 0===r?void 0:r.length))throw new z8("missing marker ".concat(this.id," position"));let e;try{e=this.config.position.map(e=>this.viewer.dataHelper.cleanPosition(e))}catch(kne){throw new z8("invalid marker ".concat(this.id," position"),kne)}const n=e.map(e=>this.viewer.dataHelper.sphericalCoordsToVector3(e)),s=Vte(n);this.state.position=this.viewer.dataHelper.vector3ToSphericalCoords(s),this.state.positions3D=n;const a=t.geometry.getAttribute("position");[n[0],n[1],n[3],n[2]].forEach((e,t)=>{a.setX(t,e.x),a.setY(t,e.y),a.setZ(t,e.z)}),a.needsUpdate=!0,this.__setTextureWrap(i)}switch(this.type){case"videoLayer":if(this.definition!==this.config.videoLayer){var s,a;null===(s=i.map)||void 0===s||s.dispose();const e=function(e){let{src:t,withCredentials:n,muted:i,autoplay:r}=e;const s=document.createElement("video");return s.crossOrigin=n?"use-credentials":"anonymous",s.loop=!0,s.playsInline=!0,s.autoplay=r,s.muted=i,s.preload="metadata",t instanceof MediaStream?s.srcObject=t:s.src=t,s}({src:this.config.videoLayer,withCredentials:this.viewer.config.withCredentials(this.config.videoLayer),muted:!0,autoplay:null===(a=this.config.autoplay)||void 0===a||a}),n=new wH(e);i.map=n,i.alpha=0,e.addEventListener("loadedmetadata",()=>{this.viewer&&(i.alpha=this.config.opacity,l8.isExtendedPosition(this.config.position)||(t.material.userData[xte]={width:e.videoWidth,height:e.videoHeight},this.__setTextureWrap(i)))},{once:!0}),e.autoplay&&e.play(),this.definition=this.config.videoLayer}else i.alpha=this.config.opacity;break;case"imageLayer":if(this.definition!==this.config.imageLayer){var o;null===(o=i.map)||void 0===o||o.dispose();const e=new QO;i.map=e,i.alpha=0,this.viewer.textureLoader.loadImage(this.config.imageLayer).then(n=>{this.viewer&&(l8.isExtendedPosition(this.config.position)||(t.material.userData[xte]={width:n.width,height:n.height},this.__setTextureWrap(i)),e.image=n,e.anisotropy=4,e.needsUpdate=!0,i.alpha=this.config.opacity,this.viewer.needsUpdate())}),this.definition=this.config.imageLayer}else i.alpha=this.config.opacity}i.chromaKey=this.config.chromaKey,t.renderOrder=1e3+this.config.zIndex,t.geometry.boundingBox=null}__setTextureWrap(e){const t=e.userData[xte];if(!t||!t.height||!t.width)return e.repeat.set(1,1),void e.offset.set(0,0);const n=this.config.position.map(e=>this.viewer.dataHelper.cleanPosition(e)),i=(l8.greatArcDistance([n[0].yaw,n[0].pitch],[n[1].yaw,n[1].pitch])+l8.greatArcDistance([n[3].yaw,n[3].pitch],[n[2].yaw,n[2].pitch]))/(l8.greatArcDistance([n[1].yaw,n[1].pitch],[n[2].yaw,n[2].pitch])+l8.greatArcDistance([n[0].yaw,n[0].pitch],[n[3].yaw,n[3].pitch])),r=t.width/t.height;let s=0,a=0;i<r?s=r-i:a=1/r-1/i,e.repeat.set(1-s,1-a),e.offset.set(s/2,a/2)}},$te=class extends Ute{constructor(e,t,n){super(e,t,n),this.viewportIntersection=!1}get threeElement(){return this.object}isCss3d(){return!0}createElement(){this.element=document.createElement("div"),this.object=new Pte(this.element),this.object.userData={[xte]:this},Object.defineProperty(this.object,"visible",{enumerable:!0,get:function(){return this.userData[xte].config.visible},set:function(e){this.userData[xte].config.visible=e}}),this.afterCreateElement()}destroy(){delete this.object.userData[xte],delete this.object,super.destroy()}render(e){let{viewerPosition:t,zoomLevel:n}=e;const i=this.domElement;this.state.size={width:i.offsetWidth,height:i.offsetHeight};if(this.state.positions3D[0].dot(this.viewer.state.direction)>0&&this.viewportIntersection){var r,s;const e=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position);return null===(r=(s=this.config.elementLayer).updateMarker)||void 0===r||r.call(s,{marker:this,position:e,viewerPosition:t,zoomLevel:n,viewerSize:this.viewer.state.size}),e}return null}update(e){if(super.update(e),!l8.isExtendedPosition(this.config.position))throw new z8("missing marker ".concat(this.id," position"));try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(kne){throw new z8("invalid marker ".concat(this.id," position"),kne)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const t=this.threeElement,n=this.domElement;n.classList.add("psv-marker--css3d"),n.childNodes.forEach(e=>e.remove()),n.appendChild(this.config.elementLayer),this.config.elementLayer.style.display="block",t.position.copy(this.state.positions3D[0]).multiplyScalar(100),t.lookAt(0,100*this.state.positions3D[0].y,0),t.rotateY(-this.config.rotation.yaw),t.rotateX(-this.config.rotation.pitch),t.rotateZ(-this.config.rotation.roll)}},ene=class extends Hte{constructor(e,t,n){super(e,t,n)}isNormal(){return!0}createElement(){this.element=document.createElement("div"),this.afterCreateElement()}render(e){const t=super.render(e);var n,i;t&&"element"===this.type&&(null===(n=(i=this.config.element).updateMarker)||void 0===n||n.call(i,{marker:this,position:t,viewerPosition:e.viewerPosition,zoomLevel:e.zoomLevel,viewerSize:this.viewer.state.size}));return t}update(e){super.update(e);const t=this.domElement;if(this.config.image&&!this.config.size)throw new z8("missing marker ".concat(this.id," size"));switch(this.config.size?(this.needsUpdateSize=!1,this.state.size=this.config.size,t.style.width=this.config.size.width+"px",t.style.height=this.config.size.height+"px"):this.needsUpdateSize=!0,this.type){case"image":this.definition=this.config.image,t.style.backgroundImage='url("'.concat(this.config.image,'")');break;case"html":this.definition=this.config.html,t.innerHTML=this.config.html;break;case"element":this.definition!==this.config.element&&(this.definition=this.config.element,t.childNodes.forEach(e=>e.remove()),t.appendChild(this.config.element),this.config.element.style.display="block")}}},tne=class extends Ute{constructor(e,t,n){super(e,t,n)}createElement(){this.element=document.createElementNS(bte,"path"),this.element[xte]=this}isPoly(){return!0}get isPixels(){return"polygonPixels"===this.type||"polylinePixels"===this.type}get isPolygon(){return"polygon"===this.type||"polygonPixels"===this.type}get isPolyline(){return"polyline"===this.type||"polylinePixels"===this.type}get coords(){return this.definition}render(){const e=this.__getAllPolyPositions();if(e[0].length>(this.isPolygon?2:1)){const t=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position),n=e.filter(e=>e.length>0).map(e=>{let n="M";return n+=e.map(e=>"".concat(e.x-t.x,",").concat(e.y-t.y)).join("L"),this.isPolygon&&(n+="Z"),n}).join(" ");return this.domElement.setAttributeNS(null,"d",n),this.domElement.setAttributeNS(null,"transform","translate(".concat(t.x," ").concat(t.y,")")),t}return null}update(e){super.update(e);const t=this.domElement;t.classList.add("psv-marker--poly"),this.config.svgStyle?(Object.entries(this.config.svgStyle).forEach(e=>{let[n,i]=e;t.setAttributeNS(null,l8.dasherize(n),i)}),this.isPolyline&&!this.config.svgStyle.fill&&t.setAttributeNS(null,"fill","none")):this.isPolygon?t.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"):this.isPolyline&&(t.setAttributeNS(null,"fill","none"),t.setAttributeNS(null,"stroke","rgb(0,0,0)"));try{let e=this.config[this.type];if(!Array.isArray(e[0])&&"object"!==typeof e[0])for(let t=0;t<e.length;t++)e.splice(t,2,[e[t],e[t+1]]);if(Array.isArray(e[0][0])||"object"===typeof e[0][0]||(e=[e]),this.isPolyline&&e.length>1)throw new z8("polylines cannot have holes");this.isPixels?this.definition=e.map(e=>e.map(e=>{let t;return t=l8.isExtendedPosition(e)?this.viewer.dataHelper.cleanPosition(e):this.viewer.dataHelper.textureCoordsToSphericalCoords({textureX:e[0],textureY:e[1]}),[t.yaw,t.pitch]})):this.definition=e.map(e=>e.map(e=>{let t;return t=l8.isExtendedPosition(e)?this.viewer.dataHelper.cleanPosition(e):this.viewer.dataHelper.cleanPosition({yaw:e[0],pitch:e[1]}),[t.yaw,t.pitch]}))}catch(kne){throw new z8("invalid marker ".concat(this.id," position"),kne)}if(this.positions3D=this.coords.map(e=>e.map(e=>this.viewer.dataHelper.sphericalCoordsToVector3({yaw:e[0],pitch:e[1]}))),this.isPolygon){const e=Vte(this.positions3D[0]);this.state.position=this.viewer.dataHelper.vector3ToSphericalCoords(e)}else{const e=Wte(this.coords[0]);this.state.position={yaw:e[0],pitch:e[1]}}this.state.positions3D=this.positions3D[0]}__getAllPolyPositions(){return this.positions3D.map(e=>this.__getPolyPositions(e))}__getPolyPositions(e){const t=e.length,n=e.map(e=>({vector:e,visible:e.dot(this.viewer.state.direction)>0})),i=[];return n.forEach((e,r)=>{if(!e.visible){[0===r?n[t-1]:n[r-1],r===t-1?n[0]:n[r+1]].forEach(t=>{t.visible&&i.push({visible:t.vector,invisible:e.vector,index:r})})}}),i.reverse().forEach(e=>{n.splice(e.index,0,{vector:Qte(e.visible,e.invisible,this.viewer.state.direction),visible:!0})}),n.filter(e=>e.visible).map(e=>this.viewer.dataHelper.vector3ToViewerCoords(e.vector))}},nne=class extends Hte{get svgElement(){return this.domElement.firstElementChild}constructor(e,t,n){super(e,t,n)}isSvg(){return!0}createElement(){const e="square"===this.type?"rect":this.type,t=document.createElementNS(bte,e);this.element=document.createElementNS(bte,"svg"),this.element.appendChild(t),this.afterCreateElement()}update(e){super.update(e);const t=this.svgElement;switch(this.needsUpdateSize=!0,this.type){case"square":this.definition={x:0,y:0,width:this.config.square,height:this.config.square};break;case"rect":Array.isArray(this.config.rect)?this.definition={x:0,y:0,width:this.config.rect[0],height:this.config.rect[1]}:this.definition={x:0,y:0,width:this.config.rect.width,height:this.config.rect.height};break;case"circle":this.definition={cx:this.config.circle,cy:this.config.circle,r:this.config.circle};break;case"ellipse":Array.isArray(this.config.ellipse)?this.definition={cx:this.config.ellipse[0],cy:this.config.ellipse[1],rx:this.config.ellipse[0],ry:this.config.ellipse[1]}:this.definition={cx:this.config.ellipse.rx,cy:this.config.ellipse.ry,rx:this.config.ellipse.rx,ry:this.config.ellipse.ry};break;case"path":this.definition={d:this.config.path}}Object.entries(this.definition).forEach(e=>{let[n,i]=e;t.setAttributeNS(null,n,i)}),this.config.svgStyle?Object.entries(this.config.svgStyle).forEach(e=>{let[n,i]=e;t.setAttributeNS(null,l8.dasherize(n),i)}):t.setAttributeNS(null,"fill","rgba(0,0,0,0.5)")}},ine=l8.getConfigParser({clickEventOnMarker:!1,gotoMarkerSpeed:"8rpm",markers:null,defaultHoverScale:null},{defaultHoverScale:e=>e?(!0===e&&(e=Tte),"number"===typeof e&&(e={amount:e}),Cr(Cr({},Tte),e)):null});var rne=class e extends aee{constructor(e,t){super(e,t),this.markers={},this.state={allVisible:!0,showAllTooltips:!1,currentMarker:null,hoveringMarker:null,needsReRender:!1,lastClientX:null,lastClientY:null},this.container=document.createElement("div"),this.container.className="psv-markers",this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",e=>e.preventDefault()),this.svgContainer=document.createElementNS(bte,"svg"),this.svgContainer.setAttribute("class","psv-markers-svg-container"),this.container.appendChild(this.svgContainer),this.css3DContainer=new Ote(e),this.container.appendChild(this.css3DContainer.element),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0)}static withConfig(t){return[e,t]}init(){super.init(),l8.checkStylesheet(this.viewer.container,"markers-plugin"),this.viewer.addEventListener(b9.ClickEvent.type,this),this.viewer.addEventListener(b9.DoubleClickEvent.type,this),this.viewer.addEventListener(b9.RenderEvent.type,this),this.viewer.addEventListener(b9.ConfigChangedEvent.type,this),this.viewer.addEventListener(b9.ObjectEnterEvent.type,this),this.viewer.addEventListener(b9.ObjectHoverEvent.type,this),this.viewer.addEventListener(b9.ObjectLeaveEvent.type,this),this.viewer.addEventListener(b9.ReadyEvent.type,this,{once:!0})}destroy(){this.clearMarkers(!1),this.viewer.unobserveObjects(xte),this.viewer.removeEventListener(b9.ClickEvent.type,this),this.viewer.removeEventListener(b9.DoubleClickEvent.type,this),this.viewer.removeEventListener(b9.RenderEvent.type,this),this.viewer.removeEventListener(b9.ObjectEnterEvent.type,this),this.viewer.removeEventListener(b9.ObjectHoverEvent.type,this),this.viewer.removeEventListener(b9.ObjectLeaveEvent.type,this),this.viewer.removeEventListener(b9.ReadyEvent.type,this),this.css3DContainer.destroy(),this.viewer.container.removeChild(this.container),super.destroy()}handleEvent(e){var t;switch(e.type){case b9.ReadyEvent.type:this.config.markers&&(this.setMarkers(this.config.markers),delete this.config.markers);break;case b9.RenderEvent.type:this.renderMarkers();break;case b9.ClickEvent.type:this.__onClick(e,!1);break;case b9.DoubleClickEvent.type:this.__onClick(e,!0);break;case b9.ObjectEnterEvent.type:case b9.ObjectLeaveEvent.type:case b9.ObjectHoverEvent.type:if(e.userDataKey===xte){const n=e.originalEvent,i=e.object.userData[xte];switch(e.type){case b9.ObjectEnterEvent.type:null!==(t=i.config.style)&&void 0!==t&&t.cursor?this.viewer.setCursor(i.config.style.cursor):(i.config.tooltip||i.config.content)&&this.viewer.setCursor("pointer"),this.__onEnterMarker(n,i);break;case b9.ObjectLeaveEvent.type:this.viewer.setCursor(null),this.__onLeaveMarker(i);break;case b9.ObjectHoverEvent.type:this.__onHoverMarker(n,i)}}break;case"mouseenter":{const t=this.__getTargetMarker(l8.getEventTarget(e));this.__onEnterMarker(e,t);break}case"mouseleave":{const t=this.__getTargetMarker(l8.getEventTarget(e));this.__onLeaveMarker(t);break}case"mousemove":{const t=this.__getTargetMarker(l8.getEventTarget(e),!0);this.__onHoverMarker(e,t);break}}}toggleAllMarkers(){this.state.allVisible?this.hideAllMarkers():this.showAllMarkers()}showAllMarkers(){this.state.allVisible=!0,Object.values(this.markers).forEach(e=>{e.config.visible=!0}),this.renderMarkers(),this.dispatchEvent(new mte)}hideAllMarkers(){this.state.allVisible=!1,Object.values(this.markers).forEach(e=>{e.config.visible=!1}),this.renderMarkers(),this.dispatchEvent(new dte)}toggleAllTooltips(){this.state.showAllTooltips?this.hideAllTooltips():this.showAllTooltips()}showAllTooltips(){this.state.showAllTooltips=!0,Object.values(this.markers).forEach(e=>{e.state.staticTooltip=!0,e.showTooltip()})}hideAllTooltips(){this.state.showAllTooltips=!1,Object.values(this.markers).forEach(e=>{e.state.staticTooltip=!1,e.hideTooltip()})}getNbMarkers(){return Object.keys(this.markers).length}getMarkers(){return Object.values(this.markers)}addMarker(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.markers[e.id])throw new z8('marker "'.concat(e.id,'" already exists'));const n=new(function(e){switch(Fte(e,!1)){case"image":case"html":case"element":return ene;case"imageLayer":case"videoLayer":return Zte;case"elementLayer":return $te;case"polygon":case"polyline":case"polygonPixels":case"polylinePixels":return tne;case"square":case"rect":case"circle":case"ellipse":case"path":return nne;default:throw new z8("invalid marker type")}}(e))(this.viewer,this,e);n.isPoly()?this.svgContainer.appendChild(n.domElement):n.isCss3d()?this.css3DContainer.addObject(n):n.is3d()?this.viewer.renderer.addObject(n.threeElement):this.container.appendChild(n.domElement),this.markers[n.id]=n,this.state.showAllTooltips&&(n.state.staticTooltip=!0),t&&this.__afterChangeMarkers()}getMarker(e){const t="object"===typeof e?e.id:e;if(!this.markers[t])throw new z8('cannot find marker "'.concat(t,'"'));return this.markers[t]}getCurrentMarker(){return this.state.currentMarker}updateMarker(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.getMarker(e.id);var i;(n.update(e),t)&&(this.__afterChangeMarkers(),(n===this.state.hoveringMarker&&"hover"===(null===(i=n.config.tooltip)||void 0===i?void 0:i.trigger)||n.state.staticTooltip)&&n.showTooltip(this.state.lastClientX,this.state.lastClientY,!0))}removeMarker(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.getMarker(e);n.isPoly()?this.svgContainer.removeChild(n.domElement):n.isCss3d()?this.css3DContainer.removeObject(n):n.is3d()?this.viewer.renderer.removeObject(n.threeElement):this.container.removeChild(n.domElement),this.state.hoveringMarker===n&&(this.state.hoveringMarker=null),this.state.currentMarker===n&&(this.state.currentMarker=null),n.destroy(),delete this.markers[n.id],t&&this.__afterChangeMarkers()}removeMarkers(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.forEach(e=>this.removeMarker(e,!1)),t&&this.__afterChangeMarkers()}setMarkers(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.clearMarkers(!1),null===e||void 0===e||e.forEach(e=>{this.addMarker(e,!1)}),t&&this.__afterChangeMarkers()}clearMarkers(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Object.keys(this.markers).forEach(e=>{this.removeMarker(e,!1)}),e&&this.__afterChangeMarkers()}gotoMarker(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.config.gotoMarkerSpeed;const n=this.getMarker(e);return t?this.viewer.animate(Cr(Cr({},n.state.position),{},{zoom:n.config.zoomLvl,speed:t})).then(()=>{this.dispatchEvent(new $ee(n))}):(this.viewer.rotate(n.state.position),l8.isNil(n.config.zoomLvl)||this.viewer.zoom(n.config.zoomLvl),this.dispatchEvent(new $ee(n)),Promise.resolve())}hideMarker(e){this.toggleMarker(e,!1)}showMarker(e){this.toggleMarker(e,!0)}showMarkerTooltip(e){const t=this.getMarker(e);t.state.staticTooltip=!0,t.showTooltip()}hideMarkerTooltip(e){const t=this.getMarker(e);t.state.staticTooltip=!1,t.hideTooltip()}toggleMarker(e,t){const n=this.getMarker(e);n.config.visible=l8.isNil(t)?!n.config.visible:t,this.renderMarkers()}showMarkerPanel(e){const t=this.getMarker(e);t.config.content?this.viewer.panel.show({id:Ete,content:t.config.content}):this.hideMarkerPanel()}hideMarkerPanel(){this.viewer.panel.hide(Ete)}toggleMarkersList(){this.viewer.panel.isVisible(wte)?this.hideMarkersList():this.showMarkersList()}showMarkersList(){let e=[];Object.values(this.markers).forEach(t=>{t.config.visible&&!t.config.hideList&&e.push(t)});const t=new vte(e);this.dispatchEvent(t),e=t.markers,this.viewer.panel.show({id:wte,content:Mte(e,this.viewer.config.lang[yte.id]),noMargin:!0,clickHandler:e=>{const t=l8.getClosest(e,".psv-panel-menu-item"),n=t?t.dataset[xte]:void 0;if(n){const e=this.getMarker(n);this.dispatchEvent(new ote(e)),this.gotoMarker(e.id),this.hideMarkersList()}}})}hideMarkersList(){this.viewer.panel.hide(wte)}renderMarkers(){if(this.state.needsReRender)return void(this.state.needsReRender=!1);const e=this.viewer.getZoomLevel(),t=this.viewer.getPosition(),n=this.state.hoveringMarker;Object.values(this.markers).forEach(i=>{let r=i.config.visible,s=!1,a=null;r&&(a=i.render({viewerPosition:t,zoomLevel:e,hoveringMarker:n}),r=!!a),s=i.state.visible!==r,i.state.visible=r,i.state.position2D=a,i.domElement&&l8.toggleClass(i.domElement,"psv-marker--visible",r),r?i.state.staticTooltip?i.showTooltip():i!==this.state.hoveringMarker&&i.hideTooltip():i.hideTooltip(),s&&(this.dispatchEvent(new Qee(i,r)),(i.is3d()||i.isCss3d())&&(this.state.needsReRender=!0))}),this.state.needsReRender&&this.viewer.needsUpdate()}__getTargetMarker(e){if(e instanceof Node){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?l8.getClosest(e,".psv-marker"):e;return t?t[xte]:void 0}return Array.isArray(e)?e.map(e=>e.userData[xte]).filter(e=>!!e).sort((e,t)=>t.config.zIndex-e.config.zIndex)[0]:null}__onEnterMarker(e,t){var n;t&&(this.state.hoveringMarker=t,this.state.lastClientX=e.clientX,this.state.lastClientY=e.clientY,this.dispatchEvent(new ite(t)),t instanceof Hte&&t.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!0}),t.state.staticTooltip||"hover"!==(null===(n=t.config.tooltip)||void 0===n?void 0:n.trigger)||t.showTooltip(e.clientX,e.clientY))}__onLeaveMarker(e){var t;e&&(this.dispatchEvent(new tte(e)),e instanceof Hte&&e.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!1}),this.state.hoveringMarker=null,e.state.staticTooltip||"hover"!==(null===(t=e.config.tooltip)||void 0===t?void 0:t.trigger)?e.state.staticTooltip&&e.showTooltip():e.hideTooltip())}__onHoverMarker(e,t){var n;t&&(this.state.lastClientX=e.clientX,this.state.lastClientY=e.clientY,(t.isPoly()||t.is3d()||t.isCss3d())&&"hover"===(null===(n=t.config.tooltip)||void 0===n?void 0:n.trigger)&&t.showTooltip(e.clientX,e.clientY))}__onClick(e,t){const n=this.__getTargetMarker(e.data.objects),i=this.__getTargetMarker(e.data.target,!0)||n;var r,s;this.state.currentMarker&&this.state.currentMarker!==i&&(this.dispatchEvent(new cte(this.state.currentMarker)),this.viewer.panel.hide(Ete),this.state.showAllTooltips||"click"!==(null===(r=this.state.currentMarker.config.tooltip)||void 0===r?void 0:r.trigger)||this.hideMarkerTooltip(this.state.currentMarker.id),this.state.currentMarker=null);i&&(this.state.currentMarker=i,this.dispatchEvent(new ste(i,t,e.data.rightclick)),this.config.clickEventOnMarker?e.data.marker=i:e.stopImmediatePropagation(),this.markers[i.id]&&!e.data.rightclick&&("click"===(null===(s=i.config.tooltip)||void 0===s?void 0:s.trigger)?i.tooltip?this.hideMarkerTooltip(i.id):this.showMarkerTooltip(i.id):this.showMarkerPanel(i.id)))}__afterChangeMarkers(){this.__refreshUi(),this.__checkObjectsObserver(),this.viewer.needsUpdate(),this.dispatchEvent(new fte(this.getMarkers()))}__refreshUi(){var e,t;const n=Object.values(this.markers).filter(e=>!e.config.hideList).length;0===n?(this.viewer.panel.hide(Ete),this.viewer.panel.hide(wte)):this.viewer.panel.isVisible(wte)?this.showMarkersList():this.viewer.panel.isVisible(Ete)&&(this.state.currentMarker?this.showMarkerPanel(this.state.currentMarker.id):this.viewer.panel.hide()),null===(e=this.viewer.navbar.getButton(yte.id,!1))||void 0===e||e.toggle(n>0),null===(t=this.viewer.navbar.getButton(Ate.id,!1))||void 0===t||t.toggle(n>0)}__checkObjectsObserver(){const e=Object.values(this.markers).some(e=>e.is3d());e?this.viewer.observeObjects(xte):this.viewer.unobserveObjects(xte)}};rne.id="markers",rne.VERSION="5.14.0",rne.configParser=ine,rne.readonlyOptions=["markers"];var sne=rne;lee.lang[yte.id]="Markers",lee.lang[Ate.id]="Markers list",mee(yte,"caption:left"),mee(Ate,"caption:left");const ane="\u041d\u043e\u043c\u0435\u0440 \u0410\u043b\u044c\u0444\u0430",one="\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u043e\u0435 \u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \u0432 \u0434\u0432\u0443\u0445\u043a\u043e\u043c\u043d\u0430\u0442\u043d\u043e\u043c \u043d\u043e\u043c\u0435\u0440\u0435",lne=12500,cne="\u043f\u0440\u043e\u0441\u0442\u043e\u0440\u043d\u044b\u0439 \u0447\u0435\u0442\u044b\u0440\u0435\u0445\u043c\u0435\u0441\u0442\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043f\u043b\u043e\u0449\u0430\u0434\u044c\u044e 35,5 \u043c\xb2. \u0414\u0432\u0435 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0435 \u0441\u043f\u0430\u043b\u044c\u043d\u0438 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044e\u0442 \u043b\u0438\u0447\u043d\u043e\u0435 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e \u043a\u0430\u0436\u0434\u043e\u043c\u0443, \u0434\u0432\u0430 \u0441\u0430\u043d\u0443\u0437\u043b\u0430 \u0438\u0437\u0431\u0430\u0432\u043b\u044f\u044e\u0442 \u043e\u0442 \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439 \u043f\u043e \u0443\u0442\u0440\u0430\u043c. \u0415\u0441\u0442\u044c \u043f\u0440\u0438\u0445\u043e\u0436\u0430\u044f \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u043d\u043e\u0433\u043e \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0432\u0435\u0449\u0435\u0439",une=e=>{Object.assign({},(ja(e),e));const n=(0,t.useContext)(x),i=(0,t.useContext)(S),r=(0,t.useContext)(E),s=Ds(),a=(0,t.useRef)(null),[o,l]=(Ns(),(0,t.useState)(!1)),[c,u]=(0,t.useState)(2),[d,h]=(0,t.useState)("layout"),[f,m]=(0,t.useState)("kitchen"),g={kitchen:{image:UQ,markers:[{id:"bathroom",image:GQ,size:{width:100,height:100},position:{yaw:"160.5deg",pitch:"-0.1deg"},tooltip:"\u0412\u0430\u043d\u043d\u0430\u044f \u043a\u043e\u043c\u043d\u0430\u0442\u0430"},{id:"bedroom",image:GQ,size:{width:100,height:100},position:{yaw:"230.5deg",pitch:"-0.1deg"},tooltip:"\u0416\u0438\u043b\u0430\u044f \u043a\u043e\u043c\u043d\u0430\u0442\u0430"}]},bedroom:{image:zQ,markers:[{id:"kitchen",image:GQ,size:{width:100,height:100},position:{yaw:"110.5deg",pitch:"-0.1deg"},tooltip:"\u041a\u0443\u0445\u043d\u044f"},{id:"bathroom",image:GQ,size:{width:100,height:100},position:{yaw:"10.5deg",pitch:"-0.1deg"},tooltip:"\u0412\u0430\u043d\u043d\u0430\u044f \u043a\u043e\u043c\u043d\u0430\u0442\u0430"}]},bathroom:{image:HQ,markers:[{id:"kitchen",image:GQ,size:{width:100,height:100},position:{yaw:"270.5deg",pitch:"-0.1deg"},tooltip:"\u041a\u0443\u0445\u043d\u044f"}]}};(0,t.useEffect)(()=>{n[1]("room"),i[1]("price"),s.state||r[1]("price")},[]);const v=e=>{e.clearMarkers(!0),g[f].markers.forEach(t=>{e.addMarker(Cr({},t))}),g[f].markers.forEach(t=>{e.getMarker(t.id).domElement.addEventListener("click",()=>{m(t.id)})})};(0,t.useEffect)(()=>{if(a.current){const e=a.current.getPlugin(sne);if(!e)return;v(e)}},[f]);return(0,p.jsxs)("main",{className:xQ,children:[(0,p.jsxs)("div",{className:SQ,children:[(0,p.jsx)("div",{className:CQ,children:ane}),(0,p.jsx)("div",{className:LQ,children:one}),(0,p.jsxs)("div",{className:RQ,children:[(0,p.jsx)(zM,{className:"".concat(NQ," ").concat(!o&&FQ),title:"\u0411\u0435\u0437 \u0431\u0430\u043b\u043a\u043e\u043da",onClick:()=>l(!1)}),(0,p.jsx)(zM,{className:"".concat(NQ," ").concat(o&&FQ),title:"\u0421 \u0431\u0430\u043b\u043a\u043e\u043d\u043e\u043c",onClick:()=>l(!0)})]}),(0,p.jsxs)("div",{className:RQ,children:[(0,p.jsx)(zM,{className:"".concat(NQ," ").concat(2===c&&FQ),title:"2 \u044d\u0442\u0430\u0436",onClick:()=>u(2)}),(0,p.jsx)(zM,{className:"".concat(NQ," ").concat(3===c&&FQ),title:"3 \u044d\u0442\u0430\u0436",onClick:()=>u(3)}),(0,p.jsx)(zM,{className:"".concat(NQ," ").concat(4===c&&FQ),title:"4 \u044d\u0442\u0430\u0436",onClick:()=>u(4)}),(0,p.jsx)(zM,{className:"".concat(NQ," ").concat(5===c&&FQ),title:"5 \u044d\u0442\u0430\u0436",onClick:()=>u(5)}),(0,p.jsx)(zM,{className:"".concat(NQ," ").concat(6===c&&FQ),title:"6 \u044d\u0442\u0430\u0436",onClick:()=>u(6)})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:DQ,children:"\u041e \u043d\u043e\u043c\u0435\u0440\u0435"}),(0,p.jsx)("div",{className:kQ,children:cne})]}),(0,p.jsx)("div",{className:PQ,children:(0,p.jsxs)("div",{className:IQ,children:[lne," \u20bd/\u043c\u0435\u0441."]})}),(0,p.jsx)("div",{className:OQ,children:(0,p.jsx)(zM,{className:NQ,title:"\u041f\u043e\u0434\u0430\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443",onClick:()=>{}})})]}),(0,p.jsxs)("div",{className:wQ,style:{backgroundImage:"url(image/".concat("layout"===d?"room-alpha.svg":"room1.jpg",")")},children:[(0,p.jsx)("div",{className:TQ}),(0,p.jsxs)("div",{className:MQ,children:[(0,p.jsx)("div",{children:(0,p.jsx)(zM,{title:"\u041f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u043a\u0430 \u043d\u043e\u043c\u0435\u0440\u0430",active:"layout"===d,onClick:()=>h("layout")})}),(0,p.jsx)("div",{children:(0,p.jsx)(zM,{title:"3\u0434 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u043d\u043e\u043c\u0435\u0440\u0430",active:"3d"===d,onClick:()=>h("3d")})})]}),(0,p.jsx)("div",{className:AQ,children:"layout"===d?(0,p.jsx)("img",{className:EQ,src:BQ}):(0,p.jsx)(Xee,{src:g[f].image,height:"100%",width:"100%",littlePlanet:!1,navbar:[],plugins:[[sne,Cr({},g[f].markers)]],onReady:e=>{a.current=e;const t=a.current.getPlugin(sne);t&&v(t)}})})]})]})},dne="SearchPageComponent_main__PnAOq",hne="SearchPageComponent_filters__GIl-1",fne="SearchPageComponent_description_filter__qW7JT",pne="SearchPageComponent_item__o903z",mne="SearchPageComponent_item_date_start__l7Pb4",gne="SearchPageComponent_item_date__rOtZA",vne="SearchPageComponent_results__7Od9b",yne="SearchPageComponent_button__G09ga",_ne="SearchPageComponent_list__3kDI2",bne="RoomCardComponent_main__OW+Km",xne="RoomCardComponent_description__kueot",Sne="RoomCardComponent_item_level_two__FGXkH",Ene="RoomCardComponent_item_level_three__OTJXm",wne="RoomCardComponent_image__HfSkH",Tne="RoomCardComponent_item__-79qU",Mne="RoomCardComponent_item_bottom__dfqog",Ane="RoomCardComponent_buttons__uI8AU",Cne="RoomCardComponent_button__NZ-JK",Rne=e=>{Object.assign({},(ja(e),e));(0,t.useContext)(x),(0,t.useContext)(S),(0,t.useContext)(E),Ds(),(0,t.useRef)(null);const n=Ns();return(0,p.jsxs)("div",{className:bne,children:[(0,p.jsx)("img",{className:wne,src:BQ}),(0,p.jsxs)("div",{className:xne,children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:Tne,children:"\u041d\u043e\u043c\u0435\u0440 \u0410\u043b\u044c\u0444\u0430"}),(0,p.jsx)("div",{className:Sne,children:"2 \u043a\u043e\u043c\u043d\u0430\u0442\u044b, 4 \u0441\u043f\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0435\u0441\u0442\u0430"}),(0,p.jsx)("div",{className:Ene,children:"\u0411\u0435\u0437 \u0431\u0430\u043b\u043a\u043e\u043d\u0430"}),(0,p.jsx)("div",{className:Ene,children:'3 \u044d\u0442\u0430\u0436 \u043a\u043e\u0440\u043f\u0443\u0441\u0430 "\u0411\u0430\u0439\u043a\u0430\u043d\u0443\u0440"'})]}),(0,p.jsxs)("div",{className:Mne,children:[(0,p.jsx)("div",{className:Tne,children:"12000 \u20bd/\u043c\u0435\u0441."}),(0,p.jsxs)("div",{className:Ane,children:[(0,p.jsx)(zM,{className:Cne,title:"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043d\u043e\u043c\u0435\u0440",onClick:()=>n("/room")}),(0,p.jsx)(zM,{className:Cne,title:"\u041f\u043e\u0434\u0430\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443",onClick:()=>{}})]})]})]})]})},Lne=e=>{Object.assign({},(ja(e),e));const n=(0,t.useContext)(x),i=(0,t.useContext)(S),r=(0,t.useContext)(E),s=CA(rR.filters),a=CA(rR.isFiltersValid),o=AA(),l=Ds();(0,t.useEffect)(()=>{n[1]("search"),i[1]("home"),l.state||r[1]("home")},[]);return(0,p.jsxs)("main",{className:dne,children:[(0,p.jsxs)("div",{className:hne,children:[(0,p.jsxs)("div",{className:mne,children:[(0,p.jsx)("p",{className:fne,children:"\u0414\u0430\u0442\u0430 \u0437\u0430\u0435\u0437\u0434\u0430:"}),(0,p.jsx)(NM,{locale:aA,selected:s.dateStart?new Date(s.dateStart):null,onChange:e=>{var t;o(iR.setDateStart(null!==(t=null===e||void 0===e?void 0:e.toISOString())&&void 0!==t?t:null)),e&&s.dateEnd&&e>new Date(s.dateEnd)&&o(iR.setDateEnd(null))},selectsStart:!0,isClearable:!1,monthsShown:1,minDate:new Date,startDate:s.dateStart?new Date(s.dateStart):null,endDate:s.dateEnd?new Date(s.dateEnd):null,dateFormat:"dd.MM.yyyy",popperPlacement:"bottom-start",showPopperArrow:!1,previousMonthButtonLabel:"< \u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439",nextMonthButtonLabel:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 >",customInput:(0,p.jsx)(aR,{})})]}),(0,p.jsxs)("div",{className:gne,children:[(0,p.jsx)("p",{className:fne,children:"\u0414\u0430\u0442\u0430 \u0432\u044b\u0435\u0437\u0434\u0430:"}),(0,p.jsx)(NM,{locale:aA,selected:s.dateEnd?new Date(s.dateEnd):null,selectsEnd:!0,onChange:e=>{var t;e&&s.dateStart&&e<new Date(s.dateStart)||o(iR.setDateEnd(null!==(t=null===e||void 0===e?void 0:e.toISOString())&&void 0!==t?t:null))},isClearable:!1,monthsShown:1,startDate:s.dateStart?new Date(s.dateStart):null,endDate:s.dateEnd?new Date(s.dateEnd):null,minDate:new Date,dateFormat:"dd.MM.yyyy",popperPlacement:"bottom-start",showPopperArrow:!1,previousMonthButtonLabel:"< \u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439",nextMonthButtonLabel:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 >",customInput:(0,p.jsx)(oR,{})})]}),(0,p.jsxs)("div",{className:pne,children:[(0,p.jsx)("div",{}),(0,p.jsx)(zM,{className:yne,title:"\u041d\u0430\u0439\u0442\u0438 \u043d\u043e\u043c\u0435\u0440\u0430",disabled:!a,onClick:()=>{}})]})]}),(0,p.jsx)("div",{className:vne,children:(0,p.jsxs)("div",{className:_ne,children:[(0,p.jsx)(Rne,{}),(0,p.jsx)(Rne,{}),(0,p.jsx)(Rne,{}),(0,p.jsx)(Rne,{}),(0,p.jsx)(Rne,{}),(0,p.jsx)(Rne,{}),(0,p.jsx)(Rne,{}),(0,p.jsx)(Rne,{}),(0,p.jsx)(Rne,{}),(0,p.jsx)(Rne,{}),(0,p.jsx)(Rne,{}),(0,p.jsx)(Rne,{}),(0,p.jsx)(Rne,{}),(0,p.jsx)(Rne,{}),(0,p.jsx)(Rne,{})]})})]})};const Pne=function(){return(0,p.jsx)("div",{className:"App",children:(0,p.jsx)(ka,{children:(0,p.jsx)(_Q,{children:(0,p.jsx)(bQ,{children:(0,p.jsxs)(yQ,{children:[(0,p.jsx)(Wa,{}),(0,p.jsxs)(ta,{children:[(0,p.jsx)($s,{path:"/",element:(0,p.jsx)(vQ,{})}),(0,p.jsx)($s,{path:"/room",element:(0,p.jsx)(une,{})}),(0,p.jsx)($s,{path:"/search",element:(0,p.jsx)(Lne,{})})]})]})})})})})},Ine=e=>{e&&e instanceof Function&&n.e(511).then(n.bind(n,511)).then(t=>{let{getCLS:n,getFID:i,getFCP:r,getLCP:s,getTTFB:a}=t;n(e),i(e),r(e),s(e),a(e)})},Dne=function(e){const t=function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:r=!0}=null!==e&&void 0!==e?e:{};let s=new kC;return t&&("boolean"===typeof t?s.push(RC):s.push(LC(t.extraArgument))),s},{reducer:n,middleware:i,devTools:r=!0,duplicateMiddlewareCheck:s=!0,preloadedState:a,enhancers:o}=e||{};let l,c;if("function"===typeof n)l=n;else{if(!wC(n))throw new Error(eR(1));l=MC(n)}c="function"===typeof i?i(t):t();let u=AC;r&&(u=IC(Cr({trace:!1},"object"===typeof r&&r)));const d=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>(n,i)=>{const r=e(n,i);let s=()=>{throw new Error(bC(15))};const a={getState:r.getState,dispatch:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return s(e,...n)}},o=t.map(e=>e(a));return s=AC(...o)(r.dispatch),Cr(Cr({},r),{},{dispatch:s})}}(...c),h=UC(d);return TC(l,a,u(..."function"===typeof o?o(h):h()))}({reducer:MC({search:nR}),middleware:e=>e()});r.createRoot(document.getElementById("root")).render((0,p.jsx)(t.StrictMode,{children:(0,p.jsx)(yA,{store:Dne,children:(0,p.jsx)(Pne,{})})})),Ine()})()})();
//# sourceMappingURL=main.85734ae7.js.map