/*! For license information please see main.456e7276.js.LICENSE.txt */
(()=>{"use strict";var t={19:(t,e,n)=>{var i=n(565);var r="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},s=i.useSyncExternalStore,a=i.useRef,o=i.useEffect,l=i.useMemo,c=i.useDebugValue;e.useSyncExternalStoreWithSelector=function(t,e,n,i,u){var h=a(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;h=l(function(){function t(t){if(!o){if(o=!0,s=t,t=i(t),void 0!==u&&d.hasValue){var e=d.value;if(u(e,t))return a=e}return a=t}if(e=a,r(s,t))return e;var n=i(t);return void 0!==u&&u(e,n)?(s=t,e):(s=t,a=n)}var s,a,o=!1,l=void 0===n?null:n;return[function(){return t(e())},null===l?void 0:function(){return t(l())}]},[e,n,i,u]);var f=s(t,h[0],h[1]);return o(function(){d.hasValue=!0,d.value=f},[f]),c(f),f}},51:(t,e,n)=>{t.exports=n(19)},69:(t,e,n)=>{t.exports=n(970)},396:(t,e,n)=>{!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(764)},501:(t,e,n)=>{var i=n(396);e.createRoot=i.createRoot,e.hydrateRoot=i.hydrateRoot},540:(t,e)=>{var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||p}function y(){}function _(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},v.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},y.prototype=v.prototype;var b=_.prototype=new y;b.constructor=_,m(b,v.prototype),b.isPureReactComponent=!0;var x=Array.isArray,E=Object.prototype.hasOwnProperty,w={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function T(t,e,i){var r,s={},a=null,o=null;if(null!=e)for(r in void 0!==e.ref&&(o=e.ref),void 0!==e.key&&(a=""+e.key),e)E.call(e,r)&&!S.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(1===l)s.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:t,key:a,ref:o,props:s,_owner:w.current}}function M(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var A=/\/+/g;function C(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(t){return e[t]})}(""+t.key):e.toString(36)}function R(t,e,r,s,a){var o=typeof t;"undefined"!==o&&"boolean"!==o||(t=null);var l=!1;if(null===t)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case n:case i:l=!0}}if(l)return a=a(l=t),t=""===s?"."+C(l,0):s,x(a)?(r="",null!=t&&(r=t.replace(A,"$&/")+"/"),R(a,e,r,"",function(t){return t})):null!=a&&(M(a)&&(a=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(A,"$&/")+"/")+t)),e.push(a)),1;if(l=0,s=""===s?".":s+":",x(t))for(var c=0;c<t.length;c++){var u=s+C(o=t[c],c);l+=R(o,e,r,u,a)}else if(u=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"===typeof u)for(t=u.call(t),c=0;!(o=t.next()).done;)l+=R(o=o.value,e,r,u=s+C(o,c++),a);else if("object"===o)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function k(t,e,n){if(null==t)return t;var i=[],r=0;return R(t,i,"","",function(t){return e.call(n,t,r++)}),i}function L(t){if(-1===t._status){var e=t._result;(e=e()).then(function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)},function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)}),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var D={current:null},P={transition:null},I={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:P,ReactCurrentOwner:w};function O(){throw Error("act(...) is not supported in production builds of React.")}e.Children={map:k,forEach:function(t,e,n){k(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return k(t,function(){e++}),e},toArray:function(t){return k(t,function(t){return t})||[]},only:function(t){if(!M(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=v,e.Fragment=r,e.Profiler=a,e.PureComponent=_,e.StrictMode=s,e.Suspense=u,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,e.act=O,e.cloneElement=function(t,e,i){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=m({},t.props),s=t.key,a=t.ref,o=t._owner;if(null!=e){if(void 0!==e.ref&&(a=e.ref,o=w.current),void 0!==e.key&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)E.call(e,c)&&!S.hasOwnProperty(c)&&(r[c]=void 0===e[c]&&void 0!==l?l[c]:e[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:t.type,key:s,ref:a,props:r,_owner:o}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:t},t.Consumer=t},e.createElement=T,e.createFactory=function(t){var e=T.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:c,render:t}},e.isValidElement=M,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:L}},e.memo=function(t,e){return{$$typeof:h,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=P.transition;P.transition={};try{t()}finally{P.transition=e}},e.unstable_act=O,e.useCallback=function(t,e){return D.current.useCallback(t,e)},e.useContext=function(t){return D.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return D.current.useDeferredValue(t)},e.useEffect=function(t,e){return D.current.useEffect(t,e)},e.useId=function(){return D.current.useId()},e.useImperativeHandle=function(t,e,n){return D.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return D.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return D.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return D.current.useMemo(t,e)},e.useReducer=function(t,e,n){return D.current.useReducer(t,e,n)},e.useRef=function(t){return D.current.useRef(t)},e.useState=function(t){return D.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return D.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return D.current.useTransition()},e.version="18.3.1"},565:(t,e,n)=>{t.exports=n(540)},643:(t,e,n)=>{var i=n(565),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(t,e,n){var i,s={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(u=e.ref),e)a.call(e,i)&&!l.hasOwnProperty(i)&&(s[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps)void 0===s[i]&&(s[i]=e[i]);return{$$typeof:r,type:t,key:c,ref:u,props:s,_owner:o.current}}e.jsx=c,e.jsxs=c},764:(t,e,n)=>{var i=n(565),r=n(69);function s(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(t,e){c(t,e),c(t+"Capture",e)}function c(t,e){for(o[t]=e,t=0;t<e.length;t++)a.add(e[t])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(t,e,n,i,r,s,a){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){g[t]=new m(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];g[e]=new m(e,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){g[t]=new m(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){g[t]=new m(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){g[t]=new m(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){g[t]=new m(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){g[t]=new m(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){g[t]=new m(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){g[t]=new m(t,5,!1,t.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(t){return t[1].toUpperCase()}function _(t,e,n,i){var r=g.hasOwnProperty(e)?g[e]:null;(null!==r?0!==r.type:i||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,n,i){if(null===e||"undefined"===typeof e||function(t,e,n,i){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,r,i)&&(n=null),i||null===r?function(t){return!!h.call(p,t)||!h.call(f,t)&&(d.test(t)?p[t]=!0:(f[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=null===n?3!==r.type&&"":n:(e=r.attributeName,i=r.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(v,y);g[e]=new m(e,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(v,y);g[e]=new m(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(v,y);g[e]=new m(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){g[t]=new m(t,1,!1,t.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){g[t]=new m(t,1,!1,t.toLowerCase(),null,!0,!0)});var b=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),E=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),A=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var I=Symbol.iterator;function O(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=I&&t[I]||t["@@iterator"])?t:null}var N,F=Object.assign;function U(t){if(void 0===N)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);N=e&&e[1]||""}return"\n"+N+t}var B=!1;function z(t,e){if(!t||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){i=c}t.call(e.prototype)}else{try{throw Error()}catch(c){i=c}t()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),s=i.stack.split("\n"),a=r.length-1,o=s.length-1;1<=a&&0<=o&&r[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||r[a]!==s[o]){var l="\n"+r[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=a&&0<=o);break}}}finally{B=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?U(t):""}function H(t){switch(t.tag){case 5:return U(t.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return t=z(t.type,!1);case 11:return t=z(t.type.render,!1);case 1:return t=z(t.type,!0);default:return""}}function V(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case w:return"Fragment";case E:return"Portal";case T:return"Profiler";case S:return"StrictMode";case R:return"Suspense";case k:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case A:return(t.displayName||"Context")+".Consumer";case M:return(t._context.displayName||"Context")+".Provider";case C:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case L:return null!==(e=t.displayName||null)?e:V(t.type)||"Memo";case D:e=t._payload,t=t._init;try{return V(t(e))}catch(n){}}return null}function G(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(e);case 8:return e===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function j(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function W(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function Y(t){t._valueTracker||(t._valueTracker=function(t){var e=W(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(t){i=""+t,s.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(t){i=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function X(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=W(t)?t.checked?"true":"false":t.value),(t=i)!==n&&(e.setValue(t),!0)}function K(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function q(t,e){var n=e.checked;return F({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function Q(t,e){var n=null==e.defaultValue?"":e.defaultValue,i=null!=e.checked?e.checked:e.defaultChecked;n=j(null!=e.value?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function Z(t,e){null!=(e=e.checked)&&_(t,"checked",e,!1)}function J(t,e){Z(t,e);var n=j(e.value),i=e.type;if(null!=n)"number"===i?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===i||"reset"===i)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&tt(t,e.type,j(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function $(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!("submit"!==i&&"reset"!==i||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function tt(t,e,n){"number"===e&&K(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var et=Array.isArray;function nt(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+j(n),e=null,r=0;r<t.length;r++){if(t[r].value===n)return t[r].selected=!0,void(i&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function it(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(s(91));return F({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function rt(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(s(92));if(et(n)){if(1<n.length)throw Error(s(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:j(n)}}function st(t,e){var n=j(e.value),i=j(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=i&&(t.defaultValue=""+i)}function at(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function ot(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?ot(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ct,ut,ht=(ut=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ct=ct||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ct.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,i){MSApp.execUnsafeLocalFunction(function(){return ut(t,e)})}:ut);function dt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var ft={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pt=["Webkit","ms","Moz","O"];function mt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||ft.hasOwnProperty(t)&&ft[t]?(""+e).trim():e+"px"}function gt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=mt(n,e[n],i);"float"===n&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}Object.keys(ft).forEach(function(t){pt.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ft[e]=ft[t]})});var vt=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yt(t,e){if(e){if(vt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(s(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(s(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(s(62))}}function _t(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bt=null;function xt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var Et=null,wt=null,St=null;function Tt(t){if(t=_r(t)){if("function"!==typeof Et)throw Error(s(280));var e=t.stateNode;e&&(e=xr(e),Et(t.stateNode,t.type,e))}}function Mt(t){wt?St?St.push(t):St=[t]:wt=t}function At(){if(wt){var t=wt,e=St;if(St=wt=null,Tt(t),e)for(t=0;t<e.length;t++)Tt(e[t])}}function Ct(t,e){return t(e)}function Rt(){}var kt=!1;function Lt(t,e,n){if(kt)return t(e,n);kt=!0;try{return Ct(t,e,n)}finally{kt=!1,(null!==wt||null!==St)&&(Rt(),At())}}function Dt(t,e){var n=t.stateNode;if(null===n)return null;var i=xr(n);if(null===i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(s(231,e,typeof n));return n}var Pt=!1;if(u)try{var It={};Object.defineProperty(It,"passive",{get:function(){Pt=!0}}),window.addEventListener("test",It,It),window.removeEventListener("test",It,It)}catch(ut){Pt=!1}function Ot(t,e,n,i,r,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Nt=!1,Ft=null,Ut=!1,Bt=null,zt={onError:function(t){Nt=!0,Ft=t}};function Ht(t,e,n,i,r,s,a,o,l){Nt=!1,Ft=null,Ot.apply(zt,arguments)}function Vt(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Gt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function jt(t){if(Vt(t)!==t)throw Error(s(188))}function Wt(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Vt(t)))throw Error(s(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(i=r.return)){n=i;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return jt(r),t;if(a===i)return jt(r),e;a=a.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=a;else{for(var o=!1,l=r.child;l;){if(l===n){o=!0,n=r,i=a;break}if(l===i){o=!0,i=r,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,i=r;break}if(l===i){o=!0,i=a,n=r;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?t:e}(t))?Yt(t):null}function Yt(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=Yt(t);if(null!==e)return e;t=t.sibling}return null}var Xt=r.unstable_scheduleCallback,Kt=r.unstable_cancelCallback,qt=r.unstable_shouldYield,Qt=r.unstable_requestPaint,Zt=r.unstable_now,Jt=r.unstable_getCurrentPriorityLevel,$t=r.unstable_ImmediatePriority,te=r.unstable_UserBlockingPriority,ee=r.unstable_NormalPriority,ne=r.unstable_LowPriority,ie=r.unstable_IdlePriority,re=null,se=null;var ae=Math.clz32?Math.clz32:function(t){return t>>>=0,0===t?32:31-(oe(t)/le|0)|0},oe=Math.log,le=Math.LN2;var ce=64,ue=4194304;function he(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function de(t,e){var n=t.pendingLanes;if(0===n)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,a=268435455&n;if(0!==a){var o=a&~r;0!==o?i=he(o):0!==(s&=a)&&(i=he(s))}else 0!==(a=n&~r)?i=he(a):0!==s&&(i=he(s));if(0===i)return 0;if(0!==e&&e!==i&&0===(e&r)&&((r=i&-i)>=(s=e&-e)||16===r&&0!==(4194240&s)))return e;if(0!==(4&i)&&(i|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=i;0<e;)r=1<<(n=31-ae(e)),i|=t[n],e&=~r;return i}function fe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function pe(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function me(){var t=ce;return 0===(4194240&(ce<<=1))&&(ce=64),t}function ge(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ve(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-ae(e)]=n}function ye(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-ae(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var _e=0;function be(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var xe,Ee,we,Se,Te,Me=!1,Ae=[],Ce=null,Re=null,ke=null,Le=new Map,De=new Map,Pe=[],Ie="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Oe(t,e){switch(t){case"focusin":case"focusout":Ce=null;break;case"dragenter":case"dragleave":Re=null;break;case"mouseover":case"mouseout":ke=null;break;case"pointerover":case"pointerout":Le.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":De.delete(e.pointerId)}}function Ne(t,e,n,i,r,s){return null===t||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==e&&(null!==(e=_r(e))&&Ee(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,null!==r&&-1===e.indexOf(r)&&e.push(r),t)}function Fe(t){var e=yr(t.target);if(null!==e){var n=Vt(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Gt(n)))return t.blockedOn=e,void Te(t.priority,function(){we(n)})}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Ue(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=qe(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=_r(n))&&Ee(e),t.blockedOn=n,!1;var i=new(n=t.nativeEvent).constructor(n.type,n);bt=i,n.target.dispatchEvent(i),bt=null,e.shift()}return!0}function Be(t,e,n){Ue(t)&&n.delete(e)}function ze(){Me=!1,null!==Ce&&Ue(Ce)&&(Ce=null),null!==Re&&Ue(Re)&&(Re=null),null!==ke&&Ue(ke)&&(ke=null),Le.forEach(Be),De.forEach(Be)}function He(t,e){t.blockedOn===e&&(t.blockedOn=null,Me||(Me=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,ze)))}function Ve(t){function e(e){return He(e,t)}if(0<Ae.length){He(Ae[0],t);for(var n=1;n<Ae.length;n++){var i=Ae[n];i.blockedOn===t&&(i.blockedOn=null)}}for(null!==Ce&&He(Ce,t),null!==Re&&He(Re,t),null!==ke&&He(ke,t),Le.forEach(e),De.forEach(e),n=0;n<Pe.length;n++)(i=Pe[n]).blockedOn===t&&(i.blockedOn=null);for(;0<Pe.length&&null===(n=Pe[0]).blockedOn;)Fe(n),null===n.blockedOn&&Pe.shift()}var Ge=b.ReactCurrentBatchConfig,je=!0;function We(t,e,n,i){var r=_e,s=Ge.transition;Ge.transition=null;try{_e=1,Xe(t,e,n,i)}finally{_e=r,Ge.transition=s}}function Ye(t,e,n,i){var r=_e,s=Ge.transition;Ge.transition=null;try{_e=4,Xe(t,e,n,i)}finally{_e=r,Ge.transition=s}}function Xe(t,e,n,i){if(je){var r=qe(t,e,n,i);if(null===r)ji(t,e,i,Ke,n),Oe(t,i);else if(function(t,e,n,i,r){switch(e){case"focusin":return Ce=Ne(Ce,t,e,n,i,r),!0;case"dragenter":return Re=Ne(Re,t,e,n,i,r),!0;case"mouseover":return ke=Ne(ke,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return Le.set(s,Ne(Le.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,De.set(s,Ne(De.get(s)||null,t,e,n,i,r)),!0}return!1}(r,t,e,n,i))i.stopPropagation();else if(Oe(t,i),4&e&&-1<Ie.indexOf(t)){for(;null!==r;){var s=_r(r);if(null!==s&&xe(s),null===(s=qe(t,e,n,i))&&ji(t,e,i,Ke,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else ji(t,e,i,null,n)}}var Ke=null;function qe(t,e,n,i){if(Ke=null,null!==(t=yr(t=xt(i))))if(null===(e=Vt(t)))t=null;else if(13===(n=e.tag)){if(null!==(t=Gt(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ke=t,null}function Qe(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Jt()){case $t:return 1;case te:return 4;case ee:case ne:return 16;case ie:return 536870912;default:return 16}default:return 16}}var Ze=null,Je=null,$e=null;function tn(){if($e)return $e;var t,e,n=Je,i=n.length,r="value"in Ze?Ze.value:Ze.textContent,s=r.length;for(t=0;t<i&&n[t]===r[t];t++);var a=i-t;for(e=1;e<=a&&n[i-e]===r[s-e];e++);return $e=r.slice(t,1<e?1-e:void 0)}function en(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function nn(){return!0}function rn(){return!1}function sn(t){function e(e,n,i,r,s){for(var a in this._reactName=e,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,t)t.hasOwnProperty(a)&&(e=t[a],this[a]=e?e(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),e}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),hn=F({},cn,{view:0,detail:0}),dn=sn(hn),fn=F({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tn,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ln&&(ln&&"mousemove"===t.type?(an=t.screenX-ln.screenX,on=t.screenY-ln.screenY):on=an=0,ln=t),an)},movementY:function(t){return"movementY"in t?t.movementY:on}}),pn=sn(fn),mn=sn(F({},fn,{dataTransfer:0})),gn=sn(F({},hn,{relatedTarget:0})),vn=sn(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=F({},cn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),_n=sn(yn),bn=sn(F({},cn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=wn[t])&&!!e[t]}function Tn(){return Sn}var Mn=F({},hn,{key:function(t){if(t.key){var e=xn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=en(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?En[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tn,charCode:function(t){return"keypress"===t.type?en(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?en(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),An=sn(Mn),Cn=sn(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Rn=sn(F({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tn})),kn=sn(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ln=F({},fn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=sn(Ln),Pn=[9,13,27,32],In=u&&"CompositionEvent"in window,On=null;u&&"documentMode"in document&&(On=document.documentMode);var Nn=u&&"TextEvent"in window&&!On,Fn=u&&(!In||On&&8<On&&11>=On),Un=String.fromCharCode(32),Bn=!1;function zn(t,e){switch(t){case"keyup":return-1!==Pn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hn(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Vn=!1;var Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Gn[t.type]:"textarea"===e}function Wn(t,e,n,i){Mt(i),0<(e=Yi(e,"onChange")).length&&(n=new un("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Yn=null,Xn=null;function Kn(t){Ui(t,0)}function qn(t){if(X(br(t)))return t}function Qn(t,e){if("change"===t)return e}var Zn=!1;if(u){var Jn;if(u){var $n="oninput"in document;if(!$n){var ti=document.createElement("div");ti.setAttribute("oninput","return;"),$n="function"===typeof ti.oninput}Jn=$n}else Jn=!1;Zn=Jn&&(!document.documentMode||9<document.documentMode)}function ei(){Yn&&(Yn.detachEvent("onpropertychange",ni),Xn=Yn=null)}function ni(t){if("value"===t.propertyName&&qn(Xn)){var e=[];Wn(e,Xn,t,xt(t)),Lt(Kn,e)}}function ii(t,e,n){"focusin"===t?(ei(),Xn=n,(Yn=e).attachEvent("onpropertychange",ni)):"focusout"===t&&ei()}function ri(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return qn(Xn)}function si(t,e){if("click"===t)return qn(e)}function ai(t,e){if("input"===t||"change"===t)return qn(e)}var oi="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function li(t,e){if(oi(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!h.call(e,r)||!oi(t[r],e[r]))return!1}return!0}function ci(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ui(t,e){var n,i=ci(t);for(t=0;i;){if(3===i.nodeType){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=ci(i)}}function hi(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?hi(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function di(){for(var t=window,e=K();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(i){n=!1}if(!n)break;e=K((t=e.contentWindow).document)}return e}function fi(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function pi(t){var e=di(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&fi(n))if(e=i.start,void 0===(t=i.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if((t=(e=n.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=ui(n,s);var a=ui(n,i);r&&a&&(1!==t.rangeCount||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&((e=e.createRange()).setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<e.length;n++)(t=e[n]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var mi=u&&"documentMode"in document&&11>=document.documentMode,gi=null,vi=null,yi=null,_i=!1;function bi(t,e,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_i||null==gi||gi!==K(i)||("selectionStart"in(i=gi)&&fi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&li(yi,i)||(yi=i,0<(i=Yi(vi,"onSelect")).length&&(e=new un("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=gi)))}function xi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ei={animationend:xi("Animation","AnimationEnd"),animationiteration:xi("Animation","AnimationIteration"),animationstart:xi("Animation","AnimationStart"),transitionend:xi("Transition","TransitionEnd")},wi={},Si={};function Ti(t){if(wi[t])return wi[t];if(!Ei[t])return t;var e,n=Ei[t];for(e in n)if(n.hasOwnProperty(e)&&e in Si)return wi[t]=n[e];return t}u&&(Si=document.createElement("div").style,"AnimationEvent"in window||(delete Ei.animationend.animation,delete Ei.animationiteration.animation,delete Ei.animationstart.animation),"TransitionEvent"in window||delete Ei.transitionend.transition);var Mi=Ti("animationend"),Ai=Ti("animationiteration"),Ci=Ti("animationstart"),Ri=Ti("transitionend"),ki=new Map,Li="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Di(t,e){ki.set(t,e),l(e,[t])}for(var Pi=0;Pi<Li.length;Pi++){var Ii=Li[Pi];Di(Ii.toLowerCase(),"on"+(Ii[0].toUpperCase()+Ii.slice(1)))}Di(Mi,"onAnimationEnd"),Di(Ai,"onAnimationIteration"),Di(Ci,"onAnimationStart"),Di("dblclick","onDoubleClick"),Di("focusin","onFocus"),Di("focusout","onBlur"),Di(Ri,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ni=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oi));function Fi(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,i,r,a,o,l,c){if(Ht.apply(this,arguments),Nt){if(!Nt)throw Error(s(198));var u=Ft;Nt=!1,Ft=null,Ut||(Ut=!0,Bt=u)}}(i,e,void 0,t),t.currentTarget=null}function Ui(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;t:{var s=void 0;if(e)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break t;Fi(r,o,c),s=l}else for(a=0;a<i.length;a++){if(l=(o=i[a]).instance,c=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break t;Fi(r,o,c),s=l}}}if(Ut)throw t=Bt,Ut=!1,Bt=null,t}function Bi(t,e){var n=e[mr];void 0===n&&(n=e[mr]=new Set);var i=t+"__bubble";n.has(i)||(Gi(e,t,2,!1),n.add(i))}function zi(t,e,n){var i=0;e&&(i|=4),Gi(n,t,i,e)}var Hi="_reactListening"+Math.random().toString(36).slice(2);function Vi(t){if(!t[Hi]){t[Hi]=!0,a.forEach(function(e){"selectionchange"!==e&&(Ni.has(e)||zi(e,!1,t),zi(e,!0,t))});var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Hi]||(e[Hi]=!0,zi("selectionchange",!1,e))}}function Gi(t,e,n,i){switch(Qe(e)){case 1:var r=We;break;case 4:r=Ye;break;default:r=Xe}n=r.bind(null,e,n,t),r=void 0,!Pt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(r=!0),i?void 0!==r?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):void 0!==r?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function ji(t,e,n,i,r){var s=i;if(0===(1&e)&&0===(2&e)&&null!==i)t:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var o=i.stateNode.containerInfo;if(o===r||8===o.nodeType&&o.parentNode===r)break;if(4===a)for(a=i.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;a=a.return}for(;null!==o;){if(null===(a=yr(o)))return;if(5===(l=a.tag)||6===l){i=s=a;continue t}o=o.parentNode}}i=i.return}Lt(function(){var i=s,r=xt(n),a=[];t:{var o=ki.get(t);if(void 0!==o){var l=un,c=t;switch(t){case"keypress":if(0===en(n))break t;case"keydown":case"keyup":l=An;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Rn;break;case Mi:case Ai:case Ci:l=vn;break;case Ri:l=kn;break;case"scroll":l=dn;break;case"wheel":l=Dn;break;case"copy":case"cut":case"paste":l=_n;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cn}var u=0!==(4&e),h=!u&&"scroll"===t,d=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=i;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=Dt(p,d))&&u.push(Wi(p,m,f)))),h)break;p=p.return}0<u.length&&(o=new l(o,c,null,n,r),a.push({event:o,listeners:u}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(o="mouseover"===t||"pointerover"===t)||n===bt||!(c=n.relatedTarget||n.fromElement)||!yr(c)&&!c[pr])&&(l||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?yr(c):null)&&(c!==(h=Vt(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=pn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==t&&"pointerover"!==t||(u=Cn,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?o:br(l),f=null==c?o:br(c),(o=new u(m,p+"leave",l,n,r)).target=h,o.relatedTarget=f,m=null,yr(r)===i&&((u=new u(d,p+"enter",c,n,r)).target=f,u.relatedTarget=h,m=u),h=m,l&&c)t:{for(d=c,p=0,f=u=l;f;f=Xi(f))p++;for(f=0,m=d;m;m=Xi(m))f++;for(;0<p-f;)u=Xi(u),p--;for(;0<f-p;)d=Xi(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break t;u=Xi(u),d=Xi(d)}u=null}else u=null;null!==l&&Ki(a,o,l,u,!1),null!==c&&null!==h&&Ki(a,h,c,u,!0)}if("select"===(l=(o=i?br(i):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Qn;else if(jn(o))if(Zn)g=ai;else{g=ri;var v=ii}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=si);switch(g&&(g=g(t,i))?Wn(a,g,n,r):(v&&v(t,o,i),"focusout"===t&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&tt(o,"number",o.value)),v=i?br(i):window,t){case"focusin":(jn(v)||"true"===v.contentEditable)&&(gi=v,vi=i,yi=null);break;case"focusout":yi=vi=gi=null;break;case"mousedown":_i=!0;break;case"contextmenu":case"mouseup":case"dragend":_i=!1,bi(a,n,r);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":bi(a,n,r)}var y;if(In)t:{switch(t){case"compositionstart":var _="onCompositionStart";break t;case"compositionend":_="onCompositionEnd";break t;case"compositionupdate":_="onCompositionUpdate";break t}_=void 0}else Vn?zn(t,n)&&(_="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(_="onCompositionStart");_&&(Fn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Vn&&(y=tn()):(Je="value"in(Ze=r)?Ze.value:Ze.textContent,Vn=!0)),0<(v=Yi(i,_)).length&&(_=new bn(_,t,null,n,r),a.push({event:_,listeners:v}),y?_.data=y:null!==(y=Hn(n))&&(_.data=y))),(y=Nn?function(t,e){switch(t){case"compositionend":return Hn(e);case"keypress":return 32!==e.which?null:(Bn=!0,Un);case"textInput":return(t=e.data)===Un&&Bn?null:t;default:return null}}(t,n):function(t,e){if(Vn)return"compositionend"===t||!In&&zn(t,e)?(t=tn(),$e=Je=Ze=null,Vn=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Fn&&"ko"!==e.locale?null:e.data}}(t,n))&&(0<(i=Yi(i,"onBeforeInput")).length&&(r=new bn("onBeforeInput","beforeinput",null,n,r),a.push({event:r,listeners:i}),r.data=y))}Ui(a,e)})}function Wi(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Yi(t,e){for(var n=e+"Capture",i=[];null!==t;){var r=t,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Dt(t,n))&&i.unshift(Wi(t,s,r)),null!=(s=Dt(t,e))&&i.push(Wi(t,s,r))),t=t.return}return i}function Xi(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Ki(t,e,n,i,r){for(var s=e._reactName,a=[];null!==n&&n!==i;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===i)break;5===o.tag&&null!==c&&(o=c,r?null!=(l=Dt(n,s))&&a.unshift(Wi(n,l,o)):r||null!=(l=Dt(n,s))&&a.push(Wi(n,l,o))),n=n.return}0!==a.length&&t.push({event:e,listeners:a})}var qi=/\r\n?/g,Qi=/\u0000|\uFFFD/g;function Zi(t){return("string"===typeof t?t:""+t).replace(qi,"\n").replace(Qi,"")}function Ji(t,e,n){if(e=Zi(e),Zi(t)!==e&&n)throw Error(s(425))}function $i(){}var tr=null,er=null;function nr(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,ar="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(t){return sr.resolve(null).then(t).catch(or)}:ir;function or(t){setTimeout(function(){throw t})}function lr(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return t.removeChild(r),void Ve(e);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Ve(e)}function cr(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function ur(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var hr=Math.random().toString(36).slice(2),dr="__reactFiber$"+hr,fr="__reactProps$"+hr,pr="__reactContainer$"+hr,mr="__reactEvents$"+hr,gr="__reactListeners$"+hr,vr="__reactHandles$"+hr;function yr(t){var e=t[dr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[pr]||n[dr]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=ur(t);null!==t;){if(n=t[dr])return n;t=ur(t)}return e}n=(t=n).parentNode}return null}function _r(t){return!(t=t[dr]||t[pr])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function br(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(s(33))}function xr(t){return t[fr]||null}var Er=[],wr=-1;function Sr(t){return{current:t}}function Tr(t){0>wr||(t.current=Er[wr],Er[wr]=null,wr--)}function Mr(t,e){wr++,Er[wr]=t.current,t.current=e}var Ar={},Cr=Sr(Ar),Rr=Sr(!1),kr=Ar;function Lr(t,e){var n=t.type.contextTypes;if(!n)return Ar;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=e[r];return i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Dr(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Pr(){Tr(Rr),Tr(Cr)}function Ir(t,e,n){if(Cr.current!==Ar)throw Error(s(168));Mr(Cr,e),Mr(Rr,n)}function Or(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in e))throw Error(s(108,G(t)||"Unknown",r));return F({},n,i)}function Nr(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ar,kr=Cr.current,Mr(Cr,t),Mr(Rr,Rr.current),!0}function Fr(t,e,n){var i=t.stateNode;if(!i)throw Error(s(169));n?(t=Or(t,e,kr),i.__reactInternalMemoizedMergedChildContext=t,Tr(Rr),Tr(Cr),Mr(Cr,t)):Tr(Rr),Mr(Rr,n)}var Ur=null,Br=!1,zr=!1;function Hr(t){null===Ur?Ur=[t]:Ur.push(t)}function Vr(){if(!zr&&null!==Ur){zr=!0;var t=0,e=_e;try{var n=Ur;for(_e=1;t<n.length;t++){var i=n[t];do{i=i(!0)}while(null!==i)}Ur=null,Br=!1}catch(r){throw null!==Ur&&(Ur=Ur.slice(t+1)),Xt($t,Vr),r}finally{_e=e,zr=!1}}return null}var Gr=[],jr=0,Wr=null,Yr=0,Xr=[],Kr=0,qr=null,Qr=1,Zr="";function Jr(t,e){Gr[jr++]=Yr,Gr[jr++]=Wr,Wr=t,Yr=e}function $r(t,e,n){Xr[Kr++]=Qr,Xr[Kr++]=Zr,Xr[Kr++]=qr,qr=t;var i=Qr;t=Zr;var r=32-ae(i)-1;i&=~(1<<r),n+=1;var s=32-ae(e)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Qr=1<<32-ae(e)+r|n<<r|i,Zr=s+t}else Qr=1<<s|n<<r|i,Zr=t}function ts(t){null!==t.return&&(Jr(t,1),$r(t,1,0))}function es(t){for(;t===Wr;)Wr=Gr[--jr],Gr[jr]=null,Yr=Gr[--jr],Gr[jr]=null;for(;t===qr;)qr=Xr[--Kr],Xr[Kr]=null,Zr=Xr[--Kr],Xr[Kr]=null,Qr=Xr[--Kr],Xr[Kr]=null}var ns=null,is=null,rs=!1,ss=null;function as(t,e){var n=Lc(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function os(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,ns=t,is=cr(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,ns=t,is=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(n=null!==qr?{id:Qr,overflow:Zr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Lc(18,null,null,0)).stateNode=e,n.return=t,t.child=n,ns=t,is=null,!0);default:return!1}}function ls(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function cs(t){if(rs){var e=is;if(e){var n=e;if(!os(t,e)){if(ls(t))throw Error(s(418));e=cr(n.nextSibling);var i=ns;e&&os(t,e)?as(i,n):(t.flags=-4097&t.flags|2,rs=!1,ns=t)}}else{if(ls(t))throw Error(s(418));t.flags=-4097&t.flags|2,rs=!1,ns=t}}}function us(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;ns=t}function hs(t){if(t!==ns)return!1;if(!rs)return us(t),rs=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!nr(t.type,t.memoizedProps)),e&&(e=is)){if(ls(t))throw ds(),Error(s(418));for(;e;)as(t,e),e=cr(e.nextSibling)}if(us(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(s(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){is=cr(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}is=null}}else is=ns?cr(t.stateNode.nextSibling):null;return!0}function ds(){for(var t=is;t;)t=cr(t.nextSibling)}function fs(){is=ns=null,rs=!1}function ps(t){null===ss?ss=[t]:ss.push(t)}var ms=b.ReactCurrentBatchConfig;function gs(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,t));var r=i,a=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===a?e.ref:(e=function(t){var e=r.refs;null===t?delete e[a]:e[a]=t},e._stringRef=a,e)}if("string"!==typeof t)throw Error(s(284));if(!n._owner)throw Error(s(290,t))}return t}function vs(t,e){throw t=Object.prototype.toString.call(e),Error(s(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ys(t){return(0,t._init)(t._payload)}function _s(t){function e(e,n){if(t){var i=e.deletions;null===i?(e.deletions=[n],e.flags|=16):i.push(n)}}function n(n,i){if(!t)return null;for(;null!==i;)e(n,i),i=i.sibling;return null}function i(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(t,e){return(t=Pc(t,e)).index=0,t.sibling=null,t}function a(e,n,i){return e.index=i,t?null!==(i=e.alternate)?(i=i.index)<n?(e.flags|=2,n):i:(e.flags|=2,n):(e.flags|=1048576,n)}function o(e){return t&&null===e.alternate&&(e.flags|=2),e}function l(t,e,n,i){return null===e||6!==e.tag?((e=Fc(n,t.mode,i)).return=t,e):((e=r(e,n)).return=t,e)}function c(t,e,n,i){var s=n.type;return s===w?h(t,e,n.props.children,i,n.key):null!==e&&(e.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===D&&ys(s)===e.type)?((i=r(e,n.props)).ref=gs(t,e,n),i.return=t,i):((i=Ic(n.type,n.key,n.props,null,t.mode,i)).ref=gs(t,e,n),i.return=t,i)}function u(t,e,n,i){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Uc(n,t.mode,i)).return=t,e):((e=r(e,n.children||[])).return=t,e)}function h(t,e,n,i,s){return null===e||7!==e.tag?((e=Oc(n,t.mode,i,s)).return=t,e):((e=r(e,n)).return=t,e)}function d(t,e,n){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Fc(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case x:return(n=Ic(e.type,e.key,e.props,null,t.mode,n)).ref=gs(t,null,e),n.return=t,n;case E:return(e=Uc(e,t.mode,n)).return=t,e;case D:return d(t,(0,e._init)(e._payload),n)}if(et(e)||O(e))return(e=Oc(e,t.mode,n,null)).return=t,e;vs(t,e)}return null}function f(t,e,n,i){var r=null!==e?e.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(t,e,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===r?c(t,e,n,i):null;case E:return n.key===r?u(t,e,n,i):null;case D:return f(t,e,(r=n._init)(n._payload),i)}if(et(n)||O(n))return null!==r?null:h(t,e,n,i,null);vs(t,n)}return null}function p(t,e,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(e,t=t.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case x:return c(e,t=t.get(null===i.key?n:i.key)||null,i,r);case E:return u(e,t=t.get(null===i.key?n:i.key)||null,i,r);case D:return p(t,e,n,(0,i._init)(i._payload),r)}if(et(i)||O(i))return h(e,t=t.get(n)||null,i,r,null);vs(e,i)}return null}function m(r,s,o,l){for(var c=null,u=null,h=s,m=s=0,g=null;null!==h&&m<o.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=f(r,h,o[m],l);if(null===v){null===h&&(h=g);break}t&&h&&null===v.alternate&&e(r,h),s=a(v,s,m),null===u?c=v:u.sibling=v,u=v,h=g}if(m===o.length)return n(r,h),rs&&Jr(r,m),c;if(null===h){for(;m<o.length;m++)null!==(h=d(r,o[m],l))&&(s=a(h,s,m),null===u?c=h:u.sibling=h,u=h);return rs&&Jr(r,m),c}for(h=i(r,h);m<o.length;m++)null!==(g=p(h,r,m,o[m],l))&&(t&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=a(g,s,m),null===u?c=g:u.sibling=g,u=g);return t&&h.forEach(function(t){return e(r,t)}),rs&&Jr(r,m),c}function g(r,o,l,c){var u=O(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,m=o,g=o=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var _=f(r,m,y.value,c);if(null===_){null===m&&(m=v);break}t&&m&&null===_.alternate&&e(r,m),o=a(_,o,g),null===h?u=_:h.sibling=_,h=_,m=v}if(y.done)return n(r,m),rs&&Jr(r,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(r,y.value,c))&&(o=a(y,o,g),null===h?u=y:h.sibling=y,h=y);return rs&&Jr(r,g),u}for(m=i(r,m);!y.done;g++,y=l.next())null!==(y=p(m,r,g,y.value,c))&&(t&&null!==y.alternate&&m.delete(null===y.key?g:y.key),o=a(y,o,g),null===h?u=y:h.sibling=y,h=y);return t&&m.forEach(function(t){return e(r,t)}),rs&&Jr(r,g),u}return function t(i,s,a,l){if("object"===typeof a&&null!==a&&a.type===w&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case x:t:{for(var c=a.key,u=s;null!==u;){if(u.key===c){if((c=a.type)===w){if(7===u.tag){n(i,u.sibling),(s=r(u,a.props.children)).return=i,i=s;break t}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&ys(c)===u.type){n(i,u.sibling),(s=r(u,a.props)).ref=gs(i,u,a),s.return=i,i=s;break t}n(i,u);break}e(i,u),u=u.sibling}a.type===w?((s=Oc(a.props.children,i.mode,l,a.key)).return=i,i=s):((l=Ic(a.type,a.key,a.props,null,i.mode,l)).ref=gs(i,s,a),l.return=i,i=l)}return o(i);case E:t:{for(u=a.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(i,s.sibling),(s=r(s,a.children||[])).return=i,i=s;break t}n(i,s);break}e(i,s),s=s.sibling}(s=Uc(a,i.mode,l)).return=i,i=s}return o(i);case D:return t(i,s,(u=a._init)(a._payload),l)}if(et(a))return m(i,s,a,l);if(O(a))return g(i,s,a,l);vs(i,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,a)).return=i,i=s):(n(i,s),(s=Fc(a,i.mode,l)).return=i,i=s),o(i)):n(i,s)}}var bs=_s(!0),xs=_s(!1),Es=Sr(null),ws=null,Ss=null,Ts=null;function Ms(){Ts=Ss=ws=null}function As(t){var e=Es.current;Tr(Es),t._currentValue=e}function Cs(t,e,n){for(;null!==t;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==i&&(i.childLanes|=e)):null!==i&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function Rs(t,e){ws=t,Ts=Ss=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(_o=!0),t.firstContext=null)}function ks(t){var e=t._currentValue;if(Ts!==t)if(t={context:t,memoizedValue:e,next:null},null===Ss){if(null===ws)throw Error(s(308));Ss=t,ws.dependencies={lanes:0,firstContext:t}}else Ss=Ss.next=t;return e}var Ls=null;function Ds(t){null===Ls?Ls=[t]:Ls.push(t)}function Ps(t,e,n,i){var r=e.interleaved;return null===r?(n.next=n,Ds(e)):(n.next=r.next,r.next=n),e.interleaved=n,Is(t,i)}function Is(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}var Os=!1;function Ns(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fs(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Us(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Bs(t,e,n){var i=t.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Cl)){var r=i.pending;return null===r?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Is(t,n)}return null===(r=i.interleaved)?(e.next=e,Ds(i)):(e.next=r.next,r.next=e),i.interleaved=e,Is(t,n)}function zs(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&n))){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ye(t,n)}}function Hs(t,e){var n=t.updateQueue,i=t.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?r=s=e:s=s.next=e}else r=s=e;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Vs(t,e,n,i){var r=t.updateQueue;Os=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?s=c:a.next=c,a=l;var u=t.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=r.baseState;for(a=0,u=c=l=null,o=s;;){var d=o.lane,f=o.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});t:{var p=t,m=o;switch(d=e,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,d);break t}h=p;break t;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(f,h,d):p)||void 0===d)break t;h=F({},h,d);break t;case 2:Os=!0}}null!==o.callback&&0!==o.lane&&(t.flags|=64,null===(d=r.effects)?r.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,a|=d;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(d=o).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(e=r.shared.interleaved)){r=e;do{a|=r.lane,r=r.next}while(r!==e)}else null===s&&(r.shared.lanes=0);Nl|=a,t.lanes=a,t.memoizedState=h}}function Gs(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var js={},Ws=Sr(js),Ys=Sr(js),Xs=Sr(js);function Ks(t){if(t===js)throw Error(s(174));return t}function qs(t,e){switch(Mr(Xs,e),Mr(Ys,t),Mr(Ws,js),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lt(null,"");break;default:e=lt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Tr(Ws),Mr(Ws,e)}function Qs(){Tr(Ws),Tr(Ys),Tr(Xs)}function Zs(t){Ks(Xs.current);var e=Ks(Ws.current),n=lt(e,t.type);e!==n&&(Mr(Ys,t),Mr(Ws,n))}function Js(t){Ys.current===t&&(Tr(Ws),Tr(Ys))}var $s=Sr(0);function ta(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ea=[];function na(){for(var t=0;t<ea.length;t++)ea[t]._workInProgressVersionPrimary=null;ea.length=0}var ia=b.ReactCurrentDispatcher,ra=b.ReactCurrentBatchConfig,sa=0,aa=null,oa=null,la=null,ca=!1,ua=!1,ha=0,da=0;function fa(){throw Error(s(321))}function pa(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!oi(t[n],e[n]))return!1;return!0}function ma(t,e,n,i,r,a){if(sa=a,aa=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ia.current=null===t||null===t.memoizedState?Ja:$a,t=n(i,r),ua){a=0;do{if(ua=!1,ha=0,25<=a)throw Error(s(301));a+=1,la=oa=null,e.updateQueue=null,ia.current=to,t=n(i,r)}while(ua)}if(ia.current=Za,e=null!==oa&&null!==oa.next,sa=0,la=oa=aa=null,ca=!1,e)throw Error(s(300));return t}function ga(){var t=0!==ha;return ha=0,t}function va(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?aa.memoizedState=la=t:la=la.next=t,la}function ya(){if(null===oa){var t=aa.alternate;t=null!==t?t.memoizedState:null}else t=oa.next;var e=null===la?aa.memoizedState:la.next;if(null!==e)la=e,oa=t;else{if(null===t)throw Error(s(310));t={memoizedState:(oa=t).memoizedState,baseState:oa.baseState,baseQueue:oa.baseQueue,queue:oa.queue,next:null},null===la?aa.memoizedState=la=t:la=la.next=t}return la}function _a(t,e){return"function"===typeof e?e(t):e}function ba(t){var e=ya(),n=e.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=t;var i=oa,r=i.baseQueue,a=n.pending;if(null!==a){if(null!==r){var o=r.next;r.next=a.next,a.next=o}i.baseQueue=r=a,n.pending=null}if(null!==r){a=r.next,i=i.baseState;var l=o=null,c=null,u=a;do{var h=u.lane;if((sa&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:t(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,o=i):c=c.next=d,aa.lanes|=h,Nl|=h}u=u.next}while(null!==u&&u!==a);null===c?o=i:c.next=l,oi(i,e.memoizedState)||(_o=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=c,n.lastRenderedState=i}if(null!==(t=n.interleaved)){r=t;do{a=r.lane,aa.lanes|=a,Nl|=a,r=r.next}while(r!==t)}else null===r&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function xa(t){var e=ya(),n=e.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,a=e.memoizedState;if(null!==r){n.pending=null;var o=r=r.next;do{a=t(a,o.action),o=o.next}while(o!==r);oi(a,e.memoizedState)||(_o=!0),e.memoizedState=a,null===e.baseQueue&&(e.baseState=a),n.lastRenderedState=a}return[a,i]}function Ea(){}function wa(t,e){var n=aa,i=ya(),r=e(),a=!oi(i.memoizedState,r);if(a&&(i.memoizedState=r,_o=!0),i=i.queue,Oa(Ma.bind(null,n,i,t),[t]),i.getSnapshot!==e||a||null!==la&&1&la.memoizedState.tag){if(n.flags|=2048,ka(9,Ta.bind(null,n,i,r,e),void 0,null),null===Rl)throw Error(s(349));0!==(30&sa)||Sa(n,e,r)}return r}function Sa(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=aa.updateQueue)?(e={lastEffect:null,stores:null},aa.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function Ta(t,e,n,i){e.value=n,e.getSnapshot=i,Aa(e)&&Ca(t)}function Ma(t,e,n){return n(function(){Aa(e)&&Ca(t)})}function Aa(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!oi(t,n)}catch(i){return!0}}function Ca(t){var e=Is(t,1);null!==e&&nc(e,t,1,-1)}function Ra(t){var e=va();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_a,lastRenderedState:t},e.queue=t,t=t.dispatch=Xa.bind(null,aa,t),[e.memoizedState,t]}function ka(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},null===(e=aa.updateQueue)?(e={lastEffect:null,stores:null},aa.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function La(){return ya().memoizedState}function Da(t,e,n,i){var r=va();aa.flags|=t,r.memoizedState=ka(1|e,n,void 0,void 0===i?null:i)}function Pa(t,e,n,i){var r=ya();i=void 0===i?null:i;var s=void 0;if(null!==oa){var a=oa.memoizedState;if(s=a.destroy,null!==i&&pa(i,a.deps))return void(r.memoizedState=ka(e,n,s,i))}aa.flags|=t,r.memoizedState=ka(1|e,n,s,i)}function Ia(t,e){return Da(8390656,8,t,e)}function Oa(t,e){return Pa(2048,8,t,e)}function Na(t,e){return Pa(4,2,t,e)}function Fa(t,e){return Pa(4,4,t,e)}function Ua(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Ba(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Pa(4,4,Ua.bind(null,e,t),n)}function za(){}function Ha(t,e){var n=ya();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&pa(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function Va(t,e){var n=ya();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&pa(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function Ga(t,e,n){return 0===(21&sa)?(t.baseState&&(t.baseState=!1,_o=!0),t.memoizedState=n):(oi(n,e)||(n=me(),aa.lanes|=n,Nl|=n,t.baseState=!0),e)}function ja(t,e){var n=_e;_e=0!==n&&4>n?n:4,t(!0);var i=ra.transition;ra.transition={};try{t(!1),e()}finally{_e=n,ra.transition=i}}function Wa(){return ya().memoizedState}function Ya(t,e,n){var i=ec(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Ka(t))qa(e,n);else if(null!==(n=Ps(t,e,n,i))){nc(n,t,i,tc()),Qa(n,e,i)}}function Xa(t,e,n){var i=ec(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ka(t))qa(e,r);else{var s=t.alternate;if(0===t.lanes&&(null===s||0===s.lanes)&&null!==(s=e.lastRenderedReducer))try{var a=e.lastRenderedState,o=s(a,n);if(r.hasEagerState=!0,r.eagerState=o,oi(o,a)){var l=e.interleaved;return null===l?(r.next=r,Ds(e)):(r.next=l.next,l.next=r),void(e.interleaved=r)}}catch(c){}null!==(n=Ps(t,e,r,i))&&(nc(n,t,i,r=tc()),Qa(n,e,i))}}function Ka(t){var e=t.alternate;return t===aa||null!==e&&e===aa}function qa(t,e){ua=ca=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Qa(t,e,n){if(0!==(4194240&n)){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ye(t,n)}}var Za={readContext:ks,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},Ja={readContext:ks,useCallback:function(t,e){return va().memoizedState=[t,void 0===e?null:e],t},useContext:ks,useEffect:Ia,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Da(4194308,4,Ua.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Da(4194308,4,t,e)},useInsertionEffect:function(t,e){return Da(4,2,t,e)},useMemo:function(t,e){var n=va();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=va();return e=void 0!==n?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=Ya.bind(null,aa,t),[i.memoizedState,t]},useRef:function(t){return t={current:t},va().memoizedState=t},useState:Ra,useDebugValue:za,useDeferredValue:function(t){return va().memoizedState=t},useTransition:function(){var t=Ra(!1),e=t[0];return t=ja.bind(null,t[1]),va().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=aa,r=va();if(rs){if(void 0===n)throw Error(s(407));n=n()}else{if(n=e(),null===Rl)throw Error(s(349));0!==(30&sa)||Sa(i,e,n)}r.memoizedState=n;var a={value:n,getSnapshot:e};return r.queue=a,Ia(Ma.bind(null,i,a,t),[t]),i.flags|=2048,ka(9,Ta.bind(null,i,a,n,e),void 0,null),n},useId:function(){var t=va(),e=Rl.identifierPrefix;if(rs){var n=Zr;e=":"+e+"R"+(n=(Qr&~(1<<32-ae(Qr)-1)).toString(32)+n),0<(n=ha++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=da++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},$a={readContext:ks,useCallback:Ha,useContext:ks,useEffect:Oa,useImperativeHandle:Ba,useInsertionEffect:Na,useLayoutEffect:Fa,useMemo:Va,useReducer:ba,useRef:La,useState:function(){return ba(_a)},useDebugValue:za,useDeferredValue:function(t){return Ga(ya(),oa.memoizedState,t)},useTransition:function(){return[ba(_a)[0],ya().memoizedState]},useMutableSource:Ea,useSyncExternalStore:wa,useId:Wa,unstable_isNewReconciler:!1},to={readContext:ks,useCallback:Ha,useContext:ks,useEffect:Oa,useImperativeHandle:Ba,useInsertionEffect:Na,useLayoutEffect:Fa,useMemo:Va,useReducer:xa,useRef:La,useState:function(){return xa(_a)},useDebugValue:za,useDeferredValue:function(t){var e=ya();return null===oa?e.memoizedState=t:Ga(e,oa.memoizedState,t)},useTransition:function(){return[xa(_a)[0],ya().memoizedState]},useMutableSource:Ea,useSyncExternalStore:wa,useId:Wa,unstable_isNewReconciler:!1};function eo(t,e){if(t&&t.defaultProps){for(var n in e=F({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}function no(t,e,n,i){n=null===(n=n(i,e=t.memoizedState))||void 0===n?e:F({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var io={isMounted:function(t){return!!(t=t._reactInternals)&&Vt(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=tc(),r=ec(t),s=Us(i,r);s.payload=e,void 0!==n&&null!==n&&(s.callback=n),null!==(e=Bs(t,s,r))&&(nc(e,t,r,i),zs(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=tc(),r=ec(t),s=Us(i,r);s.tag=1,s.payload=e,void 0!==n&&null!==n&&(s.callback=n),null!==(e=Bs(t,s,r))&&(nc(e,t,r,i),zs(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=tc(),i=ec(t),r=Us(n,i);r.tag=2,void 0!==e&&null!==e&&(r.callback=e),null!==(e=Bs(t,r,i))&&(nc(e,t,i,n),zs(e,t,i))}};function ro(t,e,n,i,r,s,a){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(i,s,a):!e.prototype||!e.prototype.isPureReactComponent||(!li(n,i)||!li(r,s))}function so(t,e,n){var i=!1,r=Ar,s=e.contextType;return"object"===typeof s&&null!==s?s=ks(s):(r=Dr(e)?kr:Cr.current,s=(i=null!==(i=e.contextTypes)&&void 0!==i)?Lr(t,r):Ar),e=new e(n,s),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=io,t.stateNode=e,e._reactInternals=t,i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function ao(t,e,n,i){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,i),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&io.enqueueReplaceState(e,e.state,null)}function oo(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},Ns(t);var s=e.contextType;"object"===typeof s&&null!==s?r.context=ks(s):(s=Dr(e)?kr:Cr.current,r.context=Lr(t,s)),r.state=t.memoizedState,"function"===typeof(s=e.getDerivedStateFromProps)&&(no(t,e,s,n),r.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(e=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),e!==r.state&&io.enqueueReplaceState(r,r.state,null),Vs(t,n,r,i),r.state=t.memoizedState),"function"===typeof r.componentDidMount&&(t.flags|=4194308)}function lo(t,e){try{var n="",i=e;do{n+=H(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:t,source:e,stack:r,digest:null}}function co(t,e,n){return{value:t,source:null,stack:null!=n?n:null,digest:null!=e?e:null}}function uo(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ho="function"===typeof WeakMap?WeakMap:Map;function fo(t,e,n){(n=Us(-1,n)).tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){jl||(jl=!0,Wl=i),uo(0,e)},n}function po(t,e,n){(n=Us(-1,n)).tag=3;var i=t.type.getDerivedStateFromError;if("function"===typeof i){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){uo(0,e)}}var s=t.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){uo(0,e),"function"!==typeof i&&(null===Yl?Yl=new Set([this]):Yl.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function mo(t,e,n){var i=t.pingCache;if(null===i){i=t.pingCache=new ho;var r=new Set;i.set(e,r)}else void 0===(r=i.get(e))&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=Tc.bind(null,t,e,n),e.then(t,t))}function go(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function vo(t,e,n,i,r){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=Us(-1,1)).tag=2,Bs(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=r,t)}var yo=b.ReactCurrentOwner,_o=!1;function bo(t,e,n,i){e.child=null===t?xs(e,null,n,i):bs(e,t.child,n,i)}function xo(t,e,n,i,r){n=n.render;var s=e.ref;return Rs(e,r),i=ma(t,e,n,i,s,r),n=ga(),null===t||_o?(rs&&n&&ts(e),e.flags|=1,bo(t,e,i,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,jo(t,e,r))}function Eo(t,e,n,i,r){if(null===t){var s=n.type;return"function"!==typeof s||Dc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Ic(n.type,null,i,e,e.mode,r)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=s,wo(t,e,s,i,r))}if(s=t.child,0===(t.lanes&r)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:li)(a,i)&&t.ref===e.ref)return jo(t,e,r)}return e.flags|=1,(t=Pc(s,i)).ref=e.ref,t.return=e,e.child=t}function wo(t,e,n,i,r){if(null!==t){var s=t.memoizedProps;if(li(s,i)&&t.ref===e.ref){if(_o=!1,e.pendingProps=i=s,0===(t.lanes&r))return e.lanes=t.lanes,jo(t,e,r);0!==(131072&t.flags)&&(_o=!0)}}return Mo(t,e,n,i,r)}function So(t,e,n){var i=e.pendingProps,r=i.children,s=null!==t?t.memoizedState:null;if("hidden"===i.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mr(Pl,Dl),Dl|=n;else{if(0===(1073741824&n))return t=null!==s?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Mr(Pl,Dl),Dl|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,Mr(Pl,Dl),Dl|=i}else null!==s?(i=s.baseLanes|n,e.memoizedState=null):i=n,Mr(Pl,Dl),Dl|=i;return bo(t,e,r,n),e.child}function To(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Mo(t,e,n,i,r){var s=Dr(n)?kr:Cr.current;return s=Lr(e,s),Rs(e,r),n=ma(t,e,n,i,s,r),i=ga(),null===t||_o?(rs&&i&&ts(e),e.flags|=1,bo(t,e,n,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,jo(t,e,r))}function Ao(t,e,n,i,r){if(Dr(n)){var s=!0;Nr(e)}else s=!1;if(Rs(e,r),null===e.stateNode)Go(t,e),so(e,n,i),oo(e,n,i,r),i=!0;else if(null===t){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=ks(c):c=Lr(e,c=Dr(n)?kr:Cr.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==i||l!==c)&&ao(e,a,i,c),Os=!1;var d=e.memoizedState;a.state=d,Vs(e,i,a,r),l=e.memoizedState,o!==i||d!==l||Rr.current||Os?("function"===typeof u&&(no(e,n,u,i),l=e.memoizedState),(o=Os||ro(e,n,o,i,d,l,c))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(e.flags|=4194308)):("function"===typeof a.componentDidMount&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),a.props=i,a.state=l,a.context=c,i=o):("function"===typeof a.componentDidMount&&(e.flags|=4194308),i=!1)}else{a=e.stateNode,Fs(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:eo(e.type,o),a.props=c,h=e.pendingProps,d=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=ks(l):l=Lr(e,l=Dr(n)?kr:Cr.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==h||d!==l)&&ao(e,a,i,l),Os=!1,d=e.memoizedState,a.state=d,Vs(e,i,a,r);var p=e.memoizedState;o!==h||d!==p||Rr.current||Os?("function"===typeof f&&(no(e,n,f,i),p=e.memoizedState),(c=Os||ro(e,n,c,i,d,p,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(i,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(i,p,l)),"function"===typeof a.componentDidUpdate&&(e.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=p),a.props=i,a.state=p,a.context=l,i=c):("function"!==typeof a.componentDidUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),i=!1)}return Co(t,e,n,i,s,r)}function Co(t,e,n,i,r,s){To(t,e);var a=0!==(128&e.flags);if(!i&&!a)return r&&Fr(e,n,!1),jo(t,e,s);i=e.stateNode,yo.current=e;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return e.flags|=1,null!==t&&a?(e.child=bs(e,t.child,null,s),e.child=bs(e,null,o,s)):bo(t,e,o,s),e.memoizedState=i.state,r&&Fr(e,n,!0),e.child}function Ro(t){var e=t.stateNode;e.pendingContext?Ir(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Ir(0,e.context,!1),qs(t,e.containerInfo)}function ko(t,e,n,i,r){return fs(),ps(r),e.flags|=256,bo(t,e,n,i),e.child}var Lo,Do,Po,Io,Oo={dehydrated:null,treeContext:null,retryLane:0};function No(t){return{baseLanes:t,cachePool:null,transitions:null}}function Fo(t,e,n){var i,r=e.pendingProps,a=$s.current,o=!1,l=0!==(128&e.flags);if((i=l)||(i=(null===t||null!==t.memoizedState)&&0!==(2&a)),i?(o=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(a|=1),Mr($s,1&a),null===t)return cs(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(l=r.children,t=r.fallback,o?(r=e.mode,o=e.child,l={mode:"hidden",children:l},0===(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Nc(l,r,0,null),t=Oc(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=No(n),e.memoizedState=Oo,t):Uo(e,l));if(null!==(a=t.memoizedState)&&null!==(i=a.dehydrated))return function(t,e,n,i,r,a,o){if(n)return 256&e.flags?(e.flags&=-257,Bo(t,e,o,i=co(Error(s(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(a=i.fallback,r=e.mode,i=Nc({mode:"visible",children:i.children},r,0,null),(a=Oc(a,r,o,null)).flags|=2,i.return=e,a.return=e,i.sibling=a,e.child=i,0!==(1&e.mode)&&bs(e,t.child,null,o),e.child.memoizedState=No(o),e.memoizedState=Oo,a);if(0===(1&e.mode))return Bo(t,e,o,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Bo(t,e,o,i=co(a=Error(s(419)),i,void 0))}if(l=0!==(o&t.childLanes),_o||l){if(null!==(i=Rl)){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|o))?0:r)&&r!==a.retryLane&&(a.retryLane=r,Is(t,r),nc(i,t,r,-1))}return mc(),Bo(t,e,o,i=co(Error(s(421))))}return"$?"===r.data?(e.flags|=128,e.child=t.child,e=Ac.bind(null,t),r._reactRetry=e,null):(t=a.treeContext,is=cr(r.nextSibling),ns=e,rs=!0,ss=null,null!==t&&(Xr[Kr++]=Qr,Xr[Kr++]=Zr,Xr[Kr++]=qr,Qr=t.id,Zr=t.overflow,qr=e),e=Uo(e,i.children),e.flags|=4096,e)}(t,e,l,r,i,a,n);if(o){o=r.fallback,l=e.mode,i=(a=t.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&e.child!==a?((r=e.child).childLanes=0,r.pendingProps=c,e.deletions=null):(r=Pc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==i?o=Pc(i,o):(o=Oc(o,l,n,null)).flags|=2,o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,l=null===(l=t.child.memoizedState)?No(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=t.childLanes&~n,e.memoizedState=Oo,r}return t=(o=t.child).sibling,r=Pc(o,{mode:"visible",children:r.children}),0===(1&e.mode)&&(r.lanes=n),r.return=e,r.sibling=null,null!==t&&(null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Uo(t,e){return(e=Nc({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Bo(t,e,n,i){return null!==i&&ps(i),bs(e,t.child,null,n),(t=Uo(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function zo(t,e,n){t.lanes|=e;var i=t.alternate;null!==i&&(i.lanes|=e),Cs(t.return,e,n)}function Ho(t,e,n,i,r){var s=t.memoizedState;null===s?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function Vo(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(bo(t,e,i.children,n),0!==(2&(i=$s.current)))i=1&i|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&zo(t,n,e);else if(19===t.tag)zo(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Mr($s,i),0===(1&e.mode))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;null!==n;)null!==(t=n.alternate)&&null===ta(t)&&(r=n),n=n.sibling;null===(n=r)?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Ho(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;null!==r;){if(null!==(t=r.alternate)&&null===ta(t)){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Ho(e,!0,n,null,s);break;case"together":Ho(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Go(t,e){0===(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function jo(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Nl|=e.lanes,0===(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(s(153));if(null!==e.child){for(n=Pc(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Pc(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Wo(t,e){if(!rs)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?e||null===t.tail?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Yo(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=t,r=r.sibling;else for(r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function Xo(t,e,n){var i=e.pendingProps;switch(es(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yo(e),null;case 1:case 17:return Dr(e.type)&&Pr(),Yo(e),null;case 3:return i=e.stateNode,Qs(),Tr(Rr),Tr(Cr),na(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==t&&null!==t.child||(hs(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==ss&&(ac(ss),ss=null))),Do(t,e),Yo(e),null;case 5:Js(e);var r=Ks(Xs.current);if(n=e.type,null!==t&&null!=e.stateNode)Po(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(null===e.stateNode)throw Error(s(166));return Yo(e),null}if(t=Ks(Ws.current),hs(e)){i=e.stateNode,n=e.type;var a=e.memoizedProps;switch(i[dr]=e,i[fr]=a,t=0!==(1&e.mode),n){case"dialog":Bi("cancel",i),Bi("close",i);break;case"iframe":case"object":case"embed":Bi("load",i);break;case"video":case"audio":for(r=0;r<Oi.length;r++)Bi(Oi[r],i);break;case"source":Bi("error",i);break;case"img":case"image":case"link":Bi("error",i),Bi("load",i);break;case"details":Bi("toggle",i);break;case"input":Q(i,a),Bi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},Bi("invalid",i);break;case"textarea":rt(i,a),Bi("invalid",i)}for(var l in yt(n,a),r=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==a.suppressHydrationWarning&&Ji(i.textContent,c,t),r=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Ji(i.textContent,c,t),r=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Bi("scroll",i)}switch(n){case"input":Y(i),$(i,a,!0);break;case"textarea":Y(i),at(i);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(i.onclick=$i)}i=r,e.updateQueue=i,null!==i&&(e.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=ot(n)),"http://www.w3.org/1999/xhtml"===t?"script"===n?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof i.is?t=l.createElement(n,{is:i.is}):(t=l.createElement(n),"select"===n&&(l=t,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):t=l.createElementNS(t,n),t[dr]=e,t[fr]=i,Lo(t,e,!1,!1),e.stateNode=t;t:{switch(l=_t(n,i),n){case"dialog":Bi("cancel",t),Bi("close",t),r=i;break;case"iframe":case"object":case"embed":Bi("load",t),r=i;break;case"video":case"audio":for(r=0;r<Oi.length;r++)Bi(Oi[r],t);r=i;break;case"source":Bi("error",t),r=i;break;case"img":case"image":case"link":Bi("error",t),Bi("load",t),r=i;break;case"details":Bi("toggle",t),r=i;break;case"input":Q(t,i),r=q(t,i),Bi("invalid",t);break;case"option":default:r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=F({},i,{value:void 0}),Bi("invalid",t);break;case"textarea":rt(t,i),r=it(t,i),Bi("invalid",t)}for(a in yt(n,r),c=r)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?gt(t,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&ht(t,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&dt(t,u):"number"===typeof u&&dt(t,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Bi("scroll",t):null!=u&&_(t,a,u,l))}switch(n){case"input":Y(t),$(t,i,!1);break;case"textarea":Y(t),at(t);break;case"option":null!=i.value&&t.setAttribute("value",""+j(i.value));break;case"select":t.multiple=!!i.multiple,null!=(a=i.value)?nt(t,!!i.multiple,a,!1):null!=i.defaultValue&&nt(t,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(t.onclick=$i)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break t;case"img":i=!0;break t;default:i=!1}}i&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return Yo(e),null;case 6:if(t&&null!=e.stateNode)Io(t,e,t.memoizedProps,i);else{if("string"!==typeof i&&null===e.stateNode)throw Error(s(166));if(n=Ks(Xs.current),Ks(Ws.current),hs(e)){if(i=e.stateNode,n=e.memoizedProps,i[dr]=e,(a=i.nodeValue!==n)&&null!==(t=ns))switch(t.tag){case 3:Ji(i.nodeValue,n,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Ji(i.nodeValue,n,0!==(1&t.mode))}a&&(e.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[dr]=e,e.stateNode=i}return Yo(e),null;case 13:if(Tr($s),i=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(rs&&null!==is&&0!==(1&e.mode)&&0===(128&e.flags))ds(),fs(),e.flags|=98560,a=!1;else if(a=hs(e),null!==i&&null!==i.dehydrated){if(null===t){if(!a)throw Error(s(318));if(!(a=null!==(a=e.memoizedState)?a.dehydrated:null))throw Error(s(317));a[dr]=e}else fs(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;Yo(e),a=!1}else null!==ss&&(ac(ss),ss=null),a=!0;if(!a)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=n,e):((i=null!==i)!==(null!==t&&null!==t.memoizedState)&&i&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&$s.current)?0===Il&&(Il=3):mc())),null!==e.updateQueue&&(e.flags|=4),Yo(e),null);case 4:return Qs(),Do(t,e),null===t&&Vi(e.stateNode.containerInfo),Yo(e),null;case 10:return As(e.type._context),Yo(e),null;case 19:if(Tr($s),null===(a=e.memoizedState))return Yo(e),null;if(i=0!==(128&e.flags),null===(l=a.rendering))if(i)Wo(a,!1);else{if(0!==Il||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(l=ta(t))){for(e.flags|=128,Wo(a,!1),null!==(i=l.updateQueue)&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;null!==n;)t=i,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,t=l.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Mr($s,1&$s.current|2),e.child}t=t.sibling}null!==a.tail&&Zt()>Vl&&(e.flags|=128,i=!0,Wo(a,!1),e.lanes=4194304)}else{if(!i)if(null!==(t=ta(l))){if(e.flags|=128,i=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),Wo(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!rs)return Yo(e),null}else 2*Zt()-a.renderingStartTime>Vl&&1073741824!==n&&(e.flags|=128,i=!0,Wo(a,!1),e.lanes=4194304);a.isBackwards?(l.sibling=e.child,e.child=l):(null!==(n=a.last)?n.sibling=l:e.child=l,a.last=l)}return null!==a.tail?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Zt(),e.sibling=null,n=$s.current,Mr($s,i?1&n|2:1&n),e):(Yo(e),null);case 22:case 23:return hc(),i=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==i&&(e.flags|=8192),i&&0!==(1&e.mode)?0!==(1073741824&Dl)&&(Yo(e),6&e.subtreeFlags&&(e.flags|=8192)):Yo(e),null;case 24:case 25:return null}throw Error(s(156,e.tag))}function Ko(t,e){switch(es(e),e.tag){case 1:return Dr(e.type)&&Pr(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return Qs(),Tr(Rr),Tr(Cr),na(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return Js(e),null;case 13:if(Tr($s),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(s(340));fs()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Tr($s),null;case 4:return Qs(),null;case 10:return As(e.type._context),null;case 22:case 23:return hc(),null;default:return null}}Lo=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Do=function(){},Po=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Ks(Ws.current);var s,a=null;switch(n){case"input":r=q(t,r),i=q(t,i),a=[];break;case"select":r=F({},r,{value:void 0}),i=F({},i,{value:void 0}),a=[];break;case"textarea":r=it(t,r),i=it(t,i),a=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(t.onclick=$i)}for(u in yt(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Bi("scroll",t),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(e.updateQueue=u)&&(e.flags|=4)}},Io=function(t,e,n,i){n!==i&&(e.flags|=4)};var qo=!1,Qo=!1,Zo="function"===typeof WeakSet?WeakSet:Set,Jo=null;function $o(t,e){var n=t.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Sc(t,e,i)}else n.current=null}function tl(t,e,n){try{n()}catch(i){Sc(t,e,i)}}var el=!1;function nl(t,e,n){var i=e.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,void 0!==s&&tl(e,n,s)}r=r.next}while(r!==i)}}function il(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function rl(t){var e=t.ref;if(null!==e){var n=t.stateNode;t.tag,t=n,"function"===typeof e?e(t):e.current=t}}function sl(t){var e=t.alternate;null!==e&&(t.alternate=null,sl(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[dr],delete e[fr],delete e[mr],delete e[gr],delete e[vr])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function al(t){return 5===t.tag||3===t.tag||4===t.tag}function ol(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||al(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function ll(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=$i));else if(4!==i&&null!==(t=t.child))for(ll(t,e,n),t=t.sibling;null!==t;)ll(t,e,n),t=t.sibling}function cl(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==i&&null!==(t=t.child))for(cl(t,e,n),t=t.sibling;null!==t;)cl(t,e,n),t=t.sibling}var ul=null,hl=!1;function dl(t,e,n){for(n=n.child;null!==n;)fl(t,e,n),n=n.sibling}function fl(t,e,n){if(se&&"function"===typeof se.onCommitFiberUnmount)try{se.onCommitFiberUnmount(re,n)}catch(o){}switch(n.tag){case 5:Qo||$o(n,e);case 6:var i=ul,r=hl;ul=null,dl(t,e,n),hl=r,null!==(ul=i)&&(hl?(t=ul,n=n.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(t=ul,n=n.stateNode,8===t.nodeType?lr(t.parentNode,n):1===t.nodeType&&lr(t,n),Ve(t)):lr(ul,n.stateNode));break;case 4:i=ul,r=hl,ul=n.stateNode.containerInfo,hl=!0,dl(t,e,n),ul=i,hl=r;break;case 0:case 11:case 14:case 15:if(!Qo&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var s=r,a=s.destroy;s=s.tag,void 0!==a&&(0!==(2&s)||0!==(4&s))&&tl(n,e,a),r=r.next}while(r!==i)}dl(t,e,n);break;case 1:if(!Qo&&($o(n,e),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(o){Sc(n,e,o)}dl(t,e,n);break;case 21:dl(t,e,n);break;case 22:1&n.mode?(Qo=(i=Qo)||null!==n.memoizedState,dl(t,e,n),Qo=i):dl(t,e,n);break;default:dl(t,e,n)}}function pl(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Zo),e.forEach(function(e){var i=Cc.bind(null,t,e);n.has(e)||(n.add(e),e.then(i,i))})}}function ml(t,e){var n=e.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var a=t,o=e,l=o;t:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break t;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break t}l=l.return}if(null===ul)throw Error(s(160));fl(a,o,r),ul=null,hl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(u){Sc(r,e,u)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)gl(e,t),e=e.sibling}function gl(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ml(e,t),vl(t),4&i){try{nl(3,t,t.return),il(3,t)}catch(g){Sc(t,t.return,g)}try{nl(5,t,t.return)}catch(g){Sc(t,t.return,g)}}break;case 1:ml(e,t),vl(t),512&i&&null!==n&&$o(n,n.return);break;case 5:if(ml(e,t),vl(t),512&i&&null!==n&&$o(n,n.return),32&t.flags){var r=t.stateNode;try{dt(r,"")}catch(g){Sc(t,t.return,g)}}if(4&i&&null!=(r=t.stateNode)){var a=t.memoizedProps,o=null!==n?n.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&Z(r,a),_t(l,o);var u=_t(l,a);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];"style"===h?gt(r,d):"dangerouslySetInnerHTML"===h?ht(r,d):"children"===h?dt(r,d):_(r,h,d,u)}switch(l){case"input":J(r,a);break;case"textarea":st(r,a);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?nt(r,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?nt(r,!!a.multiple,a.defaultValue,!0):nt(r,!!a.multiple,a.multiple?[]:"",!1))}r[fr]=a}catch(g){Sc(t,t.return,g)}}break;case 6:if(ml(e,t),vl(t),4&i){if(null===t.stateNode)throw Error(s(162));r=t.stateNode,a=t.memoizedProps;try{r.nodeValue=a}catch(g){Sc(t,t.return,g)}}break;case 3:if(ml(e,t),vl(t),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Ve(e.containerInfo)}catch(g){Sc(t,t.return,g)}break;case 4:default:ml(e,t),vl(t);break;case 13:ml(e,t),vl(t),8192&(r=t.child).flags&&(a=null!==r.memoizedState,r.stateNode.isHidden=a,!a||null!==r.alternate&&null!==r.alternate.memoizedState||(Hl=Zt())),4&i&&pl(t);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&t.mode?(Qo=(u=Qo)||h,ml(e,t),Qo=u):ml(e,t),vl(t),8192&i){if(u=null!==t.memoizedState,(t.stateNode.isHidden=u)&&!h&&0!==(1&t.mode))for(Jo=t,h=t.child;null!==h;){for(d=Jo=h;null!==Jo;){switch(p=(f=Jo).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:$o(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){i=f,n=f.return;try{e=i,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){Sc(i,n,g)}}break;case 5:$o(f,f.return);break;case 22:if(null!==f.memoizedState){xl(d);continue}}null!==p?(p.return=f,Jo=p):xl(d)}h=h.sibling}t:for(h=null,d=t;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,u?"function"===typeof(a=r.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=d.stateNode,o=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=mt("display",o))}catch(g){Sc(t,t.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Sc(t,t.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(e,t),vl(t),4&i&&pl(t);case 21:}}function vl(t){var e=t.flags;if(2&e){try{t:{for(var n=t.return;null!==n;){if(al(n)){var i=n;break t}n=n.return}throw Error(s(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(dt(r,""),i.flags&=-33),cl(t,ol(t),r);break;case 3:case 4:var a=i.stateNode.containerInfo;ll(t,ol(t),a);break;default:throw Error(s(161))}}catch(o){Sc(t,t.return,o)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function yl(t,e,n){Jo=t,_l(t,e,n)}function _l(t,e,n){for(var i=0!==(1&t.mode);null!==Jo;){var r=Jo,s=r.child;if(22===r.tag&&i){var a=null!==r.memoizedState||qo;if(!a){var o=r.alternate,l=null!==o&&null!==o.memoizedState||Qo;o=qo;var c=Qo;if(qo=a,(Qo=l)&&!c)for(Jo=r;null!==Jo;)l=(a=Jo).child,22===a.tag&&null!==a.memoizedState?El(r):null!==l?(l.return=a,Jo=l):El(r);for(;null!==s;)Jo=s,_l(s,e,n),s=s.sibling;Jo=r,qo=o,Qo=c}bl(t)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Jo=s):bl(t)}}function bl(t){for(;null!==Jo;){var e=Jo;if(0!==(8772&e.flags)){var n=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:Qo||il(5,e);break;case 1:var i=e.stateNode;if(4&e.flags&&!Qo)if(null===n)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:eo(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;null!==a&&Gs(e,a,i);break;case 3:var o=e.updateQueue;if(null!==o){if(n=null,null!==e.child)switch(e.child.tag){case 5:case 1:n=e.child.stateNode}Gs(e,o,n)}break;case 5:var l=e.stateNode;if(null===n&&4&e.flags){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var u=e.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Ve(d)}}}break;default:throw Error(s(163))}Qo||512&e.flags&&rl(e)}catch(uz){Sc(e,e.return,uz)}}if(e===t){Jo=null;break}if(null!==(n=e.sibling)){n.return=e.return,Jo=n;break}Jo=e.return}}function xl(t){for(;null!==Jo;){var e=Jo;if(e===t){Jo=null;break}var n=e.sibling;if(null!==n){n.return=e.return,Jo=n;break}Jo=e.return}}function El(t){for(;null!==Jo;){var e=Jo;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{il(4,e)}catch(l){Sc(e,n,l)}break;case 1:var i=e.stateNode;if("function"===typeof i.componentDidMount){var r=e.return;try{i.componentDidMount()}catch(l){Sc(e,r,l)}}var s=e.return;try{rl(e)}catch(l){Sc(e,s,l)}break;case 5:var a=e.return;try{rl(e)}catch(l){Sc(e,a,l)}}}catch(l){Sc(e,e.return,l)}if(e===t){Jo=null;break}var o=e.sibling;if(null!==o){o.return=e.return,Jo=o;break}Jo=e.return}}var wl,Sl=Math.ceil,Tl=b.ReactCurrentDispatcher,Ml=b.ReactCurrentOwner,Al=b.ReactCurrentBatchConfig,Cl=0,Rl=null,kl=null,Ll=0,Dl=0,Pl=Sr(0),Il=0,Ol=null,Nl=0,Fl=0,Ul=0,Bl=null,zl=null,Hl=0,Vl=1/0,Gl=null,jl=!1,Wl=null,Yl=null,Xl=!1,Kl=null,ql=0,Ql=0,Zl=null,Jl=-1,$l=0;function tc(){return 0!==(6&Cl)?Zt():-1!==Jl?Jl:Jl=Zt()}function ec(t){return 0===(1&t.mode)?1:0!==(2&Cl)&&0!==Ll?Ll&-Ll:null!==ms.transition?(0===$l&&($l=me()),$l):0!==(t=_e)?t:t=void 0===(t=window.event)?16:Qe(t.type)}function nc(t,e,n,i){if(50<Ql)throw Ql=0,Zl=null,Error(s(185));ve(t,n,i),0!==(2&Cl)&&t===Rl||(t===Rl&&(0===(2&Cl)&&(Fl|=n),4===Il&&oc(t,Ll)),ic(t,i),1===n&&0===Cl&&0===(1&e.mode)&&(Vl=Zt()+500,Br&&Vr()))}function ic(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-ae(s),o=1<<a,l=r[a];-1===l?0!==(o&n)&&0===(o&i)||(r[a]=fe(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}(t,e);var i=de(t,t===Rl?Ll:0);if(0===i)null!==n&&Kt(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(null!=n&&Kt(n),1===e)0===t.tag?function(t){Br=!0,Hr(t)}(lc.bind(null,t)):Hr(lc.bind(null,t)),ar(function(){0===(6&Cl)&&Vr()}),n=null;else{switch(be(i)){case 1:n=$t;break;case 4:n=te;break;case 16:default:n=ee;break;case 536870912:n=ie}n=Rc(n,rc.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function rc(t,e){if(Jl=-1,$l=0,0!==(6&Cl))throw Error(s(327));var n=t.callbackNode;if(Ec()&&t.callbackNode!==n)return null;var i=de(t,t===Rl?Ll:0);if(0===i)return null;if(0!==(30&i)||0!==(i&t.expiredLanes)||e)e=gc(t,i);else{e=i;var r=Cl;Cl|=2;var a=pc();for(Rl===t&&Ll===e||(Gl=null,Vl=Zt()+500,dc(t,e));;)try{yc();break}catch(l){fc(t,l)}Ms(),Tl.current=a,Cl=r,null!==kl?e=0:(Rl=null,Ll=0,e=Il)}if(0!==e){if(2===e&&(0!==(r=pe(t))&&(i=r,e=sc(t,r))),1===e)throw n=Ol,dc(t,0),oc(t,i),ic(t,Zt()),n;if(6===e)oc(t,i);else{if(r=t.current.alternate,0===(30&i)&&!function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!oi(s(),r))return!1}catch(o){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(r)&&(2===(e=gc(t,i))&&(0!==(a=pe(t))&&(i=a,e=sc(t,a))),1===e))throw n=Ol,dc(t,0),oc(t,i),ic(t,Zt()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(s(345));case 2:case 5:xc(t,zl,Gl);break;case 3:if(oc(t,i),(130023424&i)===i&&10<(e=Hl+500-Zt())){if(0!==de(t,0))break;if(((r=t.suspendedLanes)&i)!==i){tc(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=ir(xc.bind(null,t,zl,Gl),e);break}xc(t,zl,Gl);break;case 4:if(oc(t,i),(4194240&i)===i)break;for(e=t.eventTimes,r=-1;0<i;){var o=31-ae(i);a=1<<o,(o=e[o])>r&&(r=o),i&=~a}if(i=r,10<(i=(120>(i=Zt()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Sl(i/1960))-i)){t.timeoutHandle=ir(xc.bind(null,t,zl,Gl),i);break}xc(t,zl,Gl);break;default:throw Error(s(329))}}}return ic(t,Zt()),t.callbackNode===n?rc.bind(null,t):null}function sc(t,e){var n=Bl;return t.current.memoizedState.isDehydrated&&(dc(t,e).flags|=256),2!==(t=gc(t,e))&&(e=zl,zl=n,null!==e&&ac(e)),t}function ac(t){null===zl?zl=t:zl.push.apply(zl,t)}function oc(t,e){for(e&=~Ul,e&=~Fl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ae(e),i=1<<n;t[n]=-1,e&=~i}}function lc(t){if(0!==(6&Cl))throw Error(s(327));Ec();var e=de(t,0);if(0===(1&e))return ic(t,Zt()),null;var n=gc(t,e);if(0!==t.tag&&2===n){var i=pe(t);0!==i&&(e=i,n=sc(t,i))}if(1===n)throw n=Ol,dc(t,0),oc(t,e),ic(t,Zt()),n;if(6===n)throw Error(s(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xc(t,zl,Gl),ic(t,Zt()),null}function cc(t,e){var n=Cl;Cl|=1;try{return t(e)}finally{0===(Cl=n)&&(Vl=Zt()+500,Br&&Vr())}}function uc(t){null!==Kl&&0===Kl.tag&&0===(6&Cl)&&Ec();var e=Cl;Cl|=1;var n=Al.transition,i=_e;try{if(Al.transition=null,_e=1,t)return t()}finally{_e=i,Al.transition=n,0===(6&(Cl=e))&&Vr()}}function hc(){Dl=Pl.current,Tr(Pl)}function dc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,rr(n)),null!==kl)for(n=kl.return;null!==n;){var i=n;switch(es(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Pr();break;case 3:Qs(),Tr(Rr),Tr(Cr),na();break;case 5:Js(i);break;case 4:Qs();break;case 13:case 19:Tr($s);break;case 10:As(i.type._context);break;case 22:case 23:hc()}n=n.return}if(Rl=t,kl=t=Pc(t.current,null),Ll=Dl=e,Il=0,Ol=null,Ul=Fl=Nl=0,zl=Bl=null,null!==Ls){for(e=0;e<Ls.length;e++)if(null!==(i=(n=Ls[e]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var a=s.next;s.next=r,i.next=a}n.pending=i}Ls=null}return t}function fc(t,e){for(;;){var n=kl;try{if(Ms(),ia.current=Za,ca){for(var i=aa.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}ca=!1}if(sa=0,la=oa=aa=null,ua=!1,ha=0,Ml.current=null,null===n||null===n.return){Il=1,Ol=e,kl=null;break}t:{var a=t,o=n.return,l=n,c=e;if(e=Ll,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=go(o);if(null!==p){p.flags&=-257,vo(p,o,l,0,e),1&p.mode&&mo(a,u,e),c=u;var m=(e=p).updateQueue;if(null===m){var g=new Set;g.add(c),e.updateQueue=g}else m.add(c);break t}if(0===(1&e)){mo(a,u,e),mc();break t}c=Error(s(426))}else if(rs&&1&l.mode){var v=go(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vo(v,o,l,0,e),ps(lo(c,l));break t}}a=c=lo(c,l),4!==Il&&(Il=2),null===Bl?Bl=[a]:Bl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e,Hs(a,fo(0,c,e));break t;case 1:l=c;var y=a.type,_=a.stateNode;if(0===(128&a.flags)&&("function"===typeof y.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===Yl||!Yl.has(_)))){a.flags|=65536,e&=-e,a.lanes|=e,Hs(a,po(a,l,e));break t}}a=a.return}while(null!==a)}bc(n)}catch(b){e=b,kl===n&&null!==n&&(kl=n=n.return);continue}break}}function pc(){var t=Tl.current;return Tl.current=Za,null===t?Za:t}function mc(){0!==Il&&3!==Il&&2!==Il||(Il=4),null===Rl||0===(268435455&Nl)&&0===(268435455&Fl)||oc(Rl,Ll)}function gc(t,e){var n=Cl;Cl|=2;var i=pc();for(Rl===t&&Ll===e||(Gl=null,dc(t,e));;)try{vc();break}catch(r){fc(t,r)}if(Ms(),Cl=n,Tl.current=i,null!==kl)throw Error(s(261));return Rl=null,Ll=0,Il}function vc(){for(;null!==kl;)_c(kl)}function yc(){for(;null!==kl&&!qt();)_c(kl)}function _c(t){var e=wl(t.alternate,t,Dl);t.memoizedProps=t.pendingProps,null===e?bc(t):kl=e,Ml.current=null}function bc(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(n=Xo(n,e,Dl)))return void(kl=n)}else{if(null!==(n=Ko(n,e)))return n.flags&=32767,void(kl=n);if(null===t)return Il=6,void(kl=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(kl=e);kl=e=t}while(null!==e);0===Il&&(Il=5)}function xc(t,e,n){var i=_e,r=Al.transition;try{Al.transition=null,_e=1,function(t,e,n,i){do{Ec()}while(null!==Kl);if(0!==(6&Cl))throw Error(s(327));n=t.finishedWork;var r=t.finishedLanes;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(s(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-ae(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}(t,a),t===Rl&&(kl=Rl=null,Ll=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xl||(Xl=!0,Rc(ee,function(){return Ec(),null})),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Al.transition,Al.transition=null;var o=_e;_e=1;var l=Cl;Cl|=4,Ml.current=null,function(t,e){if(tr=je,fi(t=di())){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var i=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{n.nodeType,a.nodeType}catch(x){n=null;break t}var o=0,l=-1,c=-1,u=0,h=0,d=t,f=null;e:for(;;){for(var p;d!==n||0!==r&&3!==d.nodeType||(l=o+r),d!==a||0!==i&&3!==d.nodeType||(c=o+i),3===d.nodeType&&(o+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===t)break e;if(f===n&&++u===r&&(l=o),f===a&&++h===i&&(c=o),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(er={focusedElem:t,selectionRange:n},je=!1,Jo=e;null!==Jo;)if(t=(e=Jo).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,Jo=t;else for(;null!==Jo;){e=Jo;try{var m=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=e.stateNode,_=y.getSnapshotBeforeUpdate(e.elementType===e.type?g:eo(e.type,g),v);y.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var b=e.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(s(163))}}catch(x){Sc(e,e.return,x)}if(null!==(t=e.sibling)){t.return=e.return,Jo=t;break}Jo=e.return}m=el,el=!1}(t,n),gl(n,t),pi(er),je=!!tr,er=tr=null,t.current=n,yl(n,t,r),Qt(),Cl=l,_e=o,Al.transition=a}else t.current=n;if(Xl&&(Xl=!1,Kl=t,ql=r),a=t.pendingLanes,0===a&&(Yl=null),function(t){if(se&&"function"===typeof se.onCommitFiberRoot)try{se.onCommitFiberRoot(re,t,void 0,128===(128&t.current.flags))}catch(e){}}(n.stateNode),ic(t,Zt()),null!==e)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(jl)throw jl=!1,t=Wl,Wl=null,t;0!==(1&ql)&&0!==t.tag&&Ec(),a=t.pendingLanes,0!==(1&a)?t===Zl?Ql++:(Ql=0,Zl=t):Ql=0,Vr()}(t,e,n,i)}finally{Al.transition=r,_e=i}return null}function Ec(){if(null!==Kl){var t=be(ql),e=Al.transition,n=_e;try{if(Al.transition=null,_e=16>t?16:t,null===Kl)var i=!1;else{if(t=Kl,Kl=null,ql=0,0!==(6&Cl))throw Error(s(331));var r=Cl;for(Cl|=4,Jo=t.current;null!==Jo;){var a=Jo,o=a.child;if(0!==(16&Jo.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Jo=u;null!==Jo;){var h=Jo;switch(h.tag){case 0:case 11:case 15:nl(8,h,a)}var d=h.child;if(null!==d)d.return=h,Jo=d;else for(;null!==Jo;){var f=(h=Jo).sibling,p=h.return;if(sl(h),h===u){Jo=null;break}if(null!==f){f.return=p,Jo=f;break}Jo=p}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Jo=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,Jo=o;else t:for(;null!==Jo;){if(0!==(2048&(a=Jo).flags))switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Jo=y;break t}Jo=a.return}}var _=t.current;for(Jo=_;null!==Jo;){var b=(o=Jo).child;if(0!==(2064&o.subtreeFlags)&&null!==b)b.return=o,Jo=b;else t:for(o=_;null!==Jo;){if(0!==(2048&(l=Jo).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(E){Sc(l,l.return,E)}if(l===o){Jo=null;break t}var x=l.sibling;if(null!==x){x.return=l.return,Jo=x;break t}Jo=l.return}}if(Cl=r,Vr(),se&&"function"===typeof se.onPostCommitFiberRoot)try{se.onPostCommitFiberRoot(re,t)}catch(E){}i=!0}return i}finally{_e=n,Al.transition=e}}return!1}function wc(t,e,n){t=Bs(t,e=fo(0,e=lo(n,e),1),1),e=tc(),null!==t&&(ve(t,1,e),ic(t,e))}function Sc(t,e,n){if(3===t.tag)wc(t,t,n);else for(;null!==e;){if(3===e.tag){wc(e,t,n);break}if(1===e.tag){var i=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Yl||!Yl.has(i))){e=Bs(e,t=po(e,t=lo(n,t),1),1),t=tc(),null!==e&&(ve(e,1,t),ic(e,t));break}}e=e.return}}function Tc(t,e,n){var i=t.pingCache;null!==i&&i.delete(e),e=tc(),t.pingedLanes|=t.suspendedLanes&n,Rl===t&&(Ll&n)===n&&(4===Il||3===Il&&(130023424&Ll)===Ll&&500>Zt()-Hl?dc(t,0):Ul|=n),ic(t,e)}function Mc(t,e){0===e&&(0===(1&t.mode)?e=1:(e=ue,0===(130023424&(ue<<=1))&&(ue=4194304)));var n=tc();null!==(t=Is(t,e))&&(ve(t,e,n),ic(t,n))}function Ac(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),Mc(t,n)}function Cc(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(s(314))}null!==i&&i.delete(e),Mc(t,n)}function Rc(t,e){return Xt(t,e)}function kc(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lc(t,e,n,i){return new kc(t,e,n,i)}function Dc(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Pc(t,e){var n=t.alternate;return null===n?((n=Lc(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ic(t,e,n,i,r,a){var o=2;if(i=t,"function"===typeof t)Dc(t)&&(o=1);else if("string"===typeof t)o=5;else t:switch(t){case w:return Oc(n.children,r,a,e);case S:o=8,r|=8;break;case T:return(t=Lc(12,n,e,2|r)).elementType=T,t.lanes=a,t;case R:return(t=Lc(13,n,e,r)).elementType=R,t.lanes=a,t;case k:return(t=Lc(19,n,e,r)).elementType=k,t.lanes=a,t;case P:return Nc(n,r,a,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case M:o=10;break t;case A:o=9;break t;case C:o=11;break t;case L:o=14;break t;case D:o=16,i=null;break t}throw Error(s(130,null==t?t:typeof t,""))}return(e=Lc(o,n,e,r)).elementType=t,e.type=i,e.lanes=a,e}function Oc(t,e,n,i){return(t=Lc(7,t,i,e)).lanes=n,t}function Nc(t,e,n,i){return(t=Lc(22,t,i,e)).elementType=P,t.lanes=n,t.stateNode={isHidden:!1},t}function Fc(t,e,n){return(t=Lc(6,t,null,e)).lanes=n,t}function Uc(t,e,n){return(e=Lc(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Bc(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ge(0),this.expirationTimes=ge(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ge(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function zc(t,e,n,i,r,s,a,o,l){return t=new Bc(t,e,n,o,l),1===e?(e=1,!0===s&&(e|=8)):e=0,s=Lc(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ns(s),t}function Hc(t){if(!t)return Ar;t:{if(Vt(t=t._reactInternals)!==t||1!==t.tag)throw Error(s(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Dr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(s(171))}if(1===t.tag){var n=t.type;if(Dr(n))return Or(t,n,e)}return e}function Vc(t,e,n,i,r,s,a,o,l){return(t=zc(n,i,!0,t,0,s,0,o,l)).context=Hc(null),n=t.current,(s=Us(i=tc(),r=ec(n))).callback=void 0!==e&&null!==e?e:null,Bs(n,s,r),t.current.lanes=r,ve(t,r,i),ic(t,i),t}function Gc(t,e,n,i){var r=e.current,s=tc(),a=ec(r);return n=Hc(n),null===e.context?e.context=n:e.pendingContext=n,(e=Us(s,a)).payload={element:t},null!==(i=void 0===i?null:i)&&(e.callback=i),null!==(t=Bs(r,e,a))&&(nc(t,r,a,s),zs(t,r,a)),a}function jc(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Wc(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function Yc(t,e){Wc(t,e),(t=t.alternate)&&Wc(t,e)}wl=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||Rr.current)_o=!0;else{if(0===(t.lanes&n)&&0===(128&e.flags))return _o=!1,function(t,e,n){switch(e.tag){case 3:Ro(e),fs();break;case 5:Zs(e);break;case 1:Dr(e.type)&&Nr(e);break;case 4:qs(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Mr(Es,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=e.memoizedState))return null!==i.dehydrated?(Mr($s,1&$s.current),e.flags|=128,null):0!==(n&e.child.childLanes)?Fo(t,e,n):(Mr($s,1&$s.current),null!==(t=jo(t,e,n))?t.sibling:null);Mr($s,1&$s.current);break;case 19:if(i=0!==(n&e.childLanes),0!==(128&t.flags)){if(i)return Vo(t,e,n);e.flags|=128}if(null!==(r=e.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Mr($s,$s.current),i)break;return null;case 22:case 23:return e.lanes=0,So(t,e,n)}return jo(t,e,n)}(t,e,n);_o=0!==(131072&t.flags)}else _o=!1,rs&&0!==(1048576&e.flags)&&$r(e,Yr,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Go(t,e),t=e.pendingProps;var r=Lr(e,Cr.current);Rs(e,n),r=ma(null,e,i,t,r,n);var a=ga();return e.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Dr(i)?(a=!0,Nr(e)):a=!1,e.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Ns(e),r.updater=io,e.stateNode=r,r._reactInternals=e,oo(e,i,t,n),e=Co(null,e,i,!0,a,n)):(e.tag=0,rs&&a&&ts(e),bo(null,e,r,n),e=e.child),e;case 16:i=e.elementType;t:{switch(Go(t,e),t=e.pendingProps,i=(r=i._init)(i._payload),e.type=i,r=e.tag=function(t){if("function"===typeof t)return Dc(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===C)return 11;if(t===L)return 14}return 2}(i),t=eo(i,t),r){case 0:e=Mo(null,e,i,t,n);break t;case 1:e=Ao(null,e,i,t,n);break t;case 11:e=xo(null,e,i,t,n);break t;case 14:e=Eo(null,e,i,eo(i.type,t),n);break t}throw Error(s(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,Mo(t,e,i,r=e.elementType===i?r:eo(i,r),n);case 1:return i=e.type,r=e.pendingProps,Ao(t,e,i,r=e.elementType===i?r:eo(i,r),n);case 3:t:{if(Ro(e),null===t)throw Error(s(387));i=e.pendingProps,r=(a=e.memoizedState).element,Fs(t,e),Vs(e,i,null,n);var o=e.memoizedState;if(i=o.element,a.isDehydrated){if(a={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,256&e.flags){e=ko(t,e,i,n,r=lo(Error(s(423)),e));break t}if(i!==r){e=ko(t,e,i,n,r=lo(Error(s(424)),e));break t}for(is=cr(e.stateNode.containerInfo.firstChild),ns=e,rs=!0,ss=null,n=xs(e,null,i,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),i===r){e=jo(t,e,n);break t}bo(t,e,i,n)}e=e.child}return e;case 5:return Zs(e),null===t&&cs(e),i=e.type,r=e.pendingProps,a=null!==t?t.memoizedProps:null,o=r.children,nr(i,r)?o=null:null!==a&&nr(i,a)&&(e.flags|=32),To(t,e),bo(t,e,o,n),e.child;case 6:return null===t&&cs(e),null;case 13:return Fo(t,e,n);case 4:return qs(e,e.stateNode.containerInfo),i=e.pendingProps,null===t?e.child=bs(e,null,i,n):bo(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,xo(t,e,i,r=e.elementType===i?r:eo(i,r),n);case 7:return bo(t,e,e.pendingProps,n),e.child;case 8:case 12:return bo(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(i=e.type._context,r=e.pendingProps,a=e.memoizedProps,o=r.value,Mr(Es,i._currentValue),i._currentValue=o,null!==a)if(oi(a.value,o)){if(a.children===r.children&&!Rr.current){e=jo(t,e,n);break t}}else for(null!==(a=e.child)&&(a.return=e);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===a.tag){(c=Us(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Cs(a.return,n,e),l.lanes|=n;break}c=c.next}}else if(10===a.tag)o=a.type===e.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Cs(o,n,e),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===e){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}bo(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Rs(e,n),i=i(r=ks(r)),e.flags|=1,bo(t,e,i,n),e.child;case 14:return r=eo(i=e.type,e.pendingProps),Eo(t,e,i,r=eo(i.type,r),n);case 15:return wo(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:eo(i,r),Go(t,e),e.tag=1,Dr(i)?(t=!0,Nr(e)):t=!1,Rs(e,n),so(e,i,r),oo(e,i,r,n),Co(null,e,i,!0,t,n);case 19:return Vo(t,e,n);case 22:return So(t,e,n)}throw Error(s(156,e.tag))};var Xc="function"===typeof reportError?reportError:function(t){console.error(t)};function Kc(t){this._internalRoot=t}function qc(t){this._internalRoot=t}function Qc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Zc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Jc(){}function $c(t,e,n,i,r){var s=n._reactRootContainer;if(s){var a=s;if("function"===typeof r){var o=r;r=function(){var t=jc(a);o.call(t)}}Gc(e,a,t,r)}else a=function(t,e,n,i,r){if(r){if("function"===typeof i){var s=i;i=function(){var t=jc(a);s.call(t)}}var a=Vc(e,i,t,0,null,!1,0,"",Jc);return t._reactRootContainer=a,t[pr]=a.current,Vi(8===t.nodeType?t.parentNode:t),uc(),a}for(;r=t.lastChild;)t.removeChild(r);if("function"===typeof i){var o=i;i=function(){var t=jc(l);o.call(t)}}var l=zc(t,0,!1,null,0,!1,0,"",Jc);return t._reactRootContainer=l,t[pr]=l.current,Vi(8===t.nodeType?t.parentNode:t),uc(function(){Gc(e,l,n,i)}),l}(n,e,t,r,i);return jc(a)}qc.prototype.render=Kc.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(s(409));Gc(t,e,null,null)},qc.prototype.unmount=Kc.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;uc(function(){Gc(null,t,null,null)}),e[pr]=null}},qc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Se();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Pe.length&&0!==e&&e<Pe[n].priority;n++);Pe.splice(n,0,t),0===n&&Fe(t)}},xe=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=he(e.pendingLanes);0!==n&&(ye(e,1|n),ic(e,Zt()),0===(6&Cl)&&(Vl=Zt()+500,Vr()))}break;case 13:uc(function(){var e=Is(t,1);if(null!==e){var n=tc();nc(e,t,1,n)}}),Yc(t,1)}},Ee=function(t){if(13===t.tag){var e=Is(t,134217728);if(null!==e)nc(e,t,134217728,tc());Yc(t,134217728)}},we=function(t){if(13===t.tag){var e=ec(t),n=Is(t,e);if(null!==n)nc(n,t,e,tc());Yc(t,e)}},Se=function(){return _e},Te=function(t,e){var n=_e;try{return _e=t,e()}finally{_e=n}},Et=function(t,e,n){switch(e){case"input":if(J(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=xr(i);if(!r)throw Error(s(90));X(i),J(i,r)}}}break;case"textarea":st(t,n);break;case"select":null!=(e=n.value)&&nt(t,!!n.multiple,e,!1)}},Ct=cc,Rt=uc;var tu={usingClientEntryPoint:!1,Events:[_r,br,xr,Mt,At,cc]},eu={findFiberByHostInstance:yr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Wt(t))?null:t.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{re=iu.inject(nu),se=iu}catch(ut){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,e.createPortal=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qc(e))throw Error(s(200));return function(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==i?null:""+i,children:t,containerInfo:e,implementation:n}}(t,e,null,n)},e.createRoot=function(t,e){if(!Qc(t))throw Error(s(299));var n=!1,i="",r=Xc;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(n=!0),void 0!==e.identifierPrefix&&(i=e.identifierPrefix),void 0!==e.onRecoverableError&&(r=e.onRecoverableError)),e=zc(t,1,!1,null,0,n,0,i,r),t[pr]=e.current,Vi(8===t.nodeType?t.parentNode:t),new Kc(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(s(188));throw t=Object.keys(t).join(","),Error(s(268,t))}return t=null===(t=Wt(e))?null:t.stateNode},e.flushSync=function(t){return uc(t)},e.hydrate=function(t,e,n){if(!Zc(e))throw Error(s(200));return $c(null,t,e,!0,n)},e.hydrateRoot=function(t,e,n){if(!Qc(t))throw Error(s(405));var i=null!=n&&n.hydratedSources||null,r=!1,a="",o=Xc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),e=Vc(e,null,t,1,null!=n?n:null,r,0,a,o),t[pr]=e.current,Vi(t),i)for(t=0;t<i.length;t++)r=(r=(n=i[t])._getVersion)(n._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new qc(e)},e.render=function(t,e,n){if(!Zc(e))throw Error(s(200));return $c(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!Zc(t))throw Error(s(40));return!!t._reactRootContainer&&(uc(function(){$c(null,null,t,!1,function(){t._reactRootContainer=null,t[pr]=null})}),!0)},e.unstable_batchedUpdates=cc,e.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!Zc(n))throw Error(s(200));if(null==t||void 0===t._reactInternals)throw Error(s(38));return $c(t,e,n,!1,i)},e.version="18.3.1-next-f1338f8080-20240426"},929:(t,e,n)=>{t.exports=n(643)},970:(t,e)=>{function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var i=n-1>>>1,r=t[i];if(!(0<s(r,e)))break t;t[i]=e,t[n]=r,n=i}}function i(t){return 0===t.length?null:t[0]}function r(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var i=0,r=t.length,a=r>>>1;i<a;){var o=2*(i+1)-1,l=t[o],c=o+1,u=t[c];if(0>s(l,n))c<r&&0>s(u,l)?(t[i]=u,t[c]=n,i=c):(t[i]=l,t[o]=n,i=o);else{if(!(c<r&&0>s(u,n)))break t;t[i]=u,t[c]=n,i=c}}}return e}function s(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function b(t){for(var e=i(u);null!==e;){if(null===e.callback)r(u);else{if(!(e.startTime<=t))break;r(u),e.sortIndex=e.expirationTime,n(c,e)}e=i(u)}}function x(t){if(g=!1,b(t),!m)if(null!==i(c))m=!0,P(E);else{var e=i(u);null!==e&&I(x,e.startTime-t)}}function E(t,n){m=!1,g&&(g=!1,y(M),M=-1),p=!0;var s=f;try{for(b(n),d=i(c);null!==d&&(!(d.expirationTime>n)||t&&!R());){var a=d.callback;if("function"===typeof a){d.callback=null,f=d.priorityLevel;var o=a(d.expirationTime<=n);n=e.unstable_now(),"function"===typeof o?d.callback=o:d===i(c)&&r(c),b(n)}else r(c);d=i(c)}if(null!==d)var l=!0;else{var h=i(u);null!==h&&I(x,h.startTime-n),l=!1}return l}finally{d=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var w,S=!1,T=null,M=-1,A=5,C=-1;function R(){return!(e.unstable_now()-C<A)}function k(){if(null!==T){var t=e.unstable_now();C=t;var n=!0;try{n=T(!0,t)}finally{n?w():(S=!1,T=null)}}else S=!1}if("function"===typeof _)w=function(){_(k)};else if("undefined"!==typeof MessageChannel){var L=new MessageChannel,D=L.port2;L.port1.onmessage=k,w=function(){D.postMessage(null)}}else w=function(){v(k,0)};function P(t){T=t,S||(S=!0,w())}function I(t,n){M=v(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){m||p||(m=!0,P(E))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return i(c)},e.unstable_next=function(t){switch(f){case 1:case 2:case 3:var e=3;break;default:e=f}var n=f;f=e;try{return t()}finally{f=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=f;f=t;try{return e()}finally{f=n}},e.unstable_scheduleCallback=function(t,r,s){var a=e.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,t){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return t={id:h++,callback:r,priorityLevel:t,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(t.sortIndex=s,n(u,t),null===i(c)&&t===i(u)&&(g?(y(M),M=-1):g=!0,I(x,s-a))):(t.sortIndex=o,n(c,t),m||p||(m=!0,P(E))),t},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(t){var e=f;return function(){var n=f;f=e;try{return t.apply(this,arguments)}finally{f=n}}}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={exports:{}};return t[i](s,s.exports,n),s.exports}n.m=t,(()=>{var t,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__;n.t=function(i,r){if(1&r&&(i=this(i)),8&r)return i;if("object"===typeof i&&i){if(4&r&&i.__esModule)return i;if(16&r&&"function"===typeof i.then)return i}var s=Object.create(null);n.r(s);var a={};t=t||[null,e({}),e([]),e(e)];for(var o=2&r&&i;("object"==typeof o||"function"==typeof o)&&!~t.indexOf(o);o=e(o))Object.getOwnPropertyNames(o).forEach(t=>a[t]=()=>i[t]);return a.default=()=>i,n.d(s,a),s}})(),n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.f={},n.e=t=>Promise.all(Object.keys(n.f).reduce((e,i)=>(n.f[i](t,e),e),[])),n.u=t=>"static/js/"+t+".02b9464e.chunk.js",n.miniCssF=t=>{},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={},e="neimark-hostel:";n.l=(i,r,s,a)=>{if(t[i])t[i].push(r);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==e+s){o=h;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",e+s),o.src=i),t[i]=[r];var d=(e,n)=>{o.onerror=o.onload=null,clearTimeout(f);var r=t[i];if(delete t[i],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach(t=>t(n)),e)return e(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.p="/",(()=>{var t={792:0};n.f.j=(e,i)=>{var r=n.o(t,e)?t[e]:void 0;if(0!==r)if(r)i.push(r[2]);else{var s=new Promise((n,i)=>r=t[e]=[n,i]);i.push(r[2]=s);var a=n.p+n.u(e),o=new Error;n.l(a,i=>{if(n.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var s=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;o.message="Loading chunk "+e+" failed.\n("+s+": "+a+")",o.name="ChunkLoadError",o.type=s,o.request=a,r[1](o)}},"chunk-"+e,e)}};var e=(e,i)=>{var r,s,[a,o,l]=i,c=0;if(a.some(e=>0!==t[e])){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(l)l(n)}for(e&&e(i);c<a.length;c++)s=a[c],n.o(t,s)&&t[s]&&t[s][0](),t[s]=0},i=self.webpackChunkneimark_hostel=self.webpackChunkneimark_hostel||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var i=n(565),r=n.t(i,2),s=n(501);const a="AppHeader_header__nHHDe",o="AppHeader_logo__gSfYP",l="AppHeader_header_left__BYgit",c="AppHeader_header_right__aJ3xu",u="AppHeader_header_button__QY66c",h="AppHeader_navigation__-DuP-";function d(t,e){if(null==t)return{};var n,i,r=function(t,e){if(null==t)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(-1!==e.indexOf(i))continue;n[i]=t[i]}return n}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],-1===e.indexOf(n)&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}const f="Tab_tab__FudpZ",p="Tab_tab_active__jQzHr";var m=n(929);const g=["active","title","onClick"],v=t=>{let{active:e,title:n,onClick:i}=t;d(t,g);return(0,m.jsx)("div",{className:"".concat(f," ").concat(e&&p),onClick:i,children:n})},y="Button_button__wiIYs",_="Button_button_element__highlight__O7et+",b=["active","className","type","title","onClick","defaultClassName"],x=(0,i.forwardRef)((t,e)=>{let{active:n,className:i,type:r,title:s,onClick:a,defaultClassName:o=!0}=t;d(t,b);return(0,m.jsx)("button",{ref:e,className:"".concat(o&&y," ").concat(i),type:null!==r&&void 0!==r?r:"button",onClick:t=>a(t),children:(0,m.jsx)("span",{className:"".concat(n&&_),children:s})})}),E=(0,i.createContext)(["hidden",()=>{}]),w=(0,i.createContext)(["home",()=>{}]),S=(0,i.createContext)(["home",()=>{}]);var T,M,A,C,R,k,L,D,P;const I=["title","titleId"];function O(){return O=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},O.apply(null,arguments)}function N(t,e){let{title:n,titleId:r}=t,s=function(t,e){if(null==t)return{};var n,i,r=function(t,e){if(null==t)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(-1!==e.indexOf(i))continue;n[i]=t[i]}return n}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],-1===e.indexOf(n)&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}(t,I);return i.createElement("svg",O({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 238 36",fill:"none",ref:e,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,T||(T=i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M225.38925 20.277975H220.018V32.4H216.47225V6H220.018V17.066H225.474L233.05325 6H237.19325L228.51 18.473975L238 32.4H233.64775L225.38925 20.277975Z",fill:"#FEFEFE"})),M||(M=i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M197.2205 9.234V19.640025H203.6885C205.7345 19.640025 207.22225 19.200025 208.11075 18.320025C208.9995 17.440025 209.454 16.14205 209.454 14.42605C209.454 12.71005 209.02 11.39005 208.1315 10.532075C207.243 9.67405 205.755 9.234 203.6885 9.234H197.2205ZM193.74875 6H205.321C210.136 6 212.8845 9.41005 212.8845 14.44805C212.8845 19.48605 210.012 22.89605 205.321 22.89605H197.2205V32.4H193.74875V6Z",fill:"#FEFEFE"})),A||(A=i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M174.401 21.818H184.4145L180.089 7.407975H178.705L174.401 21.818ZM175.35275 6L167.43725 32.4H171.222L173.42775 25.052H185.4525L187.572 32.4H191.35675L183.44125 6H175.331H175.35275Z",fill:"#FEFEFE"})),C||(C=i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M136.34175 6V32.4H139.98125V7.429975H140.566L147.43325 32.4H153.99725L160.821 7.429975H161.40575V32.4H165.04525V6H157.8315L151.00775 30.97H150.48775L143.64225 6H136.34175Z",fill:"#FEFEFE"})),R||(R=i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M110.03025 6V32.4H116.99375L127.4815 7.429975H127.991V32.4H131.55775V6H124.55175L114.08525 30.97H113.597V6H110.03025Z",fill:"#FEFEFE"})),k||(k=i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M105.24625 6H87.3065V32.4H105.24625V29.166H90.762V20.32195H102.8875V17.08795H90.762V9.211975H105.24625V6Z",fill:"#FEFEFE"})),L||(L=i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M63.341 6H59.799V32.4H63.341V20.277975H77.78475V32.4H81.32675V6H77.78475V17.066H63.341V6Z",fill:"#FEFEFE"})),D||(D=i.createElement("path",{d:"M125.578 0H114.814V3.6H125.578V0Z",fill:"#FEFEFE"})),P||(P=i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.150425 26.8305V11.569525H13.6692V26.8305H12.150425ZM25.8195 26.8305V11.569525H27.33825V26.8305H25.8195ZM14.69595 18.435875H24.792725V19.964125H14.69595V18.435875ZM36.42975 5.456525V8.513H39.46725V32.9435H36.42975V36H15.187975V32.9435H6.075175C2.7381 32.9435 0 30.18825 0 26.8305V8.513C0 5.15515 2.7381 2.4 6.075175 2.4H27.317V5.456525H6.075175C5.2409 5.456525 4.4922 5.800875 3.936025 6.360525C3.37985 6.920175 3.037625 7.673525 3.037625 8.513V26.8305C3.037625 27.67 3.37985 28.42325 3.936025 28.983C4.4922 29.5425 5.2409 29.887 6.075175 29.887H15.187975V32.9435H36.42975V8.513H27.317V5.456525H36.42975Z",fill:"#FD9968"})))}const F=i.forwardRef(N);n.p;function U(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var z,H,V,G,j,W,Y,X,K,q,Q,Z={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},J={duration:.5,overwrite:!1,delay:0},$=1e8,tt=1e-8,et=2*Math.PI,nt=et/4,it=0,rt=Math.sqrt,st=Math.cos,at=Math.sin,ot=function(t){return"string"===typeof t},lt=function(t){return"function"===typeof t},ct=function(t){return"number"===typeof t},ut=function(t){return"undefined"===typeof t},ht=function(t){return"object"===typeof t},dt=function(t){return!1!==t},ft=function(){return"undefined"!==typeof window},pt=function(t){return lt(t)||ot(t)},mt="function"===typeof ArrayBuffer&&ArrayBuffer.isView||function(){},gt=Array.isArray,vt=/(?:-?\.?\d|\.)+/gi,yt=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,_t=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,bt=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,xt=/[+-]=-?[.\d]+/,Et=/[^,'"\[\]\s]+/gi,wt=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,St={},Tt={},Mt=function(t){return(Tt=ne(t,St))&&ri},At=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},Ct=function(t,e){return!e&&console.warn(t)},Rt=function(t,e){return t&&(St[t]=e)&&Tt&&(Tt[t]=e)||St},kt=function(){return 0},Lt={suppressEvents:!0,isStart:!0,kill:!1},Dt={suppressEvents:!0,kill:!1},Pt={suppressEvents:!0},It={},Ot=[],Nt={},Ft={},Ut={},Bt=30,zt=[],Ht="",Vt=function(t){var e,n,i=t[0];if(ht(i)||lt(i)||(t=[t]),!(e=(i._gsap||{}).harness)){for(n=zt.length;n--&&!zt[n].targetTest(i););e=zt[n]}for(n=t.length;n--;)t[n]&&(t[n]._gsap||(t[n]._gsap=new yn(t[n],e)))||t.splice(n,1);return t},Gt=function(t){return t._gsap||Vt(Ie(t))[0]._gsap},jt=function(t,e,n){return(n=t[e])&&lt(n)?t[e]():ut(n)&&t.getAttribute&&t.getAttribute(e)||n},Wt=function(t,e){return(t=t.split(",")).forEach(e)||t},Yt=function(t){return Math.round(1e5*t)/1e5||0},Xt=function(t){return Math.round(1e7*t)/1e7||0},Kt=function(t,e){var n=e.charAt(0),i=parseFloat(e.substr(2));return t=parseFloat(t),"+"===n?t+i:"-"===n?t-i:"*"===n?t*i:t/i},qt=function(t,e){for(var n=e.length,i=0;t.indexOf(e[i])<0&&++i<n;);return i<n},Qt=function(){var t,e,n=Ot.length,i=Ot.slice(0);for(Nt={},Ot.length=0,t=0;t<n;t++)(e=i[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)},Zt=function(t){return!!(t._initted||t._startAt||t.add)},Jt=function(t,e,n,i){Ot.length&&!H&&Qt(),t.render(e,n,i||!!(H&&e<0&&Zt(t))),Ot.length&&!H&&Qt()},$t=function(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(Et).length<2?e:ot(t)?t.trim():t},te=function(t){return t},ee=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},ne=function(t,e){for(var n in e)t[n]=e[n];return t},ie=function t(e,n){for(var i in n)"__proto__"!==i&&"constructor"!==i&&"prototype"!==i&&(e[i]=ht(n[i])?t(e[i]||(e[i]={}),n[i]):n[i]);return e},re=function(t,e){var n,i={};for(n in t)n in e||(i[n]=t[n]);return i},se=function(t){var e,n=t.parent||G,i=t.keyframes?(e=gt(t.keyframes),function(t,n){for(var i in n)i in t||"duration"===i&&e||"ease"===i||(t[i]=n[i])}):ee;if(dt(t.inherit))for(;n;)i(t,n.vars.defaults),n=n.parent||n._dp;return t},ae=function(t,e,n,i,r){void 0===n&&(n="_first"),void 0===i&&(i="_last");var s,a=t[i];if(r)for(s=e[r];a&&a[r]>s;)a=a._prev;return a?(e._next=a._next,a._next=e):(e._next=t[n],t[n]=e),e._next?e._next._prev=e:t[i]=e,e._prev=a,e.parent=e._dp=t,e},oe=function(t,e,n,i){void 0===n&&(n="_first"),void 0===i&&(i="_last");var r=e._prev,s=e._next;r?r._next=s:t[n]===e&&(t[n]=s),s?s._prev=r:t[i]===e&&(t[i]=r),e._next=e._prev=e.parent=null},le=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},ce=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var n=t;n;)n._dirty=1,n=n.parent;return t},ue=function(t,e,n,i){return t._startAt&&(H?t._startAt.revert(Dt):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,i))},he=function t(e){return!e||e._ts&&t(e.parent)},de=function(t){return t._repeat?fe(t._tTime,t=t.duration()+t._rDelay)*t:0},fe=function(t,e){var n=Math.floor(t=Xt(t/e));return t&&n===t?n-1:n},pe=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},me=function(t){return t._end=Xt(t._start+(t._tDur/Math.abs(t._ts||t._rts||tt)||0))},ge=function(t,e){var n=t._dp;return n&&n.smoothChildTiming&&t._ts&&(t._start=Xt(n._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),me(t),n._dirty||ce(n,t)),t},ve=function(t,e){var n;if((e._time||!e._dur&&e._initted||e._start<t._time&&(e._dur||!e.add))&&(n=pe(t.rawTime(),e),(!e._dur||Re(0,e.totalDuration(),n)-e._tTime>tt)&&e.render(n,!0)),ce(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(n=t;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;t._zTime=-1e-8}},ye=function(t,e,n,i){return e.parent&&le(e),e._start=Xt((ct(n)?n:n||t!==G?Me(t,n,e):t._time)+e._delay),e._end=Xt(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),ae(t,e,"_first","_last",t._sort?"_start":0),Ee(e)||(t._recent=e),i||ve(t,e),t._ts<0&&ge(t,t._tTime),t},_e=function(t,e){return(St.ScrollTrigger||At("scrollTrigger",e))&&St.ScrollTrigger.create(e,t)},be=function(t,e,n,i,r){return Mn(t,e,r),t._initted?!n&&t._pt&&!H&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&K!==sn.frame?(Ot.push(t),t._lazy=[r,i],1):void 0:1},xe=function t(e){var n=e.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||t(n))},Ee=function(t){var e=t.data;return"isFromStart"===e||"isStart"===e},we=function(t,e,n,i){var r=t._repeat,s=Xt(e)||0,a=t._tTime/t._tDur;return a&&!i&&(t._time*=s/t._dur),t._dur=s,t._tDur=r?r<0?1e10:Xt(s*(r+1)+t._rDelay*r):s,a>0&&!i&&ge(t,t._tTime=t._tDur*a),t.parent&&me(t),n||ce(t.parent,t),t},Se=function(t){return t instanceof bn?ce(t):we(t,t._dur)},Te={_start:0,endTime:kt,totalDuration:kt},Me=function t(e,n,i){var r,s,a,o=e.labels,l=e._recent||Te,c=e.duration()>=$?l.endTime(!1):e._dur;return ot(n)&&(isNaN(n)||n in o)?(s=n.charAt(0),a="%"===n.substr(-1),r=n.indexOf("="),"<"===s||">"===s?(r>=0&&(n=n.replace(/=/,"")),("<"===s?l._start:l.endTime(l._repeat>=0))+(parseFloat(n.substr(1))||0)*(a?(r<0?l:i).totalDuration()/100:1)):r<0?(n in o||(o[n]=c),o[n]):(s=parseFloat(n.charAt(r-1)+n.substr(r+1)),a&&i&&(s=s/100*(gt(i)?i[0]:i).totalDuration()),r>1?t(e,n.substr(0,r-1),i)+s:c+s)):null==n?c:+n},Ae=function(t,e,n){var i,r,s=ct(e[1]),a=(s?2:1)+(t<2?0:1),o=e[a];if(s&&(o.duration=e[1]),o.parent=n,t){for(i=o,r=n;r&&!("immediateRender"in i);)i=r.vars.defaults||{},r=dt(r.vars.inherit)&&r.parent;o.immediateRender=dt(i.immediateRender),t<2?o.runBackwards=1:o.startAt=e[a-1]}return new Ln(e[0],o,e[a+1])},Ce=function(t,e){return t||0===t?e(t):e},Re=function(t,e,n){return n<t?t:n>e?e:n},ke=function(t,e){return ot(t)&&(e=wt.exec(t))?e[1]:""},Le=[].slice,De=function(t,e){return t&&ht(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&ht(t[0]))&&!t.nodeType&&t!==j},Pe=function(t,e,n){return void 0===n&&(n=[]),t.forEach(function(t){var i;return ot(t)&&!e||De(t,1)?(i=n).push.apply(i,Ie(t)):n.push(t)})||n},Ie=function(t,e,n){return V&&!e&&V.selector?V.selector(t):!ot(t)||n||!W&&an()?gt(t)?Pe(t,n):De(t)?Le.call(t,0):t?[t]:[]:Le.call((e||Y).querySelectorAll(t),0)},Oe=function(t){return t=Ie(t)[0]||Ct("Invalid scope")||{},function(e){var n=t.current||t.nativeElement||t;return Ie(e,n.querySelectorAll?n:n===t?Ct("Invalid scope")||Y.createElement("div"):t)}},Ne=function(t){return t.sort(function(){return.5-Math.random()})},Fe=function(t){if(lt(t))return t;var e=ht(t)?t:{each:t},n=fn(e.ease),i=e.from||0,r=parseFloat(e.base)||0,s={},a=i>0&&i<1,o=isNaN(i)||a,l=e.axis,c=i,u=i;return ot(i)?c=u={center:.5,edges:.5,end:1}[i]||0:!a&&o&&(c=i[0],u=i[1]),function(t,a,h){var d,f,p,m,g,v,y,_,b,x=(h||e).length,E=s[x];if(!E){if(!(b="auto"===e.grid?0:(e.grid||[1,$])[1])){for(y=-$;y<(y=h[b++].getBoundingClientRect().left)&&b<x;);b<x&&b--}for(E=s[x]=[],d=o?Math.min(b,x)*c-.5:i%b,f=b===$?0:o?x*u/b-.5:i/b|0,y=0,_=$,v=0;v<x;v++)p=v%b-d,m=f-(v/b|0),E[v]=g=l?Math.abs("y"===l?m:p):rt(p*p+m*m),g>y&&(y=g),g<_&&(_=g);"random"===i&&Ne(E),E.max=y-_,E.min=_,E.v=x=(parseFloat(e.amount)||parseFloat(e.each)*(b>x?x-1:l?"y"===l?x/b:b:Math.max(b,x/b))||0)*("edges"===i?-1:1),E.b=x<0?r-x:r,E.u=ke(e.amount||e.each)||0,n=n&&x<0?hn(n):n}return x=(E[t]-E.min)/E.max||0,Xt(E.b+(n?n(x):x)*E.v)+E.u}},Ue=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(n){var i=Xt(Math.round(parseFloat(n)/t)*t*e);return(i-i%1)/e+(ct(n)?0:ke(n))}},Be=function(t,e){var n,i,r=gt(t);return!r&&ht(t)&&(n=r=t.radius||$,t.values?(t=Ie(t.values),(i=!ct(t[0]))&&(n*=n)):t=Ue(t.increment)),Ce(e,r?lt(t)?function(e){return i=t(e),Math.abs(i-e)<=n?i:e}:function(e){for(var r,s,a=parseFloat(i?e.x:e),o=parseFloat(i?e.y:0),l=$,c=0,u=t.length;u--;)(r=i?(r=t[u].x-a)*r+(s=t[u].y-o)*s:Math.abs(t[u]-a))<l&&(l=r,c=u);return c=!n||l<=n?t[c]:e,i||c===e||ct(e)?c:c+ke(e)}:Ue(t))},ze=function(t,e,n,i){return Ce(gt(t)?!e:!0===n?!!(n=0):!i,function(){return gt(t)?t[~~(Math.random()*t.length)]:(n=n||1e-5)&&(i=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((t-n/2+Math.random()*(e-t+.99*n))/n)*n*i)/i})},He=function(t,e,n){return Ce(n,function(n){return t[~~e(n)]})},Ve=function(t){for(var e,n,i,r,s=0,a="";~(e=t.indexOf("random(",s));)i=t.indexOf(")",e),r="["===t.charAt(e+7),n=t.substr(e+7,i-e-7).match(r?Et:vt),a+=t.substr(s,e-s)+ze(r?n:+n[0],r?0:+n[1],+n[2]||1e-5),s=i+1;return a+t.substr(s,t.length-s)},Ge=function(t,e,n,i,r){var s=e-t,a=i-n;return Ce(r,function(e){return n+((e-t)/s*a||0)})},je=function(t,e,n){var i,r,s,a=t.labels,o=$;for(i in a)(r=a[i]-e)<0===!!n&&r&&o>(r=Math.abs(r))&&(s=i,o=r);return s},We=function(t,e,n){var i,r,s,a=t.vars,o=a[e],l=V,c=t._ctx;if(o)return i=a[e+"Params"],r=a.callbackScope||t,n&&Ot.length&&Qt(),c&&(V=c),s=i?o.apply(r,i):o.call(r),V=l,s},Ye=function(t){return le(t),t.scrollTrigger&&t.scrollTrigger.kill(!!H),t.progress()<1&&We(t,"onInterrupt"),t},Xe=[],Ke=function(t){if(t)if(t=!t.name&&t.default||t,ft()||t.headless){var e=t.name,n=lt(t),i=e&&!n&&t.init?function(){this._props=[]}:t,r={init:kt,render:zn,add:Sn,kill:Vn,modifier:Hn,rawVars:0},s={targetTest:0,get:0,getSetter:Nn,aliases:{},register:0};if(an(),t!==i){if(Ft[e])return;ee(i,ee(re(t,r),s)),ne(i.prototype,ne(r,re(t,s))),Ft[i.prop=e]=i,t.targetTest&&(zt.push(i),It[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Rt(e,i),t.register&&t.register(ri,i,Wn)}else Xe.push(t)},qe=255,Qe={aqua:[0,qe,qe],lime:[0,qe,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,qe],navy:[0,0,128],white:[qe,qe,qe],olive:[128,128,0],yellow:[qe,qe,0],orange:[qe,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[qe,0,0],pink:[qe,192,203],cyan:[0,qe,qe],transparent:[qe,qe,qe,0]},Ze=function(t,e,n){return(6*(t+=t<0?1:t>1?-1:0)<1?e+(n-e)*t*6:t<.5?n:3*t<2?e+(n-e)*(2/3-t)*6:e)*qe+.5|0},Je=function(t,e,n){var i,r,s,a,o,l,c,u,h,d,f=t?ct(t)?[t>>16,t>>8&qe,t&qe]:0:Qe.black;if(!f){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),Qe[t])f=Qe[t];else if("#"===t.charAt(0)){if(t.length<6&&(i=t.charAt(1),r=t.charAt(2),s=t.charAt(3),t="#"+i+i+r+r+s+s+(5===t.length?t.charAt(4)+t.charAt(4):"")),9===t.length)return[(f=parseInt(t.substr(1,6),16))>>16,f>>8&qe,f&qe,parseInt(t.substr(7),16)/255];f=[(t=parseInt(t.substr(1),16))>>16,t>>8&qe,t&qe]}else if("hsl"===t.substr(0,3))if(f=d=t.match(vt),e){if(~t.indexOf("="))return f=t.match(yt),n&&f.length<4&&(f[3]=1),f}else a=+f[0]%360/360,o=+f[1]/100,i=2*(l=+f[2]/100)-(r=l<=.5?l*(o+1):l+o-l*o),f.length>3&&(f[3]*=1),f[0]=Ze(a+1/3,i,r),f[1]=Ze(a,i,r),f[2]=Ze(a-1/3,i,r);else f=t.match(vt)||Qe.transparent;f=f.map(Number)}return e&&!d&&(i=f[0]/qe,r=f[1]/qe,s=f[2]/qe,l=((c=Math.max(i,r,s))+(u=Math.min(i,r,s)))/2,c===u?a=o=0:(h=c-u,o=l>.5?h/(2-c-u):h/(c+u),a=c===i?(r-s)/h+(r<s?6:0):c===r?(s-i)/h+2:(i-r)/h+4,a*=60),f[0]=~~(a+.5),f[1]=~~(100*o+.5),f[2]=~~(100*l+.5)),n&&f.length<4&&(f[3]=1),f},$e=function(t){var e=[],n=[],i=-1;return t.split(en).forEach(function(t){var r=t.match(_t)||[];e.push.apply(e,r),n.push(i+=r.length+1)}),e.c=n,e},tn=function(t,e,n){var i,r,s,a,o="",l=(t+o).match(en),c=e?"hsla(":"rgba(",u=0;if(!l)return t;if(l=l.map(function(t){return(t=Je(t,e,1))&&c+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"}),n&&(s=$e(t),(i=n.c).join(o)!==s.c.join(o)))for(a=(r=t.replace(en,"1").split(_t)).length-1;u<a;u++)o+=r[u]+(~i.indexOf(u)?l.shift()||c+"0,0,0,0)":(s.length?s:l.length?l:n).shift());if(!r)for(a=(r=t.split(en)).length-1;u<a;u++)o+=r[u]+l[u];return o+r[a]},en=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(t in Qe)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),nn=/hsl[a]?\(/,rn=function(t){var e,n=t.join(" ");if(en.lastIndex=0,en.test(n))return e=nn.test(n),t[1]=tn(t[1],e),t[0]=tn(t[0],e,$e(t[1])),!0},sn=function(){var t,e,n,i,r,s,a=Date.now,o=500,l=33,c=a(),u=c,h=1e3/240,d=h,f=[],p=function n(p){var m,g,v,y,_=a()-u,b=!0===p;if((_>o||_<0)&&(c+=_-l),((m=(v=(u+=_)-c)-d)>0||b)&&(y=++i.frame,r=v-1e3*i.time,i.time=v/=1e3,d+=m+(m>=h?4:h-m),g=1),b||(t=e(n)),g)for(s=0;s<f.length;s++)f[s](v,r,y,p)};return i={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(t){return r/(1e3/(t||60))},wake:function(){X&&(!W&&ft()&&(j=W=window,Y=j.document||{},St.gsap=ri,(j.gsapVersions||(j.gsapVersions=[])).push(ri.version),Mt(Tt||j.GreenSockGlobals||!j.gsap&&j||{}),Xe.forEach(Ke)),n="undefined"!==typeof requestAnimationFrame&&requestAnimationFrame,t&&i.sleep(),e=n||function(t){return setTimeout(t,d-1e3*i.time+1|0)},Q=1,p(2))},sleep:function(){(n?cancelAnimationFrame:clearTimeout)(t),Q=0,e=kt},lagSmoothing:function(t,e){o=t||1/0,l=Math.min(e||33,o)},fps:function(t){h=1e3/(t||240),d=1e3*i.time+h},add:function(t,e,n){var r=e?function(e,n,s,a){t(e,n,s,a),i.remove(r)}:t;return i.remove(t),f[n?"unshift":"push"](r),an(),r},remove:function(t,e){~(e=f.indexOf(t))&&f.splice(e,1)&&s>=e&&s--},_listeners:f}}(),an=function(){return!Q&&sn.wake()},on={},ln=/^[\d.\-M][\d.\-,\s]/,cn=/["']/g,un=function(t){for(var e,n,i,r={},s=t.substr(1,t.length-3).split(":"),a=s[0],o=1,l=s.length;o<l;o++)n=s[o],e=o!==l-1?n.lastIndexOf(","):n.length,i=n.substr(0,e),r[a]=isNaN(i)?i.replace(cn,"").trim():+i,a=n.substr(e+1).trim();return r},hn=function(t){return function(e){return 1-t(1-e)}},dn=function t(e,n){for(var i,r=e._first;r;)r instanceof bn?t(r,n):!r.vars.yoyoEase||r._yoyo&&r._repeat||r._yoyo===n||(r.timeline?t(r.timeline,n):(i=r._ease,r._ease=r._yEase,r._yEase=i,r._yoyo=n)),r=r._next},fn=function(t,e){return t&&(lt(t)?t:on[t]||function(t){var e=(t+"").split("("),n=on[e[0]];return n&&e.length>1&&n.config?n.config.apply(null,~t.indexOf("{")?[un(e[1])]:function(t){var e=t.indexOf("(")+1,n=t.indexOf(")"),i=t.indexOf("(",e);return t.substring(e,~i&&i<n?t.indexOf(")",n+1):n)}(t).split(",").map($t)):on._CE&&ln.test(t)?on._CE("",t):n}(t))||e},pn=function(t,e,n,i){void 0===n&&(n=function(t){return 1-e(1-t)}),void 0===i&&(i=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var r,s={easeIn:e,easeOut:n,easeInOut:i};return Wt(t,function(t){for(var e in on[t]=St[t]=s,on[r=t.toLowerCase()]=n,s)on[r+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=on[t+"."+e]=s[e]}),s},mn=function(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}},gn=function t(e,n,i){var r=n>=1?n:1,s=(i||(e?.3:.45))/(n<1?n:1),a=s/et*(Math.asin(1/r)||0),o=function(t){return 1===t?1:r*Math.pow(2,-10*t)*at((t-a)*s)+1},l="out"===e?o:"in"===e?function(t){return 1-o(1-t)}:mn(o);return s=et/s,l.config=function(n,i){return t(e,n,i)},l},vn=function t(e,n){void 0===n&&(n=1.70158);var i=function(t){return t?--t*t*((n+1)*t+n)+1:0},r="out"===e?i:"in"===e?function(t){return 1-i(1-t)}:mn(i);return r.config=function(n){return t(e,n)},r};Wt("Linear,Quad,Cubic,Quart,Quint,Strong",function(t,e){var n=e<5?e+1:e;pn(t+",Power"+(n-1),e?function(t){return Math.pow(t,n)}:function(t){return t},function(t){return 1-Math.pow(1-t,n)},function(t){return t<.5?Math.pow(2*t,n)/2:1-Math.pow(2*(1-t),n)/2})}),on.Linear.easeNone=on.none=on.Linear.easeIn,pn("Elastic",gn("in"),gn("out"),gn()),function(t,e){var n=1/e,i=2*n,r=2.5*n,s=function(s){return s<n?t*s*s:s<i?t*Math.pow(s-1.5/e,2)+.75:s<r?t*(s-=2.25/e)*s+.9375:t*Math.pow(s-2.625/e,2)+.984375};pn("Bounce",function(t){return 1-s(1-t)},s)}(7.5625,2.75),pn("Expo",function(t){return Math.pow(2,10*(t-1))*t+t*t*t*t*t*t*(1-t)}),pn("Circ",function(t){return-(rt(1-t*t)-1)}),pn("Sine",function(t){return 1===t?1:1-st(t*nt)}),pn("Back",vn("in"),vn("out"),vn()),on.SteppedEase=on.steps=St.SteppedEase={config:function(t,e){void 0===t&&(t=1);var n=1/t,i=t+(e?0:1),r=e?1:0;return function(t){return((i*Re(0,.99999999,t)|0)+r)*n}}},J.ease=on["quad.out"],Wt("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(t){return Ht+=t+","+t+"Params,"});var yn=function(t,e){this.id=it++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:jt,this.set=e?e.getSetter:Nn},_n=function(){function t(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,we(this,+t.duration,1,1),this.data=t.data,V&&(this._ctx=V,V.data.push(this)),Q||sn.wake()}var e=t.prototype;return e.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},e.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},e.totalDuration=function(t){return arguments.length?(this._dirty=0,we(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(t,e){if(an(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(ge(this,t),!n._dp||n.parent||ve(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&ye(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!e||this._initted&&Math.abs(this._zTime)===tt||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),Jt(this,t,e)),this},e.time=function(t,e){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+de(this))%(this._dur+this._rDelay)||(t?this._dur:0),e):this._time},e.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+de(this),e):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(t,e){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*n,e):this._repeat?fe(this._tTime,n)+1:1},e.timeScale=function(t,e){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===t)return this;var n=this.parent&&this._ts?pe(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||-1e-8===t?0:this._rts,this.totalTime(Re(-Math.abs(this._delay),this.totalDuration(),n),!1!==e),me(this),function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t}(this)},e.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(an(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==tt&&(this._tTime-=tt)))),this):this._ps},e.startTime=function(t){if(arguments.length){this._start=t;var e=this.parent||this._dp;return e&&(e._sort||!this.parent)&&ye(e,this,t-this._delay),this}return this._start},e.endTime=function(t){return this._start+(dt(t)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?pe(e.rawTime(t),this):this._tTime:this._tTime},e.revert=function(t){void 0===t&&(t=Pt);var e=H;return H=t,Zt(this)&&(this.timeline&&this.timeline.revert(t),this.totalTime(-.01,t.suppressEvents)),"nested"!==this.data&&!1!==t.kill&&this.kill(),H=e,this},e.globalTime=function(t){for(var e=this,n=arguments.length?t:e.rawTime();e;)n=e._start+n/(Math.abs(e._ts)||1),e=e._dp;return!this.parent&&this._sat?this._sat.globalTime(t):n},e.repeat=function(t){return arguments.length?(this._repeat=t===1/0?-2:t,Se(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(t){if(arguments.length){var e=this._time;return this._rDelay=t,Se(this),e?this.time(e):this}return this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,e){return this.totalTime(Me(this,t),dt(e))},e.restart=function(t,e){return this.play().totalTime(t?-this._delay:0,dt(e)),this._dur||(this._zTime=-1e-8),this},e.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},e.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},e.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var t,e=this.parent||this._dp,n=this._start;return!(e&&!(this._ts&&this._initted&&e.isActive()&&(t=e.rawTime(!0))>=n&&t<this.endTime(!0)-tt))},e.eventCallback=function(t,e,n){var i=this.vars;return arguments.length>1?(e?(i[t]=e,n&&(i[t+"Params"]=n),"onUpdate"===t&&(this._onUpdate=e)):delete i[t],this):i[t]},e.then=function(t){var e=this;return new Promise(function(n){var i=lt(t)?t:te,r=function(){var t=e.then;e.then=null,lt(i)&&(i=i(e))&&(i.then||i===e)&&(e.then=t),n(i),e.then=t};e._initted&&1===e.totalProgress()&&e._ts>=0||!e._tTime&&e._ts<0?r():e._prom=r})},e.kill=function(){Ye(this)},t}();ee(_n.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var bn=function(t){function e(e,n){var i;return void 0===e&&(e={}),(i=t.call(this,e)||this).labels={},i.smoothChildTiming=!!e.smoothChildTiming,i.autoRemoveChildren=!!e.autoRemoveChildren,i._sort=dt(e.sortChildren),G&&ye(e.parent||G,U(i),n),e.reversed&&i.reverse(),e.paused&&i.paused(!0),e.scrollTrigger&&_e(U(i),e.scrollTrigger),i}B(e,t);var n=e.prototype;return n.to=function(t,e,n){return Ae(0,arguments,this),this},n.from=function(t,e,n){return Ae(1,arguments,this),this},n.fromTo=function(t,e,n,i){return Ae(2,arguments,this),this},n.set=function(t,e,n){return e.duration=0,e.parent=this,se(e).repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new Ln(t,e,Me(this,n),1),this},n.call=function(t,e,n){return ye(this,Ln.delayedCall(0,t,e),n)},n.staggerTo=function(t,e,n,i,r,s,a){return n.duration=e,n.stagger=n.stagger||i,n.onComplete=s,n.onCompleteParams=a,n.parent=this,new Ln(t,n,Me(this,r)),this},n.staggerFrom=function(t,e,n,i,r,s,a){return n.runBackwards=1,se(n).immediateRender=dt(n.immediateRender),this.staggerTo(t,e,n,i,r,s,a)},n.staggerFromTo=function(t,e,n,i,r,s,a,o){return i.startAt=n,se(i).immediateRender=dt(i.immediateRender),this.staggerTo(t,e,i,r,s,a,o)},n.render=function(t,e,n){var i,r,s,a,o,l,c,u,h,d,f,p,m=this._time,g=this._dirty?this.totalDuration():this._tDur,v=this._dur,y=t<=0?0:Xt(t),_=this._zTime<0!==t<0&&(this._initted||!v);if(this!==G&&y>g&&t>=0&&(y=g),y!==this._tTime||n||_){if(m!==this._time&&v&&(y+=this._time-m,t+=this._time-m),i=y,h=this._start,l=!(u=this._ts),_&&(v||(m=this._zTime),(t||!e)&&(this._zTime=t)),this._repeat){if(f=this._yoyo,o=v+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*o+t,e,n);if(i=Xt(y%o),y===g?(a=this._repeat,i=v):((a=~~(d=Xt(y/o)))&&a===d&&(i=v,a--),i>v&&(i=v)),d=fe(this._tTime,o),!m&&this._tTime&&d!==a&&this._tTime-d*o-this._dur<=0&&(d=a),f&&1&a&&(i=v-i,p=1),a!==d&&!this._lock){var b=f&&1&d,x=b===(f&&1&a);if(a<d&&(b=!b),m=b?0:y%v?v:y,this._lock=1,this.render(m||(p?0:Xt(a*o)),e,!v)._lock=0,this._tTime=y,!e&&this.parent&&We(this,"onRepeat"),this.vars.repeatRefresh&&!p&&(this.invalidate()._lock=1),m&&m!==this._time||l!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(v=this._dur,g=this._tDur,x&&(this._lock=2,m=b?v:-1e-4,this.render(m,!0),this.vars.repeatRefresh&&!p&&this.invalidate()),this._lock=0,!this._ts&&!l)return this;dn(this,p)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(c=function(t,e,n){var i;if(n>e)for(i=t._first;i&&i._start<=n;){if("isPause"===i.data&&i._start>e)return i;i=i._next}else for(i=t._last;i&&i._start>=n;){if("isPause"===i.data&&i._start<e)return i;i=i._prev}}(this,Xt(m),Xt(i)),c&&(y-=i-(i=c._start))),this._tTime=y,this._time=i,this._act=!u,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t,m=0),!m&&y&&!e&&!d&&(We(this,"onStart"),this._tTime!==y))return this;if(i>=m&&t>=0)for(r=this._first;r;){if(s=r._next,(r._act||i>=r._start)&&r._ts&&c!==r){if(r.parent!==this)return this.render(t,e,n);if(r.render(r._ts>0?(i-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(i-r._start)*r._ts,e,n),i!==this._time||!this._ts&&!l){c=0,s&&(y+=this._zTime=-1e-8);break}}r=s}else{r=this._last;for(var E=t<0?t:i;r;){if(s=r._prev,(r._act||E<=r._end)&&r._ts&&c!==r){if(r.parent!==this)return this.render(t,e,n);if(r.render(r._ts>0?(E-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(E-r._start)*r._ts,e,n||H&&Zt(r)),i!==this._time||!this._ts&&!l){c=0,s&&(y+=this._zTime=E?-1e-8:tt);break}}r=s}}if(c&&!e&&(this.pause(),c.render(i>=m?0:-1e-8)._zTime=i>=m?1:-1,this._ts))return this._start=h,me(this),this.render(t,e,n);this._onUpdate&&!e&&We(this,"onUpdate",!0),(y===g&&this._tTime>=this.totalDuration()||!y&&m)&&(h!==this._start&&Math.abs(u)===Math.abs(this._ts)||this._lock||((t||!v)&&(y===g&&this._ts>0||!y&&this._ts<0)&&le(this,1),e||t<0&&!m||!y&&!m&&g||(We(this,y===g&&t>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(y<g&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(t,e){var n=this;if(ct(e)||(e=Me(this,e,t)),!(t instanceof _n)){if(gt(t))return t.forEach(function(t){return n.add(t,e)}),this;if(ot(t))return this.addLabel(t,e);if(!lt(t))return this;t=Ln.delayedCall(0,t)}return this!==t?ye(this,t,e):this},n.getChildren=function(t,e,n,i){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===i&&(i=-$);for(var r=[],s=this._first;s;)s._start>=i&&(s instanceof Ln?e&&r.push(s):(n&&r.push(s),t&&r.push.apply(r,s.getChildren(!0,e,n)))),s=s._next;return r},n.getById=function(t){for(var e=this.getChildren(1,1,1),n=e.length;n--;)if(e[n].vars.id===t)return e[n]},n.remove=function(t){return ot(t)?this.removeLabel(t):lt(t)?this.killTweensOf(t):(t.parent===this&&oe(this,t),t===this._recent&&(this._recent=this._last),ce(this))},n.totalTime=function(e,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Xt(sn.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts))),t.prototype.totalTime.call(this,e,n),this._forcing=0,this):this._tTime},n.addLabel=function(t,e){return this.labels[t]=Me(this,e),this},n.removeLabel=function(t){return delete this.labels[t],this},n.addPause=function(t,e,n){var i=Ln.delayedCall(0,e||kt,n);return i.data="isPause",this._hasPause=1,ye(this,i,Me(this,t))},n.removePause=function(t){var e=this._first;for(t=Me(this,t);e;)e._start===t&&"isPause"===e.data&&le(e),e=e._next},n.killTweensOf=function(t,e,n){for(var i=this.getTweensOf(t,n),r=i.length;r--;)xn!==i[r]&&i[r].kill(t,e);return this},n.getTweensOf=function(t,e){for(var n,i=[],r=Ie(t),s=this._first,a=ct(e);s;)s instanceof Ln?qt(s._targets,r)&&(a?(!xn||s._initted&&s._ts)&&s.globalTime(0)<=e&&s.globalTime(s.totalDuration())>e:!e||s.isActive())&&i.push(s):(n=s.getTweensOf(r,e)).length&&i.push.apply(i,n),s=s._next;return i},n.tweenTo=function(t,e){e=e||{};var n,i=this,r=Me(i,t),s=e,a=s.startAt,o=s.onStart,l=s.onStartParams,c=s.immediateRender,u=Ln.to(i,ee({ease:e.ease||"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:e.duration||Math.abs((r-(a&&"time"in a?a.time:i._time))/i.timeScale())||tt,onStart:function(){if(i.pause(),!n){var t=e.duration||Math.abs((r-(a&&"time"in a?a.time:i._time))/i.timeScale());u._dur!==t&&we(u,t,0,1).render(u._time,!0,!0),n=1}o&&o.apply(u,l||[])}},e));return c?u.render(0):u},n.tweenFromTo=function(t,e,n){return this.tweenTo(e,ee({startAt:{time:Me(this,t)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(t){return void 0===t&&(t=this._time),je(this,Me(this,t))},n.previousLabel=function(t){return void 0===t&&(t=this._time),je(this,Me(this,t),1)},n.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+tt)},n.shiftChildren=function(t,e,n){void 0===n&&(n=0);for(var i,r=this._first,s=this.labels;r;)r._start>=n&&(r._start+=t,r._end+=t),r=r._next;if(e)for(i in s)s[i]>=n&&(s[i]+=t);return ce(this)},n.invalidate=function(e){var n=this._first;for(this._lock=0;n;)n.invalidate(e),n=n._next;return t.prototype.invalidate.call(this,e)},n.clear=function(t){void 0===t&&(t=!0);for(var e,n=this._first;n;)e=n._next,this.remove(n),n=e;return this._dp&&(this._time=this._tTime=this._pTime=0),t&&(this.labels={}),ce(this)},n.totalDuration=function(t){var e,n,i,r=0,s=this,a=s._last,o=$;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-t:t));if(s._dirty){for(i=s.parent;a;)e=a._prev,a._dirty&&a.totalDuration(),(n=a._start)>o&&s._sort&&a._ts&&!s._lock?(s._lock=1,ye(s,a,n-a._delay,1)._lock=0):o=n,n<0&&a._ts&&(r-=n,(!i&&!s._dp||i&&i.smoothChildTiming)&&(s._start+=n/s._ts,s._time-=n,s._tTime-=n),s.shiftChildren(-n,!1,-Infinity),o=0),a._end>r&&a._ts&&(r=a._end),a=e;we(s,s===G&&s._time>r?s._time:r,1,1),s._dirty=0}return s._tDur},e.updateRoot=function(t){if(G._ts&&(Jt(G,pe(t,G)),K=sn.frame),sn.frame>=Bt){Bt+=Z.autoSleep||120;var e=G._first;if((!e||!e._ts)&&Z.autoSleep&&sn._listeners.length<2){for(;e&&!e._ts;)e=e._next;e||sn.sleep()}}},e}(_n);ee(bn.prototype,{_lock:0,_hasPause:0,_forcing:0});var xn,En,wn=function(t,e,n,i,r,s,a){var o,l,c,u,h,d,f,p,m=new Wn(this._pt,t,e,0,1,Bn,null,r),g=0,v=0;for(m.b=n,m.e=i,n+="",(f=~(i+="").indexOf("random("))&&(i=Ve(i)),s&&(s(p=[n,i],t,e),n=p[0],i=p[1]),l=n.match(bt)||[];o=bt.exec(i);)u=o[0],h=i.substring(g,o.index),c?c=(c+1)%5:"rgba("===h.substr(-5)&&(c=1),u!==l[v++]&&(d=parseFloat(l[v-1])||0,m._pt={_next:m._pt,p:h||1===v?h:",",s:d,c:"="===u.charAt(1)?Kt(d,u)-d:parseFloat(u)-d,m:c&&c<4?Math.round:0},g=bt.lastIndex);return m.c=g<i.length?i.substring(g,i.length):"",m.fp=a,(xt.test(i)||f)&&(m.e=0),this._pt=m,m},Sn=function(t,e,n,i,r,s,a,o,l,c){lt(i)&&(i=i(r||0,t,s));var u,h=t[e],d="get"!==n?n:lt(h)?l?t[e.indexOf("set")||!lt(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():h,f=lt(h)?l?In:Pn:Dn;if(ot(i)&&(~i.indexOf("random(")&&(i=Ve(i)),"="===i.charAt(1)&&((u=Kt(d,i)+(ke(d)||0))||0===u)&&(i=u)),!c||d!==i||En)return isNaN(d*i)||""===i?(!h&&!(e in t)&&At(e,i),wn.call(this,t,e,d,i,f,o||Z.stringFilter,l)):(u=new Wn(this._pt,t,e,+d||0,i-(d||0),"boolean"===typeof h?Un:Fn,0,f),l&&(u.fp=l),a&&u.modifier(a,this,t),this._pt=u)},Tn=function(t,e,n,i,r,s){var a,o,l,c;if(Ft[t]&&!1!==(a=new Ft[t]).init(r,a.rawVars?e[t]:function(t,e,n,i,r){if(lt(t)&&(t=Cn(t,r,e,n,i)),!ht(t)||t.style&&t.nodeType||gt(t)||mt(t))return ot(t)?Cn(t,r,e,n,i):t;var s,a={};for(s in t)a[s]=Cn(t[s],r,e,n,i);return a}(e[t],i,r,s,n),n,i,s)&&(n._pt=o=new Wn(n._pt,r,t,0,1,a.render,a,0,a.priority),n!==q))for(l=n._ptLookup[n._targets.indexOf(r)],c=a._props.length;c--;)l[a._props[c]]=o;return a},Mn=function t(e,n,i){var r,s,a,o,l,c,u,h,d,f,p,m,g,v=e.vars,y=v.ease,_=v.startAt,b=v.immediateRender,x=v.lazy,E=v.onUpdate,w=v.runBackwards,S=v.yoyoEase,T=v.keyframes,M=v.autoRevert,A=e._dur,C=e._startAt,R=e._targets,k=e.parent,L=k&&"nested"===k.data?k.vars.targets:R,D="auto"===e._overwrite&&!z,P=e.timeline;if(P&&(!T||!y)&&(y="none"),e._ease=fn(y,J.ease),e._yEase=S?hn(fn(!0===S?y:S,J.ease)):0,S&&e._yoyo&&!e._repeat&&(S=e._yEase,e._yEase=e._ease,e._ease=S),e._from=!P&&!!v.runBackwards,!P||T&&!v.stagger){if(m=(h=R[0]?Gt(R[0]).harness:0)&&v[h.prop],r=re(v,It),C&&(C._zTime<0&&C.progress(1),n<0&&w&&b&&!M?C.render(-1,!0):C.revert(w&&A?Dt:Lt),C._lazy=0),_){if(le(e._startAt=Ln.set(R,ee({data:"isStart",overwrite:!1,parent:k,immediateRender:!0,lazy:!C&&dt(x),startAt:null,delay:0,onUpdate:E&&function(){return We(e,"onUpdate")},stagger:0},_))),e._startAt._dp=0,e._startAt._sat=e,n<0&&(H||!b&&!M)&&e._startAt.revert(Dt),b&&A&&n<=0&&i<=0)return void(n&&(e._zTime=n))}else if(w&&A&&!C)if(n&&(b=!1),a=ee({overwrite:!1,data:"isFromStart",lazy:b&&!C&&dt(x),immediateRender:b,stagger:0,parent:k},r),m&&(a[h.prop]=m),le(e._startAt=Ln.set(R,a)),e._startAt._dp=0,e._startAt._sat=e,n<0&&(H?e._startAt.revert(Dt):e._startAt.render(-1,!0)),e._zTime=n,b){if(!n)return}else t(e._startAt,tt,tt);for(e._pt=e._ptCache=0,x=A&&dt(x)||x&&!A,s=0;s<R.length;s++){if(u=(l=R[s])._gsap||Vt(R)[s]._gsap,e._ptLookup[s]=f={},Nt[u.id]&&Ot.length&&Qt(),p=L===R?s:L.indexOf(l),h&&!1!==(d=new h).init(l,m||r,e,p,L)&&(e._pt=o=new Wn(e._pt,l,d.name,0,1,d.render,d,0,d.priority),d._props.forEach(function(t){f[t]=o}),d.priority&&(c=1)),!h||m)for(a in r)Ft[a]&&(d=Tn(a,r,e,p,l,L))?d.priority&&(c=1):f[a]=o=Sn.call(e,l,a,"get",r[a],p,L,0,v.stringFilter);e._op&&e._op[s]&&e.kill(l,e._op[s]),D&&e._pt&&(xn=e,G.killTweensOf(l,f,e.globalTime(n)),g=!e.parent,xn=0),e._pt&&x&&(Nt[u.id]=1)}c&&jn(e),e._onInit&&e._onInit(e)}e._onUpdate=E,e._initted=(!e._op||e._pt)&&!g,T&&n<=0&&P.render($,!0,!0)},An=function(t,e,n,i){var r,s,a=e.ease||i||"power1.inOut";if(gt(e))s=n[t]||(n[t]=[]),e.forEach(function(t,n){return s.push({t:n/(e.length-1)*100,v:t,e:a})});else for(r in e)s=n[r]||(n[r]=[]),"ease"===r||s.push({t:parseFloat(t),v:e[r],e:a})},Cn=function(t,e,n,i,r){return lt(t)?t.call(e,n,i,r):ot(t)&&~t.indexOf("random(")?Ve(t):t},Rn=Ht+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",kn={};Wt(Rn+",id,stagger,delay,duration,paused,scrollTrigger",function(t){return kn[t]=1});var Ln=function(t){function e(e,n,i,r){var s;"number"===typeof n&&(i.duration=n,n=i,i=null);var a,o,l,c,u,h,d,f,p=(s=t.call(this,r?n:se(n))||this).vars,m=p.duration,g=p.delay,v=p.immediateRender,y=p.stagger,_=p.overwrite,b=p.keyframes,x=p.defaults,E=p.scrollTrigger,w=p.yoyoEase,S=n.parent||G,T=(gt(e)||mt(e)?ct(e[0]):"length"in n)?[e]:Ie(e);if(s._targets=T.length?Vt(T):Ct("GSAP target "+e+" not found. https://gsap.com",!Z.nullTargetWarn)||[],s._ptLookup=[],s._overwrite=_,b||y||pt(m)||pt(g)){if(n=s.vars,(a=s.timeline=new bn({data:"nested",defaults:x||{},targets:S&&"nested"===S.data?S.vars.targets:T})).kill(),a.parent=a._dp=U(s),a._start=0,y||pt(m)||pt(g)){if(c=T.length,d=y&&Fe(y),ht(y))for(u in y)~Rn.indexOf(u)&&(f||(f={}),f[u]=y[u]);for(o=0;o<c;o++)(l=re(n,kn)).stagger=0,w&&(l.yoyoEase=w),f&&ne(l,f),h=T[o],l.duration=+Cn(m,U(s),o,h,T),l.delay=(+Cn(g,U(s),o,h,T)||0)-s._delay,!y&&1===c&&l.delay&&(s._delay=g=l.delay,s._start+=g,l.delay=0),a.to(h,l,d?d(o,h,T):0),a._ease=on.none;a.duration()?m=g=0:s.timeline=0}else if(b){se(ee(a.vars.defaults,{ease:"none"})),a._ease=fn(b.ease||n.ease||"none");var M,A,C,R=0;if(gt(b))b.forEach(function(t){return a.to(T,t,">")}),a.duration();else{for(u in l={},b)"ease"===u||"easeEach"===u||An(u,b[u],l,b.easeEach);for(u in l)for(M=l[u].sort(function(t,e){return t.t-e.t}),R=0,o=0;o<M.length;o++)(C={ease:(A=M[o]).e,duration:(A.t-(o?M[o-1].t:0))/100*m})[u]=A.v,a.to(T,C,R),R+=C.duration;a.duration()<m&&a.to({},{duration:m-a.duration()})}}m||s.duration(m=a.duration())}else s.timeline=0;return!0!==_||z||(xn=U(s),G.killTweensOf(T),xn=0),ye(S,U(s),i),n.reversed&&s.reverse(),n.paused&&s.paused(!0),(v||!m&&!b&&s._start===Xt(S._time)&&dt(v)&&he(U(s))&&"nested"!==S.data)&&(s._tTime=-1e-8,s.render(Math.max(0,-g)||0)),E&&_e(U(s),E),s}B(e,t);var n=e.prototype;return n.render=function(t,e,n){var i,r,s,a,o,l,c,u,h,d=this._time,f=this._tDur,p=this._dur,m=t<0,g=t>f-tt&&!m?f:t<tt?0:t;if(p){if(g!==this._tTime||!t||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==m||this._lazy){if(i=g,u=this.timeline,this._repeat){if(a=p+this._rDelay,this._repeat<-1&&m)return this.totalTime(100*a+t,e,n);if(i=Xt(g%a),g===f?(s=this._repeat,i=p):(s=~~(o=Xt(g/a)))&&s===o?(i=p,s--):i>p&&(i=p),(l=this._yoyo&&1&s)&&(h=this._yEase,i=p-i),o=fe(this._tTime,a),i===d&&!n&&this._initted&&s===o)return this._tTime=g,this;s!==o&&(u&&this._yEase&&dn(u,l),this.vars.repeatRefresh&&!l&&!this._lock&&i!==a&&this._initted&&(this._lock=n=1,this.render(Xt(a*s),!0).invalidate()._lock=0))}if(!this._initted){if(be(this,m?t:i,n,e,g))return this._tTime=0,this;if(d!==this._time&&(!n||!this.vars.repeatRefresh||s===o))return this;if(p!==this._dur)return this.render(t,e,n)}if(this._tTime=g,this._time=i,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=c=(h||this._ease)(i/p),this._from&&(this.ratio=c=1-c),!d&&g&&!e&&!o&&(We(this,"onStart"),this._tTime!==g))return this;for(r=this._pt;r;)r.r(c,r.d),r=r._next;u&&u.render(t<0?t:u._dur*u._ease(i/this._dur),e,n)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(m&&ue(this,t,0,n),We(this,"onUpdate")),this._repeat&&s!==o&&this.vars.onRepeat&&!e&&this.parent&&We(this,"onRepeat"),g!==this._tDur&&g||this._tTime!==g||(m&&!this._onUpdate&&ue(this,t,0,!0),(t||!p)&&(g===this._tDur&&this._ts>0||!g&&this._ts<0)&&le(this,1),e||m&&!d||!(g||d||l)||(We(this,g===f?"onComplete":"onReverseComplete",!0),this._prom&&!(g<f&&this.timeScale()>0)&&this._prom()))}}else!function(t,e,n,i){var r,s,a,o=t.ratio,l=e<0||!e&&(!t._start&&xe(t)&&(t._initted||!Ee(t))||(t._ts<0||t._dp._ts<0)&&!Ee(t))?0:1,c=t._rDelay,u=0;if(c&&t._repeat&&(u=Re(0,t._tDur,e),s=fe(u,c),t._yoyo&&1&s&&(l=1-l),s!==fe(t._tTime,c)&&(o=1-l,t.vars.repeatRefresh&&t._initted&&t.invalidate())),l!==o||H||i||t._zTime===tt||!e&&t._zTime){if(!t._initted&&be(t,e,i,n,u))return;for(a=t._zTime,t._zTime=e||(n?tt:0),n||(n=e&&!a),t.ratio=l,t._from&&(l=1-l),t._time=0,t._tTime=u,r=t._pt;r;)r.r(l,r.d),r=r._next;e<0&&ue(t,e,0,!0),t._onUpdate&&!n&&We(t,"onUpdate"),u&&t._repeat&&!n&&t.parent&&We(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===l&&(l&&le(t,1),n||H||(We(t,l?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)}(this,t,e,n);return this},n.targets=function(){return this._targets},n.invalidate=function(e){return(!e||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(e),t.prototype.invalidate.call(this,e)},n.resetTo=function(t,e,n,i,r){Q||sn.wake(),this._ts||this.play();var s=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||Mn(this,s),function(t,e,n,i,r,s,a,o){var l,c,u,h,d=(t._pt&&t._ptCache||(t._ptCache={}))[e];if(!d)for(d=t._ptCache[e]=[],u=t._ptLookup,h=t._targets.length;h--;){if((l=u[h][e])&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==e&&l.fp!==e;)l=l._next;if(!l)return En=1,t.vars[e]="+=0",Mn(t,a),En=0,o?Ct(e+" not eligible for reset"):1;d.push(l)}for(h=d.length;h--;)(l=(c=d[h])._pt||c).s=!i&&0!==i||r?l.s+(i||0)+s*l.c:i,l.c=n-l.s,c.e&&(c.e=Yt(n)+ke(c.e)),c.b&&(c.b=l.s+ke(c.b))}(this,t,e,n,i,this._ease(s/this._dur),s,r)?this.resetTo(t,e,n,i,1):(ge(this,0),this.parent||ae(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},n.kill=function(t,e){if(void 0===e&&(e="all"),!t&&(!e||"all"===e))return this._lazy=this._pt=0,this.parent?Ye(this):this.scrollTrigger&&this.scrollTrigger.kill(!!H),this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(t,e,xn&&!0!==xn.vars.overwrite)._first||Ye(this),this.parent&&n!==this.timeline.totalDuration()&&we(this,this._dur*this.timeline._tDur/n,0,1),this}var i,r,s,a,o,l,c,u=this._targets,h=t?Ie(t):u,d=this._ptLookup,f=this._pt;if((!e||"all"===e)&&function(t,e){for(var n=t.length,i=n===e.length;i&&n--&&t[n]===e[n];);return n<0}(u,h))return"all"===e&&(this._pt=0),Ye(this);for(i=this._op=this._op||[],"all"!==e&&(ot(e)&&(o={},Wt(e,function(t){return o[t]=1}),e=o),e=function(t,e){var n,i,r,s,a=t[0]?Gt(t[0]).harness:0,o=a&&a.aliases;if(!o)return e;for(i in n=ne({},e),o)if(i in n)for(r=(s=o[i].split(",")).length;r--;)n[s[r]]=n[i];return n}(u,e)),c=u.length;c--;)if(~h.indexOf(u[c]))for(o in r=d[c],"all"===e?(i[c]=e,a=r,s={}):(s=i[c]=i[c]||{},a=e),a)(l=r&&r[o])&&("kill"in l.d&&!0!==l.d.kill(o)||oe(this,l,"_pt"),delete r[o]),"all"!==s&&(s[o]=1);return this._initted&&!this._pt&&f&&Ye(this),this},e.to=function(t,n){return new e(t,n,arguments[2])},e.from=function(t,e){return Ae(1,arguments)},e.delayedCall=function(t,n,i,r){return new e(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:n,onReverseComplete:n,onCompleteParams:i,onReverseCompleteParams:i,callbackScope:r})},e.fromTo=function(t,e,n){return Ae(2,arguments)},e.set=function(t,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new e(t,n)},e.killTweensOf=function(t,e,n){return G.killTweensOf(t,e,n)},e}(_n);ee(Ln.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),Wt("staggerTo,staggerFrom,staggerFromTo",function(t){Ln[t]=function(){var e=new bn,n=Le.call(arguments,0);return n.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,n)}});var Dn=function(t,e,n){return t[e]=n},Pn=function(t,e,n){return t[e](n)},In=function(t,e,n,i){return t[e](i.fp,n)},On=function(t,e,n){return t.setAttribute(e,n)},Nn=function(t,e){return lt(t[e])?Pn:ut(t[e])&&t.setAttribute?On:Dn},Fn=function(t,e){return e.set(e.t,e.p,Math.round(1e6*(e.s+e.c*t))/1e6,e)},Un=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},Bn=function(t,e){var n=e._pt,i="";if(!t&&e.b)i=e.b;else if(1===t&&e.e)i=e.e;else{for(;n;)i=n.p+(n.m?n.m(n.s+n.c*t):Math.round(1e4*(n.s+n.c*t))/1e4)+i,n=n._next;i+=e.c}e.set(e.t,e.p,i,e)},zn=function(t,e){for(var n=e._pt;n;)n.r(t,n.d),n=n._next},Hn=function(t,e,n,i){for(var r,s=this._pt;s;)r=s._next,s.p===i&&s.modifier(t,e,n),s=r},Vn=function(t){for(var e,n,i=this._pt;i;)n=i._next,i.p===t&&!i.op||i.op===t?oe(this,i,"_pt"):i.dep||(e=1),i=n;return!e},Gn=function(t,e,n,i){i.mSet(t,e,i.m.call(i.tween,n,i.mt),i)},jn=function(t){for(var e,n,i,r,s=t._pt;s;){for(e=s._next,n=i;n&&n.pr>s.pr;)n=n._next;(s._prev=n?n._prev:r)?s._prev._next=s:i=s,(s._next=n)?n._prev=s:r=s,s=e}t._pt=i},Wn=function(){function t(t,e,n,i,r,s,a,o,l){this.t=e,this.s=i,this.c=r,this.p=n,this.r=s||Fn,this.d=a||this,this.set=o||Dn,this.pr=l||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,e,n){this.mSet=this.mSet||this.set,this.set=Gn,this.m=t,this.mt=n,this.tween=e},t}();Wt(Ht+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(t){return It[t]=1}),St.TweenMax=St.TweenLite=Ln,St.TimelineLite=St.TimelineMax=bn,G=new bn({sortChildren:!1,defaults:J,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),Z.stringFilter=rn;var Yn=[],Xn={},Kn=[],qn=0,Qn=0,Zn=function(t){return(Xn[t]||Kn).map(function(t){return t()})},Jn=function(){var t=Date.now(),e=[];t-qn>2&&(Zn("matchMediaInit"),Yn.forEach(function(t){var n,i,r,s,a=t.queries,o=t.conditions;for(i in a)(n=j.matchMedia(a[i]).matches)&&(r=1),n!==o[i]&&(o[i]=n,s=1);s&&(t.revert(),r&&e.push(t))}),Zn("matchMediaRevert"),e.forEach(function(t){return t.onMatch(t,function(e){return t.add(null,e)})}),qn=t,Zn("matchMedia"))},$n=function(){function t(t,e){this.selector=e&&Oe(e),this.data=[],this._r=[],this.isReverted=!1,this.id=Qn++,t&&this.add(t)}var e=t.prototype;return e.add=function(t,e,n){lt(t)&&(n=e,e=t,t=lt);var i=this,r=function(){var t,r=V,s=i.selector;return r&&r!==i&&r.data.push(i),n&&(i.selector=Oe(n)),V=i,t=e.apply(i,arguments),lt(t)&&i._r.push(t),V=r,i.selector=s,i.isReverted=!1,t};return i.last=r,t===lt?r(i,function(t){return i.add(null,t)}):t?i[t]=r:r},e.ignore=function(t){var e=V;V=null,t(this),V=e},e.getTweens=function(){var e=[];return this.data.forEach(function(n){return n instanceof t?e.push.apply(e,n.getTweens()):n instanceof Ln&&!(n.parent&&"nested"===n.parent.data)&&e.push(n)}),e},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(t,e){var n=this;if(t?function(){for(var e,i=n.getTweens(),r=n.data.length;r--;)"isFlip"===(e=n.data[r]).data&&(e.revert(),e.getChildren(!0,!0,!1).forEach(function(t){return i.splice(i.indexOf(t),1)}));for(i.map(function(t){return{g:t._dur||t._delay||t._sat&&!t._sat.vars.immediateRender?t.globalTime(0):-1/0,t:t}}).sort(function(t,e){return e.g-t.g||-1/0}).forEach(function(e){return e.t.revert(t)}),r=n.data.length;r--;)(e=n.data[r])instanceof bn?"nested"!==e.data&&(e.scrollTrigger&&e.scrollTrigger.revert(),e.kill()):!(e instanceof Ln)&&e.revert&&e.revert(t);n._r.forEach(function(e){return e(t,n)}),n.isReverted=!0}():this.data.forEach(function(t){return t.kill&&t.kill()}),this.clear(),e)for(var i=Yn.length;i--;)Yn[i].id===this.id&&Yn.splice(i,1)},e.revert=function(t){this.kill(t||{})},t}(),ti=function(){function t(t){this.contexts=[],this.scope=t,V&&V.data.push(this)}var e=t.prototype;return e.add=function(t,e,n){ht(t)||(t={matches:t});var i,r,s,a=new $n(0,n||this.scope),o=a.conditions={};for(r in V&&!a.selector&&(a.selector=V.selector),this.contexts.push(a),e=a.add("onMatch",e),a.queries=t,t)"all"===r?s=1:(i=j.matchMedia(t[r]))&&(Yn.indexOf(a)<0&&Yn.push(a),(o[r]=i.matches)&&(s=1),i.addListener?i.addListener(Jn):i.addEventListener("change",Jn));return s&&e(a,function(t){return a.add(null,t)}),this},e.revert=function(t){this.kill(t||{})},e.kill=function(t){this.contexts.forEach(function(e){return e.kill(t,!0)})},t}(),ei={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(function(t){return Ke(t)})},timeline:function(t){return new bn(t)},getTweensOf:function(t,e){return G.getTweensOf(t,e)},getProperty:function(t,e,n,i){ot(t)&&(t=Ie(t)[0]);var r=Gt(t||{}).get,s=n?te:$t;return"native"===n&&(n=""),t?e?s((Ft[e]&&Ft[e].get||r)(t,e,n,i)):function(e,n,i){return s((Ft[e]&&Ft[e].get||r)(t,e,n,i))}:t},quickSetter:function(t,e,n){if((t=Ie(t)).length>1){var i=t.map(function(t){return ri.quickSetter(t,e,n)}),r=i.length;return function(t){for(var e=r;e--;)i[e](t)}}t=t[0]||{};var s=Ft[e],a=Gt(t),o=a.harness&&(a.harness.aliases||{})[e]||e,l=s?function(e){var i=new s;q._pt=0,i.init(t,n?e+n:e,q,0,[t]),i.render(1,i),q._pt&&zn(1,q)}:a.set(t,o);return s?l:function(e){return l(t,o,n?e+n:e,a,1)}},quickTo:function(t,e,n){var i,r=ri.to(t,ee(((i={})[e]="+=0.1",i.paused=!0,i.stagger=0,i),n||{})),s=function(t,n,i){return r.resetTo(e,t,n,i)};return s.tween=r,s},isTweening:function(t){return G.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=fn(t.ease,J.ease)),ie(J,t||{})},config:function(t){return ie(Z,t||{})},registerEffect:function(t){var e=t.name,n=t.effect,i=t.plugins,r=t.defaults,s=t.extendTimeline;(i||"").split(",").forEach(function(t){return t&&!Ft[t]&&!St[t]&&Ct(e+" effect requires "+t+" plugin.")}),Ut[e]=function(t,e,i){return n(Ie(t),ee(e||{},r),i)},s&&(bn.prototype[e]=function(t,n,i){return this.add(Ut[e](t,ht(n)?n:(i=n)&&{},this),i)})},registerEase:function(t,e){on[t]=fn(e)},parseEase:function(t,e){return arguments.length?fn(t,e):on},getById:function(t){return G.getById(t)},exportRoot:function(t,e){void 0===t&&(t={});var n,i,r=new bn(t);for(r.smoothChildTiming=dt(t.smoothChildTiming),G.remove(r),r._dp=0,r._time=r._tTime=G._time,n=G._first;n;)i=n._next,!e&&!n._dur&&n instanceof Ln&&n.vars.onComplete===n._targets[0]||ye(r,n,n._start-n._delay),n=i;return ye(G,r,0),r},context:function(t,e){return t?new $n(t,e):V},matchMedia:function(t){return new ti(t)},matchMediaRefresh:function(){return Yn.forEach(function(t){var e,n,i=t.conditions;for(n in i)i[n]&&(i[n]=!1,e=1);e&&t.revert()})||Jn()},addEventListener:function(t,e){var n=Xn[t]||(Xn[t]=[]);~n.indexOf(e)||n.push(e)},removeEventListener:function(t,e){var n=Xn[t],i=n&&n.indexOf(e);i>=0&&n.splice(i,1)},utils:{wrap:function t(e,n,i){var r=n-e;return gt(e)?He(e,t(0,e.length),n):Ce(i,function(t){return(r+(t-e)%r)%r+e})},wrapYoyo:function t(e,n,i){var r=n-e,s=2*r;return gt(e)?He(e,t(0,e.length-1),n):Ce(i,function(t){return e+((t=(s+(t-e)%s)%s||0)>r?s-t:t)})},distribute:Fe,random:ze,snap:Be,normalize:function(t,e,n){return Ge(t,e,0,1,n)},getUnit:ke,clamp:function(t,e,n){return Ce(n,function(n){return Re(t,e,n)})},splitColor:Je,toArray:Ie,selector:Oe,mapRange:Ge,pipe:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduce(function(t,e){return e(t)},t)}},unitize:function(t,e){return function(n){return t(parseFloat(n))+(e||ke(n))}},interpolate:function t(e,n,i,r){var s=isNaN(e+n)?0:function(t){return(1-t)*e+t*n};if(!s){var a,o,l,c,u,h=ot(e),d={};if(!0===i&&(r=1)&&(i=null),h)e={p:e},n={p:n};else if(gt(e)&&!gt(n)){for(l=[],c=e.length,u=c-2,o=1;o<c;o++)l.push(t(e[o-1],e[o]));c--,s=function(t){t*=c;var e=Math.min(u,~~t);return l[e](t-e)},i=n}else r||(e=ne(gt(e)?[]:{},e));if(!l){for(a in n)Sn.call(d,e,a,"get",n[a]);s=function(t){return zn(t,d)||(h?e.p:e)}}}return Ce(i,s)},shuffle:Ne},install:Mt,effects:Ut,ticker:sn,updateRoot:bn.updateRoot,plugins:Ft,globalTimeline:G,core:{PropTween:Wn,globals:Rt,Tween:Ln,Timeline:bn,Animation:_n,getCache:Gt,_removeLinkedListItem:oe,reverting:function(){return H},context:function(t){return t&&V&&(V.data.push(t),t._ctx=V),V},suppressOverwrites:function(t){return z=t}}};Wt("to,from,fromTo,delayedCall,set,killTweensOf",function(t){return ei[t]=Ln[t]}),sn.add(bn.updateRoot),q=ei.to({},{duration:0});var ni=function(t,e){for(var n=t._pt;n&&n.p!==e&&n.op!==e&&n.fp!==e;)n=n._next;return n},ii=function(t,e){return{name:t,headless:1,rawVars:1,init:function(t,n,i){i._onInit=function(t){var i,r;if(ot(n)&&(i={},Wt(n,function(t){return i[t]=1}),n=i),e){for(r in i={},n)i[r]=e(n[r]);n=i}!function(t,e){var n,i,r,s=t._targets;for(n in e)for(i=s.length;i--;)(r=t._ptLookup[i][n])&&(r=r.d)&&(r._pt&&(r=ni(r,n)),r&&r.modifier&&r.modifier(e[n],t,s[i],n))}(t,n)}}}},ri=ei.registerPlugin({name:"attr",init:function(t,e,n,i,r){var s,a,o;for(s in this.tween=n,e)o=t.getAttribute(s)||"",(a=this.add(t,"setAttribute",(o||0)+"",e[s],i,r,0,0,s)).op=s,a.b=o,this._props.push(s)},render:function(t,e){for(var n=e._pt;n;)H?n.set(n.t,n.p,n.b,n):n.r(t,n.d),n=n._next}},{name:"endArray",headless:1,init:function(t,e){for(var n=e.length;n--;)this.add(t,n,t[n]||0,e[n],0,0,0,0,0,1)}},ii("roundProps",Ue),ii("modifiers"),ii("snap",Be))||ei;Ln.version=bn.version=ri.version="3.13.0",X=1,ft()&&an();on.Power0,on.Power1,on.Power2,on.Power3,on.Power4,on.Linear,on.Quad,on.Cubic,on.Quart,on.Quint,on.Strong,on.Elastic,on.Back,on.SteppedEase,on.Bounce,on.Sine,on.Expo,on.Circ;var si,ai,oi,li,ci,ui,hi,di,fi={},pi=180/Math.PI,mi=Math.PI/180,gi=Math.atan2,vi=/([A-Z])/g,yi=/(left|right|width|margin|padding|x)/i,_i=/[\s,\(]\S/,bi={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},xi=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},Ei=function(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},wi=function(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)},Si=function(t,e){var n=e.s+e.c*t;e.set(e.t,e.p,~~(n+(n<0?-.5:.5))+e.u,e)},Ti=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},Mi=function(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)},Ai=function(t,e,n){return t.style[e]=n},Ci=function(t,e,n){return t.style.setProperty(e,n)},Ri=function(t,e,n){return t._gsap[e]=n},ki=function(t,e,n){return t._gsap.scaleX=t._gsap.scaleY=n},Li=function(t,e,n,i,r){var s=t._gsap;s.scaleX=s.scaleY=n,s.renderTransform(r,s)},Di=function(t,e,n,i,r){var s=t._gsap;s[e]=n,s.renderTransform(r,s)},Pi="transform",Ii=Pi+"Origin",Oi=function t(e,n){var i=this,r=this.target,s=r.style,a=r._gsap;if(e in fi&&s){if(this.tfm=this.tfm||{},"transform"===e)return bi.transform.split(",").forEach(function(e){return t.call(i,e,n)});if(~(e=bi[e]||e).indexOf(",")?e.split(",").forEach(function(t){return i.tfm[t]=$i(r,t)}):this.tfm[e]=a.x?a[e]:$i(r,e),e===Ii&&(this.tfm.zOrigin=a.zOrigin),this.props.indexOf(Pi)>=0)return;a.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(Ii,n,"")),e=Pi}(s||n)&&this.props.push(e,n,s[e])},Ni=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},Fi=function(){var t,e,n=this.props,i=this.target,r=i.style,s=i._gsap;for(t=0;t<n.length;t+=3)n[t+1]?2===n[t+1]?i[n[t]](n[t+2]):i[n[t]]=n[t+2]:n[t+2]?r[n[t]]=n[t+2]:r.removeProperty("--"===n[t].substr(0,2)?n[t]:n[t].replace(vi,"-$1").toLowerCase());if(this.tfm){for(e in this.tfm)s[e]=this.tfm[e];s.svg&&(s.renderTransform(),i.setAttribute("data-svg-origin",this.svgo||"")),(t=hi())&&t.isStart||r[Pi]||(Ni(r),s.zOrigin&&r[Ii]&&(r[Ii]+=" "+s.zOrigin+"px",s.zOrigin=0,s.renderTransform()),s.uncache=1)}},Ui=function(t,e){var n={target:t,props:[],revert:Fi,save:Oi};return t._gsap||ri.core.getCache(t),e&&t.style&&t.nodeType&&e.split(",").forEach(function(t){return n.save(t)}),n},Bi=function(t,e){var n=ai.createElementNS?ai.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):ai.createElement(t);return n&&n.style?n:ai.createElement(t)},zi=function t(e,n,i){var r=getComputedStyle(e);return r[n]||r.getPropertyValue(n.replace(vi,"-$1").toLowerCase())||r.getPropertyValue(n)||!i&&t(e,Vi(n)||n,1)||""},Hi="O,Moz,ms,Ms,Webkit".split(","),Vi=function(t,e,n){var i=(e||ci).style,r=5;if(t in i&&!n)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);r--&&!(Hi[r]+t in i););return r<0?null:(3===r?"ms":r>=0?Hi[r]:"")+t},Gi=function(){"undefined"!==typeof window&&window.document&&(si=window,ai=si.document,oi=ai.documentElement,ci=Bi("div")||{style:{}},Bi("div"),Pi=Vi(Pi),Ii=Pi+"Origin",ci.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",di=!!Vi("perspective"),hi=ri.core.reverting,li=1)},ji=function(t){var e,n=t.ownerSVGElement,i=Bi("svg",n&&n.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=t.cloneNode(!0);r.style.display="block",i.appendChild(r),oi.appendChild(i);try{e=r.getBBox()}catch(s){}return i.removeChild(r),oi.removeChild(i),e},Wi=function(t,e){for(var n=e.length;n--;)if(t.hasAttribute(e[n]))return t.getAttribute(e[n])},Yi=function(t){var e,n;try{e=t.getBBox()}catch(CO){e=ji(t),n=1}return e&&(e.width||e.height)||n||(e=ji(t)),!e||e.width||e.x||e.y?e:{x:+Wi(t,["x","cx","x1"])||0,y:+Wi(t,["y","cy","y1"])||0,width:0,height:0}},Xi=function(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!Yi(t))},Ki=function(t,e){if(e){var n,i=t.style;e in fi&&e!==Ii&&(e=Pi),i.removeProperty?("ms"!==(n=e.substr(0,2))&&"webkit"!==e.substr(0,6)||(e="-"+e),i.removeProperty("--"===n?e:e.replace(vi,"-$1").toLowerCase())):i.removeAttribute(e)}},qi=function(t,e,n,i,r,s){var a=new Wn(t._pt,e,n,0,1,s?Mi:Ti);return t._pt=a,a.b=i,a.e=r,t._props.push(n),a},Qi={deg:1,rad:1,turn:1},Zi={grid:1,flex:1},Ji=function t(e,n,i,r){var s,a,o,l,c=parseFloat(i)||0,u=(i+"").trim().substr((c+"").length)||"px",h=ci.style,d=yi.test(n),f="svg"===e.tagName.toLowerCase(),p=(f?"client":"offset")+(d?"Width":"Height"),m=100,g="px"===r,v="%"===r;if(r===u||!c||Qi[r]||Qi[u])return c;if("px"!==u&&!g&&(c=t(e,n,i,"px")),l=e.getCTM&&Xi(e),(v||"%"===u)&&(fi[n]||~n.indexOf("adius")))return s=l?e.getBBox()[d?"width":"height"]:e[p],Yt(v?c/s*m:c/100*s);if(h[d?"width":"height"]=m+(g?u:r),a="rem"!==r&&~n.indexOf("adius")||"em"===r&&e.appendChild&&!f?e:e.parentNode,l&&(a=(e.ownerSVGElement||{}).parentNode),a&&a!==ai&&a.appendChild||(a=ai.body),(o=a._gsap)&&v&&o.width&&d&&o.time===sn.time&&!o.uncache)return Yt(c/o.width*m);if(!v||"height"!==n&&"width"!==n)(v||"%"===u)&&!Zi[zi(a,"display")]&&(h.position=zi(e,"position")),a===e&&(h.position="static"),a.appendChild(ci),s=ci[p],a.removeChild(ci),h.position="absolute";else{var y=e.style[n];e.style[n]=m+r,s=e[p],y?e.style[n]=y:Ki(e,n)}return d&&v&&((o=Gt(a)).time=sn.time,o.width=a[p]),Yt(g?s*c/m:s&&c?m/s*c:0)},$i=function(t,e,n,i){var r;return li||Gi(),e in bi&&"transform"!==e&&~(e=bi[e]).indexOf(",")&&(e=e.split(",")[0]),fi[e]&&"transform"!==e?(r=hr(t,i),r="transformOrigin"!==e?r[e]:r.svg?r.origin:dr(zi(t,Ii))+" "+r.zOrigin+"px"):(!(r=t.style[e])||"auto"===r||i||~(r+"").indexOf("calc("))&&(r=rr[e]&&rr[e](t,e,n)||zi(t,e)||jt(t,e)||("opacity"===e?1:0)),n&&!~(r+"").trim().indexOf(" ")?Ji(t,e,r,n)+n:r},tr=function(t,e,n,i){if(!n||"none"===n){var r=Vi(e,t,1),s=r&&zi(t,r,1);s&&s!==n?(e=r,n=s):"borderColor"===e&&(n=zi(t,"borderTopColor"))}var a,o,l,c,u,h,d,f,p,m,g,v=new Wn(this._pt,t.style,e,0,1,Bn),y=0,_=0;if(v.b=n,v.e=i,n+="","var(--"===(i+="").substring(0,6)&&(i=zi(t,i.substring(4,i.indexOf(")")))),"auto"===i&&(h=t.style[e],t.style[e]=i,i=zi(t,e)||i,h?t.style[e]=h:Ki(t,e)),rn(a=[n,i]),i=a[1],l=(n=a[0]).match(_t)||[],(i.match(_t)||[]).length){for(;o=_t.exec(i);)d=o[0],p=i.substring(y,o.index),u?u=(u+1)%5:"rgba("!==p.substr(-5)&&"hsla("!==p.substr(-5)||(u=1),d!==(h=l[_++]||"")&&(c=parseFloat(h)||0,g=h.substr((c+"").length),"="===d.charAt(1)&&(d=Kt(c,d)+g),f=parseFloat(d),m=d.substr((f+"").length),y=_t.lastIndex-m.length,m||(m=m||Z.units[e]||g,y===i.length&&(i+=m,v.e+=m)),g!==m&&(c=Ji(t,e,h,m)||0),v._pt={_next:v._pt,p:p||1===_?p:",",s:c,c:f-c,m:u&&u<4||"zIndex"===e?Math.round:0});v.c=y<i.length?i.substring(y,i.length):""}else v.r="display"===e&&"none"===i?Mi:Ti;return xt.test(i)&&(v.e=0),this._pt=v,v},er={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},nr=function(t){var e=t.split(" "),n=e[0],i=e[1]||"50%";return"top"!==n&&"bottom"!==n&&"left"!==i&&"right"!==i||(t=n,n=i,i=t),e[0]=er[n]||n,e[1]=er[i]||i,e.join(" ")},ir=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var n,i,r,s=e.t,a=s.style,o=e.u,l=s._gsap;if("all"===o||!0===o)a.cssText="",i=1;else for(r=(o=o.split(",")).length;--r>-1;)n=o[r],fi[n]&&(i=1,n="transformOrigin"===n?Ii:Pi),Ki(s,n);i&&(Ki(s,Pi),l&&(l.svg&&s.removeAttribute("transform"),a.scale=a.rotate=a.translate="none",hr(s,1),l.uncache=1,Ni(a)))}},rr={clearProps:function(t,e,n,i,r){if("isFromStart"!==r.data){var s=t._pt=new Wn(t._pt,e,n,0,0,ir);return s.u=i,s.pr=-10,s.tween=r,t._props.push(n),1}}},sr=[1,0,0,1,0,0],ar={},or=function(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t},lr=function(t){var e=zi(t,Pi);return or(e)?sr:e.substr(7).match(yt).map(Yt)},cr=function(t,e){var n,i,r,s,a=t._gsap||Gt(t),o=t.style,l=lr(t);return a.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(r=t.transform.baseVal.consolidate().matrix).a,r.b,r.c,r.d,r.e,r.f]).join(",")?sr:l:(l!==sr||t.offsetParent||t===oi||a.svg||(r=o.display,o.display="block",(n=t.parentNode)&&(t.offsetParent||t.getBoundingClientRect().width)||(s=1,i=t.nextElementSibling,oi.appendChild(t)),l=lr(t),r?o.display=r:Ki(t,"display"),s&&(i?n.insertBefore(t,i):n?n.appendChild(t):oi.removeChild(t))),e&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},ur=function(t,e,n,i,r,s){var a,o,l,c=t._gsap,u=r||cr(t,!0),h=c.xOrigin||0,d=c.yOrigin||0,f=c.xOffset||0,p=c.yOffset||0,m=u[0],g=u[1],v=u[2],y=u[3],_=u[4],b=u[5],x=e.split(" "),E=parseFloat(x[0])||0,w=parseFloat(x[1])||0;n?u!==sr&&(o=m*y-g*v)&&(l=E*(-g/o)+w*(m/o)-(m*b-g*_)/o,E=E*(y/o)+w*(-v/o)+(v*b-y*_)/o,w=l):(E=(a=Yi(t)).x+(~x[0].indexOf("%")?E/100*a.width:E),w=a.y+(~(x[1]||x[0]).indexOf("%")?w/100*a.height:w)),i||!1!==i&&c.smooth?(_=E-h,b=w-d,c.xOffset=f+(_*m+b*v)-_,c.yOffset=p+(_*g+b*y)-b):c.xOffset=c.yOffset=0,c.xOrigin=E,c.yOrigin=w,c.smooth=!!i,c.origin=e,c.originIsAbsolute=!!n,t.style[Ii]="0px 0px",s&&(qi(s,c,"xOrigin",h,E),qi(s,c,"yOrigin",d,w),qi(s,c,"xOffset",f,c.xOffset),qi(s,c,"yOffset",p,c.yOffset)),t.setAttribute("data-svg-origin",E+" "+w)},hr=function(t,e){var n=t._gsap||new yn(t);if("x"in n&&!e&&!n.uncache)return n;var i,r,s,a,o,l,c,u,h,d,f,p,m,g,v,y,_,b,x,E,w,S,T,M,A,C,R,k,L,D,P,I,O=t.style,N=n.scaleX<0,F="px",U="deg",B=getComputedStyle(t),z=zi(t,Ii)||"0";return i=r=s=l=c=u=h=d=f=0,a=o=1,n.svg=!(!t.getCTM||!Xi(t)),B.translate&&("none"===B.translate&&"none"===B.scale&&"none"===B.rotate||(O[Pi]=("none"!==B.translate?"translate3d("+(B.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==B.rotate?"rotate("+B.rotate+") ":"")+("none"!==B.scale?"scale("+B.scale.split(" ").join(",")+") ":"")+("none"!==B[Pi]?B[Pi]:"")),O.scale=O.rotate=O.translate="none"),g=cr(t,n.svg),n.svg&&(n.uncache?(A=t.getBBox(),z=n.xOrigin-A.x+"px "+(n.yOrigin-A.y)+"px",M=""):M=!e&&t.getAttribute("data-svg-origin"),ur(t,M||z,!!M||n.originIsAbsolute,!1!==n.smooth,g)),p=n.xOrigin||0,m=n.yOrigin||0,g!==sr&&(b=g[0],x=g[1],E=g[2],w=g[3],i=S=g[4],r=T=g[5],6===g.length?(a=Math.sqrt(b*b+x*x),o=Math.sqrt(w*w+E*E),l=b||x?gi(x,b)*pi:0,(h=E||w?gi(E,w)*pi+l:0)&&(o*=Math.abs(Math.cos(h*mi))),n.svg&&(i-=p-(p*b+m*E),r-=m-(p*x+m*w))):(I=g[6],D=g[7],R=g[8],k=g[9],L=g[10],P=g[11],i=g[12],r=g[13],s=g[14],c=(v=gi(I,L))*pi,v&&(M=S*(y=Math.cos(-v))+R*(_=Math.sin(-v)),A=T*y+k*_,C=I*y+L*_,R=S*-_+R*y,k=T*-_+k*y,L=I*-_+L*y,P=D*-_+P*y,S=M,T=A,I=C),u=(v=gi(-E,L))*pi,v&&(y=Math.cos(-v),P=w*(_=Math.sin(-v))+P*y,b=M=b*y-R*_,x=A=x*y-k*_,E=C=E*y-L*_),l=(v=gi(x,b))*pi,v&&(M=b*(y=Math.cos(v))+x*(_=Math.sin(v)),A=S*y+T*_,x=x*y-b*_,T=T*y-S*_,b=M,S=A),c&&Math.abs(c)+Math.abs(l)>359.9&&(c=l=0,u=180-u),a=Yt(Math.sqrt(b*b+x*x+E*E)),o=Yt(Math.sqrt(T*T+I*I)),v=gi(S,T),h=Math.abs(v)>2e-4?v*pi:0,f=P?1/(P<0?-P:P):0),n.svg&&(M=t.getAttribute("transform"),n.forceCSS=t.setAttribute("transform","")||!or(zi(t,Pi)),M&&t.setAttribute("transform",M))),Math.abs(h)>90&&Math.abs(h)<270&&(N?(a*=-1,h+=l<=0?180:-180,l+=l<=0?180:-180):(o*=-1,h+=h<=0?180:-180)),e=e||n.uncache,n.x=i-((n.xPercent=i&&(!e&&n.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-i)?-50:0)))?t.offsetWidth*n.xPercent/100:0)+F,n.y=r-((n.yPercent=r&&(!e&&n.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-r)?-50:0)))?t.offsetHeight*n.yPercent/100:0)+F,n.z=s+F,n.scaleX=Yt(a),n.scaleY=Yt(o),n.rotation=Yt(l)+U,n.rotationX=Yt(c)+U,n.rotationY=Yt(u)+U,n.skewX=h+U,n.skewY=d+U,n.transformPerspective=f+F,(n.zOrigin=parseFloat(z.split(" ")[2])||!e&&n.zOrigin||0)&&(O[Ii]=dr(z)),n.xOffset=n.yOffset=0,n.force3D=Z.force3D,n.renderTransform=n.svg?_r:di?yr:pr,n.uncache=0,n},dr=function(t){return(t=t.split(" "))[0]+" "+t[1]},fr=function(t,e,n){var i=ke(e);return Yt(parseFloat(e)+parseFloat(Ji(t,"x",n+"px",i)))+i},pr=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,yr(t,e)},mr="0deg",gr="0px",vr=") ",yr=function(t,e){var n=e||this,i=n.xPercent,r=n.yPercent,s=n.x,a=n.y,o=n.z,l=n.rotation,c=n.rotationY,u=n.rotationX,h=n.skewX,d=n.skewY,f=n.scaleX,p=n.scaleY,m=n.transformPerspective,g=n.force3D,v=n.target,y=n.zOrigin,_="",b="auto"===g&&t&&1!==t||!0===g;if(y&&(u!==mr||c!==mr)){var x,E=parseFloat(c)*mi,w=Math.sin(E),S=Math.cos(E);E=parseFloat(u)*mi,x=Math.cos(E),s=fr(v,s,w*x*-y),a=fr(v,a,-Math.sin(E)*-y),o=fr(v,o,S*x*-y+y)}m!==gr&&(_+="perspective("+m+vr),(i||r)&&(_+="translate("+i+"%, "+r+"%) "),(b||s!==gr||a!==gr||o!==gr)&&(_+=o!==gr||b?"translate3d("+s+", "+a+", "+o+") ":"translate("+s+", "+a+vr),l!==mr&&(_+="rotate("+l+vr),c!==mr&&(_+="rotateY("+c+vr),u!==mr&&(_+="rotateX("+u+vr),h===mr&&d===mr||(_+="skew("+h+", "+d+vr),1===f&&1===p||(_+="scale("+f+", "+p+vr),v.style[Pi]=_||"translate(0, 0)"},_r=function(t,e){var n,i,r,s,a,o=e||this,l=o.xPercent,c=o.yPercent,u=o.x,h=o.y,d=o.rotation,f=o.skewX,p=o.skewY,m=o.scaleX,g=o.scaleY,v=o.target,y=o.xOrigin,_=o.yOrigin,b=o.xOffset,x=o.yOffset,E=o.forceCSS,w=parseFloat(u),S=parseFloat(h);d=parseFloat(d),f=parseFloat(f),(p=parseFloat(p))&&(f+=p=parseFloat(p),d+=p),d||f?(d*=mi,f*=mi,n=Math.cos(d)*m,i=Math.sin(d)*m,r=Math.sin(d-f)*-g,s=Math.cos(d-f)*g,f&&(p*=mi,a=Math.tan(f-p),r*=a=Math.sqrt(1+a*a),s*=a,p&&(a=Math.tan(p),n*=a=Math.sqrt(1+a*a),i*=a)),n=Yt(n),i=Yt(i),r=Yt(r),s=Yt(s)):(n=m,s=g,i=r=0),(w&&!~(u+"").indexOf("px")||S&&!~(h+"").indexOf("px"))&&(w=Ji(v,"x",u,"px"),S=Ji(v,"y",h,"px")),(y||_||b||x)&&(w=Yt(w+y-(y*n+_*r)+b),S=Yt(S+_-(y*i+_*s)+x)),(l||c)&&(a=v.getBBox(),w=Yt(w+l/100*a.width),S=Yt(S+c/100*a.height)),a="matrix("+n+","+i+","+r+","+s+","+w+","+S+")",v.setAttribute("transform",a),E&&(v.style[Pi]=a)},br=function(t,e,n,i,r){var s,a,o=360,l=ot(r),c=parseFloat(r)*(l&&~r.indexOf("rad")?pi:1)-i,u=i+c+"deg";return l&&("short"===(s=r.split("_")[1])&&(c%=o)!==c%180&&(c+=c<0?o:-360),"cw"===s&&c<0?c=(c+36e9)%o-~~(c/o)*o:"ccw"===s&&c>0&&(c=(c-36e9)%o-~~(c/o)*o)),t._pt=a=new Wn(t._pt,e,n,i,c,Ei),a.e=u,a.u="deg",t._props.push(n),a},xr=function(t,e){for(var n in e)t[n]=e[n];return t},Er=function(t,e,n){var i,r,s,a,o,l,c,u=xr({},n._gsap),h=n.style;for(r in u.svg?(s=n.getAttribute("transform"),n.setAttribute("transform",""),h[Pi]=e,i=hr(n,1),Ki(n,Pi),n.setAttribute("transform",s)):(s=getComputedStyle(n)[Pi],h[Pi]=e,i=hr(n,1),h[Pi]=s),fi)(s=u[r])!==(a=i[r])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(r)<0&&(o=ke(s)!==(c=ke(a))?Ji(n,r,s,c):parseFloat(s),l=parseFloat(a),t._pt=new Wn(t._pt,i,r,o,l-o,xi),t._pt.u=c||0,t._props.push(r));xr(i,u)};Wt("padding,margin,Width,Radius",function(t,e){var n="Top",i="Right",r="Bottom",s="Left",a=(e<3?[n,i,r,s]:[n+s,n+i,r+i,r+s]).map(function(n){return e<2?t+n:"border"+n+t});rr[e>1?"border"+t:t]=function(t,e,n,i,r){var s,o;if(arguments.length<4)return s=a.map(function(e){return $i(t,e,n)}),5===(o=s.join(" ")).split(s[0]).length?s[0]:o;s=(i+"").split(" "),o={},a.forEach(function(t,e){return o[t]=s[e]=s[e]||s[(e-1)/2|0]}),t.init(e,o,r)}});var wr={name:"css",register:Gi,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,n,i,r){var s,a,o,l,c,u,h,d,f,p,m,g,v,y,_,b,x=this._props,E=t.style,w=n.vars.startAt;for(h in li||Gi(),this.styles=this.styles||Ui(t),b=this.styles.props,this.tween=n,e)if("autoRound"!==h&&(a=e[h],!Ft[h]||!Tn(h,e,n,i,t,r)))if(c=typeof a,u=rr[h],"function"===c&&(c=typeof(a=a.call(n,i,t,r))),"string"===c&&~a.indexOf("random(")&&(a=Ve(a)),u)u(this,t,h,a,n)&&(_=1);else if("--"===h.substr(0,2))s=(getComputedStyle(t).getPropertyValue(h)+"").trim(),a+="",en.lastIndex=0,en.test(s)||(d=ke(s),f=ke(a)),f?d!==f&&(s=Ji(t,h,s,f)+f):d&&(a+=d),this.add(E,"setProperty",s,a,i,r,0,0,h),x.push(h),b.push(h,0,E[h]);else if("undefined"!==c){if(w&&h in w?(s="function"===typeof w[h]?w[h].call(n,i,t,r):w[h],ot(s)&&~s.indexOf("random(")&&(s=Ve(s)),ke(s+"")||"auto"===s||(s+=Z.units[h]||ke($i(t,h))||""),"="===(s+"").charAt(1)&&(s=$i(t,h))):s=$i(t,h),l=parseFloat(s),(p="string"===c&&"="===a.charAt(1)&&a.substr(0,2))&&(a=a.substr(2)),o=parseFloat(a),h in bi&&("autoAlpha"===h&&(1===l&&"hidden"===$i(t,"visibility")&&o&&(l=0),b.push("visibility",0,E.visibility),qi(this,E,"visibility",l?"inherit":"hidden",o?"inherit":"hidden",!o)),"scale"!==h&&"transform"!==h&&~(h=bi[h]).indexOf(",")&&(h=h.split(",")[0])),m=h in fi)if(this.styles.save(h),"string"===c&&"var(--"===a.substring(0,6)&&(a=zi(t,a.substring(4,a.indexOf(")"))),o=parseFloat(a)),g||((v=t._gsap).renderTransform&&!e.parseTransform||hr(t,e.parseTransform),y=!1!==e.smoothOrigin&&v.smooth,(g=this._pt=new Wn(this._pt,E,Pi,0,1,v.renderTransform,v,0,-1)).dep=1),"scale"===h)this._pt=new Wn(this._pt,v,"scaleY",v.scaleY,(p?Kt(v.scaleY,p+o):o)-v.scaleY||0,xi),this._pt.u=0,x.push("scaleY",h),h+="X";else{if("transformOrigin"===h){b.push(Ii,0,E[Ii]),a=nr(a),v.svg?ur(t,a,0,y,0,this):((f=parseFloat(a.split(" ")[2])||0)!==v.zOrigin&&qi(this,v,"zOrigin",v.zOrigin,f),qi(this,E,h,dr(s),dr(a)));continue}if("svgOrigin"===h){ur(t,a,1,y,0,this);continue}if(h in ar){br(this,v,h,l,p?Kt(l,p+a):a);continue}if("smoothOrigin"===h){qi(this,v,"smooth",v.smooth,a);continue}if("force3D"===h){v[h]=a;continue}if("transform"===h){Er(this,a,t);continue}}else h in E||(h=Vi(h)||h);if(m||(o||0===o)&&(l||0===l)&&!_i.test(a)&&h in E)o||(o=0),(d=(s+"").substr((l+"").length))!==(f=ke(a)||(h in Z.units?Z.units[h]:d))&&(l=Ji(t,h,s,f)),this._pt=new Wn(this._pt,m?v:E,h,l,(p?Kt(l,p+o):o)-l,m||"px"!==f&&"zIndex"!==h||!1===e.autoRound?xi:Si),this._pt.u=f||0,d!==f&&"%"!==f&&(this._pt.b=s,this._pt.r=wi);else if(h in E)tr.call(this,t,h,s,p?p+a:a);else if(h in t)this.add(t,h,s||t[h],p?p+a:a,i,r);else if("parseTransform"!==h){At(h,a);continue}m||(h in E?b.push(h,0,E[h]):"function"===typeof t[h]?b.push(h,2,t[h]()):b.push(h,1,s||t[h])),x.push(h)}_&&jn(this)},render:function(t,e){if(e.tween._time||!hi())for(var n=e._pt;n;)n.r(t,n.d),n=n._next;else e.styles.revert()},get:$i,aliases:bi,getSetter:function(t,e,n){var i=bi[e];return i&&i.indexOf(",")<0&&(e=i),e in fi&&e!==Ii&&(t._gsap.x||$i(t,"x"))?n&&ui===n?"scale"===e?ki:Ri:(ui=n||{})&&("scale"===e?Li:Di):t.style&&!ut(t.style[e])?Ai:~e.indexOf("-")?Ci:Nn(t,e)},core:{_removeProperty:Ki,_getMatrix:cr}};ri.utils.checkPrefix=Vi,ri.core.getStyleSaver=Ui,function(t,e){var n=Wt(t+","+e+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(t){fi[t]=1});Wt(e,function(t){Z.units[t]="deg",ar[t]=1}),bi[n[13]]=t+","+e,Wt("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(t){var e=t.split(":");bi[e[1]]=n[e[0]]})}("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY"),Wt("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(t){Z.units[t]="px"}),ri.registerPlugin(wr);var Sr=ri.registerPlugin(wr)||ri;Sr.core.Tween;function Tr(t){return Tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tr(t)}function Mr(t){var e=function(t,e){if("object"!=Tr(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=Tr(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Tr(e)?e:e+""}function Ar(t,e,n){return(e=Mr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function Rr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Cr(Object(n),!0).forEach(function(e){Ar(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cr(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}const kr=["sri"],Lr=["page"],Dr=["page","matches"],Pr=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ir=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Or=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var Nr="popstate";function Fr(){return jr(function(t,e){let{pathname:n,search:i,hash:r}=t.location;return Hr("",{pathname:n,search:i,hash:r},e.state&&e.state.usr||null,e.state&&e.state.key||"default")},function(t,e){return"string"===typeof e?e:Vr(e)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function Ur(t,e){if(!1===t||null===t||"undefined"===typeof t)throw new Error(e)}function Br(t,e){if(!t){"undefined"!==typeof console&&console.warn(e);try{throw new Error(e)}catch(n){}}}function zr(t,e){return{usr:t.state,key:t.key,idx:e}}function Hr(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Rr(Rr({pathname:"string"===typeof t?t:t.pathname,search:"",hash:""},"string"===typeof e?Gr(e):e),{},{state:n,key:e&&e.key||i||Math.random().toString(36).substring(2,10)})}function Vr(t){let{pathname:e="/",search:n="",hash:i=""}=t;return n&&"?"!==n&&(e+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(e+="#"===i.charAt(0)?i:"#"+i),e}function Gr(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function jr(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:r=document.defaultView,v5Compat:s=!1}=i,a=r.history,o="POP",l=null,c=u();function u(){return(a.state||{idx:null}).idx}function h(){o="POP";let t=u(),e=null==t?null:t-c;c=t,l&&l({action:o,location:f.location,delta:e})}function d(t){return Wr(t)}null==c&&(c=0,a.replaceState(Rr(Rr({},a.state),{},{idx:c}),""));let f={get action(){return o},get location(){return t(r,a)},listen(t){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(Nr,h),l=t,()=>{r.removeEventListener(Nr,h),l=null}},createHref:t=>e(r,t),createURL:d,encodeLocation(t){let e=d(t);return{pathname:e.pathname,search:e.search,hash:e.hash}},push:function(t,e){o="PUSH";let i=Hr(f.location,t,e);n&&n(i,t),c=u()+1;let h=zr(i,c),d=f.createHref(i);try{a.pushState(h,"",d)}catch(CO){if(CO instanceof DOMException&&"DataCloneError"===CO.name)throw CO;r.location.assign(d)}s&&l&&l({action:o,location:f.location,delta:1})},replace:function(t,e){o="REPLACE";let i=Hr(f.location,t,e);n&&n(i,t),c=u();let r=zr(i,c),h=f.createHref(i);a.replaceState(r,"",h),s&&l&&l({action:o,location:f.location,delta:0})},go:t=>a.go(t)};return f}function Wr(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),Ur(n,"No window.location.(origin|href) available to create URL");let i="string"===typeof t?t:Vr(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}new WeakMap;function Yr(t,e){return Xr(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function Xr(t,e,n,i){let r=ls(("string"===typeof e?Gr(e):e).pathname||"/",n);if(null==r)return null;let s=Kr(t);!function(t){t.sort((t,e)=>t.score!==e.score?e.score-t.score:function(t,e){let n=t.length===e.length&&t.slice(0,-1).every((t,n)=>t===e[n]);return n?t[t.length-1]-e[e.length-1]:0}(t.routesMeta.map(t=>t.childrenIndex),e.routesMeta.map(t=>t.childrenIndex)))}(s);let a=null;for(let o=0;null==a&&o<s.length;++o){let t=os(r);a=rs(s[o],t,i)}return a}function Kr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=function(t,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,o=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===o?t.path||"":o,caseSensitive:!0===t.caseSensitive,childrenIndex:s,route:t};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(i)&&a)return;Ur(l.relativePath.startsWith(i),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(i,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(i.length)}let c=gs([i,l.relativePath]),u=n.concat(l);t.children&&t.children.length>0&&(Ur(!0!==t.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),Kr(t.children,e,u,c,a)),(null!=t.path||t.index)&&e.push({path:c,score:is(c,t.index),routesMeta:u})};return t.forEach((t,e)=>{var n;if(""!==t.path&&null!==(n=t.path)&&void 0!==n&&n.includes("?"))for(let i of qr(t.path))s(t,e,!0,i);else s(t,e)}),e}function qr(t){let e=t.split("/");if(0===e.length)return[];let[n,...i]=e,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===i.length)return r?[s,""]:[s];let a=qr(i.join("/")),o=[];return o.push(...a.map(t=>""===t?s:[s,t].join("/"))),r&&o.push(...a),o.map(e=>t.startsWith("/")&&""===e?"/":e)}var Qr=/^:[\w-]+$/,Zr=3,Jr=2,$r=1,ts=10,es=-2,ns=t=>"*"===t;function is(t,e){let n=t.split("/"),i=n.length;return n.some(ns)&&(i+=es),e&&(i+=Jr),n.filter(t=>!ns(t)).reduce((t,e)=>t+(Qr.test(e)?Zr:""===e?$r:ts),i)}function rs(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:i}=t,r={},s="/",a=[];for(let o=0;o<i.length;++o){let t=i[o],l=o===i.length-1,c="/"===s?e:e.slice(s.length)||"/",u=ss({path:t.relativePath,caseSensitive:t.caseSensitive,end:l},c),h=t.route;if(!u&&l&&n&&!i[i.length-1].route.index&&(u=ss({path:t.relativePath,caseSensitive:t.caseSensitive,end:!1},c)),!u)return null;Object.assign(r,u.params),a.push({params:r,pathname:gs([s,u.pathname]),pathnameBase:vs(gs([s,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(s=gs([s,u.pathnameBase]))}return a}function ss(t,e){"string"===typeof t&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=as(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let s=r[0],a=s.replace(/(.)\/+$/,"$1"),o=r.slice(1),l=i.reduce((t,e,n)=>{let{paramName:i,isOptional:r}=e;if("*"===i){let t=o[n]||"";a=s.slice(0,s.length-t.length).replace(/(.)\/+$/,"$1")}const l=o[n];return t[i]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),t},{});return{params:l,pathname:s,pathnameBase:a,pattern:t}}function as(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Br("*"===t||!t.endsWith("*")||t.endsWith("/*"),'Route path "'.concat(t,'" will be treated as if it were "').concat(t.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(t.replace(/\*$/,"/*"),'".'));let i=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(t,e,n)=>(i.push({paramName:e,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),r+="*"===t||"/*"===t?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==t&&"/"!==t&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function os(t){try{return t.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(CO){return Br(!1,'The URL path "'.concat(t,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(CO,").")),t}}function ls(t,e){if("/"===e)return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&"/"!==i?null:t.slice(n)||"/"}var cs=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,us=t=>cs.test(t);function hs(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(t=>{".."===t?n.length>1&&n.pop():"."!==t&&n.push(t)}),n.length>1?n.join("/"):"/"}function ds(t,e,n,i){return"Cannot include a '".concat(t,"' character in a manually specified `to.").concat(e,"` field [").concat(JSON.stringify(i),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function fs(t){return t.filter((t,e)=>0===e||t.route.path&&t.route.path.length>0)}function ps(t){let e=fs(t);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function ms(t,e,n){let i,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof t?i=Gr(t):(i=Rr({},t),Ur(!i.pathname||!i.pathname.includes("?"),ds("?","pathname","search",i)),Ur(!i.pathname||!i.pathname.includes("#"),ds("#","pathname","hash",i)),Ur(!i.search||!i.search.includes("#"),ds("#","search","hash",i)));let s,a=""===t||""===i.pathname,o=a?"/":i.pathname;if(null==o)s=n;else{let t=e.length-1;if(!r&&o.startsWith("..")){let e=o.split("/");for(;".."===e[0];)e.shift(),t-=1;i.pathname=e.join("/")}s=t>=0?e[t]:"/"}let l=function(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:i,search:r="",hash:s=""}="string"===typeof t?Gr(t):t;if(i)if(us(i))e=i;else{if(i.includes("//")){let t=i;i=i.replace(/\/\/+/g,"/"),Br(!1,"Pathnames cannot have embedded double slashes - normalizing ".concat(t," -> ").concat(i))}e=i.startsWith("/")?hs(i.substring(1),"/"):hs(i,n)}else e=n;return{pathname:e,search:ys(r),hash:_s(s)}}(i,s),c=o&&"/"!==o&&o.endsWith("/"),u=(a||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}var gs=t=>t.join("/").replace(/\/\/+/g,"/"),vs=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),ys=t=>t&&"?"!==t?t.startsWith("?")?t:"?"+t:"",_s=t=>t&&"#"!==t?t.startsWith("#")?t:"#"+t:"";function bs(t){return null!=t&&"number"===typeof t.status&&"string"===typeof t.statusText&&"boolean"===typeof t.internal&&"data"in t}Symbol("Uninstrumented");Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var xs=["POST","PUT","PATCH","DELETE"],Es=(new Set(xs),["GET",...xs]);new Set(Es),Symbol("ResetLoaderData");var ws=i.createContext(null);ws.displayName="DataRouter";var Ss=i.createContext(null);Ss.displayName="DataRouterState";var Ts=i.createContext(!1);var Ms=i.createContext({isTransitioning:!1});Ms.displayName="ViewTransition";var As=i.createContext(new Map);As.displayName="Fetchers";var Cs=i.createContext(null);Cs.displayName="Await";var Rs=i.createContext(null);Rs.displayName="Navigation";var ks=i.createContext(null);ks.displayName="Location";var Ls=i.createContext({outlet:null,matches:[],isDataRoute:!1});Ls.displayName="Route";var Ds=i.createContext(null);Ds.displayName="RouteError";function Ps(){return null!=i.useContext(ks)}function Is(){return Ur(Ps(),"useLocation() may be used only in the context of a <Router> component."),i.useContext(ks).location}var Os="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ns(t){i.useContext(Rs).static||i.useLayoutEffect(t)}function Fs(){let{isDataRoute:t}=i.useContext(Ls);return t?function(){let{router:t}=Ys("useNavigate"),e=Ks("useNavigate"),n=i.useRef(!1);Ns(()=>{n.current=!0});let r=i.useCallback(async function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Br(n.current,Os),n.current&&("number"===typeof i?t.navigate(i):await t.navigate(i,Rr({fromRouteId:e},r)))},[t,e]);return r}():function(){Ur(Ps(),"useNavigate() may be used only in the context of a <Router> component.");let t=i.useContext(ws),{basename:e,navigator:n}=i.useContext(Rs),{matches:r}=i.useContext(Ls),{pathname:s}=Is(),a=JSON.stringify(ps(r)),o=i.useRef(!1);Ns(()=>{o.current=!0});let l=i.useCallback(function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Br(o.current,Os),!o.current)return;if("number"===typeof i)return void n.go(i);let l=ms(i,JSON.parse(a),s,"path"===r.relative);null==t&&"/"!==e&&(l.pathname="/"===l.pathname?e:gs([e,l.pathname])),(r.replace?n.replace:n.push)(l,r.state,r)},[e,n,a,s,t]);return l}()}i.createContext(null);function Us(t){let{relative:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=i.useContext(Ls),{pathname:r}=Is(),s=JSON.stringify(ps(n));return i.useMemo(()=>ms(t,JSON.parse(s),r,"path"===e),[t,s,r,e])}function Bs(t,e,n,r,s){Ur(Ps(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=i.useContext(Rs),{matches:o}=i.useContext(Ls),l=o[o.length-1],c=l?l.params:{},u=l?l.pathname:"/",h=l?l.pathnameBase:"/",d=l&&l.route;{let t=d&&d.path||"";Zs(u,!d||t.endsWith("*")||t.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(u,'" (under <Route path="').concat(t,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(t,'"> to <Route path="').concat("/"===t?"*":"".concat(t,"/*"),'">.'))}let f,p=Is();if(e){var m;let t="string"===typeof e?Gr(e):e;Ur("/"===h||(null===(m=t.pathname)||void 0===m?void 0:m.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(t.pathname,'" was given in the `location` prop.')),f=t}else f=p;let g=f.pathname||"/",v=g;if("/"!==h){let t=h.replace(/^\//,"").split("/");v="/"+g.replace(/^\//,"").split("/").slice(t.length).join("/")}let y=Yr(t,{pathname:v});Br(d||null!=y,'No routes matched location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" ')),Br(null==y||void 0!==y[y.length-1].route.element||void 0!==y[y.length-1].route.Component||void 0!==y[y.length-1].route.lazy,'Matched leaf route at location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let _=js(y&&y.map(t=>Object.assign({},t,{params:Object.assign({},c,t.params),pathname:gs([h,a.encodeLocation?a.encodeLocation(t.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:t.pathname]),pathnameBase:"/"===t.pathnameBase?h:gs([h,a.encodeLocation?a.encodeLocation(t.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:t.pathnameBase])})),o,n,r,s);return e&&_?i.createElement(ks.Provider,{value:{location:Rr({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:"POP"}},_):_}function zs(){let t=qs(),e=bs(t)?"".concat(t.status," ").concat(t.statusText):t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=i.createElement(i.Fragment,null,i.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),i.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",i.createElement("code",{style:a},"ErrorBoundary")," or"," ",i.createElement("code",{style:a},"errorElement")," prop on your route.")),i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},e),n?i.createElement("pre",{style:s},n):null,o)}var Hs=i.createElement(zs,null),Vs=class extends i.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||"idle"!==e.revalidation&&"idle"===t.revalidation?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:void 0!==t.error?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return void 0!==this.state.error?i.createElement(Ls.Provider,{value:this.props.routeContext},i.createElement(Ds.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Gs(t){let{routeContext:e,match:n,children:r}=t,s=i.useContext(ws);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),i.createElement(Ls.Provider,{value:e},r)}function js(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==t){if(!n)return null;if(n.errors)t=n.matches;else{if(0!==e.length||n.initialized||!(n.matches.length>0))return null;t=n.matches}}let s=t,a=null===n||void 0===n?void 0:n.errors;if(null!=a){let t=s.findIndex(t=>t.route.id&&void 0!==(null===a||void 0===a?void 0:a[t.route.id]));Ur(t>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(a).join(","))),s=s.slice(0,Math.min(s.length,t+1))}let o=!1,l=-1;if(n)for(let i=0;i<s.length;i++){let t=s[i];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(l=i),t.route.id){let{loaderData:e,errors:i}=n,r=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!i||void 0===i[t.route.id]);if(t.route.lazy||r){o=!0,s=l>=0?s.slice(0,l+1):[s[0]];break}}}let c=n&&r?(t,e)=>{var i,s;r(t,{location:n.location,params:null!==(i=null===(s=n.matches)||void 0===s||null===(s=s[0])||void 0===s?void 0:s.params)&&void 0!==i?i:{},errorInfo:e})}:void 0;return s.reduceRight((t,r,u)=>{let h,d=!1,f=null,p=null;n&&(h=a&&r.route.id?a[r.route.id]:void 0,f=r.route.errorElement||Hs,o&&(l<0&&0===u?(Zs("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,p=null):l===u&&(d=!0,p=r.route.hydrateFallbackElement||null)));let m=e.concat(s.slice(0,u+1)),g=()=>{let e;return e=h?f:d?p:r.route.Component?i.createElement(r.route.Component,null):r.route.element?r.route.element:t,i.createElement(Gs,{match:r,routeContext:{outlet:t,matches:m,isDataRoute:null!=n},children:e})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===u)?i.createElement(Vs,{location:n.location,revalidation:n.revalidation,component:f,error:h,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0},onError:c}):g()},null)}function Ws(t){return"".concat(t," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Ys(t){let e=i.useContext(ws);return Ur(e,Ws(t)),e}function Xs(t){let e=i.useContext(Ss);return Ur(e,Ws(t)),e}function Ks(t){let e=function(t){let e=i.useContext(Ls);return Ur(e,Ws(t)),e}(t),n=e.matches[e.matches.length-1];return Ur(n.route.id,"".concat(t,' can only be used on routes that contain a unique "id"')),n.route.id}function qs(){var t;let e=i.useContext(Ds),n=Xs("useRouteError"),r=Ks("useRouteError");return void 0!==e?e:null===(t=n.errors)||void 0===t?void 0:t[r]}var Qs={};function Zs(t,e,n){e||Qs[t]||(Qs[t]=!0,Br(!1,n))}var Js={};function $s(t,e){t||Js[e]||(Js[e]=!0,console.warn(e))}i.memo(function(t){let{routes:e,future:n,state:i,unstable_onError:r}=t;return Bs(e,void 0,i,r,n)});function ta(t){Ur(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ea(t){let{basename:e="/",children:n=null,location:r,navigationType:s="POP",navigator:a,static:o=!1}=t;Ur(!Ps(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),c=i.useMemo(()=>({basename:l,navigator:a,static:o,future:{}}),[l,a,o]);"string"===typeof r&&(r=Gr(r));let{pathname:u="/",search:h="",hash:d="",state:f=null,key:p="default"}=r,m=i.useMemo(()=>{let t=ls(u,l);return null==t?null:{location:{pathname:t,search:h,hash:d,state:f,key:p},navigationType:s}},[l,u,h,d,f,p,s]);return Br(null!=m,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(u).concat(h).concat(d,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==m?null:i.createElement(Rs.Provider,{value:c},i.createElement(ks.Provider,{children:n,value:m}))}function na(t){let{children:e,location:n}=t;return Bs(ia(e),n)}i.Component;function ia(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return i.Children.forEach(t,(t,r)=>{if(!i.isValidElement(t))return;let s=[...e,r];if(t.type===i.Fragment)return void n.push.apply(n,ia(t.props.children,s));Ur(t.type===ta,"[".concat("string"===typeof t.type?t.type:t.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),Ur(!t.props.index||!t.props.children,"An index route cannot have child routes.");let a={id:t.props.id||s.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,middleware:t.props.middleware,loader:t.props.loader,action:t.props.action,hydrateFallbackElement:t.props.hydrateFallbackElement,HydrateFallback:t.props.HydrateFallback,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:!0===t.props.hasErrorBoundary||null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(a.children=ia(t.props.children,s)),n.push(a)}),n}var ra="get",sa="application/x-www-form-urlencoded";function aa(t){return null!=t&&"string"===typeof t.tagName}var oa=null;var la=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ca(t){return null==t||la.has(t)?t:(Br(!1,'"'.concat(t,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(sa,'"')),null)}function ua(t,e){let n,i,r,s,a;if(aa(o=t)&&"form"===o.tagName.toLowerCase()){let a=t.getAttribute("action");i=a?ls(a,e):null,n=t.getAttribute("method")||ra,r=ca(t.getAttribute("enctype"))||sa,s=new FormData(t)}else if(function(t){return aa(t)&&"button"===t.tagName.toLowerCase()}(t)||function(t){return aa(t)&&"input"===t.tagName.toLowerCase()}(t)&&("submit"===t.type||"image"===t.type)){let a=t.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=t.getAttribute("formaction")||a.getAttribute("action");if(i=o?ls(o,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||ra,r=ca(t.getAttribute("formenctype"))||ca(a.getAttribute("enctype"))||sa,s=new FormData(a,t),!function(){if(null===oa)try{new FormData(document.createElement("form"),0),oa=!1}catch(t){oa=!0}return oa}()){let{name:e,type:n,value:i}=t;if("image"===n){let t=e?"".concat(e,"."):"";s.append("".concat(t,"x"),"0"),s.append("".concat(t,"y"),"0")}else e&&s.append(e,i)}}else{if(aa(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=ra,i=null,r=sa,a=t}var o;return s&&"text/plain"===r&&(a=s,s=void 0),{action:i,method:n.toLowerCase(),encType:r,formData:s,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function ha(t,e){if(!1===t||null===t||"undefined"===typeof t)throw new Error(e)}Symbol("SingleFetchRedirect");function da(t,e,n){let i="string"===typeof t?new URL(t,"undefined"===typeof window?"server://singlefetch/":window.location.origin):t;return"/"===i.pathname?i.pathname="_root.".concat(n):e&&"/"===ls(i.pathname,e)?i.pathname="".concat(e.replace(/\/$/,""),"/_root.").concat(n):i.pathname="".concat(i.pathname.replace(/\/$/,""),".").concat(n),i}async function fa(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(CO){return console.error("Error loading route module `".concat(t.module,"`, reloading page...")),console.error(CO),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function pa(t){return null!=t&&"string"===typeof t.page}function ma(t){return null!=t&&(null==t.href?"preload"===t.rel&&"string"===typeof t.imageSrcSet&&"string"===typeof t.imageSizes:"string"===typeof t.rel&&"string"===typeof t.href)}function ga(t,e,n,i,r,s){let a=(t,e)=>!n[e]||t.route.id!==n[e].route.id,o=(t,e)=>{var i;return n[e].pathname!==t.pathname||(null===(i=n[e].route.path)||void 0===i?void 0:i.endsWith("*"))&&n[e].params["*"]!==t.params["*"]};return"assets"===s?e.filter((t,e)=>a(t,e)||o(t,e)):"data"===s?e.filter((e,s)=>{let l=i.routes[e.route.id];if(!l||!l.hasLoader)return!1;if(a(e,s)||o(e,s))return!0;if(e.route.shouldRevalidate){var c;let i=e.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(t,window.origin),nextParams:e.params,defaultShouldRevalidate:!0});if("boolean"===typeof i)return i}return!0}):[]}function va(t,e){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i=t.map(t=>{let i=e.routes[t.route.id];if(!i)return[];let r=[i.module];return i.clientActionModule&&(r=r.concat(i.clientActionModule)),i.clientLoaderModule&&(r=r.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(r=r.concat(i.hydrateFallbackModule)),i.imports&&(r=r.concat(i.imports)),r}).flat(1),[...new Set(i)];var i}function ya(t,e){let n=new Set,i=new Set(e);return t.reduce((t,r)=>{if(e&&!pa(r)&&"script"===r.as&&r.href&&i.has(r.href))return t;let s=JSON.stringify(function(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}(r));return n.has(s)||(n.add(s),t.push({key:s,link:r})),t},[])}function _a(t,e){return"lazy"===t.mode&&!0===e}function ba(){let t=i.useContext(ws);return ha(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function xa(){let t=i.useContext(Ss);return ha(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Ea=i.createContext(void 0);function wa(){let t=i.useContext(Ea);return ha(t,"You must render this element inside a <HydratedRouter> element"),t}function Sa(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function Ta(t,e,n){if(n&&!Ra)return[t[0]];if(e){let n=t.findIndex(t=>void 0!==e[t.route.id]);return t.slice(0,n+1)}return t}Ea.displayName="FrameworkContext";function Ma(t){let{page:e}=t,n=d(t,Lr),{router:r}=ba(),s=i.useMemo(()=>Yr(r.routes,e,r.basename),[r.routes,e,r.basename]);return s?i.createElement(Ca,Rr({page:e,matches:s},n)):null}function Aa(t){let{manifest:e,routeModules:n}=wa(),[r,s]=i.useState([]);return i.useEffect(()=>{let i=!1;return async function(t,e,n){let i=await Promise.all(t.map(async t=>{let i=e.routes[t.route.id];if(i){let t=await fa(i,n);return t.links?t.links():[]}return[]}));return ya(i.flat(1).filter(ma).filter(t=>"stylesheet"===t.rel||"preload"===t.rel).map(t=>"stylesheet"===t.rel?Rr(Rr({},t),{},{rel:"prefetch",as:"style"}):Rr(Rr({},t),{},{rel:"prefetch"})))}(t,e,n).then(t=>{i||s(t)}),()=>{i=!0}},[t,e,n]),r}function Ca(t){let{page:e,matches:n}=t,r=d(t,Dr),s=Is(),{manifest:a,routeModules:o}=wa(),{basename:l}=ba(),{loaderData:c,matches:u}=xa(),h=i.useMemo(()=>ga(e,n,u,a,s,"data"),[e,n,u,a,s]),f=i.useMemo(()=>ga(e,n,u,a,s,"assets"),[e,n,u,a,s]),p=i.useMemo(()=>{if(e===s.pathname+s.search+s.hash)return[];let t=new Set,i=!1;if(n.forEach(e=>{var n;let r=a.routes[e.route.id];r&&r.hasLoader&&(!h.some(t=>t.route.id===e.route.id)&&e.route.id in c&&null!==(n=o[e.route.id])&&void 0!==n&&n.shouldRevalidate||r.hasClientLoader?i=!0:t.add(e.route.id))}),0===t.size)return[];let r=da(e,l,"data");return i&&t.size>0&&r.searchParams.set("_routes",n.filter(e=>t.has(e.route.id)).map(t=>t.route.id).join(",")),[r.pathname+r.search]},[l,c,s,a,h,n,e,o]),m=i.useMemo(()=>va(f,a),[f,a]),g=Aa(f);return i.createElement(i.Fragment,null,p.map(t=>i.createElement("link",Rr({key:t,rel:"prefetch",as:"fetch",href:t},r))),m.map(t=>i.createElement("link",Rr({key:t,rel:"modulepreload",href:t},r))),g.map(t=>{let{key:e,link:n}=t;return i.createElement("link",Rr({key:e,nonce:r.nonce},n))}))}var Ra=!1;function ka(t){let{manifest:e,serverHandoffString:n,isSpaMode:r,renderMeta:s,routeDiscovery:a,ssr:o}=wa(),{router:l,static:c,staticContext:u}=ba(),{matches:h}=xa(),f=i.useContext(Ts),p=_a(a,o);s&&(s.didRenderScripts=!0);let m=Ta(h,null,r);i.useEffect(()=>{Ra=!0},[]);let g=i.useMemo(()=>{var r;if(f)return null;let s=u?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",a=c?"".concat(null!==(r=e.hmr)&&void 0!==r&&r.runtime?"import ".concat(JSON.stringify(e.hmr.runtime),";"):"").concat(p?"":"import ".concat(JSON.stringify(e.url)),";\n").concat(m.map((t,n)=>{let i="route".concat(n),r=e.routes[t.route.id];ha(r,"Route ".concat(t.route.id," not found in manifest"));let{clientActionModule:s,clientLoaderModule:a,clientMiddlewareModule:o,hydrateFallbackModule:l,module:c}=r,u=[...s?[{module:s,varName:"".concat(i,"_clientAction")}]:[],...a?[{module:a,varName:"".concat(i,"_clientLoader")}]:[],...o?[{module:o,varName:"".concat(i,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(i,"_HydrateFallback")}]:[],{module:c,varName:"".concat(i,"_main")}];return 1===u.length?"import * as ".concat(i," from ").concat(JSON.stringify(c),";"):[u.map(t=>"import * as ".concat(t.varName,' from "').concat(t.module,'";')).join("\n"),"const ".concat(i," = {").concat(u.map(t=>"...".concat(t.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(p?"window.__reactRouterManifest = ".concat(JSON.stringify(function(t,e){let{sri:n}=t,i=d(t,kr),r=new Set(e.state.matches.map(t=>t.route.id)),s=e.state.location.pathname.split("/").filter(Boolean),a=["/"];for(s.pop();s.length>0;)a.push("/".concat(s.join("/"))),s.pop();a.forEach(t=>{let n=Yr(e.routes,t,e.basename);n&&n.forEach(t=>r.add(t.route.id))});let o=[...r].reduce((t,e)=>Object.assign(t,{[e]:i.routes[e]}),{});return Rr(Rr({},i),{},{routes:o,sri:!!n||void 0})}(e,l),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(m.map((t,e)=>"".concat(JSON.stringify(t.route.id),":route").concat(e)).join(","),"};\n\nimport(").concat(JSON.stringify(e.entry.module),");"):" ";return i.createElement(i.Fragment,null,i.createElement("script",Rr(Rr({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:s},type:void 0})),i.createElement("script",Rr(Rr({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:a},type:"module",async:!0})))},[]),v=Ra||f?[]:(y=e.entry.imports.concat(va(m,e,{includeHydrateFallback:!0})),[...new Set(y)]);var y;let _="object"===typeof e.sri?e.sri:{};return $s(!f,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),Ra||f?null:i.createElement(i.Fragment,null,"object"===typeof e.sri?i.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:_})}}):null,p?null:i.createElement("link",{rel:"modulepreload",href:e.url,crossOrigin:t.crossOrigin,integrity:_[e.url],suppressHydrationWarning:!0}),i.createElement("link",{rel:"modulepreload",href:e.entry.module,crossOrigin:t.crossOrigin,integrity:_[e.entry.module],suppressHydrationWarning:!0}),v.map(e=>i.createElement("link",{key:e,rel:"modulepreload",href:e,crossOrigin:t.crossOrigin,integrity:_[e],suppressHydrationWarning:!0})),g)}function La(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return t=>{e.forEach(e=>{"function"===typeof e?e(t):null!=e&&(e.current=t)})}}i.Component;function Da(t){let{error:e,isOutsideRemixApp:n}=t;console.error(e);let r,s=i.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(bs(e))return i.createElement(Pa,{title:"Unhandled Thrown Response!"},i.createElement("h1",{style:{fontSize:"24px"}},e.status," ",e.statusText),s);if(e instanceof Error)r=e;else{let t=null==e?"Unknown Error":"object"===typeof e&&"toString"in e?e.toString():JSON.stringify(e);r=new Error(t)}return i.createElement(Pa,{title:"Application Error!",isOutsideRemixApp:n},i.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),i.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},r.stack),s)}function Pa(t){var e;let{title:n,renderScripts:r,isOutsideRemixApp:s,children:a}=t,{routeModules:o}=wa();return null!==(e=o.root)&&void 0!==e&&e.Layout&&!s?a:i.createElement("html",{lang:"en"},i.createElement("head",null,i.createElement("meta",{charSet:"utf-8"}),i.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),i.createElement("title",null,n)),i.createElement("body",null,i.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},a,r?i.createElement(ka,null):null)))}var Ia="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{Ia&&(window.__reactRouterVersion="7.9.6")}catch(Wq){}function Oa(t){let{basename:e,children:n,window:r}=t,s=i.useRef();null==s.current&&(s.current=Fr({window:r,v5Compat:!0}));let a=s.current,[o,l]=i.useState({action:a.action,location:a.location}),c=i.useCallback(t=>{i.startTransition(()=>l(t))},[l]);return i.useLayoutEffect(()=>a.listen(c),[a,c]),i.createElement(ea,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:a})}var Na=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Fa=i.forwardRef(function(t,e){let n,{onClick:r,discover:s="render",prefetch:a="none",relative:o,reloadDocument:l,replace:c,state:u,target:h,to:f,preventScrollReset:p,viewTransition:m}=t,g=d(t,Pr),{basename:v}=i.useContext(Rs),y="string"===typeof f&&Na.test(f),_=!1;if("string"===typeof f&&y&&(n=f,Ia))try{let t=new URL(window.location.href),e=f.startsWith("//")?new URL(t.protocol+f):new URL(f),n=ls(e.pathname,v);e.origin===t.origin&&null!=n?f=n+e.search+e.hash:_=!0}catch(Wq){Br(!1,'<Link to="'.concat(f,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let b=function(t){let{relative:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ur(Ps(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=i.useContext(Rs),{hash:s,pathname:a,search:o}=Us(t,{relative:e}),l=a;return"/"!==n&&(l="/"===a?n:gs([n,a])),r.createHref({pathname:l,search:o,hash:s})}(f,{relative:o}),[x,E,w]=function(t,e){let n=i.useContext(Ea),[r,s]=i.useState(!1),[a,o]=i.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:h,onTouchStart:d}=e,f=i.useRef(null);i.useEffect(()=>{if("render"===t&&o(!0),"viewport"===t){let t=new IntersectionObserver(t=>{t.forEach(t=>{o(t.isIntersecting)})},{threshold:.5});return f.current&&t.observe(f.current),()=>{t.disconnect()}}},[t]),i.useEffect(()=>{if(r){let t=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(t)}}},[r]);let p=()=>{s(!0)},m=()=>{s(!1),o(!1)};return n?"intent"!==t?[a,f,{}]:[a,f,{onFocus:Sa(l,p),onBlur:Sa(c,m),onMouseEnter:Sa(u,p),onMouseLeave:Sa(h,m),onTouchStart:Sa(d,p)}]:[!1,f,{}]}(a,g),S=function(t){let{target:e,replace:n,state:r,preventScrollReset:s,relative:a,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=Fs(),c=Is(),u=Us(t,{relative:a});return i.useCallback(i=>{if(function(t,e){return 0===t.button&&(!e||"_self"===e)&&!function(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}(t)}(i,e)){i.preventDefault();let e=void 0!==n?n:Vr(c)===Vr(u);l(t,{replace:e,state:r,preventScrollReset:s,relative:a,viewTransition:o})}},[c,l,u,n,r,e,t,s,a,o])}(f,{replace:c,state:u,target:h,preventScrollReset:p,relative:o,viewTransition:m});let T=i.createElement("a",Rr(Rr(Rr({},g),w),{},{href:n||b,onClick:_||l?r:function(t){r&&r(t),t.defaultPrevented||S(t)},ref:La(e,E),target:h,"data-discover":y||"render"!==s?void 0:"true"}));return x&&!y?i.createElement(i.Fragment,null,T,i.createElement(Ma,{page:b})):T});Fa.displayName="Link";var Ua=i.forwardRef(function(t,e){let{"aria-current":n="page",caseSensitive:r=!1,className:s="",end:a=!1,style:o,to:l,viewTransition:c,children:u}=t,h=d(t,Ir),f=Us(l,{relative:h.relative}),p=Is(),m=i.useContext(Ss),{navigator:g,basename:v}=i.useContext(Rs),y=null!=m&&function(t){let{relative:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.useContext(Ms);Ur(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Ha("useViewTransitionState"),s=Us(t,{relative:e});if(!n.isTransitioning)return!1;let a=ls(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=ls(n.nextLocation.pathname,r)||n.nextLocation.pathname;return null!=ss(s.pathname,o)||null!=ss(s.pathname,a)}(f)&&!0===c,_=g.encodeLocation?g.encodeLocation(f).pathname:f.pathname,b=p.pathname,x=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;r||(b=b.toLowerCase(),x=x?x.toLowerCase():null,_=_.toLowerCase()),x&&v&&(x=ls(x,v)||x);const E="/"!==_&&_.endsWith("/")?_.length-1:_.length;let w,S=b===_||!a&&b.startsWith(_)&&"/"===b.charAt(E),T=null!=x&&(x===_||!a&&x.startsWith(_)&&"/"===x.charAt(_.length)),M={isActive:S,isPending:T,isTransitioning:y},A=S?n:void 0;w="function"===typeof s?s(M):[s,S?"active":null,T?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let C="function"===typeof o?o(M):o;return i.createElement(Fa,Rr(Rr({},h),{},{"aria-current":A,className:w,ref:e,style:C,to:l,viewTransition:c}),"function"===typeof u?u(M):u)});Ua.displayName="NavLink";var Ba=i.forwardRef((t,e)=>{let{discover:n="render",fetcherKey:r,navigate:s,reloadDocument:a,replace:o,state:l,method:c=ra,action:u,onSubmit:h,relative:f,preventScrollReset:p,viewTransition:m}=t,g=d(t,Or),v=ja(),y=function(t){let{relative:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=i.useContext(Rs),r=i.useContext(Ls);Ur(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),a=Rr({},Us(t||".",{relative:e})),o=Is();if(null==t){a.search=o.search;let t=new URLSearchParams(a.search),e=t.getAll("index");if(e.some(t=>""===t)){t.delete("index"),e.filter(t=>t).forEach(e=>t.append("index",e));let n=t.toString();a.search=n?"?".concat(n):""}}t&&"."!==t||!s.route.index||(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(a.pathname="/"===a.pathname?n:gs([n,a.pathname]));return Vr(a)}(u,{relative:f}),_="get"===c.toLowerCase()?"get":"post",b="string"===typeof u&&Na.test(u);return i.createElement("form",Rr(Rr({ref:e,method:_,action:y,onSubmit:a?h:t=>{if(h&&h(t),t.defaultPrevented)return;t.preventDefault();let e=t.nativeEvent.submitter,n=(null===e||void 0===e?void 0:e.getAttribute("formmethod"))||c;v(e||t.currentTarget,{fetcherKey:r,method:n,navigate:s,replace:o,state:l,relative:f,preventScrollReset:p,viewTransition:m})}},g),{},{"data-discover":b||"render"!==n?void 0:"true"}))});function za(t){return"".concat(t," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Ha(t){let e=i.useContext(ws);return Ur(e,za(t)),e}Ba.displayName="Form";var Va=0,Ga=()=>"__".concat(String(++Va),"__");function ja(){let{router:t}=Ha("useSubmit"),{basename:e}=i.useContext(Rs),n=Ks("useRouteId");return i.useCallback(async function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:s,method:a,encType:o,formData:l,body:c}=ua(i,e);if(!1===r.navigate){let e=r.fetcherKey||Ga();await t.fetch(e,n,r.action||s,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||a,formEncType:r.encType||o,flushSync:r.flushSync})}else await t.navigate(r.action||s,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||a,formEncType:r.encType||o,replace:r.replace,state:r.state,fromRouteId:n,flushSync:r.flushSync,viewTransition:r.viewTransition})},[t,e,n])}const Wa=()=>{const t=(0,i.useContext)(E),e=(0,i.useContext)(w),n=(0,i.useContext)(S),r=Fs(),s=(0,i.useRef)(null);(0,i.useEffect)(()=>{"hidden"===t[0]?Sr.to(s.current,{y:"-100%",duration:.5,ease:"power1.inOut"}):Sr.to(s.current,{y:0,duration:.5,ease:"power1.inOut"})},[t[0],s]);const d=t=>{n[1](t),r("/")};return(0,m.jsxs)("header",{ref:s,className:"".concat(a),children:[(0,m.jsxs)("div",{className:l,children:[(0,m.jsx)(F,{className:o}),"home"===t[0]&&(0,m.jsxs)("nav",{className:h,children:[(0,m.jsx)(v,{active:"home"===e[0],title:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f",onClick:()=>d("home")}),(0,m.jsx)(v,{active:"about"===e[0],title:"\u041e \u043d\u0430\u0441",onClick:()=>d("about")}),(0,m.jsx)(v,{active:"price"===e[0],title:"\u041d\u043e\u043c\u0435\u0440\u0430",onClick:()=>d("price")})]}),"room"===t[0]&&(0,m.jsxs)("nav",{className:h,children:[(0,m.jsx)(v,{active:!1,title:"< \u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f",onClick:()=>r(-1)}),(0,m.jsx)(v,{active:!1,title:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f",onClick:()=>r("/")}),(0,m.jsx)(v,{active:!0,title:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u043a\u043e\u043c\u043d\u0430\u0442"})]}),"search"===t[0]&&(0,m.jsxs)("nav",{className:h,children:[(0,m.jsx)(v,{active:!1,title:"< \u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f",onClick:()=>r(-1)}),(0,m.jsx)(v,{active:!1,title:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f",onClick:()=>r("/")}),(0,m.jsx)(v,{active:!0,title:"\u041f\u043e\u0438\u0441\u043a \u043d\u043e\u043c\u0435\u0440\u043e\u0432"})]})]}),(0,m.jsx)("div",{className:c,children:(0,m.jsx)(x,{className:u,defaultClassName:!1,title:"\u041f\u043e\u0434\u0430\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443",onClick:()=>{}})})]})};function Ya(t){if(null==t)throw new TypeError("Cannot destructure "+t)}const Xa="BuilderSections_main_section__WFjwE",Ka="BuilderSections_container__84DXN",qa="BuilderSections_ref_navigation__93Gzc",Qa="HomeComponent_main__au3F7",Za="HomeComponent_navigation__aZIt4",Ja="HomeComponent_logo__uIiHq",$a="HomeComponent_header__32Yj+",to="HomeComponent_header_left__SDO3Q",eo="HomeComponent_header_right__xlLyl",no="HomeComponent_gradient_overlay__DVz7T",io="HomeComponent_description_section__XaNqu",ro="HomeComponent_video_background__BY2iN",so="HomeComponent_content__yC2+Q",ao="HomeComponent_description_text__yQdod",oo="HomeComponent_description_inner_text__TVyZz",lo="HomeComponent_description_subtext__FCF3Y";function co(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var uo,ho,fo,po,mo,go,vo,yo,_o,bo,xo,Eo,wo,So=function(){return uo||"undefined"!==typeof window&&(uo=window.gsap)&&uo.registerPlugin&&uo},To=1,Mo=[],Ao=[],Co=[],Ro=Date.now,ko=function(t,e){return e},Lo=function(t,e){return~Co.indexOf(t)&&Co[Co.indexOf(t)+1][e]},Do=function(t){return!!~bo.indexOf(t)},Po=function(t,e,n,i,r){return t.addEventListener(e,n,{passive:!1!==i,capture:!!r})},Io=function(t,e,n,i){return t.removeEventListener(e,n,!!i)},Oo="scrollLeft",No="scrollTop",Fo=function(){return xo&&xo.isPressed||Ao.cache++},Uo=function(t,e){var n=function n(i){if(i||0===i){To&&(fo.history.scrollRestoration="manual");var r=xo&&xo.isPressed;i=n.v=Math.round(i)||(xo&&xo.iOS?1:0),t(i),n.cacheID=Ao.cache,r&&ko("ss",i)}else(e||Ao.cache!==n.cacheID||ko("ref"))&&(n.cacheID=Ao.cache,n.v=t());return n.v+n.offset};return n.offset=0,t&&n},Bo={s:Oo,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:Uo(function(t){return arguments.length?fo.scrollTo(t,zo.sc()):fo.pageXOffset||po[Oo]||mo[Oo]||go[Oo]||0})},zo={s:No,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:Bo,sc:Uo(function(t){return arguments.length?fo.scrollTo(Bo.sc(),t):fo.pageYOffset||po[No]||mo[No]||go[No]||0})},Ho=function(t,e){return(e&&e._ctx&&e._ctx.selector||uo.utils.toArray)(t)[0]||("string"===typeof t&&!1!==uo.config().nullTargetWarn?console.warn("Element not found:",t):null)},Vo=function(t,e){var n=e.s,i=e.sc;Do(t)&&(t=po.scrollingElement||mo);var r=Ao.indexOf(t),s=i===zo.sc?1:2;!~r&&(r=Ao.push(t)-1),Ao[r+s]||Po(t,"scroll",Fo);var a=Ao[r+s],o=a||(Ao[r+s]=Uo(Lo(t,n),!0)||(Do(t)?i:Uo(function(e){return arguments.length?t[n]=e:t[n]})));return o.target=t,a||(o.smooth="smooth"===uo.getProperty(t,"scrollBehavior")),o},Go=function(t,e,n){var i=t,r=t,s=Ro(),a=s,o=e||50,l=Math.max(500,3*o),c=function(t,e){var l=Ro();e||l-s>o?(r=i,i=t,a=s,s=l):n?i+=t:i=r+(t-r)/(l-a)*(s-a)};return{update:c,reset:function(){r=i=n?0:i,a=s=0},getVelocity:function(t){var e=a,o=r,u=Ro();return(t||0===t)&&t!==i&&c(t),s===a||u-a>l?0:(i+(n?o:-o))/((n?u:s)-e)*1e3}}},jo=function(t,e){return e&&!t._gsapAllow&&t.preventDefault(),t.changedTouches?t.changedTouches[0]:t},Wo=function(t){var e=Math.max.apply(Math,t),n=Math.min.apply(Math,t);return Math.abs(e)>=Math.abs(n)?e:n},Yo=function(){(_o=uo.core.globals().ScrollTrigger)&&_o.core&&function(){var t=_o.core,e=t.bridge||{},n=t._scrollers,i=t._proxies;n.push.apply(n,Ao),i.push.apply(i,Co),Ao=n,Co=i,ko=function(t,n){return e[t](n)}}()},Xo=function(t){return uo=t||So(),!ho&&uo&&"undefined"!==typeof document&&document.body&&(fo=window,po=document,mo=po.documentElement,go=po.body,bo=[fo,po,mo,go],uo.utils.clamp,wo=uo.core.context||function(){},yo="onpointerenter"in go?"pointer":"mouse",vo=Ko.isTouch=fo.matchMedia&&fo.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in fo||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,Eo=Ko.eventTypes=("ontouchstart"in mo?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in mo?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return To=0},500),Yo(),ho=1),ho};Bo.op=zo,Ao.cache=0;var Ko=function(){function t(t){this.init(t)}var e,n,i;return t.prototype.init=function(t){ho||Xo(uo)||console.warn("Please gsap.registerPlugin(Observer)"),_o||Yo();var e=t.tolerance,n=t.dragMinimum,i=t.type,r=t.target,s=t.lineHeight,a=t.debounce,o=t.preventDefault,l=t.onStop,c=t.onStopDelay,u=t.ignore,h=t.wheelSpeed,d=t.event,f=t.onDragStart,p=t.onDragEnd,m=t.onDrag,g=t.onPress,v=t.onRelease,y=t.onRight,_=t.onLeft,b=t.onUp,x=t.onDown,E=t.onChangeX,w=t.onChangeY,S=t.onChange,T=t.onToggleX,M=t.onToggleY,A=t.onHover,C=t.onHoverEnd,R=t.onMove,k=t.ignoreCheck,L=t.isNormalizer,D=t.onGestureStart,P=t.onGestureEnd,I=t.onWheel,O=t.onEnable,N=t.onDisable,F=t.onClick,U=t.scrollSpeed,B=t.capture,z=t.allowClicks,H=t.lockAxis,V=t.onLockAxis;this.target=r=Ho(r)||mo,this.vars=t,u&&(u=uo.utils.toArray(u)),e=e||1e-9,n=n||0,h=h||1,U=U||1,i=i||"wheel,touch,pointer",a=!1!==a,s||(s=parseFloat(fo.getComputedStyle(go).lineHeight)||22);var G,j,W,Y,X,K,q,Q=this,Z=0,J=0,$=t.passive||!o&&!1!==t.passive,tt=Vo(r,Bo),et=Vo(r,zo),nt=tt(),it=et(),rt=~i.indexOf("touch")&&!~i.indexOf("pointer")&&"pointerdown"===Eo[0],st=Do(r),at=r.ownerDocument||po,ot=[0,0,0],lt=[0,0,0],ct=0,ut=function(){return ct=Ro()},ht=function(t,e){return(Q.event=t)&&u&&function(t,e){for(var n=e.length;n--;)if(e[n]===t||e[n].contains(t))return!0;return!1}(t.target,u)||e&&rt&&"touch"!==t.pointerType||k&&k(t,e)},dt=function(){var t=Q.deltaX=Wo(ot),n=Q.deltaY=Wo(lt),i=Math.abs(t)>=e,r=Math.abs(n)>=e;S&&(i||r)&&S(Q,t,n,ot,lt),i&&(y&&Q.deltaX>0&&y(Q),_&&Q.deltaX<0&&_(Q),E&&E(Q),T&&Q.deltaX<0!==Z<0&&T(Q),Z=Q.deltaX,ot[0]=ot[1]=ot[2]=0),r&&(x&&Q.deltaY>0&&x(Q),b&&Q.deltaY<0&&b(Q),w&&w(Q),M&&Q.deltaY<0!==J<0&&M(Q),J=Q.deltaY,lt[0]=lt[1]=lt[2]=0),(Y||W)&&(R&&R(Q),W&&(f&&1===W&&f(Q),m&&m(Q),W=0),Y=!1),K&&!(K=!1)&&V&&V(Q),X&&(I(Q),X=!1),G=0},ft=function(t,e,n){ot[n]+=t,lt[n]+=e,Q._vx.update(t),Q._vy.update(e),a?G||(G=requestAnimationFrame(dt)):dt()},pt=function(t,e){H&&!q&&(Q.axis=q=Math.abs(t)>Math.abs(e)?"x":"y",K=!0),"y"!==q&&(ot[2]+=t,Q._vx.update(t,!0)),"x"!==q&&(lt[2]+=e,Q._vy.update(e,!0)),a?G||(G=requestAnimationFrame(dt)):dt()},mt=function(t){if(!ht(t,1)){var e=(t=jo(t,o)).clientX,i=t.clientY,r=e-Q.x,s=i-Q.y,a=Q.isDragging;Q.x=e,Q.y=i,(a||(r||s)&&(Math.abs(Q.startX-e)>=n||Math.abs(Q.startY-i)>=n))&&(W=a?2:1,a||(Q.isDragging=!0),pt(r,s))}},gt=Q.onPress=function(t){ht(t,1)||t&&t.button||(Q.axis=q=null,j.pause(),Q.isPressed=!0,t=jo(t),Z=J=0,Q.startX=Q.x=t.clientX,Q.startY=Q.y=t.clientY,Q._vx.reset(),Q._vy.reset(),Po(L?r:at,Eo[1],mt,$,!0),Q.deltaX=Q.deltaY=0,g&&g(Q))},vt=Q.onRelease=function(t){if(!ht(t,1)){Io(L?r:at,Eo[1],mt,!0);var e=!isNaN(Q.y-Q.startY),n=Q.isDragging,i=n&&(Math.abs(Q.x-Q.startX)>3||Math.abs(Q.y-Q.startY)>3),s=jo(t);!i&&e&&(Q._vx.reset(),Q._vy.reset(),o&&z&&uo.delayedCall(.08,function(){if(Ro()-ct>300&&!t.defaultPrevented)if(t.target.click)t.target.click();else if(at.createEvent){var e=at.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,fo,1,s.screenX,s.screenY,s.clientX,s.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(e)}})),Q.isDragging=Q.isGesturing=Q.isPressed=!1,l&&n&&!L&&j.restart(!0),W&&dt(),p&&n&&p(Q),v&&v(Q,i)}},yt=function(t){return t.touches&&t.touches.length>1&&(Q.isGesturing=!0)&&D(t,Q.isDragging)},_t=function(){return(Q.isGesturing=!1)||P(Q)},bt=function(t){if(!ht(t)){var e=tt(),n=et();ft((e-nt)*U,(n-it)*U,1),nt=e,it=n,l&&j.restart(!0)}},xt=function(t){if(!ht(t)){t=jo(t,o),I&&(X=!0);var e=(1===t.deltaMode?s:2===t.deltaMode?fo.innerHeight:1)*h;ft(t.deltaX*e,t.deltaY*e,0),l&&!L&&j.restart(!0)}},Et=function(t){if(!ht(t)){var e=t.clientX,n=t.clientY,i=e-Q.x,r=n-Q.y;Q.x=e,Q.y=n,Y=!0,l&&j.restart(!0),(i||r)&&pt(i,r)}},wt=function(t){Q.event=t,A(Q)},St=function(t){Q.event=t,C(Q)},Tt=function(t){return ht(t)||jo(t,o)&&F(Q)};j=Q._dc=uo.delayedCall(c||.25,function(){Q._vx.reset(),Q._vy.reset(),j.pause(),l&&l(Q)}).pause(),Q.deltaX=Q.deltaY=0,Q._vx=Go(0,50,!0),Q._vy=Go(0,50,!0),Q.scrollX=tt,Q.scrollY=et,Q.isDragging=Q.isGesturing=Q.isPressed=!1,wo(this),Q.enable=function(t){return Q.isEnabled||(Po(st?at:r,"scroll",Fo),i.indexOf("scroll")>=0&&Po(st?at:r,"scroll",bt,$,B),i.indexOf("wheel")>=0&&Po(r,"wheel",xt,$,B),(i.indexOf("touch")>=0&&vo||i.indexOf("pointer")>=0)&&(Po(r,Eo[0],gt,$,B),Po(at,Eo[2],vt),Po(at,Eo[3],vt),z&&Po(r,"click",ut,!0,!0),F&&Po(r,"click",Tt),D&&Po(at,"gesturestart",yt),P&&Po(at,"gestureend",_t),A&&Po(r,yo+"enter",wt),C&&Po(r,yo+"leave",St),R&&Po(r,yo+"move",Et)),Q.isEnabled=!0,Q.isDragging=Q.isGesturing=Q.isPressed=Y=W=!1,Q._vx.reset(),Q._vy.reset(),nt=tt(),it=et(),t&&t.type&&gt(t),O&&O(Q)),Q},Q.disable=function(){Q.isEnabled&&(Mo.filter(function(t){return t!==Q&&Do(t.target)}).length||Io(st?at:r,"scroll",Fo),Q.isPressed&&(Q._vx.reset(),Q._vy.reset(),Io(L?r:at,Eo[1],mt,!0)),Io(st?at:r,"scroll",bt,B),Io(r,"wheel",xt,B),Io(r,Eo[0],gt,B),Io(at,Eo[2],vt),Io(at,Eo[3],vt),Io(r,"click",ut,!0),Io(r,"click",Tt),Io(at,"gesturestart",yt),Io(at,"gestureend",_t),Io(r,yo+"enter",wt),Io(r,yo+"leave",St),Io(r,yo+"move",Et),Q.isEnabled=Q.isPressed=Q.isDragging=!1,N&&N(Q))},Q.kill=Q.revert=function(){Q.disable();var t=Mo.indexOf(Q);t>=0&&Mo.splice(t,1),xo===Q&&(xo=0)},Mo.push(Q),L&&Do(r)&&(xo=Q),Q.enable(d)},e=t,(n=[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}])&&co(e.prototype,n),i&&co(e,i),t}();Ko.version="3.13.0",Ko.create=function(t){return new Ko(t)},Ko.register=Xo,Ko.getAll=function(){return Mo.slice()},Ko.getById=function(t){return Mo.filter(function(e){return e.vars.id===t})[0]},So()&&uo.registerPlugin(Ko);var qo,Qo,Zo,Jo,$o,tl,el,nl,il,rl,sl,al,ol,ll,cl,ul,hl,dl,fl,pl,ml,gl,vl,yl,_l,bl,xl,El,wl,Sl,Tl,Ml,Al,Cl,Rl,kl,Ll,Dl,Pl=1,Il=Date.now,Ol=Il(),Nl=0,Fl=0,Ul=function(t,e,n){var i=Jl(t)&&("clamp("===t.substr(0,6)||t.indexOf("max")>-1);return n["_"+e+"Clamp"]=i,i?t.substr(6,t.length-7):t},Bl=function(t,e){return!e||Jl(t)&&"clamp("===t.substr(0,6)?t:"clamp("+t+")"},zl=function t(){return Fl&&requestAnimationFrame(t)},Hl=function(){return ll=1},Vl=function(){return ll=0},Gl=function(t){return t},jl=function(t){return Math.round(1e5*t)/1e5||0},Wl=function(){return"undefined"!==typeof window},Yl=function(){return qo||Wl()&&(qo=window.gsap)&&qo.registerPlugin&&qo},Xl=function(t){return!!~el.indexOf(t)},Kl=function(t){return("Height"===t?Tl:Zo["inner"+t])||$o["client"+t]||tl["client"+t]},ql=function(t){return Lo(t,"getBoundingClientRect")||(Xl(t)?function(){return lu.width=Zo.innerWidth,lu.height=Tl,lu}:function(){return xc(t)})},Ql=function(t,e){var n=e.s,i=e.d2,r=e.d,s=e.a;return Math.max(0,(n="scroll"+i)&&(s=Lo(t,n))?s()-ql(t)()[r]:Xl(t)?($o[n]||tl[n])-Kl(i):t[n]-t["offset"+i])},Zl=function(t,e){for(var n=0;n<fl.length;n+=3)(!e||~e.indexOf(fl[n+1]))&&t(fl[n],fl[n+1],fl[n+2])},Jl=function(t){return"string"===typeof t},$l=function(t){return"function"===typeof t},tc=function(t){return"number"===typeof t},ec=function(t){return"object"===typeof t},nc=function(t,e,n){return t&&t.progress(e?0:1)&&n&&t.pause()},ic=function(t,e){if(t.enabled){var n=t._ctx?t._ctx.add(function(){return e(t)}):e(t);n&&n.totalTime&&(t.callbackAnimation=n)}},rc=Math.abs,sc="left",ac="right",oc="bottom",lc="width",cc="height",uc="Right",hc="Left",dc="Top",fc="Bottom",pc="padding",mc="margin",gc="Width",vc="Height",yc="px",_c=function(t){return Zo.getComputedStyle(t)},bc=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},xc=function(t,e){var n=e&&"matrix(1, 0, 0, 1, 0, 0)"!==_c(t)[cl]&&qo.to(t,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),i=t.getBoundingClientRect();return n&&n.progress(0).kill(),i},Ec=function(t,e){var n=e.d2;return t["offset"+n]||t["client"+n]||0},wc=function(t){var e,n=[],i=t.labels,r=t.duration();for(e in i)n.push(i[e]/r);return n},Sc=function(t){var e=qo.utils.snap(t),n=Array.isArray(t)&&t.slice(0).sort(function(t,e){return t-e});return n?function(t,i,r){var s;if(void 0===r&&(r=.001),!i)return e(t);if(i>0){for(t-=r,s=0;s<n.length;s++)if(n[s]>=t)return n[s];return n[s-1]}for(s=n.length,t+=r;s--;)if(n[s]<=t)return n[s];return n[0]}:function(n,i,r){void 0===r&&(r=.001);var s=e(n);return!i||Math.abs(s-n)<r||s-n<0===i<0?s:e(i<0?n-t:n+t)}},Tc=function(t,e,n,i){return n.split(",").forEach(function(n){return t(e,n,i)})},Mc=function(t,e,n,i,r){return t.addEventListener(e,n,{passive:!i,capture:!!r})},Ac=function(t,e,n,i){return t.removeEventListener(e,n,!!i)},Cc=function(t,e,n){(n=n&&n.wheelHandler)&&(t(e,"wheel",n),t(e,"touchmove",n))},Rc={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},kc={toggleActions:"play",anticipatePin:0},Lc={top:0,left:0,center:.5,bottom:1,right:1},Dc=function(t,e){if(Jl(t)){var n=t.indexOf("="),i=~n?+(t.charAt(n-1)+1)*parseFloat(t.substr(n+1)):0;~n&&(t.indexOf("%")>n&&(i*=e/100),t=t.substr(0,n-1)),t=i+(t in Lc?Lc[t]*e:~t.indexOf("%")?parseFloat(t)*e/100:parseFloat(t)||0)}return t},Pc=function(t,e,n,i,r,s,a,o){var l=r.startColor,c=r.endColor,u=r.fontSize,h=r.indent,d=r.fontWeight,f=Jo.createElement("div"),p=Xl(n)||"fixed"===Lo(n,"pinType"),m=-1!==t.indexOf("scroller"),g=p?tl:n,v=-1!==t.indexOf("start"),y=v?l:c,_="border-color:"+y+";font-size:"+u+";color:"+y+";font-weight:"+d+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return _+="position:"+((m||o)&&p?"fixed;":"absolute;"),(m||o||!p)&&(_+=(i===zo?ac:oc)+":"+(s+parseFloat(h))+"px;"),a&&(_+="box-sizing:border-box;text-align:left;width:"+a.offsetWidth+"px;"),f._isStart=v,f.setAttribute("class","gsap-marker-"+t+(e?" marker-"+e:"")),f.style.cssText=_,f.innerText=e||0===e?t+"-"+e:t,g.children[0]?g.insertBefore(f,g.children[0]):g.appendChild(f),f._offset=f["offset"+i.op.d2],Ic(f,0,i,v),f},Ic=function(t,e,n,i){var r={display:"block"},s=n[i?"os2":"p2"],a=n[i?"p2":"os2"];t._isFlipped=i,r[n.a+"Percent"]=i?-100:0,r[n.a]=i?"1px":0,r["border"+s+gc]=1,r["border"+a+gc]=0,r[n.p]=e+"px",qo.set(t,r)},Oc=[],Nc={},Fc=function(){return Il()-Nl>34&&(Rl||(Rl=requestAnimationFrame(eu)))},Uc=function(){(!vl||!vl.isPressed||vl.startX>tl.clientWidth)&&(Ao.cache++,vl?Rl||(Rl=requestAnimationFrame(eu)):eu(),Nl||jc("scrollStart"),Nl=Il())},Bc=function(){bl=Zo.innerWidth,_l=Zo.innerHeight},zc=function(t){Ao.cache++,(!0===t||!ol&&!gl&&!Jo.fullscreenElement&&!Jo.webkitFullscreenElement&&(!yl||bl!==Zo.innerWidth||Math.abs(Zo.innerHeight-_l)>.25*Zo.innerHeight))&&nl.restart(!0)},Hc={},Vc=[],Gc=function t(){return Ac(mu,"scrollEnd",t)||Jc(!0)},jc=function(t){return Hc[t]&&Hc[t].map(function(t){return t()})||Vc},Wc=[],Yc=function(t){for(var e=0;e<Wc.length;e+=5)(!t||Wc[e+4]&&Wc[e+4].query===t)&&(Wc[e].style.cssText=Wc[e+1],Wc[e].getBBox&&Wc[e].setAttribute("transform",Wc[e+2]||""),Wc[e+3].uncache=1)},Xc=function(t,e){var n;for(ul=0;ul<Oc.length;ul++)!(n=Oc[ul])||e&&n._ctx!==e||(t?n.kill(1):n.revert(!0,!0));Ml=!0,e&&Yc(e),e||jc("revert")},Kc=function(t,e){Ao.cache++,(e||!kl)&&Ao.forEach(function(t){return $l(t)&&t.cacheID++&&(t.rec=0)}),Jl(t)&&(Zo.history.scrollRestoration=wl=t)},qc=0,Qc=function(){tl.appendChild(Sl),Tl=!vl&&Sl.offsetHeight||Zo.innerHeight,tl.removeChild(Sl)},Zc=function(t){return il(".gsap-marker-start, .gsap-marker-end, .gsap-marker-scroller-start, .gsap-marker-scroller-end").forEach(function(e){return e.style.display=t?"none":"block"})},Jc=function(t,e){if($o=Jo.documentElement,tl=Jo.body,el=[Zo,Jo,$o,tl],!Nl||t||Ml){Qc(),kl=mu.isRefreshing=!0,Ao.forEach(function(t){return $l(t)&&++t.cacheID&&(t.rec=t())});var n=jc("refreshInit");pl&&mu.sort(),e||Xc(),Ao.forEach(function(t){$l(t)&&(t.smooth&&(t.target.style.scrollBehavior="auto"),t(0))}),Oc.slice(0).forEach(function(t){return t.refresh()}),Ml=!1,Oc.forEach(function(t){if(t._subPinOffset&&t.pin){var e=t.vars.horizontal?"offsetWidth":"offsetHeight",n=t.pin[e];t.revert(!0,1),t.adjustPinSpacing(t.pin[e]-n),t.refresh()}}),Al=1,Zc(!0),Oc.forEach(function(t){var e=Ql(t.scroller,t._dir),n="max"===t.vars.end||t._endClamp&&t.end>e,i=t._startClamp&&t.start>=e;(n||i)&&t.setPositions(i?e-1:t.start,n?Math.max(i?e:t.start+1,e):t.end,!0)}),Zc(!1),Al=0,n.forEach(function(t){return t&&t.render&&t.render(-1)}),Ao.forEach(function(t){$l(t)&&(t.smooth&&requestAnimationFrame(function(){return t.target.style.scrollBehavior="smooth"}),t.rec&&t(t.rec))}),Kc(wl,1),nl.pause(),qc++,kl=2,eu(2),Oc.forEach(function(t){return $l(t.vars.onRefresh)&&t.vars.onRefresh(t)}),kl=mu.isRefreshing=!1,jc("refresh")}else Mc(mu,"scrollEnd",Gc)},$c=0,tu=1,eu=function(t){if(2===t||!kl&&!Ml){mu.isUpdating=!0,Dl&&Dl.update(0);var e=Oc.length,n=Il(),i=n-Ol>=50,r=e&&Oc[0].scroll();if(tu=$c>r?-1:1,kl||($c=r),i&&(Nl&&!ll&&n-Nl>200&&(Nl=0,jc("scrollEnd")),sl=Ol,Ol=n),tu<0){for(ul=e;ul-- >0;)Oc[ul]&&Oc[ul].update(0,i);tu=1}else for(ul=0;ul<e;ul++)Oc[ul]&&Oc[ul].update(0,i);mu.isUpdating=!1}Rl=0},nu=[sc,"top",oc,ac,mc+fc,mc+uc,mc+dc,mc+hc,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],iu=nu.concat([lc,cc,"boxSizing","max"+gc,"max"+vc,"position",mc,pc,pc+dc,pc+uc,pc+fc,pc+hc]),ru=function(t,e,n,i){if(!t._gsap.swappedIn){for(var r,s=nu.length,a=e.style,o=t.style;s--;)a[r=nu[s]]=n[r];a.position="absolute"===n.position?"absolute":"relative","inline"===n.display&&(a.display="inline-block"),o[oc]=o[ac]="auto",a.flexBasis=n.flexBasis||"auto",a.overflow="visible",a.boxSizing="border-box",a[lc]=Ec(t,Bo)+yc,a[cc]=Ec(t,zo)+yc,a[pc]=o[mc]=o.top=o[sc]="0",au(i),o[lc]=o["max"+gc]=n[lc],o[cc]=o["max"+vc]=n[cc],o[pc]=n[pc],t.parentNode!==e&&(t.parentNode.insertBefore(e,t),e.appendChild(t)),t._gsap.swappedIn=!0}},su=/([A-Z])/g,au=function(t){if(t){var e,n,i=t.t.style,r=t.length,s=0;for((t.t._gsap||qo.core.getCache(t.t)).uncache=1;s<r;s+=2)n=t[s+1],e=t[s],n?i[e]=n:i[e]&&i.removeProperty(e.replace(su,"-$1").toLowerCase())}},ou=function(t){for(var e=iu.length,n=t.style,i=[],r=0;r<e;r++)i.push(iu[r],n[iu[r]]);return i.t=t,i},lu={left:0,top:0},cu=function(t,e,n,i,r,s,a,o,l,c,u,h,d,f){$l(t)&&(t=t(o)),Jl(t)&&"max"===t.substr(0,3)&&(t=h+("="===t.charAt(4)?Dc("0"+t.substr(3),n):0));var p,m,g,v=d?d.time():0;if(d&&d.seek(0),isNaN(t)||(t=+t),tc(t))d&&(t=qo.utils.mapRange(d.scrollTrigger.start,d.scrollTrigger.end,0,h,t)),a&&Ic(a,n,i,!0);else{$l(e)&&(e=e(o));var y,_,b,x,E=(t||"0").split(" ");g=Ho(e,o)||tl,(y=xc(g)||{})&&(y.left||y.top)||"none"!==_c(g).display||(x=g.style.display,g.style.display="block",y=xc(g),x?g.style.display=x:g.style.removeProperty("display")),_=Dc(E[0],y[i.d]),b=Dc(E[1]||"0",n),t=y[i.p]-l[i.p]-c+_+r-b,a&&Ic(a,b,i,n-b<20||a._isStart&&b>20),n-=n-b}if(f&&(o[f]=t||-.001,t<0&&(t=0)),s){var w=t+n,S=s._isStart;p="scroll"+i.d2,Ic(s,w,i,S&&w>20||!S&&(u?Math.max(tl[p],$o[p]):s.parentNode[p])<=w+1),u&&(l=xc(a),u&&(s.style[i.op.p]=l[i.op.p]-i.op.m-s._offset+yc))}return d&&g&&(p=xc(g),d.seek(h),m=xc(g),d._caScrollDist=p[i.p]-m[i.p],t=t/d._caScrollDist*h),d&&d.seek(v),d?t:Math.round(t)},uu=/(webkit|moz|length|cssText|inset)/i,hu=function(t,e,n,i){if(t.parentNode!==e){var r,s,a=t.style;if(e===tl){for(r in t._stOrig=a.cssText,s=_c(t))+r||uu.test(r)||!s[r]||"string"!==typeof a[r]||"0"===r||(a[r]=s[r]);a.top=n,a.left=i}else a.cssText=t._stOrig;qo.core.getCache(t).uncache=1,e.appendChild(t)}},du=function(t,e,n){var i=e,r=i;return function(e){var s=Math.round(t());return s!==i&&s!==r&&Math.abs(s-i)>3&&Math.abs(s-r)>3&&(e=s,n&&n()),r=i,i=Math.round(e)}},fu=function(t,e,n){var i={};i[e.p]="+="+n,qo.set(t,i)},pu=function(t,e){var n=Vo(t,e),i="_scroll"+e.p2,r=function e(r,s,a,o,l){var c=e.tween,u=s.onComplete,h={};a=a||n();var d=du(n,a,function(){c.kill(),e.tween=0});return l=o&&l||0,o=o||r-a,c&&c.kill(),s[i]=r,s.inherit=!1,s.modifiers=h,h[i]=function(){return d(a+o*c.ratio+l*c.ratio*c.ratio)},s.onUpdate=function(){Ao.cache++,e.tween&&eu()},s.onComplete=function(){e.tween=0,u&&u.call(c)},c=e.tween=qo.to(t,s)};return t[i]=n,n.wheelHandler=function(){return r.tween&&r.tween.kill()&&(r.tween=0)},Mc(t,"wheel",n.wheelHandler),mu.isTouch&&Mc(t,"touchmove",n.wheelHandler),r},mu=function(){function t(e,n){Qo||t.register(qo)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),El(this),this.init(e,n)}return t.prototype.init=function(e,n){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),Fl){var i,r,s,a,o,l,c,u,h,d,f,p,m,g,v,y,_,b,x,E,w,S,T,M,A,C,R,k,L,D,P,I,O,N,F,U,B,z,H,V,G=e=bc(Jl(e)||tc(e)||e.nodeType?{trigger:e}:e,kc),j=G.onUpdate,W=G.toggleClass,Y=G.id,X=G.onToggle,K=G.onRefresh,q=G.scrub,Q=G.trigger,Z=G.pin,J=G.pinSpacing,$=G.invalidateOnRefresh,tt=G.anticipatePin,et=G.onScrubComplete,nt=G.onSnapComplete,it=G.once,rt=G.snap,st=G.pinReparent,at=G.pinSpacer,ot=G.containerAnimation,lt=G.fastScrollEnd,ct=G.preventOverlaps,ut=e.horizontal||e.containerAnimation&&!1!==e.horizontal?Bo:zo,ht=!q&&0!==q,dt=Ho(e.scroller||Zo),ft=qo.core.getCache(dt),pt=Xl(dt),mt="fixed"===("pinType"in e?e.pinType:Lo(dt,"pinType")||pt&&"fixed"),gt=[e.onEnter,e.onLeave,e.onEnterBack,e.onLeaveBack],vt=ht&&e.toggleActions.split(" "),yt="markers"in e?e.markers:kc.markers,_t=pt?0:parseFloat(_c(dt)["border"+ut.p2+gc])||0,bt=this,xt=e.onRefreshInit&&function(){return e.onRefreshInit(bt)},Et=function(t,e,n){var i=n.d,r=n.d2,s=n.a;return(s=Lo(t,"getBoundingClientRect"))?function(){return s()[i]}:function(){return(e?Kl(r):t["client"+r])||0}}(dt,pt,ut),wt=function(t,e){return!e||~Co.indexOf(t)?ql(t):function(){return lu}}(dt,pt),St=0,Tt=0,Mt=0,At=Vo(dt,ut);if(bt._startClamp=bt._endClamp=!1,bt._dir=ut,tt*=45,bt.scroller=dt,bt.scroll=ot?ot.time.bind(ot):At,a=At(),bt.vars=e,n=n||e.animation,"refreshPriority"in e&&(pl=1,-9999===e.refreshPriority&&(Dl=bt)),ft.tweenScroll=ft.tweenScroll||{top:pu(dt,zo),left:pu(dt,Bo)},bt.tweenTo=i=ft.tweenScroll[ut.p],bt.scrubDuration=function(t){(O=tc(t)&&t)?I?I.duration(t):I=qo.to(n,{ease:"expo",totalProgress:"+=0",inherit:!1,duration:O,paused:!0,onComplete:function(){return et&&et(bt)}}):(I&&I.progress(1).kill(),I=0)},n&&(n.vars.lazy=!1,n._initted&&!bt.isReverted||!1!==n.vars.immediateRender&&!1!==e.immediateRender&&n.duration()&&n.render(0,!0,!0),bt.animation=n.pause(),n.scrollTrigger=bt,bt.scrubDuration(q),D=0,Y||(Y=n.vars.id)),rt&&(ec(rt)&&!rt.push||(rt={snapTo:rt}),"scrollBehavior"in tl.style&&qo.set(pt?[tl,$o]:dt,{scrollBehavior:"auto"}),Ao.forEach(function(t){return $l(t)&&t.target===(pt?Jo.scrollingElement||$o:dt)&&(t.smooth=!1)}),s=$l(rt.snapTo)?rt.snapTo:"labels"===rt.snapTo?function(t){return function(e){return qo.utils.snap(wc(t),e)}}(n):"labelsDirectional"===rt.snapTo?(V=n,function(t,e){return Sc(wc(V))(t,e.direction)}):!1!==rt.directional?function(t,e){return Sc(rt.snapTo)(t,Il()-Tt<500?0:e.direction)}:qo.utils.snap(rt.snapTo),N=rt.duration||{min:.1,max:2},N=ec(N)?rl(N.min,N.max):rl(N,N),F=qo.delayedCall(rt.delay||O/2||.1,function(){var t=At(),e=Il()-Tt<500,r=i.tween;if(!(e||Math.abs(bt.getVelocity())<10)||r||ll||St===t)bt.isActive&&St!==t&&F.restart(!0);else{var a,o,u=(t-l)/g,h=n&&!ht?n.totalProgress():u,d=e?0:(h-P)/(Il()-sl)*1e3||0,f=qo.utils.clamp(-u,1-u,rc(d/2)*d/.185),p=u+(!1===rt.inertia?0:f),m=rt,v=m.onStart,y=m.onInterrupt,_=m.onComplete;if(a=s(p,bt),tc(a)||(a=p),o=Math.max(0,Math.round(l+a*g)),t<=c&&t>=l&&o!==t){if(r&&!r._initted&&r.data<=rc(o-t))return;!1===rt.inertia&&(f=a-u),i(o,{duration:N(rc(.185*Math.max(rc(p-h),rc(a-h))/d/.05||0)),ease:rt.ease||"power3",data:rc(o-t),onInterrupt:function(){return F.restart(!0)&&y&&y(bt)},onComplete:function(){bt.update(),St=At(),n&&!ht&&(I?I.resetTo("totalProgress",a,n._tTime/n._tDur):n.progress(a)),D=P=n&&!ht?n.totalProgress():bt.progress,nt&&nt(bt),_&&_(bt)}},t,f*g,o-t-f*g),v&&v(bt,i.tween)}}}).pause()),Y&&(Nc[Y]=bt),(H=(Q=bt.trigger=Ho(Q||!0!==Z&&Z))&&Q._gsap&&Q._gsap.stRevert)&&(H=H(bt)),Z=!0===Z?Q:Ho(Z),Jl(W)&&(W={targets:Q,className:W}),Z&&(!1===J||J===mc||(J=!(!J&&Z.parentNode&&Z.parentNode.style&&"flex"===_c(Z.parentNode).display)&&pc),bt.pin=Z,(r=qo.core.getCache(Z)).spacer?v=r.pinState:(at&&((at=Ho(at))&&!at.nodeType&&(at=at.current||at.nativeElement),r.spacerIsNative=!!at,at&&(r.spacerState=ou(at))),r.spacer=b=at||Jo.createElement("div"),b.classList.add("pin-spacer"),Y&&b.classList.add("pin-spacer-"+Y),r.pinState=v=ou(Z)),!1!==e.force3D&&qo.set(Z,{force3D:!0}),bt.spacer=b=r.spacer,L=_c(Z),M=L[J+ut.os2],E=qo.getProperty(Z),w=qo.quickSetter(Z,ut.a,yc),ru(Z,b,L),_=ou(Z)),yt){p=ec(yt)?bc(yt,Rc):Rc,d=Pc("scroller-start",Y,dt,ut,p,0),f=Pc("scroller-end",Y,dt,ut,p,0,d),x=d["offset"+ut.op.d2];var Ct=Ho(Lo(dt,"content")||dt);u=this.markerStart=Pc("start",Y,Ct,ut,p,x,0,ot),h=this.markerEnd=Pc("end",Y,Ct,ut,p,x,0,ot),ot&&(z=qo.quickSetter([u,h],ut.a,yc)),mt||Co.length&&!0===Lo(dt,"fixedMarkers")||(!function(t){var e=_c(t).position;t.style.position="absolute"===e||"fixed"===e?e:"relative"}(pt?tl:dt),qo.set([d,f],{force3D:!0}),C=qo.quickSetter(d,ut.a,yc),k=qo.quickSetter(f,ut.a,yc))}if(ot){var Rt=ot.vars.onUpdate,kt=ot.vars.onUpdateParams;ot.eventCallback("onUpdate",function(){bt.update(0,0,1),Rt&&Rt.apply(ot,kt||[])})}if(bt.previous=function(){return Oc[Oc.indexOf(bt)-1]},bt.next=function(){return Oc[Oc.indexOf(bt)+1]},bt.revert=function(t,e){if(!e)return bt.kill(!0);var i=!1!==t||!bt.enabled,r=ol;i!==bt.isReverted&&(i&&(U=Math.max(At(),bt.scroll.rec||0),Mt=bt.progress,B=n&&n.progress()),u&&[u,h,d,f].forEach(function(t){return t.style.display=i?"none":"block"}),i&&(ol=bt,bt.update(i)),!Z||st&&bt.isActive||(i?function(t,e,n){au(n);var i=t._gsap;if(i.spacerIsNative)au(i.spacerState);else if(t._gsap.swappedIn){var r=e.parentNode;r&&(r.insertBefore(t,e),r.removeChild(e))}t._gsap.swappedIn=!1}(Z,b,v):ru(Z,b,_c(Z),A)),i||bt.update(i),ol=r,bt.isReverted=i)},bt.refresh=function(r,s,p,x){if(!ol&&bt.enabled||s)if(Z&&r&&Nl)Mc(t,"scrollEnd",Gc);else{!kl&&xt&&xt(bt),ol=bt,i.tween&&!p&&(i.tween.kill(),i.tween=0),I&&I.pause(),$&&n&&(n.revert({kill:!1}).invalidate(),n.getChildren&&n.getChildren(!0,!0,!1).forEach(function(t){return t.vars.immediateRender&&t.render(0,!0,!0)})),bt.isReverted||bt.revert(!0,!0),bt._subPinOffset=!1;var w,M,C,k,L,D,P,O,N,z,H,V,G,j=Et(),W=wt(),Y=ot?ot.duration():Ql(dt,ut),X=g<=.01||!g,q=0,tt=x||0,et=ec(p)?p.end:e.end,nt=e.endTrigger||Q,it=ec(p)?p.start:e.start||(0!==e.start&&Q?Z?"0 0":"0 100%":0),rt=bt.pinnedContainer=e.pinnedContainer&&Ho(e.pinnedContainer,bt),at=Q&&Math.max(0,Oc.indexOf(bt))||0,lt=at;for(yt&&ec(p)&&(V=qo.getProperty(d,ut.p),G=qo.getProperty(f,ut.p));lt-- >0;)(D=Oc[lt]).end||D.refresh(0,1)||(ol=bt),!(P=D.pin)||P!==Q&&P!==Z&&P!==rt||D.isReverted||(z||(z=[]),z.unshift(D),D.revert(!0,!0)),D!==Oc[lt]&&(at--,lt--);for($l(it)&&(it=it(bt)),it=Ul(it,"start",bt),l=cu(it,Q,j,ut,At(),u,d,bt,W,_t,mt,Y,ot,bt._startClamp&&"_startClamp")||(Z?-.001:0),$l(et)&&(et=et(bt)),Jl(et)&&!et.indexOf("+=")&&(~et.indexOf(" ")?et=(Jl(it)?it.split(" ")[0]:"")+et:(q=Dc(et.substr(2),j),et=Jl(it)?it:(ot?qo.utils.mapRange(0,ot.duration(),ot.scrollTrigger.start,ot.scrollTrigger.end,l):l)+q,nt=Q)),et=Ul(et,"end",bt),c=Math.max(l,cu(et||(nt?"100% 0":Y),nt,j,ut,At()+q,h,f,bt,W,_t,mt,Y,ot,bt._endClamp&&"_endClamp"))||-.001,q=0,lt=at;lt--;)(P=(D=Oc[lt]).pin)&&D.start-D._pinPush<=l&&!ot&&D.end>0&&(w=D.end-(bt._startClamp?Math.max(0,D.start):D.start),(P===Q&&D.start-D._pinPush<l||P===rt)&&isNaN(it)&&(q+=w*(1-D.progress)),P===Z&&(tt+=w));if(l+=q,c+=q,bt._startClamp&&(bt._startClamp+=q),bt._endClamp&&!kl&&(bt._endClamp=c||-.001,c=Math.min(c,Ql(dt,ut))),g=c-l||(l-=.01)&&.001,X&&(Mt=qo.utils.clamp(0,1,qo.utils.normalize(l,c,U))),bt._pinPush=tt,u&&q&&((w={})[ut.a]="+="+q,rt&&(w[ut.p]="-="+At()),qo.set([u,h],w)),!Z||Al&&bt.end>=Ql(dt,ut)){if(Q&&At()&&!ot)for(M=Q.parentNode;M&&M!==tl;)M._pinOffset&&(l-=M._pinOffset,c-=M._pinOffset),M=M.parentNode}else w=_c(Z),k=ut===zo,C=At(),S=parseFloat(E(ut.a))+tt,!Y&&c>1&&(H={style:H=(pt?Jo.scrollingElement||$o:dt).style,value:H["overflow"+ut.a.toUpperCase()]},pt&&"scroll"!==_c(tl)["overflow"+ut.a.toUpperCase()]&&(H.style["overflow"+ut.a.toUpperCase()]="scroll")),ru(Z,b,w),_=ou(Z),M=xc(Z,!0),O=mt&&Vo(dt,k?Bo:zo)(),J?((A=[J+ut.os2,g+tt+yc]).t=b,(lt=J===pc?Ec(Z,ut)+g+tt:0)&&(A.push(ut.d,lt+yc),"auto"!==b.style.flexBasis&&(b.style.flexBasis=lt+yc)),au(A),rt&&Oc.forEach(function(t){t.pin===rt&&!1!==t.vars.pinSpacing&&(t._subPinOffset=!0)}),mt&&At(U)):(lt=Ec(Z,ut))&&"auto"!==b.style.flexBasis&&(b.style.flexBasis=lt+yc),mt&&((L={top:M.top+(k?C-l:O)+yc,left:M.left+(k?O:C-l)+yc,boxSizing:"border-box",position:"fixed"})[lc]=L["max"+gc]=Math.ceil(M.width)+yc,L[cc]=L["max"+vc]=Math.ceil(M.height)+yc,L[mc]=L[mc+dc]=L[mc+uc]=L[mc+fc]=L[mc+hc]="0",L[pc]=w[pc],L[pc+dc]=w[pc+dc],L[pc+uc]=w[pc+uc],L[pc+fc]=w[pc+fc],L[pc+hc]=w[pc+hc],y=function(t,e,n){for(var i,r=[],s=t.length,a=n?8:0;a<s;a+=2)i=t[a],r.push(i,i in e?e[i]:t[a+1]);return r.t=t.t,r}(v,L,st),kl&&At(0)),n?(N=n._initted,ml(1),n.render(n.duration(),!0,!0),T=E(ut.a)-S+g+tt,R=Math.abs(g-T)>1,mt&&R&&y.splice(y.length-2,2),n.render(0,!0,!0),N||n.invalidate(!0),n.parent||n.totalTime(n.totalTime()),ml(0)):T=g,H&&(H.value?H.style["overflow"+ut.a.toUpperCase()]=H.value:H.style.removeProperty("overflow-"+ut.a));z&&z.forEach(function(t){return t.revert(!1,!0)}),bt.start=l,bt.end=c,a=o=kl?U:At(),ot||kl||(a<U&&At(U),bt.scroll.rec=0),bt.revert(!1,!0),Tt=Il(),F&&(St=-1,F.restart(!0)),ol=0,n&&ht&&(n._initted||B)&&n.progress()!==B&&n.progress(B||0,!0).render(n.time(),!0,!0),(X||Mt!==bt.progress||ot||$||n&&!n._initted)&&(n&&!ht&&(n._initted||Mt||!1!==n.vars.immediateRender)&&n.totalProgress(ot&&l<-.001&&!Mt?qo.utils.normalize(l,c,0):Mt,!0),bt.progress=X||(a-l)/g===Mt?0:Mt),Z&&J&&(b._pinOffset=Math.round(bt.progress*T)),I&&I.invalidate(),isNaN(V)||(V-=qo.getProperty(d,ut.p),G-=qo.getProperty(f,ut.p),fu(d,ut,V),fu(u,ut,V-(x||0)),fu(f,ut,G),fu(h,ut,G-(x||0))),X&&!kl&&bt.update(),!K||kl||m||(m=!0,K(bt),m=!1)}},bt.getVelocity=function(){return(At()-o)/(Il()-sl)*1e3||0},bt.endAnimation=function(){nc(bt.callbackAnimation),n&&(I?I.progress(1):n.paused()?ht||nc(n,bt.direction<0,1):nc(n,n.reversed()))},bt.labelToScroll=function(t){return n&&n.labels&&(l||bt.refresh()||l)+n.labels[t]/n.duration()*g||0},bt.getTrailing=function(t){var e=Oc.indexOf(bt),n=bt.direction>0?Oc.slice(0,e).reverse():Oc.slice(e+1);return(Jl(t)?n.filter(function(e){return e.vars.preventOverlaps===t}):n).filter(function(t){return bt.direction>0?t.end<=l:t.start>=c})},bt.update=function(t,e,r){if(!ot||r||t){var s,u,h,f,p,m,v,x=!0===kl?U:bt.scroll(),E=t?0:(x-l)/g,A=E<0?0:E>1?1:E||0,L=bt.progress;if(e&&(o=a,a=ot?At():x,rt&&(P=D,D=n&&!ht?n.totalProgress():A)),tt&&Z&&!ol&&!Pl&&Nl&&(!A&&l<x+(x-o)/(Il()-sl)*tt?A=1e-4:1===A&&c>x+(x-o)/(Il()-sl)*tt&&(A=.9999)),A!==L&&bt.enabled){if(f=(p=(s=bt.isActive=!!A&&A<1)!==(!!L&&L<1))||!!A!==!!L,bt.direction=A>L?1:-1,bt.progress=A,f&&!ol&&(u=A&&!L?0:1===A?1:1===L?2:3,ht&&(h=!p&&"none"!==vt[u+1]&&vt[u+1]||vt[u],v=n&&("complete"===h||"reset"===h||h in n))),ct&&(p||v)&&(v||q||!n)&&($l(ct)?ct(bt):bt.getTrailing(ct).forEach(function(t){return t.endAnimation()})),ht||(!I||ol||Pl?n&&n.totalProgress(A,!(!ol||!Tt&&!t)):(I._dp._time-I._start!==I._time&&I.render(I._dp._time-I._start),I.resetTo?I.resetTo("totalProgress",A,n._tTime/n._tDur):(I.vars.totalProgress=A,I.invalidate().restart()))),Z)if(t&&J&&(b.style[J+ut.os2]=M),mt){if(f){if(m=!t&&A>L&&c+1>x&&x+1>=Ql(dt,ut),st)if(t||!s&&!m)hu(Z,b);else{var O=xc(Z,!0),N=x-l;hu(Z,tl,O.top+(ut===zo?N:0)+yc,O.left+(ut===zo?0:N)+yc)}au(s||m?y:_),R&&A<1&&s||w(S+(1!==A||m?0:T))}}else w(jl(S+T*A));rt&&!i.tween&&!ol&&!Pl&&F.restart(!0),W&&(p||it&&A&&(A<1||!Cl))&&il(W.targets).forEach(function(t){return t.classList[s||it?"add":"remove"](W.className)}),j&&!ht&&!t&&j(bt),f&&!ol?(ht&&(v&&("complete"===h?n.pause().totalProgress(1):"reset"===h?n.restart(!0).pause():"restart"===h?n.restart(!0):n[h]()),j&&j(bt)),!p&&Cl||(X&&p&&ic(bt,X),gt[u]&&ic(bt,gt[u]),it&&(1===A?bt.kill(!1,1):gt[u]=0),p||gt[u=1===A?1:3]&&ic(bt,gt[u])),lt&&!s&&Math.abs(bt.getVelocity())>(tc(lt)?lt:2500)&&(nc(bt.callbackAnimation),I?I.progress(1):nc(n,"reverse"===h?1:!A,1))):ht&&j&&!ol&&j(bt)}if(k){var B=ot?x/ot.duration()*(ot._caScrollDist||0):x;C(B+(d._isFlipped?1:0)),k(B)}z&&z(-x/ot.duration()*(ot._caScrollDist||0))}},bt.enable=function(e,n){bt.enabled||(bt.enabled=!0,Mc(dt,"resize",zc),pt||Mc(dt,"scroll",Uc),xt&&Mc(t,"refreshInit",xt),!1!==e&&(bt.progress=Mt=0,a=o=St=At()),!1!==n&&bt.refresh())},bt.getTween=function(t){return t&&i?i.tween:I},bt.setPositions=function(t,e,n,i){if(ot){var r=ot.scrollTrigger,s=ot.duration(),a=r.end-r.start;t=r.start+a*t/s,e=r.start+a*e/s}bt.refresh(!1,!1,{start:Bl(t,n&&!!bt._startClamp),end:Bl(e,n&&!!bt._endClamp)},i),bt.update()},bt.adjustPinSpacing=function(t){if(A&&t){var e=A.indexOf(ut.d)+1;A[e]=parseFloat(A[e])+t+yc,A[1]=parseFloat(A[1])+t+yc,au(A)}},bt.disable=function(e,n){if(bt.enabled&&(!1!==e&&bt.revert(!0,!0),bt.enabled=bt.isActive=!1,n||I&&I.pause(),U=0,r&&(r.uncache=1),xt&&Ac(t,"refreshInit",xt),F&&(F.pause(),i.tween&&i.tween.kill()&&(i.tween=0)),!pt)){for(var s=Oc.length;s--;)if(Oc[s].scroller===dt&&Oc[s]!==bt)return;Ac(dt,"resize",zc),pt||Ac(dt,"scroll",Uc)}},bt.kill=function(t,i){bt.disable(t,i),I&&!i&&I.kill(),Y&&delete Nc[Y];var s=Oc.indexOf(bt);s>=0&&Oc.splice(s,1),s===ul&&tu>0&&ul--,s=0,Oc.forEach(function(t){return t.scroller===bt.scroller&&(s=1)}),s||kl||(bt.scroll.rec=0),n&&(n.scrollTrigger=null,t&&n.revert({kill:!1}),i||n.kill()),u&&[u,h,d,f].forEach(function(t){return t.parentNode&&t.parentNode.removeChild(t)}),Dl===bt&&(Dl=0),Z&&(r&&(r.uncache=1),s=0,Oc.forEach(function(t){return t.pin===Z&&s++}),s||(r.spacer=0)),e.onKill&&e.onKill(bt)},Oc.push(bt),bt.enable(!1,!1),H&&H(bt),n&&n.add&&!g){var Lt=bt.update;bt.update=function(){bt.update=Lt,Ao.cache++,l||c||bt.refresh()},qo.delayedCall(.01,bt.update),g=.01,l=c=0}else bt.refresh();Z&&function(){if(Ll!==qc){var t=Ll=qc;requestAnimationFrame(function(){return t===qc&&Jc(!0)})}}()}else this.update=this.refresh=this.kill=Gl},t.register=function(e){return Qo||(qo=e||Yl(),Wl()&&window.document&&t.enable(),Qo=Fl),Qo},t.defaults=function(t){if(t)for(var e in t)kc[e]=t[e];return kc},t.disable=function(t,e){Fl=0,Oc.forEach(function(n){return n[e?"kill":"disable"](t)}),Ac(Zo,"wheel",Uc),Ac(Jo,"scroll",Uc),clearInterval(al),Ac(Jo,"touchcancel",Gl),Ac(tl,"touchstart",Gl),Tc(Ac,Jo,"pointerdown,touchstart,mousedown",Hl),Tc(Ac,Jo,"pointerup,touchend,mouseup",Vl),nl.kill(),Zl(Ac);for(var n=0;n<Ao.length;n+=3)Cc(Ac,Ao[n],Ao[n+1]),Cc(Ac,Ao[n],Ao[n+2])},t.enable=function(){if(Zo=window,Jo=document,$o=Jo.documentElement,tl=Jo.body,qo&&(il=qo.utils.toArray,rl=qo.utils.clamp,El=qo.core.context||Gl,ml=qo.core.suppressOverwrites||Gl,wl=Zo.history.scrollRestoration||"auto",$c=Zo.pageYOffset||0,qo.core.globals("ScrollTrigger",t),tl)){Fl=1,(Sl=document.createElement("div")).style.height="100vh",Sl.style.position="absolute",Qc(),zl(),Ko.register(qo),t.isTouch=Ko.isTouch,xl=Ko.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),yl=1===Ko.isTouch,Mc(Zo,"wheel",Uc),el=[Zo,Jo,$o,tl],qo.matchMedia?(t.matchMedia=function(t){var e,n=qo.matchMedia();for(e in t)n.add(e,t[e]);return n},qo.addEventListener("matchMediaInit",function(){return Xc()}),qo.addEventListener("matchMediaRevert",function(){return Yc()}),qo.addEventListener("matchMedia",function(){Jc(0,1),jc("matchMedia")}),qo.matchMedia().add("(orientation: portrait)",function(){return Bc(),Bc})):console.warn("Requires GSAP 3.11.0 or later"),Bc(),Mc(Jo,"scroll",Uc);var e,n,i=tl.hasAttribute("style"),r=tl.style,s=r.borderTopStyle,a=qo.core.Animation.prototype;for(a.revert||Object.defineProperty(a,"revert",{value:function(){return this.time(-.01,!0)}}),r.borderTopStyle="solid",e=xc(tl),zo.m=Math.round(e.top+zo.sc())||0,Bo.m=Math.round(e.left+Bo.sc())||0,s?r.borderTopStyle=s:r.removeProperty("border-top-style"),i||(tl.setAttribute("style",""),tl.removeAttribute("style")),al=setInterval(Fc,250),qo.delayedCall(.5,function(){return Pl=0}),Mc(Jo,"touchcancel",Gl),Mc(tl,"touchstart",Gl),Tc(Mc,Jo,"pointerdown,touchstart,mousedown",Hl),Tc(Mc,Jo,"pointerup,touchend,mouseup",Vl),cl=qo.utils.checkPrefix("transform"),iu.push(cl),Qo=Il(),nl=qo.delayedCall(.2,Jc).pause(),fl=[Jo,"visibilitychange",function(){var t=Zo.innerWidth,e=Zo.innerHeight;Jo.hidden?(hl=t,dl=e):hl===t&&dl===e||zc()},Jo,"DOMContentLoaded",Jc,Zo,"load",Jc,Zo,"resize",zc],Zl(Mc),Oc.forEach(function(t){return t.enable(0,1)}),n=0;n<Ao.length;n+=3)Cc(Ac,Ao[n],Ao[n+1]),Cc(Ac,Ao[n],Ao[n+2])}},t.config=function(e){"limitCallbacks"in e&&(Cl=!!e.limitCallbacks);var n=e.syncInterval;n&&clearInterval(al)||(al=n)&&setInterval(Fc,n),"ignoreMobileResize"in e&&(yl=1===t.isTouch&&e.ignoreMobileResize),"autoRefreshEvents"in e&&(Zl(Ac)||Zl(Mc,e.autoRefreshEvents||"none"),gl=-1===(e.autoRefreshEvents+"").indexOf("resize"))},t.scrollerProxy=function(t,e){var n=Ho(t),i=Ao.indexOf(n),r=Xl(n);~i&&Ao.splice(i,r?6:2),e&&(r?Co.unshift(Zo,e,tl,e,$o,e):Co.unshift(n,e))},t.clearMatchMedia=function(t){Oc.forEach(function(e){return e._ctx&&e._ctx.query===t&&e._ctx.kill(!0,!0)})},t.isInViewport=function(t,e,n){var i=(Jl(t)?Ho(t):t).getBoundingClientRect(),r=i[n?lc:cc]*e||0;return n?i.right-r>0&&i.left+r<Zo.innerWidth:i.bottom-r>0&&i.top+r<Zo.innerHeight},t.positionInViewport=function(t,e,n){Jl(t)&&(t=Ho(t));var i=t.getBoundingClientRect(),r=i[n?lc:cc],s=null==e?r/2:e in Lc?Lc[e]*r:~e.indexOf("%")?parseFloat(e)*r/100:parseFloat(e)||0;return n?(i.left+s)/Zo.innerWidth:(i.top+s)/Zo.innerHeight},t.killAll=function(t){if(Oc.slice(0).forEach(function(t){return"ScrollSmoother"!==t.vars.id&&t.kill()}),!0!==t){var e=Hc.killAll||[];Hc={},e.forEach(function(t){return t()})}},t}();mu.version="3.13.0",mu.saveStyles=function(t){return t?il(t).forEach(function(t){if(t&&t.style){var e=Wc.indexOf(t);e>=0&&Wc.splice(e,5),Wc.push(t,t.style.cssText,t.getBBox&&t.getAttribute("transform"),qo.core.getCache(t),El())}}):Wc},mu.revert=function(t,e){return Xc(!t,e)},mu.create=function(t,e){return new mu(t,e)},mu.refresh=function(t){return t?zc(!0):(Qo||mu.register())&&Jc(!0)},mu.update=function(t){return++Ao.cache&&eu(!0===t?2:0)},mu.clearScrollMemory=Kc,mu.maxScroll=function(t,e){return Ql(t,e?Bo:zo)},mu.getScrollFunc=function(t,e){return Vo(Ho(t),e?Bo:zo)},mu.getById=function(t){return Nc[t]},mu.getAll=function(){return Oc.filter(function(t){return"ScrollSmoother"!==t.vars.id})},mu.isScrolling=function(){return!!Nl},mu.snapDirectional=Sc,mu.addEventListener=function(t,e){var n=Hc[t]||(Hc[t]=[]);~n.indexOf(e)||n.push(e)},mu.removeEventListener=function(t,e){var n=Hc[t],i=n&&n.indexOf(e);i>=0&&n.splice(i,1)},mu.batch=function(t,e){var n,i=[],r={},s=e.interval||.016,a=e.batchMax||1e9,o=function(t,e){var n=[],i=[],r=qo.delayedCall(s,function(){e(n,i),n=[],i=[]}).pause();return function(t){n.length||r.restart(!0),n.push(t.trigger),i.push(t),a<=n.length&&r.progress(1)}};for(n in e)r[n]="on"===n.substr(0,2)&&$l(e[n])&&"onRefreshInit"!==n?o(0,e[n]):e[n];return $l(a)&&(a=a(),Mc(mu,"refresh",function(){return a=e.batchMax()})),il(t).forEach(function(t){var e={};for(n in r)e[n]=r[n];e.trigger=t,i.push(mu.create(e))}),i};var gu,vu=function(t,e,n,i){return e>i?t(i):e<0&&t(0),n>i?(i-e)/(n-e):n<0?e/(e-n):1},yu=function t(e,n){!0===n?e.style.removeProperty("touch-action"):e.style.touchAction=!0===n?"auto":n?"pan-"+n+(Ko.isTouch?" pinch-zoom":""):"none",e===$o&&t(tl,n)},_u={auto:1,scroll:1},bu=function(t){var e,n=t.event,i=t.target,r=t.axis,s=(n.changedTouches?n.changedTouches[0]:n).target,a=s._gsap||qo.core.getCache(s),o=Il();if(!a._isScrollT||o-a._isScrollT>2e3){for(;s&&s!==tl&&(s.scrollHeight<=s.clientHeight&&s.scrollWidth<=s.clientWidth||!_u[(e=_c(s)).overflowY]&&!_u[e.overflowX]);)s=s.parentNode;a._isScroll=s&&s!==i&&!Xl(s)&&(_u[(e=_c(s)).overflowY]||_u[e.overflowX]),a._isScrollT=o}(a._isScroll||"x"===r)&&(n.stopPropagation(),n._gsapAllow=!0)},xu=function(t,e,n,i){return Ko.create({target:t,capture:!0,debounce:!1,lockAxis:!0,type:e,onWheel:i=i&&bu,onPress:i,onDrag:i,onScroll:i,onEnable:function(){return n&&Mc(Jo,Ko.eventTypes[0],wu,!1,!0)},onDisable:function(){return Ac(Jo,Ko.eventTypes[0],wu,!0)}})},Eu=/(input|label|select|textarea)/i,wu=function(t){var e=Eu.test(t.target.tagName);(e||gu)&&(t._gsapAllow=!0,gu=e)},Su=function(t){ec(t)||(t={}),t.preventDefault=t.isNormalizer=t.allowClicks=!0,t.type||(t.type="wheel,touch"),t.debounce=!!t.debounce,t.id=t.id||"normalizer";var e,n,i,r,s,a,o,l,c=t,u=c.normalizeScrollX,h=c.momentum,d=c.allowNestedScroll,f=c.onRelease,p=Ho(t.target)||$o,m=qo.core.globals().ScrollSmoother,g=m&&m.get(),v=xl&&(t.content&&Ho(t.content)||g&&!1!==t.content&&!g.smooth()&&g.content()),y=Vo(p,zo),_=Vo(p,Bo),b=1,x=(Ko.isTouch&&Zo.visualViewport?Zo.visualViewport.scale*Zo.visualViewport.width:Zo.outerWidth)/Zo.innerWidth,E=0,w=$l(h)?function(){return h(e)}:function(){return h||2.8},S=xu(p,t.type,!0,d),T=function(){return r=!1},M=Gl,A=Gl,C=function(){n=Ql(p,zo),A=rl(xl?1:0,n),u&&(M=rl(0,Ql(p,Bo))),i=qc},R=function(){v._gsap.y=jl(parseFloat(v._gsap.y)+y.offset)+"px",v.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(v._gsap.y)+", 0, 1)",y.offset=y.cacheID=0},k=function(){C(),s.isActive()&&s.vars.scrollY>n&&(y()>n?s.progress(1)&&y(n):s.resetTo("scrollY",n))};return v&&qo.set(v,{y:"+=0"}),t.ignoreCheck=function(t){return xl&&"touchmove"===t.type&&function(){if(r){requestAnimationFrame(T);var t=jl(e.deltaY/2),n=A(y.v-t);if(v&&n!==y.v+y.offset){y.offset=n-y.v;var i=jl((parseFloat(v&&v._gsap.y)||0)-y.offset);v.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+i+", 0, 1)",v._gsap.y=i+"px",y.cacheID=Ao.cache,eu()}return!0}y.offset&&R(),r=!0}()||b>1.05&&"touchstart"!==t.type||e.isGesturing||t.touches&&t.touches.length>1},t.onPress=function(){r=!1;var t=b;b=jl((Zo.visualViewport&&Zo.visualViewport.scale||1)/x),s.pause(),t!==b&&yu(p,b>1.01||!u&&"x"),a=_(),o=y(),C(),i=qc},t.onRelease=t.onGestureStart=function(t,e){if(y.offset&&R(),e){Ao.cache++;var i,r,a=w();u&&(r=(i=_())+.05*a*-t.velocityX/.227,a*=vu(_,i,r,Ql(p,Bo)),s.vars.scrollX=M(r)),r=(i=y())+.05*a*-t.velocityY/.227,a*=vu(y,i,r,Ql(p,zo)),s.vars.scrollY=A(r),s.invalidate().duration(a).play(.01),(xl&&s.vars.scrollY>=n||i>=n-1)&&qo.to({},{onUpdate:k,duration:a})}else l.restart(!0);f&&f(t)},t.onWheel=function(){s._ts&&s.pause(),Il()-E>1e3&&(i=0,E=Il())},t.onChange=function(t,e,n,r,s){if(qc!==i&&C(),e&&u&&_(M(r[2]===e?a+(t.startX-t.x):_()+e-r[1])),n){y.offset&&R();var l=s[2]===n,c=l?o+t.startY-t.y:y()+n-s[1],h=A(c);l&&c!==h&&(o+=h-c),y(h)}(n||e)&&eu()},t.onEnable=function(){yu(p,!u&&"x"),mu.addEventListener("refresh",k),Mc(Zo,"resize",k),y.smooth&&(y.target.style.scrollBehavior="auto",y.smooth=_.smooth=!1),S.enable()},t.onDisable=function(){yu(p,!0),Ac(Zo,"resize",k),mu.removeEventListener("refresh",k),S.kill()},t.lockAxis=!1!==t.lockAxis,(e=new Ko(t)).iOS=xl,xl&&!y()&&y(1),xl&&qo.ticker.add(Gl),l=e._dc,s=qo.to(e,{ease:"power4",paused:!0,inherit:!1,scrollX:u?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:du(y,y(),function(){return s.pause()})},onUpdate:eu,onComplete:l.vars.onComplete}),e};mu.sort=function(t){if($l(t))return Oc.sort(t);var e=Zo.pageYOffset||0;return mu.getAll().forEach(function(t){return t._sortY=t.trigger?e+t.trigger.getBoundingClientRect().top:t.start+Zo.innerHeight}),Oc.sort(t||function(t,e){return-1e6*(t.vars.refreshPriority||0)+(t.vars.containerAnimation?1e6:t._sortY)-((e.vars.containerAnimation?1e6:e._sortY)+-1e6*(e.vars.refreshPriority||0))})},mu.observe=function(t){return new Ko(t)},mu.normalizeScroll=function(t){if("undefined"===typeof t)return vl;if(!0===t&&vl)return vl.enable();if(!1===t)return vl&&vl.kill(),void(vl=t);var e=t instanceof Ko?t:Su(t);return vl&&vl.target===e.target&&vl.kill(),Xl(e.target)&&(vl=e),e},mu.core={_getVelocityProp:Go,_inputObserver:xu,_scrollers:Ao,_proxies:Co,bridge:{ss:function(){Nl||jc("scrollStart"),Nl=Il()},ref:function(){return ol}}},Yl()&&qo.registerPlugin(mu);const Tu=Number.isFinite||function(t){return"number"===typeof t&&isFinite(t)},Mu=Number.isSafeInteger||function(t){return"number"===typeof t&&Math.abs(t)<=Au},Au=Number.MAX_SAFE_INTEGER||9007199254740991;let Cu=function(t){return t.NETWORK_ERROR="networkError",t.MEDIA_ERROR="mediaError",t.KEY_SYSTEM_ERROR="keySystemError",t.MUX_ERROR="muxError",t.OTHER_ERROR="otherError",t}({}),Ru=function(t){return t.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",t.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",t.KEY_SYSTEM_NO_SESSION="keySystemNoSession",t.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",t.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",t.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",t.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",t.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",t.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",t.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",t.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",t.MANIFEST_LOAD_ERROR="manifestLoadError",t.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",t.MANIFEST_PARSING_ERROR="manifestParsingError",t.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",t.LEVEL_EMPTY_ERROR="levelEmptyError",t.LEVEL_LOAD_ERROR="levelLoadError",t.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",t.LEVEL_PARSING_ERROR="levelParsingError",t.LEVEL_SWITCH_ERROR="levelSwitchError",t.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",t.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",t.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",t.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",t.FRAG_LOAD_ERROR="fragLoadError",t.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",t.FRAG_DECRYPT_ERROR="fragDecryptError",t.FRAG_PARSING_ERROR="fragParsingError",t.FRAG_GAP="fragGap",t.REMUX_ALLOC_ERROR="remuxAllocError",t.KEY_LOAD_ERROR="keyLoadError",t.KEY_LOAD_TIMEOUT="keyLoadTimeOut",t.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",t.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",t.BUFFER_APPEND_ERROR="bufferAppendError",t.BUFFER_APPENDING_ERROR="bufferAppendingError",t.BUFFER_STALLED_ERROR="bufferStalledError",t.BUFFER_FULL_ERROR="bufferFullError",t.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",t.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",t.ASSET_LIST_LOAD_ERROR="assetListLoadError",t.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",t.ASSET_LIST_PARSING_ERROR="assetListParsingError",t.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",t.INTERNAL_EXCEPTION="internalException",t.INTERNAL_ABORTED="aborted",t.ATTACH_MEDIA_ERROR="attachMediaError",t.UNKNOWN="unknown",t}({}),ku=function(t){return t.MEDIA_ATTACHING="hlsMediaAttaching",t.MEDIA_ATTACHED="hlsMediaAttached",t.MEDIA_DETACHING="hlsMediaDetaching",t.MEDIA_DETACHED="hlsMediaDetached",t.MEDIA_ENDED="hlsMediaEnded",t.STALL_RESOLVED="hlsStallResolved",t.BUFFER_RESET="hlsBufferReset",t.BUFFER_CODECS="hlsBufferCodecs",t.BUFFER_CREATED="hlsBufferCreated",t.BUFFER_APPENDING="hlsBufferAppending",t.BUFFER_APPENDED="hlsBufferAppended",t.BUFFER_EOS="hlsBufferEos",t.BUFFERED_TO_END="hlsBufferedToEnd",t.BUFFER_FLUSHING="hlsBufferFlushing",t.BUFFER_FLUSHED="hlsBufferFlushed",t.MANIFEST_LOADING="hlsManifestLoading",t.MANIFEST_LOADED="hlsManifestLoaded",t.MANIFEST_PARSED="hlsManifestParsed",t.LEVEL_SWITCHING="hlsLevelSwitching",t.LEVEL_SWITCHED="hlsLevelSwitched",t.LEVEL_LOADING="hlsLevelLoading",t.LEVEL_LOADED="hlsLevelLoaded",t.LEVEL_UPDATED="hlsLevelUpdated",t.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",t.LEVELS_UPDATED="hlsLevelsUpdated",t.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",t.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",t.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",t.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",t.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",t.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",t.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",t.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",t.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",t.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",t.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",t.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",t.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",t.CUES_PARSED="hlsCuesParsed",t.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",t.INIT_PTS_FOUND="hlsInitPtsFound",t.FRAG_LOADING="hlsFragLoading",t.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",t.FRAG_LOADED="hlsFragLoaded",t.FRAG_DECRYPTED="hlsFragDecrypted",t.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",t.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",t.FRAG_PARSING_METADATA="hlsFragParsingMetadata",t.FRAG_PARSED="hlsFragParsed",t.FRAG_BUFFERED="hlsFragBuffered",t.FRAG_CHANGED="hlsFragChanged",t.FPS_DROP="hlsFpsDrop",t.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",t.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",t.ERROR="hlsError",t.DESTROYING="hlsDestroying",t.KEY_LOADING="hlsKeyLoading",t.KEY_LOADED="hlsKeyLoaded",t.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",t.BACK_BUFFER_REACHED="hlsBackBufferReached",t.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",t.ASSET_LIST_LOADING="hlsAssetListLoading",t.ASSET_LIST_LOADED="hlsAssetListLoaded",t.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",t.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",t.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",t.INTERSTITIAL_STARTED="hlsInterstitialStarted",t.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",t.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",t.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",t.INTERSTITIAL_ENDED="hlsInterstitialEnded",t.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",t.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",t.EVENT_CUE_ENTER="hlsEventCueEnter",t}({});var Lu="manifest",Du="level",Pu="audioTrack",Iu="subtitleTrack",Ou="main",Nu="audio",Fu="subtitle";class Uu{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=e,this.totalWeight_=n}sample(t,e){const n=Math.pow(this.alpha_,t);this.estimate_=e*(1-n)+n*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}}class Bu{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Uu(t),this.fast_=new Uu(e),this.defaultTTFB_=i,this.ttfb_=new Uu(t)}update(t,e){const{slow_:n,fast_:i,ttfb_:r}=this;n.halfLife!==t&&(this.slow_=new Uu(t,n.getEstimate(),n.getTotalWeight())),i.halfLife!==e&&(this.fast_=new Uu(e,i.getEstimate(),i.getTotalWeight())),r.halfLife!==t&&(this.ttfb_=new Uu(t,r.getEstimate(),r.getTotalWeight()))}sample(t,e){const n=(t=Math.max(t,this.minDelayMs_))/1e3,i=8*e/n;this.fast_.sample(n,i),this.slow_.sample(n,i)}sampleTTFB(t){const e=t/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(e,2)/2);this.ttfb_.sample(n,Math.max(t,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function zu(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hu(){return Hu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Hu.apply(null,arguments)}function Vu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function Gu(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Vu(Object(n),!0).forEach(function(e){zu(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vu(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}class ju{constructor(t,e){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const n="[".concat(t,"]:");this.trace=Wu,this.debug=e.debug.bind(null,n),this.log=e.log.bind(null,n),this.warn=e.warn.bind(null,n),this.info=e.info.bind(null,n),this.error=e.error.bind(null,n)}}const Wu=function(){},Yu={trace:Wu,debug:Wu,log:Wu,warn:Wu,info:Wu,error:Wu};function Xu(){return Hu({},Yu)}function Ku(t,e,n){return e[t]?e[t].bind(e):function(t,e){const n=self.console[t];return n?n.bind(self.console,"".concat(e?"["+e+"] ":"","[").concat(t,"] >")):Wu}(t,n)}const qu=Xu();const Qu=qu;function Zu(){if("undefined"===typeof self)return;return(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function Ju(t,e){const n=Object.keys(t),i=Object.keys(e),r=n.length,s=i.length;return!r||!s||r===s&&!n.some(t=>-1===i.indexOf(t))}function $u(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("undefined"!==typeof TextDecoder){const n=new TextDecoder("utf-8").decode(t);if(e){const t=n.indexOf("\0");return-1!==t?n.substring(0,t):n}return n.replace(/\0/g,"")}const n=t.length;let i,r,s,a="",o=0;for(;o<n;){if(i=t[o++],0===i&&e)return a;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(i);break;case 12:case 13:r=t[o++],a+=String.fromCharCode((31&i)<<6|63&r);break;case 14:r=t[o++],s=t[o++],a+=String.fromCharCode((15&i)<<12|(63&r)<<6|63&s)}}return a}function th(t){let e="";for(let n=0;n<t.length;n++){let i=t[n].toString(16);i.length<2&&(i="0"+i),e+=i}return e}function eh(t){return Uint8Array.from(t.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function nh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ih,rh={exports:{}};var sh=function(){return ih||(ih=1,t=rh,function(){var e=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,r=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(t,e,i){if(i=i||{},t=t.trim(),!(e=e.trim())){if(!i.alwaysNormalize)return t;var r=s.parseURL(t);if(!r)throw new Error("Error trying to parse base URL.");return r.path=s.normalizePath(r.path),s.buildURLFromParts(r)}var a=s.parseURL(e);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):e;var o=s.parseURL(t);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=n.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var c={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(c.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var u=o.path,h=u.substring(0,u.lastIndexOf("/")+1)+a.path;c.path=s.normalizePath(h)}else c.path=o.path,a.params||(c.params=o.params,a.query||(c.query=o.query));return null===c.path&&(c.path=i.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(c)},parseURL:function(t){var n=e.exec(t);return n?{scheme:n[1]||"",netLoc:n[2]||"",path:n[3]||"",params:n[4]||"",query:n[5]||"",fragment:n[6]||""}:null},normalizePath:function(t){for(t=t.split("").reverse().join("").replace(i,"");t.length!==(t=t.replace(r,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}};t.exports=s}()),rh.exports;var t}();class ah{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var oh="audio",lh="video",ch="audiovideo";class uh{constructor(t){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,"string"===typeof t&&(t={url:t}),this.base=t,function(t,e){const n=ph(t,e);n&&(n.enumerable=!0,Object.defineProperty(t,e,n))}(this,"stats")}setByteRange(t,e){const n=t.split("@",2);let i;i=1===n.length?(null==e?void 0:e.byteRangeEndOffset)||0:parseInt(n[1]),this._byteRange=[i,parseInt(n[0])+i]}get baseurl(){return this.base.url}get byteRange(){return null===this._byteRange?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return null===this._streams&&(this._streams={[oh]:null,[lh]:null,[ch]:null}),this._streams}set elementaryStreams(t){this._streams=t}get hasStats(){return null!==this._stats}get hasStreams(){return null!==this._streams}get stats(){return null===this._stats&&(this._stats=new ah),this._stats}set stats(t){this._stats=t}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=sh.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}clearElementaryStreamInfo(){const{elementaryStreams:t}=this;t[oh]=null,t[lh]=null,t[ch]=null}}function hh(t){return"initSegment"!==t.sn}class dh extends uh{constructor(t,e){super(e),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=t}get byteLength(){if(this.hasStats){const t=this.stats.total;if(t)return t}if(this.byteRange.length){const t=this.byteRange[0],e=this.byteRange[1];if(Tu(t)&&Tu(e))return e-t}return null}get bitrate(){return this.byteLength?8*this.byteLength/this.duration:this._bitrate?this._bitrate:null}set bitrate(t){this._bitrate=t}get decryptdata(){var t;const{levelkeys:e}=this;if(!e||e.NONE)return null;if(e.identity)this._decryptdata||(this._decryptdata=e.identity.getDecryptData(this.sn));else if(null==(t=this._decryptdata)||!t.keyId){const t=Object.keys(e);if(1===t.length){const n=this._decryptdata=e[t[0]]||null;n&&(this._decryptdata=n.getDecryptData(this.sn,e))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;const t=Tu(this.duration)?this.duration:0;return this.programDateTime+1e3*t}get encrypted(){var t;if(null!=(t=this._decryptdata)&&t.encrypted)return!0;if(this.levelkeys){var e;const t=Object.keys(this.levelkeys),n=t.length;if(n>1||1===n&&null!=(e=this.levelkeys[t[0]])&&e.encrypted)return!0}return!1}get programDateTime(){return null===this._programDateTime&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(t){Tu(t)?this._programDateTime=t:this._programDateTime=this.rawProgramDateTime=null}get ref(){return hh(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(t){this.setStart(this.start+t)}setStart(t){this.start=t,this._ref&&(this._ref.start=t)}setDuration(t){this.duration=t,this._ref&&(this._ref.duration=t)}setKeyFormat(t){const e=this.levelkeys;if(e){var n;const i=e[t];!i||null!=(n=this._decryptdata)&&n.keyId||(this._decryptdata=i.getDecryptData(this.sn,e))}}abortRequests(){var t,e;null==(t=this.loader)||t.abort(),null==(e=this.keyLoader)||e.abort()}setElementaryStreamInfo(t,e,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const{elementaryStreams:a}=this,o=a[t];o?(o.startPTS=Math.min(o.startPTS,e),o.endPTS=Math.max(o.endPTS,n),o.startDTS=Math.min(o.startDTS,i),o.endDTS=Math.max(o.endDTS,r)):a[t]={startPTS:e,endPTS:n,startDTS:i,endDTS:r,partial:s}}}class fh extends uh{constructor(t,e,n,i,r){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=e,this.index=i;const s=t.enumeratedString("BYTERANGE");s&&this.setByteRange(s,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:t}=this;return!!(t.audio||t.video||t.audiovideo)}}function ph(t,e){const n=Object.getPrototypeOf(t);if(n){const t=Object.getOwnPropertyDescriptor(n,e);return t||ph(n,e)}}const mh=Math.pow(2,32)-1,gh=[].push,vh={video:1,audio:2,id3:3,text:4};function yh(t){return String.fromCharCode.apply(null,t)}function _h(t,e){const n=t[e]<<8|t[e+1];return n<0?65536+n:n}function bh(t,e){const n=Eh(t,e);return n<0?4294967296+n:n}function xh(t,e){let n=bh(t,e);return n*=Math.pow(2,32),n+=bh(t,e+4),n}function Eh(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function wh(t,e){const n=[];if(!e.length)return n;const i=t.byteLength;for(let r=0;r<i;){const s=bh(t,r),a=s>1?r+s:i;if(yh(t.subarray(r+4,r+8))===e[0])if(1===e.length)n.push(t.subarray(r+8,a));else{const i=wh(t.subarray(r+8,a),e.slice(1));i.length&&gh.apply(n,i)}r=a}return n}function Sh(t){const e=[],n=t[0];let i=8;const r=bh(t,i);i+=4;let s=0,a=0;0===n?(s=bh(t,i),a=bh(t,i+4),i+=8):(s=xh(t,i),a=xh(t,i+8),i+=16),i+=2;let o=t.length+a;const l=_h(t,i);i+=2;for(let c=0;c<l;c++){let n=i;const s=bh(t,n);n+=4;const a=2147483647&s;if(1===(2147483648&s)>>>31)return Qu.warn("SIDX has hierarchical references (not supported)"),null;const l=bh(t,n);n+=4,e.push({referenceSize:a,subsegmentDuration:l,info:{duration:l/r,start:o,end:o+a-1}}),o+=a,n+=4,i=n}return{earliestPresentationTime:s,timescale:r,version:n,referencesCount:l,references:e}}function Th(t){const e=[],n=wh(t,["moov","trak"]);for(let i=0;i<n.length;i++){const t=n[i],r=wh(t,["tkhd"])[0];if(r){let n=r[0];const i=bh(r,0===n?12:20),s=wh(t,["mdia","mdhd"])[0];if(s){n=s[0];const r=bh(s,0===n?12:20),a=wh(t,["mdia","hdlr"])[0];if(a){const n=yh(a.subarray(8,12)),s={soun:oh,vide:lh}[n],o=Mh(wh(t,["mdia","minf","stbl","stsd"])[0]);s?(e[i]={timescale:r,type:s,stsd:o},e[s]=Gu({timescale:r,id:i},o)):e[i]={timescale:r,type:n,stsd:o}}}}}return wh(t,["moov","mvex","trex"]).forEach(t=>{const n=bh(t,4),i=e[n];i&&(i.default={duration:bh(t,12),flags:bh(t,20)})}),e}function Mh(t){const e=t.subarray(8),n=e.subarray(86),i=yh(e.subarray(4,8));let r,s=i;const a="enca"===i||"encv"===i;if(a){const t=wh(e,[i])[0];wh(t.subarray("enca"===i?28:78),["sinf"]).forEach(t=>{const e=wh(t,["schm"])[0];if(e){const n=yh(e.subarray(4,8));if("cbcs"===n||"cenc"===n){const e=wh(t,["frma"])[0];e&&(s=yh(e))}}})}const o=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const t=wh(n,["avcC"])[0];t&&t.length>3&&(s+="."+Rh(t[1])+Rh(t[2])+Rh(t[3]),r=Ah("avc1"===o?"dva1":"dvav",n));break}case"mp4a":{const t=wh(e,[i])[0],n=wh(t.subarray(28),["esds"])[0];if(n&&n.length>7){let t=4;if(3!==n[t++])break;t=Ch(n,t),t+=2;const e=n[t++];if(128&e&&(t+=2),64&e&&(t+=n[t++]),4!==n[t++])break;t=Ch(n,t);const i=n[t++];if(64!==i)break;if(s+="."+Rh(i),t+=12,5!==n[t++])break;t=Ch(n,t);const r=n[t++];let a=(248&r)>>3;31===a&&(a+=1+((7&r)<<3)+((224&n[t])>>5)),s+="."+a}break}case"hvc1":case"hev1":{const t=wh(n,["hvcC"])[0];if(t&&t.length>12){const e=t[1],n=["","A","B","C"][e>>6],i=31&e,r=bh(t,2),a=(32&e)>>5?"H":"L",o=t[12],l=t.subarray(6,12);s+="."+n+i,s+="."+function(t){let e=0;for(let n=0;n<32;n++)e|=(t>>n&1)<<31-n;return e>>>0}(r).toString(16).toUpperCase(),s+="."+a+o;let c="";for(let t=l.length;t--;){const e=l[t];if(e||c){c="."+e.toString(16).toUpperCase()+c}}s+=c}r=Ah("hev1"==o?"dvhe":"dvh1",n);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":s=Ah(s,n)||s;break;case"vp09":{const t=wh(n,["vpcC"])[0];if(t&&t.length>6){const e=t[4],n=t[5],i=t[6]>>4&15;s+="."+kh(e)+"."+kh(n)+"."+kh(i)}break}case"av01":{const t=wh(n,["av1C"])[0];if(t&&t.length>2){const e=t[1]>>>5,i=31&t[1],a=t[2]>>>7?"H":"M",o=(64&t[2])>>6,l=(32&t[2])>>5,c=2===e&&o?l?12:10:o?10:8,u=(16&t[2])>>4,h=(8&t[2])>>3,d=(4&t[2])>>2,f=3&t[2],p=1,m=1,g=1,v=0;s+="."+e+"."+kh(i)+a+"."+kh(c)+"."+u+"."+h+d+f+"."+kh(p)+"."+kh(m)+"."+kh(g)+"."+v,r=Ah("dav1",n)}break}}return{codec:s,encrypted:a,supplemental:r}}function Ah(t,e){const n=wh(e,["dvvC"]),i=n.length?n[0]:wh(e,["dvcC"])[0];if(i){const e=i[2]>>1&127,n=i[2]<<5&32|i[3]>>3&31;return t+"."+kh(e)+"."+kh(n)}}function Ch(t,e){const n=e+5;for(;128&t[e++]&&e<n;);return e}function Rh(t){return("0"+t.toString(16).toUpperCase()).slice(-2)}function kh(t){return(t<10?"0":"")+t}function Lh(t,e){wh(t,["moov","trak"]).forEach(t=>{const n=wh(t,["mdia","minf","stbl","stsd"])[0];if(!n)return;const i=n.subarray(8);let r=wh(i,["enca"]);const s=r.length>0;s||(r=wh(i,["encv"])),r.forEach(t=>{wh(s?t.subarray(28):t.subarray(78),["sinf"]).forEach(t=>{const n=Dh(t);n&&e(n,s)})})})}function Dh(t){const e=wh(t,["schm"])[0];if(e){const n=yh(e.subarray(4,8));if("cbcs"===n||"cenc"===n){const e=wh(t,["schi","tenc"])[0];if(e)return e}}}function Ph(t,e){const n=new Uint8Array(t.length+e.length);return n.set(t),n.set(e,t.length),n}function Ih(t,e){const n=[],i=e.samples,r=e.timescale,s=e.id;let a=!1;return wh(i,["moof"]).map(o=>{const l=o.byteOffset-8;wh(o,["traf"]).map(o=>{const c=wh(o,["tfdt"]).map(t=>{const e=t[0];let n=bh(t,4);return 1===e&&(n*=Math.pow(2,32),n+=bh(t,8)),n/r})[0];return void 0!==c&&(t=c),wh(o,["tfhd"]).map(c=>{const u=bh(c,4),h=16777215&bh(c,0);let d=0;const f=0!==(16&h);let p=0;const m=0!==(32&h);let g=8;u===s&&(0!==(1&h)&&(g+=8),0!==(2&h)&&(g+=4),0!==(8&h)&&(d=bh(c,g),g+=4),f&&(p=bh(c,g),g+=4),m&&(g+=4),"video"===e.type&&(a=Oh(e.codec)),wh(o,["trun"]).map(s=>{const o=s[0],c=16777215&bh(s,0),u=0!==(1&c);let h=0;const f=0!==(4&c),m=0!==(256&c);let g=0;const v=0!==(512&c);let y=0;const _=0!==(1024&c),b=0!==(2048&c);let x=0;const E=bh(s,4);let w=8;u&&(h=bh(s,w),w+=4),f&&(w+=4);let S=h+l;for(let l=0;l<E;l++){if(m?(g=bh(s,w),w+=4):g=d,v?(y=bh(s,w),w+=4):y=p,_&&(w+=4),b&&(x=0===o?bh(s,w):Eh(s,w),w+=4),e.type===lh){let e=0;for(;e<y;){const s=bh(i,S);if(S+=4,Nh(a,i[S])){Fh(i.subarray(S,S+s),a?2:1,t+x/r,n)}S+=s,e+=s+4}}t+=g/r}}))})})}),n}function Oh(t){if(!t)return!1;const e=t.substring(0,4);return"hvc1"===e||"hev1"===e||"dvh1"===e||"dvhe"===e}function Nh(t,e){if(t){const t=e>>1&63;return 39===t||40===t}return 6===(31&e)}function Fh(t,e,n,i){const r=Uh(t);let s=0;s+=e;let a=0,o=0,l=0;for(;s<r.length;){a=0;do{if(s>=r.length)break;l=r[s++],a+=l}while(255===l);o=0;do{if(s>=r.length)break;l=r[s++],o+=l}while(255===l);const t=r.length-s;let e=s;if(o<t)s+=o;else if(o>t){Qu.error("Malformed SEI payload. ".concat(o," is too small, only ").concat(t," bytes left to parse."));break}if(4===a){if(181===r[e++]){const t=_h(r,e);if(e+=2,49===t){const t=bh(r,e);if(e+=4,1195456820===t){const t=r[e++];if(3===t){const s=r[e++],o=64&s,l=o?2+3*(31&s):0,c=new Uint8Array(l);if(o){c[0]=s;for(let t=1;t<l;t++)c[t]=r[e++]}i.push({type:t,payloadType:a,pts:n,bytes:c})}}}}}else if(5===a&&o>16){const t=[];for(let n=0;n<16;n++){const i=r[e++].toString(16);t.push(1==i.length?"0"+i:i),3!==n&&5!==n&&7!==n&&9!==n||t.push("-")}const s=o-16,l=new Uint8Array(s);for(let n=0;n<s;n++)l[n]=r[e++];i.push({payloadType:a,pts:n,uuid:t.join(""),userData:$u(l),userDataBytes:l})}}}function Uh(t){const e=t.byteLength,n=[];let i=1;for(;i<e-2;)0===t[i]&&0===t[i+1]&&3===t[i+2]?(n.push(i+2),i+=2):i++;if(0===n.length)return t;const r=e-n.length,s=new Uint8Array(r);let a=0;for(i=0;i<r;a++,i++)a===n[0]&&(a++,n.shift()),s[i]=t[a];return s}function Bh(t,e,n){if(16!==t.byteLength)throw new RangeError("Invalid system id");let i,r,s;i=0,r=new Uint8Array,s=new Uint8Array;const a=new Uint8Array(4);return n.byteLength>0&&new DataView(a.buffer).setUint32(0,n.byteLength,!1),function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];const r=n.length;let s=8,a=r;for(;a--;)s+=n[a].byteLength;const o=new Uint8Array(s);for(o[0]=s>>24&255,o[1]=s>>16&255,o[2]=s>>8&255,o[3]=255&s,o.set(t,4),a=0,s=8;a<r;a++)o.set(n[a],s),s+=n[a].byteLength;return o}([112,115,115,104],new Uint8Array([0,0,0,0]),t,s,r,a,n)}function zh(t){const e=t.getUint32(0),n=t.byteOffset,i=t.byteLength;if(i<e)return{offset:n,size:i};if(1886614376!==t.getUint32(4))return{offset:n,size:e};const r=t.getUint32(8)>>>24;if(0!==r&&1!==r)return{offset:n,size:e};const s=t.buffer,a=th(new Uint8Array(s,n+12,16));let o=null,l=null,c=0;if(0===r)c=28;else{const r=t.getUint32(28);if(!r||i<32+16*r)return{offset:n,size:e};o=[];for(let t=0;t<r;t++)o.push(new Uint8Array(s,n+32+16*t,16));c=32+16*r}if(!c)return{offset:n,size:e};const u=t.getUint32(c);return e-32<u?{offset:n,size:e}:(l=new Uint8Array(s,n+c+4,u),{version:r,systemId:a,kids:o,data:l,offset:n,size:e})}const Hh=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Vh={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Gh(t,e){const n=Vh[e];return!!n&&!!n[t.slice(0,4)]}function jh(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!t.split(",").some(t=>!Wh(t,e,n))}function Wh(t,e){var n;const i=Zu(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]);return null!=(n=null==i?void 0:i.isTypeSupported(Yh(t,e)))&&n}function Yh(t,e){return"".concat(e,"/mp4;codecs=").concat(t)}function Xh(t){if(t){const e=t.substring(0,4);return Vh.video[e]}return 2}function Kh(t){const e=Hh();return t.split(",").reduce((t,n)=>{const i=e&&Oh(n)?9:Vh.video[n];return i?(2*i+t)/(t?3:2):(Vh.audio[n]+t)/(t?2:1)},0)}const qh={};const Qh=/flac|opus|mp4a\.40\.34/i;function Zh(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t.replace(Qh,t=>function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(qh[t])return qh[t];const n={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[t];for(let r=0;r<n.length;r++){var i;if(Wh(n[r],"audio",e))return qh[t]=n[r],n[r];if("mp3"===n[r]&&null!=(i=Zu(e))&&i.isTypeSupported("audio/mpeg"))return""}return t}(t.toLowerCase(),e))}function Jh(t,e){if(t&&(t.length>4||-1!==["ac-3","ec-3","alac","fLaC","Opus"].indexOf(t))&&($h(t,"audio")||$h(t,"video")))return t;if(e){const n=e.split(",");if(n.length>1){if(t)for(let e=n.length;e--;)if(n[e].substring(0,4)===t.substring(0,4))return n[e];return n[0]}}return e||t}function $h(t,e){return Gh(t,e)&&Wh(t,e)}function td(t){if(t.startsWith("av01.")){const e=t.split("."),n=["0","111","01","01","01","0"];for(let t=e.length;t>4&&t<10;t++)e[t]=n[t-4];return e.join(".")}return t}function ed(t){const e=Zu(t)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function nd(t){return t.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const id={supported:!1,smooth:!1,powerEfficient:!1},rd={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function sd(t,e){return{supported:!1,configurations:e,decodingInfoResults:[id],error:t}}function ad(t,e,n,i,r,s){const a=t.videoCodec,o=t.audioCodec?t.audioGroups:null,l=null==s?void 0:s.audioCodec,c=null==s?void 0:s.channels,u=c?parseInt(c):l?1/0:2;let h=null;if(null!=o&&o.length)try{h=1===o.length&&o[0]?e.groups[o[0]].channels:o.reduce((t,n)=>{if(n){const i=e.groups[n];if(!i)throw new Error("Audio track group ".concat(n," not found"));Object.keys(i.channels).forEach(e=>{t[e]=(t[e]||0)+i.channels[e]})}return t},{2:0})}catch(CO){return!0}return void 0!==a&&(a.split(",").some(t=>Oh(t))||t.width>1920&&t.height>1088||t.height>1920&&t.width>1088||t.frameRate>Math.max(i,30)||"SDR"!==t.videoRange&&t.videoRange!==n||t.bitrate>Math.max(r,8e6))||!!h&&Tu(u)&&Object.keys(h).some(t=>parseInt(t)>u)}function od(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const r=t.videoCodec;if(!r&&!t.audioCodec||!n)return Promise.resolve(rd);const s=[],a=function(t){var e;const n=null==(e=t.videoCodec)?void 0:e.split(","),i=cd(t),r=t.width||640,s=t.height||480,a=t.frameRate||30,o=t.videoRange.toLowerCase();return n?n.map(t=>{const e={contentType:Yh(td(t),"video"),width:r,height:s,bitrate:i,framerate:a};return"sdr"!==o&&(e.transferFunction=o),e}):[]}(t),o=a.length,l=function(t,e,n){var i;const r=null==(i=t.audioCodec)?void 0:i.split(","),s=cd(t);if(r&&t.audioGroups)return t.audioGroups.reduce((t,i)=>{var a;const o=i?null==(a=e.groups[i])?void 0:a.tracks:null;return o?o.reduce((t,e)=>{if(e.groupId===i){const i=parseFloat(e.channels||"");r.forEach(e=>{const r={contentType:Yh(e,"audio"),bitrate:n?ld(e,s):s};i&&(r.channels=""+i),t.push(r)})}return t},t):t},[]);return[]}(t,e,o>0),c=l.length;for(let u=o||1*c||1;u--;){const t={type:"media-source"};if(o&&(t.video=a[u%o]),c){t.audio=l[u%c];const e=t.audio.bitrate;t.video&&e&&(t.video.bitrate-=e)}s.push(t)}if(r){const t=navigator.userAgent;if(r.split(",").some(t=>Oh(t))&&Hh())return Promise.resolve(sd(new Error("Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (".concat(t,")")),s))}return Promise.all(s.map(t=>{const e=function(t){let e="";const{audio:n,video:i}=t;if(i){const t=nd(i.contentType);e+="".concat(t,"_r").concat(i.height,"x").concat(i.width,"f").concat(Math.ceil(i.framerate)).concat(i.transferFunction||"sd","_").concat(Math.ceil(i.bitrate/1e5))}if(n){const t=nd(n.contentType);e+="".concat(i?"_":"").concat(t,"_c").concat(n.channels)}return e}(t);return i[e]||(i[e]=n.decodingInfo(t))})).then(t=>({supported:!t.some(t=>!t.supported),configurations:s,decodingInfoResults:t})).catch(t=>({supported:!1,configurations:s,decodingInfoResults:[],error:t}))}function ld(t,e){if(e<=1)return 1;let n=128e3;return"ec-3"===t?n=768e3:"ac-3"===t&&(n=64e4),Math.min(e/2,n)}function cd(t){return 1e3*Math.ceil(Math.max(.9*t.bitrate,t.averageBitrate)/1e3)||1}const ud=["NONE","TYPE-0","TYPE-1",null];const hd=["SDR","PQ","HLG"];var dd="",fd="YES",pd="v2";function md(t){const{canSkipUntil:e,canSkipDateRanges:n,age:i}=t;return e&&i<e/2?n?pd:fd:dd}class gd{constructor(t,e,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=e,this.skip=n}addDirectives(t){const e=new self.URL(t);return void 0!==this.msn&&e.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&e.searchParams.set("_HLS_part",this.part.toString()),this.skip&&e.searchParams.set("_HLS_skip",this.skip),e.href}}class vd{constructor(t){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=t.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.codecSet=[t.videoCodec,t.audioCodec].filter(t=>!!t).map(t=>t.substring(0,4)).join(","),"supplemental"in t){var e;this.supplemental=t.supplemental;const n=null==(e=t.supplemental)?void 0:e.videoCodec;n&&n!==t.videoCodec&&(this.codecSet+=",".concat(n.substring(0,4)))}this.addGroupId("audio",t.attrs.AUDIO),this.addGroupId("text",t.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(t){return yd(this._audioGroups,t)}hasSubtitleGroup(t){return yd(this._subtitleGroups,t)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(t,e){if(e)if("audio"===t){let t=this._audioGroups;t||(t=this._audioGroups=[]),-1===t.indexOf(e)&&t.push(e)}else if("text"===t){let t=this._subtitleGroups;t||(t=this._subtitleGroups=[]),-1===t.indexOf(e)&&t.push(e)}}get urlId(){return 0}set urlId(t){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var t;return null==(t=this.audioGroups)?void 0:t[0]}get textGroupId(){var t;return null==(t=this.subtitleGroups)?void 0:t[0]}addFallback(){}}function yd(t,e){return!(!e||!t)&&-1!==t.indexOf(e)}function _d(t,e){let n=!1,i=[];if(t&&(n="SDR"!==t,i=[t]),e){i=e.allowedVideoRanges||hd.slice(0);const t="SDR"!==i.join("")&&!e.videoCodec;n=void 0!==e.preferHDR?e.preferHDR:t&&function(){if("function"===typeof matchMedia){const t=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(t.media!==e.media)return!0===t.matches}return!1}(),n||(i=["SDR"])}return{preferHDR:n,allowedVideoRanges:i}}const bd=(t,e)=>JSON.stringify(t,(t=>{const e=new WeakSet;return(n,i)=>{if(t&&(i=t(n,i)),"object"===typeof i&&null!==i){if(e.has(i))return;e.add(i)}return i}})(e));function xd(t,e){Qu.log('[abr] start candidates with "'.concat(t,'" ignored because ').concat(e))}function Ed(t){return t.reduce((t,e)=>{let n=t.groups[e.groupId];n||(n=t.groups[e.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(e);const i=e.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||e.default,n.hasAutoSelect=n.hasAutoSelect||e.autoselect,n.hasDefault&&(t.hasDefaultAudio=!0),n.hasAutoSelect&&(t.hasAutoSelectAudio=!0),t},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function wd(t){if(!t)return t;const{lang:e,assocLang:n,characteristics:i,channels:r,audioCodec:s}=t;return{lang:e,assocLang:n,characteristics:i,channels:r,audioCodec:s}}function Sd(t,e,n){if("attrs"in t){const n=e.indexOf(t);if(-1!==n)return n}for(let i=0;i<e.length;i++){if(Td(t,e[i],n))return i}return-1}function Td(t,e,n){const{groupId:i,name:r,lang:s,assocLang:a,default:o}=t,l=t.forced;return(void 0===i||e.groupId===i)&&(void 0===r||e.name===r)&&(void 0===s||function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"--";if(t.length===e.length)return t===e;return t.startsWith(e)||e.startsWith(t)}(s,e.lang))&&(void 0===s||e.assocLang===a)&&(void 0===o||e.default===o)&&(void 0===l||e.forced===l)&&(!("characteristics"in t)||function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=t.split(","),i=e.split(",");return n.length===i.length&&!n.some(t=>-1===i.indexOf(t))}(t.characteristics||"",e.characteristics))&&(void 0===n||n(t,e))}function Md(t,e){const{audioCodec:n,channels:i}=t;return(void 0===n||(e.audioCodec||"").substring(0,4)===n.substring(0,4))&&(void 0===i||i===(e.channels||"2"))}function Ad(t,e,n){for(let i=e;i>-1;i--)if(n(t[i]))return i;for(let i=e+1;i<t.length;i++)if(n(t[i]))return i;return-1}function Cd(t,e){var n;return!!t&&t!==(null==(n=e.loadLevelObj)?void 0:n.uri)}const Rd=function(t,e){let n=0,i=t.length-1,r=null,s=null;for(;n<=i;){r=(n+i)/2|0,s=t[r];const a=e(s);if(a>0)n=r+1;else{if(!(a<0))return s;i=r-1}}return null};function kd(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.005,s=null;if(t){s=e[1+t.sn-e[0].sn]||null;const i=t.endDTS-n;i>0&&i<15e-7&&(n+=15e-7),s&&t.level!==s.level&&s.end<=t.end&&(s=e[2+t.sn-e[0].sn]||null)}else 0===n&&0===e[0].start&&(s=e[0]);if(s&&((!t||t.level===s.level)&&0===Ld(n,i,s)||function(t,e,n){if(e&&0===e.start&&e.level<t.level&&(e.endPTS||0)>0){const i=e.tagList.reduce((t,e)=>("INF"===e[0]&&(t+=parseFloat(e[1])),t),n);return t.start<=i}return!1}(s,t,Math.min(r,i))))return s;const a=Rd(e,Ld.bind(null,n,i));return!a||a===t&&s?s:a}function Ld(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(n.start<=t&&n.start+n.duration>t)return 0;const i=Math.min(e,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-i<=t?1:n.start-i>t&&n.start?-1:0}function Dd(t,e,n){const i=1e3*Math.min(e,n.duration+(n.deltaPTS?n.deltaPTS:0));return(n.endProgramDateTime||0)-i>t}function Pd(t,e,n){if(t&&t.startCC<=e&&t.endCC>=e){let i=t.fragments;const{fragmentHint:r}=t;let s;return r&&(i=i.concat(r)),Rd(i,t=>t.cc<e?1:t.cc>e?-1:(s=t,t.end<=n?1:t.start>n?-1:0)),s||null}return null}function Id(t){switch(t.details){case Ru.FRAG_LOAD_TIMEOUT:case Ru.KEY_LOAD_TIMEOUT:case Ru.LEVEL_LOAD_TIMEOUT:case Ru.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Od(t){return t.details.startsWith("key")}function Nd(t){return Od(t)&&!!t.frag&&!t.frag.decryptdata}function Fd(t,e){const n=Id(e);return t.default["".concat(n?"timeout":"error","Retry")]}function Ud(t,e){const n="linear"===t.backoff?1:Math.pow(2,e);return Math.min(n*t.retryDelayMs,t.maxRetryDelayMs)}function Bd(t){return Gu(Gu({},t),{errorRetry:null,timeoutRetry:null})}function zd(t,e,n,i){if(!t)return!1;const r=null==i?void 0:i.code,s=e<t.maxNumRetry&&(function(t){return Hd(t)||!!t&&(t<400||t>499)}(r)||!!n);return t.shouldRetry?t.shouldRetry(t,e,n,i,s):s}function Hd(t){return 0===t&&!1===navigator.onLine}var Vd=0,Gd=2,jd=3,Wd=5,Yd=0,Xd=1,Kd=2,qd=4;function Qd(t){const e={action:Vd,flags:Yd};return t&&(e.resolved=!0),e}var Zd="NOT_LOADED",Jd="APPENDING",$d="PARTIAL",tf="OK";class ef{constructor(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}_registerListeners(){const{hls:t}=this;t&&(t.on(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.on(ku.BUFFER_APPENDED,this.onBufferAppended,this),t.on(ku.FRAG_BUFFERED,this.onFragBuffered,this),t.on(ku.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:t}=this;t&&(t.off(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.off(ku.BUFFER_APPENDED,this.onBufferAppended,this),t.off(ku.FRAG_BUFFERED,this.onFragBuffered,this),t.off(ku.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(t,e){const n=this.activePartLists[e];if(n)for(let i=n.length;i--;){const e=n[i];if(!e)break;if(e.start<=t&&t<=e.end&&e.loaded)return e}return this.getBufferedFrag(t,e)}getBufferedFrag(t,e){return this.getFragAtPos(t,e,!0)}getFragAtPos(t,e,n){const{fragments:i}=this,r=Object.keys(i);for(let s=r.length;s--;){const a=i[r[s]];if((null==a?void 0:a.body.type)===e&&(!n||a.buffered)){const e=a.body;if(e.start<=t&&t<=e.end)return e}}return null}detectEvictedFragments(t,e,n,i,r){this.timeRanges&&(this.timeRanges[t]=e);const s=(null==i?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach(i=>{const a=this.fragments[i];if(!a)return;if(s>=a.body.sn)return;if(!a.buffered&&(!a.loaded||r))return void(a.body.type===n&&this.removeFragment(a.body));const o=a.range[t];o&&(0!==o.time.length?o.time.some(t=>{const n=!this.isTimeBuffered(t.startPTS,t.endPTS,e);return n&&this.removeFragment(a.body),n}):this.removeFragment(a.body))})}detectPartialFragments(t){const e=this.timeRanges;if(!e||"initSegment"===t.frag.sn)return;const n=t.frag,i=rf(n),r=this.fragments[i];if(!r||r.buffered&&n.gap)return;const s=!n.relurl;Object.keys(e).forEach(i=>{const a=n.elementaryStreams[i];if(!a)return;const o=e[i],l=s||!0===a.partial;r.range[i]=this.getBufferedTimes(n,t.part,l,o)}),r.loaded=null,Object.keys(r.range).length?(this.bufferedEnd(r,n),nf(r)||this.removeParts(n.sn-1,n.type)):this.removeFragment(r.body)}bufferedEnd(t,e){t.buffered=!0;(t.body.endList=e.endList||t.body.endList)&&(this.endListFragments[t.body.type]=t)}removeParts(t,e){const n=this.activePartLists[e];n&&(this.activePartLists[e]=sf(n,e=>e.fragment.sn>=t))}fragBuffered(t,e){const n=rf(t);let i=this.fragments[n];!i&&e&&(i=this.fragments[n]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,this.bufferedEnd(i,t))}getBufferedTimes(t,e,n,i){const r={time:[],partial:n},s=t.start,a=t.end,o=t.minEndPTS||a,l=t.maxStartPTS||s;for(let c=0;c<i.length;c++){const t=i.start(c)-this.bufferPadding,e=i.end(c)+this.bufferPadding;if(l>=t&&o<=e){r.time.push({startPTS:Math.max(s,i.start(c)),endPTS:Math.min(a,i.end(c))});break}if(s<e&&a>t){const t=Math.max(s,i.start(c)),e=Math.min(a,i.end(c));e>t&&(r.partial=!0,r.time.push({startPTS:t,endPTS:e}))}else if(a<=t)break}return r}getPartialFragment(t){let e,n,i,r=null,s=0;const{bufferPadding:a,fragments:o}=this;return Object.keys(o).forEach(l=>{const c=o[l];c&&nf(c)&&(n=c.body.start-a,i=c.body.end+a,t>=n&&t<=i&&(e=Math.min(t-n,i-t),s<=e&&(r=c.body,s=e)))}),r}isEndListAppended(t){const e=this.endListFragments[t];return void 0!==e&&(e.buffered||nf(e))}getState(t){const e=rf(t),n=this.fragments[e];return n?n.buffered?nf(n)?$d:tf:Jd:Zd}isTimeBuffered(t,e,n){let i,r;for(let s=0;s<n.length;s++){if(i=n.start(s)-this.bufferPadding,r=n.end(s)+this.bufferPadding,t>=i&&e<=r)return!0;if(e<=i)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(t,e){if("initSegment"===e.frag.sn||e.frag.bitrateTest)return;const n=e.frag,i=e.part?null:e,r=rf(n);this.fragments[r]={body:n,appendedPTS:null,loaded:i,buffered:!1,range:Object.create(null)}}onBufferAppended(t,e){const{frag:n,part:i,timeRanges:r,type:s}=e;if("initSegment"===n.sn)return;const a=n.type;if(i){let t=this.activePartLists[a];t||(this.activePartLists[a]=t=[]),t.push(i)}this.timeRanges=r;const o=r[s];this.detectEvictedFragments(s,o,a,i)}onFragBuffered(t,e){this.detectPartialFragments(e)}hasFragment(t){const e=rf(t);return!!this.fragments[e]}hasFragments(t){const{fragments:e}=this,n=Object.keys(e);if(!t)return n.length>0;for(let i=n.length;i--;){const r=e[n[i]];if((null==r?void 0:r.body.type)===t)return!0}return!1}hasParts(t){var e;return!(null==(e=this.activePartLists[t])||!e.length)}removeFragmentsInRange(t,e,n,i,r){i&&!this.hasGaps||Object.keys(this.fragments).forEach(s=>{const a=this.fragments[s];if(!a)return;const o=a.body;o.type!==n||i&&!o.gap||o.start<e&&o.end>t&&(a.buffered||r)&&this.removeFragment(o)})}removeFragment(t){const e=rf(t);t.clearElementaryStreamInfo();const n=this.activePartLists[t.type];if(n){const e=t.sn;this.activePartLists[t.type]=sf(n,t=>t.fragment.sn!==e)}delete this.fragments[e],t.endList&&delete this.endListFragments[t.type]}removeAllFragments(){var t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const e=null==(t=this.hls)||null==(t=t.latestLevelDetails)?void 0:t.partList;e&&e.forEach(t=>t.clearElementaryStreamInfo())}}function nf(t){var e,n,i;return t.buffered&&!!(t.body.gap||null!=(e=t.range.video)&&e.partial||null!=(n=t.range.audio)&&n.partial||null!=(i=t.range.audiovideo)&&i.partial)}function rf(t){return"".concat(t.type,"_").concat(t.level,"_").concat(t.sn)}function sf(t,e){return t.filter(t=>{const n=e(t);return n||t.clearElementaryStreamInfo(),n})}var af=0,of=1;class lf{constructor(t,e,n){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=t,this.aesIV=e,this.aesMode=n}decrypt(t,e){switch(this.aesMode){case af:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t);case of:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},e,t);default:throw new Error("[AESCrypto] invalid aes mode ".concat(this.aesMode))}}}class cf{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(t){const e=new DataView(t),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=e.getUint32(4*i);return n}initTable(){const t=this.sBox,e=this.invSBox,n=this.subMix,i=n[0],r=n[1],s=n[2],a=n[3],o=this.invSubMix,l=o[0],c=o[1],u=o[2],h=o[3],d=new Uint32Array(256);let f=0,p=0,m=0;for(m=0;m<256;m++)d[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){let n=p^p<<1^p<<2^p<<3^p<<4;n=n>>>8^255&n^99,t[f]=n,e[n]=f;const o=d[f],m=d[o],g=d[m];let v=257*d[n]^16843008*n;i[f]=v<<24|v>>>8,r[f]=v<<16|v>>>16,s[f]=v<<8|v>>>24,a[f]=v,v=16843009*g^65537*m^257*o^16843008*f,l[n]=v<<24|v>>>8,c[n]=v<<16|v>>>16,u[n]=v<<8|v>>>24,h[n]=v,f?(f=o^d[d[d[g^o]]],p^=d[d[p]]):f=p=1}}expandKey(t){const e=this.uint8ArrayToUint32Array_(t);let n=!0,i=0;for(;i<e.length&&n;)n=e[i]===this.key[i],i++;if(n)return;this.key=e;const r=this.keySize=e.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);const s=this.ksRows=4*(r+6+1);let a,o;const l=this.keySchedule=new Uint32Array(s),c=this.invKeySchedule=new Uint32Array(s),u=this.sBox,h=this.rcon,d=this.invSubMix,f=d[0],p=d[1],m=d[2],g=d[3];let v,y;for(a=0;a<s;a++)a<r?v=l[a]=e[a]:(y=v,a%r===0?(y=y<<8|y>>>24,y=u[y>>>24]<<24|u[y>>>16&255]<<16|u[y>>>8&255]<<8|u[255&y],y^=h[a/r|0]<<24):r>6&&a%r===4&&(y=u[y>>>24]<<24|u[y>>>16&255]<<16|u[y>>>8&255]<<8|u[255&y]),l[a]=v=(l[a-r]^y)>>>0);for(o=0;o<s;o++)a=s-o,y=3&o?l[a]:l[a-4],c[o]=o<4||a<=4?y:f[u[y>>>24]]^p[u[y>>>16&255]]^m[u[y>>>8&255]]^g[u[255&y]],c[o]=c[o]>>>0}networkToHostOrderSwap(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24}decrypt(t,e,n){const i=this.keySize+6,r=this.invKeySchedule,s=this.invSBox,a=this.invSubMix,o=a[0],l=a[1],c=a[2],u=a[3],h=this.uint8ArrayToUint32Array_(n);let d=h[0],f=h[1],p=h[2],m=h[3];const g=new Int32Array(t),v=new Int32Array(g.length);let y,_,b,x,E,w,S,T,M,A,C,R,k,L;const D=this.networkToHostOrderSwap;for(;e<g.length;){for(M=D(g[e]),A=D(g[e+1]),C=D(g[e+2]),R=D(g[e+3]),E=M^r[0],w=R^r[1],S=C^r[2],T=A^r[3],k=4,L=1;L<i;L++)y=o[E>>>24]^l[w>>16&255]^c[S>>8&255]^u[255&T]^r[k],_=o[w>>>24]^l[S>>16&255]^c[T>>8&255]^u[255&E]^r[k+1],b=o[S>>>24]^l[T>>16&255]^c[E>>8&255]^u[255&w]^r[k+2],x=o[T>>>24]^l[E>>16&255]^c[w>>8&255]^u[255&S]^r[k+3],E=y,w=_,S=b,T=x,k+=4;y=s[E>>>24]<<24^s[w>>16&255]<<16^s[S>>8&255]<<8^s[255&T]^r[k],_=s[w>>>24]<<24^s[S>>16&255]<<16^s[T>>8&255]<<8^s[255&E]^r[k+1],b=s[S>>>24]<<24^s[T>>16&255]<<16^s[E>>8&255]<<8^s[255&w]^r[k+2],x=s[T>>>24]<<24^s[E>>16&255]<<16^s[w>>8&255]<<8^s[255&S]^r[k+3],v[e]=D(y^d),v[e+1]=D(x^f),v[e+2]=D(b^p),v[e+3]=D(_^m),d=M,f=A,p=C,m=R,e+=4}return v.buffer}}class uf{constructor(t,e,n){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=t,this.key=e,this.aesMode=n}expandKey(){const t=function(t){switch(t){case af:return"AES-CBC";case of:return"AES-CTR";default:throw new Error("[FastAESKey] invalid aes mode ".concat(t))}}(this.aesMode);return this.subtle.importKey("raw",this.key,{name:t},!1,["encrypt","decrypt"])}}class hf{constructor(t){let{removePKCS7Padding:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=t.enableSoftwareAES,this.removePKCS7Padding=e,e)try{const t=self.crypto;t&&(this.subtle=t.subtle||t.webkitSubtle)}catch(Wq){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:t,remainderData:e}=this;if(!t||e)return this.reset(),null;const n=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?function(t){const e=t.byteLength,n=e&&new DataView(t.buffer).getUint8(e-1);return n?t.slice(0,e-n):t}(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(t,e,n,i){return this.useSoftware?new Promise((r,s)=>{const a=ArrayBuffer.isView(t)?t:new Uint8Array(t);this.softwareDecrypt(a,e,n,i);const o=this.flush();o?r(o.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(t),e,n,i)}softwareDecrypt(t,e,n,i){const{currentIV:r,currentResult:s,remainderData:a}=this;if(i!==af||16!==e.byteLength)return Qu.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),a&&(t=Ph(a,t),this.remainderData=null);const o=this.getValidChunk(t);if(!o.length)return null;r&&(n=r);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new cf),l.expandKey(e);const c=s;return this.currentResult=l.decrypt(o.buffer,0,n),this.currentIV=o.slice(-16).buffer,c||null}webCryptoDecrypt(t,e,n,i){if(this.key!==e||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(t,e,n,i));this.key=e,this.fastAesKey=new uf(this.subtle,e,i)}return this.fastAesKey.expandKey().then(e=>{if(!this.subtle)return Promise.reject(new Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");return new lf(this.subtle,new Uint8Array(n),i).decrypt(t.buffer,e)}).catch(r=>(Qu.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, ".concat(r.name,": ").concat(r.message)),this.onWebCryptoError(t,e,n,i)))}onWebCryptoError(t,e,n,i){const r=this.enableSoftwareAES;if(r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,e,n,i);const r=this.flush();if(r)return r.buffer}throw new Error("WebCrypto"+(r?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(t){let e=t;const n=t.length-t.length%16;return n!==t.length&&(e=t.slice(0,n),this.remainderData=t.slice(n)),e}logOnce(t){this.logEnabled&&(Qu.log("[decrypter]: ".concat(t)),this.logEnabled=!1)}}const df=Math.pow(2,17);class ff{constructor(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(t,e){const n=t.url;if(!n)return Promise.reject(new gf({type:Cu.NETWORK_ERROR,details:Ru.FRAG_LOAD_ERROR,fatal:!1,frag:t,error:new Error("Fragment does not have a ".concat(n?"part list":"url")),networkDetails:null}));this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise((a,o)=>{if(this.loader&&this.loader.destroy(),t.gap){if(t.tagList.some(t=>"GAP"===t[0]))return void o(mf(t));t.gap=!1}const l=this.loader=r?new r(i):new s(i),c=pf(t);t.loader=l;const u=Bd(i.fragLoadPolicy.default),h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===t.sn?1/0:df};t.stats=l.stats;const d={onSuccess:(e,n,i,r)=>{this.resetLoader(t,l);let s=e.data;i.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(s.slice(0,16)),s=s.slice(16)),a({frag:t,part:null,payload:s,networkDetails:r})},onError:(e,i,r,s)=>{this.resetLoader(t,l),o(new gf({type:Cu.NETWORK_ERROR,details:Ru.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:Gu({url:n,data:void 0},e),error:new Error("HTTP Error ".concat(e.code," ").concat(e.text)),networkDetails:r,stats:s}))},onAbort:(e,n,i)=>{this.resetLoader(t,l),o(new gf({type:Cu.NETWORK_ERROR,details:Ru.INTERNAL_ABORTED,fatal:!1,frag:t,error:new Error("Aborted"),networkDetails:i,stats:e}))},onTimeout:(e,n,i)=>{this.resetLoader(t,l),o(new gf({type:Cu.NETWORK_ERROR,details:Ru.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,error:new Error("Timeout after ".concat(h.timeout,"ms")),networkDetails:i,stats:e}))}};e&&(d.onProgress=(n,i,r,s)=>e({frag:t,part:null,payload:r,networkDetails:s})),l.load(c,h,d)})}loadPart(t,e,n){this.abort();const i=this.config,r=i.fLoader,s=i.loader;return new Promise((a,o)=>{if(this.loader&&this.loader.destroy(),t.gap||e.gap)return void o(mf(t,e));const l=this.loader=r?new r(i):new s(i),c=pf(t,e);t.loader=l;const u=Bd(i.fragLoadPolicy.default),h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:df};e.stats=l.stats,l.load(c,h,{onSuccess:(i,r,s,o)=>{this.resetLoader(t,l),this.updateStatsFromPart(t,e);const c={frag:t,part:e,payload:i.data,networkDetails:o};n(c),a(c)},onError:(n,i,r,s)=>{this.resetLoader(t,l),o(new gf({type:Cu.NETWORK_ERROR,details:Ru.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:e,response:Gu({url:c.url,data:void 0},n),error:new Error("HTTP Error ".concat(n.code," ").concat(n.text)),networkDetails:r,stats:s}))},onAbort:(n,i,r)=>{t.stats.aborted=e.stats.aborted,this.resetLoader(t,l),o(new gf({type:Cu.NETWORK_ERROR,details:Ru.INTERNAL_ABORTED,fatal:!1,frag:t,part:e,error:new Error("Aborted"),networkDetails:r,stats:n}))},onTimeout:(n,i,r)=>{this.resetLoader(t,l),o(new gf({type:Cu.NETWORK_ERROR,details:Ru.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:e,error:new Error("Timeout after ".concat(h.timeout,"ms")),networkDetails:r,stats:n}))}})})}updateStatsFromPart(t,e){const n=t.stats,i=e.stats,r=i.total;if(n.loaded+=i.loaded,r){const i=Math.round(t.duration/e.duration),s=Math.min(Math.round(n.loaded/r),i),a=(i-s)*Math.round(n.loaded/s);n.total=n.loaded+a}else n.total=Math.max(n.loaded,n.total);const s=n.loading,a=i.loading;s.start?s.first+=a.first-a.start:(s.start=a.start,s.first=a.first),s.end=a.end}resetLoader(t,e){t.loader=null,this.loader===e&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),e.destroy()}}function pf(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=e||t,i={frag:t,part:e,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},r=n.byteRangeStartOffset,s=n.byteRangeEndOffset;if(Tu(r)&&Tu(s)){var a;let e=r,n=s;if("initSegment"===t.sn&&("AES-128"===(o=null==(a=t.decryptdata)?void 0:a.method)||"AES-256"===o)){const t=s-r;t%16&&(n=s+(16-t%16)),0!==r&&(i.resetIV=!0,e=r-16)}i.rangeStart=e,i.rangeEnd=n}var o;return i}function mf(t,e){const n=new Error("GAP ".concat(t.gap?"tag":"attribute"," found")),i={type:Cu.MEDIA_ERROR,details:Ru.FRAG_GAP,fatal:!1,frag:t,error:n,networkDetails:null};return e&&(i.part=e),(e||t).stats.aborted=!0,new gf(i)}class gf extends Error{constructor(t){super(t.error.message),this.data=void 0,this.data=t}}class vf extends ju{constructor(t,e){super(t,e),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class yf{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=t,this.sn=e,this.id=n,this.size=i,this.part=r,this.partial=s}}const _f={length:0,start:()=>0,end:()=>0};class bf{static isBuffered(t,e){if(t){const n=bf.getBuffered(t);for(let t=n.length;t--;)if(e>=n.start(t)&&e<=n.end(t))return!0}return!1}static bufferedRanges(t){if(t){const e=bf.getBuffered(t);return bf.timeRangesToArray(e)}return[]}static timeRangesToArray(t){const e=[];for(let n=0;n<t.length;n++)e.push({start:t.start(n),end:t.end(n)});return e}static bufferInfo(t,e,n){if(t){const i=bf.bufferedRanges(t);if(i.length)return bf.bufferedInfo(i,e,n)}return{len:0,start:e,end:e,bufferedIndex:-1}}static bufferedInfo(t,e,n){e=Math.max(0,e),t.length>1&&t.sort((t,e)=>t.start-e.start||e.end-t.end);let i=-1,r=[];if(n)for(let c=0;c<t.length;c++){e>=t[c].start&&e<=t[c].end&&(i=c);const s=r.length;if(s){const e=r[s-1].end;t[c].start-e<n?t[c].end>e&&(r[s-1].end=t[c].end):r.push(t[c])}else r.push(t[c])}else r=t;let s,a=0,o=e,l=e;for(let c=0;c<r.length;c++){const t=r[c].start,u=r[c].end;if(-1===i&&e>=t&&e<=u&&(i=c),e+n>=t&&e<u)o=t,l=u,a=l-e;else if(e+n<t){s=t;break}}return{len:a,start:o||0,end:l||0,nextStart:s,buffered:t,bufferedIndex:i}}static getBuffered(t){try{return t.buffered||_f}catch(Wq){return Qu.log("failed to get media.buffered",Wq),_f}}}const xf=/\{\$([a-zA-Z0-9-_]+)\}/g;function Ef(t){return xf.test(t)}function wf(t,e){if(null!==t.variableList||t.hasVariableRefs){const n=t.variableList;return e.replace(xf,e=>{const i=e.substring(2,e.length-1),r=null==n?void 0:n[i];return void 0===r?(t.playlistParsingError||(t.playlistParsingError=new Error('Missing preceding EXT-X-DEFINE tag for Variable Reference: "'.concat(i,'"'))),e):r})}return e}function Sf(t,e,n){let i,r,s=t.variableList;if(s||(t.variableList=s={}),"QUERYPARAM"in e){i=e.QUERYPARAM;try{const t=new self.URL(n).searchParams;if(!t.has(i))throw new Error('"'.concat(i,'" does not match any query parameter in URI: "').concat(n,'"'));r=t.get(i)}catch(CO){t.playlistParsingError||(t.playlistParsingError=new Error("EXT-X-DEFINE QUERYPARAM: ".concat(CO.message)))}}else i=e.NAME,r=e.VALUE;i in s?t.playlistParsingError||(t.playlistParsingError=new Error('EXT-X-DEFINE duplicate Variable Name declarations: "'.concat(i,'"'))):s[i]=r||""}function Tf(t,e,n){const i=e.IMPORT;if(n&&i in n){let e=t.variableList;e||(t.variableList=e={}),e[i]=n[i]}else t.playlistParsingError||(t.playlistParsingError=new Error('EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "'.concat(i,'"')))}const Mf=/^(\d+)x(\d+)$/,Af=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Cf{constructor(t,e){"string"===typeof t&&(t=Cf.parseAttrList(t,e)),Hu(this,t)}get clientAttrs(){return Object.keys(this).filter(t=>"X-"===t.substring(0,2))}decimalInteger(t){const e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e}hexadecimalInteger(t){if(this[t]){let e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;const n=new Uint8Array(e.length/2);for(let t=0;t<e.length/2;t++)n[t]=parseInt(e.slice(2*t,2*t+2),16);return n}return null}hexadecimalIntegerAsNumber(t){const e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,e){const n=this[t];return n?parseFloat(n):e}enumeratedString(t){return this[t]}enumeratedStringList(t,e){const n=this[t];return(n?n.split(/[ ,]+/):[]).reduce((t,e)=>(t[e.toLowerCase()]=!0,t),e)}bool(t){return"YES"===this[t]}decimalResolution(t){const e=Mf.exec(this[t]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}}static parseAttrList(t,e){let n;const i={};for(Af.lastIndex=0;null!==(n=Af.exec(t));){const r=n[1].trim();let s=n[2];const a=0===s.indexOf('"')&&s.lastIndexOf('"')===s.length-1;let o=!1;if(a)s=s.slice(1,-1);else switch(r){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":o=!0}if(e&&(a||o))s=wf(e,s);else if(!o&&!a)switch(r){case"CLOSED-CAPTIONS":if("NONE"===s)break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Qu.warn("".concat(t,": attribute ").concat(r," is missing quotes"))}i[r]=s}return i}}function Rf(t){return"ID"!==t&&"CLASS"!==t&&"CUE"!==t&&"START-DATE"!==t&&"DURATION"!==t&&"END-DATE"!==t&&"END-ON-NEXT"!==t}function kf(t){return"SCTE35-OUT"===t||"SCTE35-IN"===t||"SCTE35-CMD"===t}class Lf{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;var i;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(null==e?void 0:e.tagAnchor)||null,this.tagOrder=null!=(i=null==e?void 0:e.tagOrder)?i:n,e){const n=e.attr;for(const e in n)if(Object.prototype.hasOwnProperty.call(t,e)&&t[e]!==n[e]){Qu.warn('DATERANGE tag attribute: "'.concat(e,'" does not match for tags with ID: "').concat(t.ID,'"')),this._badValueForSameId=e;break}t=Hu(new Cf({}),n,t)}if(this.attr=t,e?(this._startDate=e._startDate,this._cue=e._cue,this._endDate=e._endDate,this._dateAtEnd=e._dateAtEnd):this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr){const t=(null==e?void 0:e.endDate)||new Date(this.attr["END-DATE"]);Tu(t.getTime())&&(this._endDate=t)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const t=this._cue;return void 0===t?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):t}get startTime(){const{tagAnchor:t}=this;return null===t||null===t.programDateTime?(Qu.warn('Expected tagAnchor Fragment with PDT set for DateRange "'.concat(this.id,'": ').concat(t)),NaN):t.start+(this.startDate.getTime()-t.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const t=this._endDate||this._dateAtEnd;if(t)return t;const e=this.duration;return null!==e?this._dateAtEnd=new Date(this._startDate.getTime()+1e3*e):null}get duration(){if("DURATION"in this.attr){const t=this.attr.decimalFloatingPoint("DURATION");if(Tu(t))return t}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return"com.apple.hls.interstitial"===this.class}get isValid(){return!!this.id&&!this._badValueForSameId&&Tu(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}class Df{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}reloaded(t){if(!t)return this.advanced=!0,void(this.updated=!0);const e=this.lastPartSn-t.lastPartSn,n=this.lastPartIndex-t.lastPartIndex;this.updated=this.endSN!==t.endSN||!!n||!!e||!this.live,this.advanced=this.endSN>t.endSN||e>0||0===e&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*t.misses):this.misses=t.misses+1}hasKey(t){return this.encryptedFragments.some(e=>{let n=e.decryptdata;return n||(e.setKeyFormat(t.keyFormat),n=e.decryptdata),!!n&&t.matches(n)})}get hasProgramDateTime(){return!!this.fragments.length&&Tu(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const t=this.driftEndTime-this.driftStartTime;if(t>0){return 1e3*(this.driftEnd-this.driftStart)/t}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const t=this.partList;if(t){const e=this.lastPartIndex;if(-1!==e){for(let n=t.length;n--;)if(t[n].index>e)return t[n].index;return e}}return 0}get lastPartSn(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const t=this.partEnd-this.fragmentStart;return this.age>Math.max(t,this.totalduration)+this.levelTargetDuration}return!1}}function Pf(t,e){return t.length===e.length&&!t.some((t,n)=>t!==e[n])}function If(t,e){return!t&&!e||!(!t||!e)&&Pf(t,e)}function Of(t){return"AES-128"===t||"AES-256"===t||"AES-256-CTR"===t}function Nf(t){switch(t){case"AES-128":case"AES-256":return af;case"AES-256-CTR":return of;default:throw new Error("invalid full segment method ".concat(t))}}function Ff(t){return Uint8Array.from(atob(t),t=>t.charCodeAt(0))}function Uf(t){return Uint8Array.from(unescape(encodeURIComponent(t)),t=>t.charCodeAt(0))}function Bf(t){const e=function(t,e,n){const i=t[e];t[e]=t[n],t[n]=i};e(t,0,3),e(t,1,2),e(t,4,5),e(t,6,7)}function zf(t){const e=t.split(":");let n=null;if("data"===e[0]&&2===e.length){const t=e[1].split(";"),i=t[t.length-1].split(",");if(2===i.length){const e="base64"===i[0],r=i[1];e?(t.splice(-1,1),n=Ff(r)):n=function(t){const e=Uf(t).subarray(0,16),n=new Uint8Array(16);return n.set(e,16-e.length),n}(r)}}return n}const Hf="undefined"!==typeof self?self:void 0;var Vf={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Gf="org.w3.clearkey",jf="com.apple.streamingkeydelivery",Wf="com.microsoft.playready",Yf="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function Xf(t){switch(t){case jf:return Vf.FAIRPLAY;case Wf:return Vf.PLAYREADY;case Yf:return Vf.WIDEVINE;case Gf:return Vf.CLEARKEY}}function Kf(t){switch(t){case Vf.FAIRPLAY:return jf;case Vf.PLAYREADY:return Wf;case Vf.WIDEVINE:return Yf;case Vf.CLEARKEY:return Gf}}function qf(t){const{drmSystems:e,widevineLicenseUrl:n}=t,i=e?[Vf.FAIRPLAY,Vf.WIDEVINE,Vf.PLAYREADY,Vf.CLEARKEY].filter(t=>!!e[t]):[];return!i[Vf.WIDEVINE]&&n&&i.push(Vf.WIDEVINE),i}const Qf=null!=Hf&&null!=(Zf=Hf.navigator)&&Zf.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;var Zf;function Jf(t){const e=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),n=String.fromCharCode.apply(null,Array.from(e)),i=n.substring(n.indexOf("<"),n.length),r=(new DOMParser).parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(r){const t=r.childNodes[0]?r.childNodes[0].nodeValue:r.getAttribute("VALUE");if(t){const e=Ff(t).subarray(0,16);return Bf(e),e}}return null}let $f={};class tp{static clearKeyUriToKeyIdMap(){$f={}}static setKeyIdForUri(t,e){$f[t]=e}static addKeyIdForUri(t){const e=Object.keys($f).length%Number.MAX_SAFE_INTEGER,n=new Uint8Array(16);return new DataView(n.buffer,12,4).setUint32(0,e),$f[t]=n,n}constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5?arguments[5]:void 0;this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=e,this.keyFormat=n,this.keyFormatVersions=i,this.iv=r,this.encrypted=!!t&&"NONE"!==t,this.isCommonEncryption=this.encrypted&&!Of(t),null!=s&&s.startsWith("0x")&&(this.keyId=new Uint8Array(eh(s)))}matches(t){return t.uri===this.uri&&t.method===this.method&&t.encrypted===this.encrypted&&t.keyFormat===this.keyFormat&&Pf(t.keyFormatVersions,this.keyFormatVersions)&&If(t.iv,this.iv)&&If(t.keyId,this.keyId)}isSupported(){if(this.method){if(Of(this.method)||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case jf:case Yf:case Wf:case Gf:return-1!==["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(t,e){if(!this.encrypted||!this.uri)return null;if(Of(this.method)){let e=this.iv;e||("number"!==typeof t&&(Qu.warn('missing IV for initialization segment with method="'.concat(this.method,'" - compliance issue')),t=0),e=function(t){const e=new Uint8Array(16);for(let n=12;n<16;n++)e[n]=t>>8*(15-n)&255;return e}(t));return new tp(this.method,this.uri,"identity",this.keyFormatVersions,e)}if(this.keyId){const t=$f[this.uri];if(t&&!Pf(this.keyId,t)&&tp.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const n=zf(this.uri);if(n)switch(this.keyFormat){case Yf:if(this.pssh=n,!this.keyId){const t=function(t){const e=[];if(t instanceof ArrayBuffer){const n=t.byteLength;let i=0;for(;i+32<n;){const n=zh(new DataView(t,i));e.push(n),i+=n.size}}return e}(n.buffer);if(t.length){var i;const e=t[0];this.keyId=null!=(i=e.kids)&&i.length?e.kids[0]:null}}this.keyId||(this.keyId=ep(e));break;case Wf:{const t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=Bh(t,0,n),this.keyId=Jf(n);break}default:{let t=n.subarray(0,16);if(16!==t.length){const e=new Uint8Array(16);e.set(t,16-t.length),t=e}this.keyId=t;break}}if(!this.keyId||16!==this.keyId.byteLength){let t;t=function(t){const e=null==t?void 0:t[Yf];if(e)return e.keyId;return null}(e),t||(t=ep(e),t||(t=$f[this.uri])),t&&(this.keyId=t,tp.setKeyIdForUri(this.uri,t))}return this}}function ep(t){const e=null==t?void 0:t[Wf];if(e){const t=zf(e.uri);if(t)return Jf(t)}return null}const np=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,ip=/#EXT-X-MEDIA:(.*)/g,rp=/^#EXT(?:INF|-X-TARGETDURATION):/m,sp=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),ap=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class op{static findGroup(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(i.id===e)return i}}static resolve(t,e){return sh.buildAbsoluteURL(e,t,{alwaysNormalize:!0})}static isMediaPlaylist(t){return rp.test(t)}static parseMasterPlaylist(t,e){const n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:Ef(t)},i=[];if(np.lastIndex=0,!t.startsWith("#EXTM3U"))return n.playlistParsingError=new Error("no EXTM3U delimiter"),n;let r;for(;null!=(r=np.exec(t));)if(r[1]){var s;const t=new Cf(r[1],n),a=wf(n,r[2]),o={attrs:t,bitrate:t.decimalInteger("BANDWIDTH")||t.decimalInteger("AVERAGE-BANDWIDTH"),name:t.NAME,url:op.resolve(a,e)},l=t.decimalResolution("RESOLUTION");l&&(o.width=l.width,o.height=l.height),dp(t.CODECS,o);const c=t["SUPPLEMENTAL-CODECS"];c&&(o.supplemental={},dp(c,o.supplemental)),null!=(s=o.unknownCodecs)&&s.length||i.push(o),n.levels.push(o)}else if(r[3]){const t=r[3],i=r[4];switch(t){case"SESSION-DATA":{const t=new Cf(i,n),e=t["DATA-ID"];e&&(null===n.sessionData&&(n.sessionData={}),n.sessionData[e]=t);break}case"SESSION-KEY":{const t=up(i,e,n);t.encrypted&&t.isSupported()?(null===n.sessionKeys&&(n.sessionKeys=[]),n.sessionKeys.push(t)):Qu.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'.concat(i,'"'));break}case"DEFINE":Sf(n,new Cf(i,n),e);break;case"CONTENT-STEERING":{const t=new Cf(i,n);n.contentSteering={uri:op.resolve(t["SERVER-URI"],e),pathwayId:t["PATHWAY-ID"]||"."};break}case"START":n.startTimeOffset=hp(i)}}const a=i.length>0&&i.length<n.levels.length;return n.levels=a?i:n.levels,0===n.levels.length&&(n.playlistParsingError=new Error("no levels found in manifest")),n}static parseMasterPlaylistMedia(t,e,n){let i;const r={},s=n.levels,a={AUDIO:s.map(t=>({id:t.attrs.AUDIO,audioCodec:t.audioCodec})),SUBTITLES:s.map(t=>({id:t.attrs.SUBTITLES,textCodec:t.textCodec})),"CLOSED-CAPTIONS":[]};let o=0;for(ip.lastIndex=0;null!==(i=ip.exec(t));){const t=new Cf(i[1],n),s=t.TYPE;if(s){const n=a[s],i=r[s]||[];r[s]=i;const l=t.LANGUAGE,c=t["ASSOC-LANGUAGE"],u=t.CHANNELS,h=t.CHARACTERISTICS,d=t["INSTREAM-ID"],f={attrs:t,bitrate:0,id:o++,groupId:t["GROUP-ID"]||"",name:t.NAME||l||"",type:s,default:t.bool("DEFAULT"),autoselect:t.bool("AUTOSELECT"),forced:t.bool("FORCED"),lang:l,url:t.URI?op.resolve(t.URI,e):""};if(c&&(f.assocLang=c),u&&(f.channels=u),h&&(f.characteristics=h),d&&(f.instreamId=d),null!=n&&n.length){const t=op.findGroup(n,f.groupId)||n[0];fp(f,t,"audioCodec"),fp(f,t,"textCodec")}i.push(f)}}return r}static parseLevelPlaylist(t,e,n,i,r,s){var a;const o={url:e},l=new Df(e),c=l.fragments,u=[];let h,d,f,p,m=null,g=0,v=0,y=0,_=0,b=0,x=null,E=new dh(i,o),w=-1,S=!1,T=null;if(sp.lastIndex=0,l.m3u8=t,l.hasVariableRefs=Ef(t),"#EXTM3U"!==(null==(a=sp.exec(t))?void 0:a[0]))return l.playlistParsingError=new Error("Missing format identifier #EXTM3U"),l;for(;null!==(h=sp.exec(t));){S&&(S=!1,E=new dh(i,o),E.playlistOffset=y,E.setStart(y),E.sn=g,E.cc=_,b&&(E.bitrate=b),E.level=n,m&&(E.initSegment=m,m.rawProgramDateTime&&(E.rawProgramDateTime=m.rawProgramDateTime,m.rawProgramDateTime=null),T&&(E.setByteRange(T),T=null)));const t=h[1];if(t){E.duration=parseFloat(t);const e=(" "+h[2]).slice(1);E.title=e||null,E.tagList.push(e?["INF",t,e]:["INF",t])}else if(h[3]){if(Tu(E.duration)){E.playlistOffset=y,E.setStart(y),f&&gp(E,f,l),E.sn=g,E.level=n,E.cc=_,c.push(E);const t=(" "+h[3]).slice(1);E.relurl=wf(l,t),pp(E,x,u),x=E,y+=E.duration,g++,v=0,S=!0}}else{if(h=h[0].match(ap),!h){Qu.warn("No matches on slow regex match for level playlist!");continue}for(d=1;d<h.length&&void 0===h[d];d++);const t=(" "+h[d]).slice(1),r=(" "+h[d+1]).slice(1),a=h[d+2]?(" "+h[d+2]).slice(1):null;switch(t){case"BYTERANGE":x?E.setByteRange(r,x):E.setByteRange(r);break;case"PROGRAM-DATE-TIME":E.rawProgramDateTime=r,E.tagList.push(["PROGRAM-DATE-TIME",r]),-1===w&&(w=c.length);break;case"PLAYLIST-TYPE":l.type&&vp(l,t,h),l.type=r.toUpperCase();break;case"MEDIA-SEQUENCE":0!==l.startSN?vp(l,t,h):c.length>0&&yp(l,t,h),g=l.startSN=parseInt(r);break;case"SKIP":{l.skippedSegments&&vp(l,t,h);const e=new Cf(r,l),n=e.decimalInteger("SKIPPED-SEGMENTS");if(Tu(n)){l.skippedSegments+=n;for(let t=n;t--;)c.push(null);g+=n}const i=e.enumeratedString("RECENTLY-REMOVED-DATERANGES");i&&(l.recentlyRemovedDateranges=(l.recentlyRemovedDateranges||[]).concat(i.split("\t")));break}case"TARGETDURATION":0!==l.targetduration&&vp(l,t,h),l.targetduration=Math.max(parseInt(r),1);break;case"VERSION":null!==l.version&&vp(l,t,h),l.version=parseInt(r);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":l.live||vp(l,t,h),l.live=!1;break;case"#":(r||a)&&E.tagList.push(a?[r,a]:[r]);break;case"DISCONTINUITY":_++,E.tagList.push(["DIS"]);break;case"GAP":E.gap=!0,E.tagList.push([t]);break;case"BITRATE":E.tagList.push([t,r]),b=1e3*parseInt(r),Tu(b)?E.bitrate=b:b=0;break;case"DATERANGE":{const t=new Cf(r,l),e=new Lf(t,l.dateRanges[t.ID],l.dateRangeTagCount);l.dateRangeTagCount++,e.isValid||l.skippedSegments?l.dateRanges[e.id]=e:Qu.warn('Ignoring invalid DATERANGE tag: "'.concat(r,'"')),E.tagList.push(["EXT-X-DATERANGE",r]);break}case"DEFINE":{const t=new Cf(r,l);"IMPORT"in t?Tf(l,t,s):Sf(l,t,e)}break;case"DISCONTINUITY-SEQUENCE":0!==l.startCC?vp(l,t,h):c.length>0&&yp(l,t,h),l.startCC=_=parseInt(r);break;case"KEY":{const t=up(r,e,l);if(t.isSupported()){if("NONE"===t.method){f=void 0;break}f||(f={});const e=f[t.keyFormat];null!=e&&e.matches(t)||(e&&(f=Hu({},f)),f[t.keyFormat]=t)}else Qu.warn('[Keys] Ignoring unsupported EXT-X-KEY tag: "'.concat(r,'"'));break}case"START":l.startTimeOffset=hp(r);break;case"MAP":{const t=new Cf(r,l);if(E.duration){const e=new dh(i,o);mp(e,t,n,f),m=e,E.initSegment=m,m.rawProgramDateTime&&!E.rawProgramDateTime&&(E.rawProgramDateTime=m.rawProgramDateTime)}else{const e=E.byteRangeEndOffset;if(e){const t=E.byteRangeStartOffset;T="".concat(e-t,"@").concat(t)}else T=null;mp(E,t,n,f),m=E,S=!0}m.cc=_;break}case"SERVER-CONTROL":p&&vp(l,t,h),p=new Cf(r),l.canBlockReload=p.bool("CAN-BLOCK-RELOAD"),l.canSkipUntil=p.optionalFloat("CAN-SKIP-UNTIL",0),l.canSkipDateRanges=l.canSkipUntil>0&&p.bool("CAN-SKIP-DATERANGES"),l.partHoldBack=p.optionalFloat("PART-HOLD-BACK",0),l.holdBack=p.optionalFloat("HOLD-BACK",0);break;case"PART-INF":{l.partTarget&&vp(l,t,h);const e=new Cf(r);l.partTarget=e.decimalFloatingPoint("PART-TARGET");break}case"PART":{let t=l.partList;t||(t=l.partList=[]);const e=v>0?t[t.length-1]:void 0,n=v++,i=new Cf(r,l),s=new fh(i,E,o,n,e);t.push(s),E.duration+=s.duration;break}case"PRELOAD-HINT":{const t=new Cf(r,l);l.preloadHint=t;break}case"RENDITION-REPORT":{const t=new Cf(r,l);l.renditionReports=l.renditionReports||[],l.renditionReports.push(t);break}default:Qu.warn("line parsed but not handled: ".concat(h))}}}x&&!x.relurl?(c.pop(),y-=x.duration,l.partList&&(l.fragmentHint=x)):l.partList&&(pp(E,x,u),E.cc=_,l.fragmentHint=E,f&&gp(E,f,l)),l.targetduration||(l.playlistParsingError=new Error("Missing Target Duration"));const M=c.length,A=c[0],C=c[M-1];if(y+=l.skippedSegments*l.targetduration,y>0&&M&&C){l.averagetargetduration=y/M;const t=C.sn;l.endSN="initSegment"!==t?t:0,l.live||(C.endList=!0),w>0&&(!function(t,e){let n=t[e];for(let i=e;i--;){const e=t[i];if(!e)return;e.programDateTime=n.programDateTime-1e3*e.duration,n=e}}(c,w),A&&u.unshift(A))}return l.fragmentHint&&(y+=l.fragmentHint.duration),l.totalduration=y,u.length&&l.dateRangeTagCount&&A&&lp(u,l),l.endCC=_,l}}function lp(t,e){let n=t.length;if(!n){if(!e.hasProgramDateTime)return;{const i=e.fragments[e.fragments.length-1];t.push(i),n++}}const i=t[n-1],r=e.live?1/0:e.totalduration,s=Object.keys(e.dateRanges);for(let o=s.length;o--;){const l=e.dateRanges[s[o]],c=l.startDate.getTime();l.tagAnchor=i.ref;for(let i=n;i--;){var a;if((null==(a=t[i])?void 0:a.sn)<e.startSN)break;const n=cp(e,c,t,i,r);if(-1!==n){l.tagAnchor=e.fragments[n].ref;break}}}}function cp(t,e,n,i,r){const s=n[i];if(s){const o=s.programDateTime;if(e>=o||0===i){var a;if(e<=o+1e3*(((null==(a=n[i+1])?void 0:a.start)||r)-s.start)){const r=n[i].sn-t.startSN;if(r<0)return-1;const s=t.fragments;if(s.length>n.length){for(let a=(n[i+1]||s[s.length-1]).sn-t.startSN;a>r;a--){const t=s[a].programDateTime;if(e>=t&&e<t+1e3*s[a].duration)return a}}return r}}}return-1}function up(t,e,n){var i,r;const s=new Cf(t,n),a=null!=(i=s.METHOD)?i:"",o=s.URI,l=s.hexadecimalInteger("IV"),c=s.KEYFORMATVERSIONS,u=null!=(r=s.KEYFORMAT)?r:"identity";o&&s.IV&&!l&&Qu.error("Invalid IV: ".concat(s.IV));const h=o?op.resolve(o,e):"",d=(c||"1").split("/").map(Number).filter(Number.isFinite);return new tp(a,h,u,d,l,s.KEYID)}function hp(t){const e=new Cf(t).decimalFloatingPoint("TIME-OFFSET");return Tu(e)?e:null}function dp(t,e){let n=(t||"").split(/[ ,]+/).filter(t=>t);["video","audio","text"].forEach(t=>{const i=n.filter(e=>Gh(e,t));i.length&&(e["".concat(t,"Codec")]=i.map(t=>t.split("/")[0]).join(","),n=n.filter(t=>-1===i.indexOf(t)))}),e.unknownCodecs=n}function fp(t,e,n){const i=e[n];i&&(t[n]=i)}function pp(t,e,n){t.rawProgramDateTime?n.push(t):null!=e&&e.programDateTime&&(t.programDateTime=e.endProgramDateTime)}function mp(t,e,n,i){t.relurl=e.URI,e.BYTERANGE&&t.setByteRange(e.BYTERANGE),t.level=n,t.sn="initSegment",i&&(t.levelkeys=i),t.initSegment=null}function gp(t,e,n){t.levelkeys=e;const{encryptedFragments:i}=n;i.length&&i[i.length-1].levelkeys===e||!Object.keys(e).some(t=>e[t].isCommonEncryption)||i.push(t)}function vp(t,e,n){t.playlistParsingError=new Error("#EXT-X-".concat(e," must not appear more than once (").concat(n[0],")"))}function yp(t,e,n){t.playlistParsingError=new Error("#EXT-X-".concat(e," must appear before the first Media Segment (").concat(n[0],")"))}function _p(t,e){const n=e.startPTS;if(Tu(n)){let i,r=0;e.sn>t.sn?(r=n-t.start,i=t):(r=t.start-n,i=e),i.duration!==r&&i.setDuration(r)}else if(e.sn>t.sn){t.cc===e.cc&&t.minEndPTS?e.setStart(t.start+(t.minEndPTS-t.start)):e.setStart(t.start+t.duration)}else e.setStart(Math.max(t.start-e.duration,0))}function bp(t,e,n,i,r,s,a){i-n<=0&&(a.warn("Fragment should have a positive duration",e),i=n+e.duration,s=r+e.duration);let o=n,l=i;const c=e.startPTS,u=e.endPTS;if(Tu(c)){const h=Math.abs(c-n);t&&h>t.totalduration?a.warn("media timestamps and playlist times differ by ".concat(h,"s for level ").concat(e.level," ").concat(t.url)):Tu(e.deltaPTS)?e.deltaPTS=Math.max(h,e.deltaPTS):e.deltaPTS=h,o=Math.max(n,c),n=Math.min(n,c),r=void 0!==e.startDTS?Math.min(r,e.startDTS):r,l=Math.min(i,u),i=Math.max(i,u),s=void 0!==e.endDTS?Math.max(s,e.endDTS):s}const h=n-e.start;0!==e.start&&e.setStart(n),e.setDuration(i-e.start),e.startPTS=n,e.maxStartPTS=o,e.startDTS=r,e.endPTS=i,e.minEndPTS=l,e.endDTS=s;const d=e.sn;if(!t||d<t.startSN||d>t.endSN)return 0;let f;const p=d-t.startSN,m=t.fragments;for(m[p]=e,f=p;f>0;f--)_p(m[f],m[f-1]);for(f=p;f<m.length-1;f++)_p(m[f],m[f+1]);return t.fragmentHint&&_p(m[m.length-1],t.fragmentHint),t.PTSKnown=t.alignedSliding=!0,h}function xp(t,e,n){if(t===e)return;let i=null;const r=t.fragments;for(let u=r.length-1;u>=0;u--){const t=r[u].initSegment;if(t){i=t;break}}let s;t.fragmentHint&&delete t.fragmentHint.endPTS,function(t,e,n){const i=e.skippedSegments,r=Math.max(t.startSN,e.startSN)-e.startSN,s=(t.fragmentHint?1:0)+(i?e.endSN:Math.min(t.endSN,e.endSN))-e.startSN,a=e.startSN-t.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments;for(let c=r;c<=s;c++){const r=l[a+c];let s=o[c];if(i&&!s&&r&&(s=e.fragments[c]=r),r&&s){n(r,s,c,o);const i=r.relurl,a=s.relurl;if(i&&kp(i,a))return void(e.playlistParsingError=Ep("media sequence mismatch ".concat(s.sn,":"),t,e,r,s));if(r.cc!==s.cc)return void(e.playlistParsingError=Ep("discontinuity sequence mismatch (".concat(r.cc,"!=").concat(s.cc,")"),t,e,r,s))}}}(t,e,(t,n,r,a)=>{if((!e.startCC||e.skippedSegments)&&n.cc!==t.cc){const i=t.cc-n.cc;for(let t=r;t<a.length;t++)a[t].cc+=i;e.endCC=a[a.length-1].cc}Tu(t.startPTS)&&Tu(t.endPTS)&&(n.setStart(n.startPTS=t.startPTS),n.startDTS=t.startDTS,n.maxStartPTS=t.maxStartPTS,n.endPTS=t.endPTS,n.endDTS=t.endDTS,n.minEndPTS=t.minEndPTS,n.setDuration(t.endPTS-t.startPTS),n.duration&&(s=n),e.PTSKnown=e.alignedSliding=!0),t.hasStreams&&(n.elementaryStreams=t.elementaryStreams),n.loader=t.loader,t.hasStats&&(n.stats=t.stats),t.initSegment&&(n.initSegment=t.initSegment,i=t.initSegment)});const a=e.fragments,o=e.fragmentHint?a.concat(e.fragmentHint):a;if(i&&o.forEach(t=>{var e;!t||t.initSegment&&t.initSegment.relurl!==(null==(e=i)?void 0:e.relurl)||(t.initSegment=i)}),e.skippedSegments){if(e.deltaUpdateFailed=a.some(t=>!t),e.deltaUpdateFailed){n.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let t=e.skippedSegments;t--;)a.shift();e.startSN=a[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=function(t,e,n){const{dateRanges:i,recentlyRemovedDateranges:r}=e,s=Hu({},t);r&&r.forEach(t=>{delete s[t]});const a=Object.keys(s).length;if(!a)return i;return Object.keys(i).forEach(t=>{const e=s[t],r=new Lf(i[t].attr,e);r.isValid?(s[t]=r,e||(r.tagOrder+=a)):n.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'.concat(bd(i[t].attr),'"'))}),s}(t.dateRanges,e,n));const i=t.fragments.filter(t=>t.rawProgramDateTime);if(t.hasProgramDateTime&&!e.hasProgramDateTime)for(let t=1;t<o.length;t++)null===o[t].programDateTime&&pp(o[t],o[t-1],i);lp(i,e)}e.endCC=a[a.length-1].cc}if(!e.startCC){var l;const n=Mp(t,e.startSN-1);e.startCC=null!=(l=null==n?void 0:n.cc)?l:a[0].cc}!function(t,e,n){if(t&&e){let i=0;for(let r=0,s=t.length;r<=s;r++){const s=t[r],a=e[r+i];s&&a&&s.index===a.index&&s.fragment.sn===a.fragment.sn?n(s,a):i--}}}(t.partList,e.partList,(t,e)=>{e.elementaryStreams=t.elementaryStreams,e.stats=t.stats}),s?bp(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS,n):wp(t,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=t.driftStartTime,e.driftStart=t.driftStart;const c=e.advancedDateTime;if(e.advanced&&c){const t=e.edge;e.driftStart||(e.driftStartTime=c,e.driftStart=t),e.driftEndTime=c,e.driftEnd=t}else e.driftEndTime=t.driftEndTime,e.driftEnd=t.driftEnd,e.advancedDateTime=t.advancedDateTime;-1===e.requestScheduled&&(e.requestScheduled=t.requestScheduled)}function Ep(t,e,n,i,r){return new Error("".concat(t," ").concat(r.url,"\nPlaylist starting @").concat(e.startSN,"\n").concat(e.m3u8,"\n\nPlaylist starting @").concat(n.startSN,"\n").concat(n.m3u8))}function wp(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=e.startSN+e.skippedSegments-t.startSN,r=t.fragments,s=i>=0;let a=0;if(s&&i<r.length)a=r[i].start;else if(s&&e.startSN===t.endSN+1)a=t.fragmentEnd;else if(s&&n)a=t.fragmentStart+i*e.levelTargetDuration;else{if(e.skippedSegments||0!==e.fragmentStart)return;a=t.fragmentStart}Sp(e,a)}function Sp(t,e){if(e){const n=t.fragments;for(let i=t.skippedSegments;i<n.length;i++)n[i].addStart(e);t.fragmentHint&&t.fragmentHint.addStart(e)}}function Tp(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=1e3*t.targetduration;if(t.updated){const i=t.fragments,r=4;if(i.length&&n*r>e){const t=1e3*i[i.length-1].duration;t<n&&(n=t)}}else n/=2;return Math.round(n)}function Mp(t,e,n){if(!t)return null;let i=t.fragments[e-t.startSN];return i||(i=t.fragmentHint,i&&i.sn===e?i:e<t.startSN&&n&&n.sn===e?n:null)}function Ap(t,e,n){return t?Cp(t.partList,e,n):null}function Cp(t,e,n){if(t)for(let i=t.length;i--;){const r=t[i];if(r.index===n&&r.fragment.sn===e)return r}return null}function Rp(t){t.forEach((t,e)=>{var n;null==(n=t.details)||n.fragments.forEach(t=>{t.level=e,t.initSegment&&(t.initSegment.level=e)})})}function kp(t,e){return!(t===e||!e)&&Lp(t)!==Lp(e)}function Lp(t){return t.replace(/\?[^?]*$/,"")}function Dp(t,e){for(let i=0,r=t.length;i<r;i++){var n;if((null==(n=t[i])?void 0:n.cc)===e)return t[i]}return null}function Pp(t,e){const n=t.start+e;t.startPTS=n,t.setStart(n),t.endPTS=n+t.duration}function Ip(t,e){const n=e.fragments;for(let i=0,r=n.length;i<r;i++)Pp(n[i],t);e.fragmentHint&&Pp(e.fragmentHint,t),e.alignedSliding=!0}function Op(t,e){if(!function(t,e){return!!(t&&e.startCC<t.endCC&&e.endCC>t.startCC)}(e,t))return;const n=Math.min(e.endCC,t.endCC),i=Dp(e.fragments,n),r=Dp(t.fragments,n);if(!i||!r)return;Qu.log("Aligning playlist at start of dicontinuity sequence ".concat(n));Ip(i.start-r.start,t)}function Np(t,e){if(!t.hasProgramDateTime||!e.hasProgramDateTime)return;const n=t.fragments,i=e.fragments;if(!n.length||!i.length)return;let r,s;const a=Math.min(e.endCC,t.endCC);e.startCC<a&&t.startCC<a&&(r=Dp(i,a),s=Dp(n,a)),r&&s||(r=i[Math.floor(i.length/2)],s=Dp(n,r.cc)||n[Math.floor(n.length/2)]);const o=r.programDateTime,l=s.programDateTime;if(!o||!l)return;Ip((l-o)/1e3-(s.start-r.start),t)}function Fp(t,e,n){Up(t,e,n),t.addEventListener(e,n)}function Up(t,e,n){t.removeEventListener(e,n)}const Bp=function(t){let e="";const n=t.length;for(let i=0;i<n;i++)e+="[".concat(t.start(i).toFixed(3),"-").concat(t.end(i).toFixed(3),"]");return e},zp="STOPPED",Hp="IDLE",Vp="KEY_LOADING",Gp="FRAG_LOADING",jp="FRAG_LOADING_WAITING_RETRY",Wp="WAITING_TRACK",Yp="PARSING",Xp="PARSED",Kp="ENDED",qp="ERROR",Qp="WAITING_INIT_PTS",Zp="WAITING_LEVEL";class Jp extends vf{constructor(t,e,n,i,r){super(i,t.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=zp,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:t,fragCurrent:e,media:n,mediaBuffer:i,state:r}=this,s=n?n.currentTime:0,a=bf.bufferInfo(i||n,s,t.maxBufferHole),o=!a.len;if(this.log("Media seeking to ".concat(Tu(s)?s.toFixed(3):s,", state: ").concat(r,", ").concat(o?"out of":"in"," buffer")),this.state===Kp)this.resetLoadingState();else if(e){const n=t.maxFragLookUpTolerance,i=e.start-n,r=e.start+e.duration+n;if(o||r<a.start||i>a.end){const t=s>r;(s<i||t)&&(t&&e.loader&&(this.log("Cancelling fragment load for seek (sn: ".concat(e.sn,")")),e.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(n){this.fragmentTracker.removeFragmentsInRange(s,1/0,this.playlistType,!0);if(s>this.lastCurrentTime&&(this.lastCurrentTime=s),!this.loadingParts){const t=Math.max(a.end,s),e=this.shouldLoadParts(this.getLevelDetails(),t);e&&(this.log("LL-Part loading ON after seeking to ".concat(s.toFixed(2)," with buffer @").concat(t.toFixed(2))),this.loadingParts=e)}}this.hls.hasEnoughToStart||(this.log("Setting ".concat(o?"startPosition":"nextLoadPosition"," to ").concat(s," for seek without enough to start")),this.nextLoadPosition=s,o&&(this.startPosition=s)),o&&this.state===Hp&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=r,this.hls=t,this.fragmentLoader=new ff(t.config),this.keyLoader=n,this.fragmentTracker=e,this.config=t.config,this.decrypter=new hf(t.config)}registerListeners(){const{hls:t}=this;t.on(ku.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.on(ku.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(ku.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(ku.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.off(ku.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(ku.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){if(this.state===zp)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const t=this.fragCurrent;null!=t&&t.loader&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=zp}get startPositionValue(){const{nextLoadPosition:t,startPosition:e}=this;return-1===e&&t?t:e}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(t,e){if(e.live||!this.media)return!1;const n=t.end||0,i=this.config.timelineOffset||0;if(n<=i)return!1;const r=t.buffered;this.config.maxBufferHole&&r&&r.length>1&&(t=bf.bufferedInfo(r,t.start,0));const s=t.nextStart;if(s&&s>i&&s<e.edge)return!1;if(this.media.currentTime<t.start)return!1;const a=e.partList;if(null!=a&&a.length){const t=a[a.length-1];return bf.isBuffered(this.media,t.start+t.duration/2)}const o=e.fragments[e.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(o)}getLevelDetails(){if(this.levels&&null!==this.levelLastLoaded)return this.levelLastLoaded.details}get timelineOffset(){const t=this.config.timelineOffset;var e;return t?(null==(e=this.getLevelDetails())?void 0:e.appliedTimelineOffset)||t:0}onMediaAttached(t,e){const n=this.media=this.mediaBuffer=e.media;Fp(n,"seeking",this.onMediaSeeking),Fp(n,"ended",this.onMediaEnded);const i=this.config;this.levels&&i.autoStartLoad&&this.state===zp&&this.startLoad(i.startPosition)}onMediaDetaching(t,e){const n=!!e.transferMedia,i=this.media;if(null!==i){if(i.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),Up(i,"seeking",this.onMediaSeeking),Up(i,"ended",this.onMediaEnded),this.keyLoader&&!n&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,n)return this.resetLoadingState(),void this.resetTransmuxer();this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(t,e){}onManifestLoaded(t,e){this.startTimeOffset=e.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=zp,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(t,e,n){this.startFragRequested=!0,this._loadFragForPlayback(t,e,n)}_loadFragForPlayback(t,e,n){this._doFragLoad(t,e,n,t=>{const e=t.frag;if(this.fragContextChanged(e))return this.warn("".concat(e.type," sn: ").concat(e.sn).concat(t.part?" part: "+t.part.index:""," of ").concat(this.fragInfo(e,!1,t.part),") was dropped during download.")),void this.fragmentTracker.removeFragment(e);e.stats.chunkCount++,this._handleFragmentLoadProgress(t)}).then(t=>{if(!t)return;const e=this.state,n=t.frag;this.fragContextChanged(n)?(e===Gp||!this.fragCurrent&&e===Yp)&&(this.fragmentTracker.removeFragment(n),this.state=Hp):("payload"in t&&(this.log("Loaded ".concat(n.type," sn: ").concat(n.sn," of ").concat(this.playlistLabel()," ").concat(n.level)),this.hls.trigger(ku.FRAG_LOADED,t)),this._handleFragmentLoadComplete(t))}).catch(e=>{this.state!==zp&&this.state!==qp&&(this.warn("Frag error: ".concat((null==e?void 0:e.message)||e)),this.resetFragmentLoading(t))})}clearTrackerIfNeeded(t){var e;const{fragmentTracker:n}=this;if(n.getState(t)===Jd){const e=t.type,i=this.getFwdBufferInfo(this.mediaBuffer,e),r=Math.max(t.duration,i?i.len:this.config.maxBufferLength),s=this.backtrackFragment;(1===(s?t.sn-s.sn:0)||this.reduceMaxBufferLength(r,t.duration))&&n.removeFragment(t)}else 0===(null==(e=this.mediaBuffer)?void 0:e.buffered.length)?n.removeAllFragments():n.hasParts(t.type)&&(n.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type}),n.getState(t)===$d&&n.removeFragment(t))}checkLiveUpdate(t){if(t.updated&&!t.live){const e=t.fragments[t.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type})}t.fragments[0]||(t.deltaUpdateFailed=!0)}waitForLive(t){const e=t.details;return(null==e?void 0:e.live)&&"EVENT"!==e.type&&(this.levelLastLoaded!==t||e.expired)}flushMainBuffer(t,e){if(!(t-e))return;const n={startOffset:t,endOffset:e,type:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null};this.hls.trigger(ku.BUFFER_FLUSHING,n)}_loadInitSegment(t,e){this._doFragLoad(t,e).then(t=>{const e=null==t?void 0:t.frag;if(!e||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return t}).then(t=>{const{hls:e}=this,{frag:n,payload:i}=t,r=n.decryptdata;if(i&&i.byteLength>0&&null!=r&&r.key&&r.iv&&Of(r.method)){const s=self.performance.now();return this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer,Nf(r.method)).catch(t=>{throw e.trigger(ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:n}),t}).then(i=>{const r=self.performance.now();return e.trigger(ku.FRAG_DECRYPTED,{frag:n,payload:i,stats:{tstart:s,tdecrypt:r}}),t.payload=i,this.completeInitSegmentLoad(t)})}return this.completeInitSegmentLoad(t)}).catch(e=>{this.state!==zp&&this.state!==qp&&(this.warn(e),this.resetFragmentLoading(t))})}completeInitSegmentLoad(t){const{levels:e}=this;if(!e)throw new Error("init load aborted, missing levels");const n=t.frag.stats;this.state!==zp&&(this.state=Hp),t.frag.data=new Uint8Array(t.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(t,e){var n,i;const r=t.tracks;if(r&&!e.encrypted&&(null!=(n=r.audio)&&n.encrypted||null!=(i=r.video)&&i.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const t=this.media,n=new Error("Encrypted track with no key in ".concat(this.fragInfo(e)," (media ").concat(t?"attached mediaKeys: "+t.mediaKeys:"detached",")"));return this.warn(n.message),!t||t.mediaKeys?!1:(this.hls.trigger(ku.ERROR,{type:Cu.KEY_SYSTEM_ERROR,details:Ru.KEY_SYSTEM_NO_KEYS,fatal:!1,error:n,frag:e}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(t){const{fragCurrent:e}=this;return!t||!e||t.sn!==e.sn||t.level!==e.level}fragBufferedComplete(t,e){const n=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log("Buffered ".concat(t.type," sn: ").concat(t.sn).concat(e?" part: "+e.index:""," of ").concat(this.fragInfo(t,!1,e)," > buffer:").concat(n?Bp(bf.getBuffered(n)):"(detached)",")")),hh(t)){var i;if(t.type!==Fu){const e=t.elementaryStreams;if(!Object.keys(e).some(t=>!!e[t]))return void(this.state=Hp)}const e=null==(i=this.levels)?void 0:i[t.level];null!=e&&e.fragmentError&&(this.log("Resetting level fragment error count of ".concat(e.fragmentError," on frag buffered")),e.fragmentError=0)}this.state=Hp}_handleFragmentLoadComplete(t){const{transmuxer:e}=this;if(!e)return;const{frag:n,part:i,partsLoaded:r}=t,s=!r||0===r.length||r.some(t=>!t),a=new yf(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!s);e.flush(a)}_handleFragmentLoadProgress(t){}_doFragLoad(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;var r;this.fragCurrent=t;const s=e.details;if(!this.levels||!s)throw new Error("frag load aborted, missing level".concat(s?"":" detail","s"));let a=null;if(!t.encrypted||null!=(r=t.decryptdata)&&r.key)t.encrypted||(a=this.keyLoader.loadClear(t,s.encryptedFragments,this.startFragRequested),a&&this.log("[eme] blocking frag load until media-keys acquired"));else if(this.log("Loading key for ".concat(t.sn," of [").concat(s.startSN,"-").concat(s.endSN,"], ").concat(this.playlistLabel()," ").concat(t.level)),this.state=Vp,this.fragCurrent=t,a=this.keyLoader.load(t).then(t=>{if(!this.fragContextChanged(t.frag))return this.hls.trigger(ku.KEY_LOADED,t),this.state===Vp&&(this.state=Hp),t}),this.hls.trigger(ku.KEY_LOADING,{frag:t}),null===this.fragCurrent)return this.log("context changed in KEY_LOADING"),Promise.resolve(null);const o=this.fragPrevious;if(hh(t)&&(!o||t.sn!==o.sn)){const n=this.shouldLoadParts(e.details,t.end);n!==this.loadingParts&&(this.log("LL-Part loading ".concat(n?"ON":"OFF"," loading sn ").concat(null==o?void 0:o.sn,"->").concat(t.sn)),this.loadingParts=n)}if(n=Math.max(t.start,n||0),this.loadingParts&&hh(t)){const r=s.partList;if(r&&i){n>s.fragmentEnd&&s.fragmentHint&&(t=s.fragmentHint);const o=this.getNextPart(r,t,n);if(o>-1){const l=r[o];let c;return t=this.fragCurrent=l.fragment,this.log("Loading ".concat(t.type," sn: ").concat(t.sn," part: ").concat(l.index," (").concat(o,"/").concat(r.length-1,") of ").concat(this.fragInfo(t,!1,l),") cc: ").concat(t.cc," [").concat(s.startSN,"-").concat(s.endSN,"], target: ").concat(parseFloat(n.toFixed(3)))),this.nextLoadPosition=l.start+l.duration,this.state=Gp,c=a?a.then(n=>!n||this.fragContextChanged(n.frag)?null:this.doFragPartsLoad(t,l,e,i)).catch(t=>this.handleFragLoadError(t)):this.doFragPartsLoad(t,l,e,i).catch(t=>this.handleFragLoadError(t)),this.hls.trigger(ku.FRAG_LOADING,{frag:t,part:l,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):c}if(!t.url||this.loadedEndOfParts(r,n))return Promise.resolve(null)}}var l;if(hh(t)&&this.loadingParts)this.log("LL-Part loading OFF after next part miss @".concat(n.toFixed(2)," Check buffer at sn: ").concat(t.sn," loaded parts: ").concat(null==(l=s.partList)?void 0:l.filter(t=>t.loaded).map(t=>"[".concat(t.start,"-").concat(t.end,"]")))),this.loadingParts=!1;else if(!t.url)return Promise.resolve(null);this.log("Loading ".concat(t.type," sn: ").concat(t.sn," of ").concat(this.fragInfo(t,!1),") cc: ").concat(t.cc," ").concat("["+s.startSN+"-"+s.endSN+"]",", target: ").concat(parseFloat(n.toFixed(3)))),Tu(t.sn)&&!this.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),this.state=Gp;const c=this.config.progressive&&t.type!==Fu;let u;return u=c&&a?a.then(e=>!e||this.fragContextChanged(e.frag)?null:this.fragmentLoader.load(t,i)).catch(t=>this.handleFragLoadError(t)):Promise.all([this.fragmentLoader.load(t,c?i:void 0),a]).then(t=>{let[e]=t;return!c&&i&&i(e),e}).catch(t=>this.handleFragLoadError(t)),this.hls.trigger(ku.FRAG_LOADING,{frag:t,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):u}doFragPartsLoad(t,e,n,i){return new Promise((r,s)=>{var a;const o=[],l=null==(a=n.details)?void 0:a.partList,c=e=>{this.fragmentLoader.loadPart(t,e,i).then(i=>{o[e.index]=i;const s=i.part;this.hls.trigger(ku.FRAG_LOADED,i);const a=Ap(n.details,t.sn,e.index+1)||Cp(l,t.sn,e.index+1);if(!a)return r({frag:t,part:s,partsLoaded:o});c(a)}).catch(s)};c(e)})}handleFragLoadError(t){if("data"in t){const e=t.data;e.frag&&e.details===Ru.INTERNAL_ABORTED?this.handleFragLoadAborted(e.frag,e.part):e.frag&&e.type===Cu.KEY_SYSTEM_ERROR?(e.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(e.frag)):this.hls.trigger(ku.ERROR,e)}else this.hls.trigger(ku.ERROR,{type:Cu.OTHER_ERROR,details:Ru.INTERNAL_EXCEPTION,err:t,error:t,fatal:!0});return null}_handleTransmuxerFlush(t){const e=this.getCurrentContext(t);if(!e||this.state!==Yp)return void(this.fragCurrent||this.state===zp||this.state===qp||(this.state=Hp));const{frag:n,part:i,level:r}=e,s=self.performance.now();n.stats.parsing.end=s,i&&(i.stats.parsing.end=s);const a=this.getLevelDetails(),o=a&&n.sn>a.endSN||this.shouldLoadParts(a,n.end);o!==this.loadingParts&&(this.log("LL-Part loading ".concat(o?"ON":"OFF"," after parsing segment ending @").concat(n.end.toFixed(2))),this.loadingParts=o),this.updateLevelTiming(n,i,r,t.partial)}shouldLoadParts(t,e){if(this.config.lowLatencyMode){if(!t)return this.loadingParts;if(t.partList){var n;const r=t.partList[0];if(r.fragment.type===Fu)return!1;if(e>=r.end+((null==(n=t.fragmentHint)?void 0:n.duration)||0)){var i;if((this.hls.hasEnoughToStart?(null==(i=this.media)?void 0:i.currentTime)||this.lastCurrentTime:this.getLoadPosition())>r.start-r.fragment.duration)return!0}}}return!1}getCurrentContext(t){const{levels:e,fragCurrent:n}=this,{level:i,sn:r,part:s}=t;if(null==e||!e[i])return this.warn("Levels object was unset while buffering fragment ".concat(r," of ").concat(this.playlistLabel()," ").concat(i,". The current chunk will not be buffered.")),null;const a=e[i],o=a.details,l=s>-1?Ap(o,r,s):null,c=l?l.fragment:Mp(o,r,n);return c?(n&&n!==c&&(c.stats=n.stats),{frag:c,part:l,level:a}):null}bufferFragmentData(t,e,n,i,r){if(this.state!==Yp)return;const{data1:s,data2:a}=t;let o=s;if(a&&(o=Ph(s,a)),!o.length)return;const l=this.initPTS[e.cc],c=l?-l.baseTime/l.timescale:void 0,u={type:t.type,frag:e,part:n,chunkMeta:i,offset:c,parent:e.type,data:o};if(this.hls.trigger(ku.BUFFER_APPENDING,u),t.dropped&&t.independent&&!n){if(r)return;this.flushBufferGap(e)}}flushBufferGap(t){const e=this.media;if(!e)return;if(!bf.isBuffered(e,e.currentTime))return void this.flushMainBuffer(0,t.start);const n=e.currentTime,i=bf.bufferInfo(e,n,0),r=t.duration,s=Math.min(2*this.config.maxFragLookUpTolerance,.25*r),a=Math.max(Math.min(t.start-s,i.end-s),n+s);t.start-a>s&&this.flushMainBuffer(a,t.start)}getFwdBufferInfo(t,e){var n;const i=this.getLoadPosition();if(!Tu(i))return null;const r=this.lastCurrentTime>i||null!=(n=this.media)&&n.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(t,i,e,r)}getFwdBufferInfoAtPos(t,e,n,i){const r=bf.bufferInfo(t,e,i);if(0===r.len&&void 0!==r.nextStart){const s=this.fragmentTracker.getBufferedFrag(e,n);if(s&&(r.nextStart<=s.end||s.gap)){const n=Math.max(Math.min(r.nextStart,s.end)-e,i);return bf.bufferInfo(t,e,n)}}return r}getMaxBufferLength(t){const{config:e}=this;let n;return n=t?Math.max(8*e.maxBufferSize/t,e.maxBufferLength):e.maxBufferLength,Math.min(n,e.maxMaxBufferLength)}reduceMaxBufferLength(t,e){const n=this.config,i=Math.max(Math.min(t-e,n.maxBufferLength),e),r=Math.max(t-3*e,n.maxMaxBufferLength/2,i);return r>=i&&(n.maxMaxBufferLength=r,this.warn("Reduce max buffer length to ".concat(r,"s")),!0)}getAppendedFrag(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ou;const n=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(t,e):null;return n&&"fragment"in n?n.fragment:n}getNextFragment(t,e){const n=e.fragments,i=n.length;if(!i)return null;const{config:r}=this,s=n[0].start,a=r.lowLatencyMode&&!!e.partList;let o=null;if(e.live){const n=r.initialLiveManifestSize;if(i<n)return this.warn("Not enough fragments to start playback (have: ".concat(i,", need: ").concat(n,")")),null;if(!e.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||t<s){var l;a&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),o=this.getInitialLiveFragment(e);const n=this.hls.startPosition,i=this.hls.liveSyncPosition,r=o?(-1!==n&&n>=s?n:i)||o.start:t;this.log("Setting startPosition to ".concat(r," to match start frag at live edge. mainStart: ").concat(n," liveSyncPosition: ").concat(i," frag.start: ").concat(null==(l=o)?void 0:l.start)),this.startPosition=this.nextLoadPosition=r}}else t<=s&&(o=n[0]);if(!o){const n=this.loadingParts?e.partEnd:e.fragmentEnd;o=this.getFragmentAtPosition(t,n,e)}let c=this.filterReplacedPrimary(o,e);if(!c&&o){const t=o.sn-e.startSN;c=this.filterReplacedPrimary(n[t+1]||null,e)}return this.mapToInitFragWhenRequired(c)}isLoopLoading(t,e){const n=this.fragmentTracker.getState(t);return(n===tf||n===$d&&!!t.gap)&&this.nextLoadPosition>e}getNextFragmentLoopLoading(t,e,n,i,r){let s=null;if(t.gap&&(s=this.getNextFragment(this.nextLoadPosition,e),s&&!s.gap&&n.nextStart)){const t=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i,0);if(null!==t&&n.len+t.len>=r){const t=s.sn;return this.loopSn!==t&&(this.log('buffer full after gaps in "'.concat(i,'" playlist starting at sn: ').concat(t)),this.loopSn=t),null}}return this.loopSn=void 0,s}get primaryPrefetch(){if($p(this.config)){var t;if(null==(t=this.hls.interstitialsManager)||null==(t=t.playingItem)?void 0:t.event)return!0}return!1}filterReplacedPrimary(t,e){if(!t)return t;if($p(this.config)&&t.type!==Fu){const n=this.hls.interstitialsManager,i=null==n?void 0:n.bufferingItem;if(i){const n=i.event;if(n){if(n.appendInPlace||Math.abs(t.start-i.start)>1||0===i.start)return null}else{if(t.end<=i.start&&!1===(null==e?void 0:e.live))return null;if(t.start>i.end&&i.nextEvent&&(i.nextEvent.appendInPlace||t.start-i.end>1))return null}}const r=null==n?void 0:n.playerQueue;if(r)for(let e=r.length;e--;){const n=r[e].interstitial;if(n.appendInPlace&&t.start>=n.startTime&&t.end<=n.resumeTime)return null}}return t}mapToInitFragWhenRequired(t){return null==t||!t.initSegment||t.initSegment.data||this.bitrateTest?t:t.initSegment}getNextPart(t,e,n){let i=-1,r=!1,s=!0;for(let a=0,o=t.length;a<o;a++){const o=t[a];if(s=s&&!o.independent,i>-1&&n<o.start)break;const l=o.loaded;l?i=-1:(r||(o.independent||s)&&o.fragment===e)&&(o.fragment!==e&&this.warn("Need buffer at ".concat(n," but next unloaded part starts at ").concat(o.start)),i=a),r=l}return i}loadedEndOfParts(t,e){let n;for(let i=t.length;i--;){if(n=t[i],!n.loaded)return!1;if(e>n.start)return!0}return!1}getInitialLiveFragment(t){const e=t.fragments,n=this.fragPrevious;let i=null;if(n){if(t.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: ".concat(n.programDateTime)),i=function(t,e,n){if(null===e||!Array.isArray(t)||!t.length||!Tu(e))return null;if(e<(t[0].programDateTime||0))return null;if(e>=(t[t.length-1].endProgramDateTime||0))return null;for(let i=0;i<t.length;++i){const r=t[i];if(Dd(e,n,r))return r}return null}(e,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const r=n.sn+1;if(r>=t.startSN&&r<=t.endSN){const s=e[r-t.startSN];n.cc===s.cc&&(i=s,this.log("Live playlist, switching playlist, load frag with next SN: ".concat(i.sn)))}i||(i=Pd(t,n.cc,n.end),i&&this.log("Live playlist, switching playlist, load frag with same CC: ".concat(i.sn)))}}else{const e=this.hls.liveSyncPosition;null!==e&&(i=this.getFragmentAtPosition(e,this.bitrateTest?t.fragmentEnd:t.edge,t))}return i}getFragmentAtPosition(t,e,n){const{config:i}=this;let{fragPrevious:r}=this,{fragments:s,endSN:a}=n;const{fragmentHint:o}=n,{maxFragLookUpTolerance:l}=i,c=n.partList,u=!!(this.loadingParts&&null!=c&&c.length&&o);let h;if(u&&!this.bitrateTest&&c[c.length-1].fragment.sn===o.sn&&(s=s.concat(o),a=o.sn),t<e){var d;h=kd(r,s,t,t<this.lastCurrentTime||t>e-l||null!=(d=this.media)&&d.paused||!this.startFragRequested?0:l)}else h=s[s.length-1];if(h){const t=h.sn-n.startSN,e=this.fragmentTracker.getState(h);if((e===tf||e===$d&&h.gap)&&(r=h),r&&h.sn===r.sn&&(!u||c[0].fragment.sn>h.sn||!n.live)){if(h.level===r.level){const e=s[t+1];h=h.sn<a&&this.fragmentTracker.getState(e)!==tf?e:null}}}return h}alignPlaylists(t,e,n){const i=t.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;const r=t.fragmentStart,s=!e,a=t.alignedSliding&&Tu(r);if(s||!a&&!r){!function(t,e){t&&(Op(e,t),e.alignedSliding||Np(e,t),e.alignedSliding||e.skippedSegments||wp(t,e,!1))}(n,t);const r=t.fragmentStart;return this.log("Live playlist sliding: ".concat(r.toFixed(2)," start-sn: ").concat(e?e.startSN:"na","->").concat(t.startSN," fragments: ").concat(i)),r}return r}waitForCdnTuneIn(t){return t.live&&t.canBlockReload&&t.partTarget&&t.tuneInGoal>Math.max(t.partHoldBack,3*t.partTarget)}setStartPosition(t,e){let n=this.startPosition;n<e&&(n=-1);const i=this.timelineOffset;if(-1===n){const r=null!==this.startTimeOffset,s=r?this.startTimeOffset:t.startTimeOffset;null!==s&&Tu(s)?(n=e+s,s<0&&(n+=t.edge),n=Math.min(Math.max(e,n),e+t.totalduration),this.log("Setting startPosition to ".concat(n," for start time offset ").concat(s," found in ").concat(r?"multivariant":"media"," playlist")),this.startPosition=n):t.live?(n=this.hls.liveSyncPosition||e,this.log("Setting startPosition to -1 to start at live edge ".concat(n)),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=n=0),this.lastCurrentTime=n+i}this.nextLoadPosition=n+i}getLoadPosition(){var t;const{media:e}=this;let n=0;return null!=(t=this.hls)&&t.hasEnoughToStart&&e?n=e.currentTime:this.nextLoadPosition>=0&&(n=this.nextLoadPosition),n}handleFragLoadAborted(t,e){this.transmuxer&&t.type===this.playlistType&&hh(t)&&t.stats.aborted&&(this.log("Fragment ".concat(t.sn).concat(e?" part "+e.index:""," of ").concat(this.playlistLabel()," ").concat(t.level," was aborted")),this.resetFragmentLoading(t))}resetFragmentLoading(t){this.fragCurrent&&(this.fragContextChanged(t)||this.state===jp)||(this.state=Hp)}onFragmentOrKeyLoadError(t,e){var n;if(e.chunkMeta&&!e.frag){const t=this.getCurrentContext(e.chunkMeta);t&&(e.frag=t.frag)}const i=e.frag;if(!i||i.type!==t||!this.levels)return;var r;if(this.fragContextChanged(i))return void this.warn("Frag load error must match current frag to retry ".concat(i.url," > ").concat(null==(r=this.fragCurrent)?void 0:r.url));const s=e.details===Ru.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(i,!0);const a=e.errorAction;if(!a)return void(this.state=qp);const{action:o,flags:l,retryCount:c=0,retryConfig:u}=a,h=!!u,d=h&&o===Wd,f=h&&!a.resolved&&l===Xd,p=null==(n=this.hls.latestLevelDetails)?void 0:n.live;if(!d&&f&&hh(i)&&!i.endList&&p&&!Nd(e))this.resetFragmentErrors(t),this.treatAsGap(i),a.resolved=!0;else if((d||f)&&c<u.maxNumRetry){var m;const n=Hd(null==(m=e.response)?void 0:m.code),r=Ud(u,c);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+r,this.state=jp,a.resolved=!0,n)return this.log("Waiting for connection (offline)"),this.retryDate=1/0,void(e.reason="offline");this.warn("Fragment ".concat(i.sn," of ").concat(t," ").concat(i.level," errored with ").concat(e.details,", retrying loading ").concat(c+1,"/").concat(u.maxNumRetry," in ").concat(r,"ms"))}else if(u){if(this.resetFragmentErrors(t),!(c<u.maxNumRetry))return void this.warn("".concat(e.details," reached or exceeded max retry (").concat(c,")"));s||o===jd||(a.resolved=!0)}else this.state=o===Gd?Zp:qp;this.tickImmediate()}checkRetryDate(){const t=self.performance.now(),e=this.retryDate,n=e===1/0;(!e||t>=e||n&&!Hd(0))&&(n&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=Hp)}reduceLengthAndFlushBuffer(t){if(this.state===Yp||this.state===Xp){const e=t.frag,n=t.parent,i=this.getFwdBufferInfo(this.mediaBuffer,n),r=i&&i.len>.5;r&&this.reduceMaxBufferLength(i.len,(null==e?void 0:e.duration)||10);const s=!r;return s&&this.warn("Buffer full error while media.currentTime (".concat(this.getLoadPosition(),") is not buffered, flush ").concat(n," buffer")),e&&(this.fragmentTracker.removeFragment(e),this.nextLoadPosition=e.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(t){t===Nu&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==zp&&(this.state=Hp)}afterBufferFlushed(t,e,n){if(!t)return;const i=bf.getBuffered(t);this.fragmentTracker.detectEvictedFragments(e,i,n),this.state===Kp&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==zp&&(this.state=Hp)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=this.levelLastLoaded,e=t?t.details:null;null!=e&&e.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(e,e.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(t){this.log("Loading context changed while buffering sn ".concat(t.sn," of ").concat(this.playlistLabel()," ").concat(-1===t.level?"<removed>":t.level,". This chunk will not be buffered.")),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.fragmentTracker.removeFragmentsInRange(t,1/0,this.playlistType,!1,!0)}updateLevelTiming(t,e,n,i){const r=n.details;if(!r)return void this.warn("level.details undefined");if(!Object.keys(t.elementaryStreams).reduce((e,s)=>{const a=t.elementaryStreams[s];if(a){const o=a.endPTS-a.startPTS;if(o<=0)return this.warn("Could not parse fragment ".concat(t.sn," ").concat(s," duration reliably (").concat(o,")")),e||!1;const l=i?0:bp(r,t,a.startPTS,a.endPTS,a.startDTS,a.endDTS,this);return this.hls.trigger(ku.LEVEL_PTS_UPDATED,{details:r,level:n,drift:l,type:s,frag:t,start:a.startPTS,end:a.endPTS}),!0}return e},!1)){var s;const e=null===(null==(s=this.transmuxer)?void 0:s.error);if((0===n.fragmentError||e&&(n.fragmentError<2||t.endList))&&this.treatAsGap(t,n),e){const e=new Error("Found no media in fragment ".concat(t.sn," of ").concat(this.playlistLabel()," ").concat(t.level," resetting transmuxer to fallback to playlist timing"));if(this.warn(e.message),this.hls.trigger(ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.FRAG_PARSING_ERROR,fatal:!1,error:e,frag:t,reason:"Found no media in msn ".concat(t.sn," of ").concat(this.playlistLabel(),' "').concat(n.url,'"')}),!this.hls)return;this.resetTransmuxer()}}this.state=Xp,this.log("Parsed ".concat(t.type," sn: ").concat(t.sn).concat(e?" part: "+e.index:""," of ").concat(this.fragInfo(t,!1,e),")")),this.hls.trigger(ku.FRAG_PARSED,{frag:t,part:e})}playlistLabel(){return this.playlistType===Ou?"level":"track"}fragInfo(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;var i,r;return"".concat(this.playlistLabel()," ").concat(t.level," (").concat(n?"part":"frag",":[").concat((null!=(i=e&&!n?t.startPTS:(n||t).start)?i:NaN).toFixed(3),"-").concat((null!=(r=e&&!n?t.endPTS:(n||t).end)?r:NaN).toFixed(3),"]").concat(n&&"main"===t.type?"INDEPENDENT="+(n.independent?"YES":"NO"):"")}treatAsGap(t,e){e&&e.fragmentError++,t.gap=!0,this.fragmentTracker.removeFragment(t),this.fragmentTracker.fragBuffered(t,!0)}resetTransmuxer(){var t;null==(t=this.transmuxer)||t.reset()}recoverWorkerError(t){"demuxerWorker"===t.event&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(t){const e=this._state;e!==t&&(this._state=t,this.log("".concat(e,"->").concat(t)))}get state(){return this._state}}function $p(t){return!!t.interstitialsController&&!1!==t.enableInterstitialPlayback}class tm{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){const{chunks:t,dataLength:e}=this;let n;return t.length?(n=1===t.length?t[0]:function(t,e){const n=new Uint8Array(e);let i=0;for(let r=0;r<t.length;r++){const e=t[r];n.set(e,i),i+=e.length}return n}(t,e),this.reset(),n):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}var em,nm={exports:{}};var im=(em||(em=1,function(t){var e=Object.prototype.hasOwnProperty,n="~";function i(){}function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(t,e,i,s,a){if("function"!==typeof i)throw new TypeError("The listener must be a function");var o=new r(i,s||t,a),l=n?n+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],o]:t._events[l].push(o):(t._events[l]=o,t._eventsCount++),t}function a(t,e){0===--t._eventsCount?t._events=new i:delete t._events[e]}function o(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),o.prototype.eventNames=function(){var t,i,r=[];if(0===this._eventsCount)return r;for(i in t=this._events)e.call(t,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},o.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,a=new Array(s);r<s;r++)a[r]=i[r].fn;return a},o.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},o.prototype.emit=function(t,e,i,r,s,a){var o=n?n+t:t;if(!this._events[o])return!1;var l,c,u=this._events[o],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,r),!0;case 5:return u.fn.call(u.context,e,i,r,s),!0;case 6:return u.fn.call(u.context,e,i,r,s,a),!0}for(c=1,l=new Array(h-1);c<h;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var d,f=u.length;for(c=0;c<f;c++)switch(u[c].once&&this.removeListener(t,u[c].fn,void 0,!0),h){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,e);break;case 3:u[c].fn.call(u[c].context,e,i);break;case 4:u[c].fn.call(u[c].context,e,i,r);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];u[c].fn.apply(u[c].context,l)}}return!0},o.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},o.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},o.prototype.removeListener=function(t,e,i,r){var s=n?n+t:t;if(!this._events[s])return this;if(!e)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==e||r&&!o.once||i&&o.context!==i||a(this,s);else{for(var l=0,c=[],u=o.length;l<u;l++)(o[l].fn!==e||r&&!o[l].once||i&&o[l].context!==i)&&c.push(o[l]);c.length?this._events[s]=1===c.length?c[0]:c:a(this,s)}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&a(this,e)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o}(nm)),nm.exports),rm=nh(im);const sm="1.6.15",am={};function om(t,e){return e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128}function lm(t,e){return e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128}function cm(t,e){let n=0;return n=(127&t[e])<<21,n|=(127&t[e+1])<<14,n|=(127&t[e+2])<<7,n|=127&t[e+3],n}function um(t,e){const n=e;let i=0;for(;lm(t,e);){i+=10;i+=cm(t,e+6),om(t,e+10)&&(i+=10),e+=i}if(i>0)return t.subarray(n,n+i)}function hm(t,e){return 255===t[e]&&240===(246&t[e+1])}function dm(t,e){return 1&t[e+1]?7:9}function fm(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function pm(t,e){return e+1<t.length&&hm(t,e)}function mm(t,e){if(pm(t,e)){const n=dm(t,e);if(e+n>=t.length)return!1;const i=fm(t,e);if(i<=n)return!1;const r=e+i;return r===t.length||pm(t,r)}return!1}function gm(t,e,n,i,r){if(!t.samplerate){const s=function(t,e,n,i){const r=e[n+2],s=r>>2&15;if(s>12){const e=new Error("invalid ADTS sampling index:".concat(s));return void t.emit(ku.ERROR,ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.FRAG_PARSING_ERROR,fatal:!0,error:e,reason:e.message})}const a=1+(r>>6&3),o=e[n+3]>>6&3|(1&r)<<2,l="mp4a.40."+a,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][s];let u=s;5!==a&&29!==a||(u-=3);const h=[a<<3|(14&u)>>1,(1&u)<<7|o<<3];return Qu.log("manifest codec:".concat(i,", parsed codec:").concat(l,", channels:").concat(o,", rate:").concat(c," (ADTS object type:").concat(a," sampling index:").concat(s,")")),{config:h,samplerate:c,channelCount:o,codec:l,parsedCodec:l,manifestCodec:i}}(e,n,i,r);if(!s)return;Hu(t,s)}}function vm(t){return 9216e4/t}function ym(t,e,n,i,r){const s=i+r*vm(t.samplerate),a=function(t,e){const n=dm(t,e);if(e+n<=t.length){const i=fm(t,e)-n;if(i>0)return{headerLength:n,frameLength:i}}}(e,n);let o;if(a){const{frameLength:i,headerLength:r}=a,l=r+i,c=Math.max(0,n+l-e.length);c?(o=new Uint8Array(l-r),o.set(e.subarray(n+r,e.length),0)):o=e.subarray(n+r,n+l);const u={unit:o,pts:s};return c||t.samples.push(u),{sample:u,length:l,missing:c}}const l=e.length-n;o=new Uint8Array(l),o.set(e.subarray(n,e.length),0);return{sample:{unit:o,pts:s},length:l,missing:-1}}function _m(t,e){return lm(t,e)&&cm(t,e+6)+10<=t.length-e}function bm(t){return function(t,e,n,i){const r=function(t){return t instanceof ArrayBuffer?t:t.buffer}(t);let s=1;"BYTES_PER_ELEMENT"in i&&(s=i.BYTES_PER_ELEMENT);const a=(h=t,h&&h.buffer instanceof ArrayBuffer&&void 0!==h.byteLength&&void 0!==h.byteOffset?t.byteOffset:0),o=(a+t.byteLength)/s,l=(a+e)/s,c=Math.floor(Math.max(0,Math.min(l,o))),u=Math.floor(Math.min(c+Math.max(n,0),o));var h;return new i(r,c,u-c)}(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,Uint8Array)}function xm(t){const e={key:t.type,description:"",data:"",mimeType:null,pictureType:null};if(t.size<2)return;if(3!==t.data[0])return void console.log("Ignore frame with unrecognized character encoding");const n=t.data.subarray(1).indexOf(0);if(-1===n)return;const i=$u(bm(t.data,1,n)),r=t.data[2+n],s=t.data.subarray(3+n).indexOf(0);if(-1===s)return;const a=$u(bm(t.data,3+n,s));let o;return o="--\x3e"===i?$u(bm(t.data,4+n+s)):function(t){return t instanceof ArrayBuffer?t:0==t.byteOffset&&t.byteLength==t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer}(t.data.subarray(4+n+s)),e.mimeType=i,e.pictureType=r,e.description=a,e.data=o,e}function Em(t){return"PRIV"===t.type?function(t){if(t.size<2)return;const e=$u(t.data,!0),n=new Uint8Array(t.data.subarray(e.length+1));return{key:t.type,info:e,data:n.buffer}}(t):"W"===t.type[0]?function(t){if("WXXX"===t.type){if(t.size<2)return;let e=1;const n=$u(t.data.subarray(e),!0);e+=n.length+1;const i=$u(t.data.subarray(e));return{key:t.type,info:n,data:i}}const e=$u(t.data);return{key:t.type,info:"",data:e}}(t):"APIC"===t.type?xm(t):function(t){if(t.size<2)return;if("TXXX"===t.type){let e=1;const n=$u(t.data.subarray(e),!0);e+=n.length+1;const i=$u(t.data.subarray(e));return{key:t.type,info:n,data:i}}const e=$u(t.data.subarray(1));return{key:t.type,info:"",data:e}}(t)}function wm(t){const e=String.fromCharCode(t[0],t[1],t[2],t[3]),n=cm(t,4);return{type:e,size:n,data:t.subarray(10,10+n)}}function Sm(t){let e=0;const n=[];for(;lm(t,e);){const i=cm(t,e+6);t[e+5]>>6&1&&(e+=10),e+=10;const r=e+i;for(;e+10<r;){const i=wm(t.subarray(e)),r=Em(i);r&&n.push(r),e+=i.size+10}om(t,e)&&(e+=10)}return n}function Tm(t){return t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info}function Mm(t){if(8===t.data.byteLength){const e=new Uint8Array(t.data),n=1&e[3];let i=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return i/=45,n&&(i+=47721858.84),Math.round(i)}}function Am(t){const e=Sm(t);for(let n=0;n<e.length;n++){const t=e[n];if(Tm(t))return Mm(t)}}let Cm=function(t){return t.audioId3="org.id3",t.dateRange="com.apple.quicktime.HLS",t.emsg="https://aomedia.org/emsg/ID3",t.misbklv="urn:misb:KLV:bin:1910.1",t}({});function Rm(){return{type:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",id:-1,pid:-1,inputTimeScale:arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4,sequenceNumber:-1,samples:[],dropped:0}}class km{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(t,e,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(t){this.initPTS=t,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(t,e){return!1}appendFrame(t,e,n){}demux(t,e){this.cachedData&&(t=Ph(this.cachedData,t),this.cachedData=null);let n,i=um(t,0),r=i?i.length:0;const s=this._audioTrack,a=this._id3Track,o=i?Am(i):void 0,l=t.length;for((null===this.basePTS||0===this.frameIndex&&Tu(o))&&(this.basePTS=Lm(o,e,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),i&&i.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Cm.audioId3,duration:Number.POSITIVE_INFINITY});r<l;){if(this.canParse(t,r)){const e=this.appendFrame(s,t,r);e?(this.frameIndex++,this.lastPTS=e.sample.pts,r+=e.length,n=r):r=l}else _m(t,r)?(i=um(t,r),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Cm.audioId3,duration:Number.POSITIVE_INFINITY}),r+=i.length,n=r):r++;if(r===l&&n!==l){const e=t.slice(n);this.cachedData?this.cachedData=Ph(this.cachedData,e):this.cachedData=e}}return{audioTrack:s,videoTrack:Rm(),id3Track:a,textTrack:Rm()}}demuxSampleAes(t,e,n){return Promise.reject(new Error("[".concat(this,"] This demuxer does not support Sample-AES decryption")))}flush(t){const e=this.cachedData;return e&&(this.cachedData=null,this.demux(e,0)),{audioTrack:this._audioTrack,videoTrack:Rm(),id3Track:this._id3Track,textTrack:Rm()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const Lm=(t,e,n)=>{if(Tu(t))return 90*t;return 9e4*e+(n?9e4*n.baseTime/n.timescale:0)};let Dm=null;const Pm=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Im=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Om=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Nm=[0,1,1,4];function Fm(t,e,n,i,r){if(n+24>e.length)return;const s=Um(e,n);if(s&&n+s.frameLength<=e.length){const a=i+r*(9e4*s.samplesPerFrame/s.sampleRate),o={unit:e.subarray(n,n+s.frameLength),pts:a,dts:a};return t.config=[],t.channelCount=s.channelCount,t.samplerate=s.sampleRate,t.samples.push(o),{sample:o,length:s.frameLength,missing:0}}}function Um(t,e){const n=t[e+1]>>3&3,i=t[e+1]>>1&3,r=t[e+2]>>4&15,s=t[e+2]>>2&3;if(1!==n&&0!==r&&15!==r&&3!==s){const a=t[e+2]>>1&1,o=t[e+3]>>6,l=1e3*Pm[14*(3===n?3-i:3===i?3:4)+r-1],c=Im[3*(3===n?0:2===n?1:2)+s],u=3===o?1:2,h=Om[n][i],d=Nm[i],f=8*h*d,p=Math.floor(h*l/c+a)*d;if(null===Dm){const t=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Dm=t?parseInt(t[1]):0}return!!Dm&&Dm<=87&&2===i&&l>=224e3&&0===o&&(t[e+3]=128|t[e+3]),{sampleRate:c,channelCount:u,frameLength:p,samplesPerFrame:f}}}function Bm(t,e){return 255===t[e]&&224===(224&t[e+1])&&0!==(6&t[e+1])}function zm(t,e){return e+1<t.length&&Bm(t,e)}function Hm(t,e){if(e+1<t.length&&Bm(t,e)){const n=4,i=Um(t,e);let r=n;null!=i&&i.frameLength&&(r=i.frameLength);const s=e+r;return s===t.length||zm(t,s)}return!1}const Vm=(t,e)=>{let n=0,i=5;e+=i;const r=new Uint32Array(1),s=new Uint32Array(1),a=new Uint8Array(1);for(;i>0;){a[0]=t[e];const o=Math.min(i,8),l=8-o;s[0]=4278190080>>>24+l<<l,r[0]=(a[0]&s[0])>>l,n=n?n<<o|r[0]:r[0],e+=1,i-=o}return n};class Gm extends km{constructor(t){super(),this.observer=void 0,this.observer=t}resetInitSegment(t,e,n,i){super.resetInitSegment(t,e,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:e,duration:i,inputTimeScale:9e4,dropped:0}}canParse(t,e){return e+64<t.length}appendFrame(t,e,n){const i=jm(t,e,n,this.basePTS,this.frameIndex);if(-1!==i){return{sample:t.samples[t.samples.length-1],length:i,missing:0}}}static probe(t){if(!t)return!1;const e=um(t,0);if(!e)return!1;const n=e.length;return 11===t[n]&&119===t[n+1]&&void 0!==Am(e)&&Vm(t,n)<16}}function jm(t,e,n,i,r){if(n+8>e.length)return-1;if(11!==e[n]||119!==e[n+1])return-1;const s=e[n+4]>>6;if(s>=3)return-1;const a=[48e3,44100,32e3][s],o=63&e[n+4],l=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*o+s];if(n+l>e.length)return-1;const c=e[n+6]>>5;let u=0;2===c?u+=2:(1&c&&1!==c&&(u+=2),4&c&&(u+=2));const h=(e[n+6]<<8|e[n+7])>>12-u&1,d=[2,1,2,3,3,4,4,5][c]+h,f=e[n+5]>>3,p=7&e[n+5],m=new Uint8Array([s<<6|f<<1|p>>2,(3&p)<<6|c<<3|h<<2|o>>4,o<<4&224]),g=i+r*(1536/a*9e4),v=e.subarray(n,n+l);return t.config=m,t.channelCount=d,t.samplerate=a,t.samples.push({unit:v,pts:g}),l}const Wm=/\/emsg[-/]ID3/i;function Ym(t,e){return Tu(t.presentationTime)?t.presentationTime/t.timeScale:e+t.presentationTimeDelta/t.timeScale}class Xm{constructor(t,e,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new hf(e,{removePKCS7Padding:!1})}decryptBuffer(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer,af)}decryptAacSample(t,e,n){const i=t[e].unit;if(i.length<=16)return;const r=i.subarray(16,i.length-i.length%16),s=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(s).then(r=>{const s=new Uint8Array(r);i.set(s,16),this.decrypter.isSync()||this.decryptAacSamples(t,e+1,n)}).catch(n)}decryptAacSamples(t,e,n){for(;;e++){if(e>=t.length)return void n();if(!(t[e].unit.length<32)&&(this.decryptAacSample(t,e,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(t){const e=16*Math.floor((t.length-48)/160)+16,n=new Int8Array(e);let i=0;for(let r=32;r<t.length-16;r+=160,i+=16)n.set(t.subarray(r,r+16),i);return n}getAvcDecryptedUnit(t,e){const n=new Uint8Array(e);let i=0;for(let r=32;r<t.length-16;r+=160,i+=16)t.set(n.subarray(i,i+16),r);return t}decryptAvcSample(t,e,n,i,r){const s=Uh(r.data),a=this.getAvcEncryptedData(s);this.decryptBuffer(a.buffer).then(a=>{r.data=this.getAvcDecryptedUnit(s,a),this.decrypter.isSync()||this.decryptAvcSamples(t,e,n+1,i)}).catch(i)}decryptAvcSamples(t,e,n,i){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;e++,n=0){if(e>=t.length)return void i();const r=t[e].units;for(;!(n>=r.length);n++){const s=r[n];if(!(s.data.length<=48||1!==s.type&&5!==s.type)&&(this.decryptAvcSample(t,e,n,i,s),!this.decrypter.isSync()))return}}}}class Km{constructor(){this.VideoSample=null}createVideoSample(t,e,n){return{key:t,frame:!1,pts:e,dts:n,units:[],length:0}}getLastNalUnit(t){var e;let n,i=this.VideoSample;if(i&&0!==i.units.length||(i=t[t.length-1]),null!=(e=i)&&e.units){const t=i.units;n=t[t.length-1]}return n}pushAccessUnit(t,e){if(t.units.length&&t.frame){if(void 0===t.pts){const n=e.samples,i=n.length;if(!i)return void e.dropped++;{const e=n[i-1];t.pts=e.pts,t.dts=e.dts}}e.samples.push(t)}}parseNALu(t,e,n){const i=e.byteLength;let r=t.naluState||0;const s=r,a=[];let o,l,c,u=0,h=-1,d=0;for(-1===r&&(h=0,d=this.getNALuType(e,0),r=0,u=1);u<i;)if(o=e[u++],r)if(1!==r)if(o)if(1===o){if(l=u-r-1,h>=0){const t={data:e.subarray(h,l),type:d};a.push(t)}else{const n=this.getLastNalUnit(t.samples);n&&(s&&u<=4-s&&n.state&&(n.data=n.data.subarray(0,n.data.byteLength-s)),l>0&&(n.data=Ph(n.data,e.subarray(0,l)),n.state=0))}u<i?(c=this.getNALuType(e,u),h=u,d=c,r=0):r=-1}else r=0;else r=3;else r=o?0:2;else r=o?0:1;if(h>=0&&r>=0){const t={data:e.subarray(h,i),type:d,state:r};a.push(t)}if(0===a.length){const n=this.getLastNalUnit(t.samples);n&&(n.data=Ph(n.data,e))}return t.naluState=r,a}}class qm{constructor(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const t=this.data,e=this.bytesAvailable,n=t.byteLength-e,i=new Uint8Array(4),r=Math.min(4,e);if(0===r)throw new Error("no bytes available");i.set(t.subarray(n,n+r)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r}skipBits(t){let e;t=Math.min(t,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(e=(t-=this.bitsAvailable)>>3,t-=e<<3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)}readBits(t){let e=Math.min(this.bitsAvailable,t);const n=this.word>>>32-e;if(t>32&&Qu.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0)this.word<<=e;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return e=t-e,e>0&&this.bitsAvailable?n<<e|this.readBits(e):n}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if(0!==(this.word&2147483648>>>t))return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const t=this.skipLZ();return this.readBits(t+1)-1}readEG(){const t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class Qm extends Km{parsePES(t,e,n,i){const r=this.parseNALu(t,n.data,i);let s,a=this.VideoSample,o=!1;n.data=null,a&&r.length&&!t.audFound&&(this.pushAccessUnit(a,t),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),r.forEach(i=>{var r,l;switch(i.type){case 1:{let e=!1;s=!0;const r=i.data;if(o&&r.length>4){const t=this.readSliceType(r);2!==t&&4!==t&&7!==t&&9!==t||(e=!0)}var c;if(e)null!=(c=a)&&c.frame&&!a.key&&(this.pushAccessUnit(a,t),a=this.VideoSample=null);a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.frame=!0,a.key=e;break}case 5:s=!0,null!=(r=a)&&r.frame&&!a.key&&(this.pushAccessUnit(a,t),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 6:s=!0,Fh(i.data,1,n.pts,e.samples);break;case 7:{var u,h;s=!0,o=!0;const e=i.data,n=this.readSPS(e);if(!t.sps||t.width!==n.width||t.height!==n.height||(null==(u=t.pixelRatio)?void 0:u[0])!==n.pixelRatio[0]||(null==(h=t.pixelRatio)?void 0:h[1])!==n.pixelRatio[1]){t.width=n.width,t.height=n.height,t.pixelRatio=n.pixelRatio,t.sps=[e];const i=e.subarray(1,4);let r="avc1.";for(let t=0;t<3;t++){let e=i[t].toString(16);e.length<2&&(e="0"+e),r+=e}t.codec=r}break}case 8:s=!0,t.pps=[i.data];break;case 9:s=!0,t.audFound=!0,null!=(l=a)&&l.frame&&(this.pushAccessUnit(a,t),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;case 12:s=!0;break;default:s=!1}if(a&&s){a.units.push(i)}}),i&&a&&(this.pushAccessUnit(a,t),this.VideoSample=null)}getNALuType(t,e){return 31&t[e]}readSliceType(t){const e=new qm(t);return e.readUByte(),e.readUEG(),e.readUEG()}skipScalingList(t,e){let n,i=8,r=8;for(let s=0;s<t;s++)0!==r&&(n=e.readEG(),r=(i+n+256)%256),i=0===r?i:r}readSPS(t){const e=new qm(t);let n,i,r,s=0,a=0,o=0,l=0;const c=e.readUByte.bind(e),u=e.readBits.bind(e),h=e.readUEG.bind(e),d=e.readBoolean.bind(e),f=e.skipBits.bind(e),p=e.skipEG.bind(e),m=e.skipUEG.bind(e),g=this.skipScalingList.bind(this);c();const v=c();if(u(5),f(3),c(),m(),100===v||110===v||122===v||244===v||44===v||83===v||86===v||118===v||128===v){const t=h();if(3===t&&f(1),m(),m(),f(1),d())for(i=3!==t?8:12,r=0;r<i;r++)d()&&g(r<6?16:64,e)}m();const y=h();if(0===y)h();else if(1===y)for(f(1),p(),p(),n=h(),r=0;r<n;r++)p();m(),f(1);const _=h(),b=h(),x=u(1);0===x&&f(1),f(1),d()&&(s=h(),a=h(),o=h(),l=h());let E=[1,1];if(d()&&d()){switch(c()){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:E=[c()<<8|c(),c()<<8|c()]}}return{width:Math.ceil(16*(_+1)-2*s-2*a),height:(2-x)*(b+1)*16-(x?2:4)*(o+l),pixelRatio:E}}}class Zm extends Km{constructor(){super(...arguments),this.initVPS=null}parsePES(t,e,n,i){const r=this.parseNALu(t,n.data,i);let s,a=this.VideoSample,o=!1;n.data=null,a&&r.length&&!t.audFound&&(this.pushAccessUnit(a,t),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),r.forEach(i=>{var r,l;switch(i.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),a.frame=!0,s=!0;break;case 16:case 17:case 18:case 21:var c;if(s=!0,o)null!=(c=a)&&c.frame&&!a.key&&(this.pushAccessUnit(a,t),a=this.VideoSample=null);a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:s=!0,null!=(r=a)&&r.frame&&!a.key&&(this.pushAccessUnit(a,t),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 39:s=!0,Fh(i.data,2,n.pts,e.samples);break;case 32:s=!0,t.vps||("object"!==typeof t.params&&(t.params={}),t.params=Hu(t.params,this.readVPS(i.data)),this.initVPS=i.data),t.vps=[i.data];break;case 33:if(s=!0,o=!0,void 0===t.vps||t.vps[0]===this.initVPS||void 0===t.sps||this.matchSPS(t.sps[0],i.data)||(this.initVPS=t.vps[0],t.sps=t.pps=void 0),!t.sps){const e=this.readSPS(i.data);t.width=e.width,t.height=e.height,t.pixelRatio=e.pixelRatio,t.codec=e.codecString,t.sps=[],"object"!==typeof t.params&&(t.params={});for(const n in e.params)t.params[n]=e.params[n]}this.pushParameterSet(t.sps,i.data,t.vps),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0;break;case 34:if(s=!0,"object"===typeof t.params){if(!t.pps){t.pps=[];const e=this.readPPS(i.data);for(const n in e)t.params[n]=e[n]}this.pushParameterSet(t.pps,i.data,t.vps)}break;case 35:s=!0,t.audFound=!0,null!=(l=a)&&l.frame&&(this.pushAccessUnit(a,t),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;default:s=!1}if(a&&s){a.units.push(i)}}),i&&a&&(this.pushAccessUnit(a,t),this.VideoSample=null)}pushParameterSet(t,e,n){(n&&n[0]===this.initVPS||!n&&!t.length)&&t.push(e)}getNALuType(t,e){return(126&t[e])>>>1}ebsp2rbsp(t){const e=new Uint8Array(t.byteLength);let n=0;for(let i=0;i<t.byteLength;i++)i>=2&&3===t[i]&&0===t[i-1]&&0===t[i-2]||(e[n]=t[i],n++);return new Uint8Array(e.buffer,0,n)}pushAccessUnit(t,e){super.pushAccessUnit(t,e),this.initVPS&&(this.initVPS=null)}readVPS(t){const e=new qm(t);e.readUByte(),e.readUByte(),e.readBits(4),e.skipBits(2),e.readBits(6);return{numTemporalLayers:e.readBits(3)+1,temporalIdNested:e.readBoolean()}}readSPS(t){const e=new qm(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.readBits(4);const n=e.readBits(3);e.readBoolean();const i=e.readBits(2),r=e.readBoolean(),s=e.readBits(5),a=e.readUByte(),o=e.readUByte(),l=e.readUByte(),c=e.readUByte(),u=e.readUByte(),h=e.readUByte(),d=e.readUByte(),f=e.readUByte(),p=e.readUByte(),m=e.readUByte(),g=e.readUByte(),v=[],y=[];for(let Y=0;Y<n;Y++)v.push(e.readBoolean()),y.push(e.readBoolean());if(n>0)for(let Y=n;Y<8;Y++)e.readBits(2);for(let Y=0;Y<n;Y++)v[Y]&&(e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte()),y[Y]&&e.readUByte();e.readUEG();const _=e.readUEG();3==_&&e.skipBits(1);const b=e.readUEG(),x=e.readUEG(),E=e.readBoolean();let w=0,S=0,T=0,M=0;E&&(w+=e.readUEG(),S+=e.readUEG(),T+=e.readUEG(),M+=e.readUEG());const A=e.readUEG(),C=e.readUEG(),R=e.readUEG();for(let Y=e.readBoolean()?0:n;Y<=n;Y++)e.skipUEG(),e.skipUEG(),e.skipUEG();e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG();if(e.readBoolean()){if(e.readBoolean())for(let t=0;t<4;t++)for(let n=0;n<(3===t?2:6);n++){if(e.readBoolean()){const n=Math.min(64,1<<4+(t<<1));t>1&&e.readEG();for(let t=0;t<n;t++)e.readEG()}else e.readUEG()}}e.readBoolean(),e.readBoolean();e.readBoolean()&&(e.readUByte(),e.skipUEG(),e.skipUEG(),e.readBoolean());const k=e.readUEG();let L=0;for(let Y=0;Y<k;Y++){let t=!1;if(0!==Y&&(t=e.readBoolean()),t){Y===k&&e.readUEG(),e.readBoolean(),e.readUEG();let t=0;for(let n=0;n<=L;n++){const n=e.readBoolean();let i=!1;n||(i=e.readBoolean()),(n||i)&&t++}L=t}else{const t=e.readUEG(),n=e.readUEG();L=t+n;for(let i=0;i<t;i++)e.readUEG(),e.readBoolean();for(let i=0;i<n;i++)e.readUEG(),e.readBoolean()}}if(e.readBoolean()){const t=e.readUEG();for(let n=0;n<t;n++){for(let t=0;t<R+4;t++)e.readBits(1);e.readBits(1)}}let D=0,P=1,I=1,O=!0,N=1,F=0;e.readBoolean(),e.readBoolean();let U=!1;if(e.readBoolean()){if(e.readBoolean()){const t=e.readUByte();t>0&&t<16?(P=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][t-1],I=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][t-1]):255===t&&(P=e.readBits(16),I=e.readBits(16))}e.readBoolean()&&e.readBoolean();if(e.readBoolean()){e.readBits(3),e.readBoolean();e.readBoolean()&&(e.readUByte(),e.readUByte(),e.readUByte())}e.readBoolean()&&(e.readUEG(),e.readUEG()),e.readBoolean(),e.readBoolean(),e.readBoolean(),U=e.readBoolean(),U&&(e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG());if(e.readBoolean()){N=e.readBits(32),F=e.readBits(32);e.readBoolean()&&e.readUEG();if(e.readBoolean()){const t=e.readBoolean(),i=e.readBoolean();let r=!1;(t||i)&&(r=e.readBoolean(),r&&(e.readUByte(),e.readBits(5),e.readBoolean(),e.readBits(5)),e.readBits(4),e.readBits(4),r&&e.readBits(4),e.readBits(5),e.readBits(5),e.readBits(5));for(let s=0;s<=n;s++){O=e.readBoolean();let n=!1;O||e.readBoolean()?e.readEG():n=e.readBoolean();const s=n?1:e.readUEG()+1;if(t)for(let t=0;t<s;t++)e.readUEG(),e.readUEG(),r&&(e.readUEG(),e.readUEG()),e.skipBits(1);if(i)for(let t=0;t<s;t++)e.readUEG(),e.readUEG(),r&&(e.readUEG(),e.readUEG()),e.skipBits(1)}}}e.readBoolean()&&(e.readBoolean(),e.readBoolean(),e.readBoolean(),D=e.readUEG())}let B=b,z=x;if(E){let t=1,e=1;1===_?t=e=2:2==_&&(t=2),B=b-t*S-t*w,z=x-e*M-e*T}const H=i?["A","B","C"][i]:"",V=a<<24|o<<16|l<<8|c;let G=0;for(let Y=0;Y<32;Y++)G=(G|(V>>Y&1)<<31-Y)>>>0;let j=G.toString(16);1===s&&"2"===j&&(j="6");const W=r?"H":"L";return{codecString:"hvc1.".concat(H).concat(s,".").concat(j,".").concat(W).concat(g,".B0"),params:{general_tier_flag:r,general_profile_idc:s,general_profile_space:i,general_profile_compatibility_flags:[a,o,l,c],general_constraint_indicator_flags:[u,h,d,f,p,m],general_level_idc:g,bit_depth:A+8,bit_depth_luma_minus8:A,bit_depth_chroma_minus8:C,min_spatial_segmentation_idc:D,chroma_format_idc:_,frame_rate:{fixed:O,fps:F/N}},width:B,height:z,pixelRatio:[P,I]}}readPPS(t){const e=new qm(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.skipUEG(),e.skipUEG(),e.skipBits(2),e.skipBits(3),e.skipBits(2),e.skipUEG(),e.skipUEG(),e.skipEG(),e.skipBits(2);e.readBoolean()&&e.skipUEG(),e.skipEG(),e.skipEG(),e.skipBits(4);const n=e.readBoolean(),i=e.readBoolean();let r=1;return i&&n?r=0:i?r=3:n&&(r=2),{parallelismType:r}}matchSPS(t,e){return String.fromCharCode.apply(null,t).substr(3)===String.fromCharCode.apply(null,e).substr(3)}}const Jm=188;class $m{constructor(t,e,n,i){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=t,this.config=e,this.typeSupported=n,this.logger=i,this.videoParser=null}static probe(t,e){const n=$m.syncOffset(t);return n>0&&e.warn("MPEG2-TS detected but first sync word found @ offset ".concat(n)),-1!==n}static syncOffset(t){const e=t.length;let n=Math.min(940,e-Jm)+1,i=0;for(;i<n;){let r=!1,s=-1,a=0;for(let o=i;o<e;o+=Jm){if(71!==t[o]||e-o!==Jm&&71!==t[o+Jm]){if(a)return-1;break}if(a++,-1===s&&(s=o,0!==s&&(n=Math.min(s+18612,t.length-Jm)+1)),r||(r=0===tg(t,o)),r&&a>1&&(0===s&&a>2||o+Jm>n))return s}i++}return-1}static createTrack(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:vh[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===t?e:void 0}}resetInitSegment(t,e,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=$m.createTrack("video"),this._videoTrack.duration=i,this._audioTrack=$m.createTrack("audio",i),this._id3Track=$m.createTrack("id3"),this._txtTrack=$m.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=e,this.videoCodec=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:t,_videoTrack:e,_id3Track:n}=this;t&&(t.pesData=null),e&&(e.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(t,e){let n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];i||(this.sampleAes=null);const s=this._videoTrack,a=this._audioTrack,o=this._id3Track,l=this._txtTrack;let c=s.pid,u=s.pesData,h=a.pid,d=o.pid,f=a.pesData,p=o.pesData,m=null,g=this.pmtParsed,v=this._pmtId,y=t.length;if(this.remainderData&&(y=(t=Ph(this.remainderData,t)).length,this.remainderData=null),y<Jm&&!r)return this.remainderData=t,{audioTrack:a,videoTrack:s,id3Track:o,textTrack:l};const _=Math.max(0,$m.syncOffset(t));y-=(y-_)%Jm,y<t.byteLength&&!r&&(this.remainderData=new Uint8Array(t.buffer,y,t.buffer.byteLength-y));let b=0;for(let E=_;E<y;E+=Jm)if(71===t[E]){const e=!!(64&t[E+1]),r=tg(t,E);let y;if((48&t[E+3])>>4>1){if(y=E+5+t[E+4],y===E+Jm)continue}else y=E+4;switch(r){case c:e&&(u&&(n=sg(u,this.logger))&&(this.readyVideoParser(s.segmentCodec),null!==this.videoParser&&this.videoParser.parsePES(s,l,n,!1)),u={data:[],size:0}),u&&(u.data.push(t.subarray(y,E+Jm)),u.size+=E+Jm-y);break;case h:if(e){if(f&&(n=sg(f,this.logger)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,n);break;case"mp3":this.parseMPEGPES(a,n);break;case"ac3":this.parseAC3PES(a,n)}f={data:[],size:0}}f&&(f.data.push(t.subarray(y,E+Jm)),f.size+=E+Jm-y);break;case d:e&&(p&&(n=sg(p,this.logger))&&this.parseID3PES(o,n),p={data:[],size:0}),p&&(p.data.push(t.subarray(y,E+Jm)),p.size+=E+Jm-y);break;case 0:e&&(y+=t[y]+1),v=this._pmtId=eg(t,y);break;case v:{e&&(y+=t[y]+1);const n=ng(t,y,this.typeSupported,i,this.observer,this.logger);c=n.videoPid,c>0&&(s.pid=c,s.segmentCodec=n.segmentVideoCodec),h=n.audioPid,h>0&&(a.pid=h,a.segmentCodec=n.segmentAudioCodec),d=n.id3Pid,d>0&&(o.pid=d),null===m||g||(this.logger.warn("MPEG-TS PMT found at ".concat(E," after unknown PID '").concat(m,"'. Backtracking to sync byte @").concat(_," to parse all TS packets.")),m=null,E=_-188),g=this.pmtParsed=!0;break}case 17:case 8191:break;default:m=r}}else b++;b>0&&ig(this.observer,new Error("Found ".concat(b," TS packet/s that do not start with 0x47")),void 0,this.logger),s.pesData=u,a.pesData=f,o.pesData=p;const x={audioTrack:a,videoTrack:s,id3Track:o,textTrack:l};return r&&this.extractRemainingSamples(x),x}flush(){const{remainderData:t}=this;let e;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e}extractRemainingSamples(t){const{audioTrack:e,videoTrack:n,id3Track:i,textTrack:r}=t,s=n.pesData,a=e.pesData,o=i.pesData;let l;if(s&&(l=sg(s,this.logger))?(this.readyVideoParser(n.segmentCodec),null!==this.videoParser&&(this.videoParser.parsePES(n,r,l,!0),n.pesData=null)):n.pesData=s,a&&(l=sg(a,this.logger))){switch(e.segmentCodec){case"aac":this.parseAACPES(e,l);break;case"mp3":this.parseMPEGPES(e,l);break;case"ac3":this.parseAC3PES(e,l)}e.pesData=null}else null!=a&&a.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),e.pesData=a;o&&(l=sg(o,this.logger))?(this.parseID3PES(i,l),i.pesData=null):i.pesData=o}demuxSampleAes(t,e,n){const i=this.demux(t,n,!0,!this.config.progressive),r=this.sampleAes=new Xm(this.observer,this.config,e);return this.decrypt(i,r)}readyVideoParser(t){null===this.videoParser&&("avc"===t?this.videoParser=new Qm:"hevc"===t&&(this.videoParser=new Zm))}decrypt(t,e){return new Promise(n=>{const{audioTrack:i,videoTrack:r}=t;i.samples&&"aac"===i.segmentCodec?e.decryptAacSamples(i.samples,0,()=>{r.samples?e.decryptAvcSamples(r.samples,0,0,()=>{n(t)}):n(t)}):r.samples&&e.decryptAvcSamples(r.samples,0,0,()=>{n(t)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(t,e){let n=0;const i=this.aacOverFlow;let r,s,a,o=e.data;if(i){this.aacOverFlow=null;const e=i.missing,r=i.sample.unit.byteLength;if(-1===e)o=Ph(i.sample.unit,o);else{const s=r-e;i.sample.unit.set(o.subarray(0,e),s),t.samples.push(i.sample),n=i.missing}}for(r=n,s=o.length;r<s-1&&!pm(o,r);r++);if(r!==n){let t;const e=r<s-1;if(t=e?"AAC PES did not start with ADTS header,offset:".concat(r):"No ADTS header found in AAC PES",ig(this.observer,new Error(t),e,this.logger),!e)return}if(gm(t,this.observer,o,r,this.audioCodec),void 0!==e.pts)a=e.pts;else{if(!i)return void this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");{const e=vm(t.samplerate);a=i.sample.pts+e}}let l,c=0;for(;r<s;){if(l=ym(t,o,r,a,c),r+=l.length,l.missing){this.aacOverFlow=l;break}for(c++;r<s-1&&!pm(o,r);r++);}}parseMPEGPES(t,e){const n=e.data,i=n.length;let r=0,s=0;const a=e.pts;if(void 0!==a)for(;s<i;)if(zm(n,s)){const e=Fm(t,n,s,a,r);if(!e)break;s+=e.length,r++}else s++;else this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(t,e){{const n=e.data,i=e.pts;if(void 0===i)return void this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");const r=n.length;let s,a=0,o=0;for(;o<r&&(s=jm(t,n,o,i,a++))>0;)o+=s}}parseID3PES(t,e){if(void 0===e.pts)return void this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");const n=Hu({},e,{type:this._videoTrack?Cm.emsg:Cm.audioId3,duration:Number.POSITIVE_INFINITY});t.samples.push(n)}}function tg(t,e){return((31&t[e+1])<<8)+t[e+2]}function eg(t,e){return(31&t[e+10])<<8|t[e+11]}function ng(t,e,n,i,r,s){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=e+3+((15&t[e+1])<<8|t[e+2])-4;for(e+=12+((15&t[e+10])<<8|t[e+11]);e<o;){const o=tg(t,e),l=(15&t[e+3])<<8|t[e+4];switch(t[e]){case 207:if(!i){rg("ADTS AAC",s);break}case 15:-1===a.audioPid&&(a.audioPid=o);break;case 21:-1===a.id3Pid&&(a.id3Pid=o);break;case 219:if(!i){rg("H.264",s);break}case 27:-1===a.videoPid&&(a.videoPid=o);break;case 3:case 4:n.mpeg||n.mp3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="mp3"):s.log("MPEG audio found, not supported in this browser");break;case 193:if(!i){rg("AC-3",s);break}case 129:n.ac3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="ac3"):s.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===a.audioPid&&l>0){let i=e+5,r=l;for(;r>2;){if(106===t[i])!0!==n.ac3?s.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=o,a.segmentAudioCodec="ac3");const e=t[i+1]+2;i+=e,r-=e}}break;case 194:case 135:return ig(r,new Error("Unsupported EC-3 in M2TS found"),void 0,s),a;case 36:-1===a.videoPid&&(a.videoPid=o,a.segmentVideoCodec="hevc",s.log("HEVC in M2TS found"))}e+=l+5}return a}function ig(t,e,n,i){i.warn("parsing error: ".concat(e.message)),t.emit(ku.ERROR,ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.FRAG_PARSING_ERROR,fatal:!1,levelRetry:n,error:e,reason:e.message})}function rg(t,e){e.log("".concat(t," with AES-128-CBC encryption found in unencrypted stream"))}function sg(t,e){let n,i,r,s,a,o=0;const l=t.data;if(!t||0===t.size)return null;for(;l[0].length<19&&l.length>1;)l[0]=Ph(l[0],l[1]),l.splice(1,1);n=l[0];if(1===(n[0]<<16)+(n[1]<<8)+n[2]){if(i=(n[4]<<8)+n[5],i&&i>t.size-6)return null;const c=n[7];192&c&&(s=536870912*(14&n[9])+4194304*(255&n[10])+16384*(254&n[11])+128*(255&n[12])+(254&n[13])/2,64&c?(a=536870912*(14&n[14])+4194304*(255&n[15])+16384*(254&n[16])+128*(255&n[17])+(254&n[18])/2,s-a>54e5&&(e.warn("".concat(Math.round((s-a)/9e4),"s delta between PTS and DTS, align them")),s=a)):a=s),r=n[8];let u=r+9;if(t.size<=u)return null;t.size-=u;const h=new Uint8Array(t.size);for(let t=0,e=l.length;t<e;t++){n=l[t];let e=n.byteLength;if(u){if(u>e){u-=e;continue}n=n.subarray(u),e-=u,u=0}h.set(n,o),o+=e}return i&&(i-=r+3),{data:h,pts:s,dts:a,len:i}}return null}class ag{static getSilentFrame(t,e){if("mp4a.40.2"===t){if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const og=Math.pow(2,32)-1;class lg{static init(){let t;for(t in lg.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},lg.types)lg.types.hasOwnProperty(t)&&(lg.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);const e=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);lg.HDLR_TYPES={video:e,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);lg.STTS=lg.STSC=lg.STCO=r,lg.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),lg.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),lg.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),lg.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const s=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);lg.FTYP=lg.box(lg.types.ftyp,s,o,s,a),lg.DINF=lg.box(lg.types.dinf,lg.box(lg.types.dref,i))}static box(t){let e=8;for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];let s=i.length;const a=s;for(;s--;)e+=i[s].byteLength;const o=new Uint8Array(e);for(o[0]=e>>24&255,o[1]=e>>16&255,o[2]=e>>8&255,o[3]=255&e,o.set(t,4),s=0,e=8;s<a;s++)o.set(i[s],e),e+=i[s].byteLength;return o}static hdlr(t){return lg.box(lg.types.hdlr,lg.HDLR_TYPES[t])}static mdat(t){return lg.box(lg.types.mdat,t)}static mdhd(t,e){e*=t;const n=Math.floor(e/(og+1)),i=Math.floor(e%(og+1));return lg.box(lg.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}static mdia(t){return lg.box(lg.types.mdia,lg.mdhd(t.timescale||0,t.duration||0),lg.hdlr(t.type),lg.minf(t))}static mfhd(t){return lg.box(lg.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}static minf(t){return"audio"===t.type?lg.box(lg.types.minf,lg.box(lg.types.smhd,lg.SMHD),lg.DINF,lg.stbl(t)):lg.box(lg.types.minf,lg.box(lg.types.vmhd,lg.VMHD),lg.DINF,lg.stbl(t))}static moof(t,e,n){return lg.box(lg.types.moof,lg.mfhd(t),lg.traf(n,e))}static moov(t){let e=t.length;const n=[];for(;e--;)n[e]=lg.trak(t[e]);return lg.box.apply(null,[lg.types.moov,lg.mvhd(t[0].timescale||0,t[0].duration||0)].concat(n).concat(lg.mvex(t)))}static mvex(t){let e=t.length;const n=[];for(;e--;)n[e]=lg.trex(t[e]);return lg.box.apply(null,[lg.types.mvex,...n])}static mvhd(t,e){e*=t;const n=Math.floor(e/(og+1)),i=Math.floor(e%(og+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return lg.box(lg.types.mvhd,r)}static sdtp(t){const e=t.samples||[],n=new Uint8Array(4+e.length);let i,r;for(i=0;i<e.length;i++)r=e[i].flags,n[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return lg.box(lg.types.sdtp,n)}static stbl(t){return lg.box(lg.types.stbl,lg.stsd(t),lg.box(lg.types.stts,lg.STTS),lg.box(lg.types.stsc,lg.STSC),lg.box(lg.types.stsz,lg.STSZ),lg.box(lg.types.stco,lg.STCO))}static avc1(t){let e,n,i,r=[],s=[];for(e=0;e<t.sps.length;e++)n=t.sps[e],i=n.byteLength,r.push(i>>>8&255),r.push(255&i),r=r.concat(Array.prototype.slice.call(n));for(e=0;e<t.pps.length;e++)n=t.pps[e],i=n.byteLength,s.push(i>>>8&255),s.push(255&i),s=s.concat(Array.prototype.slice.call(n));const a=lg.box(lg.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|t.sps.length].concat(r).concat([t.pps.length]).concat(s))),o=t.width,l=t.height,c=t.pixelRatio[0],u=t.pixelRatio[1];return lg.box(lg.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,lg.box(lg.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),lg.box(lg.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,u>>24,u>>16&255,u>>8&255,255&u])))}static esds(t){const e=t.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...e,6,1,2])}static audioStsd(t){const e=t.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount||0,0,16,0,0,0,0,e>>8&255,255&e,0,0])}static mp4a(t){return lg.box(lg.types.mp4a,lg.audioStsd(t),lg.box(lg.types.esds,lg.esds(t)))}static mp3(t){return lg.box(lg.types[".mp3"],lg.audioStsd(t))}static ac3(t){return lg.box(lg.types["ac-3"],lg.audioStsd(t),lg.box(lg.types.dac3,t.config))}static stsd(t){const{segmentCodec:e}=t;if("audio"===t.type){if("aac"===e)return lg.box(lg.types.stsd,lg.STSD,lg.mp4a(t));if("ac3"===e&&t.config)return lg.box(lg.types.stsd,lg.STSD,lg.ac3(t));if("mp3"===e&&"mp3"===t.codec)return lg.box(lg.types.stsd,lg.STSD,lg.mp3(t))}else{if(!t.pps||!t.sps)throw new Error("video track missing pps or sps");if("avc"===e)return lg.box(lg.types.stsd,lg.STSD,lg.avc1(t));if("hevc"===e&&t.vps)return lg.box(lg.types.stsd,lg.STSD,lg.hvc1(t))}throw new Error("unsupported ".concat(t.type," segment codec (").concat(e,"/").concat(t.codec,")"))}static tkhd(t){const e=t.id,n=(t.duration||0)*(t.timescale||0),i=t.width||0,r=t.height||0,s=Math.floor(n/(og+1)),a=Math.floor(n%(og+1));return lg.box(lg.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,r>>8&255,255&r,0,0]))}static traf(t,e){const n=lg.sdtp(t),i=t.id,r=Math.floor(e/(og+1)),s=Math.floor(e%(og+1));return lg.box(lg.types.traf,lg.box(lg.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),lg.box(lg.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s])),lg.trun(t,n.length+16+20+8+16+8+8),n)}static trak(t){return t.duration=t.duration||4294967295,lg.box(lg.types.trak,lg.tkhd(t),lg.mdia(t))}static trex(t){const e=t.id;return lg.box(lg.types.trex,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,e){const n=t.samples||[],i=n.length,r=12+16*i,s=new Uint8Array(r);let a,o,l,c,u,h;for(e+=8+r,s.set(["video"===t.type?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,255&i,e>>>24&255,e>>>16&255,e>>>8&255,255&e],0),a=0;a<i;a++)o=n[a],l=o.duration,c=o.size,u=o.flags,h=o.cts,s.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,c>>>24&255,c>>>16&255,c>>>8&255,255&c,u.isLeading<<2|u.dependsOn,u.isDependedOn<<6|u.hasRedundancy<<4|u.paddingValue<<1|u.isNonSync,61440&u.degradPrio,15&u.degradPrio,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*a);return lg.box(lg.types.trun,s)}static initSegment(t){lg.types||lg.init();const e=lg.moov(t);return Ph(lg.FTYP,e)}static hvc1(t){const e=t.params,n=[t.vps,t.sps,t.pps],i=new Uint8Array([1,e.general_profile_space<<6|(e.general_tier_flag?32:0)|e.general_profile_idc,e.general_profile_compatibility_flags[0],e.general_profile_compatibility_flags[1],e.general_profile_compatibility_flags[2],e.general_profile_compatibility_flags[3],e.general_constraint_indicator_flags[0],e.general_constraint_indicator_flags[1],e.general_constraint_indicator_flags[2],e.general_constraint_indicator_flags[3],e.general_constraint_indicator_flags[4],e.general_constraint_indicator_flags[5],e.general_level_idc,240|e.min_spatial_segmentation_idc>>8,255&e.min_spatial_segmentation_idc,252|e.parallelismType,252|e.chroma_format_idc,248|e.bit_depth_luma_minus8,248|e.bit_depth_chroma_minus8,0,parseInt(e.frame_rate.fps),3|e.temporal_id_nested<<2|e.num_temporal_layers<<3|(e.frame_rate.fixed?64:0),n.length]);let r=i.length;for(let d=0;d<n.length;d+=1){r+=3;for(let t=0;t<n[d].length;t+=1)r+=2+n[d][t].length}const s=new Uint8Array(r);s.set(i,0),r=i.length;const a=n.length-1;for(let d=0;d<n.length;d+=1){s.set(new Uint8Array([32+d|(d===a?128:0),0,n[d].length]),r),r+=3;for(let t=0;t<n[d].length;t+=1)s.set(new Uint8Array([n[d][t].length>>8,255&n[d][t].length]),r),r+=2,s.set(n[d][t],r),r+=n[d][t].length}const o=lg.box(lg.types.hvcC,s),l=t.width,c=t.height,u=t.pixelRatio[0],h=t.pixelRatio[1];return lg.box(lg.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,lg.box(lg.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),lg.box(lg.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,h>>24,h>>16&255,h>>8&255,255&h])))}}lg.types=void 0,lg.HDLR_TYPES=void 0,lg.STTS=void 0,lg.STSC=void 0,lg.STCO=void 0,lg.STSZ=void 0,lg.VMHD=void 0,lg.SMHD=void 0,lg.STSD=void 0,lg.FTYP=void 0,lg.DINF=void 0;function cg(t,e){const n=t*e*(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1);return arguments.length>3&&void 0!==arguments[3]&&arguments[3]?Math.round(n):n}function ug(t){return cg(t,1e3,1/9e4,arguments.length>1&&void 0!==arguments[1]&&arguments[1])}function hg(t){const{baseTime:e,timescale:n,trackId:i}=t;return"".concat(e/n," (").concat(e,"/").concat(n,") trackId: ").concat(i)}let dg,fg=null,pg=null;function mg(t,e,n,i){return{duration:e,size:n,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:t?2:1,isNonSync:t?0:1}}}class gg extends ju{constructor(t,e,n,i){if(super("mp4-remuxer",i),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=t,this.config=e,this.typeSupported=n,this.ISGenerated=!1,null===fg){const t=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);fg=t?parseInt(t[1]):0}if(null===pg){const t=navigator.userAgent.match(/Safari\/(\d+)/i);pg=t?parseInt(t[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(t){const e=this._initPTS;e&&t&&t.trackId===e.trackId&&t.baseTime===e.baseTime&&t.timescale===e.timescale||this.log("Reset initPTS: ".concat(e?hg(e):e," > ").concat(t?hg(t):t)),this._initPTS=this._initDTS=t}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(t){let e=!1;const n=t[0].pts,i=t.reduce((t,i)=>{let r=i.pts,s=r-t;return s<-4294967296&&(e=!0,r=vg(r,n),s=r-t),s>0?t:r},n);return e&&this.debug("PTS rollover detected"),i}remux(t,e,n,i,r,s,a,o){let l,c,u,h,d,f,p=r,m=r;const g=t.pid>-1,v=e.pid>-1,y=e.samples.length,_=t.samples.length>0,b=a&&y>0||y>1;if((!g||_)&&(!v||b)||this.ISGenerated||a){if(this.ISGenerated){var x,E,w,S;const t=this.videoTrackConfig;(t&&(e.width!==t.width||e.height!==t.height||(null==(x=e.pixelRatio)?void 0:x[0])!==(null==(E=t.pixelRatio)?void 0:E[0])||(null==(w=e.pixelRatio)?void 0:w[1])!==(null==(S=t.pixelRatio)?void 0:S[1]))||!t&&b||null===this.nextAudioTs&&_)&&this.resetInitSegment()}this.ISGenerated||(u=this.generateIS(t,e,r,s));const n=this.isVideoContiguous;let i,a=-1;if(b&&(a=function(t){for(let e=0;e<t.length;e++)if(t[e].key)return e;return-1}(e.samples),!n&&this.config.forceKeyFrameOnDiscontinuity))if(f=!0,a>0){this.warn("Dropped ".concat(a," out of ").concat(y," video samples due to a missing keyframe"));const t=this.getVideoStartPts(e.samples);e.samples=e.samples.slice(a),e.dropped+=a,m+=(e.samples[0].pts-t)/e.inputTimeScale,i=m}else-1===a&&(this.warn("No keyframe found out of ".concat(y," video samples")),f=!1);if(this.ISGenerated){if(_&&b){const n=this.getVideoStartPts(e.samples),i=(vg(t.samples[0].pts,n)-n)/e.inputTimeScale;p+=Math.max(0,i),m+=Math.max(0,-i)}if(_){if(t.samplerate||(this.warn("regenerate InitSegment as audio detected"),u=this.generateIS(t,e,r,s)),c=this.remuxAudio(t,p,this.isAudioContiguous,s,v||b||o===Nu?m:void 0),b){const i=c?c.endPTS-c.startPTS:0;e.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),u=this.generateIS(t,e,r,s)),l=this.remuxVideo(e,m,n,i)}}else b&&(l=this.remuxVideo(e,m,n,0));l&&(l.firstKeyFrame=a,l.independent=-1!==a,l.firstKeyFramePTS=i)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(d=yg(n,r,this._initPTS,this._initDTS)),i.samples.length&&(h=_g(i,r,this._initPTS))),{audio:c,video:l,initSegment:u,independent:f,text:h,id3:d}}computeInitPts(t,e,n,i){const r=Math.round(n*e);let s=vg(t,r);if(s<r+e)for(this.log("Adjusting PTS for rollover in timeline near ".concat((r-s)/e," ").concat(i));s<r+e;)s+=8589934592;return s-r}generateIS(t,e,n,i){const r=t.samples,s=e.samples,a=this.typeSupported,o={},l=this._initPTS;let c,u,h,d=!l||i,f="audio/mp4",p=-1;if(d&&(c=u=1/0),t.config&&r.length){switch(t.timescale=t.samplerate,t.segmentCodec){case"mp3":a.mpeg?(f="audio/mpeg",t.codec=""):a.mp3&&(t.codec="mp3");break;case"ac3":t.codec="ac-3"}o.audio={id:"audio",container:f,codec:t.codec,initSegment:"mp3"===t.segmentCodec&&a.mpeg?new Uint8Array(0):lg.initSegment([t]),metadata:{channelCount:t.channelCount}},d&&(p=t.id,h=t.inputTimeScale,l&&h===l.timescale?d=!1:c=u=this.computeInitPts(r[0].pts,h,n,"audio"))}if(e.sps&&e.pps&&s.length){if(e.timescale=e.inputTimeScale,o.video={id:"main",container:"video/mp4",codec:e.codec,initSegment:lg.initSegment([e]),metadata:{width:e.width,height:e.height}},d)if(p=e.id,h=e.inputTimeScale,l&&h===l.timescale)d=!1;else{const t=this.getVideoStartPts(s),e=vg(s[0].dts,t),i=this.computeInitPts(e,h,n,"video"),r=this.computeInitPts(t,h,n,"video");u=Math.min(u,i),c=Math.min(c,r)}this.videoTrackConfig={width:e.width,height:e.height,pixelRatio:e.pixelRatio}}if(Object.keys(o).length)return this.ISGenerated=!0,d?(l&&this.warn("Timestamps at playlist time: ".concat(i?"":"~").concat(n," ").concat(c/h," != initPTS: ").concat(l.baseTime/l.timescale," (").concat(l.baseTime,"/").concat(l.timescale,") trackId: ").concat(l.trackId)),this.log("Found initPTS at playlist time: ".concat(n," offset: ").concat(c/h," (").concat(c,"/").concat(h,") trackId: ").concat(p)),this._initPTS={baseTime:c,timescale:h,trackId:p},this._initDTS={baseTime:u,timescale:h,trackId:p}):c=h=void 0,{tracks:o,initPTS:c,timescale:h,trackId:p}}remuxVideo(t,e,n,i){const r=t.inputTimeScale,s=t.samples,a=[],o=s.length,l=this._initPTS,c=l.baseTime*r/l.timescale;let u,h,d=this.nextVideoTs,f=8,p=this.videoSampleDuration,m=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,v=!1;if(!n||null===d){const t=c+e*r,i=s[0].pts-vg(s[0].dts,s[0].pts);fg&&null!==d&&Math.abs(t-i-(d+c))<15e3?n=!0:d=t-i-c}const y=d+c;for(let O=0;O<o;O++){const t=s[O];t.pts=vg(t.pts,y),t.dts=vg(t.dts,y),t.dts<s[O>0?O-1:O].dts&&(v=!0)}v&&s.sort(function(t,e){const n=t.dts-e.dts,i=t.pts-e.pts;return n||i}),u=s[0].dts,h=s[s.length-1].dts;const _=h-u,b=_?Math.round(_/(o-1)):p||t.inputTimeScale/30;if(n){const n=u-y,i=n>b,r=n<-1;if((i||r)&&(i?this.warn("".concat((t.segmentCodec||"").toUpperCase(),": ").concat(ug(n,!0)," ms (").concat(n,"dts) hole between fragments detected at ").concat(e.toFixed(3))):this.warn("".concat((t.segmentCodec||"").toUpperCase(),": ").concat(ug(-n,!0)," ms (").concat(n,"dts) overlapping between fragments detected at ").concat(e.toFixed(3))),!r||y>=s[0].pts||fg)){u=y;const t=s[0].pts-n;if(i)s[0].dts=u,s[0].pts=t;else{let e=!0;for(let i=0;i<s.length&&!(s[i].dts>t&&e);i++){const t=s[i].pts;if(s[i].dts-=n,s[i].pts-=n,i<s.length-1){const n=s[i+1].pts;e=n<=s[i].pts==n<=t}}}this.log("Video: Initial PTS/DTS adjusted: ".concat(ug(t,!0),"/").concat(ug(u,!0),", delta: ").concat(ug(n,!0)," ms"))}}u=Math.max(0,u);let x=0,E=0,w=u;for(let O=0;O<o;O++){const t=s[O],e=t.units,n=e.length;let i=0;for(let r=0;r<n;r++)i+=e[r].data.length;E+=i,x+=n,t.length=i,t.dts<w?(t.dts=w,w+=b/4|0||1):w=t.dts,m=Math.min(t.pts,m),g=Math.max(t.pts,g)}h=s[o-1].dts;const S=E+4*x+8;let T;try{T=new Uint8Array(S)}catch(I){return void this.observer.emit(ku.ERROR,ku.ERROR,{type:Cu.MUX_ERROR,details:Ru.REMUX_ALLOC_ERROR,fatal:!1,error:I,bytes:S,reason:"fail allocating video mdat ".concat(S)})}const M=new DataView(T.buffer);M.setUint32(0,S),T.set(lg.types.mdat,4);let A=!1,C=Number.POSITIVE_INFINITY,R=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY,L=Number.NEGATIVE_INFINITY;for(let O=0;O<o;O++){const t=s[O],e=t.units;let n,l=0;for(let i=0,r=e.length;i<r;i++){const t=e[i],n=t.data,r=t.data.byteLength;M.setUint32(f,r),f+=4,T.set(n,f),f+=r,l+=4+r}if(O<o-1)p=s[O+1].dts-t.dts,n=s[O+1].pts-t.pts;else{const e=this.config,a=O>0?t.dts-s[O-1].dts:b;if(n=O>0?t.pts-s[O-1].pts:b,e.stretchShortVideoTrack&&null!==this.nextAudioTs){const n=Math.floor(e.maxBufferHole*r),s=(i?m+i*r:this.nextAudioTs+c)-t.pts;s>n?(p=s-a,p<0?p=a:A=!0,this.log("It is approximately ".concat(s/90," ms to the next segment; using duration ").concat(p/90," ms for the last video frame."))):p=a}else p=a}const u=Math.round(t.pts-t.dts);C=Math.min(C,p),k=Math.max(k,p),R=Math.min(R,n),L=Math.max(L,n),a.push(mg(t.key,p,l,u))}if(a.length)if(fg){if(fg<70){const t=a[0].flags;t.dependsOn=2,t.isNonSync=0}}else if(pg&&L-R<k-C&&b/k<.025&&0===a[0].cts){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let t=u;for(let e=0,n=a.length;e<n;e++){const i=t+a[e].duration,r=t+a[e].cts;if(e<n-1){const t=i+a[e+1].cts;a[e].duration=t-r}else a[e].duration=e?a[e-1].duration:b;a[e].cts=0,t=i}}p=A||!p?b:p;const D=h+p;this.nextVideoTs=d=D-c,this.videoSampleDuration=p,this.isVideoContiguous=!0;const P={data1:lg.moof(t.sequenceNumber++,u,Hu(t,{samples:a})),data2:T,startPTS:(m-c)/r,endPTS:(g+p-c)/r,startDTS:(u-c)/r,endDTS:d/r,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:t.dropped};return t.samples=[],t.dropped=0,P}getSamplesPerFrame(t){switch(t.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}}remuxAudio(t,e,n,i,r){const s=t.inputTimeScale,a=s/(t.samplerate?t.samplerate:s),o=this.getSamplesPerFrame(t),l=o*a,c=this._initPTS,u="mp3"===t.segmentCodec&&this.typeSupported.mpeg,h=[],d=void 0!==r;let f=t.samples,p=u?0:8,m=this.nextAudioTs||-1;const g=c.baseTime*s/c.timescale,v=g+e*s;if(this.isAudioContiguous=n=n||f.length&&m>0&&(i&&Math.abs(v-(m+g))<9e3||Math.abs(vg(f[0].pts,v)-(m+g))<20*l),f.forEach(function(t){t.pts=vg(t.pts,v)}),!n||m<0){const t=f.length;if(f=f.filter(t=>t.pts>=0),t!==f.length&&this.warn("Removed ".concat(f.length-t," of ").concat(t," samples (initPTS ").concat(g," / ").concat(s,")")),!f.length)return;m=0===r?0:i&&!d?Math.max(0,v-g):f[0].pts-g}if("aac"===t.segmentCodec){const e=this.config.maxAudioFramesDrift;for(let n=0,i=m+g;n<f.length;n++){const r=f[n],a=r.pts,o=a-i,c=Math.abs(1e3*o/s);if(o<=-e*l&&d)0===n&&(this.warn("Audio frame @ ".concat((a/s).toFixed(3),"s overlaps marker by ").concat(Math.round(1e3*o/s)," ms.")),this.nextAudioTs=m=a-g,i=a);else if(o>=e*l&&c<1e4&&d){let e=Math.round(o/l);for(i=a-e*l;i<0&&e&&l;)e--,i+=l;0===n&&(this.nextAudioTs=m=i-g),this.warn("Injecting ".concat(e," audio frames @ ").concat(((i-g)/s).toFixed(3),"s due to ").concat(Math.round(1e3*o/s)," ms gap."));for(let s=0;s<e;s++){let e=ag.getSilentFrame(t.parsedCodec||t.manifestCodec||t.codec,t.channelCount);e||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),e=r.unit.subarray()),f.splice(n,0,{unit:e,pts:i}),i+=l,n++}}r.pts=i,i+=l}}let y,_=null,b=null,x=0,E=f.length;for(;E--;)x+=f[E].unit.byteLength;for(let k=0,L=f.length;k<L;k++){const e=f[k],i=e.unit;let r=e.pts;if(null!==b){h[k-1].duration=Math.round((r-b)/a)}else{if(n&&"aac"===t.segmentCodec&&(r=m+g),_=r,!(x>0))return;x+=p;try{y=new Uint8Array(x)}catch(R){return void this.observer.emit(ku.ERROR,ku.ERROR,{type:Cu.MUX_ERROR,details:Ru.REMUX_ALLOC_ERROR,fatal:!1,error:R,bytes:x,reason:"fail allocating audio mdat ".concat(x)})}if(!u){new DataView(y.buffer).setUint32(0,x),y.set(lg.types.mdat,4)}}y.set(i,p);const s=i.byteLength;p+=s,h.push(mg(!0,o,s,0)),b=r}const w=h.length;if(!w)return;const S=h[h.length-1];m=b-g,this.nextAudioTs=m+a*S.duration;const T=u?new Uint8Array(0):lg.moof(t.sequenceNumber++,_/a,Hu({},t,{samples:h}));t.samples=[];const M=(_-g)/s,A=this.nextAudioTs/s,C={data1:T,data2:y,startPTS:M,endPTS:A,startDTS:M,endDTS:A,type:"audio",hasAudio:!0,hasVideo:!1,nb:w};return this.isAudioContiguous=!0,C}}function vg(t,e){let n;if(null===e)return t;for(n=e<t?-8589934592:8589934592;Math.abs(t-e)>4294967296;)t+=n;return t}function yg(t,e,n,i){const r=t.samples.length;if(!r)return;const s=t.inputTimeScale;for(let o=0;o<r;o++){const r=t.samples[o];r.pts=vg(r.pts-n.baseTime*s/n.timescale,e*s)/s,r.dts=vg(r.dts-i.baseTime*s/i.timescale,e*s)/s}const a=t.samples;return t.samples=[],{samples:a}}function _g(t,e,n){const i=t.samples.length;if(!i)return;const r=t.inputTimeScale;for(let a=0;a<i;a++){const i=t.samples[a];i.pts=vg(i.pts-n.baseTime*r/n.timescale,e*r)/r}t.samples.sort((t,e)=>t.pts-e.pts);const s=t.samples;return t.samples=[],{samples:s}}function bg(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return void 0!==(null==t?void 0:t.start)?(t.start+(n?t.duration:0))/t.timescale:e}function xg(t,e,n){const i=t.codec;if(i&&i.length>4)return i;if(e===oh){if("ec-3"===i||"ac-3"===i||"alac"===i)return i;if("fLaC"===i||"Opus"===i){return Zh(i,!1)}return n.warn('Unhandled audio codec "'.concat(i,'" in mp4 MAP')),i||"mp4a"}return n.warn('Unhandled video codec "'.concat(i,'" in mp4 MAP')),i||"avc1"}try{dg=self.performance.now.bind(self.performance)}catch(Yq){dg=Date.now}const Eg=[{demux:class{constructor(t,e){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=e}resetTimeStamp(){}resetInitSegment(t,e,n,i){const r=this.videoTrack=Rm("video",1),s=this.audioTrack=Rm("audio",1),a=this.txtTrack=Rm("text",1);if(this.id3Track=Rm("id3",1),this.timeOffset=0,null==t||!t.byteLength)return;const o=Th(t);if(o.video){const{id:t,timescale:e,codec:n,supplemental:i}=o.video;r.id=t,r.timescale=a.timescale=e,r.codec=n,r.supplemental=i}if(o.audio){const{id:t,timescale:e,codec:n}=o.audio;s.id=t,s.timescale=e,s.codec=n}a.id=vh.text,r.sampleDuration=0,r.duration=s.duration=i}resetContiguity(){this.remainderData=null}static probe(t){return function(t){const e=t.byteLength;for(let n=0;n<e;){const i=bh(t,n);if(i>8&&109===t[n+4]&&111===t[n+5]&&111===t[n+6]&&102===t[n+7])return!0;n=i>1?n+i:e}return!1}(t)}demux(t,e){this.timeOffset=e;let n=t;const i=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Ph(this.remainderData,t));const e=function(t){const e={valid:null,remainder:null},n=wh(t,["moof"]);if(n.length<2)return e.remainder=t,e;const i=n[n.length-1];return e.valid=t.slice(0,i.byteOffset-8),e.remainder=t.slice(i.byteOffset-8),e}(n);this.remainderData=e.remainder,i.samples=e.valid||new Uint8Array}else i.samples=n;const s=this.extractID3Track(i,e);return r.samples=Ih(e,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}}flush(){const t=this.timeOffset,e=this.videoTrack,n=this.txtTrack;e.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(e,this.timeOffset);return n.samples=Ih(t,e),{videoTrack:e,audioTrack:Rm(),id3Track:i,textTrack:Rm()}}extractID3Track(t,e){const n=this.id3Track;if(t.samples.length){const i=wh(t.samples,["emsg"]);i&&i.forEach(t=>{const i=function(t){const e=t[0];let n="",i="",r=0,s=0,a=0,o=0,l=0,c=0;if(0===e){for(;"\0"!==yh(t.subarray(c,c+1));)n+=yh(t.subarray(c,c+1)),c+=1;for(n+=yh(t.subarray(c,c+1)),c+=1;"\0"!==yh(t.subarray(c,c+1));)i+=yh(t.subarray(c,c+1)),c+=1;i+=yh(t.subarray(c,c+1)),c+=1,r=bh(t,12),s=bh(t,16),o=bh(t,20),l=bh(t,24),c=28}else if(1===e){c+=4,r=bh(t,c),c+=4;const e=bh(t,c);c+=4;const s=bh(t,c);for(c+=4,a=2**32*e+s,Mu(a)||(a=Number.MAX_SAFE_INTEGER,Qu.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=bh(t,c),c+=4,l=bh(t,c),c+=4;"\0"!==yh(t.subarray(c,c+1));)n+=yh(t.subarray(c,c+1)),c+=1;for(n+=yh(t.subarray(c,c+1)),c+=1;"\0"!==yh(t.subarray(c,c+1));)i+=yh(t.subarray(c,c+1)),c+=1;i+=yh(t.subarray(c,c+1)),c+=1}return{schemeIdUri:n,value:i,timeScale:r,presentationTime:a,presentationTimeDelta:s,eventDuration:o,id:l,payload:t.subarray(c,t.byteLength)}}(t);if(Wm.test(i.schemeIdUri)){const t=Ym(i,e);let r=4294967295===i.eventDuration?Number.POSITIVE_INFINITY:i.eventDuration/i.timeScale;r<=.001&&(r=Number.POSITIVE_INFINITY);const s=i.payload;n.samples.push({data:s,len:s.byteLength,dts:t,pts:t,type:Cm.emsg,duration:r})}else if(this.config.enableEmsgKLVMetadata&&i.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const t=Ym(i,e);n.samples.push({data:i.payload,len:i.payload.byteLength,dts:t,pts:t,type:Cm.misbklv,duration:Number.POSITIVE_INFINITY})}})}return n}demuxSampleAes(t,e,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}},remux:class extends ju{constructor(t,e,n,i){super("passthrough-remuxer",i),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(t){this.lastEndTime=null;const e=this.initPTS;e&&t&&e.baseTime===t.baseTime&&e.timescale===t.timescale||(this.initPTS=t)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(t,e,n,i){this.audioCodec=e,this.videoCodec=n,this.generateInitSegment(t,i),this.emitInitSegment=!0}generateInitSegment(t,e){let{audioCodec:n,videoCodec:i}=this;if(null==t||!t.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const{audio:r,video:s}=this.initData=Th(t);if(e)!function(t,e){if(!t||!e)return;const n=e.keyId;n&&e.isCommonEncryption&&Lh(t,(t,e)=>{const i=t.subarray(8,24);i.some(t=>0!==t)||(Qu.log("[eme] Patching keyId in 'enc".concat(e?"a":"v",">sinf>>tenc' box: ").concat(th(i)," -> ").concat(th(n))),t.set(n,8))})}(t,e);else{const t=r||s;null!=t&&t.encrypted&&this.warn('Init segment with encrypted track with has no key ("'.concat(t.codec,'")!'))}r&&(n=xg(r,oh,this)),s&&(i=xg(s,lh,this));const a={};r&&s?a.audiovideo={container:"video/mp4",codec:n+","+i,supplemental:s.supplemental,encrypted:s.encrypted,initSegment:t,id:"main"}:r?a.audio={container:"audio/mp4",codec:n,encrypted:r.encrypted,initSegment:t,id:"audio"}:s?a.video={container:"video/mp4",codec:i,supplemental:s.supplemental,encrypted:s.encrypted,initSegment:t,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=a}remux(t,e,n,i,r,s){var a,o;let{initPTS:l,lastEndTime:c}=this;const u={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};Tu(c)||(c=this.lastEndTime=r||0);const h=e.samples;if(!h.length)return u;const d={initPTS:void 0,timescale:void 0,trackId:void 0};let f=this.initData;if(null!=(a=f)&&a.length||(this.generateInitSegment(h),f=this.initData),null==(o=f)||!o.length)return this.warn("Failed to generate initSegment."),u;this.emitInitSegment&&(d.tracks=this.initTracks,this.emitInitSegment=!1);const p=function(t,e,n){const i={},r=wh(t,["moof","traf"]);for(let s=0;s<r.length;s++){const t=r[s],a=wh(t,["tfhd"])[0],o=bh(a,4),l=e[o];if(!l)continue;i[o]||(i[o]={start:NaN,duration:0,sampleCount:0,timescale:l.timescale,type:l.type});const c=i[o],u=wh(t,["tfdt"])[0];if(u){const t=u[0];let e=bh(u,4);1===t&&(e===mh?n.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(e*=mh+1,e+=bh(u,8))),Tu(e)&&(!Tu(c.start)||e<c.start)&&(c.start=e)}const h=l.default,d=bh(a,0)|(null==h?void 0:h.flags);let f=(null==h?void 0:h.duration)||0;8&d&&(f=bh(a,2&d?12:8));const p=wh(t,["trun"]);let m=c.start||0,g=0,v=f;for(let e=0;e<p.length;e++){const t=p[e],n=bh(t,4),i=c.sampleCount;c.sampleCount+=n;const r=1&t[3],s=4&t[3],a=1&t[2],o=2&t[2],l=4&t[2],u=8&t[2];let h=8,d=n;for(r&&(h+=4),s&&n&&(1&t[h+1]||void 0!==c.keyFrameIndex||(c.keyFrameIndex=i),h+=4,a?(v=bh(t,h),h+=4):v=f,o&&(h+=4),u&&(h+=4),m+=v,g+=v,d--);d--;)a?(v=bh(t,h),h+=4):v=f,o&&(h+=4),l&&(1&t[h+1]||void 0===c.keyFrameIndex&&(c.keyFrameIndex=c.sampleCount-(d+1),c.keyFrameStart=m),h+=4),u&&(h+=4),m+=v,g+=v;!g&&f&&(g+=f*n)}c.duration+=g}if(!Object.keys(i).some(t=>i[t].duration)){let e=1/0,n=0;const r=wh(t,["sidx"]);for(let t=0;t<r.length;t++){const i=Sh(r[t]);if(null!=i&&i.references){e=Math.min(e,i.earliestPresentationTime/i.timescale);const t=i.references.reduce((t,e)=>t+e.info.duration||0,0);n=Math.max(n,t+i.earliestPresentationTime/i.timescale)}}n&&Tu(n)&&Object.keys(i).forEach(t=>{i[t].duration||(i[t].duration=n*i[t].timescale-i[t].start)})}return i}(h,f,this),m=f.audio?p[f.audio.id]:null,g=f.video?p[f.video.id]:null,v=bg(g,1/0),y=bg(m,1/0),_=bg(g,0,!0),b=bg(m,0,!0);let x=r,E=0;const w=m&&(!g||!l&&y<v||l&&l.trackId===f.audio.id),S=w?m:g;if(S){const t=S.timescale,e=S.start-r*t,n=w?f.audio.id:f.video.id;x=S.start/t,E=w?b-y:_-v,!s&&l||!function(t,e,n,i){if(null===t)return!0;const r=Math.max(i,1),s=e-t.baseTime/t.timescale;return Math.abs(s-n)>r}(l,x,r,E)&&t===l.timescale||(l&&this.warn("Timestamps at playlist time: ".concat(s?"":"~").concat(r," ").concat(e/t," != initPTS: ").concat(l.baseTime/l.timescale," (").concat(l.baseTime,"/").concat(l.timescale,") trackId: ").concat(l.trackId)),this.log("Found initPTS at playlist time: ".concat(r," offset: ").concat(x-r," (").concat(e,"/").concat(t,") trackId: ").concat(n)),l=null,d.initPTS=e,d.timescale=t,d.trackId=n)}else this.warn("No audio or video samples found for initPTS at playlist time: ".concat(r));l?(d.initPTS=l.baseTime,d.timescale=l.timescale,d.trackId=l.trackId):(d.timescale&&void 0!==d.trackId&&void 0!==d.initPTS||(this.warn("Could not set initPTS"),d.initPTS=x,d.timescale=1,d.trackId=-1),this.initPTS=l={baseTime:d.initPTS,timescale:d.timescale,trackId:d.trackId});const T=x-l.baseTime/l.timescale,M=T+E;E>0?this.lastEndTime=M:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const A=!!f.audio,C=!!f.video;let R="";A&&(R+="audio"),C&&(R+="video");const k={data1:h,startPTS:T,startDTS:T,endPTS:M,endDTS:M,type:R,hasAudio:A,hasVideo:C,nb:1,dropped:0,encrypted:!!f.audio&&f.audio.encrypted||!!f.video&&f.video.encrypted};u.audio=A&&!C?k:void 0,u.video=C?k:void 0;const L=null==g?void 0:g.sampleCount;if(L){const t=g.keyFrameIndex,e=-1!==t;k.nb=L,k.dropped=0===t||this.isVideoContiguous?0:e?t:L,k.independent=e,k.firstKeyFrame=t,e&&g.keyFrameStart&&(k.firstKeyFramePTS=(g.keyFrameStart-l.baseTime)/l.timescale),this.isVideoContiguous||(u.independent=e),this.isVideoContiguous||(this.isVideoContiguous=e),k.dropped&&this.warn("fmp4 does not start with IDR: firstIDR ".concat(t,"/").concat(L," dropped: ").concat(k.dropped," start: ").concat(k.firstKeyFramePTS||"NA"))}return u.initSegment=d,u.id3=yg(n,r,l,l),i.samples.length&&(u.text=_g(i,r,l)),u}}},{demux:$m,remux:gg},{demux:class extends km{constructor(t,e){super(),this.observer=void 0,this.config=void 0,this.observer=t,this.config=e}resetInitSegment(t,e,n,i){super.resetInitSegment(t,e,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:e,duration:i,inputTimeScale:9e4,dropped:0}}static probe(t,e){if(!t)return!1;const n=um(t,0);let i=(null==n?void 0:n.length)||0;if(Hm(t,i))return!1;for(let r=t.length;i<r;i++)if(mm(t,i))return e.log("ADTS sync word found !"),!0;return!1}canParse(t,e){return function(t,e){return function(t,e){return e+5<t.length}(t,e)&&hm(t,e)&&fm(t,e)<=t.length-e}(t,e)}appendFrame(t,e,n){gm(t,this.observer,e,n,t.manifestCodec);const i=ym(t,e,n,this.basePTS,this.frameIndex);if(i&&0===i.missing)return i}},remux:gg},{demux:class extends km{resetInitSegment(t,e,n,i){super.resetInitSegment(t,e,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:e,duration:i,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;const e=um(t,0);let n=(null==e?void 0:e.length)||0;if(e&&11===t[n]&&119===t[n+1]&&void 0!==Am(e)&&Vm(t,n)<=16)return!1;for(let i=t.length;n<i;n++)if(Hm(t,n))return Qu.log("MPEG Audio sync word found !"),!0;return!1}canParse(t,e){return function(t,e){return Bm(t,e)&&4<=t.length-e}(t,e)}appendFrame(t,e,n){if(null!==this.basePTS)return Fm(t,e,n,this.basePTS,this.frameIndex)}},remux:gg}];Eg.splice(2,0,{demux:Gm,remux:gg});class wg{constructor(t,e,n,i,r,s){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=e,this.config=n,this.id=r,this.logger=s}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,e,n,i){const r=n.transmuxing;r.executeStart=dg();let s=new Uint8Array(t);const{currentTransmuxState:a,transmuxConfig:o}=this;i&&(this.currentTransmuxState=i);const{contiguous:l,discontinuity:c,trackSwitch:u,accurateTimeOffset:h,timeOffset:d,initSegmentChange:f}=i||a,{audioCodec:p,videoCodec:m,defaultInitPts:g,duration:v,initSegmentData:y}=o,_=function(t,e){let n=null;t.byteLength>0&&null!=(null==e?void 0:e.key)&&null!==e.iv&&null!=e.method&&(n=e);return n}(s,e);if(_&&Of(_.method)){const t=this.getDecrypter(),e=Nf(_.method);if(!t.isSync())return this.asyncResult=!0,this.decryptionPromise=t.webCryptoDecrypt(s,_.key.buffer,_.iv.buffer,e).then(t=>{const e=this.push(t,null,n);return this.decryptionPromise=null,e}),this.decryptionPromise;{let i=t.softwareDecrypt(s,_.key.buffer,_.iv.buffer,e);if(n.part>-1){const e=t.flush();i=e?e.buffer:e}if(!i)return r.executeEnd=dg(),Sg(n);s=new Uint8Array(i)}}const b=this.needsProbing(c,u);if(b){const t=this.configureTransmuxer(s);if(t)return this.logger.warn("[transmuxer] ".concat(t.message)),this.observer.emit(ku.ERROR,ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.FRAG_PARSING_ERROR,fatal:!1,error:t,reason:t.message}),r.executeEnd=dg(),Sg(n)}(c||u||f||b)&&this.resetInitSegment(y,p,m,v,e),(c||f||b)&&this.resetInitialTimestamp(g),l||this.resetContiguity();const x=this.transmux(s,_,d,h,n);this.asyncResult=Tg(x);const E=this.currentTransmuxState;return E.contiguous=!0,E.discontinuity=!1,E.trackSwitch=!1,r.executeEnd=dg(),x}flush(t){const e=t.transmuxing;e.executeStart=dg();const{decrypter:n,currentTransmuxState:i,decryptionPromise:r}=this;if(r)return this.asyncResult=!0,r.then(()=>this.flush(t));const s=[],{timeOffset:a}=i;if(n){const e=n.flush();e&&s.push(this.push(e.buffer,null,t))}const{demuxer:o,remuxer:l}=this;if(!o||!l){e.executeEnd=dg();const n=[Sg(t)];return this.asyncResult?Promise.resolve(n):n}const c=o.flush(a);return Tg(c)?(this.asyncResult=!0,c.then(e=>(this.flushRemux(s,e,t),s))):(this.flushRemux(s,c,t),this.asyncResult?Promise.resolve(s):s)}flushRemux(t,e,n){const{audioTrack:i,videoTrack:r,id3Track:s,textTrack:a}=e,{accurateTimeOffset:o,timeOffset:l}=this.currentTransmuxState;this.logger.log("[transmuxer.ts]: Flushed ".concat(this.id," sn: ").concat(n.sn).concat(n.part>-1?" part: "+n.part:""," of ").concat(this.id===Ou?"level":"track"," ").concat(n.level));const c=this.remuxer.remux(i,r,s,a,l,o,!0,this.id);t.push({remuxResult:c,chunkMeta:n}),n.transmuxing.executeEnd=dg()}resetInitialTimestamp(t){const{demuxer:e,remuxer:n}=this;e&&n&&(e.resetTimeStamp(t),n.resetTimeStamp(t))}resetContiguity(){const{demuxer:t,remuxer:e}=this;t&&e&&(t.resetContiguity(),e.resetNextTimestamp())}resetInitSegment(t,e,n,i,r){const{demuxer:s,remuxer:a}=this;s&&a&&(s.resetInitSegment(t,e,n,i),a.resetInitSegment(t,e,n,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,e,n,i,r){let s;return s=e&&"SAMPLE-AES"===e.method?this.transmuxSampleAes(t,e,n,i,r):this.transmuxUnencrypted(t,n,i,r),s}transmuxUnencrypted(t,e,n,i){const{audioTrack:r,videoTrack:s,id3Track:a,textTrack:o}=this.demuxer.demux(t,e,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,s,a,o,e,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(t,e,n,i,r){return this.demuxer.demuxSampleAes(t,e,n).then(t=>({remuxResult:this.remuxer.remux(t.audioTrack,t.videoTrack,t.id3Track,t.textTrack,n,i,!1,this.id),chunkMeta:r}))}configureTransmuxer(t){const{config:e,observer:n,typeSupported:i}=this;let r;for(let u=0,h=Eg.length;u<h;u++){var s;if(null!=(s=Eg[u].demux)&&s.probe(t,this.logger)){r=Eg[u];break}}if(!r)return new Error("Failed to find demuxer by probing fragment data");const a=this.demuxer,o=this.remuxer,l=r.remux,c=r.demux;o&&o instanceof l||(this.remuxer=new l(n,e,i,this.logger)),a&&a instanceof c||(this.demuxer=new c(n,e,i,this.logger),this.probe=c.probe)}needsProbing(t,e){return!this.demuxer||!this.remuxer||t||e}getDecrypter(){let t=this.decrypter;return t||(t=this.decrypter=new hf(this.config)),t}}const Sg=t=>({remuxResult:{},chunkMeta:t});function Tg(t){return"then"in t&&t.then instanceof Function}class Mg{constructor(t,e,n,i,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=e,this.initSegmentData=n,this.duration=i,this.defaultInitPts=r||null}}class Ag{constructor(t,e,n,i,r,s){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=e,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=r,this.initSegmentChange=s}}let Cg=0;class Rg{constructor(t,e,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=Cg++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=t=>{const e=t.data,n=this.hls;if(n&&null!=e&&e.event&&e.instanceNo===this.instanceNo)switch(e.event){case"init":{var i;const t=null==(i=this.workerContext)?void 0:i.objectURL;t&&self.URL.revokeObjectURL(t);break}case"transmuxComplete":this.handleTransmuxComplete(e.data);break;case"flush":this.onFlush(e.data);break;case"workerLog":n.logger[e.data.logType]&&n.logger[e.data.logType](e.data.message);break;default:e.data=e.data||{},e.data.frag=this.frag,e.data.part=this.part,e.data.id=this.id,n.trigger(e.event,e.data)}},this.onWorkerError=t=>{if(!this.hls)return;const e=new Error("".concat(t.message,"  (").concat(t.filename,":").concat(t.lineno,")"));this.hls.config.enableWorker=!1,this.hls.logger.warn('Error in "'.concat(this.id,'" Web Worker, fallback to inline')),this.hls.trigger(ku.ERROR,{type:Cu.OTHER_ERROR,details:Ru.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:e})};const r=t.config;this.hls=t,this.id=e,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const s=(t,e)=>{(e=e||{}).frag=this.frag||void 0,t===ku.ERROR&&(e.parent=this.id,e.part=this.part,this.error=e.error),this.hls.trigger(t,e)};this.observer=new rm,this.observer.on(ku.FRAG_DECRYPTED,s),this.observer.on(ku.ERROR,s);const a=ed(r.preferManagedMediaSource);if(this.useWorker&&"undefined"!==typeof Worker){const n=this.hls.logger;if(r.workerPath||"function"===typeof __HLS_WORKER_BUNDLE__){try{r.workerPath?(n.log("loading Web Worker ".concat(r.workerPath,' for "').concat(e,'"')),this.workerContext=function(t){const e=am[t];if(e)return e.clientCount++,e;const n=new self.URL(t,self.location.href).href,i={worker:new self.Worker(n),scriptURL:n,clientCount:1};return am[t]=i,i}(r.workerPath)):(n.log('injecting Web Worker for "'.concat(e,'"')),this.workerContext=function(){const t=am[sm];if(t)return t.clientCount++,t;const e=new self.Blob(["var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(".concat(__HLS_WORKER_BUNDLE__.toString(),")(true);")],{type:"text/javascript"}),n=self.URL.createObjectURL(e),i={worker:new self.Worker(n),objectURL:n,clientCount:1};return am[sm]=i,i}());const{worker:t}=this.workerContext;t.addEventListener("message",this.onWorkerMessage),t.addEventListener("error",this.onWorkerError),t.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:a,id:e,config:bd(r)})}catch(Yq){n.warn('Error setting up "'.concat(e,'" Web Worker, fallback to inline'),Yq),this.terminateWorker(),this.error=null,this.transmuxer=new wg(this.observer,a,r,"",e,t.logger)}return}}this.transmuxer=new wg(this.observer,a,r,"",e,t.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const t=this.instanceNo;this.instanceNo=Cg++;const e=this.hls.config,n=ed(e.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:t,typeSupported:n,id:this.id,config:bd(e)})}}terminateWorker(){if(this.workerContext){const{worker:t}=this.workerContext;this.workerContext=null,t.removeEventListener("message",this.onWorkerMessage),t.removeEventListener("error",this.onWorkerError),function(t){const e=am[t||sm];if(e&&1===e.clientCount--){const{worker:n,objectURL:i}=e;delete am[t||sm],i&&self.URL.revokeObjectURL(i),n.terminate()}}(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(t,e,n,i,r,s,a,o,l,c){var u,h;l.transmuxing.start=self.performance.now();const{instanceNo:d,transmuxer:f}=this,p=s?s.start:r.start,m=r.decryptdata,g=this.frag,v=!(g&&r.cc===g.cc),y=!(g&&l.level===g.level),_=g?l.sn-g.sn:-1,b=this.part?l.part-this.part.index:-1,x=0===_&&l.id>1&&l.id===(null==g?void 0:g.stats.chunkCount),E=!y&&(1===_||0===_&&(1===b||x&&b<=0)),w=self.performance.now();(y||_||0===r.stats.parsing.start)&&(r.stats.parsing.start=w),!s||!b&&E||(s.stats.parsing.start=w);const S=!(g&&(null==(u=r.initSegment)?void 0:u.url)===(null==(h=g.initSegment)?void 0:h.url)),T=new Ag(v,E,o,y,p,S);if(!E||v||S){this.hls.logger.log("[transmuxer-interface]: Starting new transmux session for ".concat(r.type," sn: ").concat(l.sn).concat(l.part>-1?" part: "+l.part:""," ").concat(this.id===Ou?"level":"track",": ").concat(l.level," id: ").concat(l.id,"\n        discontinuity: ").concat(v,"\n        trackSwitch: ").concat(y,"\n        contiguous: ").concat(E,"\n        accurateTimeOffset: ").concat(o,"\n        timeOffset: ").concat(p,"\n        initSegmentChange: ").concat(S));const t=new Mg(n,i,e,a,c);this.configureTransmuxer(t)}if(this.frag=r,this.part=s,this.workerContext)this.workerContext.worker.postMessage({instanceNo:d,cmd:"demux",data:t,decryptdata:m,chunkMeta:l,state:T},t instanceof ArrayBuffer?[t]:[]);else if(f){const e=f.push(t,m,l,T);Tg(e)?e.then(t=>{this.handleTransmuxComplete(t)}).catch(t=>{this.transmuxerError(t,l,"transmuxer-interface push error")}):this.handleTransmuxComplete(e)}}flush(t){t.transmuxing.start=self.performance.now();const{instanceNo:e,transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:e,cmd:"flush",chunkMeta:t});else if(n){const e=n.flush(t);Tg(e)?e.then(e=>{this.handleFlushResult(e,t)}).catch(e=>{this.transmuxerError(e,t,"transmuxer-interface flush error")}):this.handleFlushResult(e,t)}}transmuxerError(t,e,n){this.hls&&(this.error=t,this.hls.trigger(ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.FRAG_PARSING_ERROR,chunkMeta:e,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:t,err:t,reason:n}))}handleFlushResult(t,e){t.forEach(t=>{this.handleTransmuxComplete(t)}),this.onFlush(e)}configureTransmuxer(t){const{instanceNo:e,transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:e,cmd:"configure",config:t}):n&&n.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}}class kg extends ju{constructor(t,e){super(e,t.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(t,e,n){const i=null==e?void 0:e.renditionReports;if(i){let r=-1;for(let n=0;n<i.length;n++){const s=i[n];let a;try{a=new self.URL(s.URI,e.url).href}catch(CO){this.warn("Could not construct new URL for Rendition Report: ".concat(CO)),a=s.URI||""}if(a===t){r=n;break}a===t.substring(0,a.length)&&(r=n)}if(-1!==r){const t=i[r],s=parseInt(t["LAST-MSN"])||e.lastPartSn;let a=parseInt(t["LAST-PART"])||e.lastPartIndex;if(this.hls.config.lowLatencyMode){const t=Math.min(e.age-e.partTarget,e.targetduration);a>=0&&t>e.partTarget&&(a+=1)}const o=n&&md(n);return new gd(s,a>=0?a:void 0,o)}}}loadPlaylist(t){this.clearTimer()}loadingPlaylist(t,e){this.clearTimer()}shouldLoadPlaylist(t){return this.canLoad&&!!t&&!!t.url&&(!t.details||t.details.live)}getUrlWithDirectives(t,e){if(e)try{return e.addDirectives(t)}catch(CO){this.warn("Could not construct new URL with HLS Delivery Directives: ".concat(CO))}return t}playlistLoaded(t,e,n){const{details:i,stats:r}=e,s=self.performance.now(),a=r.loading.first?Math.max(0,s-r.loading.first):0;i.advancedDateTime=Date.now()-a;const o=this.hls.config.timelineOffset;if(o!==i.appliedTimelineOffset){const t=Math.max(o||0,0);i.appliedTimelineOffset=t,i.fragments.forEach(e=>{e.setStart(e.playlistOffset+t)})}if(i.live||null!=n&&n.live){const o="levelInfo"in e?e.levelInfo:e.track;if(i.reloaded(n),n&&i.fragments.length>0){xp(n,i,this);const t=i.playlistParsingError;if(t){this.warn(t);const n=this.hls;if(!n.config.ignorePlaylistParsingErrors){var l;const{networkDetails:s}=e;return void n.trigger(ku.ERROR,{type:Cu.NETWORK_ERROR,details:Ru.LEVEL_PARSING_ERROR,fatal:!1,url:i.url,error:t,reason:t.message,level:e.level||void 0,parent:null==(l=i.fragments[0])?void 0:l.type,networkDetails:s,stats:r})}i.playlistParsingError=null}}-1===i.requestScheduled&&(i.requestScheduled=r.loading.start);const c=this.hls.mainForwardBufferInfo,u=c?c.end-c.len:0,h=Tp(i,1e3*(i.edge-u));if(i.requestScheduled+h<s?i.requestScheduled=s:i.requestScheduled+=h,this.log("live playlist ".concat(t," ").concat(i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED")),!this.canLoad||!i.live)return;let d,f,p;if(i.canBlockReload&&i.endSN&&i.advanced){const t=this.hls.config.lowLatencyMode,r=i.lastPartSn,a=i.endSN,l=i.lastPartIndex,c=r===a;-1!==l?c?(f=a+1,p=t?0:l):(f=r,p=t?l+1:i.maxPartIndex):f=a+1;const u=i.age,h=u+i.ageHeader;let m=Math.min(h-i.partTarget,1.5*i.targetduration);if(m>0){if(h>3*i.targetduration)this.log("Playlist last advanced ".concat(u.toFixed(2),"s ago. Omitting segment and part directives.")),f=void 0,p=void 0;else if(null!=n&&n.tuneInGoal&&h-i.partTarget>n.tuneInGoal)this.warn("CDN Tune-in goal increased from: ".concat(n.tuneInGoal," to: ").concat(m," with playlist age: ").concat(i.age)),m=0;else{const t=Math.floor(m/i.targetduration);if(f+=t,void 0!==p){p+=Math.round(m%i.targetduration/i.partTarget)}this.log("CDN Tune-in age: ".concat(i.ageHeader,"s last advanced ").concat(u.toFixed(2),"s goal: ").concat(m," skip sn ").concat(t," to part ").concat(p))}i.tuneInGoal=m}if(d=this.getDeliveryDirectives(i,e.deliveryDirectives,f,p),t||!c)return i.requestScheduled=s,void this.loadingPlaylist(o,d)}else(i.canBlockReload||i.canSkipUntil)&&(d=this.getDeliveryDirectives(i,e.deliveryDirectives,f,p));d&&void 0!==f&&i.canBlockReload&&(i.requestScheduled=r.loading.first+Math.max(h-2*a,h/2)),this.scheduleLoading(o,d,i)}else this.clearTimer()}scheduleLoading(t,e,n){const i=n||t.details;if(!i)return void this.loadingPlaylist(t,e);const r=self.performance.now(),s=i.requestScheduled;if(r>=s)return void this.loadingPlaylist(t,e);const a=s-r;this.log("reload live playlist ".concat(t.name||t.bitrate+"bps"," in ").concat(Math.round(a)," ms")),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(t,e),a)}getDeliveryDirectives(t,e,n,i){let r=md(t);return null!=e&&e.skip&&t.deltaUpdateFailed&&(n=e.msn,i=e.part,r=dd),new gd(n,i,r)}checkRetry(t){const e=t.details,n=Id(t),i=t.errorAction,{action:r,retryCount:s=0,retryConfig:a}=i||{},o=!!i&&!!a&&(r===Wd||!i.resolved&&r===Gd);if(o){var l;if(s>=a.maxNumRetry)return!1;if(n&&null!=(l=t.context)&&l.deliveryDirectives)this.warn("Retrying playlist loading ".concat(s+1,"/").concat(a.maxNumRetry,' after "').concat(e,'" without delivery-directives')),this.loadPlaylist();else{const t=Ud(a,s);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),t),this.warn("Retrying playlist loading ".concat(s+1,"/").concat(a.maxNumRetry,' after "').concat(e,'" in ').concat(t,"ms"))}t.levelRetry=!0,i.resolved=!0}return o}}function Lg(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Dg(t[n].attrs,e[n].attrs))return!1;return!0}function Dg(t,e,n){const i=t["STABLE-RENDITION-ID"];return i&&!n?i===e["STABLE-RENDITION-ID"]:!(n||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(n=>t[n]!==e[n])}function Pg(t,e){return e.label.toLowerCase()===t.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(t.lang||"").toLowerCase())}class Ig{constructor(t){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=t}destroy(){this.tracks=this.queues=null}append(t,e,n){if(null===this.queues||null===this.tracks)return;const i=this.queues[e];i.push(t),1!==i.length||n||this.executeNext(e)}appendBlocker(t){return new Promise(e=>{const n={label:"async-blocker",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(n,t)})}prependBlocker(t){return new Promise(e=>{if(this.queues){const n={label:"async-blocker-prepend",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[t].unshift(n)}})}removeBlockers(){null!==this.queues&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(t=>{var e;const n=null==(e=t[0])?void 0:e.label;"async-blocker"!==n&&"async-blocker-prepend"!==n||(t[0].execute(),t.splice(0,1))})}unblockAudio(t){if(null===this.queues)return;this.queues.audio[0]===t&&this.shiftAndExecuteNext("audio")}executeNext(t){if(null===this.queues||null===this.tracks)return;const e=this.queues[t];if(e.length){const i=e[0];try{i.execute()}catch(CO){var n;if(i.onError(CO),null===this.queues||null===this.tracks)return;const r=null==(n=this.tracks[t])?void 0:n.buffer;null!=r&&r.updating||this.shiftAndExecuteNext(t)}}}shiftAndExecuteNext(t){null!==this.queues&&(this.queues[t].shift(),this.executeNext(t))}current(t){var e;return(null==(e=this.queues)?void 0:e[t][0])||null}toString(){const{queues:t,tracks:e}=this;return null===t||null===e?"<destroyed>":"\n".concat(this.list("video"),"\n").concat(this.list("audio"),"\n").concat(this.list("audiovideo"),"}")}list(t){var e,n;return null!=(e=this.queues)&&e[t]||null!=(n=this.tracks)&&n[t]?"".concat(t,": (").concat(this.listSbInfo(t),") ").concat(this.listOps(t)):""}listSbInfo(t){var e;const n=null==(e=this.tracks)?void 0:e[t],i=null==n?void 0:n.buffer;return i?"SourceBuffer".concat(i.updating?" updating":"").concat(n.ended?" ended":"").concat(n.ending?" ending":""):"none"}listOps(t){var e;return(null==(e=this.queues)?void 0:e[t].map(t=>t.label).join(", "))||""}}const Og=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,Ng="HlsJsTrackRemovedError";class Fg extends Error{constructor(t){super(t),this.name=Ng}}function Ug(t){const e=t.querySelectorAll("source");[].slice.call(e).forEach(e=>{t.removeChild(e)})}function Bg(t){return"audio"===t?1:0}class zg{constructor(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:t}=this;t.on(ku.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(ku.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(ku.MANIFEST_PARSED,this.onManifestParsed,this),t.on(ku.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(ku.BUFFER_CODECS,this.onBufferCodecs,this),t.on(ku.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:t}=this;t.off(ku.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(ku.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(ku.MANIFEST_PARSED,this.onManifestParsed,this),t.off(ku.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(ku.BUFFER_CODECS,this.onBufferCodecs,this),t.off(ku.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,e){const n=this.hls.levels[e.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(t,e){this.media=e.media instanceof HTMLVideoElement?e.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(t,e){const n=this.hls;this.restrictedLevels=[],this.firstLevel=e.firstLevel,n.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onLevelsUpdated(t,e){this.timer&&Tu(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(t,e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const t=this.hls.levels;if(t.length){const e=this.hls,n=this.getMaxLevel(t.length-1);n!==this.autoLevelCapping&&e.logger.log("Setting autoLevelCapping to ".concat(n,": ").concat(t[n].height,"p@").concat(t[n].bitrate," for media ").concat(this.mediaWidth,"x").concat(this.mediaHeight)),e.autoLevelCapping=n,e.autoLevelEnabled&&e.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}}getMaxLevel(t){const e=this.hls.levels;if(!e.length)return-1;const n=e.filter((e,n)=>this.isLevelAllowed(e)&&n<=t);return this.clientRect=null,zg.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const t=this.media,e={width:0,height:0};if(t){const n=t.getBoundingClientRect();e.width=n.width,e.height=n.height,e.width||e.height||(e.width=n.right-n.left||t.width||0,e.height=n.bottom-n.top||t.height||0)}return this.clientRect=e,e}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch(Wq){}return Math.min(t,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(t){return!this.restrictedLevels.some(e=>t.bitrate===e.bitrate&&t.width===e.width&&t.height===e.height)}static getMaxLevelByMediaSize(t,e,n){if(null==t||!t.length)return-1;const i=(t,e)=>!e||(t.width!==e.width||t.height!==e.height);let r=t.length-1;const s=Math.max(e,n);for(let a=0;a<t.length;a+=1){const e=t[a];if((e.width>=s||e.height>=s)&&i(e,t[a+1])){r=a;break}}return r}}const Hg={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},Vg={HLS:"h"};class Gg{constructor(t,e){Array.isArray(t)&&(t=t.map(t=>t instanceof Gg?t:new Gg(t))),this.value=t,this.params=e}}function jg(t,e,n,i){return new Error("failed to ".concat(t,' "').concat((r=e,Array.isArray(r)?JSON.stringify(r):r instanceof Map?"Map{}":r instanceof Set?"Set{}":"object"===typeof r?JSON.stringify(r):String(r)),'" as ').concat(n),{cause:i});var r}function Wg(t,e,n){return jg("serialize",t,e,n)}class Yg{constructor(t){this.description=t}}const Xg="Bare Item";function Kg(t){if(!1===ArrayBuffer.isView(t))throw Wg(t,"Byte Sequence");return":".concat((e=t,btoa(String.fromCharCode(...e))),":");var e}function qg(t){if(function(t){return t<-999999999999999||999999999999999<t}(t))throw Wg(t,"Integer");return t.toString()}function Qg(t,e){if(t<0)return-Qg(-t,e);const n=Math.pow(10,e);if(Math.abs(t*n%1-.5)<Number.EPSILON){const e=Math.floor(t*n);return(e%2===0?e:e+1)/n}return Math.round(t*n)/n}function Zg(t){const e=Qg(t,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Wg(t,"Decimal");const n=e.toString();return n.includes(".")?n:"".concat(n,".0")}const Jg=/[\x00-\x1f\x7f]+/;function $g(t){const e=(n=t).description||n.toString().slice(7,-1);var n;if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e))throw Wg(e,"Token");return e}function tv(t){switch(typeof t){case"number":if(!Tu(t))throw Wg(t,Xg);return Number.isInteger(t)?qg(t):Zg(t);case"string":return function(t){if(Jg.test(t))throw Wg(t,"String");return'"'.concat(t.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),'"')}(t);case"symbol":return $g(t);case"boolean":return function(t){if("boolean"!==typeof t)throw Wg(t,"Boolean");return t?"?1":"?0"}(t);case"object":if(t instanceof Date)return function(t){return"@".concat(qg(t.getTime()/1e3))}(t);if(t instanceof Uint8Array)return Kg(t);if(t instanceof Yg)return $g(t);default:throw Wg(t,Xg)}}function ev(t){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(t))throw Wg(t,"Key");return t}function nv(t){return null==t?"":Object.entries(t).map(t=>{let[e,n]=t;return!0===n?";".concat(ev(e)):";".concat(ev(e),"=").concat(tv(n))}).join("")}function iv(t){return t instanceof Gg?"".concat(tv(t.value)).concat(nv(t.params)):tv(t)}function rv(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{whitespace:!0};if("object"!==typeof t||null==t)throw Wg(t,"Dict");const n=t instanceof Map?t.entries():Object.entries(t),i=(null===e||void 0===e?void 0:e.whitespace)?" ":"";return Array.from(n).map(t=>{let[e,n]=t;n instanceof Gg===!1&&(n=new Gg(n));let i=ev(e);var r;return!0===n.value?i+=nv(n.params):(i+="=",Array.isArray(n.value)?i+="(".concat((r=n).value.map(iv).join(" "),")").concat(nv(r.params)):i+=iv(n)),i}).join(",".concat(i))}function sv(t,e){return rv(t,e)}const av="CMCD-Object",ov="CMCD-Request",lv="CMCD-Session",cv="CMCD-Status",uv={br:av,ab:av,d:av,ot:av,tb:av,tpb:av,lb:av,tab:av,lab:av,url:av,pb:ov,bl:ov,tbl:ov,dl:ov,ltc:ov,mtp:ov,nor:ov,nrr:ov,rc:ov,sn:ov,sta:ov,su:ov,ttfb:ov,ttfbb:ov,ttlb:ov,cmsdd:ov,cmsds:ov,smrt:ov,df:ov,cs:ov,ts:ov,cid:lv,pr:lv,sf:lv,sid:lv,st:lv,v:lv,msd:lv,bs:cv,bsd:cv,cdn:cv,rtp:cv,bg:cv,pt:cv,ec:cv,e:cv},hv=ov;function dv(t,e){const n={};if(!t)return n;const i=Object.keys(t),r=e?(s=e,Object.keys(s).reduce((t,e)=>{var n;return null===(n=s[e])||void 0===n||n.forEach(n=>t[n]=e),t},{})):{};var s;return i.reduce((e,n)=>{var i;const s=uv[n]||r[n]||hv;return(null!==(i=e[s])&&void 0!==i?i:e[s]={})[n]=t[n],e},n)}const fv="event";const pv=t=>Math.round(t),mv=(t,e)=>Array.isArray(t)?t.map(t=>mv(t,e)):t instanceof Gg&&"string"===typeof t.value?new Gg(mv(t.value,e),t.params):(e.baseUrl&&(t=function(t,e){const n=new URL(t),i=new URL(e);if(n.origin!==i.origin)return t;const r=n.pathname.split("/").slice(1),s=i.pathname.split("/").slice(1,-1);for(;r[0]===s[0];)r.shift(),s.shift();for(;s.length;)s.shift(),r.unshift("..");return r.join("/")+n.search+n.hash}(t,e.baseUrl)),1===e.version?encodeURIComponent(t):t),gv=t=>100*pv(t/100),vv={br:pv,d:pv,bl:gv,dl:gv,mtp:gv,nor:(t,e)=>{let n=t;return e.version>=2&&(t instanceof Gg&&"string"===typeof t.value?n=new Gg([t]):"string"===typeof t&&(n=[t])),mv(n,e)},rtp:gv,tb:pv},yv="request",_v="response",bv=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],xv=["e"],Ev=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function wv(t){return Ev.test(t)}const Sv=["d","dl","nor","ot","rtp","su"];const Tv=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];const Mv=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function Av(t){return Mv.includes(t)||wv(t)}const Cv={[_v]:function(t){return bv.includes(t)||Sv.includes(t)||Tv.includes(t)||wv(t)},[fv]:function(t){return bv.includes(t)||xv.includes(t)||wv(t)},[yv]:function(t){return bv.includes(t)||Sv.includes(t)||wv(t)}};function Rv(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={};if(null==t||"object"!==typeof t)return n;const i=e.version||t.v||1,r=e.reportingMode||yv,s=1===i?Av:Cv[r];let a=Object.keys(t).filter(s);const o=e.filter;"function"===typeof o&&(a=a.filter(o));const l=r===_v||r===fv;l&&!a.includes("ts")&&a.push("ts"),i>1&&!a.includes("v")&&a.push("v");const c=Hu({},vv,e.formatters),u={version:i,reportingMode:r,baseUrl:e.baseUrl};return a.sort().forEach(e=>{let r=t[e];const s=c[e];if("function"===typeof s&&(r=s(r,u)),"v"===e){if(1===i)return;r=i}"pr"==e&&1===r||(l&&"ts"===e&&!Tu(r)&&(r=Date.now()),function(t){return"number"===typeof t?Tu(t):null!=t&&""!==t&&!1!==t}(r)&&(function(t){return["ot","sf","st","e","sta"].includes(t)}(e)&&"string"===typeof r&&(r=new Yg(r)),n[e]=r))}),n}function kv(t,e,n){return Hu(t,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={};if(!t)return n;const i=dv(Rv(t,e),null===e||void 0===e?void 0:e.customHeaderMap);return Object.entries(i).reduce((t,e)=>{let[n,i]=e;const r=sv(i,{whitespace:!1});return r&&(t[n]=r),t},n)}(e,n))}function Lv(t){if(!t)return"";const e=function(t){return t?sv(Rv(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),{whitespace:!1}):""}(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});return encodeURIComponent(e)}const Dv=/CMCD=[^&#]+/;function Pv(t,e,n){const i=function(t){if(!t)return"";const e=Lv(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});return"".concat("CMCD","=").concat(e)}(e,n);if(!i)return t;if(Dv.test(t))return t.replace(Dv,i);const r=t.includes("?")?"&":"?";return"".concat(t).concat(r).concat(i)}function Iv(t,e,n,i){t&&Object.keys(e).forEach(r=>{const s=t.filter(t=>t.groupId===r).map(t=>{const s=Hu({},t);return s.details=void 0,s.attrs=new Cf(s.attrs),s.url=s.attrs.URI=Ov(t.url,t.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),s.groupId=s.attrs["GROUP-ID"]=e[r],s.attrs["PATHWAY-ID"]=i,s});t.push(...s)})}function Ov(t,e,n,i){const{HOST:r,PARAMS:s,[n]:a}=i;let o;e&&(o=null==a?void 0:a[e],o&&(t=o));const l=new self.URL(t);return r&&!o&&(l.host=r),s&&Object.keys(s).sort().forEach(t=>{t&&l.searchParams.set(t,s[t])}),l.href}class Nv extends ju{constructor(t){super("eme",t.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Nv.CDMCleanupPromise?[Nv.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=t=>{const{initDataType:e,initData:n}=t,i='"'.concat(t.type,'" event: init data type: "').concat(e,'"');if(this.debug(i),null!==n){if(!this.keyFormatPromise){let t=Object.keys(this.keySystemAccessPromises);t.length||(t=qf(this.config));const e=t.map(Kf).filter(t=>!!t);this.keyFormatPromise=this.getKeyFormatPromise(e)}this.keyFormatPromise.then(r=>{const s=Xf(r);if("sinf"!==e||s!==Vf.FAIRPLAY)return void this.log('Ignoring "'.concat(t.type,'" event with init data type: "').concat(e,'" for selected key-system ').concat(s));let a;try{const t=yh(new Uint8Array(n)),e=Dh(Ff(JSON.parse(t).sinf));if(!e)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");a=new Uint8Array(e.subarray(8,24))}catch(CO){return void this.warn("".concat(i," Failed to parse sinf: ").concat(CO))}const o=th(a),{keyIdToKeySessionPromise:l,mediaKeySessions:c}=this;let u=l[o];for(let t=0;t<c.length;t++){const i=c[t],r=i.decryptdata;if(!r.keyId)continue;const s=th(r.keyId);if(Pf(a,r.keyId)||-1!==r.uri.replace(/-/g,"").indexOf(o)){if(u=l[s],!u)continue;if(r.pssh)break;delete l[s],r.pssh=new Uint8Array(n),r.keyId=a,u=l[o]=u.then(()=>this.generateRequestWithPreferredKeySession(i,e,n,"encrypted-event-key-match")),u.catch(t=>this.handleError(t));break}}u||this.handleError(new Error("Key ID ".concat(o," not encountered in playlist. Key-system sessions ").concat(c.length,".")))}).catch(t=>this.handleError(t))}},this.onWaitingForKey=t=>{this.log('"'.concat(t.type,'" event'))},this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(ku.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(ku.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(ku.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(ku.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(ku.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(ku.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(ku.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(ku.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(ku.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(ku.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(t){const{drmSystems:e,widevineLicenseUrl:n}=this.config,i=null==e?void 0:e[t];return i?i.licenseUrl:t===Vf.WIDEVINE&&n?n:void 0}getLicenseServerUrlOrThrow(t){const e=this.getLicenseServerUrl(t);if(void 0===e)throw new Error('no license server URL configured for key-system "'.concat(t,'"'));return e}getServerCertificateUrl(t){const{drmSystems:e}=this.config,n=null==e?void 0:e[t];if(n)return n.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'.concat(t,'"]'))}attemptKeySystemAccess(t){const e=this.hls.levels,n=(t,e,n)=>!!t&&n.indexOf(t)===e,i=e.map(t=>t.audioCodec).filter(n),r=e.map(t=>t.videoCodec).filter(n);return i.length+r.length===0&&r.push("avc1.42e01e"),new Promise((e,n)=>{const s=t=>{const a=t.shift();this.getMediaKeysPromise(a,i,r).then(t=>e({keySystem:a,mediaKeys:t})).catch(e=>{t.length?s(t):n(e instanceof Bv?e:new Bv({type:Cu.KEY_SYSTEM_ERROR,details:Ru.KEY_SYSTEM_NO_ACCESS,error:e,fatal:!0},e.message))})};s(t)})}requestMediaKeySystemAccess(t,e){const{requestMediaKeySystemAccessFunc:n}=this.config;if("function"!==typeof n){let t="Configured requestMediaKeySystemAccess is not a function ".concat(n);return null===Qf&&"http:"===self.location.protocol&&(t="navigator.requestMediaKeySystemAccess is not available over insecure protocol ".concat(location.protocol)),Promise.reject(new Error(t))}return n(t,e)}getMediaKeysPromise(t,e,n){var i;const r=function(t,e,n,i){let r;switch(t){case Vf.FAIRPLAY:r=["cenc","sinf"];break;case Vf.WIDEVINE:case Vf.PLAYREADY:r=["cenc"];break;case Vf.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error("Unknown key-system: ".concat(t))}return function(t,e,n,i){return[{initDataTypes:t,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:e.map(t=>({contentType:"audio/mp4; codecs=".concat(t),robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:n.map(t=>({contentType:"video/mp4; codecs=".concat(t),robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}(r,e,n,i)}(t,e,n,this.config.drmSystemOptions||{});let s=this.keySystemAccessPromises[t],a=null==(i=s)?void 0:i.keySystemAccess;if(!a){this.log('Requesting encrypted media "'.concat(t,'" key-system access with config: ').concat(bd(r))),a=this.requestMediaKeySystemAccess(t,r);const e=s=this.keySystemAccessPromises[t]={keySystemAccess:a};return a.catch(e=>{this.log('Failed to obtain access to key-system "'.concat(t,'": ').concat(e))}),a.then(n=>{this.log('Access for key-system "'.concat(n.keySystem,'" obtained'));const i=this.fetchServerCertificate(t);this.log('Create media-keys for "'.concat(t,'"'));const r=e.mediaKeys=n.createMediaKeys().then(n=>(this.log('Media-keys created for "'.concat(t,'"')),e.hasMediaKeys=!0,i.then(e=>e?this.setMediaKeysServerCertificate(n,t,e):n)));return r.catch(e=>{this.error('Failed to create media-keys for "'.concat(t,'"}: ').concat(e))}),r})}return a.then(()=>s.mediaKeys)}createMediaKeySessionContext(t){let{decryptdata:e,keySystem:n,mediaKeys:i}=t;this.log('Creating key-system session "'.concat(n,'" keyId: ').concat(th(e.keyId||[])," keyUri: ").concat(e.uri));const r=i.createSession(),s={decryptdata:e,keySystem:n,mediaKeys:i,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(t){const e=t.decryptdata;if(e.pssh){const n=this.createMediaKeySessionContext(t),i=Fv(e),r="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,r,e.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)}updateKeySession(t,e){const n=t.mediaKeysSession;return this.log('Updating key-session "'.concat(n.sessionId,'" for keyId ').concat(th(t.decryptdata.keyId||[]),"\n      } (data length: ").concat(e.byteLength,")")),n.update(e)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(t=>({keySystem:t,hasMediaKeys:this.keySystemAccessPromises[t].hasMediaKeys})).filter(t=>{let{hasMediaKeys:e}=t;return!!e}).map(t=>{let{keySystem:e}=t;return Kf(e)}).filter(t=>!!t)}getKeySystemAccess(t){return this.getKeySystemSelectionPromise(t).then(t=>{let{keySystem:e,mediaKeys:n}=t;return this.attemptSetMediaKeys(e,n)})}selectKeySystem(t){return new Promise((e,n)=>{this.getKeySystemSelectionPromise(t).then(t=>{let{keySystem:i}=t;const r=Kf(i);r?e(r):n(new Error('Unable to find format for key-system "'.concat(i,'"')))}).catch(n)})}selectKeySystemFormat(t){const e=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: ".concat(t.sn," ").concat(t.type,": ").concat(t.level,") key formats ").concat(e.join(", "))),this.keyFormatPromise=this.getKeyFormatPromise(e)),this.keyFormatPromise}getKeyFormatPromise(t){const e=qf(this.config),n=t.map(Xf).filter(t=>!!t&&-1!==e.indexOf(t));return this.selectKeySystem(n)}getKeyStatus(t){const{mediaKeySessions:e}=this;for(let n=0;n<e.length;n++){const i=Uv(t,e[n]);if(i)return i}}loadKey(t){const e=t.keyInfo.decryptdata,n=Fv(e),i=this.bannedKeyIds[n];if(i||"internal-error"===this.getKeyStatus(e)){const n=zv(i||"internal-error",e);return this.handleError(n,t.frag),Promise.reject(n)}const r="(keyId: ".concat(n,' format: "').concat(e.keyFormat,'" method: ').concat(e.method," uri: ").concat(e.uri,")");this.log("Starting session for key ".concat(r));const s=this.keyIdToKeySessionPromise[n];if(!s){const i=this.getKeySystemForKeyPromise(e).then(n=>{let{keySystem:i,mediaKeys:s}=n;return this.throwIfDestroyed(),this.log("Handle encrypted media sn: ".concat(t.frag.sn," ").concat(t.frag.type,": ").concat(t.frag.level," using key ").concat(r)),this.attemptSetMediaKeys(i,s).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:i,mediaKeys:s,decryptdata:e})))}).then(t=>{const n=e.pssh?e.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(t,"cenc",n,"playlist-key")});return i.catch(e=>this.handleError(e,t.frag)),this.keyIdToKeySessionPromise[n]=i,i}return s.catch(n=>{if(n instanceof Bv){const i=Gu({},n.data);"internal-error"===this.getKeyStatus(e)&&(i.decryptdata=e);const r=new Bv(i,n.message);this.handleError(r,t.frag)}}),s}throwIfDestroyed(){if(!this.hls)throw new Error("invalid state")}handleError(t,e){if(this.hls)if(t instanceof Bv){e&&(t.data.frag=e);const n=t.data.decryptdata;this.error("".concat(t.message).concat(n?" (".concat(th(n.keyId||[]),")"):"")),this.hls.trigger(ku.ERROR,t.data)}else this.error(t.message),this.hls.trigger(ku.ERROR,{type:Cu.KEY_SYSTEM_ERROR,details:Ru.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0})}getKeySystemForKeyPromise(t){const e=Fv(t),n=this.keyIdToKeySessionPromise[e];if(!n){const e=Xf(t.keyFormat),n=e?[e]:qf(this.config);return this.attemptKeySystemAccess(n)}return n}getKeySystemSelectionPromise(t){if(t.length||(t=qf(this.config)),0===t.length)throw new Bv({type:Cu.KEY_SYSTEM_ERROR,details:Ru.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options ".concat(bd({drmSystems:this.config.drmSystems})));return this.attemptKeySystemAccess(t)}attemptSetMediaKeys(t,e){if(this.mediaResolved=void 0,this.mediaKeys===e)return Promise.resolve();const n=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'.concat(t,'"'));const i=Promise.all(n).then(()=>this.media?this.media.setMediaKeys(e):new Promise((t,n)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return n(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=e,this.media.setMediaKeys(e).then(t).catch(n)}}));return this.mediaKeys=e,this.setMediaKeysQueue.push(i),i.then(()=>{this.log('Media-keys set for "'.concat(t,'"')),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(t=>-1===n.indexOf(t))})}generateRequestWithPreferredKeySession(t,e,n,i){var r;const s=null==(r=this.config.drmSystems)||null==(r=r[t.keySystem])?void 0:r.generateRequest;if(s)try{const i=s.call(this.hls,e,n,t);if(!i)throw new Error("Invalid response from configured generateRequest filter");e=i.initDataType,n=i.initData?i.initData:null,t.decryptdata.pssh=n?new Uint8Array(n):null}catch(CO){if(this.warn(CO.message),this.hls&&this.hls.config.debug)throw CO}if(null===n)return this.log('Skipping key-session request for "'.concat(i,'" (no initData)')),Promise.resolve(t);const a=Fv(t.decryptdata),o=t.decryptdata.uri;this.log('Generating key-session request for "'.concat(i,'" keyId: ').concat(a," URI: ").concat(o," (init data type: ").concat(e," length: ").concat(n.byteLength,")"));const l=new rm,c=t._onmessage=e=>{const n=t.mediaKeysSession;if(!n)return void l.emit("error",new Error("invalid state"));const{messageType:i,message:r}=e;this.log('"'.concat(i,'" message event for session "').concat(n.sessionId,'" message size: ').concat(r.byteLength)),"license-request"===i||"license-renewal"===i?this.renewLicense(t,r).catch(t=>{l.eventNames().length?l.emit("error",t):this.handleError(t)}):"license-release"===i?t.keySystem===Vf.FAIRPLAY&&this.updateKeySession(t,Uf("acknowledged")).then(()=>this.removeSession(t)).catch(t=>this.handleError(t)):this.warn('unhandled media key message type "'.concat(i,'"'))},u=(t,e)=>{let n;e.keyStatus=t,t.startsWith("usable")?l.emit("resolved"):"internal-error"===t||"output-restricted"===t||"output-downscaled"===t?n=zv(t,e.decryptdata):"expired"===t?n=new Error("key expired (keyId: ".concat(a,")")):"released"===t?n=new Error("key released"):"status-pending"===t||this.warn('unhandled key status change "'.concat(t,'" (keyId: ').concat(a,")")),n&&(l.eventNames().length?l.emit("error",n):this.handleError(n))},h=t._onkeystatuseschange=e=>{if(!t.mediaKeysSession)return void l.emit("error",new Error("invalid state"));const n=this.getKeyStatuses(t);if(!Object.keys(n).some(t=>"status-pending"!==n[t]))return;if("expired"===n[a])return this.log("Expired key ".concat(bd(n),' in key-session "').concat(t.mediaKeysSession.sessionId,'"')),void this.renewKeySession(t);let i=n[a];if(i)u(i,t);else{var r;const e=1e3;t.keyStatusTimeouts||(t.keyStatusTimeouts={}),(r=t.keyStatusTimeouts)[a]||(r[a]=self.setTimeout(()=>{if(!t.mediaKeysSession||!this.mediaKeys)return;const n=this.getKeyStatus(t.decryptdata);if(n&&"status-pending"!==n)return this.log("No status for keyId ".concat(a,' in key-session "').concat(t.mediaKeysSession.sessionId,'". Using session key-status ').concat(n," from other session.")),u(n,t);this.log("key status for ".concat(a,' in key-session "').concat(t.mediaKeysSession.sessionId,'" timed out after ').concat(e,"ms")),i="internal-error",u(i,t)},e)),this.log("No status for keyId ".concat(a," (").concat(bd(n),")."))}};Fp(t.mediaKeysSession,"message",c),Fp(t.mediaKeysSession,"keystatuseschange",h);const d=new Promise((t,e)=>{l.on("error",e),l.on("resolved",t)});return t.mediaKeysSession.generateRequest(e,n).then(()=>{this.log('Request generated for key-session "'.concat(t.mediaKeysSession.sessionId,'" keyId: ').concat(a," URI: ").concat(o))}).catch(e=>{throw new Bv({type:Cu.KEY_SYSTEM_ERROR,details:Ru.KEY_SYSTEM_NO_SESSION,error:e,decryptdata:t.decryptdata,fatal:!1},"Error generating key-session request: ".concat(e))}).then(()=>d).catch(e=>(l.removeAllListeners(),this.removeSession(t).then(()=>{throw e}))).then(()=>(l.removeAllListeners(),t))}getKeyStatuses(t){const e={};return t.mediaKeysSession.keyStatuses.forEach((n,i)=>{if("string"===typeof i&&"object"===typeof n){const t=i;i=n,n=t}const r="buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i);if(t.keySystem===Vf.PLAYREADY&&16===r.length){const t=th(r);e[t]=n,Bf(r)}const s=th(r);"internal-error"===n&&(this.bannedKeyIds[s]=n),this.log('key status change "'.concat(n,'" for keyStatuses keyId: ').concat(s,' key-session "').concat(t.mediaKeysSession.sessionId,'"')),e[s]=n}),e}fetchServerCertificate(t){const e=this.config,n=new(0,e.loader)(e),i=this.getServerCertificateUrl(t);return i?(this.log('Fetching server certificate for "'.concat(t,'"')),new Promise((r,s)=>{const a={responseType:"arraybuffer",url:i},o=e.certLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(t,e,n,i)=>{r(t.data)},onError:(e,n,r,o)=>{s(new Bv({type:Cu.KEY_SYSTEM_ERROR,details:Ru.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:Gu({url:a.url,data:void 0},e)},'"'.concat(t,'" certificate request failed (').concat(i,"). Status: ").concat(e.code," (").concat(e.text,")")))},onTimeout:(e,n,r)=>{s(new Bv({type:Cu.KEY_SYSTEM_ERROR,details:Ru.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:{url:a.url,data:void 0}},'"'.concat(t,'" certificate request timed out (').concat(i,")")))},onAbort:(t,e,n)=>{s(new Error("aborted"))}};n.load(a,l,c)})):Promise.resolve()}setMediaKeysServerCertificate(t,e,n){return new Promise((i,r)=>{t.setServerCertificate(n).then(r=>{this.log("setServerCertificate ".concat(r?"success":"not supported by CDM"," (").concat(n.byteLength,') on "').concat(e,'"')),i(t)}).catch(t=>{r(new Bv({type:Cu.KEY_SYSTEM_ERROR,details:Ru.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:t,fatal:!0},t.message))})})}renewLicense(t,e){return this.requestLicense(t,new Uint8Array(e)).then(e=>this.updateKeySession(t,new Uint8Array(e)).catch(e=>{throw new Bv({type:Cu.KEY_SYSTEM_ERROR,details:Ru.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:t.decryptdata,error:e,fatal:!1},e.message)}))}unpackPlayReadyKeyMessage(t,e){const n=String.fromCharCode.apply(null,new Uint16Array(e.buffer));if(!n.includes("PlayReadyKeyMessage"))return t.setRequestHeader("Content-Type","text/xml; charset=utf-8"),e;const i=(new DOMParser).parseFromString(n,"application/xml"),r=i.querySelectorAll("HttpHeader");if(r.length>0){let e;for(let n=0,i=r.length;n<i;n++){var s,a;e=r[n];const i=null==(s=e.querySelector("name"))?void 0:s.textContent,o=null==(a=e.querySelector("value"))?void 0:a.textContent;i&&o&&t.setRequestHeader(i,o)}}const o=i.querySelector("Challenge"),l=null==o?void 0:o.textContent;if(!l)throw new Error("Cannot find <Challenge> in key message");return Uf(atob(l))}setupLicenseXHR(t,e,n,i){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return r.call(this.hls,t,e,n,i)}).catch(s=>{if(!n.decryptdata)throw s;return t.open("POST",e,!0),r.call(this.hls,t,e,n,i)}).then(n=>{t.readyState||t.open("POST",e,!0);return{xhr:t,licenseChallenge:n||i}}):(t.open("POST",e,!0),Promise.resolve({xhr:t,licenseChallenge:i}))}requestLicense(t,e){const n=this.config.keyLoadPolicy.default;return new Promise((i,r)=>{const s=this.getLicenseServerUrlOrThrow(t.keySystem);this.log("Sending license request to URL: ".concat(s));const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!t.mediaKeysSession)return r(new Error("invalid state"));if(4===a.readyState)if(200===a.status){this._requestLicenseFailureCount=0;let e=a.response;this.log("License received ".concat(e instanceof ArrayBuffer?e.byteLength:e));const n=this.config.licenseResponseCallback;if(n)try{e=n.call(this.hls,a,s,t)}catch(CO){this.error(CO)}i(e)}else{const o=n.errorRetry,l=o?o.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||a.status>=400&&a.status<500)r(new Bv({type:Cu.KEY_SYSTEM_ERROR,details:Ru.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:t.decryptdata,fatal:!0,networkDetails:a,response:{url:s,data:void 0,code:a.status,text:a.statusText}},"License Request XHR failed (".concat(s,"). Status: ").concat(a.status," (").concat(a.statusText,")")));else{const n=l-this._requestLicenseFailureCount+1;this.warn("Retrying license request, ".concat(n," attempts left")),this.requestLicense(t,e).then(i,r)}}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=a,this.setupLicenseXHR(a,s,t,e).then(e=>{let{xhr:n,licenseChallenge:i}=e;t.keySystem==Vf.PLAYREADY&&(i=this.unpackPlayReadyKeyMessage(n,i)),n.send(i)}).catch(r)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(t,e){if(!this.config.emeEnabled)return;const n=e.media;this.media=n,Fp(n,"encrypted",this.onMediaEncrypted),Fp(n,"waitingforkey",this.onWaitingForKey);const i=this.mediaResolved;i?i():this.mediaKeys=n.mediaKeys}onMediaDetached(){const t=this.media;t&&(Up(t,"encrypted",this.onMediaEncrypted),Up(t,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var t;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const e=this.mediaResolved;if(e&&e(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const n=this.media,i=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,tp.clearKeyUriToKeyIdMap();const r=i.length;Nv.CDMCleanupPromise=Promise.all(i.map(t=>this.removeSession(t)).concat((null==n||null==(t=n.setMediaKeys(null))?void 0:t.catch(t=>{this.log("Could not clear media keys: ".concat(t)),this.hls&&this.hls.trigger(ku.ERROR,{type:Cu.OTHER_ERROR,details:Ru.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error("Could not clear media keys: ".concat(t))})}))||Promise.resolve())).catch(t=>{this.log("Could not close sessions and clear media keys: ".concat(t)),this.hls&&this.hls.trigger(ku.ERROR,{type:Cu.OTHER_ERROR,details:Ru.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error("Could not close sessions and clear media keys: ".concat(t))})}).then(()=>{r&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(t,e){let{sessionKeys:n}=e;if(n&&this.config.emeEnabled&&!this.keyFormatPromise){const t=n.reduce((t,e)=>(-1===t.indexOf(e.keyFormat)&&t.push(e.keyFormat),t),[]);this.log("Selecting key-system from session-keys ".concat(t.join(", "))),this.keyFormatPromise=this.getKeyFormatPromise(t)}}removeSession(t){const{mediaKeysSession:e,licenseXhr:n,decryptdata:i}=t;if(e){this.log('Remove licenses and keys and close session "'.concat(e.sessionId,'" keyId: ').concat(th((null==i?void 0:i.keyId)||[]))),t._onmessage&&(e.removeEventListener("message",t._onmessage),t._onmessage=void 0),t._onkeystatuseschange&&(e.removeEventListener("keystatuseschange",t._onkeystatuseschange),t._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;const r=this.mediaKeySessions.indexOf(t);r>-1&&this.mediaKeySessions.splice(r,1);const{keyStatusTimeouts:s}=t;s&&Object.keys(s).forEach(t=>self.clearTimeout(s[t]));const{drmSystemOptions:a}=this.config,o=function(t){var e;return!!t&&("persistent-license"===t.sessionType||!(null==(e=t.sessionTypes)||!e.some(t=>"persistent-license"===t)))}(a)?new Promise((t,n)=>{self.setTimeout(()=>n(new Error("MediaKeySession.remove() timeout")),8e3),e.remove().then(t).catch(n)}):Promise.resolve();return o.catch(t=>{this.log("Could not remove session: ".concat(t)),this.hls&&this.hls.trigger(ku.ERROR,{type:Cu.OTHER_ERROR,details:Ru.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error("Could not remove session: ".concat(t))})}).then(()=>e.close()).catch(t=>{this.log("Could not close session: ".concat(t)),this.hls&&this.hls.trigger(ku.ERROR,{type:Cu.OTHER_ERROR,details:Ru.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error("Could not close session: ".concat(t))})})}return Promise.resolve()}}function Fv(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(null===t.keyId)throw new Error("keyId is null");return th(t.keyId)}function Uv(t,e){return t.keyId&&e.mediaKeysSession.keyStatuses.has(t.keyId)?e.mediaKeysSession.keyStatuses.get(t.keyId):t.matches(e.decryptdata)?e.keyStatus:void 0}Nv.CDMCleanupPromise=void 0;class Bv extends Error{constructor(t,e){super(e),this.data=void 0,t.error||(t.error=new Error(e)),this.data=t,t.err=t.error}}function zv(t,e){const n="output-restricted"===t,i=n?Ru.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:Ru.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new Bv({type:Cu.KEY_SYSTEM_ERROR,details:i,fatal:!1,decryptdata:e},n?"HDCP level output restricted":'key status changed to "'.concat(t,'"'))}function Hv(t,e){let n;try{n=new Event("addtrack")}catch(Yq){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=t,e.dispatchEvent(n)}function Vv(t,e){const n=t.mode;if("disabled"===n&&(t.mode="hidden"),t.cues&&!t.cues.getCueById(e.id))try{if(t.addCue(e),!t.cues.getCueById(e.id))throw new Error("addCue is failed for: ".concat(e))}catch(Yq){Qu.debug("[texttrack-utils]: ".concat(Yq));try{const n=new self.TextTrackCue(e.startTime,e.endTime,e.text);n.id=e.id,t.addCue(n)}catch(i){Qu.debug("[texttrack-utils]: Legacy TextTrackCue fallback failed: ".concat(i))}}"disabled"===n&&(t.mode=n)}function Gv(t,e){const n=t.mode;if("disabled"===n&&(t.mode="hidden"),t.cues)for(let i=t.cues.length;i--;)e&&t.cues[i].removeEventListener("enter",e),t.removeCue(t.cues[i]);"disabled"===n&&(t.mode=n)}function jv(t,e,n,i){const r=t.mode;if("disabled"===r&&(t.mode="hidden"),t.cues&&t.cues.length>0){const r=function(t,e,n){const i=[],r=function(t,e){if(e<=t[0].startTime)return 0;const n=t.length-1;if(e>t[n].endTime)return-1;let i,r=0,s=n;for(;r<=s;)if(i=Math.floor((s+r)/2),e<t[i].startTime)s=i-1;else{if(!(e>t[i].startTime&&r<n))return i;r=i+1}return t[r].startTime-e<e-t[s].startTime?r:s}(t,e);if(r>-1)for(let s=r,a=t.length;s<a;s++){const r=t[s];if(r.startTime>=e&&r.endTime<=n)i.push(r);else if(r.startTime>n)return i}return i}(t.cues,e,n);for(let e=0;e<r.length;e++)i&&!i(r[e])||t.removeCue(r[e])}"disabled"===r&&(t.mode=r)}function Wv(t){const e=[];for(let n=0;n<t.length;n++){const i=t[n];"subtitles"!==i.kind&&"captions"!==i.kind||!i.label||e.push(t[n])}return e}function Yv(t){let e=5381,n=t.length;for(;n;)e=33*e^t.charCodeAt(--n);return(e>>>0).toString()}const Xv=.025;let Kv=function(t){return t[t.Point=0]="Point",t[t.Range=1]="Range",t}({});function qv(t,e,n){return"".concat(t.identifier,"-").concat(n+1,"-").concat(Yv(e))}class Qv{constructor(t,e){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=e,this.dateRange=t,this.setDateRange(t)}setDateRange(t){this.dateRange=t,this.resumeOffset=t.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=t.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=t.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=t.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var t;this.appendInPlaceStarted=!1,null==(t=this.assetListLoader)||t.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(t){var e;if(t>0&&t>=this.assetList.length)return!0;const n=this.playoutLimit;if(t<=0||isNaN(n))return!1;if(0===n)return!0;return((null==(e=this.assetList[t])?void 0:e.startOffset)||0)>n}findAssetIndex(t){return this.assetList.indexOf(t)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const t=this.dateRange.startTime;if(this.snapOptions.out){const e=this.dateRange.tagAnchor;if(e)return Zv(t,e)}return t}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(0===this.startTime||this.snapOptions.out)return!0;const t=this.dateRange.tagAnchor;if(t){const e=this.dateRange.startTime;return e-Zv(e,t)<.1}return!1}get resumptionOffset(){const t=this.resumeOffset,e=Tu(t)?t:this.duration;return this.cumulativeDuration+e}get resumeTime(){const t=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const e=this.resumeAnchor;if(e)return Zv(t,e)}return t}get appendInPlace(){return!!this.appendInPlaceStarted||!this.appendInPlaceDisabled&&!(this.cue.once||this.cue.pre||!this.startIsAligned||!(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Xv))}set appendInPlace(t){this.appendInPlaceStarted?this.resetOnResume=!t:this.appendInPlaceDisabled=!t}get timelineStart(){return null!==this._timelineStart?this._timelineStart:this.startTime}set timelineStart(t){this._timelineStart=t}get duration(){const t=this.playoutLimit;let e;return e=null!==this._duration?this._duration:this.dateRange.duration?this.dateRange.duration:this.dateRange.plannedDuration||0,!isNaN(t)&&t<e&&(e=t),e}set duration(t){this._duration=t}get cue(){return this.dateRange.cue}get timelineOccupancy(){return"RANGE"===this.dateRange.attr["X-TIMELINE-OCCUPIES"]?Kv.Range:Kv.Point}get supplementsPrimary(){return"PRIMARY"===this.dateRange.attr["X-TIMELINE-STYLE"]}get contentMayVary(){return"NO"!==this.dateRange.attr["X-CONTENT-MAY-VARY"]}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||null!==this.assetListResponse}toString(){return'["'.concat((t=this).identifier,'" ').concat(t.cue.pre?"<pre>":t.cue.post?"<post>":"").concat(t.timelineStart.toFixed(2),"-").concat(t.resumeTime.toFixed(2),"]");var t}}function Zv(t,e){return t-e.start<e.duration/2&&!(Math.abs(t-(e.start+e.duration))<Xv)?e.start:e.start+e.duration}function Jv(t,e,n){const i=new self.URL(t,n);return"data:"!==i.protocol&&i.searchParams.set("_HLS_primary_id",e),i}function $v(t,e){for(;null!=(n=t.assetList[++e])&&n.error;)var n;return e}function ty(t){const e=t.timelineStart,n=t.duration||0;return'["'.concat(t.identifier,'" ').concat(e.toFixed(2),"-").concat((e+n).toFixed(2),"]")}class ey{constructor(t,e,n,i){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(ku.PLAYOUT_LIMIT_REACHED,{})};const r=this.hls=new t(e);this.interstitial=n,this.assetItem=i;const s=()=>{this.hasDetails=!0};r.once(ku.LEVEL_LOADED,s),r.once(ku.AUDIO_TRACK_LOADED,s),r.once(ku.SUBTITLE_TRACK_LOADED,s),r.on(ku.MEDIA_ATTACHING,(t,e)=>{let{media:n}=e;this.removeMediaListeners(),this.mediaAttached=n;this.interstitial.playoutLimit&&(n.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&r.on(ku.BUFFER_APPENDED,()=>{const t=this.bufferedEnd;this.reachedPlayout(t)&&(this._bufferedEosTime=t,r.trigger(ku.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const t=this.hls;if(t)if(t.url)t.levels.length&&!t.started&&t.startLoad(-1,!0);else{let e=this.assetItem.uri;try{e=Jv(e,t.config.primarySessionId||"").href}catch(CO){}t.loadSource(e)}}bufferedInPlaceToEnd(t){var e;if(!this.appendInPlace)return!1;if(null!=(e=this.hls)&&e.bufferedToEnd)return!0;if(!t)return!1;const n=Math.min(this._bufferedEosTime||1/0,this.duration),i=this.timelineOffset,r=bf.bufferInfo(t,i,0);return this.getAssetTime(r.end)>=n-.02}reachedPlayout(t){const e=this.interstitial.playoutLimit;return this.startOffset+t>=e}get destroyed(){var t;return!(null!=(t=this.hls)&&t.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var t;return(null==(t=this.hls)?void 0:t.media)||null}get bufferedEnd(){const t=this.media||this.mediaAttached;if(!t)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const e=bf.bufferInfo(t,t.currentTime,.001);return this.getAssetTime(e.end)}get currentTime(){const t=this.media||this.mediaAttached;return t?this.getAssetTime(t.currentTime):this._currentTime||0}get duration(){const t=this.assetItem.duration;if(!t)return 0;const e=this.interstitial.playoutLimit;if(e){const n=e-this.startOffset;if(n>0&&n<t)return n}return t}get remaining(){const t=this.duration;return t?Math.max(0,t-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var t;return(null==(t=this.hls)?void 0:t.config.timelineOffset)||0}set timelineOffset(t){const e=this.timelineOffset;if(t!==e){const n=t-e;if(Math.abs(n)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=t}}}getAssetTime(t){const e=this.timelineOffset,n=this.duration;return Math.min(Math.max(0,t-e),n)}removeMediaListeners(){const t=this.mediaAttached;t&&(this._currentTime=t.currentTime,this.bufferSnapShot(),t.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){var t;this.mediaAttached&&(null!=(t=this.hls)&&t.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd))}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(t){var e;this.loadSource(),null==(e=this.hls)||e.attachMedia(t)}detachMedia(){var t;this.removeMediaListeners(),this.mediaAttached=null,null==(t=this.hls)||t.detachMedia()}resumeBuffering(){var t;null==(t=this.hls)||t.resumeBuffering()}pauseBuffering(){var t;null==(t=this.hls)||t.pauseBuffering()}transferMedia(){var t;return this.bufferSnapShot(),(null==(t=this.hls)?void 0:t.transferMedia())||null}resetDetails(){const t=this.hls;if(t&&this.hasDetails){t.stopLoad();const e=t=>delete t.details;t.levels.forEach(e),t.allAudioTracks.forEach(e),t.allSubtitleTracks.forEach(e),this.hasDetails=!1}}on(t,e,n){var i;null==(i=this.hls)||i.on(t,e)}once(t,e,n){var i;null==(i=this.hls)||i.once(t,e)}off(t,e,n){var i;null==(i=this.hls)||i.off(t,e)}toString(){var t;return"HlsAssetPlayer: ".concat(ty(this.assetItem)," ").concat(null==(t=this.hls)?void 0:t.sessionId," ").concat(this.appendInPlace?"append-in-place":"")}}class ny extends ju{constructor(t,e){super("interstitials-sched",e),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=t}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(t=>t.reset()),this.events=this.items=null}resetErrorsInRange(t,e){return this.events?this.events.reduce((n,i)=>t<=i.startOffset&&e>i.startOffset?(delete i.error,n+1):n,0):0}get duration(){const t=this.items;return t?t[t.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(t){return t&&this.eventMap[t]||null}hasEvent(t){return t in this.eventMap}findItemIndex(t,e){if(t.event)return this.findEventIndex(t.event.identifier);let n=-1;t.nextEvent?n=this.findEventIndex(t.nextEvent.identifier)-1:t.previousEvent&&(n=this.findEventIndex(t.previousEvent.identifier)+1);const i=this.items;if(i)for(i[n]||(void 0===e&&(e=t.start),n=this.findItemIndexAtTime(e));n>=0&&null!=(r=i[n])&&r.event;){var r;n--}return n}findItemIndexAtTime(t,e){const n=this.items;if(n)for(let i=0;i<n.length;i++){let r=n[i];if(e&&"primary"!==e&&(r=r[e]),t===r.start||t>r.start&&t<r.end)return i}return-1}findJumpRestrictedIndex(t,e){const n=this.items;if(n)for(let i=t;i<=e&&n[i];i++){const t=n[i].event;if(null!=t&&t.restrictions.jump&&!t.appendInPlace)return i}return-1}findEventIndex(t){const e=this.items;if(e)for(let i=e.length;i--;){var n;if((null==(n=e[i].event)?void 0:n.identifier)===t)return i}return-1}findAssetIndex(t,e){const n=t.assetList,i=n.length;if(i>1)for(let r=0;r<i;r++){const t=n[r];if(!t.error){const n=t.timelineStart;if(e===n||e>n&&(e<n+(t.duration||0)||r===i-1))return r}}return 0}get assetIdAtEnd(){var t;const e=null==(t=this.items)||null==(t=t[this.length-1])?void 0:t.event;if(e){const t=e.assetList,n=t[t.length-1];if(n)return n.identifier}return null}parseInterstitialDateRanges(t,e){const n=t.main.details,{dateRanges:i}=n,r=this.events,s=this.parseDateRanges(i,{url:n.url},e),a=Object.keys(i),o=r?r.filter(t=>!a.includes(t.identifier)):[];s.length&&s.sort((t,e)=>{const n=t.cue.pre,i=t.cue.post,r=e.cue.pre,s=e.cue.post;if(n&&!r)return-1;if(r&&!n)return 1;if(i&&!s)return 1;if(s&&!i)return-1;if(!n&&!r&&!i&&!s){const n=t.startTime,i=e.startTime;if(n!==i)return n-i}return t.dateRange.tagOrder-e.dateRange.tagOrder}),this.events=s,o.forEach(t=>{this.removeEvent(t)}),this.updateSchedule(t,o)}updateSchedule(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.events||[];if(i.length||e.length||this.length<2){const r=this.items,s=this.parseSchedule(i,t);(n||e.length||(null==r?void 0:r.length)!==s.length||s.some((t,e)=>Math.abs(t.playout.start-r[e].playout.start)>.005||Math.abs(t.playout.end-r[e].playout.end)>.005))&&(this.items=s,this.onScheduleUpdate(e,r))}}parseDateRanges(t,e,n){const i=[],r=Object.keys(t);for(let s=0;s<r.length;s++){const a=r[s],o=t[a];if(o.isInterstitial){let t=this.eventMap[a];t?t.setDateRange(o):(t=new Qv(o,e),this.eventMap[a]=t,!1===n&&(t.appendInPlace=n)),i.push(t)}}return i}parseSchedule(t,e){const n=[],i=e.main.details,r=i.live?1/0:i.edge;let s=0;if((t=t.filter(t=>!t.error&&!(t.cue.once&&t.hasPlayed))).length){this.resolveOffsets(t,e);let i=0,o=0;if(t.forEach((e,a)=>{const l=e.cue.pre,c=e.cue.post,u=t[a-1]||null,h=e.appendInPlace,d=c?r:e.startOffset,f=e.duration,p=e.timelineOccupancy===Kv.Range?f:0,m=e.resumptionOffset,g=(null==u?void 0:u.startTime)===d,v=d+e.cumulativeDuration;let y=h?v+f:d+m;if(l||!c&&d<=0){const t=o;o+=p,e.timelineStart=v;const i=s;s+=f,n.push({event:e,start:v,end:y,playout:{start:i,end:s},integrated:{start:t,end:o}})}else{if(!(d<=r))return;{if(!g){const r=d-i;if(r>.033){const l=i,c=o;o+=r;const u=s;s+=r;const h={previousEvent:t[a-1]||null,nextEvent:e,start:l,end:l+r,playout:{start:u,end:s},integrated:{start:c,end:o}};n.push(h)}else r>0&&u&&(u.cumulativeDuration+=r,n[n.length-1].end=d)}c&&(y=v),e.timelineStart=v;const r=o;o+=p;const l=s;s+=f,n.push({event:e,start:v,end:y,playout:{start:l,end:s},integrated:{start:r,end:o}})}}const _=e.resumeTime;i=c||_>r?r:_}),i<r){var a;const t=i,e=o,l=r-i;o+=l;const c=s;s+=l,n.push({previousEvent:(null==(a=n[n.length-1])?void 0:a.event)||null,nextEvent:null,start:i,end:t+l,playout:{start:c,end:s},integrated:{start:e,end:o}})}this.setDurations(r,s,o)}else{const t=0;n.push({previousEvent:null,nextEvent:null,start:t,end:r,playout:{start:t,end:r},integrated:{start:t,end:r}}),this.setDurations(r,r,r)}return n}setDurations(t,e,n){this.durations={primary:t,playout:e,integrated:n}}resolveOffsets(t,e){const n=e.main.details,i=n.live?1/0:n.edge;let r=0,s=-1;t.forEach((a,o)=>{const l=a.cue.pre,c=a.cue.post,u=l?0:c?i:a.startTime;this.updateAssetDurations(a);if(s===u?a.cumulativeDuration=r:(r=0,s=u),!c&&a.snapOptions.in&&(a.resumeAnchor=kd(null,n.fragments,a.startOffset+a.resumptionOffset,0,0)||void 0),a.appendInPlace&&!a.appendInPlaceStarted){this.primaryCanResumeInPlaceAt(a,e)||(a.appendInPlace=!1)}if(!a.appendInPlace&&o+1<t.length){t[o+1].startTime-t[o].resumeTime<.033&&(t[o+1].appendInPlace=!1,t[o+1].appendInPlace&&this.warn("Could not change append strategy for abutting event ".concat(a)))}const h=Tu(a.resumeOffset)?a.resumeOffset:a.duration;r+=h})}primaryCanResumeInPlaceAt(t,e){const n=t.resumeTime,i=t.startTime+t.resumptionOffset;if(Math.abs(n-i)>Xv)return this.log('"'.concat(t.identifier,'" resumption ').concat(n," not aligned with estimated timeline end ").concat(i)),!1;return!Object.keys(e).some(i=>{const r=e[i].details,s=r.edge;if(n>=s)return this.log('"'.concat(t.identifier,'" resumption ').concat(n," past ").concat(i," playlist end ").concat(s)),!1;const a=kd(null,r.fragments,n);if(!a)return this.log('"'.concat(t.identifier,'" resumption ').concat(n," does not align with any fragments in ").concat(i," playlist (").concat(r.fragStart,"-").concat(r.fragmentEnd,")")),!0;const o="audio"===i?.175:0;return!(Math.abs(a.start-n)<Xv+o||Math.abs(a.end-n)<Xv+o)&&(this.log('"'.concat(t.identifier,'" resumption ').concat(n," not aligned with ").concat(i," fragment bounds (").concat(a.start,"-").concat(a.end," sn: ").concat(a.sn," cc: ").concat(a.cc,")")),!0)})}updateAssetDurations(t){if(!t.assetListLoaded)return;const e=t.timelineStart;let n=0,i=!1,r=!1;for(let s=0;s<t.assetList.length;s++){const a=t.assetList[s],o=e+n;a.startOffset=n,a.timelineStart=o,i||(i=null===a.duration),r||(r=!!a.error);n+=a.error?0:a.duration||0}t.duration=i&&!r?Math.max(n,t.duration):n}removeEvent(t){t.reset(),delete this.eventMap[t.identifier]}}function iy(t){return"[".concat(t.event?'"'+t.event.identifier+'"':"primary",": ").concat(t.start.toFixed(2),"-").concat(t.end.toFixed(2),"]")}class ry{constructor(t){this.hls=void 0,this.hls=t}destroy(){this.hls=null}loadAssetList(t,e){const n=t.assetListUrl;let i;try{i=Jv(n,this.hls.sessionId,t.baseUrl)}catch(CO){const i=this.assignAssetListError(t,Ru.ASSET_LIST_LOAD_ERROR,CO,n);return void this.hls.trigger(ku.ERROR,i)}e&&"data:"!==i.protocol&&i.searchParams.set("_HLS_start_offset",""+e);const r=this.hls.config,s=new(0,r.loader)(r),a={responseType:"json",url:i.href},o=r.interstitialAssetListLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(e,n,i,r)=>{const s=e.data,a=null==s?void 0:s.ASSETS;if(!Array.isArray(a)){const e=this.assignAssetListError(t,Ru.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),i.url,n,r);return void this.hls.trigger(ku.ERROR,e)}t.assetListResponse=s,this.hls.trigger(ku.ASSET_LIST_LOADED,{event:t,assetListResponse:s,networkDetails:r})},onError:(e,n,i,r)=>{const s=this.assignAssetListError(t,Ru.ASSET_LIST_LOAD_ERROR,new Error("Error loading X-ASSET-LIST: HTTP status ".concat(e.code," ").concat(e.text," (").concat(n.url,")")),n.url,r,i);this.hls.trigger(ku.ERROR,s)},onTimeout:(e,n,i)=>{const r=this.assignAssetListError(t,Ru.ASSET_LIST_LOAD_TIMEOUT,new Error("Timeout loading X-ASSET-LIST (".concat(n.url,")")),n.url,e,i);this.hls.trigger(ku.ERROR,r)}};return s.load(a,l,c),this.hls.trigger(ku.ASSET_LIST_LOADING,{event:t}),s}assignAssetListError(t,e,n,i,r,s){return t.error=n,{type:Cu.NETWORK_ERROR,details:e,fatal:!1,interstitial:t,url:i,error:n,networkDetails:s,stats:r}}}function sy(t){var e;null==t||null==(e=t.play())||e.catch(()=>{})}function ay(t,e){return"[".concat(t,"] Advancing timeline position to ").concat(e)}class oy{constructor(t){this.buffered=void 0;const e=(e,n,i)=>{if((n>>>=0)>i-1)throw new DOMException("Failed to execute '".concat(e,"' on 'TimeRanges': The index provided (").concat(n,") is greater than the maximum bound (").concat(i,")"));return t[n][e]};this.buffered={get length(){return t.length},end:n=>e("end",n,t.length),start:n=>e("start",n,t.length)}}}const ly={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},cy=t=>String.fromCharCode(ly[t]||t),uy=15,hy=100,dy={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},fy={17:2,18:4,21:6,22:8,23:10,19:13,20:15},py={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},my={25:2,26:4,29:6,30:8,31:10,27:13,28:15},gy=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class vy{constructor(){this.time=null,this.verboseLevel=0}log(t,e){if(this.verboseLevel>=t){const n="function"===typeof e?e():e;Qu.log("".concat(this.time," [").concat(t,"] ").concat(n))}}}const yy=function(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].toString(16));return e};class _y{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(t){const e=["foreground","underline","italics","background","flash"];for(let n=0;n<e.length;n++){const i=e[n];t.hasOwnProperty(i)&&(this[i]=t[i])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash}copy(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class by{constructor(){this.uchar=" ",this.penState=new _y}reset(){this.uchar=" ",this.penState.reset()}setChar(t,e){this.uchar=t,this.penState.copy(e)}setPenState(t){this.penState.copy(t)}equals(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)}copy(t){this.uchar=t.uchar,this.penState.copy(t.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class xy{constructor(t){this.chars=[],this.pos=0,this.currPenState=new _y,this.cueStartTime=null,this.logger=void 0;for(let e=0;e<hy;e++)this.chars.push(new by);this.logger=t}equals(t){for(let e=0;e<hy;e++)if(!this.chars[e].equals(t.chars[e]))return!1;return!0}copy(t){for(let e=0;e<hy;e++)this.chars[e].copy(t.chars[e])}isEmpty(){let t=!0;for(let e=0;e<hy;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t}setCursor(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>hy&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=hy)}moveCursor(t){const e=this.pos+t;if(t>1)for(let n=this.pos+1;n<e+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(e)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(t){t>=144&&this.backSpace();const e=cy(t);this.pos>=hy?this.logger.log(0,()=>"Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1))}clearFromPos(t){let e;for(e=t;e<hy;e++)this.chars[e].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const t=[];let e=!0;for(let n=0;n<hy;n++){const i=this.chars[n].uchar;" "!==i&&(e=!1),t.push(i)}return e?"":t.join("")}setPenStyles(t){this.currPenState.setStyles(t);this.chars[this.pos].setPenState(this.currPenState)}}class Ey{constructor(t){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let e=0;e<uy;e++)this.rows.push(new xy(t));this.logger=t}reset(){for(let t=0;t<uy;t++)this.rows[t].clear();this.currRow=14}equals(t){let e=!0;for(let n=0;n<uy;n++)if(!this.rows[n].equals(t.rows[n])){e=!1;break}return e}copy(t){for(let e=0;e<uy;e++)this.rows[e].copy(t.rows[e])}isEmpty(){let t=!0;for(let e=0;e<uy;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(t){this.rows[this.currRow].insertChar(t)}setPen(t){this.rows[this.currRow].setPenStyles(t)}moveCursor(t){this.rows[this.currRow].moveCursor(t)}setCursor(t){this.logger.log(2,"setCursor: "+t);this.rows[this.currRow].setCursor(t)}setPAC(t){this.logger.log(2,()=>"pacData = "+bd(t));let e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(let e=0;e<uy;e++)this.rows[e].clear();const t=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){const i=n.rows[t].cueStartTime,r=this.logger.time;if(null!==i&&null!==r&&i<r)for(let s=0;s<this.nrRollUpRows;s++)this.rows[e-this.nrRollUpRows+s+1].copy(n.rows[t+s])}}this.currRow=e;const n=this.rows[this.currRow];if(null!==t.indent){const e=t.indent,i=Math.max(e-1,0);n.setCursor(t.indent),t.color=n.chars[i].penState.foreground}const i={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(t){this.logger.log(2,()=>"bkgData = "+bd(t)),this.backSpace(),this.setPen(t),this.insertChar(32)}setRollUpRows(t){this.nrRollUpRows=t}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,()=>this.getDisplayText());const t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),this.logger.log(2,"Rolling up")}getDisplayText(t){t=t||!1;const e=[];let n="",i=-1;for(let r=0;r<uy;r++){const n=this.rows[r].getTextString();n&&(i=r+1,t?e.push("Row "+i+": '"+n+"'"):e.push(n.trim()))}return e.length>0&&(n=t?"["+e.join(" | ")+"]":e.join("\n")),n}getTextAndFormat(){return this.rows}}class wy{constructor(t,e,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new Ey(n),this.nonDisplayedMemory=new Ey(n),this.lastOutputScreen=new Ey(n),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(t){this.outputFilter=t}setPAC(t){this.writeScreen.setPAC(t)}setBkgData(t){this.writeScreen.setBkgData(t)}setMode(t){t!==this.mode&&(this.mode=t,this.logger.log(2,()=>"MODE="+t),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)}insertChars(t){for(let n=0;n<t.length;n++)this.writeScreen.insertChar(t[n]);const e=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>e+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(t){this.logger.log(2,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(t){this.logger.log(2,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)}ccMIDROW(t){const e={flash:!1};if(e.underline=t%2===1,e.italics=t>=46,e.italics)e.foreground="white";else{const n=Math.floor(t/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];e.foreground=i[n]}this.logger.log(2,"MIDROW: "+bd(e)),this.writeScreen.setPen(e)}outputDataUpdate(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.logger.time;null!==e&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}}class Sy{constructor(t,e,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;const i=this.logger=new vy;this.channels=[null,new wy(t,e,i),new wy(t+1,n,i)]}getHandler(t){return this.channels[t].getHandler()}setHandler(t,e){this.channels[t].setHandler(e)}addData(t,e){this.logger.time=t;for(let n=0;n<e.length;n+=2){const t=127&e[n],i=127&e[n+1];let r=!1,s=null;if(0===t&&0===i)continue;this.logger.log(3,()=>"["+yy([e[n],e[n+1]])+"] -> ("+yy([t,i])+")");const a=this.cmdHistory;if(t>=16&&t<=31){if(My(t,i,a)){Ty(null,null,a),this.logger.log(3,()=>"Repeated command ("+yy([t,i])+") is dropped");continue}Ty(t,i,this.cmdHistory),r=this.parseCmd(t,i),r||(r=this.parseMidrow(t,i)),r||(r=this.parsePAC(t,i)),r||(r=this.parseBackgroundAttributes(t,i))}else Ty(null,null,a);if(!r&&(s=this.parseChars(t,i),s)){const t=this.currentChannel;if(t&&t>0){this.channels[t].insertChars(s)}else this.logger.log(2,"No channel found yet. TEXT-MODE?")}r||s||this.logger.log(2,()=>"Couldn't parse cleaned data "+yy([t,i])+" orig: "+yy([e[n],e[n+1]]))}}parseCmd(t,e){if(!((20===t||28===t||21===t||29===t)&&e>=32&&e<=47)&&!((23===t||31===t)&&e>=33&&e<=35))return!1;const n=20===t||21===t||23===t?1:2,i=this.channels[n];return 20===t||21===t||28===t||29===t?32===e?i.ccRCL():33===e?i.ccBS():34===e?i.ccAOF():35===e?i.ccAON():36===e?i.ccDER():37===e?i.ccRU(2):38===e?i.ccRU(3):39===e?i.ccRU(4):40===e?i.ccFON():41===e?i.ccRDC():42===e?i.ccTR():43===e?i.ccRTD():44===e?i.ccEDM():45===e?i.ccCR():46===e?i.ccENM():47===e&&i.ccEOC():i.ccTO(e-32),this.currentChannel=n,!0}parseMidrow(t,e){let n=0;if((17===t||25===t)&&e>=32&&e<=47){if(n=17===t?1:2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return!!i&&(i.ccMIDROW(e),this.logger.log(3,()=>"MIDROW ("+yy([t,e])+")"),!0)}return!1}parsePAC(t,e){let n;if(!((t>=17&&t<=23||t>=25&&t<=31)&&e>=64&&e<=127)&&!((16===t||24===t)&&e>=64&&e<=95))return!1;const i=t<=23?1:2;n=e>=64&&e<=95?1===i?dy[t]:py[t]:1===i?fy[t]:my[t];const r=this.channels[i];return!!r&&(r.setPAC(this.interpretPAC(n,e)),this.currentChannel=i,!0)}interpretPAC(t,e){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:t};return n=e>95?e-96:e-64,i.underline=1===(1&n),n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((n-16)/2),i}parseChars(t,e){let n,i=null,r=null;if(t>=25?(n=2,r=t-8):(n=1,r=t),r>=17&&r<=19){let t;t=17===r?e+80:18===r?e+112:e+144,this.logger.log(2,()=>"Special char '"+cy(t)+"' in channel "+n),i=[t]}else t>=32&&t<=127&&(i=0===e?[t]:[t,e]);return i&&this.logger.log(3,()=>"Char codes =  "+yy(i).join(",")),i}parseBackgroundAttributes(t,e){if(!((16===t||24===t)&&e>=32&&e<=47)&&!((23===t||31===t)&&e>=45&&e<=47))return!1;let n;const i={};16===t||24===t?(n=Math.floor((e-32)/2),i.background=gy[n],e%2===1&&(i.background=i.background+"_semi")):45===e?i.background="transparent":(i.foreground="black",47===e&&(i.underline=!0));const r=t<=23?1:2;return this.channels[r].setBkgData(i),!0}reset(){for(let t=0;t<Object.keys(this.channels).length;t++){const e=this.channels[t];e&&e.reset()}Ty(null,null,this.cmdHistory)}cueSplitAtTime(t){for(let e=0;e<this.channels.length;e++){const n=this.channels[e];n&&n.cueSplitAtTime(t)}}}function Ty(t,e,n){n.a=t,n.b=e}function My(t,e,n){return n.a===t&&n.b===e}var Ay=function(){if(null!=Hf&&Hf.VTTCue)return self.VTTCue;const t=["","lr","rl"],e=["start","middle","end","left","right"];function n(t,e){if("string"!==typeof e)return!1;if(!Array.isArray(t))return!1;const n=e.toLowerCase();return!!~t.indexOf(n)&&n}function i(t){return n(e,t)}function r(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];let r=1;for(;r<arguments.length;r++){const e=arguments[r];for(const n in e)t[n]=e[n]}return t}function s(e,s,a){const o=this,l={enumerable:!0};o.hasBeenReset=!1;let c="",u=!1,h=e,d=s,f=a,p=null,m="",g=!0,v="auto",y="start",_=50,b="middle",x=50,E="middle";Object.defineProperty(o,"id",r({},l,{get:function(){return c},set:function(t){c=""+t}})),Object.defineProperty(o,"pauseOnExit",r({},l,{get:function(){return u},set:function(t){u=!!t}})),Object.defineProperty(o,"startTime",r({},l,{get:function(){return h},set:function(t){if("number"!==typeof t)throw new TypeError("Start time must be set to a number.");h=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",r({},l,{get:function(){return d},set:function(t){if("number"!==typeof t)throw new TypeError("End time must be set to a number.");d=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",r({},l,{get:function(){return f},set:function(t){f=""+t,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",r({},l,{get:function(){return p},set:function(t){p=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",r({},l,{get:function(){return m},set:function(e){const i=function(e){return n(t,e)}(e);if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");m=i,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",r({},l,{get:function(){return g},set:function(t){g=!!t,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",r({},l,{get:function(){return v},set:function(t){if("number"!==typeof t&&"auto"!==t)throw new SyntaxError("An invalid number or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",r({},l,{get:function(){return y},set:function(t){const e=i(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",r({},l,{get:function(){return _},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");_=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",r({},l,{get:function(){return b},set:function(t){const e=i(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",r({},l,{get:function(){return x},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");x=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",r({},l,{get:function(){return E},set:function(t){const e=i(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");E=e,this.hasBeenReset=!0}})),o.displayState=void 0}return s.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},s}();class Cy{decode(t,e){if(!t)return"";if("string"!==typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}function Ry(t){function e(t,e,n,i){return 3600*(0|t)+60*(0|e)+(0|n)+parseFloat(i||0)}const n=t.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?e(n[2],n[3],0,n[4]):e(n[1],n[2],n[3],n[4]):null}class ky{constructor(){this.values=Object.create(null)}set(t,e){this.get(t)||""===e||(this.values[t]=e)}get(t,e,n){return n?this.has(t)?this.values[t]:e[n]:this.has(t)?this.values[t]:e}has(t){return t in this.values}alt(t,e,n){for(let i=0;i<n.length;++i)if(e===n[i]){this.set(t,e);break}}integer(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))}percent(t,e){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(e)){const n=parseFloat(e);if(n>=0&&n<=100)return this.set(t,n),!0}return!1}}function Ly(t,e,n,i){const r=i?t.split(i):[t];for(const s in r){if("string"!==typeof r[s])continue;const t=r[s].split(n);if(2!==t.length)continue;e(t[0],t[1])}}const Dy=new Ay(0,0,""),Py="middle"===Dy.align?"middle":"center";function Iy(t,e,n){const i=t;function r(){const e=Ry(t);if(null===e)throw new Error("Malformed timestamp: "+i);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function s(){t=t.replace(/^\s+/,"")}if(s(),e.startTime=r(),s(),"--\x3e"!==t.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);t=t.slice(3),s(),e.endTime=r(),s(),function(t,e){const i=new ky;Ly(t,function(t,e){let r;switch(t){case"region":for(let r=n.length-1;r>=0;r--)if(n[r].id===e){i.set(t,n[r].region);break}break;case"vertical":i.alt(t,e,["rl","lr"]);break;case"line":r=e.split(","),i.integer(t,r[0]),i.percent(t,r[0])&&i.set("snapToLines",!1),i.alt(t,r[0],["auto"]),2===r.length&&i.alt("lineAlign",r[1],["start",Py,"end"]);break;case"position":r=e.split(","),i.percent(t,r[0]),2===r.length&&i.alt("positionAlign",r[1],["start",Py,"end","line-left","line-right","auto"]);break;case"size":i.percent(t,e);break;case"align":i.alt(t,e,["start",Py,"end","left","right"])}},/:/,/\s/),e.region=i.get("region",null),e.vertical=i.get("vertical","");let r=i.get("line","auto");"auto"===r&&-1===Dy.line&&(r=-1),e.line=r,e.lineAlign=i.get("lineAlign","start"),e.snapToLines=i.get("snapToLines",!0),e.size=i.get("size",100),e.align=i.get("align",Py);let s=i.get("position","auto");"auto"===s&&50===Dy.position&&(s="start"===e.align||"left"===e.align?0:"end"===e.align||"right"===e.align?100:50),e.position=s}(t,e)}function Oy(t){return t.replace(/<br(?: \/)?>/gi,"\n")}class Ny{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Cy,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(t){const e=this;function n(){let t=e.buffer,n=0;for(t=Oy(t);n<t.length&&"\r"!==t[n]&&"\n"!==t[n];)++n;const i=t.slice(0,n);return"\r"===t[n]&&++n,"\n"===t[n]&&++n,e.buffer=t.slice(n),i}function i(t){Ly(t,function(t,e){},/:/)}t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));try{let t="";if("INITIAL"===e.state){if(!/\r\n|\n/.test(e.buffer))return this;t=n();const i=t.match(/^(\xef\xbb\xbf)?WEBVTT([ \t].*)?$/);if(null==i||!i[0])throw new Error("Malformed WebVTT signature.");e.state="HEADER"}let r=!1;for(;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(r?r=!1:t=n(),e.state){case"HEADER":/:/.test(t)?i(t):t||(e.state="ID");continue;case"NOTE":t||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(t)){e.state="NOTE";break}if(!t)continue;if(e.cue=new Ay(0,0,""),e.state="CUE",-1===t.indexOf("--\x3e")){e.cue.id=t;continue}case"CUE":if(!e.cue){e.state="BADCUE";continue}try{Iy(t,e.cue,e.regionList)}catch(Wq){e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":{const n=-1!==t.indexOf("--\x3e");if(!t||n&&(r=!0)){e.oncue&&e.cue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}if(null===e.cue)continue;e.cue.text&&(e.cue.text+="\n"),e.cue.text+=t}continue;case"BADCUE":t||(e.state="ID")}}}catch(Wq){"CUETEXT"===e.state&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state="INITIAL"===e.state?"BADWEBVTT":"BADCUE"}return this}flush(){const t=this;try{if((t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state||"BADWEBVTT"===t.state)throw new Error("Malformed WebVTT signature.")}catch(Wq){t.onparsingerror&&t.onparsingerror(Wq)}return t.onflush&&t.onflush(),this}}const Fy=/\r\n|\n\r|\n|\r/g,Uy=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t.slice(n,n+e.length)===e};function By(t,e,n){return Yv(t.toString())+Yv(e.toString())+Yv(n)}function zy(t,e,n,i,r,s,a){const o=new Ny,l=$u(new Uint8Array(t)).trim().replace(Fy,"\n").split("\n"),c=[],u=e?function(t){return cg(t,9e4,1/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1))}(e.baseTime,e.timescale):0;let h,d="00:00.000",f=0,p=0,m=!0;o.oncue=function(t){const s=n[i];let a=n.ccOffset;const o=(f-u)/9e4;if(null!=s&&s.new&&(void 0!==p?a=n.ccOffset=s.start:function(t,e,n){let i=t[e],r=t[i.prevCC];if(!r||!r.new&&i.new)return t.ccOffset=t.presentationOffset=i.start,void(i.new=!1);for(;null!=(s=r)&&s.new;){var s;t.ccOffset+=i.start-r.start,i.new=!1,i=r,r=t[i.prevCC]}t.presentationOffset=n}(n,i,o)),o){if(!e)return void(h=new Error("Missing initPTS for VTT MPEGTS"));a=o-n.presentationOffset}const l=t.endTime-t.startTime,d=vg(9e4*(t.startTime+a-p),9e4*r)/9e4;t.startTime=Math.max(d,0),t.endTime=Math.max(d+l,0);const m=t.text.trim();t.text=decodeURIComponent(encodeURIComponent(m)),t.id||(t.id=By(t.startTime,t.endTime,m)),t.endTime>0&&c.push(t)},o.onparsingerror=function(t){h=t},o.onflush=function(){h?a(h):s(c)},l.forEach(t=>{if(m){if(Uy(t,"X-TIMESTAMP-MAP=")){m=!1,t.slice(16).split(",").forEach(t=>{Uy(t,"LOCAL:")?d=t.slice(6):Uy(t,"MPEGTS:")&&(f=parseInt(t.slice(7)))});try{p=function(t){let e=parseInt(t.slice(-3));const n=parseInt(t.slice(-6,-4)),i=parseInt(t.slice(-9,-7)),r=t.length>9?parseInt(t.substring(0,t.indexOf(":"))):0;if(!Tu(e)||!Tu(n)||!Tu(i)||!Tu(r))throw Error("Malformed X-TIMESTAMP-MAP: Local:".concat(t));return e+=1e3*n,e+=6e4*i,e+=36e5*r,e}(d)/1e3}catch(CO){h=CO}return}""===t&&(m=!1)}o.parse(t+"\n")}),o.flush()}const Hy="stpp.ttml.im1t",Vy=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Gy=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,jy={left:"start",center:"center",right:"end",start:"start",end:"end"};function Wy(t,e,n,i){const r=wh(new Uint8Array(t),["mdat"]);if(0===r.length)return void i(new Error("Could not parse IMSC1 mdat"));const s=r.map(t=>$u(t)),a=function(t,e){return cg(t,e,1/(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1),arguments.length>3&&void 0!==arguments[3]&&arguments[3])}(e.baseTime,1,e.timescale);try{s.forEach(t=>n(function(t,e){const n=(new DOMParser).parseFromString(t,"text/xml"),i=n.getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},s=Object.keys(r).reduce((t,e)=>(t[e]=i.getAttribute("ttp:".concat(e))||r[e],t),{}),a="preserve"!==i.getAttribute("xml:space"),o=Xy(Yy(i,"styling","style")),l=Xy(Yy(i,"layout","region")),c=Yy(i,"body","[begin]");return[].map.call(c,t=>{const n=Ky(t,a);if(!n||!t.hasAttribute("begin"))return null;const i=Zy(t.getAttribute("begin"),s),r=Zy(t.getAttribute("dur"),s);let c=Zy(t.getAttribute("end"),s);if(null===i)throw Qy(t);if(null===c){if(null===r)throw Qy(t);c=i+r}const u=new Ay(i-e,c-e,n);u.id=By(u.startTime,u.endTime,u.text);const h=function(t,e,n){const i="http://www.w3.org/ns/ttml#styling";let r=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=null!=t&&t.hasAttribute("style")?t.getAttribute("style"):null;a&&n.hasOwnProperty(a)&&(r=n[a]);return s.reduce((n,s)=>{const a=qy(e,i,s)||qy(t,i,s)||qy(r,i,s);return a&&(n[s]=a),n},{})}(l[t.getAttribute("region")],o[t.getAttribute("style")],o),{textAlign:d}=h;if(d){const t=jy[d];t&&(u.lineAlign=t),u.align=d}return Hu(u,h),u}).filter(t=>null!==t)}(t,a)))}catch(CO){i(CO)}}function Yy(t,e,n){const i=t.getElementsByTagName(e)[0];return i?[].slice.call(i.querySelectorAll(n)):[]}function Xy(t){return t.reduce((t,e)=>{const n=e.getAttribute("xml:id");return n&&(t[n]=e),t},{})}function Ky(t,e){return[].slice.call(t.childNodes).reduce((t,n,i)=>{var r;return"br"===n.nodeName&&i?t+"\n":null!=(r=n.childNodes)&&r.length?Ky(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function qy(t,e,n){return t&&t.hasAttributeNS(e,n)?t.getAttributeNS(e,n):null}function Qy(t){return new Error("Could not parse ttml timestamp ".concat(t))}function Zy(t,e){if(!t)return null;let n=Ry(t);return null===n&&(Vy.test(t)?n=function(t,e){const n=Vy.exec(t),i=(0|n[4])+(0|n[5])/e.subFrameRate;return 3600*(0|n[1])+60*(0|n[2])+(0|n[3])+i/e.frameRate}(t,e):Gy.test(t)&&(n=function(t,e){const n=Gy.exec(t),i=Number(n[1]);switch(n[2]){case"h":return 3600*i;case"m":return 60*i;case"ms":return 1e3*i;case"f":return i/e.frameRate;case"t":return i/e.tickRate}return i}(t,e))),n}class Jy{constructor(t,e){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=e}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(t,e,n){(null===this.startTime||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}function $y(t){return t.characteristics&&/transcribes-spoken-dialog/gi.test(t.characteristics)&&/describes-music-and-sound/gi.test(t.characteristics)?"captions":"subtitles"}function t_(t,e){return!!t&&t.kind===$y(e)&&Pg(e,t)}function e_(t,e,n,i){return Math.min(e,i)-Math.max(t,n)}const n_=/\s/,i_={newCue(t,e,n,i){const r=[];let s,a,o,l,c;const u=self.VTTCue||self.TextTrackCue;for(let d=0;d<i.rows.length;d++)if(s=i.rows[d],o=!0,l=0,c="",!s.isEmpty()){var h;for(let t=0;t<s.chars.length;t++)n_.test(s.chars[t].uchar)&&o?l++:(c+=s.chars[t].uchar,o=!1);s.cueStartTime=e,e===n&&(n+=1e-4),l>=16?l--:l++;const i=Oy(c.trim()),f=By(e,n,i);null!=t&&null!=(h=t.cues)&&h.getCueById(f)||(a=new u(e,n,i),a.id=f,a.line=d+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*l/32)),r.push(a))}return t&&r.length&&(r.sort((t,e)=>"auto"===t.line||"auto"===e.line?0:t.line>8&&e.line>8?e.line-t.line:t.line-e.line),r.forEach(e=>Vv(t,e))),r}};const r_=/(\d+)-(\d+)\/(\d+)/;class s_{constructor(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||a_,this.controller=new self.AbortController,this.stats=new ah}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),null!=(t=this.callbacks)&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(t,e,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const r=function(t,e){const n={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Hu({},t.headers))};t.rangeEnd&&n.headers.set("Range","bytes="+t.rangeStart+"-"+String(t.rangeEnd-1));return n}(t,this.controller.signal),s="arraybuffer"===t.responseType,a=s?"byteLength":"length",{maxTimeToFirstByteMs:o,maxLoadTimeMs:l}=e.loadPolicy;this.context=t,this.config=e,this.callbacks=n,this.request=this.fetchSetup(t,r),self.clearTimeout(this.requestTimeout),e.timeout=o&&Tu(o)?o:l,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,t,this.response))},e.timeout);(Tg(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(n=>{var r;this.response=this.loader=n;const a=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),e.timeout=l,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,t,this.response))},l-(a-i.loading.start)),!n.ok){const{status:t,statusText:e}=n;throw new o_(e||"fetch, bad network response",t,n)}i.loading.first=a,i.total=function(t){const e=t.get("Content-Range");if(e){const t=function(t){const e=r_.exec(t);if(e)return parseInt(e[2])-parseInt(e[1])+1}(e);if(Tu(t))return t}const n=t.get("Content-Length");if(n)return parseInt(n)}(n.headers)||i.total;const o=null==(r=this.callbacks)?void 0:r.onProgress;return o&&Tu(e.highWaterMark)?this.loadProgressively(n,i,t,e.highWaterMark,o):s?n.arrayBuffer():"json"===t.responseType?n.json():n.text()}).then(n=>{var r,s;const o=this.response;if(!o)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const l=n[a];l&&(i.loaded=i.total=l);const c={url:o.url,data:n,code:o.status},u=null==(r=this.callbacks)?void 0:r.onProgress;u&&!Tu(e.highWaterMark)&&u(i,t,n,o),null==(s=this.callbacks)||s.onSuccess(c,i,t,o)}).catch(e=>{var n;if(self.clearTimeout(this.requestTimeout),i.aborted)return;const r=e&&e.code||0,s=e?e.message:null;null==(n=this.callbacks)||n.onError({code:r,text:s},t,e?e.details:null,i)})}getCacheAge(){let t=null;if(this.response){const e=this.response.headers.get("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.response?this.response.headers.get(t):null}loadProgressively(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0;const s=new tm,a=t.body.getReader(),o=()=>a.read().then(a=>{if(a.done)return s.dataLength&&r(e,n,s.flush().buffer,t),Promise.resolve(new ArrayBuffer(0));const l=a.value,c=l.length;return e.loaded+=c,c<i||s.dataLength?(s.push(l),s.dataLength>=i&&r(e,n,s.flush().buffer,t)):r(e,n,l.buffer,t),o()}).catch(()=>Promise.reject());return o()}}function a_(t,e){return new self.Request(t.url,e)}class o_ extends Error{constructor(t,e,n){super(t),this.code=void 0,this.details=void 0,this.code=e,this.details=n}}const l_=/^age:\s*[\d.]+\s*$/im;class c_{constructor(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new ah,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,4!==t.readyState&&(this.stats.aborted=!0,t.abort()))}abort(){var t;this.abortInternal(),null!=(t=this.callbacks)&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,e,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=e,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:t,context:e}=this;if(!t||!e)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then(()=>{if(this.loader===n&&!this.stats.aborted)return r(n,e.url)}).catch(t=>{if(this.loader===n&&!this.stats.aborted)return n.open("GET",e.url,!0),r(n,e.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,e,t)}).catch(t=>{var r;null==(r=this.callbacks)||r.onError({code:n.status,text:t.message},e,n,i)}):this.openAndSendXhr(n,e,t)}openAndSendXhr(t,e,n){t.readyState||t.open("GET",e.url,!0);const i=e.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:s}=n.loadPolicy;if(i)for(const a in i)t.setRequestHeader(a,i[a]);e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,self.clearTimeout(this.requestTimeout),n.timeout=r&&Tu(r)?r:s,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),t.send()}readystatechange(){const{context:t,loader:e,stats:n}=this;if(!t||!e)return;const i=e.readyState,r=this.config;if(!n.aborted&&i>=2&&(0===n.loading.first&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),4===i)){self.clearTimeout(this.requestTimeout),e.onreadystatechange=null,e.onprogress=null;const i=e.status,l="text"===e.responseType?e.responseText:null;if(i>=200&&i<300){const r=null!=l?l:e.response;if(null!=r){var s,a;n.loading.end=Math.max(self.performance.now(),n.loading.first);const o="arraybuffer"===e.responseType?r.byteLength:r.length;n.loaded=n.total=o,n.bwEstimate=8e3*n.total/(n.loading.end-n.loading.first);const l=null==(s=this.callbacks)?void 0:s.onProgress;l&&l(n,t,r,e);const c={url:e.responseURL,data:r,code:i};return void(null==(a=this.callbacks)||a.onSuccess(c,n,t,e))}}const c=r.loadPolicy.errorRetry;var o;if(zd(c,n.retry,!1,{url:t.url,data:void 0,code:i}))this.retry(c);else Qu.error("".concat(i," while loading ").concat(t.url)),null==(o=this.callbacks)||o.onError({code:i,text:e.statusText},t,e,n)}}loadtimeout(){if(!this.config)return;const t=this.config.loadPolicy.timeoutRetry;if(zd(t,this.stats.retry,!0))this.retry(t);else{var e;Qu.warn("timeout while loading ".concat(null==(e=this.context)?void 0:e.url));const t=this.callbacks;t&&(this.abortInternal(),t.onTimeout(this.stats,this.context,this.loader))}}retry(t){const{context:e,stats:n}=this;this.retryDelay=Ud(t,n.retry),n.retry++,Qu.warn("".concat(status?"HTTP Status "+status:"Timeout"," while loading ").concat(null==e?void 0:e.url,", retrying ").concat(n.retry,"/").concat(t.maxNumRetry," in ").concat(this.retryDelay,"ms")),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(t){const e=this.stats;e.loaded=t.loaded,t.lengthComputable&&(e.total=t.total)}getCacheAge(){let t=null;if(this.loader&&l_.test(this.loader.getAllResponseHeaders())){const e=this.loader.getResponseHeader("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.loader&&new RegExp("^".concat(t,":\\s*[\\d.]+\\s*$"),"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null}}const u_=Gu(Gu({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:6e7,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:c_,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class extends ju{constructor(t){super("abr",t.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var e;const{fragCurrent:n,partCurrent:i,hls:r}=this,{autoLevelEnabled:s,media:a}=r;if(!n||!a)return;const o=performance.now(),l=i?i.stats:n.stats,c=i?i.duration:n.duration,u=o-l.loading.start,h=r.minAutoLevel,d=n.level,f=this._nextAutoLevel;if(l.aborted||l.loaded&&l.loaded===l.total||d<=h)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!s)return;const p=f>-1&&f!==d,m=!!t||p;if(!m&&(a.paused||!a.playbackRate||!a.readyState))return;const g=r.mainForwardBufferInfo;if(!m&&null===g)return;const v=this.bwEstimator.getEstimateTTFB(),y=Math.abs(a.playbackRate);if(u<=Math.max(v,c/(2*y)*1e3))return;const _=g?g.len/y:0,b=l.loading.first?l.loading.first-l.loading.start:-1,x=l.loaded&&b>-1,E=this.getBwEstimate(),w=r.levels,S=w[d],T=Math.max(l.loaded,Math.round(c*(n.bitrate||S.averageBitrate)/8));let M=x?u-b:u;M<1&&x&&(M=Math.min(u,8*l.loaded/E));const A=x?1e3*l.loaded/M:0,C=v/1e3,R=A?(T-l.loaded)/A:8*T/E+C;if(R<=_)return;const k=A?8*A:E,L=!0===(null==(e=(null==t?void 0:t.details)||this.hls.latestLevelDetails)?void 0:e.live),D=this.hls.config.abrBandWidthUpFactor;let P,I=Number.POSITIVE_INFINITY;for(P=d-1;P>h;P--){const t=w[P].maxBitrate,e=!w[P].details||L;if(I=this.getTimeToLoadFrag(C,k,c*t,e),I<Math.min(_,c+C))break}if(I>=R)return;if(I>10*c)return;x?this.bwEstimator.sample(u-Math.min(v,b),l.loaded):this.bwEstimator.sampleTTFB(u);const O=w[P].maxBitrate;this.getBwEstimate()*D>O&&this.resetEstimator(O);const N=this.findBestLevel(O,h,P,0,_,1,1);N>-1&&(P=N),this.warn("Fragment ".concat(n.sn).concat(i?" part "+i.index:""," of level ").concat(d," is loading too slowly;\n      Fragment duration: ").concat(n.duration.toFixed(3),"\n      Time to underbuffer: ").concat(_.toFixed(3)," s\n      Estimated load time for current fragment: ").concat(R.toFixed(3)," s\n      Estimated load time for down switch fragment: ").concat(I.toFixed(3)," s\n      TTFB estimate: ").concat(0|b," ms\n      Current BW estimate: ").concat(Tu(E)?0|E:"Unknown"," bps\n      New BW estimate: ").concat(0|this.getBwEstimate()," bps\n      Switching to level ").concat(P," @ ").concat(0|O," bps")),r.nextLoadLevel=r.nextAutoLevel=P,this.clearTimer();const F=()=>{if(this.clearTimer(),this.fragCurrent===n&&this.hls.loadLevel===P&&P>0){const t=this.getStarvationDelay();if(this.warn("Aborting inflight request ".concat(P>0?"and switching down":"","\n      Fragment duration: ").concat(n.duration.toFixed(3)," s\n      Time to underbuffer: ").concat(t.toFixed(3)," s")),n.abortRequests(),this.fragCurrent=this.partCurrent=null,P>h){let e=this.findBestLevel(this.hls.levels[h].bitrate,h,P,0,t,1,1);-1===e&&(e=h),this.hls.nextLoadLevel=this.hls.nextAutoLevel=e,this.resetEstimator(this.hls.levels[e].bitrate)}}};p||R>2*I?F():this.timer=self.setInterval(F,1e3*I),r.trigger(ku.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,part:i,stats:l})},this.hls=t,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(t){t&&(this.log("setting initial bwe to ".concat(t)),this.hls.config.abrEwmaDefaultEstimate=t),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const t=this.hls.config;return new Bu(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate)}registerListeners(){const{hls:t}=this;t.on(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.on(ku.FRAG_LOADING,this.onFragLoading,this),t.on(ku.FRAG_LOADED,this.onFragLoaded,this),t.on(ku.FRAG_BUFFERED,this.onFragBuffered,this),t.on(ku.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(ku.LEVEL_LOADED,this.onLevelLoaded,this),t.on(ku.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(ku.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.on(ku.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t&&(t.off(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.off(ku.FRAG_LOADING,this.onFragLoading,this),t.off(ku.FRAG_LOADED,this.onFragLoaded,this),t.off(ku.FRAG_BUFFERED,this.onFragBuffered,this),t.off(ku.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(ku.LEVEL_LOADED,this.onLevelLoaded,this),t.off(ku.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(ku.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.off(ku.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(t,e){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(t,e){const n=e.frag;if(!this.ignoreFragment(n)){var i;if(!n.bitrateTest)this.fragCurrent=n,this.partCurrent=null!=(i=e.part)?i:null;this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(t,e){this.clearTimer()}onError(t,e){if(!e.fatal)switch(e.details){case Ru.BUFFER_ADD_CODEC_ERROR:case Ru.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Ru.FRAG_LOAD_TIMEOUT:{const t=e.frag,{fragCurrent:n,partCurrent:i}=this;if(t&&n&&t.sn===n.sn&&t.level===n.level){const e=performance.now(),n=i?i.stats:t.stats,r=e-n.loading.start,s=n.loading.first?n.loading.first-n.loading.start:-1;if(n.loaded&&s>-1){const t=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(r-Math.min(t,s),n.loaded)}else this.bwEstimator.sampleTTFB(r)}break}}}getTimeToLoadFrag(t,e,n,i){return t+n/e+(i?t+this.lastLevelLoadSec:0)}onLevelLoaded(t,e){const n=this.hls.config,{loading:i}=e.stats,r=i.end-i.first;Tu(r)&&(this.lastLevelLoadSec=r/1e3),e.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(e.levelInfo)}onFragLoaded(t,e){let{frag:n,part:i}=e;const r=i?i.stats:n.stats;if(n.type===Ou&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(n)){if(this.clearTimer(),n.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const t=i?i.duration:n.duration,e=this.hls.levels[n.level],s=(e.loaded?e.loaded.bytes:0)+r.loaded,a=(e.loaded?e.loaded.duration:0)+t;e.loaded={bytes:s,duration:a},e.realBitrate=Math.round(8*s/a)}if(n.bitrateTest){const t={stats:r,frag:n,part:i,id:n.type};this.onFragBuffered(ku.FRAG_BUFFERED,t),n.bitrateTest=!1}else this.lastLoadedFragLevel=n.level}}onFragBuffered(t,e){const{frag:n,part:i}=e,r=null!=i&&i.stats.loaded?i.stats:n.stats;if(r.aborted)return;if(this.ignoreFragment(n))return;const s=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(s,r.loaded),r.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=s/1e3:this.bitrateTestDelay=0}ignoreFragment(t){return t.type!==Ou||"initSegment"===t.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:t,minAutoLevel:e}=this.hls,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,r=this.findBestLevel(n,e,t,0,i,1,1);if(r>-1)return r;const s=this.hls.firstLevel,a=Math.min(Math.max(s,e),t);return this.warn("Could not find best starting auto level. Defaulting to first in playlist ".concat(s," clamped to ").concat(a)),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const t=this.forcedAutoLevel,e=this.bwEstimator.canEstimate(),n=this.lastLoadedFragLevel>-1;if(-1!==t&&(!e||!n||this.nextAutoLevelKey===this.getAutoLevelKey()))return t;const i=e&&n?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==t){const e=this.hls.levels;if(e.length>Math.max(t,i)&&e[t].loadError<=e[i].loadError)return t}return this._nextAutoLevel=i,this.nextAutoLevelKey=this.getAutoLevelKey(),i}getAutoLevelKey(){return"".concat(this.getBwEstimate(),"_").concat(this.getStarvationDelay().toFixed(2))}getNextABRAutoLevel(){const{fragCurrent:t,partCurrent:e,hls:n}=this;if(n.levels.length<=1)return n.loadLevel;const{maxAutoLevel:i,config:r,minAutoLevel:s}=n,a=e?e.duration:t?t.duration:0,o=this.getBwEstimate(),l=this.getStarvationDelay();let c=r.abrBandWidthFactor,u=r.abrBandWidthUpFactor;if(l){const t=this.findBestLevel(o,s,i,l,0,c,u);if(t>=0)return this.rebufferNotice=-1,t}let h=a?Math.min(a,r.maxStarvationDelay):r.maxStarvationDelay;if(!l){const t=this.bitrateTestDelay;if(t){h=(a?Math.min(a,r.maxLoadingDelay):r.maxLoadingDelay)-t,this.info("bitrate test took ".concat(Math.round(1e3*t),"ms, set first fragment max fetchDuration to ").concat(Math.round(1e3*h)," ms")),c=u=1}}const d=this.findBestLevel(o,s,i,l,h,c,u);if(this.rebufferNotice!==d&&(this.rebufferNotice=d,this.info("".concat(l?"rebuffering expected":"buffer is empty",", optimal quality level ").concat(d))),d>-1)return d;const f=n.levels[s],p=n.loadLevelObj;return p&&(null==f?void 0:f.bitrate)<p.bitrate?s:n.loadLevel}getStarvationDelay(){const t=this.hls,e=t.media;if(!e)return 1/0;const n=e&&0!==e.playbackRate?Math.abs(e.playbackRate):1,i=t.mainForwardBufferInfo;return(i?i.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(t,e,n,i,r,s,a){var o;const l=i+r,c=this.lastLoadedFragLevel,u=-1===c?this.hls.firstLevel:c,{fragCurrent:h,partCurrent:d}=this,{levels:f,allAudioTracks:p,loadLevel:m,config:g}=this.hls;if(1===f.length)return 0;const v=f[u],y=!(null==(o=this.hls.latestLevelDetails)||!o.live),_=-1===m||-1===c;let b,x="SDR",E=(null==v?void 0:v.frameRate)||0;const{audioPreference:w,videoPreference:S}=g,T=this.audioTracksByGroup||(this.audioTracksByGroup=Ed(p));let M=-1;if(_){if(-1!==this.firstSelection)return this.firstSelection;const i=this.codecTiers||(this.codecTiers=function(t,e,n,i){return t.slice(n,i+1).reduce((t,n,i)=>{if(!n.codecSet)return t;const r=n.audioGroups;let s=t[n.codecSet];s||(t[n.codecSet]=s={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:i,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!r,fragmentError:0}),s.minBitrate=Math.min(s.minBitrate,n.bitrate);const a=Math.min(n.height,n.width);return s.minHeight=Math.min(s.minHeight,a),s.minFramerate=Math.min(s.minFramerate,n.frameRate),s.minIndex=Math.min(s.minIndex,i),s.maxScore=Math.max(s.maxScore,n.score),s.fragmentError+=n.fragmentError,s.videoRanges[n.videoRange]=(s.videoRanges[n.videoRange]||0)+1,r&&r.forEach(t=>{if(!t)return;const n=e.groups[t];n&&(s.hasDefaultAudio=s.hasDefaultAudio||e.hasDefaultAudio?n.hasDefault:n.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(n.channels).forEach(t=>{s.channels[t]=(s.channels[t]||0)+n.channels[t]}))}),t},{})}(f,T,e,n)),r=function(t,e,n,i,r){const s=Object.keys(t),a=null==i?void 0:i.channels,o=null==i?void 0:i.audioCodec,l=null==r?void 0:r.videoCodec,c=a&&2===parseInt(a);let u=!1,h=!1,d=1/0,f=1/0,p=1/0,m=1/0,g=0,v=[];const{preferHDR:y,allowedVideoRanges:_}=_d(e,r);for(let w=s.length;w--;){const e=t[s[w]];u||(u=e.channels[2]>0),d=Math.min(d,e.minHeight),f=Math.min(f,e.minFramerate),p=Math.min(p,e.minBitrate),_.filter(t=>e.videoRanges[t]>0).length>0&&(h=!0)}d=Tu(d)?d:0,f=Tu(f)?f:0;const b=Math.max(1080,d),x=Math.max(30,f);p=Tu(p)?p:n,n=Math.max(p,n),h||(e=void 0);const E=s.length>1;return{codecSet:s.reduce((e,i)=>{const r=t[i];if(i===e)return e;if(v=h?_.filter(t=>r.videoRanges[t]>0):[],E){if(r.minBitrate>n)return xd(i,"min bitrate of ".concat(r.minBitrate," > current estimate of ").concat(n)),e;if(!r.hasDefaultAudio)return xd(i,"no renditions with default or auto-select sound found"),e;if(o&&i.indexOf(o.substring(0,4))%5!==0)return xd(i,'audio codec preference "'.concat(o,'" not found')),e;if(a&&!c){if(!r.channels[a])return xd(i,"no renditions with ".concat(a," channel sound found (channels options: ").concat(Object.keys(r.channels),")")),e}else if((!o||c)&&u&&0===r.channels[2])return xd(i,"no renditions with stereo sound found"),e;if(r.minHeight>b)return xd(i,"min resolution of ".concat(r.minHeight," > maximum of ").concat(b)),e;if(r.minFramerate>x)return xd(i,"min framerate of ".concat(r.minFramerate," > maximum of ").concat(x)),e;if(!v.some(t=>r.videoRanges[t]>0))return xd(i,"no variants with VIDEO-RANGE of ".concat(bd(v)," found")),e;if(l&&i.indexOf(l.substring(0,4))%5!==0)return xd(i,'video codec preference "'.concat(l,'" not found')),e;if(r.maxScore<g)return xd(i,"max score of ".concat(r.maxScore," < selected max of ").concat(g)),e}return e&&(Kh(i)>=Kh(e)||r.fragmentError>t[e].fragmentError)?e:(m=r.minIndex,g=r.maxScore,i)},void 0),videoRanges:v,preferHDR:y,minFramerate:f,minBitrate:p,minIndex:m}}(i,x,t,w,S),{codecSet:s,videoRanges:a,minFramerate:o,minBitrate:l,minIndex:c,preferHDR:u}=r;M=c,b=s,x=u?a[a.length-1]:a[0],E=o,t=Math.max(t,l),this.log("picked start tier ".concat(bd(r)))}else b=null==v?void 0:v.codecSet,x=null==v?void 0:v.videoRange;const A=d?d.duration:h?h.duration:0,C=this.bwEstimator.getEstimateTTFB()/1e3,R=[];for(let L=n;L>=e;L--){var k;const e=f[L],o=L>u;if(!e)continue;if(g.useMediaCapabilities&&!e.supportedResult&&!e.supportedPromise){const n=navigator.mediaCapabilities;"function"===typeof(null==n?void 0:n.decodingInfo)&&ad(e,T,x,E,t,w)?(e.supportedPromise=od(e,T,n,this.supportedCache),e.supportedPromise.then(t=>{if(!this.hls)return;e.supportedResult=t;const n=this.hls.levels,i=n.indexOf(e);t.error?this.warn('MediaCapabilities decodingInfo error: "'.concat(t.error,'" for level ').concat(i," ").concat(bd(t))):t.supported?t.decodingInfoResults.some(t=>!1===t.smooth||!1===t.powerEfficient)&&this.log("MediaCapabilities decodingInfo for level ".concat(i," not smooth or powerEfficient: ").concat(bd(t))):(this.warn("Unsupported MediaCapabilities decodingInfo result for level ".concat(i," ").concat(bd(t))),i>-1&&n.length>1&&(this.log("Removing unsupported level ".concat(i)),this.hls.removeLevel(i),-1===this.hls.loadLevel&&(this.hls.nextLoadLevel=0)))}).catch(t=>{this.warn("Error handling MediaCapabilities decodingInfo: ".concat(t))})):e.supportedResult=rd}if((b&&e.codecSet!==b||x&&e.videoRange!==x||o&&E>e.frameRate||!o&&E>0&&E<e.frameRate||null!=(k=e.supportedResult)&&null!=(k=k.decodingInfoResults)&&k.some(t=>!1===t.smooth))&&(!_||L!==M)){R.push(L);continue}const h=e.details,p=(d?null==h?void 0:h.partTarget:null==h?void 0:h.averagetargetduration)||A;let v;v=o?a*t:s*t;const S=A&&i>=2*A&&0===r?e.averageBitrate:e.maxBitrate,D=this.getTimeToLoadFrag(C,v,S*p,void 0===h);if(v>=S&&(L===c||0===e.loadError&&0===e.fragmentError)&&(D<=C||!Tu(D)||y&&!this.bitrateTestDelay||D<l)){const t=this.forcedAutoLevel;return L===m||-1!==t&&t===m||(R.length&&this.trace("Skipped level(s) ".concat(R.join(",")," of ").concat(n,' max with CODECS and VIDEO-RANGE:"').concat(f[R[0]].codecs,'" ').concat(f[R[0]].videoRange,'; not compatible with "').concat(b,'" ').concat(x)),this.info("switch candidate:".concat(u,"->").concat(L," adjustedbw(").concat(Math.round(v),")-bitrate=").concat(Math.round(v-S)," ttfb:").concat(C.toFixed(1)," avgDuration:").concat(p.toFixed(1)," maxFetchDuration:").concat(l.toFixed(1)," fetchDuration:").concat(D.toFixed(1)," firstSelection:").concat(_," codecSet:").concat(e.codecSet," videoRange:").concat(e.videoRange," hls.loadLevel:").concat(m))),_&&(this.firstSelection=L),L}}return-1}set nextAutoLevel(t){const e=this.deriveNextAutoLevel(t);this._nextAutoLevel!==e&&(this.nextAutoLevelKey="",this._nextAutoLevel=e)}deriveNextAutoLevel(t){const{maxAutoLevel:e,minAutoLevel:n}=this.hls;return Math.min(Math.max(t,n),e)}},bufferController:class extends ju{constructor(t,e){var n;super("buffer-controller",t.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=t=>{var e;this.hls&&"open"===(null==(e=this.mediaSource)?void 0:e.readyState)&&this.hls.pauseBuffering()},this._onStartStreaming=t=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=t=>{const{media:e,mediaSource:n}=this;t&&this.log("Media source opened"),e&&n&&(n.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(ku.MEDIA_ATTACHED,{media:e,mediaSource:n}),null!==this.mediaSource&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:t,_objectUrl:e}=this;t!==e&&this.error("Media element src was set while attaching MediaSource (".concat(e," > ").concat(t,")"))},this.hls=t,this.fragmentTracker=e,this.appendSource=(n=Zu(t.config.preferManagedMediaSource),"undefined"!==typeof self&&n===self.ManagedMediaSource),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:t}=this;t.on(ku.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.on(ku.MANIFEST_PARSED,this.onManifestParsed,this),t.on(ku.BUFFER_RESET,this.onBufferReset,this),t.on(ku.BUFFER_APPENDING,this.onBufferAppending,this),t.on(ku.BUFFER_CODECS,this.onBufferCodecs,this),t.on(ku.BUFFER_EOS,this.onBufferEos,this),t.on(ku.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(ku.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(ku.FRAG_PARSED,this.onFragParsed,this),t.on(ku.FRAG_CHANGED,this.onFragChanged,this),t.on(ku.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(ku.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.off(ku.MANIFEST_PARSED,this.onManifestParsed,this),t.off(ku.BUFFER_RESET,this.onBufferReset,this),t.off(ku.BUFFER_APPENDING,this.onBufferAppending,this),t.off(ku.BUFFER_CODECS,this.onBufferCodecs,this),t.off(ku.BUFFER_EOS,this.onBufferEos,this),t.off(ku.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(ku.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(ku.FRAG_PARSED,this.onFragParsed,this),t.off(ku.FRAG_CHANGED,this.onFragChanged,this),t.off(ku.ERROR,this.onError,this)}transferMedia(){const{media:t,mediaSource:e}=this;if(!t)return null;const n={};if(this.operationQueue){const t=this.isUpdating();t||this.operationQueue.removeBlockers();const e=this.isQueued();(t||e)&&this.warn("Transfering MediaSource with".concat(e?" operations in queue":"").concat(t?" updating SourceBuffer(s)":""," ").concat(this.operationQueue)),this.operationQueue.destroy()}const i=this.transferData;return!this.sourceBufferCount&&i&&i.mediaSource===e?Hu(n,i.tracks):this.sourceBuffers.forEach(t=>{const[e]=t;e&&(n[e]=Hu({},this.tracks[e]),this.removeBuffer(e)),t[0]=t[1]=null}),{media:t,mediaSource:e,tracks:n}}initTracks(){this.sourceBuffers=[[null,null],[null,null]],this.tracks={},this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(t,e){var n;let i=2;(e.audio&&!e.video||!e.altAudio)&&(i=1),this.bufferCodecEventsTotal=i,this.log("".concat(i," bufferCodec event(s) expected.")),null!=(n=this.transferData)&&n.mediaSource&&this.sourceBufferCount&&i&&this.bufferCreated()}onMediaAttaching(t,e){const n=this.media=e.media;this.transferData=this.overrides=void 0;const i=Zu(this.appendSource);if(i){const t=!!e.mediaSource;(t||e.overrides)&&(this.transferData=e,this.overrides=e.overrides);const r=this.mediaSource=e.mediaSource||new i;if(this.assignMediaSource(r),t)this._objectUrl=n.src,this.attachTransferred();else{const t=this._objectUrl=self.URL.createObjectURL(r);if(this.appendSource)try{n.removeAttribute("src");const e=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||e&&r instanceof e,Ug(n),function(t,e){const n=self.document.createElement("source");n.type="video/mp4",n.src=e,t.appendChild(n)}(n,t),n.load()}catch(CO){n.src=t}else n.src=t}n.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(t){var e,n;this.log("".concat((null==(e=this.transferData)?void 0:e.mediaSource)===t?"transferred":"created"," media source: ").concat(null==(n=t.constructor)?void 0:n.name)),t.addEventListener("sourceopen",this._onMediaSourceOpen),t.addEventListener("sourceended",this._onMediaSourceEnded),t.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.addEventListener("startstreaming",this._onStartStreaming),t.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const t=this.media,e=this.transferData;if(!e||!t)return;const n=this.tracks,i=e.tracks,r=i?Object.keys(i):null,s=r?r.length:0,a=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(i&&r&&s){if(!this.tracksReady)return this.hls.config.startFragPrefetch=!0,void this.log("attachTransferred: waiting for SourceBuffer track info");if(this.log("attachTransferred: (bufferCodecEventsTotal ".concat(this.bufferCodecEventsTotal,")\nrequired tracks: ").concat(bd(n,(t,e)=>"initSegment"===t?void 0:e),";\ntransfer tracks: ").concat(bd(i,(t,e)=>"initSegment"===t?void 0:e),"}")),!Ju(i,n)){e.mediaSource=null,e.tracks=void 0;const r=t.currentTime,s=this.details,a=Math.max(r,(null==s?void 0:s.fragments[0].start)||0);return a-r>1?void this.log("attachTransferred: waiting for playback to reach new tracks start time ".concat(r," -> ").concat(a)):(this.warn('attachTransferred: resetting MediaSource for incompatible tracks ("'.concat(Object.keys(i),'"->"').concat(Object.keys(n),'") start time: ').concat(a," currentTime: ").concat(r)),this.onMediaDetaching(ku.MEDIA_DETACHING,{}),this.onMediaAttaching(ku.MEDIA_ATTACHING,e),void(t.currentTime=a))}this.transferData=void 0,r.forEach(t=>{const e=t,n=i[e];if(n){const t=n.buffer;if(t){const i=this.fragmentTracker,r=n.id;if(i.hasFragments(r)||i.hasParts(r)){const n=bf.getBuffered(t);i.detectEvictedFragments(e,n,r,null,!0)}const s=Bg(e),a=[e,t];this.sourceBuffers[s]=a,t.updating&&this.operationQueue&&this.operationQueue.prependBlocker(e),this.trackSourceBuffer(e,n)}}}),a(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),a()}get mediaSourceOpenOrEnded(){var t;const e=null==(t=this.mediaSource)?void 0:t.readyState;return"open"===e||"ended"===e}onMediaDetaching(t,e){const n=!!e.transferMedia;this.transferData=this.overrides=void 0;const{media:i,mediaSource:r,_objectUrl:s}=this;if(r){if(this.log("media source ".concat(n?"transferring":"detaching")),n)this.sourceBuffers.forEach(t=>{let[e]=t;e&&this.removeBuffer(e)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const t="open"===r.readyState;try{const e=r.sourceBuffers;for(let n=e.length;n--;)t&&e[n].abort(),r.removeSourceBuffer(e[n]);t&&r.endOfStream()}catch(Yq){this.warn("onMediaDetaching: ".concat(Yq.message," while calling endOfStream"))}}this.sourceBufferCount&&this.onBufferReset()}r.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("sourceended",this._onMediaSourceEnded),r.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(r.removeEventListener("startstreaming",this._onStartStreaming),r.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}i&&(i.removeEventListener("emptied",this._onMediaEmptied),n||(s&&self.URL.revokeObjectURL(s),this.mediaSrc===s?(i.removeAttribute("src"),this.appendSource&&Ug(i),i.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(ku.MEDIA_DETACHED,e)}onBufferReset(){this.sourceBuffers.forEach(t=>{let[e]=t;e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(t){var e;const n=null==(e=this.tracks[t])?void 0:e.buffer;if(this.removeBuffer(t),n)try{var i;null!=(i=this.mediaSource)&&i.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}catch(Yq){this.warn("onBufferReset ".concat(t),Yq)}delete this.tracks[t]}removeBuffer(t){this.removeBufferListeners(t),this.sourceBuffers[Bg(t)]=[null,null];const e=this.tracks[t];e&&(e.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new Ig(this.tracks)}onBufferCodecs(t,e){var n;const i=this.tracks,r=Object.keys(e);this.log('BUFFER_CODECS: "'.concat(r,'" (current SB count ').concat(this.sourceBufferCount,")"));const s="audiovideo"in e&&(i.audio||i.video)||i.audiovideo&&("audio"in e||"video"in e),a=!s&&this.sourceBufferCount&&this.media&&r.some(t=>!i[t]);s||a?this.warn('Unsupported transition between "'.concat(Object.keys(i),'" and "').concat(r,'" SourceBuffers')):(r.forEach(t=>{var n,r;const s=e[t],{id:a,codec:o,levelCodec:l,container:c,metadata:u,supplemental:h}=s;let d=i[t];const f=null==(n=this.transferData)||null==(n=n.tracks)?void 0:n[t],p=null!=f&&f.buffer?f:d,m=(null==p?void 0:p.pendingCodec)||(null==p?void 0:p.codec),g=null==p?void 0:p.levelCodec;d||(d=i[t]={buffer:void 0,listeners:[],codec:o,supplemental:h,container:c,levelCodec:l,metadata:u,id:a});const v=Jh(m,g),y=null==v?void 0:v.replace(Og,"$1");let _=Jh(o,l);const b=null==(r=_)?void 0:r.replace(Og,"$1");_&&v&&y!==b&&("audio"===t.slice(0,5)&&(_=Zh(_,this.appendSource)),this.log("switching codec ".concat(m," to ").concat(_)),_!==(d.pendingCodec||d.codec)&&(d.pendingCodec=_),d.container=c,this.appendChangeType(t,c,_))}),(this.tracksReady||this.sourceBufferCount)&&(e.tracks=this.sourceBufferTracks),this.sourceBufferCount||(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!e.video&&"main"===(null==(n=e.audio)?void 0:n.id)&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks()))}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((t,e)=>{const n=this.tracks[e];return t[e]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},t},{})}appendChangeType(t,e,n){const i="".concat(e,";codecs=").concat(n),r={label:"change-type=".concat(i),execute:()=>{const r=this.tracks[t];if(r){const s=r.buffer;null!=s&&s.changeType&&(this.log("changing ".concat(t," sourceBuffer type to ").concat(i)),s.changeType(i),r.codec=n,r.container=e)}this.shiftAndExecuteNext(t)},onStart:()=>{},onComplete:()=>{},onError:e=>{this.warn("Failed to change ".concat(t," SourceBuffer type"),e)}};this.append(r,t,this.isPending(this.tracks[t]))}blockAudio(t){var e;const n=t.start,i=n+.05*t.duration;if(!0===(null==(e=this.fragmentTracker.getAppendedFrag(n,Ou))?void 0:e.gap))return;const r={label:"block-audio",execute:()=>{var t;const e=this.tracks.video;(this.lastVideoAppendEnd>i||null!=e&&e.buffer&&bf.isBuffered(e.buffer,i)||!0===(null==(t=this.fragmentTracker.getAppendedFrag(i,Ou))?void 0:t.gap))&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:t=>{this.warn("Error executing block-audio operation",t)}};this.blockedAudioAppend={op:r,frag:t},this.append(r,"audio",!0)}unblockAudio(){const{blockedAudioAppend:t,operationQueue:e}=this;t&&e&&(this.blockedAudioAppend=null,e.unblockAudio(t.op))}onBufferAppending(t,e){const{tracks:n}=this,{data:i,type:r,parent:s,frag:a,part:o,chunkMeta:l,offset:c}=e,u=l.buffering[r],{sn:h,cc:d}=a,f=self.performance.now();u.start=f;const p=a.stats.buffering,m=o?o.stats.buffering:null;0===p.start&&(p.start=f),m&&0===m.start&&(m.start=f);const g=n.audio;let v=!1;"audio"===r&&"audio/mpeg"===(null==g?void 0:g.container)&&(v=!this.lastMpegAudioChunk||1===l.id||this.lastMpegAudioChunk.sn!==l.sn,this.lastMpegAudioChunk=l);const y=n.video,_=null==y?void 0:y.buffer;if(_&&"initSegment"!==h){const t=o||a,e=this.blockedAudioAppend;if("audio"!==r||"main"===s||this.blockedAudioAppend||y.ending||y.ended){if("video"===r){const n=t.end;if(e){const t=e.frag.start;(n>t||n<this.lastVideoAppendEnd||bf.isBuffered(_,t))&&this.unblockAudio()}this.lastVideoAppendEnd=n}}else{const e=t.start+.05*t.duration,n=_.buffered,i=this.currentOp("video");n.length||i?!i&&!bf.isBuffered(_,e)&&this.lastVideoAppendEnd<e&&this.blockAudio(t):this.blockAudio(t)}}const b=(o||a).start,x={label:"append-".concat(r),execute:()=>{var t;u.executeStart=self.performance.now();const e=null==(t=this.tracks[r])?void 0:t.buffer;e&&(v?this.updateTimestampOffset(e,b,.1,r,h,d):void 0!==c&&Tu(c)&&this.updateTimestampOffset(e,c,1e-6,r,h,d)),this.appendExecutor(i,r)},onStart:()=>{},onComplete:()=>{const t=self.performance.now();u.executeEnd=u.end=t,0===p.first&&(p.first=t),m&&0===m.first&&(m.first=t);const e={};this.sourceBuffers.forEach(t=>{let[n,i]=t;n&&(e[n]=bf.getBuffered(i))}),this.appendErrors[r]=0,"audio"===r||"video"===r?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(ku.BUFFER_APPENDED,{type:r,frag:a,part:o,chunkMeta:l,parent:a.type,timeRanges:e})},onError:t=>{var e;const n={type:Cu.MEDIA_ERROR,parent:a.type,details:Ru.BUFFER_APPEND_ERROR,sourceBufferName:r,frag:a,part:o,chunkMeta:l,error:t,err:t,fatal:!1},i=null==(e=this.media)?void 0:e.error;if(t.code===DOMException.QUOTA_EXCEEDED_ERR||"QuotaExceededError"==t.name||"quota"in t)n.details=Ru.BUFFER_FULL_ERROR;else if(t.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!i)n.errorAction=Qd(!0);else if(t.name===Ng&&0===this.sourceBufferCount)n.errorAction=Qd(!0);else{const t=++this.appendErrors[r];this.warn("Failed ".concat(t,"/").concat(this.hls.config.appendErrorMaxRetry,' times to append segment in "').concat(r,'" sourceBuffer (').concat(i||"no media error",")")),(t>=this.hls.config.appendErrorMaxRetry||i)&&(n.fatal=!0)}this.hls.trigger(ku.ERROR,n)}};this.log('queuing "'.concat(r,'" append sn: ').concat(h).concat(o?" p: "+o.index:""," of ").concat(a.type===Ou?"level":"track"," ").concat(a.level," cc: ").concat(d)),this.append(x,r,this.isPending(this.tracks[r]))}getFlushOp(t,e,n){return this.log('queuing "'.concat(t,'" remove ').concat(e,"-").concat(n)),{label:"remove",execute:()=>{this.removeExecutor(t,e,n)},onStart:()=>{},onComplete:()=>{this.hls.trigger(ku.BUFFER_FLUSHED,{type:t})},onError:i=>{this.warn("Failed to remove ".concat(e,"-").concat(n,' from "').concat(t,'" SourceBuffer'),i)}}}onBufferFlushing(t,e){const{type:n,startOffset:i,endOffset:r}=e;n?this.append(this.getFlushOp(n,i,r),n):this.sourceBuffers.forEach(t=>{let[e]=t;e&&this.append(this.getFlushOp(e,i,r),e)})}onFragParsed(t,e){const{frag:n,part:i}=e,r=[],s=i?i.elementaryStreams:n.elementaryStreams;s[ch]?r.push("audiovideo"):(s[oh]&&r.push("audio"),s[lh]&&r.push("video"));0===r.length&&this.warn("Fragments must have at least one ElementaryStreamType set. type: ".concat(n.type," level: ").concat(n.level," sn: ").concat(n.sn)),this.blockBuffers(()=>{const t=self.performance.now();n.stats.buffering.end=t,i&&(i.stats.buffering.end=t);const e=i?i.stats:n.stats;this.hls.trigger(ku.FRAG_BUFFERED,{frag:n,part:i,stats:e,id:n.type})},r).catch(t=>{this.warn("Fragment buffered callback ".concat(t)),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(t,e){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(t=>{let[e]=t;if(e){const t=this.tracks[e];if(t)return!t.ended||t.ending}return!1})}onBufferEos(t,e){var n;this.sourceBuffers.forEach(t=>{let[n]=t;if(n){const t=this.tracks[n];e.type&&e.type!==n||(t.ending=!0,t.ended||(t.ended=!0,this.log("".concat(n," buffer reached EOS"))))}});const i=!1!==(null==(n=this.overrides)?void 0:n.endOfStream);this.sourceBufferCount>0&&!this.sourceBuffers.some(t=>{let[e]=t;var n;return e&&!(null!=(n=this.tracks[e])&&n.ended)})?i?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:t}=this;t&&"open"===t.readyState?(this.log("Calling mediaSource.endOfStream()"),t.endOfStream(),this.hls.trigger(ku.BUFFERED_TO_END,void 0)):t&&this.log("Could not call mediaSource.endOfStream(). mediaSource.readyState: ".concat(t.readyState))})):(this.tracksEnded(),this.hls.trigger(ku.BUFFERED_TO_END,void 0)):"video"===e.type&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(t=>{let[e]=t;if(null!==e){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(t,e){let{details:n}=e;n.fragments.length&&(this.details=n,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const t=this.getDurationAndRange();t&&this.updateMediaSource(t)})}onError(t,e){if(e.details===Ru.BUFFER_APPEND_ERROR&&e.frag){var n;const t=null==(n=e.errorAction)?void 0:n.nextAutoLevel;Tu(t)&&t!==e.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:t,details:e,media:n}=this;if(!n||null===e)return;if(!this.sourceBufferCount)return;const i=t.config,r=n.currentTime,s=e.levelTargetDuration,a=e.live&&null!==i.liveBackBufferLength?i.liveBackBufferLength:i.backBufferLength;if(Tu(a)&&a>=0){const t=Math.max(a,s),e=Math.floor(r/s)*s-t;this.flushBackBuffer(r,s,e)}const o=i.frontBufferFlushThreshold;if(Tu(o)&&o>0){const t=Math.max(i.maxBufferLength,o),e=Math.max(t,s),n=Math.floor(r/s)*s+e;this.flushFrontBuffer(r,s,n)}}flushBackBuffer(t,e,n){this.sourceBuffers.forEach(t=>{let[e,i]=t;if(i){const t=bf.getBuffered(i);if(t.length>0&&n>t.start(0)){var r;this.hls.trigger(ku.BACK_BUFFER_REACHED,{bufferEnd:n});const t=this.tracks[e];if(null!=(r=this.details)&&r.live)this.hls.trigger(ku.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(null!=t&&t.ended)return void this.log("Cannot flush ".concat(e," back buffer while SourceBuffer is in ended state"));this.hls.trigger(ku.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:e})}}})}flushFrontBuffer(t,e,n){this.sourceBuffers.forEach(e=>{let[i,r]=e;if(r){const e=bf.getBuffered(r),s=e.length;if(s<2)return;const a=e.start(s-1),o=e.end(s-1);if(n>a||t>=a&&t<=o)return;this.hls.trigger(ku.BUFFER_FLUSHING,{startOffset:a,endOffset:1/0,type:i})}})}getDurationAndRange(){var t;const{details:e,mediaSource:n}=this;if(!e||!this.media||"open"!==(null==n?void 0:n.readyState))return null;const i=e.edge;if(e.live&&this.hls.config.liveDurationInfinity){if(e.fragments.length&&n.setLiveSeekableRange){const t=Math.max(0,e.fragmentStart);return{duration:1/0,start:t,end:Math.max(t,i)}}return{duration:1/0}}const r=null==(t=this.overrides)?void 0:t.duration;if(r)return Tu(r)?{duration:r}:null;const s=this.media.duration;return i>(Tu(n.duration)?n.duration:0)&&i>s||!Tu(s)?{duration:i}:null}updateMediaSource(t){let{duration:e,start:n,end:i}=t;const r=this.mediaSource;this.media&&r&&"open"===r.readyState&&(r.duration!==e&&(Tu(e)&&this.log("Updating MediaSource duration to ".concat(e.toFixed(3))),r.duration=e),void 0!==n&&void 0!==i&&(this.log("MediaSource duration is set to ".concat(r.duration,". Setting seekable range to ").concat(n,"-").concat(i,".")),r.setLiveSeekableRange(n,i)))}get tracksReady(){const t=this.pendingTrackCount;return t>0&&(t>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:t,pendingTrackCount:e,tracks:n}=this;if(this.log("checkPendingTracks (pending: ".concat(e," codec events expected: ").concat(t,") ").concat(bd(n))),this.tracksReady){var i;const t=null==(i=this.transferData)?void 0:i.tracks;t&&Object.keys(t).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const t={};this.sourceBuffers.forEach(e=>{let[n,i]=e;if(n){const e=this.tracks[n];t[n]={buffer:i,container:e.container,codec:e.codec,supplemental:e.supplemental,levelCodec:e.levelCodec,id:e.id,metadata:e.metadata}}}),this.hls.trigger(ku.BUFFER_CREATED,{tracks:t}),this.log("SourceBuffers created. Running queue: ".concat(this.operationQueue)),this.sourceBuffers.forEach(t=>{let[e]=t;this.executeNext(e)})}else{const t=new Error("could not create source buffer for media codec(s)");this.hls.trigger(ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:t,reason:t.message})}}createSourceBuffers(){const{tracks:t,sourceBuffers:e,mediaSource:n}=this;if(!n)throw new Error("createSourceBuffers called when mediaSource was null");for(const r in t){const s=r,a=t[s];if(this.isPending(a)){const t=this.getTrackCodec(a,s),r="".concat(a.container,";codecs=").concat(t);a.codec=t,this.log("creating sourceBuffer(".concat(r,")").concat(this.currentOp(s)?" Queued":""," ").concat(bd(a)));try{const t=n.addSourceBuffer(r),i=Bg(s),o=[s,t];e[i]=o,a.buffer=t}catch(CO){var i;return this.error("error while trying to add sourceBuffer: ".concat(CO.message)),this.shiftAndExecuteNext(s),null==(i=this.operationQueue)||i.removeBlockers(),delete this.tracks[s],void this.hls.trigger(ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:CO,sourceBufferName:s,mimeType:r,parent:a.id})}this.trackSourceBuffer(s,a)}}this.bufferCreated()}getTrackCodec(t,e){const n=t.supplemental;let i=t.codec;n&&("video"===e||"audiovideo"===e)&&jh(n,"video")&&(i=function(t,e){const n=[];if(t){const e=t.split(",");for(let t=0;t<e.length;t++)Gh(e[t],"video")||n.push(e[t])}return e&&n.push(e),n.join(",")}(i,n));const r=Jh(i,t.levelCodec);return r?"audio"===e.slice(0,5)?Zh(r,this.appendSource):r:""}trackSourceBuffer(t,e){const n=e.buffer;if(!n)return;const i=this.getTrackCodec(e,t);this.tracks[t]={buffer:n,codec:i,container:e.container,levelCodec:e.levelCodec,supplemental:e.supplemental,metadata:e.metadata,id:e.id,listeners:[]},this.removeBufferListeners(t),this.addBufferListener(t,"updatestart",this.onSBUpdateStart),this.addBufferListener(t,"updateend",this.onSBUpdateEnd),this.addBufferListener(t,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(t,"bufferedchange",(t,e)=>{const n=e.removedRanges;null!=n&&n.length&&this.hls.trigger(ku.BUFFER_FLUSHED,{type:t})})}get mediaSrc(){var t,e;const n=(null==(t=this.media)||null==(e=t.querySelector)?void 0:e.call(t,"source"))||this.media;return null==n?void 0:n.src}onSBUpdateStart(t){const e=this.currentOp(t);e&&e.onStart()}onSBUpdateEnd(t){var e;if("closed"===(null==(e=this.mediaSource)?void 0:e.readyState))return void this.resetBuffer(t);const n=this.currentOp(t);n&&(n.onComplete(),this.shiftAndExecuteNext(t))}onSBUpdateError(t,e){var n;const i=new Error("".concat(t," SourceBuffer error. MediaSource readyState: ").concat(null==(n=this.mediaSource)?void 0:n.readyState));this.error("".concat(i),e),this.hls.trigger(ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.BUFFER_APPENDING_ERROR,sourceBufferName:t,error:i,fatal:!1});const r=this.currentOp(t);r&&r.onError(i)}updateTimestampOffset(t,e,n,i,r,s){const a=e-t.timestampOffset;Math.abs(a)>=n&&(this.log("Updating ".concat(i," SourceBuffer timestampOffset to ").concat(e," (sn: ").concat(r," cc: ").concat(s,")")),t.timestampOffset=e)}removeExecutor(t,e,n){const{media:i,mediaSource:r}=this,s=this.tracks[t],a=null==s?void 0:s.buffer;if(!i||!r||!a)return this.warn("Attempting to remove from the ".concat(t," SourceBuffer, but it does not exist")),void this.shiftAndExecuteNext(t);const o=Tu(i.duration)?i.duration:1/0,l=Tu(r.duration)?r.duration:1/0,c=Math.max(0,e),u=Math.min(n,o,l);u>c&&(!s.ending||s.ended)?(s.ended=!1,this.log("Removing [".concat(c,",").concat(u,"] from the ").concat(t," SourceBuffer")),a.remove(c,u)):this.shiftAndExecuteNext(t)}appendExecutor(t,e){const n=this.tracks[e],i=null==n?void 0:n.buffer;if(!i)throw new Fg("Attempting to append to the ".concat(e," SourceBuffer, but it does not exist"));n.ending=!1,n.ended=!1,i.appendBuffer(t)}blockUntilOpen(t){if(this.isUpdating()||this.isQueued())this.blockBuffers(t).catch(t=>{this.warn("SourceBuffer blocked callback ".concat(t)),this.stepOperationQueue(this.sourceBufferTypes)});else try{t()}catch(CO){this.warn("Callback run without blocking ".concat(this.operationQueue," ").concat(CO))}}isUpdating(){return this.sourceBuffers.some(t=>{let[e,n]=t;return e&&n.updating})}isQueued(){return this.sourceBuffers.some(t=>{let[e]=t;return e&&!!this.currentOp(e)})}isPending(t){return!!t&&!t.buffer}blockBuffers(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sourceBufferTypes;if(!e.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(t);const{operationQueue:n}=this,i=e.map(t=>this.appendBlocker(t));return e.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(i).then(e=>{n===this.operationQueue&&(t(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(t){t.forEach(t=>{var e;const n=null==(e=this.tracks[t])?void 0:e.buffer;n&&!n.updating&&this.shiftAndExecuteNext(t)})}append(t,e,n){this.operationQueue&&this.operationQueue.append(t,e,n)}appendBlocker(t){if(this.operationQueue)return this.operationQueue.appendBlocker(t)}currentOp(t){return this.operationQueue?this.operationQueue.current(t):null}executeNext(t){t&&this.operationQueue&&this.operationQueue.executeNext(t)}shiftAndExecuteNext(t){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(t)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((t,e)=>t+(this.isPending(this.tracks[e])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((t,e)=>{let[n]=e;return t+(n?1:0)},0)}get sourceBufferTypes(){return this.sourceBuffers.map(t=>{let[e]=t;return e}).filter(t=>!!t)}addBufferListener(t,e,n){const i=this.tracks[t];if(!i)return;const r=i.buffer;if(!r)return;const s=n.bind(this,t);i.listeners.push({event:e,listener:s}),r.addEventListener(e,s)}removeBufferListeners(t){const e=this.tracks[t];if(!e)return;const n=e.buffer;n&&(e.listeners.forEach(t=>{n.removeEventListener(t.event,t.listener)}),e.listeners.length=0)}},capLevelController:zg,errorController:class extends ju{constructor(t){super("error-controller",t.logger),this.hls=void 0,this.playlistError=0,this.hls=t,this.registerListeners()}registerListeners(){const t=this.hls;t.on(ku.ERROR,this.onError,this),t.on(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.on(ku.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const t=this.hls;t&&(t.off(ku.ERROR,this.onError,this),t.off(ku.ERROR,this.onErrorOut,this),t.off(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.off(ku.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(t){}stopLoad(){this.playlistError=0}getVariantLevelIndex(t){return(null==t?void 0:t.type)===Ou?t.level:this.getVariantIndex()}getVariantIndex(){var t;const e=this.hls,n=e.currentLevel;return null!=(t=e.loadLevelObj)&&t.details||-1===n?e.loadLevel:n}variantHasKey(t,e){if(t){var n;if(null!=(n=t.details)&&n.hasKey(e))return!0;const i=t.audioGroups;if(i){return this.hls.allAudioTracks.filter(t=>i.indexOf(t.groupId)>=0).some(t=>{var n;return null==(n=t.details)?void 0:n.hasKey(e)})}}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(t,e){var n;if(e.fatal)return;const i=this.hls,r=e.context;switch(e.details){case Ru.FRAG_LOAD_ERROR:case Ru.FRAG_LOAD_TIMEOUT:case Ru.KEY_LOAD_ERROR:case Ru.KEY_LOAD_TIMEOUT:return void(e.errorAction=this.getFragRetryOrSwitchAction(e));case Ru.FRAG_PARSING_ERROR:if(null!=(n=e.frag)&&n.gap)return void(e.errorAction=Qd());case Ru.FRAG_GAP:case Ru.FRAG_DECRYPT_ERROR:return e.errorAction=this.getFragRetryOrSwitchAction(e),void(e.errorAction.action=Gd);case Ru.LEVEL_EMPTY_ERROR:case Ru.LEVEL_PARSING_ERROR:{var s;const t=e.parent===Ou?e.level:i.loadLevel;e.details===Ru.LEVEL_EMPTY_ERROR&&null!=(s=e.context)&&null!=(s=s.levelDetails)&&s.live?e.errorAction=this.getPlaylistRetryOrSwitchAction(e,t):(e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t))}return;case Ru.LEVEL_LOAD_ERROR:case Ru.LEVEL_LOAD_TIMEOUT:return void("number"===typeof(null==r?void 0:r.level)&&(e.errorAction=this.getPlaylistRetryOrSwitchAction(e,r.level)));case Ru.AUDIO_TRACK_LOAD_ERROR:case Ru.AUDIO_TRACK_LOAD_TIMEOUT:case Ru.SUBTITLE_LOAD_ERROR:case Ru.SUBTITLE_TRACK_LOAD_TIMEOUT:if(r){const t=i.loadLevelObj;if(t&&(r.type===Pu&&t.hasAudioGroup(r.groupId)||r.type===Iu&&t.hasSubtitleGroup(r.groupId)))return e.errorAction=this.getPlaylistRetryOrSwitchAction(e,i.loadLevel),e.errorAction.action=Gd,void(e.errorAction.flags=Xd)}return;case Ru.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:return void(e.errorAction={action:Gd,flags:Kd});case Ru.KEY_SYSTEM_SESSION_UPDATE_FAILED:case Ru.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case Ru.KEY_SYSTEM_NO_SESSION:return void(e.errorAction={action:Gd,flags:qd});case Ru.BUFFER_ADD_CODEC_ERROR:case Ru.REMUX_ALLOC_ERROR:case Ru.BUFFER_APPEND_ERROR:var a;if(!e.errorAction)e.errorAction=this.getLevelSwitchAction(e,null!=(a=e.level)?a:i.loadLevel);return;case Ru.INTERNAL_EXCEPTION:case Ru.BUFFER_APPENDING_ERROR:case Ru.BUFFER_FULL_ERROR:case Ru.LEVEL_SWITCH_ERROR:case Ru.BUFFER_STALLED_ERROR:case Ru.BUFFER_SEEK_OVER_HOLE:case Ru.BUFFER_NUDGE_ON_STALL:return void(e.errorAction=Qd())}e.type===Cu.KEY_SYSTEM_ERROR&&(e.levelRetry=!1,e.errorAction=Qd())}getPlaylistRetryOrSwitchAction(t,e){const n=Fd(this.hls.config.playlistLoadPolicy,t),i=this.playlistError++;if(zd(n,i,Id(t),t.response))return{action:Wd,flags:Yd,retryConfig:n,retryCount:i};const r=this.getLevelSwitchAction(t,e);return n&&(r.retryConfig=n,r.retryCount=i),r}getFragRetryOrSwitchAction(t){const e=this.hls,n=this.getVariantLevelIndex(t.frag),i=e.levels[n],{fragLoadPolicy:r,keyLoadPolicy:s}=e.config,a=Fd(Od(t)?s:r,t),o=e.levels.reduce((t,e)=>t+e.fragmentError,0);if(i&&(t.details!==Ru.FRAG_GAP&&i.fragmentError++,!Nd(t))){if(zd(a,o,Id(t),t.response))return{action:Wd,flags:Yd,retryConfig:a,retryCount:o}}const l=this.getLevelSwitchAction(t,n);return a&&(l.retryConfig=a,l.retryCount=o),l}getLevelSwitchAction(t,e){const n=this.hls;null!==e&&void 0!==e||(e=n.loadLevel);const i=this.hls.levels[e];if(i){var r,s;const e=t.details;i.loadError++,e===Ru.BUFFER_APPEND_ERROR&&i.fragmentError++;let l=-1;const{levels:c,loadLevel:u,minAutoLevel:h,maxAutoLevel:d}=n;n.autoLevelEnabled||n.config.preserveManualLevelOnError||(n.loadLevel=-1);const f=null==(r=t.frag)?void 0:r.type,p=(f===Nu&&e===Ru.FRAG_PARSING_ERROR||"audio"===t.sourceBufferName&&(e===Ru.BUFFER_ADD_CODEC_ERROR||e===Ru.BUFFER_APPEND_ERROR))&&c.some(t=>{let{audioCodec:e}=t;return i.audioCodec!==e}),m="video"===t.sourceBufferName&&(e===Ru.BUFFER_ADD_CODEC_ERROR||e===Ru.BUFFER_APPEND_ERROR)&&c.some(t=>{let{codecSet:e,audioCodec:n}=t;return i.codecSet!==e&&i.audioCodec===n}),{type:g,groupId:v}=null!=(s=t.context)?s:{};for(let n=c.length;n--;){const r=(n+u)%c.length;if(r!==u&&r>=h&&r<=d&&0===c[r].loadError){var a,o;const n=c[r];if(e===Ru.FRAG_GAP&&f===Ou&&t.frag){const e=c[r].details;if(e){const n=kd(t.frag,e.fragments,t.frag.start);if(null!=n&&n.gap)continue}}else{if(g===Pu&&n.hasAudioGroup(v)||g===Iu&&n.hasSubtitleGroup(v))continue;if(f===Nu&&null!=(a=i.audioGroups)&&a.some(t=>n.hasAudioGroup(t))||f===Fu&&null!=(o=i.subtitleGroups)&&o.some(t=>n.hasSubtitleGroup(t))||p&&i.audioCodec===n.audioCodec||m&&i.codecSet===n.codecSet||!p&&i.codecSet!==n.codecSet)continue}l=r;break}}if(l>-1&&n.loadLevel!==l)return t.levelRetry=!0,this.playlistError=0,{action:Gd,flags:Yd,nextAutoLevel:l}}return{action:Gd,flags:Xd}}onErrorOut(t,e){var n;switch(null==(n=e.errorAction)?void 0:n.action){case Vd:break;case Gd:this.sendAlternateToPenaltyBox(e),e.errorAction.resolved||e.details===Ru.FRAG_GAP?/MediaSource readyState: ended/.test(e.error.message)&&(this.warn('MediaSource ended after "'.concat(e.sourceBufferName,'" sourceBuffer append error. Attempting to recover from media error.')),this.hls.recoverMediaError()):e.fatal=!0}e.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(t){const e=this.hls,n=t.errorAction;if(!n)return;const{flags:i}=n,r=n.nextAutoLevel;switch(i){case Yd:this.switchLevel(t,r);break;case Kd:{const i=this.getVariantLevelIndex(t.frag),r=e.levels[i],s=null==r?void 0:r.attrs["HDCP-LEVEL"];if(n.hdcpLevel=s,"NONE"===s)this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(s){e.maxHdcpLevel=ud[ud.indexOf(s)-1],n.resolved=!0,this.warn('Restricting playback to HDCP-LEVEL of "'.concat(e.maxHdcpLevel,'" or lower'));break}}case qd:{const e=t.decryptdata;if(e){const i=this.hls.levels,r=i.length;for(let n=r;n--;){var s,a;if(this.variantHasKey(i[n],e))this.log("Banned key found in level ".concat(n," (").concat(i[n].bitrate,'bps) or audio group "').concat(null==(s=i[n].audioGroups)?void 0:s.join(","),'" (').concat(null==(a=t.frag)?void 0:a.type," fragment) ").concat(th(e.keyId||[]))),i[n].fragmentError++,i[n].loadError++,this.log("Removing level ".concat(n," with key error (").concat(t.error,")")),this.hls.removeLevel(n)}const o=t.frag;if(this.hls.levels.length<r)n.resolved=!0;else if(o&&o.type!==Ou){const t=o.decryptdata;t&&!e.matches(t)&&(n.resolved=!0)}}break}}n.resolved||this.switchLevel(t,r)}switchLevel(t,e){if(void 0!==e&&t.errorAction&&(this.warn("switching to level ".concat(e," after ").concat(t.details)),this.hls.nextAutoLevel=e,t.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,t.details===Ru.BUFFER_ADD_CODEC_ERROR&&t.mimeType&&"audiovideo"!==t.sourceBufferName)){const e=nd(t.mimeType),n=this.hls.levels;for(let i=n.length;i--;)n[i]["".concat(t.sourceBufferName,"Codec")]===e&&(this.log("Removing level ".concat(i," for ").concat(t.details,' ("').concat(e,'" not supported)')),this.hls.removeLevel(i))}}},fpsController:class{constructor(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on(ku.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(ku.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(ku.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(ku.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,e){const n=this.hls.config;if(n.capLevelOnFPSDrop){const t=e.media instanceof self.HTMLVideoElement?e.media:null;this.media=t,t&&"function"===typeof t.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(t,e,n){const i=performance.now();if(e){if(this.lastTime){const t=i-this.lastTime,r=n-this.lastDroppedFrames,s=e-this.lastDecodedFrames,a=1e3*r/t,o=this.hls;if(o.trigger(ku.FPS_DROP,{currentDropped:r,currentDecoded:s,totalDroppedFrames:n}),a>0&&r>o.config.fpsDroppedMonitoringThreshold*s){let t=o.currentLevel;o.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+t),t>0&&(-1===o.autoLevelCapping||o.autoLevelCapping>=t)&&(t-=1,o.trigger(ku.FPS_DROP_LEVEL_CAPPING,{level:t,droppedLevel:o.currentLevel}),o.autoLevelCapping=t,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=e}}checkFPSInterval(){const t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){const e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Qf,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:i_,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends Jp{constructor(t,e,n){super(t,e,n,"subtitle-stream-controller",Fu),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(ku.LEVEL_LOADED,this.onLevelLoaded,this),t.on(ku.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(ku.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(ku.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(ku.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on(ku.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:t}=this;t.off(ku.LEVEL_LOADED,this.onLevelLoaded,this),t.off(ku.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(ku.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(ku.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(ku.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off(ku.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(t,e){this.stopLoad(),this.state=Hp,this.setInterval(500),this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(t,e){this.tracksBuffered=[],super.onMediaDetaching(t,e)}onLevelLoaded(t,e){this.mainDetails=e.details}onSubtitleFragProcessed(t,e){const{frag:n,success:i}=e;if(this.fragContextChanged(n)||(hh(n)&&(this.fragPrevious=n),this.state=Hp),!i)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let s;const a=n.start;for(let l=0;l<r.length;l++)if(a>=r[l].start&&a<=r[l].end){s=r[l];break}const o=n.start+n.duration;s?s.end=o:(s={start:a,end:o},r.push(s)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null),this.media&&this.tick()}onBufferFlushing(t,e){const{startOffset:n,endOffset:i}=e;if(0===n&&i!==Number.POSITIVE_INFINITY){const t=i-1;if(t<=0)return;e.endOffsetSubtitles=Math.max(0,t),this.tracksBuffered.forEach(e=>{for(let n=0;n<e.length;)if(e[n].end<=t)e.shift();else{if(!(e[n].start<t))break;e[n].start=t,n++}}),this.fragmentTracker.removeFragmentsInRange(n,t,Fu)}}onError(t,e){const n=e.frag;(null==n?void 0:n.type)===Fu&&(e.details===Ru.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==zp&&(this.state=Hp))}onSubtitleTracksUpdated(t,e){let{subtitleTracks:n}=e;this.levels&&Lg(this.levels,n)?this.levels=n.map(t=>new vd(t)):(this.tracksBuffered=[],this.levels=n.map(t=>{const e=new vd(t);return this.tracksBuffered[e.id]=[],e}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Fu),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(t,e){var n;if(this.currentTrackId=e.id,null==(n=this.levels)||!n.length||-1===this.currentTrackId)return void this.clearInterval();const i=this.levels[this.currentTrackId];null!=i&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.state!==zp&&this.setInterval(500)}onSubtitleTrackLoaded(t,e){var n;const{currentTrackId:i,levels:r}=this,{details:s,id:a}=e;if(!r)return void this.warn("Subtitle tracks were reset while loading level ".concat(a));const o=r[a];if(a>=r.length||!o)return;this.log("Subtitle track ".concat(a," loaded [").concat(s.startSN,",").concat(s.endSN,"]").concat(s.lastPartSn?"[part-".concat(s.lastPartSn,"-").concat(s.lastPartIndex,"]"):"",",duration:").concat(s.totalduration)),this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(s.live||null!=(n=o.details)&&n.live){if(s.deltaUpdateFailed)return;const t=this.mainDetails;if(!t)return void(this.startFragRequested=!1);const e=t.fragments[0];var c;if(o.details)l=this.alignPlaylists(s,o.details,null==(c=this.levelLastLoaded)?void 0:c.details),0===l&&e&&(l=e.start,Sp(s,l));else s.hasProgramDateTime&&t.hasProgramDateTime?(Np(s,t),l=s.fragmentStart):e&&(l=e.start,Sp(s,l));t&&!this.startFragRequested&&this.setStartPosition(t,l)}if(o.details=s,this.levelLastLoaded=o,a===i&&(this.hls.trigger(ku.SUBTITLE_TRACK_UPDATED,{details:s,id:a,groupId:e.groupId}),this.tick(),s.live&&!this.fragCurrent&&this.media&&this.state===Hp)){kd(null,s.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),o.details=void 0)}}_handleFragmentLoadComplete(t){const{frag:e,payload:n}=t,i=e.decryptdata,r=this.hls;if(!this.fragContextChanged(e)&&n&&n.byteLength>0&&null!=i&&i.key&&i.iv&&Of(i.method)){const t=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer,Nf(i.method)).catch(t=>{throw r.trigger(ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t}).then(n=>{const i=performance.now();r.trigger(ku.FRAG_DECRYPTED,{frag:e,payload:n,stats:{tstart:t,tdecrypt:i}})}).catch(t=>{this.warn("".concat(t.name,": ").concat(t.message)),this.state=Hp})}}doTick(){if(this.media){if(this.state===Hp){const{currentTrackId:t,levels:e}=this,n=null==e?void 0:e[t];if(!n||!e.length||!n.details)return;if(this.waitForLive(n))return;const{config:i}=this,r=this.getLoadPosition(),s=bf.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,i.maxBufferHole),{end:a,len:o}=s,l=n.details;if(o>this.hls.maxBufferLength+l.levelTargetDuration)return;const c=l.fragments,u=c.length,h=l.edge;let d=null;const f=this.fragPrevious;if(a<h){const t=i.maxFragLookUpTolerance,e=a>h-t?0:t;d=kd(f,c,Math.max(c[0].start,a),e),!d&&f&&f.start<c[0].start&&(d=c[0])}else d=c[u-1];if(d=this.filterReplacedPrimary(d,n.details),!d)return;const p=c[d.sn-l.startSN-1];if(p&&p.cc===d.cc&&this.fragmentTracker.getState(p)===Zd&&(d=p),this.fragmentTracker.getState(d)===Zd){const t=this.mapToInitFragWhenRequired(d);t&&this.loadFragment(t,n,a)}}}else this.state=Hp}loadFragment(t,e,n){hh(t)?super.loadFragment(t,e,n):this._loadInitSegment(t,e)}get mediaBufferTimeRanges(){return new oy(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends kg{constructor(t){super(t,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const e=Wv(this.media.textTracks);for(let i=0;i<e.length;i++)if("hidden"===e[i].mode)t=e[i];else if("showing"===e[i].mode){t=e[i];break}const n=this.findTrackForTextTrack(t);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(t){this._subtitleDisplay=t,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:t}=this;t.on(ku.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.on(ku.MANIFEST_PARSED,this.onManifestParsed,this),t.on(ku.LEVEL_LOADING,this.onLevelLoading,this),t.on(ku.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(ku.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(ku.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(ku.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.off(ku.MANIFEST_PARSED,this.onManifestParsed,this),t.off(ku.LEVEL_LOADING,this.onLevelLoading,this),t.off(ku.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(ku.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(ku.ERROR,this.onError,this)}onMediaAttached(t,e){this.media=e.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,t)}onMediaDetaching(t,e){const n=this.media;if(!n)return;const i=!!e.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||n.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,i)return;Wv(n.textTracks).forEach(t=>{Gv(t)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.subtitleTracks}onSubtitleTrackLoaded(t,e){const{id:n,groupId:i,details:r}=e,s=this.tracksInGroup[n];if(!s||s.groupId!==i)return void this.warn("Subtitle track with id:".concat(n," and group:").concat(i," not found in active group ").concat(null==s?void 0:s.groupId));const a=s.details;s.details=e.details,this.log("Subtitle track ".concat(n,' "').concat(s.name,'" lang:').concat(s.lang," group:").concat(i," loaded [").concat(r.startSN,"-").concat(r.endSN,"]")),n===this.trackId&&this.playlistLoaded(n,e,a)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const n=e.subtitleGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some(t=>-1===(null==i?void 0:i.indexOf(t)))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const t=this.tracks.filter(t=>!n||-1!==n.indexOf(t.groupId));if(t.length)this.selectDefaultTrack&&!t.some(t=>t.default)&&(this.selectDefaultTrack=!1),t.forEach((t,e)=>{t.id=e});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=t;const e=this.hls.config.subtitlePreference;if(!r&&e){this.selectDefaultTrack=!1;const n=Sd(e,t);if(n>-1)r=t[n];else{const t=Sd(e,this.tracks);r=this.tracks[t]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const s={subtitleTracks:t};this.log("Updating subtitle tracks, ".concat(t.length,' track(s) found in "').concat(null==n?void 0:n.join(","),'" group-id')),this.hls.trigger(ku.SUBTITLE_TRACKS_UPDATED,s),-1!==i&&-1===this.trackId&&this.setSubtitleTrack(i)}}findTrackId(t){const e=this.tracksInGroup,n=this.selectDefaultTrack;for(let i=0;i<e.length;i++){const r=e[i];if((!n||r.default)&&(n||t)&&(!t||Td(r,t)))return i}if(t){for(let n=0;n<e.length;n++){const i=e[n];if(Dg(t.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<e.length;n++){const i=e[n];if(Dg(t.attrs,i.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(t){if(t){const e=this.tracksInGroup;for(let n=0;n<e.length;n++){if(Pg(e[n],t))return n}}return-1}onError(t,e){!e.fatal&&e.context&&(e.context.type!==Iu||e.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(e.context.groupId)||this.checkRetry(e))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(t){this.selectDefaultTrack=!1,this.setSubtitleTrack(t)}setSubtitleOption(t){if(this.hls.config.subtitlePreference=t,t){if(-1===t.id)return this.setSubtitleTrack(-1),null;const e=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,e.length){const n=this.currentTrack;if(n&&Td(t,n))return n;const i=Sd(t,this.tracksInGroup);if(i>-1){const t=this.tracksInGroup[i];return this.setSubtitleTrack(i),t}if(n)return null;{const n=Sd(t,e);if(n>-1)return e[n]}}}return null}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const n=t.id,i=t.groupId,r=this.getUrlWithDirectives(t.url,e),s=t.details,a=null==s?void 0:s.age;this.log("Loading subtitle ".concat(n,' "').concat(t.name,'" lang:').concat(t.lang," group:").concat(i).concat(void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:"").concat(a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""," ").concat(r)),this.hls.trigger(ku.SUBTITLE_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:e||null,track:t})}toggleTrackModes(){const{media:t}=this;if(!t)return;const e=Wv(t.textTracks),n=this.currentTrack;let i;if(n&&(i=e.filter(t=>Pg(n,t))[0],i||this.warn('Unable to find subtitle TextTrack with name "'.concat(n.name,'" and language "').concat(n.lang,'"'))),[].slice.call(e).forEach(t=>{"disabled"!==t.mode&&t!==i&&(t.mode="disabled")}),i){const t=this.subtitleDisplay?"showing":"hidden";i.mode!==t&&(i.mode=t)}}setSubtitleTrack(t){const e=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=t);if(t<-1||t>=e.length||!Tu(t))return void this.warn("Invalid subtitle track id: ".concat(t));this.selectDefaultTrack=!1;const n=this.currentTrack,i=e[t]||null;if(this.trackId=t,this.currentTrack=i,this.toggleTrackModes(),!i)return void this.hls.trigger(ku.SUBTITLE_TRACK_SWITCH,{id:t});const r=!!i.details&&!i.details.live;if(t===this.trackId&&i===n&&r)return;this.log("Switching to subtitle-track ".concat(t)+(i?' "'.concat(i.name,'" lang:').concat(i.lang," group:").concat(i.groupId):""));const{id:s,groupId:a="",name:o,type:l,url:c}=i;this.hls.trigger(ku.SUBTITLE_TRACK_SWITCH,{id:s,groupId:a,name:o,type:l,url:c});const u=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(u)}},timelineController:class{constructor(t){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},t.on(ku.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.on(ku.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(ku.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(ku.FRAG_LOADING,this.onFragLoading,this),t.on(ku.FRAG_LOADED,this.onFragLoaded,this),t.on(ku.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(ku.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(ku.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(ku.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(ku.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:t}=this;t.off(ku.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.off(ku.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(ku.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(ku.FRAG_LOADING,this.onFragLoading,this),t.off(ku.FRAG_LOADED,this.onFragLoaded,this),t.off(ku.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(ku.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(ku.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(ku.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(ku.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const t=new Jy(this,"textTrack1"),e=new Jy(this,"textTrack2"),n=new Jy(this,"textTrack3"),i=new Jy(this,"textTrack4");this.cea608Parser1=new Sy(1,t,e),this.cea608Parser2=new Sy(3,n,i)}addCues(t,e,n,i,r){let s=!1;for(let a=r.length;a--;){const t=r[a],i=e_(t[0],t[1],e,n);if(i>=0&&(t[0]=Math.min(t[0],e),t[1]=Math.max(t[1],n),s=!0,i/(n-e)>.5))return}if(s||r.push([e,n]),this.config.renderTextTracksNatively){const r=this.captionsTracks[t];this.Cues.newCue(r,e,n,i)}else{const r=this.Cues.newCue(null,e,n,i);this.hls.trigger(ku.CUES_PARSED,{type:"captions",cues:r,track:t})}}onInitPtsFound(t,e){let{frag:n,id:i,initPTS:r,timescale:s,trackId:a}=e;const{unparsedVttFrags:o}=this;i===Ou&&(this.initPTS[n.cc]={baseTime:r,timescale:s,trackId:a}),o.length&&(this.unparsedVttFrags=[],o.forEach(t=>{this.initPTS[t.frag.cc]?this.onFragLoaded(ku.FRAG_LOADED,t):this.hls.trigger(ku.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(t,e){const{media:n}=this;if(n)for(let i=0;i<n.textTracks.length;i++){const r=n.textTracks[i];if(t_(r,{name:t,lang:e,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return r}return null}createCaptionsTrack(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)}createNativeTrack(t){if(this.captionsTracks[t])return;const{captionsProperties:e,captionsTracks:n,media:i}=this,{label:r,languageCode:s}=e[t],a=this.getExistingTrack(r,s);if(a)n[t]=a,Gv(n[t]),Hv(n[t],i);else{const e=this.createTextTrack("captions",r,s);e&&(e[t]=!0,n[t]=e)}}createNonNativeTrack(t){if(this.nonNativeCaptionsTracks[t])return;const e=this.captionsProperties[t];if(!e)return;const n={_id:t,label:e.label,kind:"captions",default:!!e.media&&!!e.media.default,closedCaptions:e.media};this.nonNativeCaptionsTracks[t]=n,this.hls.trigger(ku.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}createTextTrack(t,e,n){const i=this.media;if(i)return i.addTextTrack(t,e,n)}onMediaAttaching(t,e){this.media=e.media,e.mediaSource||this._cleanTracks()}onMediaDetaching(t,e){const n=!!e.transferMedia;if(this.media=null,n)return;const{captionsTracks:i}=this;Object.keys(i).forEach(t=>{Gv(i[t]),delete i[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:t}=this;if(!t)return;const e=t.textTracks;if(e)for(let n=0;n<e.length;n++)Gv(e[n])}onSubtitleTracksUpdated(t,e){const n=e.subtitleTracks||[],i=n.some(t=>t.textCodec===Hy);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(Lg(this.tracks,n))return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const t=this.media,e=t?Wv(t.textTracks):null;if(this.tracks.forEach((t,n)=>{let i;if(e){let n=null;for(let i=0;i<e.length;i++)if(e[i]&&t_(e[i],t)){n=e[i],e[i]=null;break}n&&(i=n)}if(i)Gv(i);else{const e=$y(t);i=this.createTextTrack(e,t.name,t.lang),i&&(i.mode="disabled")}i&&this.textTracks.push(i)}),null!=e&&e.length){const t=e.filter(t=>null!==t).map(t=>t.label);t.length&&this.hls.logger.warn("Media element contains unused subtitle tracks: ".concat(t.join(", "),". Replace media element for each source to clear TextTracks and captions menu."))}}else if(this.tracks.length){const t=this.tracks.map(t=>({label:t.name,kind:t.type.toLowerCase(),default:t.default,subtitleTrack:t}));this.hls.trigger(ku.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:t})}}}onManifestLoaded(t,e){this.config.enableCEA708Captions&&e.captions&&e.captions.forEach(t=>{const e=/(?:CC|SERVICE)([1-4])/.exec(t.instreamId);if(!e)return;const n="textTrack".concat(e[1]),i=this.captionsProperties[n];i&&(i.label=t.name,t.lang&&(i.languageCode=t.lang),i.media=t)})}closedCaptionsForLevel(t){const e=this.hls.levels[t.level];return null==e?void 0:e.attrs["CLOSED-CAPTIONS"]}onFragLoading(t,e){if(this.enabled&&e.frag.type===Ou){var n,i;const{cea608Parser1:t,cea608Parser2:r,lastSn:s}=this,{cc:a,sn:o}=e.frag,l=null!=(n=null==(i=e.part)?void 0:i.index)?n:-1;t&&r&&(o!==s+1||o===s&&l!==this.lastPartIndex+1||a!==this.lastCc)&&(t.reset(),r.reset()),this.lastCc=a,this.lastSn=o,this.lastPartIndex=l}}onFragLoaded(t,e){const{frag:n,payload:i}=e;if(n.type===Fu)if(i.byteLength){const t=n.decryptdata,r="stats"in e;if(null==t||!t.encrypted||r){const t=this.tracks[n.level],r=this.vttCCs;r[n.cc]||(r[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),t&&t.textCodec===Hy?this._parseIMSC1(n,i):this._parseVTTs(e)}}else this.hls.trigger(ku.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(t,e){const n=this.hls;Wy(e,this.initPTS[t.cc],e=>{this._appendCues(e,t.level),n.trigger(ku.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},e=>{n.logger.log("Failed to parse IMSC1: ".concat(e)),n.trigger(ku.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:e})})}_parseVTTs(t){var e;const{frag:n,payload:i}=t,{initPTS:r,unparsedVttFrags:s}=this,a=r.length-1;if(!r[n.cc]&&-1===a)return void s.push(t);const o=this.hls;zy(null!=(e=n.initSegment)&&e.data?Ph(n.initSegment.data,new Uint8Array(i)).buffer:i,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,t=>{this._appendCues(t,n.level),o.trigger(ku.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},e=>{const r="Missing initPTS for VTT MPEGTS"===e.message;r?s.push(t):this._fallbackToIMSC1(n,i),o.logger.log("Failed to parse VTT cue: ".concat(e)),r&&a>n.cc||o.trigger(ku.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:e})})}_fallbackToIMSC1(t,e){const n=this.tracks[t.level];n.textCodec||Wy(e,this.initPTS[t.cc],()=>{n.textCodec=Hy,this._parseIMSC1(t,e)},()=>{n.textCodec="wvtt"})}_appendCues(t,e){const n=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[e];if(!n||"disabled"===n.mode)return;t.forEach(t=>Vv(n,t))}else{const i=this.tracks[e];if(!i)return;const r=i.default?"default":"subtitles"+e;n.trigger(ku.CUES_PARSED,{type:"subtitles",cues:t,track:r})}}onFragDecrypted(t,e){const{frag:n}=e;n.type===Fu&&this.onFragLoaded(ku.FRAG_LOADED,e)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(t,e){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:n,samples:i}=e;if(n.type!==Ou||"NONE"!==this.closedCaptionsForLevel(n))for(let r=0;r<i.length;r++){const t=i[r].bytes;if(t){this.cea608Parser1||this.initCea608Parsers();const e=this.extractCea608Data(t);this.cea608Parser1.addData(i[r].pts,e[0]),this.cea608Parser2.addData(i[r].pts,e[1])}}}onBufferFlushing(t,e){let{startOffset:n,endOffset:i,endOffsetSubtitles:r,type:s}=e;const{media:a}=this;if(a&&!(a.currentTime<i)){if(!s||"video"===s){const{captionsTracks:t}=this;Object.keys(t).forEach(e=>jv(t[e],n,i))}if(this.config.renderTextTracksNatively&&0===n&&void 0!==r){const{textTracks:t}=this;Object.keys(t).forEach(e=>jv(t[e],n,r))}}}extractCea608Data(t){const e=[[],[]],n=31&t[0];let i=2;for(let r=0;r<n;r++){const n=t[i++],r=127&t[i++],s=127&t[i++];if(0===r&&0===s)continue;if(0!==(4&n)){const t=3&n;0!==t&&1!==t||(e[t].push(r),e[t].push(s))}}return e}},audioStreamController:class extends Jp{constructor(t,e,n){super(t,e,n,"audio-stream-controller",Nu),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(ku.LEVEL_LOADED,this.onLevelLoaded,this),t.on(ku.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(ku.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(ku.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(ku.BUFFER_RESET,this.onBufferReset,this),t.on(ku.BUFFER_CREATED,this.onBufferCreated,this),t.on(ku.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(ku.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(ku.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(ku.FRAG_LOADING,this.onFragLoading,this),t.on(ku.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:t}=this;t&&(super.unregisterListeners(),t.off(ku.LEVEL_LOADED,this.onLevelLoaded,this),t.off(ku.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(ku.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(ku.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(ku.BUFFER_RESET,this.onBufferReset,this),t.off(ku.BUFFER_CREATED,this.onBufferCreated,this),t.off(ku.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(ku.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(ku.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(ku.FRAG_LOADING,this.onFragLoading,this),t.off(ku.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(t,e){let{frag:n,id:i,initPTS:r,timescale:s,trackId:a}=e;if(i===Ou){const t=n.cc,e=this.fragCurrent;if(this.initPTS[t]={baseTime:r,timescale:s,trackId:a},this.log("InitPTS for cc: ".concat(t," found from main: ").concat(r/s," (").concat(r,"/").concat(s,") trackId: ").concat(a)),this.mainAnchor=n,this.state===Qp){const e=this.waitingData;(!e&&!this.loadingParts||e&&e.frag.cc!==t)&&this.syncWithAnchor(n,null==e?void 0:e.frag)}else!this.hls.hasEnoughToStart&&e&&e.cc!==t?(e.abortRequests(),this.syncWithAnchor(n,e)):this.state===Hp&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(t,e){var n;const i=(null==(n=this.mainFragLoading)?void 0:n.frag)||null;if(e&&(null==i?void 0:i.cc)===e.cc)return;const r=(i||t).cc,s=Pd(this.getLevelDetails(),r,this.getLoadPosition());s&&(this.log("Syncing with main frag at ".concat(s.start," cc ").concat(s.cc)),this.startFragRequested=!1,this.nextLoadPosition=s.start,this.resetLoadingState(),this.state===Hp&&this.doTickIdle())}startLoad(t,e){if(!this.levels)return this.startPosition=t,void(this.state=zp);const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),n>0&&-1===t?(this.log("Override startPosition with lastCurrentTime @".concat(n.toFixed(3))),t=n,this.state=Hp):this.state=Wp,this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}doTick(){switch(this.state){case Hp:this.doTickIdle();break;case Wp:{const{levels:t,trackId:e}=this,n=null==t?void 0:t[e],i=null==n?void 0:n.details;if(i&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(i))break;this.state=Qp}break}case jp:this.checkRetryDate();break;case Qp:{const t=this.waitingData;if(t){const{frag:e,part:n,cache:i,complete:r}=t,s=this.mainAnchor;if(void 0!==this.initPTS[e.cc]){this.waitingData=null,this.state=Gp;const t={frag:e,part:n,payload:i.flush().buffer,networkDetails:null};this._handleFragmentLoadProgress(t),r&&super._handleFragmentLoadComplete(t)}else s&&s.cc!==t.frag.cc&&this.syncWithAnchor(s,t.frag)}else this.state=Hp}}this.onTickEnd()}resetLoadingState(){const t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:t}=this;null!=t&&t.readyState&&(this.lastCurrentTime=t.currentTime)}doTickIdle(){var t;const{hls:e,levels:n,media:i,trackId:r}=this,s=e.config;if(!this.buffering||!i&&!this.primaryPrefetch&&(this.startFragRequested||!s.startFragPrefetch)||null==n||!n[r])return;const a=n[r],o=a.details;if(!o||this.waitForLive(a)||this.waitForCdnTuneIn(o))return this.state=Wp,void(this.startFragRequested=!1);const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,oh,Nu));const c=this.getFwdBufferInfo(l,Nu);if(null===c)return;if(!this.switchingTrack&&this._streamEnded(c,o))return e.trigger(ku.BUFFER_EOS,{type:"audio"}),void(this.state=Kp);const u=c.len,h=e.maxBufferLength,d=o.fragments,f=d[0].start,p=this.getLoadPosition(),m=this.flushing?p:c.end;if(this.switchingTrack&&i){const t=p;o.PTSKnown&&t<f&&(c.end>f||c.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=f+.05)}if(u>=h&&!this.switchingTrack&&m<d[d.length-1].start)return;let g=this.getNextFragment(m,o);if(g&&this.isLoopLoading(g,m)&&(g=this.getNextFragmentLoopLoading(g,o,c,Ou,h)),!g)return void(this.bufferFlushed=!0);let v=(null==(t=this.mainFragLoading)?void 0:t.frag)||null;if(!this.audioOnly&&this.startFragRequested&&v&&hh(g)&&!g.endList&&(!o.live||!this.loadingParts&&m<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(v)===tf&&(this.mainFragLoading=v=null),v&&hh(v))){if(g.start>v.end){const t=this.fragmentTracker.getFragAtPos(m,Ou);t&&t.end>v.end&&(v=t,this.mainFragLoading={frag:t,targetBufferTime:null})}if(g.start>v.end)return}this.loadFragment(g,a,m)}onMediaDetaching(t,e){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(t,e)}onAudioTracksUpdated(t,e){let{audioTracks:n}=e;this.resetTransmuxer(),this.levels=n.map(t=>new vd(t))}onAudioTrackSwitching(t,e){const n=!!e.url;this.trackId=e.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?(this.switchingTrack=e,this.flushAudioIfNeeded(e),this.state!==zp&&(this.setInterval(100),this.state=Hp,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=e,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(t,e){this.mainDetails=e.details;const n=this.cachedTrackLoadedData;n&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(ku.AUDIO_TRACK_LOADED,n))}onAudioTrackLoaded(t,e){var n;const{levels:i}=this,{details:r,id:s,groupId:a,track:o}=e;if(!i)return void this.warn("Audio tracks reset while loading track ".concat(s,' "').concat(o.name,'" of "').concat(a,'"'));const l=this.mainDetails;if(!l||r.endCC>l.endCC||l.expired)return this.cachedTrackLoadedData=e,void(this.state!==zp&&(this.state=Wp));this.cachedTrackLoadedData=null,this.log("Audio track ".concat(s,' "').concat(o.name,'" of "').concat(a,'" loaded [').concat(r.startSN,",").concat(r.endSN,"]").concat(r.lastPartSn?"[part-".concat(r.lastPartSn,"-").concat(r.lastPartIndex,"]"):"",",duration:").concat(r.totalduration));const c=i[s];let u=0;if(r.live||null!=(n=c.details)&&n.live){if(this.checkLiveUpdate(r),r.deltaUpdateFailed)return;var h;if(c.details)u=this.alignPlaylists(r,c.details,null==(h=this.levelLastLoaded)?void 0:h.details);r.alignedSliding||(Op(r,l),r.alignedSliding||Np(r,l),u=r.fragmentStart)}c.details=r,this.levelLastLoaded=c,this.startFragRequested||this.setStartPosition(l,u),this.hls.trigger(ku.AUDIO_TRACK_UPDATED,{details:r,id:s,groupId:e.groupId}),this.state!==Wp||this.waitForCdnTuneIn(r)||(this.state=Hp),this.tick()}_handleFragmentLoadProgress(t){var e;const n=t.frag,{part:i,payload:r}=t,{config:s,trackId:a,levels:o}=this;if(!o)return void this.warn("Audio tracks were reset while fragment load was in progress. Fragment ".concat(n.sn," of level ").concat(n.level," will not be buffered"));const l=o[a];if(!l)return void this.warn("Audio track is undefined on fragment load progress");const c=l.details;if(!c)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(n.start);const u=s.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let h=this.transmuxer;h||(h=this.transmuxer=new Rg(this.hls,Nu,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const d=this.initPTS[n.cc],f=null==(e=n.initSegment)?void 0:e.data;if(void 0!==d){const t=!1,e=i?i.index:-1,s=-1!==e,a=new yf(n.level,n.sn,n.stats.chunkCount,r.byteLength,e,s);h.push(r,f,u,"",n,i,c.totalduration,t,a,d)}else{this.log("Unknown video PTS for cc ".concat(n.cc,", waiting for video PTS before demuxing audio frag ").concat(n.sn," of [").concat(c.startSN," ,").concat(c.endSN,"],track ").concat(a));const{cache:t}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new tm,complete:!1};t.push(new Uint8Array(r)),this.state!==zp&&(this.state=Qp)}}_handleFragmentLoadComplete(t){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(t)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(t,e){this.bufferFlushed=this.flushing=!1;const n=e.tracks.audio;n&&(this.mediaBuffer=n.buffer||null)}onFragLoading(t,e){!this.audioOnly&&e.frag.type===Ou&&hh(e.frag)&&(this.mainFragLoading=e,this.state===Hp&&this.tick())}onFragBuffered(t,e){const{frag:n,part:i}=e;if(n.type===Nu)if(this.fragContextChanged(n))this.warn("Fragment ".concat(n.sn).concat(i?" p: "+i.index:""," of level ").concat(n.level," finished buffering, but was aborted. state: ").concat(this.state,", audioSwitch: ").concat(this.switchingTrack?this.switchingTrack.name:"false"));else{if(hh(n)){this.fragPrevious=n;const t=this.switchingTrack;t&&(this.bufferedTrack=t,this.switchingTrack=null,this.hls.trigger(ku.AUDIO_TRACK_SWITCHED,Gu({},t)))}this.fragBufferedComplete(n,i),this.media&&this.tick()}else this.audioOnly||n.type!==Ou||n.elementaryStreams.video||n.elementaryStreams.audiovideo||(this.audioOnly=!0,this.mainFragLoading=null)}onError(t,e){var n;if(e.fatal)this.state=qp;else switch(e.details){case Ru.FRAG_GAP:case Ru.FRAG_PARSING_ERROR:case Ru.FRAG_DECRYPT_ERROR:case Ru.FRAG_LOAD_ERROR:case Ru.FRAG_LOAD_TIMEOUT:case Ru.KEY_LOAD_ERROR:case Ru.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Nu,e);break;case Ru.AUDIO_TRACK_LOAD_ERROR:case Ru.AUDIO_TRACK_LOAD_TIMEOUT:case Ru.LEVEL_PARSING_ERROR:e.levelRetry||this.state!==Wp||(null==(n=e.context)?void 0:n.type)!==Pu||(this.state=Hp);break;case Ru.BUFFER_ADD_CODEC_ERROR:case Ru.BUFFER_APPEND_ERROR:if("audio"!==e.parent)return;this.reduceLengthAndFlushBuffer(e)||this.resetLoadingState();break;case Ru.BUFFER_FULL_ERROR:if("audio"!==e.parent)return;this.reduceLengthAndFlushBuffer(e)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Ru.INTERNAL_EXCEPTION:this.recoverWorkerError(e)}}onBufferFlushing(t,e){let{type:n}=e;n!==lh&&(this.flushing=!0)}onBufferFlushed(t,e){let{type:n}=e;if(n!==lh){this.flushing=!1,this.bufferFlushed=!0,this.state===Kp&&(this.state=Hp);const t=this.mediaBuffer||this.media;t&&(this.afterBufferFlushed(t,n,Nu),this.tick())}}_handleTransmuxComplete(t){var e;const n="audio",{hls:i}=this,{remuxResult:r,chunkMeta:s}=t,a=this.getCurrentContext(s);if(!a)return void this.resetWhenMissingContext(s);const{frag:o,part:l,level:c}=a,{details:u}=c,{audio:h,text:d,id3:f,initSegment:p}=r;if(!this.fragContextChanged(o)&&u){if(this.state=Yp,this.switchingTrack&&h&&this.completeAudioSwitch(this.switchingTrack),null!=p&&p.tracks){const t=o.initSegment||o;if(this.unhandledEncryptionError(p,o))return;this._bufferInitSegment(c,p.tracks,t,s),i.trigger(ku.FRAG_PARSING_INIT_SEGMENT,{frag:t,id:n,tracks:p.tracks})}if(h){const{startPTS:t,endPTS:e,startDTS:n,endDTS:i}=h;l&&(l.elementaryStreams[oh]={startPTS:t,endPTS:e,startDTS:n,endDTS:i}),o.setElementaryStreamInfo(oh,t,e,n,i),this.bufferFragmentData(h,o,l,s)}if(null!=f&&null!=(e=f.samples)&&e.length){const t=Hu({id:n,frag:o,details:u},f);i.trigger(ku.FRAG_PARSING_METADATA,t)}if(d){const t=Hu({id:n,frag:o,details:u},d);i.trigger(ku.FRAG_PARSING_USERDATA,t)}}else this.fragmentTracker.removeFragment(o)}_bufferInitSegment(t,e,n,i){if(this.state!==Yp)return;if(e.video&&delete e.video,e.audiovideo&&delete e.audiovideo,!e.audio)return;const r=e.audio;r.id=Nu;const s=t.audioCodec;this.log("Init audio buffer, container:".concat(r.container,", codecs[level/parsed]=[").concat(s,"/").concat(r.codec,"]")),s&&1===s.split(",").length&&(r.levelCodec=s),this.hls.trigger(ku.BUFFER_CODECS,e);const a=r.initSegment;if(null!=a&&a.byteLength){const t={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:a};this.hls.trigger(ku.BUFFER_APPENDING,t)}this.tickImmediate()}loadFragment(t,e,n){const i=this.fragmentTracker.getState(t);var r;if(this.switchingTrack||i===Zd||i===$d)if(hh(t))if(null!=(r=e.details)&&r.live&&!this.initPTS[t.cc]){this.log("Waiting for video PTS in continuity counter ".concat(t.cc," of live stream before loading audio fragment ").concat(t.sn," of level ").concat(this.trackId)),this.state=Qp;const n=this.mainDetails;n&&n.fragmentStart!==e.details.fragmentStart&&Np(e.details,n)}else super.loadFragment(t,e,n);else this._loadInitSegment(t,e);else this.clearTrackerIfNeeded(t)}flushAudioIfNeeded(t){if(this.media&&this.bufferedTrack){const{name:e,lang:n,assocLang:i,characteristics:r,audioCodec:s,channels:a}=this.bufferedTrack;Td({name:e,lang:n,assocLang:i,characteristics:r,audioCodec:s,channels:a},t,Md)||(Cd(t.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=t)}}completeAudioSwitch(t){const{hls:e}=this;this.flushAudioIfNeeded(t),this.bufferedTrack=t,this.switchingTrack=null,e.trigger(ku.AUDIO_TRACK_SWITCHED,Gu({},t))}},audioTrackController:class extends kg{constructor(t){super(t,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:t}=this;t.on(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.on(ku.MANIFEST_PARSED,this.onManifestParsed,this),t.on(ku.LEVEL_LOADING,this.onLevelLoading,this),t.on(ku.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(ku.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(ku.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.off(ku.MANIFEST_PARSED,this.onManifestParsed,this),t.off(ku.LEVEL_LOADING,this.onLevelLoading,this),t.off(ku.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(ku.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(ku.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.audioTracks||[]}onAudioTrackLoaded(t,e){const{id:n,groupId:i,details:r}=e,s=this.tracksInGroup[n];if(!s||s.groupId!==i)return void this.warn("Audio track with id:".concat(n," and group:").concat(i," not found in active group ").concat(null==s?void 0:s.groupId));const a=s.details;s.details=e.details,this.log("Audio track ".concat(n,' "').concat(s.name,'" lang:').concat(s.lang," group:").concat(i," loaded [").concat(r.startSN,"-").concat(r.endSN,"]")),n===this.trackId&&this.playlistLoaded(n,e,a)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const n=e.audioGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(null==i?void 0:i.length)!==(null==n?void 0:n.length)||null!=n&&n.some(t=>-1===(null==i?void 0:i.indexOf(t)))){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const t=this.tracks.filter(t=>!n||-1!==n.indexOf(t.groupId));if(t.length)this.selectDefaultTrack&&!t.some(t=>t.default)&&(this.selectDefaultTrack=!1),t.forEach((t,e)=>{t.id=e});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=t;const e=this.hls.config.audioPreference;if(!r&&e){const n=Sd(e,t,Md);if(n>-1)r=t[n];else{const t=Sd(e,this.tracks);r=this.tracks[t]}}let i=this.findTrackId(r);-1===i&&r&&(i=this.findTrackId(null));const a={audioTracks:t};this.log("Updating audio tracks, ".concat(t.length," track(s) found in group(s): ").concat(null==n?void 0:n.join(","))),this.hls.trigger(ku.AUDIO_TRACKS_UPDATED,a);const o=this.trackId;if(-1!==i&&-1===o)this.setAudioTrack(i);else if(t.length&&-1===o){var s;const e=new Error("No audio track selected for current audio group-ID(s): ".concat(null==(s=this.groupIds)?void 0:s.join(",")," track count: ").concat(t.length));this.warn(e.message),this.hls.trigger(ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:e})}}}onError(t,e){!e.fatal&&e.context&&(e.context.type!==Pu||e.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(e.context.groupId)||this.checkRetry(e))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}setAudioOption(t){const e=this.hls;if(e.config.audioPreference=t,t){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&Td(t,i,Md))return i;const r=Sd(t,this.tracksInGroup,Md);if(r>-1){const t=this.tracksInGroup[r];return this.setAudioTrack(r),t}if(i){let i=e.loadLevel;-1===i&&(i=e.firstAutoLevel);const r=function(t,e,n,i,r){const s=e[i],a=e.reduce((t,e,n)=>{const i=e.uri;return(t[i]||(t[i]=[])).push(n),t},{}),o=a[s.uri];o.length>1&&(i=Math.max.apply(Math,o));const l=s.videoRange,c=s.frameRate,u=s.codecSet.substring(0,4),h=Ad(e,i,e=>{if(e.videoRange!==l||e.frameRate!==c||e.codecSet.substring(0,4)!==u)return!1;const i=e.audioGroups,s=n.filter(t=>!i||-1!==i.indexOf(t.groupId));return Sd(t,s,r)>-1});return h>-1?h:Ad(e,i,e=>{const i=e.audioGroups,s=n.filter(t=>!i||-1!==i.indexOf(t.groupId));return Sd(t,s,r)>-1})}(t,e.levels,n,i,Md);if(-1===r)return null;e.nextLoadLevel=r}if(t.channels||t.audioCodec){const e=Sd(t,n);if(e>-1)return n[e]}}}return null}setAudioTrack(t){const e=this.tracksInGroup;if(t<0||t>=e.length)return void this.warn("Invalid audio track id: ".concat(t));this.selectDefaultTrack=!1;const n=this.currentTrack,i=e[t],r=i.details&&!i.details.live;if(t===this.trackId&&i===n&&r)return;if(this.log("Switching to audio-track ".concat(t,' "').concat(i.name,'" lang:').concat(i.lang," group:").concat(i.groupId," channels:").concat(i.channels)),this.trackId=t,this.currentTrack=i,this.hls.trigger(ku.AUDIO_TRACK_SWITCHING,Gu({},i)),r)return;const s=this.switchParams(i.url,null==n?void 0:n.details,i.details);this.loadPlaylist(s)}findTrackId(t){const e=this.tracksInGroup;for(let n=0;n<e.length;n++){const i=e[n];if((!this.selectDefaultTrack||i.default)&&(!t||Td(t,i,Md)))return n}if(t){const{name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o}=t;for(let t=0;t<e.length;t++){if(Td({name:n,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o},e[t],Md))return t}for(let l=0;l<e.length;l++){const n=e[l];if(Dg(t.attrs,n.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return l}for(let l=0;l<e.length;l++){const n=e[l];if(Dg(t.attrs,n.attrs,["LANGUAGE"]))return l}}return-1}loadPlaylist(t){super.loadPlaylist();const e=this.currentTrack;this.shouldLoadPlaylist(e)&&Cd(e.url,this.hls)&&this.scheduleLoading(e,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const n=t.id,i=t.groupId,r=this.getUrlWithDirectives(t.url,e),s=t.details,a=null==s?void 0:s.age;this.log("Loading audio-track ".concat(n,' "').concat(t.name,'" lang:').concat(t.lang," group:").concat(i).concat(void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:"").concat(a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""," ").concat(r)),this.hls.trigger(ku.AUDIO_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:e||null,track:t})}},emeController:Nv,cmcdController:class{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=t=>{try{this.apply(t,{ot:Hg.MANIFEST,su:!this.initialized})}catch(CO){this.hls.logger.warn("Could not generate manifest CMCD data.",CO)}},this.applyFragmentData=t=>{try{const{frag:e,part:n}=t,i=this.hls.levels[e.level],r=this.getObjectType(e),s={d:1e3*(n||e).duration,ot:r};r!==Hg.VIDEO&&r!==Hg.AUDIO&&r!=Hg.MUXED||(s.br=i.bitrate/1e3,s.tb=this.getTopBandwidth(r)/1e3,s.bl=this.getBufferLength(r));const a=n?this.getNextPart(n):this.getNextFrag(e);null!=a&&a.url&&a.url!==e.url&&(s.nor=a.url),this.apply(t,s)}catch(CO){this.hls.logger.warn("Could not generate segment CMCD data.",CO)}},this.hls=t;const e=this.config=t.config,{cmcd:n}=e;null!=n&&(e.pLoader=this.createPlaylistLoader(),e.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||t.sessionId,this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const t=this.hls;t.on(ku.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(ku.MEDIA_DETACHED,this.onMediaDetached,this),t.on(ku.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const t=this.hls;t.off(ku.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(ku.MEDIA_DETACHED,this.onMediaDetached,this),t.off(ku.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(t,e){var n,i;this.audioBuffer=null==(n=e.tracks.audio)?void 0:n.buffer,this.videoBuffer=null==(i=e.tracks.video)?void 0:i.buffer}createData(){var t;return{v:1,sf:Vg.HLS,sid:this.sid,cid:this.cid,pr:null==(t=this.media)?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Hu(e,this.createData());const n=e.ot===Hg.INIT||e.ot===Hg.VIDEO||e.ot===Hg.MUXED;this.starved&&n&&(e.bs=!0,e.su=!0,this.starved=!1),null==e.su&&(e.su=this.buffering);const{includeKeys:i}=this;i&&(e=Object.keys(e).reduce((t,n)=>(i.includes(n)&&(t[n]=e[n]),t),{}));const r={baseUrl:t.url};this.useHeaders?(t.headers||(t.headers={}),kv(t.headers,e,r)):t.url=Pv(t.url,e,r)}getNextFrag(t){var e;const n=null==(e=this.hls.levels[t.level])?void 0:e.details;if(n){const e=t.sn-n.startSN;return n.fragments[e+1]}}getNextPart(t){var e;const{index:n,fragment:i}=t,r=null==(e=this.hls.levels[i.level])||null==(e=e.details)?void 0:e.partList;if(r){const{sn:t}=i;for(let e=r.length-1;e>=0;e--){const i=r[e];if(i.index===n&&i.fragment.sn===t)return r[e+1]}}}getObjectType(t){const{type:e}=t;return"subtitle"===e?Hg.TIMED_TEXT:"initSegment"===t.sn?Hg.INIT:"audio"===e?Hg.AUDIO:"main"===e?this.hls.audioTracks.length?Hg.VIDEO:Hg.MUXED:void 0}getTopBandwidth(t){let e,n=0;const i=this.hls;if(t===Hg.AUDIO)e=i.audioTracks;else{const t=i.maxAutoLevel,n=t>-1?t+1:i.levels.length;e=i.levels.slice(0,n)}return e.forEach(t=>{t.bitrate>n&&(n=t.bitrate)}),n>0?n:NaN}getBufferLength(t){const e=this.media,n=t===Hg.AUDIO?this.audioBuffer:this.videoBuffer;if(!n||!e)return NaN;return 1e3*bf.bufferInfo(n,e.currentTime,this.config.maxBufferHole).len}createPlaylistLoader(){const{pLoader:t}=this.config,e=this.applyPlaylistData,n=t||this.config.loader;return class{constructor(t){this.loader=void 0,this.loader=new n(t)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(t,n,i){e(t),this.loader.load(t,n,i)}}}createFragmentLoader(){const{fLoader:t}=this.config,e=this.applyFragmentData,n=t||this.config.loader;return class{constructor(t){this.loader=void 0,this.loader=new n(t)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(t,n,i){e(t),this.loader.load(t,n,i)}}}},contentSteeringController:class extends ju{constructor(t){super("content-steering",t.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.registerListeners()}registerListeners(){const t=this.hls;t.on(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.on(ku.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(ku.MANIFEST_PARSED,this.onManifestParsed,this),t.on(ku.ERROR,this.onError,this)}unregisterListeners(){const t=this.hls;t&&(t.off(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.off(ku.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(ku.MANIFEST_PARSED,this.onManifestParsed,this),t.off(ku.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((t,e)=>(-1===t.indexOf(e.pathwayId)&&t.push(e.pathwayId),t),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(t){this.updatePathwayPriority(t)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const t=1e3*this.timeToLoad-(performance.now()-this.updated);if(t>0)return void this.scheduleRefresh(this.uri,t)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(t){const e=this.levels;e&&(this.levels=e.filter(e=>e!==t))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(t,e){const{contentSteering:n}=e;null!==n&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(t,e){this.audioTracks=e.audioTracks,this.subtitleTracks=e.subtitleTracks}onError(t,e){const{errorAction:n}=e;if((null==n?void 0:n.action)===Gd&&n.flags===Xd){const t=this.levels;let i=this._pathwayPriority,r=this.pathwayId;if(e.context){const{groupId:n,pathwayId:i,type:s}=e.context;n&&t?r=this.getPathwayForGroupId(n,s,r):i&&(r=i)}r in this.penalizedPathways||(this.penalizedPathways[r]=performance.now()),!i&&t&&(i=this.pathways()),i&&i.length>1&&(this.updatePathwayPriority(i),n.resolved=this.pathwayId!==r),e.details!==Ru.BUFFER_APPEND_ERROR||e.fatal?n.resolved||this.warn("Could not resolve ".concat(e.details,' ("').concat(e.error.message,'") with content-steering for Pathway: ').concat(r," levels: ").concat(t?t.length:t," priorities: ").concat(bd(i)," penalized: ").concat(bd(this.penalizedPathways))):n.resolved=!0}}filterParsedLevels(t){this.levels=t;let e=this.getLevelsForPathway(this.pathwayId);if(0===e.length){const n=t[0].pathwayId;this.log("No levels found in Pathway ".concat(this.pathwayId,'. Setting initial Pathway to "').concat(n,'"')),e=this.getLevelsForPathway(n),this.pathwayId=n}return e.length!==t.length&&this.log("Found ".concat(e.length,"/").concat(t.length,' levels in Pathway "').concat(this.pathwayId,'"')),e}getLevelsForPathway(t){return null===this.levels?[]:this.levels.filter(e=>t===e.pathwayId)}updatePathwayPriority(t){let e;this._pathwayPriority=t;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach(t=>{i-n[t]>3e5&&delete n[t]});for(let r=0;r<t.length;r++){const i=t[r];if(i in n)continue;if(i===this.pathwayId)return;const s=this.hls.nextLoadLevel,a=this.hls.levels[s];if(e=this.getLevelsForPathway(i),e.length>0){this.log('Setting Pathway to "'.concat(i,'"')),this.pathwayId=i,Rp(e),this.hls.trigger(ku.LEVELS_UPDATED,{levels:e});const t=this.hls.levels[s];a&&t&&this.levels&&(t.attrs["STABLE-VARIANT-ID"]!==a.attrs["STABLE-VARIANT-ID"]&&t.bitrate!==a.bitrate&&this.log("Unstable Pathways change from bitrate ".concat(a.bitrate," to ").concat(t.bitrate)),this.hls.nextLoadLevel=s);break}}}getPathwayForGroupId(t,e,n){const i=this.getLevelsForPathway(n).concat(this.levels||[]);for(let r=0;r<i.length;r++)if(e===Pu&&i[r].hasAudioGroup(t)||e===Iu&&i[r].hasSubtitleGroup(t))return i[r].pathwayId;return n}clonePathways(t){const e=this.levels;if(!e)return;const n={},i={};t.forEach(t=>{const{ID:r,"BASE-ID":s,"URI-REPLACEMENT":a}=t;if(e.some(t=>t.pathwayId===r))return;const o=this.getLevelsForPathway(s).map(t=>{const e=new Cf(t.attrs);e["PATHWAY-ID"]=r;const s=e.AUDIO&&"".concat(e.AUDIO,"_clone_").concat(r),o=e.SUBTITLES&&"".concat(e.SUBTITLES,"_clone_").concat(r);s&&(n[e.AUDIO]=s,e.AUDIO=s),o&&(i[e.SUBTITLES]=o,e.SUBTITLES=o);const l=Ov(t.uri,e["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",a),c=new vd({attrs:e,audioCodec:t.audioCodec,bitrate:t.bitrate,height:t.height,name:t.name,url:l,videoCodec:t.videoCodec,width:t.width});if(t.audioGroups)for(let n=1;n<t.audioGroups.length;n++)c.addGroupId("audio","".concat(t.audioGroups[n],"_clone_").concat(r));if(t.subtitleGroups)for(let n=1;n<t.subtitleGroups.length;n++)c.addGroupId("text","".concat(t.subtitleGroups[n],"_clone_").concat(r));return c});e.push(...o),Iv(this.audioTracks,n,a,r),Iv(this.subtitleTracks,i,a,r)})}loadSteeringManifest(t){const e=this.hls.config,n=e.loader;let i;this.loader&&this.loader.destroy(),this.loader=new n(e);try{i=new self.URL(t)}catch(CO){return this.enabled=!1,void this.log("Failed to parse Steering Manifest URI: ".concat(t))}if("data:"!==i.protocol){const t=0|(this.hls.bandwidthEstimate||e.abrEwmaDefaultEstimate);i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+t)}const r={responseType:"json",url:i.href},s=e.steeringManifestLoadPolicy.default,a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(t,e,n,r)=>{this.log('Loaded steering manifest: "'.concat(i,'"'));const s=t.data;if(1!==(null==s?void 0:s.VERSION))return void this.log("Steering VERSION ".concat(s.VERSION," not supported!"));this.updated=performance.now(),this.timeToLoad=s.TTL;const{"RELOAD-URI":a,"PATHWAY-CLONES":o,"PATHWAY-PRIORITY":l}=s;if(a)try{this.uri=new self.URL(a,i).href}catch(CO){return this.enabled=!1,void this.log("Failed to parse Steering Manifest RELOAD-URI: ".concat(a))}this.scheduleRefresh(this.uri||n.url),o&&this.clonePathways(o);const c={steeringManifest:s,url:i.toString()};this.hls.trigger(ku.STEERING_MANIFEST_LOADED,c),l&&this.updatePathwayPriority(l)},onError:(t,e,n,i)=>{if(this.log("Error loading steering manifest: ".concat(t.code," ").concat(t.text," (").concat(e.url,")")),this.stopLoad(),410===t.code)return this.enabled=!1,void this.log("Steering manifest ".concat(e.url," no longer available"));let r=1e3*this.timeToLoad;if(429===t.code){const t=this.loader;if("function"===typeof(null==t?void 0:t.getResponseHeader)){const e=t.getResponseHeader("Retry-After");e&&(r=1e3*parseFloat(e))}return void this.log("Steering manifest ".concat(e.url," rate limited"))}this.scheduleRefresh(this.uri||e.url,r)},onTimeout:(t,e,n)=>{this.log("Timeout loading steering manifest (".concat(e.url,")")),this.scheduleRefresh(this.uri||e.url)}};this.log("Requesting steering manifest: ".concat(i)),this.loader.load(r,o,l)}scheduleRefresh(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3*this.timeToLoad;this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var e;const n=null==(e=this.hls)?void 0:e.media;!n||n.ended?this.scheduleRefresh(t,1e3*this.timeToLoad):this.loadSteeringManifest(t)},e)}},interstitialsController:class extends ju{constructor(t,e){super("interstitials",t.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const t=this.currentTime;if(void 0===t||this.playbackDisabled||!this.schedule)return;const e=t-this.timelinePos;if(Math.abs(e)<1/7056e5)return;const n=e<=-.01;this.timelinePos=t,this.bufferedPos=t;const i=this.playingItem;if(!i)return void this.checkBuffer();if(n){this.schedule.resetErrorsInRange(t,t-e)&&this.updateSchedule(!0)}if(this.checkBuffer(),n&&t<i.start||t>=i.end){var r;const e=this.findItemIndex(i);let s=this.schedule.findItemIndexAtTime(t);if(-1===s&&(s=e+(n?-1:1),this.log("seeked ".concat(n?"back ":"","to position not covered by schedule ").concat(t," (resolving from ").concat(e," to ").concat(s,")"))),!this.isInterstitial(i)&&null!=(r=this.media)&&r.paused&&(this.shouldPlay=!1),!n&&s>e){const t=this.schedule.findJumpRestrictedIndex(e+1,s);if(t>e)return void this.setSchedulePosition(t)}return void this.setSchedulePosition(s)}const s=this.playingAsset;if(!s){if(this.playingLastItem&&this.isInterstitial(i)){const e=i.event.assetList[0];e&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(t,e))}return}const a=s.timelineStart,o=s.duration||0;var l;(n&&t<a||t>=a+o)&&(null!=(l=i.event)&&l.appendInPlace&&(this.clearAssetPlayers(i.event,i),this.flushFrontBuffer(t)),this.setScheduleToAssetAtTime(t,s))},this.onTimeupdate=()=>{const t=this.currentTime;if(void 0===t||this.playbackDisabled)return;if(!(t>this.timelinePos))return;this.timelinePos=t,t>this.bufferedPos&&this.checkBuffer();const e=this.playingItem;if(!e||this.playingLastItem)return;if(t>=e.end){this.timelinePos=e.end;const t=this.findItemIndex(e);this.setSchedulePosition(t+1)}const n=this.playingAsset;if(!n)return;t>=n.timelineStart+(n.duration||0)&&this.setScheduleToAssetAtTime(t,n)},this.onScheduleUpdate=(t,e)=>{const n=this.schedule;if(!n)return;const i=this.playingItem,r=n.events||[],s=n.items||[],a=n.durations,o=t.map(t=>t.identifier),l=!(!r.length&&!o.length);(l||e)&&this.log("INTERSTITIALS_UPDATED (".concat(r.length,"): ").concat(r,"\nSchedule: ").concat(s.map(t=>iy(t))," pos: ").concat(this.timelinePos)),o.length&&this.log("Removed events ".concat(o));let c=null,u=null;i&&(c=this.updateItem(i,this.timelinePos),this.itemsMatch(i,c)?this.playingItem=c:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const h=this.bufferingItem;if(h&&(u=this.updateItem(h,this.bufferedPos),this.itemsMatch(h,u)?this.bufferingItem=u:h.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(h.event,null))),t.forEach(t=>{t.assetList.forEach(t=>{this.clearAssetPlayer(t.identifier,null)})}),this.playerQueue.forEach(t=>{if(t.interstitial.appendInPlace){const e=t.assetItem.timelineStart,n=t.timelineOffset-e;if(n)try{t.timelineOffset=e}catch(Wq){Math.abs(n)>Xv&&this.warn("".concat(Wq,' ("').concat(t.assetId,'" ').concat(t.timelineOffset,"->").concat(e,")"))}}}),l||e){if(this.hls.trigger(ku.INTERSTITIALS_UPDATED,{events:r.slice(0),schedule:s.slice(0),durations:a,removedIds:o}),this.isInterstitial(i)&&o.includes(i.event.identifier))return this.warn('Interstitial "'.concat(i.event.identifier,'" removed while playing')),void this.primaryFallback(i.event);i&&this.trimInPlace(c,i),h&&u!==c&&this.trimInPlace(u,h),this.checkBuffer()}},this.hls=t,this.HlsPlayerClass=e,this.assetListLoader=new ry(t),this.schedule=new ny(this.onScheduleUpdate,t.logger),this.registerListeners()}registerListeners(){const t=this.hls;t&&(t.on(ku.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(ku.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.on(ku.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(ku.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(ku.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.on(ku.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(ku.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.on(ku.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.on(ku.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.on(ku.BUFFER_APPENDED,this.onBufferAppended,this),t.on(ku.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(ku.BUFFERED_TO_END,this.onBufferedToEnd,this),t.on(ku.MEDIA_ENDED,this.onMediaEnded,this),t.on(ku.ERROR,this.onError,this),t.on(ku.DESTROYING,this.onDestroying,this))}unregisterListeners(){const t=this.hls;t&&(t.off(ku.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(ku.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.off(ku.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(ku.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(ku.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.off(ku.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(ku.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.off(ku.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.off(ku.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.off(ku.BUFFER_CODECS,this.onBufferCodecs,this),t.off(ku.BUFFER_APPENDED,this.onBufferAppended,this),t.off(ku.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(ku.BUFFERED_TO_END,this.onBufferedToEnd,this),t.off(ku.MEDIA_ENDED,this.onMediaEnded,this),t.off(ku.ERROR,this.onError,this),t.off(ku.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var t;null==(t=this.getBufferingPlayer())||t.resumeBuffering()}pauseBuffering(){var t;null==(t=this.getBufferingPlayer())||t.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const t=this.primaryMedia||this.media;t&&this.removeMediaListeners(t)}removeMediaListeners(t){Up(t,"play",this.onPlay),Up(t,"pause",this.onPause),Up(t,"seeking",this.onSeeking),Up(t,"timeupdate",this.onTimeupdate)}onMediaAttaching(t,e){const n=this.media=e.media;Fp(n,"seeking",this.onSeeking),Fp(n,"timeupdate",this.onTimeupdate),Fp(n,"play",this.onPlay),Fp(n,"pause",this.onPause)}onMediaAttached(t,e){const n=this.effectivePlayingItem,i=this.detachedData;if(this.detachedData=null,null===n)this.checkStart();else if(!i){this.clearScheduleState();const t=this.findItemIndex(n);this.setSchedulePosition(t)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(t,e){const n=!!e.transferMedia,i=this.media;if(this.media=null,!n&&(i&&this.removeMediaListeners(i),this.detachedData)){const t=this.getBufferingPlayer();t&&(this.log("Removing schedule state for detachedData and ".concat(t)),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,t.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const t=this,e=()=>t.bufferingItem||t.waitingItem,n=e=>e?t.getAssetPlayer(e.identifier):e,i=(e,i,s,a,o)=>{if(e){let l=e[i].start;const c=e.event;if(c){if("playout"===i||c.timelineOccupancy!==Kv.Point){const t=n(s);(null==t?void 0:t.interstitial)===c&&(l+=t.assetItem.startOffset+t[o])}}else{l+=("bufferedPos"===a?r():t[a])-e.start}return l}return 0},r=()=>{const e=t.bufferedPos;return e===Number.MAX_VALUE?s("primary"):Math.max(e,0)},s=e=>{var n,i;return null!=(n=t.primaryDetails)&&n.live?t.primaryDetails.edge:(null==(i=t.schedule)?void 0:i.durations[e])||0},a=(e,r)=>{var s,a;const o=t.effectivePlayingItem;if(null!=o&&null!=(s=o.event)&&s.restrictions.skip||!t.schedule)return;t.log("seek to ".concat(e,' "').concat(r,'"'));const l=t.effectivePlayingItem,c=t.schedule.findItemIndexAtTime(e,r),u=null==(a=t.schedule.items)?void 0:a[c],h=t.getBufferingPlayer(),d=null==h?void 0:h.interstitial,f=null==d?void 0:d.appendInPlace,p=l&&t.itemsMatch(l,u);if(l&&(f||p)){const s=n(t.playingAsset),a=(null==s?void 0:s.media)||t.primaryMedia;if(a){const n="primary"===r?a.currentTime:i(l,r,t.playingAsset,"timelinePos","currentTime"),o=e-n,c=(f?n:a.currentTime)+o;if(c>=0&&(!s||f||c<=s.duration))return void(a.currentTime=c)}}if(u){let n=e;if("primary"!==r){const t=e-u[r].start;n=u.start+t}const i=!t.isInterstitial(u);if(t.isInterstitial(l)&&!l.event.appendInPlace||!i&&!u.event.appendInPlace){if(l){const s=t.findItemIndex(l);if(c>s){const e=t.schedule.findJumpRestrictedIndex(s+1,c);if(e>s)return void t.setSchedulePosition(e)}let a=0;if(i)t.timelinePos=n,t.checkBuffer();else{const t=u.event.assetList,n=e-(u[r]||u).start;for(let e=t.length;e--;){const i=t[e];if(i.duration&&n>=i.startOffset&&n<i.startOffset+i.duration){a=e;break}}}t.setSchedulePosition(c,a)}}else{const e=t.media||(f?null==h?void 0:h.media:null);e&&(e.currentTime=n)}}},o=()=>{const n=t.effectivePlayingItem;if(t.isInterstitial(n))return n;const i=e();return t.isInterstitial(i)?i:null},l={get bufferedEnd(){const n=e(),r=t.bufferingItem;var s;return r&&r===n&&(i(r,"playout",t.bufferingAsset,"bufferedPos","bufferedEnd")-r.playout.start||(null==(s=t.bufferingAsset)?void 0:s.startOffset))||0},get currentTime(){const e=o(),n=t.effectivePlayingItem;return n&&n===e?i(n,"playout",t.effectivePlayingAsset,"timelinePos","currentTime")-n.playout.start:0},set currentTime(e){const n=o(),i=t.effectivePlayingItem;i&&i===n&&a(e+i.playout.start,"playout")},get duration(){const t=o();return t?t.playout.end-t.playout.start:0},get assetPlayers(){var e;const n=null==(e=o())?void 0:e.event.assetList;return n?n.map(e=>t.getAssetPlayer(e.identifier)):[]},get playingIndex(){var e;const n=null==(e=o())?void 0:e.event;return n&&t.effectivePlayingAsset?n.findAssetIndex(t.effectivePlayingAsset):-1},get scheduleItem(){return o()}};return this.manager={get events(){var e;return(null==(e=t.schedule)||null==(e=e.events)?void 0:e.slice(0))||[]},get schedule(){var e;return(null==(e=t.schedule)||null==(e=e.items)?void 0:e.slice(0))||[]},get interstitialPlayer(){return o()?l:null},get playerQueue(){return t.playerQueue.slice(0)},get bufferingAsset(){return t.bufferingAsset},get bufferingItem(){return e()},get bufferingIndex(){const n=e();return t.findItemIndex(n)},get playingAsset(){return t.effectivePlayingAsset},get playingItem(){return t.effectivePlayingItem},get playingIndex(){const e=t.effectivePlayingItem;return t.findItemIndex(e)},primary:{get bufferedEnd(){return r()},get currentTime(){const e=t.timelinePos;return e>0?e:0},set currentTime(t){a(t,"primary")},get duration(){return s("primary")},get seekableStart(){var e;return(null==(e=t.primaryDetails)?void 0:e.fragmentStart)||0}},integrated:{get bufferedEnd(){return i(e(),"integrated",t.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return i(t.effectivePlayingItem,"integrated",t.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(t){a(t,"integrated")},get duration(){return s("integrated")},get seekableStart(){var e;return((e,n)=>{var i;if(0!==e&&"primary"!==n&&null!=(i=t.schedule)&&i.length){var r;const i=t.schedule.findItemIndexAtTime(e),s=null==(r=t.schedule.items)?void 0:r[i];if(s)return e+(s[n].start-s.start)}return e})((null==(e=t.primaryDetails)?void 0:e.fragmentStart)||0,"integrated")}},skip:()=>{const e=t.effectivePlayingItem,n=null==e?void 0:e.event;if(n&&!n.restrictions.skip){const i=t.findItemIndex(e);if(n.appendInPlace){const t=e.playout.start+e.event.duration;a(t+.001,"playout")}else t.advanceAfterAssetEnded(n,i,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var t;const e=this.playingItem,n=null==(t=this.schedule)?void 0:t.items;return!!(this.playbackStarted&&e&&n)&&this.findItemIndex(e)===n.length-1}get playbackStarted(){return null!==this.effectivePlayingItem}get currentTime(){var t,e;if(null===this.mediaSelection)return;const n=this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&!n.event.appendInPlace)return;let i=this.media;!i&&null!=(t=this.bufferingItem)&&null!=(t=t.event)&&t.appendInPlace&&(i=this.primaryMedia);const r=null==(e=i)?void 0:e.currentTime;return void 0!==r&&Tu(r)?r:void 0}get primaryMedia(){var t;return this.media||(null==(t=this.detachedData)?void 0:t.media)||null}isInterstitial(t){return!(null==t||!t.event)}retreiveMediaSource(t,e){const n=this.getAssetPlayer(t);n&&this.transferMediaFromPlayer(n,e)}transferMediaFromPlayer(t,e){const n=t.interstitial.appendInPlace,i=t.media;if(n&&i===this.primaryMedia){if(this.bufferingAsset=null,(!e||this.isInterstitial(e)&&!e.event.appendInPlace)&&e&&i)return void(this.detachedData={media:i});const n=t.transferMedia();this.log("transfer MediaSource from ".concat(t," ").concat(bd(n))),this.detachedData=n}else e&&i&&(this.shouldPlay||(this.shouldPlay=!i.paused))}transferMediaTo(t,e){var n,i;if(t.media===e)return;let r=null;const s=this.hls,a=t!==s,o=a&&t.interstitial.appendInPlace,l=null==(n=this.detachedData)?void 0:n.mediaSource;let c;if(s.media)o&&(r=s.transferMedia(),this.detachedData=r),c="Primary";else if(l){const t=this.getBufferingPlayer();t?(r=t.transferMedia(),c="".concat(t)):c="detached MediaSource"}else c="detached media";if(!r)if(l)r=this.detachedData,this.log("using detachedData: MediaSource ".concat(bd(r)));else if(!this.detachedData||s.media===e){const t=this.playerQueue;t.length>1&&t.forEach(t=>{if(a&&t.interstitial.appendInPlace!==o){const e=t.interstitial;this.clearInterstitial(t.interstitial,null),e.appendInPlace=!1,e.appendInPlace&&this.warn("Could not change append strategy for queued assets ".concat(e))}}),this.hls.detachMedia(),this.detachedData={media:e}}const u=r&&"mediaSource"in r&&"closed"!==(null==(i=r.mediaSource)?void 0:i.readyState),h=u&&r?r:e;this.log("".concat(u?"transfering MediaSource":"attaching media"," to ").concat(a?t:"Primary"," from ").concat(c," (media.currentTime: ").concat(e.currentTime,")"));const d=this.schedule;if(h===r&&d){const e=a&&t.assetId===d.assetIdAtEnd;h.overrides={duration:d.duration,endOfStream:!a||e,cueRemoval:!a}}t.attachMedia(h)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const t=this.schedule,e=null==t?void 0:t.events;if(!e||this.playbackDisabled||!this.media)return;-1===this.bufferedPos&&(this.bufferedPos=0);const n=this.timelinePos,i=this.effectivePlayingItem;if(-1===n){const n=this.hls.startPosition;if(this.log(ay("checkStart",n)),this.timelinePos=n,e.length&&e[0].cue.pre){const n=t.findEventIndex(e[0].identifier);this.setSchedulePosition(n)}else if(n>=0||!this.primaryLive){const e=this.timelinePos=n>0?n:0,i=t.findItemIndexAtTime(e);this.setSchedulePosition(i)}}else if(i&&!this.playingItem){const e=t.findItemIndex(i);this.setSchedulePosition(e)}}advanceAssetBuffering(t,e){const n=t.event,i=n.findAssetIndex(e),r=$v(n,i);if(n.isAssetPastPlayoutLimit(r)){if(this.schedule){var s;const e=null==(s=this.schedule.items)?void 0:s[this.findItemIndex(t)+1];e&&this.bufferedToItem(e)}}else this.bufferedToEvent(t,r)}advanceAfterAssetEnded(t,e,n){const i=$v(t,n);if(t.isAssetPastPlayoutLimit(i)){if(this.schedule){const n=this.schedule.items;if(n){const i=e+1;if(i>=n.length)return void this.setSchedulePosition(-1);const r=t.resumeTime;this.timelinePos<r&&(this.log(ay("advanceAfterAssetEnded",r)),this.timelinePos=r,t.appendInPlace&&this.advanceInPlace(r),this.checkBuffer(this.bufferedPos<r)),this.setSchedulePosition(i)}}}else{if(t.appendInPlace){const e=t.assetList[i];e&&this.advanceInPlace(e.timelineStart)}this.setSchedulePosition(e,i)}}setScheduleToAssetAtTime(t,e){const n=this.schedule;if(!n)return;const i=e.parentIdentifier,r=n.getEvent(i);if(r){const e=n.findEventIndex(i),s=n.findAssetIndex(r,t);this.advanceAfterAssetEnded(r,e,s-1)}}setSchedulePosition(t,e){var n;const i=null==(n=this.schedule)?void 0:n.items;if(!i||this.playbackDisabled)return;const r=t>=0?i[t]:null;this.log("setSchedulePosition ".concat(t,", ").concat(e," (").concat(r?iy(r):r,") pos: ").concat(this.timelinePos));const s=this.waitingItem||this.playingItem,a=this.playingLastItem;if(this.isInterstitial(s)){const n=s.event,c=this.playingAsset,u=null==c?void 0:c.identifier,h=u?this.getAssetPlayer(u):null;if(h&&u&&(!this.eventItemsMatch(s,r)||void 0!==e&&u!==n.assetList[e].identifier)){var o;const e=n.findAssetIndex(c);if(this.log("INTERSTITIAL_ASSET_ENDED ".concat(e+1,"/").concat(n.assetList.length," ").concat(ty(c))),this.endedAsset=c,this.playingAsset=null,this.hls.trigger(ku.INTERSTITIAL_ASSET_ENDED,{asset:c,assetListIndex:e,event:n,schedule:i.slice(0),scheduleIndex:t,player:h}),s!==this.playingItem)return void(this.itemsMatch(s,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(n,this.findItemIndex(this.playingItem),e));this.retreiveMediaSource(u,r),!h.media||null!=(o=this.detachedData)&&o.mediaSource||h.detachMedia()}if(!this.eventItemsMatch(s,r)&&(this.endedItem=s,this.playingItem=null,this.log("INTERSTITIAL_ENDED ".concat(n," ").concat(iy(s))),n.hasPlayed=!0,this.hls.trigger(ku.INTERSTITIAL_ENDED,{event:n,schedule:i.slice(0),scheduleIndex:t}),n.cue.once)){var l;this.updateSchedule();const t=null==(l=this.schedule)?void 0:l.items;if(r&&t){const n=this.findItemIndex(r);this.advanceSchedule(n,t,e,s,a)}return}}this.advanceSchedule(t,i,e,s,a)}advanceSchedule(t,e,n,i,r){const s=this.schedule;if(!s)return;const a=e[t]||null,o=this.primaryMedia,l=this.playerQueue;if(l.length&&l.forEach(e=>{const n=e.interstitial,i=s.findEventIndex(n.identifier);(i<t||i>t+1)&&this.clearInterstitial(n,a)}),this.isInterstitial(a)){this.timelinePos=Math.min(Math.max(this.timelinePos,a.start),a.end);const r=a.event;if(void 0===n){const e=$v(r,(n=s.findAssetIndex(r,this.timelinePos))-1);if(r.isAssetPastPlayoutLimit(e)||r.appendInPlace&&this.timelinePos===a.end)return void this.advanceAfterAssetEnded(r,t,n);n=e}const l=this.waitingItem;this.assetsBuffered(a,o)||this.setBufferingItem(a);let c=this.preloadAssets(r,n);if(this.eventItemsMatch(a,l||i)||(this.waitingItem=a,this.log("INTERSTITIAL_STARTED ".concat(iy(a)," ").concat(r.appendInPlace?"append in place":"")),this.hls.trigger(ku.INTERSTITIAL_STARTED,{event:r,schedule:e.slice(0),scheduleIndex:t})),!r.assetListLoaded)return void this.log("Waiting for ASSET-LIST to complete loading ".concat(r));if(r.assetListLoader&&(r.assetListLoader.destroy(),r.assetListLoader=void 0),!o)return void this.log("Waiting for attachMedia to start Interstitial ".concat(r));this.waitingItem=this.endedItem=null,this.playingItem=a;const u=r.assetList[n];if(!u)return void this.advanceAfterAssetEnded(r,t,n||0);if(c||(c=this.getAssetPlayer(u.identifier)),null===c||c.destroyed){const t=r.assetList.length;this.warn("asset ".concat(n+1,"/").concat(t," player destroyed ").concat(r)),c=this.createAssetPlayer(r,u,n),c.loadSource()}if(!this.eventItemsMatch(a,this.bufferingItem)&&r.appendInPlace&&this.isAssetBuffered(u))return;this.startAssetPlayer(c,n,e,t,o),this.shouldPlay&&sy(c.media)}else a?(this.resumePrimary(a,t,i),this.shouldPlay&&sy(this.hls.media)):r&&this.isInterstitial(i)&&(this.endedItem=null,this.playingItem=i,i.event.appendInPlace||this.attachPrimary(s.durations.primary,null))}get playbackDisabled(){return!1===this.hls.config.enableInterstitialPlayback}get primaryDetails(){var t;return null==(t=this.mediaSelection)?void 0:t.main.details}get primaryLive(){var t;return!(null==(t=this.primaryDetails)||!t.live)}resumePrimary(t,e,n){var i,r;if(this.playingItem=t,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(t),this.log("resuming ".concat(iy(t))),null==(i=this.detachedData)||!i.mediaSource){let n=this.timelinePos;(n<t.start||n>=t.end)&&(n=this.getPrimaryResumption(t,e),this.log(ay("resumePrimary",n)),this.timelinePos=n),this.attachPrimary(n,t)}if(!n)return;const s=null==(r=this.schedule)?void 0:r.items;s&&(this.log("INTERSTITIALS_PRIMARY_RESUMED ".concat(iy(t))),this.hls.trigger(ku.INTERSTITIALS_PRIMARY_RESUMED,{schedule:s.slice(0),scheduleIndex:e}),this.checkBuffer())}getPrimaryResumption(t,e){const n=t.start;if(this.primaryLive){const t=this.primaryDetails;if(0===e)return this.hls.startPosition;if(t&&(n<t.fragmentStart||n>t.edge))return this.hls.liveSyncPosition||-1}return n}isAssetBuffered(t){const e=this.getAssetPlayer(t.identifier);if(null!=e&&e.hls)return e.hls.bufferedToEnd;return bf.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=t.timelineStart+(t.duration||0)}attachPrimary(t,e,n){e?this.setBufferingItem(e):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const i=this.primaryMedia;if(!i)return;const r=this.hls;r.media?this.checkBuffer():(this.transferMediaTo(r,i),n&&this.startLoadingPrimaryAt(t,n)),n||(this.log(ay("attachPrimary",t)),this.timelinePos=t,this.startLoadingPrimaryAt(t,n))}startLoadingPrimaryAt(t,e){var n;const i=this.hls;!i.loadingEnabled||!i.media||Math.abs(((null==(n=i.mainForwardBufferInfo)?void 0:n.start)||i.media.currentTime)-t)>.5?i.startLoad(t,e):i.bufferingEnabled||i.resumeBuffering()}onManifestLoading(){var t;this.stopLoad(),null==(t=this.schedule)||t.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(ku.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(ku.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(t,e){if(-1===e.level||!this.schedule)return;const n=this.hls.levels[e.level];if(!n.details)return;const i=Gu(Gu({},this.mediaSelection||this.altSelection),{},{main:n});this.mediaSelection=i,this.schedule.parseInterstitialDateRanges(i,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(t,e){const n=this.hls.audioTracks[e.id],i=this.mediaSelection;if(!i)return void(this.altSelection=Gu(Gu({},this.altSelection),{},{audio:n}));const r=Gu(Gu({},i),{},{audio:n});this.mediaSelection=r}onSubtitleTrackUpdated(t,e){const n=this.hls.subtitleTracks[e.id],i=this.mediaSelection;if(!i)return void(this.altSelection=Gu(Gu({},this.altSelection),{},{subtitles:n}));const r=Gu(Gu({},i),{},{subtitles:n});this.mediaSelection=r}onAudioTrackSwitching(t,e){const n=wd(e);this.playerQueue.forEach(t=>{let{hls:i}=t;return i&&(i.setAudioOption(e)||i.setAudioOption(n))})}onSubtitleTrackSwitch(t,e){const n=wd(e);this.playerQueue.forEach(t=>{let{hls:i}=t;return i&&(i.setSubtitleOption(e)||-1!==e.id&&i.setSubtitleOption(n))})}onBufferCodecs(t,e){const n=e.tracks;n&&(this.requiredTracks=n)}onBufferAppended(t,e){this.checkBuffer()}onBufferFlushed(t,e){const n=this.playingItem;if(n&&!this.itemsMatch(n,this.bufferingItem)&&!this.isInterstitial(n)){const t=this.timelinePos;this.bufferedPos=t,this.checkBuffer()}}onBufferedToEnd(t){if(!this.schedule)return;const e=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&e){for(let t=0;t<e.length;t++){const i=e[t];if(i.cue.post){var n;const t=this.schedule.findEventIndex(i.identifier),e=null==(n=this.schedule.items)?void 0:n[t];this.isInterstitial(e)&&this.eventItemsMatch(e,this.bufferingItem)&&this.bufferedToItem(e,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(t){const e=this.playingItem;if(!this.playingLastItem&&e){const t=this.findItemIndex(e);this.setSchedulePosition(t+1)}else this.shouldPlay=!1}updateItem(t,e){var n;const i=null==(n=this.schedule)?void 0:n.items;if(t&&i){return i[this.findItemIndex(t,e)]||null}return null}trimInPlace(t,e){if(this.isInterstitial(t)&&t.event.appendInPlace&&e.end-t.end>.25){t.event.assetList.forEach((e,n)=>{t.event.isAssetPastPlayoutLimit(n)&&this.clearAssetPlayer(e.identifier,null)});const n=t.end+.25,i=bf.bufferInfo(this.primaryMedia,n,0);if(i.end>n||(i.nextStart||0)>n){this.log("trim buffered interstitial ".concat(iy(t)," (was ").concat(iy(e),")"));const i=!0;this.attachPrimary(n,null,i),this.flushFrontBuffer(n)}}}itemsMatch(t,e){return!!e&&(t===e||t.event&&e.event&&this.eventItemsMatch(t,e)||!t.event&&!e.event&&this.findItemIndex(t)===this.findItemIndex(e))}eventItemsMatch(t,e){var n;return!!e&&(t===e||t.event.identifier===(null==(n=e.event)?void 0:n.identifier))}findItemIndex(t,e){return t&&this.schedule?this.schedule.findItemIndex(t,e):-1}updateSchedule(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e;const n=this.mediaSelection;n&&(null==(e=this.schedule)||e.updateSchedule(n,[],t))}checkBuffer(t){var e;const n=null==(e=this.schedule)?void 0:e.items;if(!n)return;const i=bf.bufferInfo(this.primaryMedia,this.timelinePos,0);t&&(this.bufferedPos=this.timelinePos),t||(t=i.len<1),this.updateBufferedPos(i.end,n,t)}updateBufferedPos(t,e,n){const i=this.schedule,r=this.bufferingItem;if(this.bufferedPos>t||!i)return;if(1===e.length&&this.itemsMatch(e[0],r))return void(this.bufferedPos=t);const s=this.playingItem,a=this.findItemIndex(s);let o=i.findItemIndexAtTime(t);if(this.bufferedPos<t){var l;const n=this.findItemIndex(r),i=Math.min(n+1,e.length-1),s=e[i];if((-1===o&&r&&t>=r.end||null!=(l=s.event)&&l.appendInPlace&&t+.01>=s.start)&&(o=i),this.isInterstitial(r)){const t=r.event;if(i-a>1&&!1===t.appendInPlace)return;if(0===t.assetList.length&&t.assetListLoader)return}if(this.bufferedPos=t,o>n&&o>a)this.bufferedToItem(s);else{const e=this.primaryDetails;this.primaryLive&&e&&t>e.edge-e.targetduration&&s.start<e.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(s)&&this.preloadAssets(s.event,0)}}else n&&s&&!this.itemsMatch(s,r)&&(o===a?this.bufferedToItem(s):o===a+1&&this.bufferedToItem(e[o]))}assetsBuffered(t,e){return 0!==t.event.assetList.length&&!t.event.assetList.some(t=>{const n=this.getAssetPlayer(t.identifier);return!(null!=n&&n.bufferedInPlaceToEnd(e))})}setBufferingItem(t){const e=this.bufferingItem,n=this.schedule;if(!this.itemsMatch(t,e)&&n){const{items:i,events:r}=n;if(!i||!r)return e;const s=this.isInterstitial(t),a=this.getBufferingPlayer();this.bufferingItem=t,this.bufferedPos=Math.max(t.start,Math.min(t.end,this.timelinePos));const o=a?a.remaining:e?e.end-this.timelinePos:0;if(this.log("INTERSTITIALS_BUFFERED_TO_BOUNDARY ".concat(iy(t))+(e?" (".concat(o.toFixed(2)," remaining)"):"")),!this.playbackDisabled)if(s){const e=n.findAssetIndex(t.event,this.bufferedPos);t.event.assetList.forEach((t,n)=>{const i=this.getAssetPlayer(t.identifier);i&&(n===e&&i.loadSource(),i.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(t=>t.pauseBuffering());this.hls.trigger(ku.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:r.slice(0),schedule:i.slice(0),bufferingIndex:this.findItemIndex(t),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==t&&(this.bufferingItem=t);return e}bufferedToItem(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.setBufferingItem(t);if(!this.playbackDisabled)if(this.isInterstitial(t))this.bufferedToEvent(t,e);else if(null!==n){this.bufferingAsset=null;const e=this.detachedData;if(e)if(e.mediaSource){const e=!0;this.attachPrimary(t.start,t,e)}else this.preloadPrimary(t);else this.preloadPrimary(t)}}preloadPrimary(t){const e=this.findItemIndex(t),n=this.getPrimaryResumption(t,e);this.startLoadingPrimaryAt(n)}bufferedToEvent(t,e){const n=t.event,i=0===n.assetList.length&&!n.assetListLoader,r=n.cue.once;if(i||!r){const t=this.preloadAssets(n,e);if(null!=t&&t.interstitial.appendInPlace){const e=this.primaryMedia;e&&this.bufferAssetPlayer(t,e)}}}preloadAssets(t,e){const n=t.assetUrl,i=t.assetList.length,r=0===i&&!t.assetListLoader,s=t.cue.once;if(r){const r=t.timelineStart;if(t.appendInPlace){var a;const e=this.playingItem;this.isInterstitial(e)||(null==e||null==(a=e.nextEvent)?void 0:a.identifier)!==t.identifier||this.flushFrontBuffer(r+.25)}let s,o=0;if(!this.playingItem&&this.primaryLive&&(o=this.hls.startPosition,-1===o&&(o=this.hls.liveSyncPosition||0)),o&&!t.cue.pre&&!t.cue.post){const t=o-r;t>0&&(s=Math.round(1e3*t)/1e3)}if(this.log("Load interstitial asset ".concat(e+1,"/").concat(n?1:i," ").concat(t).concat(s?" live-start: ".concat(o," start-offset: ").concat(s):"")),n)return this.createAsset(t,0,0,r,t.duration,n);const l=this.assetListLoader.loadAssetList(t,s);l&&(t.assetListLoader=l)}else if(!s&&i){for(let r=e;r<i;r++){const e=t.assetList[r],n=this.getAssetPlayerQueueIndex(e.identifier);-1!==n&&!this.playerQueue[n].destroyed||e.error||this.createAssetPlayer(t,e,r)}const n=t.assetList[e];if(n){const t=this.getAssetPlayer(n.identifier);return t&&t.loadSource(),t}}return null}flushFrontBuffer(t){const e=this.requiredTracks;if(!e)return;this.log("Removing front buffer starting at ".concat(t));Object.keys(e).forEach(e=>{this.hls.trigger(ku.BUFFER_FLUSHING,{startOffset:t,endOffset:1/0,type:e})})}getAssetPlayerQueueIndex(t){const e=this.playerQueue;for(let n=0;n<e.length;n++)if(t===e[n].assetId)return n;return-1}getAssetPlayer(t){const e=this.getAssetPlayerQueueIndex(t);return this.playerQueue[e]||null}getBufferingPlayer(){const{playerQueue:t,primaryMedia:e}=this;if(e)for(let n=0;n<t.length;n++)if(t[n].media===e)return t[n];return null}createAsset(t,e,n,i,r,s){const a={parentIdentifier:t.identifier,identifier:qv(t,s,e),duration:r,startOffset:n,timelineStart:i,uri:s};return this.createAssetPlayer(t,a,e)}createAssetPlayer(t,e,n){const i=this.hls,r=i.userConfig;let s=r.videoPreference;const a=i.loadLevelObj||i.levels[i.currentLevel];(s||a)&&(s=Hu({},s),a.videoCodec&&(s.videoCodec=a.videoCodec),a.videoRange&&(s.allowedVideoRanges=[a.videoRange]));const o=i.audioTracks[i.audioTrack],l=i.subtitleTracks[i.subtitleTrack];let c=0;if(this.primaryLive||t.appendInPlace){const t=this.timelinePos-e.timelineStart;if(t>1){const n=e.duration;n&&t<n&&(c=t)}}const u=e.identifier,h=Gu(Gu({},r),{},{maxMaxBufferLength:Math.min(180,i.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:i.sessionId,assetPlayerId:u,abrEwmaDefaultEstimate:i.bandwidthEstimate,interstitialsController:void 0,startPosition:c,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:s,audioPreference:o||r.audioPreference,subtitlePreference:l||r.subtitlePreference});t.appendInPlace&&(t.appendInPlaceStarted=!0,e.timelineStart&&(h.timelineOffset=e.timelineStart));const d=h.cmcd;null!=d&&d.sessionId&&d.contentId&&(h.cmcd=Hu({},d,{contentId:Yv(e.uri)})),this.getAssetPlayer(u)&&this.warn("Duplicate date range identifier ".concat(t," and asset ").concat(u));const f=new ey(this.HlsPlayerClass,h,t,e);this.playerQueue.push(f),t.assetList[n]=e;let p=!0;const m=i=>{if(i.live){var r;const e=new Error("Interstitials MUST be VOD assets ".concat(t)),i={fatal:!0,type:Cu.OTHER_ERROR,details:Ru.INTERSTITIAL_ASSET_ITEM_ERROR,error:e},s=(null==(r=this.schedule)?void 0:r.findEventIndex(t.identifier))||-1;return void this.handleAssetItemError(i,t,s,n,e.message)}const s=i.edge-i.fragmentStart,a=e.duration;(p||null===a||s>a)&&(p=!1,this.log('Interstitial asset "'.concat(u,'" duration change ').concat(a," > ").concat(s)),e.duration=s,this.updateSchedule())};f.on(ku.LEVEL_UPDATED,(t,e)=>{let{details:n}=e;return m(n)}),f.on(ku.LEVEL_PTS_UPDATED,(t,e)=>{let{details:n}=e;return m(n)}),f.on(ku.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const g=(t,e)=>{const n=this.getAssetPlayer(u);if(n&&e.tracks){n.off(ku.BUFFER_CODECS,g),n.tracks=e.tracks;const t=this.primaryMedia;this.bufferingAsset===n.assetItem&&t&&!n.media&&this.bufferAssetPlayer(n,t)}};f.on(ku.BUFFER_CODECS,g);f.on(ku.BUFFERED_TO_END,()=>{var n;const i=this.getAssetPlayer(u);if(this.log("buffered to end of asset ".concat(i)),!i||!this.schedule)return;const r=this.schedule.findEventIndex(t.identifier),s=null==(n=this.schedule.items)?void 0:n[r];this.isInterstitial(s)&&this.advanceAssetBuffering(s,e)});const v=e=>()=>{if(!this.getAssetPlayer(u)||!this.schedule)return;this.shouldPlay=!0;const n=this.schedule.findEventIndex(t.identifier);this.advanceAfterAssetEnded(t,n,e)};return f.once(ku.MEDIA_ENDED,v(n)),f.once(ku.PLAYOUT_LIMIT_REACHED,v(1/0)),f.on(ku.ERROR,(e,i)=>{if(!this.schedule)return;const r=this.getAssetPlayer(u);if(i.details===Ru.BUFFER_STALLED_ERROR)return null!=r&&r.appendInPlace?void this.handleInPlaceStall(t):(this.onTimeupdate(),void this.checkBuffer(!0));this.handleAssetItemError(i,t,this.schedule.findEventIndex(t.identifier),n,"Asset player error ".concat(i.error," ").concat(t))}),f.on(ku.DESTROYING,()=>{if(!this.getAssetPlayer(u)||!this.schedule)return;const e=new Error("Asset player destroyed unexpectedly ".concat(u)),i={fatal:!0,type:Cu.OTHER_ERROR,details:Ru.INTERSTITIAL_ASSET_ITEM_ERROR,error:e};this.handleAssetItemError(i,t,this.schedule.findEventIndex(t.identifier),n,e.message)}),this.log("INTERSTITIAL_ASSET_PLAYER_CREATED ".concat(ty(e))),this.hls.trigger(ku.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:e,assetListIndex:n,event:t,player:f}),f}clearInterstitial(t,e){this.clearAssetPlayers(t,e),t.reset()}clearAssetPlayers(t,e){t.assetList.forEach(t=>{this.clearAssetPlayer(t.identifier,e)})}resetAssetPlayer(t){const e=this.getAssetPlayerQueueIndex(t);if(-1!==e){this.log('reset asset player "'.concat(t,'" after error'));const n=this.playerQueue[e];this.transferMediaFromPlayer(n,null),n.resetDetails()}}clearAssetPlayer(t,e){const n=this.getAssetPlayerQueueIndex(t);if(-1!==n){const t=this.playerQueue[n];this.log("clear ".concat(t," toSegment: ").concat(e?iy(e):e)),this.transferMediaFromPlayer(t,e),this.playerQueue.splice(n,1),t.destroy()}}emptyPlayerQueue(){let t;for(;t=this.playerQueue.pop();)t.destroy();this.playerQueue=[]}startAssetPlayer(t,e,n,i,r){const{interstitial:s,assetItem:a,assetId:o}=t,l=s.assetList.length,c=this.playingAsset;this.endedAsset=null,this.playingAsset=a,c&&c.identifier===o||(c&&(this.clearAssetPlayer(c.identifier,n[i]),delete c.error),this.log("INTERSTITIAL_ASSET_STARTED ".concat(e+1,"/").concat(l," ").concat(ty(a))),this.hls.trigger(ku.INTERSTITIAL_ASSET_STARTED,{asset:a,assetListIndex:e,event:s,schedule:n.slice(0),scheduleIndex:i,player:t})),this.bufferAssetPlayer(t,r)}bufferAssetPlayer(t,e){var n,i;if(!this.schedule)return;const{interstitial:r,assetItem:s}=t,a=this.schedule.findEventIndex(r.identifier),o=null==(n=this.schedule.items)?void 0:n[a];if(!o)return;t.loadSource(),this.setBufferingItem(o),this.bufferingAsset=s;const l=this.getBufferingPlayer();if(l===t)return;const c=r.appendInPlace;if(c&&!1===(null==l?void 0:l.interstitial.appendInPlace))return;const u=(null==l?void 0:l.tracks)||(null==(i=this.detachedData)?void 0:i.tracks)||this.requiredTracks;if(c&&s!==this.playingAsset){if(!t.tracks)return void this.log("Waiting for track info before buffering ".concat(t));if(u&&!Ju(u,t.tracks)){const e=new Error("Asset ".concat(ty(s)," SourceBuffer tracks ('").concat(Object.keys(t.tracks),"') are not compatible with primary content tracks ('").concat(Object.keys(u),"')")),n={fatal:!0,type:Cu.OTHER_ERROR,details:Ru.INTERSTITIAL_ASSET_ITEM_ERROR,error:e},i=r.findAssetIndex(s);return void this.handleAssetItemError(n,r,a,i,e.message)}}this.transferMediaTo(t,e)}handleInPlaceStall(t){const e=this.schedule,n=this.primaryMedia;if(!e||!n)return;const i=n.currentTime,r=e.findAssetIndex(t,i),s=t.assetList[r];if(s){const a=this.getAssetPlayer(s.identifier);if(a){const o=a.currentTime||i-s.timelineStart,l=a.duration-o;if(this.warn("Stalled at ".concat(o," of ").concat(o+l," in ").concat(a," ").concat(t," (media.currentTime: ").concat(i,")")),o&&(l/n.playbackRate<.5||a.bufferedInPlaceToEnd(n))&&a.hls){const n=e.findEventIndex(t.identifier);this.advanceAfterAssetEnded(t,n,r)}}}}advanceInPlace(t){const e=this.primaryMedia;e&&e.currentTime<t&&(e.currentTime=t)}handleAssetItemError(t,e,n,i,r){if(t.details===Ru.BUFFER_STALLED_ERROR)return;const s=e.assetList[i]||null;if(this.warn("INTERSTITIAL_ASSET_ERROR ".concat(s?ty(s):s," ").concat(t.error)),!this.schedule)return;const a=(null==s?void 0:s.identifier)||"",o=this.getAssetPlayerQueueIndex(a),l=this.playerQueue[o]||null,c=this.schedule.items,u=Hu({},t,{fatal:!1,errorAction:Qd(!0),asset:s,assetListIndex:i,event:e,schedule:c,scheduleIndex:n,player:l});if(this.hls.trigger(ku.INTERSTITIAL_ASSET_ERROR,u),!t.fatal)return;const h=this.playingAsset,d=this.bufferingAsset,f=new Error(r);if(s&&(this.clearAssetPlayer(a,null),s.error=f),e.assetList.some(t=>!t.error))for(let p=i;p<e.assetList.length;p++)this.resetAssetPlayer(e.assetList[p].identifier);else e.error=f;this.updateSchedule(!0),e.error?this.primaryFallback(e):h&&h.identifier===a?this.advanceAfterAssetEnded(e,n,i):d&&d.identifier===a&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,d)}primaryFallback(t){const e=t.timelineStart,n=this.effectivePlayingItem;let i=this.timelinePos;if(n){this.log('Fallback to primary from event "'.concat(t.identifier,'" start: ').concat(e," pos: ").concat(i," playing: ").concat(iy(n)," error: ").concat(t.error)),-1===i&&(i=this.hls.startPosition);const r=this.updateItem(n,i);this.itemsMatch(n,r)&&this.clearInterstitial(t,null),t.appendInPlace&&(this.attachPrimary(e,null),this.flushFrontBuffer(e))}else if(-1===i)return void this.checkStart();if(!this.schedule)return;const r=this.schedule.findItemIndexAtTime(i);this.setSchedulePosition(r)}onAssetListLoaded(t,e){var n,i;const r=e.event,s=r.identifier,a=e.assetListResponse.ASSETS;if(null==(n=this.schedule)||!n.hasEvent(s))return;const o=r.timelineStart,l=r.duration;let c=0;a.forEach((t,e)=>{const n=parseFloat(t.DURATION);this.createAsset(r,e,c,o+c,n,t.URI),c+=n}),r.duration=c,this.log("Loaded asset-list with duration: ".concat(c," (was: ").concat(l,") ").concat(r));const u=this.waitingItem,h=(null==u?void 0:u.event.identifier)===s;this.updateSchedule();const d=null==(i=this.bufferingItem)?void 0:i.event;if(h){var f;const t=this.schedule.findEventIndex(s),e=null==(f=this.schedule.items)?void 0:f[t];if(e){if(!this.playingItem&&this.timelinePos>e.end){if(this.schedule.findItemIndexAtTime(this.timelinePos)!==t)return r.error=new Error("Interstitial ".concat(a.length?"no longer within playback range":"asset-list is empty"," ").concat(this.timelinePos," ").concat(r)),this.log(r.error.message),this.updateSchedule(!0),void this.primaryFallback(r)}this.setBufferingItem(e)}this.setSchedulePosition(t)}else if((null==d?void 0:d.identifier)===s){const t=r.assetList[0];if(t){const e=this.getAssetPlayer(t.identifier);if(d.appendInPlace){const t=this.primaryMedia;e&&t&&this.bufferAssetPlayer(e,t)}else e&&e.loadSource()}}}onError(t,e){if(this.schedule)switch(e.details){case Ru.ASSET_LIST_PARSING_ERROR:case Ru.ASSET_LIST_LOAD_ERROR:case Ru.ASSET_LIST_LOAD_TIMEOUT:{const t=e.interstitial;t&&(this.updateSchedule(!0),this.primaryFallback(t));break}case Ru.BUFFER_STALLED_ERROR:{const t=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(t)&&t.event.appendInPlace)return void this.handleInPlaceStall(t.event);this.log("Primary player stall @".concat(this.timelinePos," bufferedPos: ").concat(this.bufferedPos)),this.onTimeupdate(),this.checkBuffer(!0);break}}}}});function h_(t){return t&&"object"===typeof t?Array.isArray(t)?t.map(h_):Object.keys(t).reduce((e,n)=>(e[n]=h_(t[n]),e),{}):t}function d_(t,e){const n=t.loader;if(n!==s_&&n!==c_)e.log("[config]: Custom loader detected, cannot enable progressive streaming"),t.progressive=!1;else{(function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(Wq){}return!1})()&&(t.loader=s_,t.progressive=!0,t.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}}class f_ extends vf{constructor(t,e){super("gap-controller",t.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var t;null!=(t=this.media)&&t.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{var t;this.hls&&(this.ended=(null==(t=this.media)?void 0:t.currentTime)||1,this.hls.trigger(ku.MEDIA_ENDED,{stalled:!1}))},this.hls=t,this.fragmentTracker=e,this.registerListeners()}registerListeners(){const{hls:t}=this;t&&(t.on(ku.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(ku.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:t}=this;t&&(t.off(ku.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(ku.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(t,e){this.setInterval(100),this.mediaSource=e.mediaSource;const n=this.media=e.media;Fp(n,"playing",this.onMediaPlaying),Fp(n,"waiting",this.onMediaWaiting),Fp(n,"ended",this.onMediaEnded)}onMediaDetaching(t,e){this.clearInterval();const{media:n}=this;n&&(Up(n,"playing",this.onMediaPlaying),Up(n,"waiting",this.onMediaWaiting),Up(n,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(t,e){this.buffered=e.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var t;if(null==(t=this.media)||!t.readyState||!this.hasBuffered)return;const e=this.media.currentTime;this.poll(e,this.lastCurrentTime),this.lastCurrentTime=e}poll(t,e){var n,i;const r=null==(n=this.hls)?void 0:n.config;if(!r)return;const s=this.media;if(!s)return;const{seeking:a}=s,o=this.seeking&&!a,l=!this.seeking&&a,c=s.paused&&!a||s.ended||0===s.playbackRate;if(this.seeking=a,t!==e)return e&&(this.ended=0),this.moved=!0,a||(this.nudgeRetry=0,r.nudgeOnVideoHole&&!c&&t>e&&this.nudgeOnVideoHole(t,e)),void(0===this.waiting&&this.stallResolved(t));if(l||o)return void(o&&this.stallResolved(t));if(c)return this.nudgeRetry=0,this.stallResolved(t),void(!this.ended&&s.ended&&this.hls&&(this.ended=t||1,this.hls.trigger(ku.MEDIA_ENDED,{stalled:!1})));if(!bf.getBuffered(s).length)return void(this.nudgeRetry=0);const u=bf.bufferInfo(s,t,0),h=u.nextStart||0,d=this.fragmentTracker;if(a&&d&&this.hls){const e=p_(this.hls.inFlightFragments,t),n=u.len>2,i=!h||e||h-t>2&&!d.getPartialFragment(t);if(n||i)return;this.moved=!1}const f=null==(i=this.hls)?void 0:i.latestLevelDetails;if(!this.moved&&null!==this.stalled&&d){if(!(u.len>0)&&!h)return;const e=Math.max(h,u.start||0)-t,n=!(null==f||!f.live)?2*f.targetduration:2,i=g_(t,d);if(e>0&&(e<=n||i))return void(s.paused||this._trySkipBufferHole(i))}const p=r.detectStallWithCurrentTimeMs,m=self.performance.now(),g=this.waiting;let v=this.stalled;if(null===v){if(!(g>0&&m-g<p))return void(this.stalled=m);v=this.stalled=g}const y=m-v;if(!a&&(y>=p||g)&&this.hls){var _;if("ended"===(null==(_=this.mediaSource)?void 0:_.readyState)&&(null==f||!f.live)&&Math.abs(t-((null==f?void 0:f.edge)||0))<1){if(this.ended)return;return this.ended=t||1,void this.hls.trigger(ku.MEDIA_ENDED,{stalled:!0})}if(this._reportStall(u),!this.media||!this.hls)return}const b=bf.bufferInfo(s,t,r.maxBufferHole);this._tryFixBufferStall(b,y,t)}stallResolved(t){const e=this.stalled;if(e&&this.hls&&(this.stalled=null,this.stallReported)){const n=self.performance.now()-e;this.log("playback not stuck anymore @".concat(t,", after ").concat(Math.round(n),"ms")),this.stallReported=!1,this.waiting=0,this.hls.trigger(ku.STALL_RESOLVED,{})}}nudgeOnVideoHole(t,e){var n;const i=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&null!=(n=this.buffered.audio)&&n.length&&i&&i.length>1&&t>i.end(0)){const n=bf.bufferedInfo(bf.timeRangesToArray(this.buffered.audio),t,0);if(n.len>1&&e>=n.start){const n=bf.timeRangesToArray(i),r=bf.bufferedInfo(n,e,0).bufferedIndex;if(r>-1&&r<n.length-1){const e=bf.bufferedInfo(n,t,0).bufferedIndex,i=n[r].end,s=n[r+1].start;if((-1===e||e>r)&&s-i<1&&t-i<2){const n=new Error("nudging playhead to flush pipeline after video hole. currentTime: ".concat(t," hole: ").concat(i," -> ").concat(s," buffered index: ").concat(e));this.warn(n.message),this.media.currentTime+=1e-6;let r=g_(t,this.fragmentTracker);r&&"fragment"in r?r=r.fragment:r||(r=void 0);const a=bf.bufferInfo(this.media,t,0);this.hls.trigger(ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:n,reason:n.message,frag:r,buffer:a.len,bufferInfo:a})}}}}}_tryFixBufferStall(t,e,n){var i,r;const{fragmentTracker:s,media:a}=this,o=null==(i=this.hls)?void 0:i.config;if(!a||!s||!o)return;const l=null==(r=this.hls)?void 0:r.latestLevelDetails,c=g_(n,s);if(c||null!=l&&l.live&&n<l.fragmentStart){if(this._trySkipBufferHole(c)||!this.media)return}const u=t.buffered,h=this.adjacentTraversal(t,n);(u&&u.length>1&&t.len>o.maxBufferHole||t.nextStart&&(t.nextStart-n<o.maxBufferHole||h))&&(e>1e3*o.highBufferWatchdogPeriod||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(t))}adjacentTraversal(t,e){const n=this.fragmentTracker,i=t.nextStart;if(n&&i){const t=n.getFragAtPos(e,Ou),r=n.getFragAtPos(i,Ou);if(t&&r)return r.sn-t.sn<2}return!1}_reportStall(t){const{hls:e,media:n,stallReported:i,stalled:r}=this;if(!i&&null!==r&&n&&e){this.stallReported=!0;const i=new Error("Playback stalling at @".concat(n.currentTime," due to low buffer (").concat(bd(t),")"));this.warn(i.message),e.trigger(ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.BUFFER_STALLED_ERROR,fatal:!1,error:i,buffer:t.len,bufferInfo:t,stalled:{start:r}})}}_trySkipBufferHole(t){var e;const{fragmentTracker:n,media:i}=this,r=null==(e=this.hls)?void 0:e.config;if(!i||!n||!r)return 0;const s=i.currentTime,a=bf.bufferInfo(i,s,0),o=s<a.start?a.start:a.nextStart;if(o&&this.hls){const e=a.len<=r.maxBufferHole,c=a.len>0&&a.len<1&&i.readyState<3,u=o-s;if(u>0&&(e||c)){if(u>r.maxBufferHole){let e=!1;if(0===s){const t=n.getAppendedFrag(0,Ou);t&&o<t.end&&(e=!0)}if(!e&&t){var l;if(null==(l=this.hls.loadLevelObj)||!l.details)return 0;if(p_(this.hls.inFlightFragments,o))return 0;let e=!1,i=t.end;for(;i<o;){const t=g_(i,n);if(!t){e=!0;break}i+=t.duration}if(e)return 0}}const e=Math.max(o+.05,s+.1);if(this.warn("skipping hole, adjusting currentTime from ".concat(s," to ").concat(e)),this.moved=!0,i.currentTime=e,null==t||!t.gap){const n=new Error("fragment loaded with buffer holes, seeking from ".concat(s," to ").concat(e)),i={type:Cu.MEDIA_ERROR,details:Ru.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:n,reason:n.message,buffer:a.len,bufferInfo:a};t&&("fragment"in t?i.part=t:i.frag=t),this.hls.trigger(ku.ERROR,i)}return e}}return 0}_tryNudgeBuffer(t){const{hls:e,media:n,nudgeRetry:i}=this,r=null==e?void 0:e.config;if(!n||!r)return 0;const s=n.currentTime;if(this.nudgeRetry++,i<r.nudgeMaxRetry){const a=s+(i+1)*r.nudgeOffset,o=new Error("Nudging 'currentTime' from ".concat(s," to ").concat(a));this.warn(o.message),n.currentTime=a,e.trigger(ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1,buffer:t.len,bufferInfo:t})}else{const n=new Error("Playhead still not moving while enough data buffered @".concat(s," after ").concat(r.nudgeMaxRetry," nudges"));this.error(n.message),e.trigger(ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.BUFFER_STALLED_ERROR,error:n,fatal:!0,buffer:t.len,bufferInfo:t})}}}function p_(t,e){const n=m_(t.main);if(n&&n.start<=e)return n;const i=m_(t.audio);return i&&i.start<=e?i:null}function m_(t){if(!t)return null;switch(t.state){case Hp:case zp:case Kp:case qp:return null}return t.frag}function g_(t,e){return e.getAppendedFrag(t,Ou)||e.getPartialFragment(t)}function v_(){if("undefined"!==typeof self)return self.VTTCue||self.TextTrackCue}function y_(t,e,n,i,r){let s=new t(e,n,"");try{s.value=i,r&&(s.type=r)}catch(Wq){s=new t(e,n,bd(r?Gu({type:r},i):i))}return s}const __=(()=>{const t=v_();try{t&&new t(0,Number.POSITIVE_INFINITY,"")}catch(Wq){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class b_{constructor(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(ku.EVENT_CUE_ENTER,{})},this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:t}=this;t&&(t.on(ku.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(ku.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.on(ku.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(ku.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(ku.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(ku.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:t}=this;t&&(t.off(ku.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(ku.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.off(ku.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(ku.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(ku.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(ku.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(t,e){var n;this.media=e.media,!1===(null==(n=e.overrides)?void 0:n.cueRemoval)&&(this.removeCues=!1)}onMediaAttached(){var t;const e=null==(t=this.hls)?void 0:t.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(t,e){this.media=null;!!e.transferMedia||(this.id3Track&&(this.removeCues&&Gv(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(t){const e=this.getID3Track(t.textTracks);return e.mode="hidden",e}getID3Track(t){if(this.media){for(let e=0;e<t.length;e++){const n=t[e];if("metadata"===n.kind&&"id3"===n.label)return Hv(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,e){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:n,enableID3MetadataCues:i}=this.hls.config;if(!n&&!i)return;const{samples:r}=e;this.id3Track||(this.id3Track=this.createTrack(this.media));const s=v_();if(s)for(let a=0;a<r.length;a++){const t=r[a].type;if(t===Cm.emsg&&!n||!i)continue;const e=Sm(r[a].data),o=r[a].pts;let l=o+r[a].duration;l>__&&(l=__);l-o<=0&&(l=o+.25);for(let n=0;n<e.length;n++){const i=e[n];if(!Tm(i)){this.updateId3CueEnds(o,t);const e=y_(s,o,l,i,t);e&&this.id3Track.addCue(e)}}}}updateId3CueEnds(t,e){var n;const i=null==(n=this.id3Track)?void 0:n.cues;if(i)for(let r=i.length;r--;){const n=i[r];n.type===e&&n.startTime<t&&n.endTime===__&&(n.endTime=t)}}onBufferFlushing(t,e){let{startOffset:n,endOffset:i,type:r}=e;const{id3Track:s,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:l}}=a;if(s&&(o||l)){let t;t="audio"===r?t=>t.type===Cm.audioId3&&l:"video"===r?t=>t.type===Cm.emsg&&o:t=>t.type===Cm.audioId3&&l||t.type===Cm.emsg&&o,jv(s,n,i,t)}}onLevelUpdated(t,e){let{details:n}=e;this.updateDateRangeCues(n,!0)}onLevelPtsUpdated(t,e){Math.abs(e.drift)>.01&&this.updateDateRangeCues(e.details)}updateDateRangeCues(t,e){if(!this.hls||!this.media)return;const{assetPlayerId:n,timelineOffset:i,enableDateRangeMetadataCues:r,interstitialsController:s}=this.hls.config;if(!r)return;const a=v_();if(n&&i&&!s){const{fragmentStart:e,fragmentEnd:i}=t;let r=this.assetCue;r?(r.startTime=e,r.endTime=i):a&&(r=this.assetCue=y_(a,e,i,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),r&&(r.id=n,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(r),r.addEventListener("enter",this.onEventCueEnter)))}if(!t.hasProgramDateTime)return;const{id3Track:o}=this,{dateRanges:l}=t,c=Object.keys(l);let u=this.dateRangeCuesAppended;var h;if(o&&e)if(null!=(h=o.cues)&&h.length){const t=Object.keys(u).filter(t=>!c.includes(t));for(let e=t.length;e--;){var d;const n=t[e],i=null==(d=u[n])?void 0:d.cues;delete u[n],i&&Object.keys(i).forEach(t=>{const e=i[t];if(e){e.removeEventListener("enter",this.onEventCueEnter);try{o.removeCue(e)}catch(Wq){}}})}}else u=this.dateRangeCuesAppended={};const f=t.fragments[t.fragments.length-1];if(0!==c.length&&Tu(null==f?void 0:f.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let t=0;t<c.length;t++){const e=c[t],n=l[e],i=n.startTime,r=u[e],o=(null==r?void 0:r.cues)||{};let h=(null==r?void 0:r.durationKnown)||!1,d=__;const{duration:f,endDate:p}=n;if(p&&null!==f)d=i+f,h=!0;else if(n.endOnNext&&!h){const t=c.reduce((t,e)=>{if(e!==n.id){const i=l[e];if(i.class===n.class&&i.startDate>n.startDate&&(!t||n.startDate<t.startDate))return i}return t},null);t&&(d=t.startTime,h=!0)}const m=Object.keys(n.attr);for(let t=0;t<m.length;t++){const l=m[t];if(!Rf(l))continue;const c=o[l];if(c)!h||null!=r&&r.durationKnown?Math.abs(c.startTime-i)>.01&&(c.startTime=i,c.endTime=d):c.endTime=d;else if(a){let t=n.attr[l];kf(l)&&(t=eh(t));const r=y_(a,i,d,{key:l,data:t},Cm.dateRange);r&&(r.id=e,this.id3Track.addCue(r),o[l]=r,s&&("X-ASSET-LIST"!==l&&"X-ASSET-URL"!==l||r.addEventListener("enter",this.onEventCueEnter)))}}u[e]={cues:o,dateRange:n,durationKnown:h}}}}}class x_{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,e=this.levelDetails;if(!t||!e)return;this.currentTime=t.currentTime;const n=this.computeLatency();if(null===n)return;this._latency=n;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:r}=this.config;if(!i||1===r||!e.live)return;const s=this.targetLatency;if(null===s)return;const a=n-s;if(a<Math.min(this.maxLatency,s+e.targetduration)&&a>.05&&this.forwardBufferLength>1){const e=Math.min(2,Math.max(1,r)),n=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20,i=Math.min(e,Math.max(1,n));this.changeMediaPlaybackRate(t,i)}else 1!==t.playbackRate&&0!==t.playbackRate&&this.changeMediaPlaybackRate(t,1)},this.hls=t,this.config=t.config,this.registerListeners()}get levelDetails(){var t;return(null==(t=this.hls)?void 0:t.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:t}=this;if(void 0!==t.liveMaxLatencyDuration)return t.liveMaxLatencyDuration;const e=this.levelDetails;return e?t.liveMaxLatencyDurationCount*e.targetduration:0}get targetLatency(){const t=this.levelDetails;if(null===t||null===this.hls)return null;const{holdBack:e,partHoldBack:n,targetduration:i}=t,{liveSyncDuration:r,liveSyncDurationCount:s,lowLatencyMode:a}=this.config,o=this.hls.userConfig;let l=a&&n||e;(this._targetLatencyUpdated||o.liveSyncDuration||o.liveSyncDurationCount||0===l)&&(l=void 0!==r?r:s*i);const c=i;return l+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,c)}set targetLatency(t){this.stallCount=0,this.config.liveSyncDuration=t,this._targetLatencyUpdated=!0}get liveSyncPosition(){const t=this.estimateLiveEdge(),e=this.targetLatency;if(null===t||null===e)return null;const n=this.levelDetails;if(null===n)return null;const i=n.edge,r=t-e-this.edgeStalled,s=i-n.totalduration,a=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(s,r),a)}get drift(){const t=this.levelDetails;return null===t?1:t.drift}get edgeStalled(){const t=this.levelDetails;if(null===t)return 0;const e=3*(this.config.lowLatencyMode&&t.partTarget||t.targetduration);return Math.max(t.age-e,0)}get forwardBufferLength(){const{media:t}=this,e=this.levelDetails;if(!t||!e)return 0;const n=t.buffered.length;return(n?t.buffered.end(n-1):e.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:t}=this;t&&(t.on(ku.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.on(ku.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(ku.ERROR,this.onError,this))}unregisterListeners(){const{hls:t}=this;t&&(t.off(ku.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(ku.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.off(ku.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(ku.ERROR,this.onError,this))}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(t,e){let{details:n}=e;n.advanced&&this.onTimeupdate(),!n.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(t,e){var n;e.details===Ru.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&null!=(n=this.levelDetails)&&n.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(t,e){var n,i;t.playbackRate!==e&&(null==(n=this.hls)||n.logger.debug("[latency-controller]: latency=".concat(this.latency.toFixed(3),", targetLatency=").concat(null==(i=this.targetLatency)?void 0:i.toFixed(3),", forwardBufferLength=").concat(this.forwardBufferLength.toFixed(3),": adjusting playback rate from ").concat(t.playbackRate," to ").concat(e)),t.playbackRate=e)}estimateLiveEdge(){const t=this.levelDetails;return null===t?null:t.edge+t.age}computeLatency(){const t=this.estimateLiveEdge();return null===t?null:t-this.currentTime}}class E_ extends kg{constructor(t,e){super(t,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=e,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.on(ku.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(ku.LEVEL_LOADED,this.onLevelLoaded,this),t.on(ku.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(ku.FRAG_BUFFERED,this.onFragBuffered,this),t.on(ku.ERROR,this.onError,this)}_unregisterListeners(){const{hls:t}=this;t.off(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.off(ku.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(ku.LEVEL_LOADED,this.onLevelLoaded,this),t.off(ku.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(ku.FRAG_BUFFERED,this.onFragBuffered,this),t.off(ku.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(t,e){this.resetLevels()}onManifestLoaded(t,e){const n=this.hls.config.preferManagedMediaSource,i=[],r={},s={};let a=!1,o=!1,l=!1;e.levels.forEach(t=>{const e=t.attrs;let{audioCodec:c,videoCodec:u}=t;c&&(t.audioCodec=c=Zh(c,n)||void 0),u&&(u=t.videoCodec=function(t){const e=t.split(",");for(let n=0;n<e.length;n++){const t=e[n].split(".");t.length>2&&"avc1"===t[0]&&(e[n]="avc1.".concat(parseInt(t[1]).toString(16)).concat(("000"+parseInt(t[2]).toString(16)).slice(-4)))}return e.join(",")}(u));const{width:h,height:d,unknownCodecs:f}=t,p=(null==f?void 0:f.length)||0;if(a||(a=!(!h||!d)),o||(o=!!u),l||(l=!!c),p||c&&!this.isAudioSupported(c)||u&&!this.isVideoSupported(u))return void this.log('Some or all CODECS not supported "'.concat(e.CODECS,'"'));const{CODECS:m,"FRAME-RATE":g,"HDCP-LEVEL":v,"PATHWAY-ID":y,RESOLUTION:_,"VIDEO-RANGE":b}=e,x="".concat(y||".","-"),E="".concat(x).concat(t.bitrate,"-").concat(_,"-").concat(g,"-").concat(m,"-").concat(b,"-").concat(v);if(r[E])if(r[E].uri===t.url||t.attrs["PATHWAY-ID"])r[E].addGroupId("audio",e.AUDIO),r[E].addGroupId("text",e.SUBTITLES);else{const e=s[E]+=1;t.attrs["PATHWAY-ID"]=new Array(e+1).join(".");const n=this.createLevel(t);r[E]=n,i.push(n)}else{const e=this.createLevel(t);r[E]=e,s[E]=1,i.push(e)}}),this.filterAndSortMediaOptions(i,e,a,o,l)}createLevel(t){const e=new vd(t),n=t.supplemental;if(null!=n&&n.videoCodec&&!this.isVideoSupported(n.videoCodec)){const t=new Error('SUPPLEMENTAL-CODECS not supported "'.concat(n.videoCodec,'"'));this.log(t.message),e.supportedResult=sd(t,[])}return e}isAudioSupported(t){return jh(t,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(t){return jh(t,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(t,e,n,i,r){var s;let a=[],o=[],l=t;const c=(null==(s=e.stats)?void 0:s.parsing)||{};if((n||i)&&r&&(l=l.filter(t=>{let{videoCodec:e,videoRange:n,width:i,height:r}=t;return(!!e||!(!i||!r))&&(!!(s=n)&&hd.indexOf(s)>-1);var s})),0===l.length)return Promise.resolve().then(()=>{if(this.hls){let t="no level with compatible codecs found in manifest",n=t;e.levels.length&&(n="one or more CODECS in variant not supported: ".concat(bd(e.levels.map(t=>t.attrs.CODECS).filter((t,e,n)=>n.indexOf(t)===e))),this.warn(n),t+=" (".concat(n,")"));const i=new Error(t);this.hls.trigger(ku.ERROR,{type:Cu.MEDIA_ERROR,details:Ru.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:e.url,error:i,reason:n})}}),void(c.end=performance.now());e.audioTracks&&(a=e.audioTracks.filter(t=>!t.audioCodec||this.isAudioSupported(t.audioCodec)),w_(a)),e.subtitles&&(o=e.subtitles,w_(o));const u=l.slice(0);l.sort((t,e)=>{if(t.attrs["HDCP-LEVEL"]!==e.attrs["HDCP-LEVEL"])return(t.attrs["HDCP-LEVEL"]||"")>(e.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&t.height!==e.height)return t.height-e.height;if(t.frameRate!==e.frameRate)return t.frameRate-e.frameRate;if(t.videoRange!==e.videoRange)return hd.indexOf(t.videoRange)-hd.indexOf(e.videoRange);if(t.videoCodec!==e.videoCodec){const n=Xh(t.videoCodec),i=Xh(e.videoCodec);if(n!==i)return i-n}if(t.uri===e.uri&&t.codecSet!==e.codecSet){const n=Kh(t.codecSet),i=Kh(e.codecSet);if(n!==i)return i-n}return t.averageBitrate!==e.averageBitrate?t.averageBitrate-e.averageBitrate:0});let h=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==u.length))for(let v=0;v<u.length;v++)if(u[v].pathwayId===l[0].pathwayId){h=u[v];break}this._levels=l;for(let v=0;v<l.length;v++)if(l[v]===h){var d;this._firstLevel=v;const t=h.bitrate,e=this.hls.bandwidthEstimate;if(this.log("manifest loaded, ".concat(l.length," level(s) found, first bitrate: ").concat(t)),void 0===(null==(d=this.hls.userConfig)?void 0:d.abrEwmaDefaultEstimate)){const n=Math.min(t,this.hls.config.abrEwmaDefaultEstimateMax);n>e&&e===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=n)}break}const f=r&&!i,p=this.hls.config,m=!(!p.audioStreamController||!p.audioTrackController),g={levels:l,audioTracks:a,subtitleTracks:o,sessionData:e.sessionData,sessionKeys:e.sessionKeys,firstLevel:this._firstLevel,stats:e.stats,audio:r,video:i,altAudio:m&&!f&&a.some(t=>!!t.url)};c.end=performance.now(),this.hls.trigger(ku.MANIFEST_PARSED,g)}get levels(){return 0===this._levels.length?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(t){const e=this._levels;if(0===e.length)return;if(t<0||t>=e.length){const n=new Error("invalid level idx"),i=t<0;if(this.hls.trigger(ku.ERROR,{type:Cu.OTHER_ERROR,details:Ru.LEVEL_SWITCH_ERROR,level:t,fatal:i,error:n,reason:n.message}),i)return;t=Math.min(t,e.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,r=i?i.attrs["PATHWAY-ID"]:void 0,s=e[t],a=s.attrs["PATHWAY-ID"];if(this.currentLevelIndex=t,this.currentLevel=s,n===t&&i&&r===a)return;this.log("Switching to level ".concat(t," (").concat(s.height?s.height+"p ":"").concat(s.videoRange?s.videoRange+" ":"").concat(s.codecSet?s.codecSet+" ":"","@").concat(s.bitrate,")").concat(a?" with Pathway "+a:""," from level ").concat(n).concat(r?" with Pathway "+r:""));const o={level:t,attrs:s.attrs,details:s.details,bitrate:s.bitrate,averageBitrate:s.averageBitrate,maxBitrate:s.maxBitrate,realBitrate:s.realBitrate,width:s.width,height:s.height,codecSet:s.codecSet,audioCodec:s.audioCodec,videoCodec:s.videoCodec,audioGroups:s.audioGroups,subtitleGroups:s.subtitleGroups,loaded:s.loaded,loadError:s.loadError,fragmentError:s.fragmentError,name:s.name,id:s.id,uri:s.uri,url:s.url,urlId:0,audioGroupIds:s.audioGroupIds,textGroupIds:s.textGroupIds};this.hls.trigger(ku.LEVEL_SWITCHING,o);const l=s.details;if(!l||l.live){const t=this.switchParams(s.uri,null==i?void 0:i.details,l);this.loadPlaylist(t)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){if(void 0===this._startLevel){const t=this.hls.config.startLevel;return void 0!==t?t:this.hls.firstAutoLevel}return this._startLevel}set startLevel(t){this._startLevel=t}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(t){if(this.steering){const e=this.steering.pathways(),n=t.filter(t=>-1!==e.indexOf(t));if(t.length<1)return void this.warn("pathwayPriority ".concat(t," should contain at least one pathway from list: ").concat(e));this.steering.pathwayPriority=n}}onError(t,e){!e.fatal&&e.context&&e.context.type===Du&&e.context.level===this.level&&this.checkRetry(e)}onFragBuffered(t,e){let{frag:n}=e;if(void 0!==n&&n.type===Ou){const t=n.elementaryStreams;if(!Object.keys(t).some(e=>!!t[e]))return;const e=this._levels[n.level];null!=e&&e.loadError&&(this.log("Resetting level error count of ".concat(e.loadError," on frag buffered")),e.loadError=0)}}onLevelLoaded(t,e){var n;const{level:i,details:r}=e,s=e.levelInfo;var a;if(!s)return this.warn("Invalid level index ".concat(i)),void(null!=(a=e.deliveryDirectives)&&a.skip&&(r.deltaUpdateFailed=!0));if(s===this.currentLevel||e.withoutMultiVariant){0===s.fragmentError&&(s.loadError=0);let t=s.details;t===e.details&&t.advanced&&(t=void 0),this.playlistLoaded(i,e,t)}else null!=(n=e.deliveryDirectives)&&n.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const n=this.getUrlWithDirectives(t.uri,e),i=this.currentLevelIndex,r=t.attrs["PATHWAY-ID"],s=t.details,a=null==s?void 0:s.age;this.log("Loading level index ".concat(i).concat(void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:"").concat(r?" Pathway "+r:"").concat(a&&s.live?" age "+a.toFixed(1)+(s.type?" "+s.type||0:""):""," ").concat(n)),this.hls.trigger(ku.LEVEL_LOADING,{url:n,level:i,levelInfo:t,pathwayId:t.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)}removeLevel(t){var e;if(1===this._levels.length)return;const n=this._levels.filter((e,n)=>n!==t||(this.steering&&this.steering.removeLevel(e),e===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,e.details&&e.details.fragments.forEach(t=>t.level=-1)),!1));Rp(n),this._levels=n,this.currentLevelIndex>-1&&null!=(e=this.currentLevel)&&e.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const i=n.length-1;this._firstLevel=Math.min(this._firstLevel,i),this._startLevel&&(this._startLevel=Math.min(this._startLevel,i)),this.hls.trigger(ku.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(t,e){let{levels:n}=e;this._levels=n}checkMaxAutoUpdated(){const{autoLevelCapping:t,maxAutoLevel:e,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==e&&(this._maxAutoLevel=e,this.hls.trigger(ku.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:e,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function w_(t){const e={};t.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}function S_(){return self.SourceBuffer||self.WebKitSourceBuffer}function T_(){if(!Zu())return!1;const t=S_();return!t||t.prototype&&"function"===typeof t.prototype.appendBuffer&&"function"===typeof t.prototype.remove}class M_ extends Jp{constructor(t,e,n){super(t,e,n,"stream-controller",Ou),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const t=this.media,e=t?t.currentTime:null;if(null===e||!Tu(e))return;if(this.log("Media seeked to ".concat(e.toFixed(3))),!this.getBufferedFrag(e))return;const n=this.getFwdBufferInfoAtPos(t,e,Ou,0);null!==n&&0!==n.len?this.tick():this.warn("Main forward buffer length at ".concat(e,' on "seeked" event ').concat(n?n.len:"empty",")"))},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(ku.MANIFEST_PARSED,this.onManifestParsed,this),t.on(ku.LEVEL_LOADING,this.onLevelLoading,this),t.on(ku.LEVEL_LOADED,this.onLevelLoaded,this),t.on(ku.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(ku.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(ku.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(ku.BUFFER_CREATED,this.onBufferCreated,this),t.on(ku.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(ku.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(ku.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:t}=this;t.off(ku.MANIFEST_PARSED,this.onManifestParsed,this),t.off(ku.LEVEL_LOADED,this.onLevelLoaded,this),t.off(ku.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(ku.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(ku.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(ku.BUFFER_CREATED,this.onBufferCreated,this),t.off(ku.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(ku.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(ku.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(t,e){if(this.levels){const{lastCurrentTime:n,hls:i}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let t=i.startLevel;-1===t&&(i.config.testBandwidth&&this.levels.length>1?(t=0,this.bitrateTest=!0):t=i.firstAutoLevel),i.nextLoadLevel=t,this.level=i.loadLevel,this._hasEnoughToStart=!!e}n>0&&-1===t&&!e&&(this.log("Override startPosition with lastCurrentTime @".concat(n.toFixed(3))),t=n),this.state=Hp,this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}else this._forceStartLoad=!0,this.state=zp}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Zp:{const{levels:t,level:e}=this,n=null==t?void 0:t[e],i=null==n?void 0:n.details;if(i&&(!i.live||this.levelLastLoaded===n&&!this.waitForLive(n))){if(this.waitForCdnTuneIn(i))break;this.state=Hp;break}if(this.hls.nextLoadLevel!==this.level){this.state=Hp;break}break}case jp:this.checkRetryDate()}this.state===Hp&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var t;super.onTickEnd(),null!=(t=this.media)&&t.readyState&&!1===this.media.seeking&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:t,levelLastLoaded:e,levels:n,media:i}=this;if(null===e||!i&&!this.primaryPrefetch&&(this.startFragRequested||!t.config.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;const r=this.buffering?t.nextLoadLevel:t.loadLevel;if(null==n||!n[r])return;const s=n[r],a=this.getMainFwdBufferInfo();if(null===a)return;const o=this.getLevelDetails();if(o&&this._streamEnded(a,o)){const t={};return 2===this.altAudio&&(t.type="video"),this.hls.trigger(ku.BUFFER_EOS,t),void(this.state=Kp)}if(!this.buffering)return;t.loadLevel!==r&&-1===t.manualLevel&&this.log("Adapting to level ".concat(r," from level ").concat(this.level)),this.level=t.nextLoadLevel=r;const l=s.details;if(!l||this.state===Zp||this.waitForLive(s))return this.level=r,this.state=Zp,void(this.startFragRequested=!1);const c=a.len,u=this.getMaxBufferLength(s.maxBitrate);if(c>=u)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const h=this.backtrackFragment?this.backtrackFragment.start:a.end;let d=this.getNextFragment(h,l);if(this.couldBacktrack&&!this.fragPrevious&&d&&hh(d)&&this.fragmentTracker.getState(d)!==tf){var f;const t=(null!=(f=this.backtrackFragment)?f:d).sn-l.startSN,e=l.fragments[t-1];e&&d.cc===e.cc&&(d=e,this.fragmentTracker.removeFragment(e))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(d&&this.isLoopLoading(d,h)){if(!d.gap){const t=this.audioOnly&&!this.altAudio?oh:lh,e=(t===lh?this.videoBuffer:this.mediaBuffer)||this.media;e&&this.afterBufferFlushed(e,t,Ou)}d=this.getNextFragmentLoopLoading(d,l,a,Ou,u)}d&&(!d.initSegment||d.initSegment.data||this.bitrateTest||(d=d.initSegment),this.loadFragment(d,s,h))}loadFragment(t,e,n){const i=this.fragmentTracker.getState(t);i===Zd||i===$d?hh(t)?this.bitrateTest?(this.log("Fragment ".concat(t.sn," of level ").concat(t.level," is being downloaded to test bitrate and will not be buffered")),this._loadBitrateTestFrag(t,e)):super.loadFragment(t,e,n):this._loadInitSegment(t,e):this.clearTrackerIfNeeded(t)}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,Ou)}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:t,media:e}=this;if(null!=e&&e.readyState){let n;const i=this.getAppendedFrag(e.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const r=this.getLevelDetails();if(null!=r&&r.live){const t=this.getMainFwdBufferInfo();if(!t||t.len<2*r.targetduration)return}if(!e.paused&&t){const e=t[this.hls.nextLoadLevel],i=this.fragLastKbps;n=i&&this.fragCurrent?this.fragCurrent.duration*e.maxBitrate/(1e3*i)+1:0}else n=0;const s=this.getBufferedFrag(e.currentTime+n);if(s){const t=this.followingBufferedFrag(s);if(t){this.abortCurrentFrag();const e=t.maxStartPTS?t.maxStartPTS:t.start,n=t.duration,i=Math.max(s.end,e+Math.min(Math.max(n-this.config.maxFragLookUpTolerance,n*(this.couldBacktrack?.5:.125)),n*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(i,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const t=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,t&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.state){case Vp:case Gp:case jp:case Yp:case Xp:this.state=Hp}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,e){super.flushMainBuffer(t,e,2===this.altAudio?"video":null)}onMediaAttached(t,e){super.onMediaAttached(t,e);const n=e.media;Fp(n,"playing",this.onMediaPlaying),Fp(n,"seeked",this.onMediaSeeked)}onMediaDetaching(t,e){const{media:n}=this;n&&(Up(n,"playing",this.onMediaPlaying),Up(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(t,e);!!e.transferMedia||(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(ku.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(t,e){let n=!1,i=!1;for(let r=0;r<e.levels.length;r++){const t=e.levels[r].audioCodec;t&&(n=n||-1!==t.indexOf("mp4a.40.2"),i=i||-1!==t.indexOf("mp4a.40.5"))}this.audioCodecSwitch=n&&i&&!function(){var t;const e=S_();return"function"===typeof(null==e||null==(t=e.prototype)?void 0:t.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1}onLevelLoading(t,e){const{levels:n}=this;if(!n||this.state!==Hp)return;const i=e.levelInfo;(!i.details||i.details.live&&(this.levelLastLoaded!==i||i.details.expired)||this.waitForCdnTuneIn(i.details))&&(this.state=Zp)}onLevelLoaded(t,e){var n;const{levels:i,startFragRequested:r}=this,s=e.level,a=e.details,o=a.totalduration;if(!i)return void this.warn("Levels were reset while loading level ".concat(s));this.log("Level ".concat(s," loaded [").concat(a.startSN,",").concat(a.endSN,"]").concat(a.lastPartSn?"[part-".concat(a.lastPartSn,"-").concat(a.lastPartIndex,"]"):"",", cc [").concat(a.startCC,", ").concat(a.endCC,"] duration:").concat(o));const l=e.levelInfo,c=this.fragCurrent;!c||this.state!==Gp&&this.state!==jp||c.level!==e.level&&c.loader&&this.abortCurrentFrag();let u=0;if(a.live||null!=(n=l.details)&&n.live){var h;if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;u=this.alignPlaylists(a,l.details,null==(h=this.levelLastLoaded)?void 0:h.details)}if(l.details=a,this.levelLastLoaded=l,r||this.setStartPosition(a,u),this.hls.trigger(ku.LEVEL_UPDATED,{details:a,level:s}),this.state===Zp){if(this.waitForCdnTuneIn(a))return;this.state=Hp}r&&a.live&&this.synchronizeToLiveEdge(a),this.tick()}synchronizeToLiveEdge(t){const{config:e,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,r=this.getLoadPosition(),s=t.fragmentStart,a=t.edge,o=r>=s-e.maxFragLookUpTolerance&&r<=a;if(null!==i&&n.duration>i&&(r<i||!o)){const s=void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:e.liveMaxLatencyDurationCount*t.targetduration;if((!o&&n.readyState<4||r<a-s)&&(this._hasEnoughToStart||(this.nextLoadPosition=i),n.readyState))if(this.warn("Playback: ".concat(r.toFixed(3)," is located too far from the end of live sliding playlist: ").concat(a,", reset currentTime to : ").concat(i.toFixed(3))),"buffered"===this.config.liveSyncMode){var l;const t=bf.bufferInfo(n,i,0);if(null==(l=t.buffered)||!l.length)return void(n.currentTime=i);if(t.start<=r)return void(n.currentTime=i);const{nextStart:e}=bf.bufferedInfo(t.buffered,r,0);e&&(n.currentTime=e)}else n.currentTime=i}}_handleFragmentLoadProgress(t){var e;const n=t.frag,{part:i,payload:r}=t,{levels:s}=this;if(!s)return void this.warn("Levels were reset while fragment load was in progress. Fragment ".concat(n.sn," of level ").concat(n.level," will not be buffered"));const a=s[n.level];if(!a)return void this.warn("Level ".concat(n.level," not found on progress"));const o=a.details;if(!o)return this.warn("Dropping fragment ".concat(n.sn," of level ").concat(n.level," after level details were reset")),void this.fragmentTracker.removeFragment(n);const l=a.videoCodec,c=o.PTSKnown||!o.live,u=null==(e=n.initSegment)?void 0:e.data,h=this._getAudioCodec(a),d=this.transmuxer=this.transmuxer||new Rg(this.hls,Ou,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),f=i?i.index:-1,p=-1!==f,m=new yf(n.level,n.sn,n.stats.chunkCount,r.byteLength,f,p),g=this.initPTS[n.cc];d.push(r,u,h,l,n,i,o.totalduration,c,m,g)}onAudioTrackSwitching(t,e){const n=this.hls,i=0!==this.altAudio;if(Cd(e.url,n))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const t=this.fragCurrent;t&&(this.log("Switching to main audio track, cancel main fragment load"),t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(i)return this.altAudio=0,this.fragmentTracker.removeAllFragments(),n.once(ku.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(ku.AUDIO_TRACK_SWITCHED,e)}),void n.trigger(ku.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});n.trigger(ku.AUDIO_TRACK_SWITCHED,e)}}onAudioTrackSwitched(t,e){const n=Cd(e.url,this.hls);if(n){const t=this.videoBuffer;t&&this.mediaBuffer!==t&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=t)}this.altAudio=n?2:0,this.tick()}onBufferCreated(t,e){const n=e.tracks;let i,r,s=!1;for(const a in n){const t=n[a];if("main"===t.id){if(r=a,i=t,"video"===a){const t=n[a];t&&(this.videoBuffer=t.buffer)}}else s=!0}s&&i?(this.log("Alternate track found, use ".concat(r,".buffered to schedule main fragment loading")),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(t,e){const{frag:n,part:i}=e,r=n.type===Ou;if(r){if(this.fragContextChanged(n))return this.warn("Fragment ".concat(n.sn).concat(i?" p: "+i.index:""," of level ").concat(n.level," finished buffering, but was aborted. state: ").concat(this.state)),void(this.state===Xp&&(this.state=Hp));const t=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*t.total/(t.buffering.end-t.loading.first)),hh(n)&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}const s=this.media;s&&(!this._hasEnoughToStart&&bf.getBuffered(s).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),r&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(t,e){var n;if(e.fatal)this.state=qp;else switch(e.details){case Ru.FRAG_GAP:case Ru.FRAG_PARSING_ERROR:case Ru.FRAG_DECRYPT_ERROR:case Ru.FRAG_LOAD_ERROR:case Ru.FRAG_LOAD_TIMEOUT:case Ru.KEY_LOAD_ERROR:case Ru.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Ou,e);break;case Ru.LEVEL_LOAD_ERROR:case Ru.LEVEL_LOAD_TIMEOUT:case Ru.LEVEL_PARSING_ERROR:e.levelRetry||this.state!==Zp||(null==(n=e.context)?void 0:n.type)!==Du||(this.state=Hp);break;case Ru.BUFFER_ADD_CODEC_ERROR:case Ru.BUFFER_APPEND_ERROR:if("main"!==e.parent)return;this.reduceLengthAndFlushBuffer(e)&&this.resetLoadingState();break;case Ru.BUFFER_FULL_ERROR:if("main"!==e.parent)return;if(this.reduceLengthAndFlushBuffer(e)){!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}break;case Ru.INTERNAL_EXCEPTION:this.recoverWorkerError(e)}}onFragLoadEmergencyAborted(){this.state=Hp,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(t,e){let{type:n}=e;if(n!==oh||!this.altAudio){const t=(n===lh?this.videoBuffer:this.mediaBuffer)||this.media;t&&(this.afterBufferFlushed(t,n,Ou),this.tick())}}onLevelsUpdated(t,e){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,-1===this.level&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=e.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:t}=this;if(!t)return;const e=t.currentTime;let n=this.startPosition;if(n>=0&&e<n){if(t.seeking)return void this.log("could not seek to ".concat(n,", already seeking at ").concat(e));const i=this.timelineOffset;i&&n&&(n+=i);const r=this.getLevelDetails(),s=bf.getBuffered(t),a=s.length?s.start(0):0,o=a-n,l=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||o>0&&(o<l||this.loadingParts&&o<2*((null==r?void 0:r.partTarget)||0)))&&(this.log("adjusting start position by ".concat(o," to match buffer start")),n+=o,this.startPosition=n),e<n&&(this.log("seek to target start position ".concat(n," from current time ").concat(e," buffer start ").concat(a)),t.currentTime=n)}}_getAudioCodec(t){let e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&e&&(this.log("Swapping audio codec"),e=-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),e}_loadBitrateTestFrag(t,e){t.bitrateTest=!0,this._doFragLoad(t,e).then(t=>{const{hls:n}=this,i=null==t?void 0:t.frag;if(!i||this.fragContextChanged(i))return;e.fragmentError=0,this.state=Hp,this.startFragRequested=!1,this.bitrateTest=!1;const r=i.stats;r.parsing.start=r.parsing.end=r.buffering.start=r.buffering.end=self.performance.now(),n.trigger(ku.FRAG_LOADED,t),i.bitrateTest=!1}).catch(e=>{this.state!==zp&&this.state!==qp&&(this.warn(e),this.resetFragmentLoading(t))})}_handleTransmuxComplete(t){const e=this.playlistType,{hls:n}=this,{remuxResult:i,chunkMeta:r}=t,s=this.getCurrentContext(r);if(!s)return void this.resetWhenMissingContext(r);const{frag:a,part:o,level:l}=s,{video:c,text:u,id3:h,initSegment:d}=i,{details:f}=l,p=this.altAudio?void 0:i.audio;if(this.fragContextChanged(a))this.fragmentTracker.removeFragment(a);else{if(this.state=Yp,d){const t=d.tracks;if(t){const i=a.initSegment||a;if(this.unhandledEncryptionError(d,a))return;this._bufferInitSegment(l,t,i,r),n.trigger(ku.FRAG_PARSING_INIT_SEGMENT,{frag:i,id:e,tracks:t})}const i=d.initPTS,s=d.timescale,o=this.initPTS[a.cc];if(Tu(i)&&(!o||o.baseTime!==i||o.timescale!==s)){const t=d.trackId;this.initPTS[a.cc]={baseTime:i,timescale:s,trackId:t},n.trigger(ku.INIT_PTS_FOUND,{frag:a,id:e,initPTS:i,timescale:s,trackId:t})}}if(c&&f){p&&"audiovideo"===c.type&&this.logMuxedErr(a);const t=f.fragments[a.sn-1-f.startSN],e=a.sn===f.startSN,n=!t||a.cc>t.cc;if(!1!==i.independent){const{startPTS:t,endPTS:i,startDTS:s,endDTS:l}=c;if(o)o.elementaryStreams[c.type]={startPTS:t,endPTS:i,startDTS:s,endDTS:l};else if(c.firstKeyFrame&&c.independent&&1===r.id&&!n&&(this.couldBacktrack=!0),c.dropped&&c.independent){const r=this.getMainFwdBufferInfo(),s=(r?r.end:this.getLoadPosition())+this.config.maxBufferHole,o=c.firstKeyFramePTS?c.firstKeyFramePTS:t;if(!e&&s<o-this.config.maxBufferHole&&!n)return void this.backtrack(a);n&&(a.gap=!0),a.setElementaryStreamInfo(c.type,a.start,i,a.start,l,!0)}else e&&t-(f.appliedTimelineOffset||0)>2&&(a.gap=!0);a.setElementaryStreamInfo(c.type,t,i,s,l),this.backtrackFragment&&(this.backtrackFragment=a),this.bufferFragmentData(c,a,o,r,e||n)}else{if(!e&&!n)return void this.backtrack(a);a.gap=!0}}if(p){const{startPTS:t,endPTS:e,startDTS:n,endDTS:i}=p;o&&(o.elementaryStreams[oh]={startPTS:t,endPTS:e,startDTS:n,endDTS:i}),a.setElementaryStreamInfo(oh,t,e,n,i),this.bufferFragmentData(p,a,o,r)}if(f&&null!=h&&h.samples.length){const t={id:e,frag:a,details:f,samples:h.samples};n.trigger(ku.FRAG_PARSING_METADATA,t)}if(f&&u){const t={id:e,frag:a,details:f,samples:u.samples};n.trigger(ku.FRAG_PARSING_USERDATA,t)}}}logMuxedErr(t){this.warn("".concat(hh(t)?"Media":"Init"," segment with muxed audiovideo where only video expected: ").concat(t.url))}_bufferInitSegment(t,e,n,i){if(this.state!==Yp)return;this.audioOnly=!!e.audio&&!e.video,this.altAudio&&!this.audioOnly&&(delete e.audio,e.audiovideo&&this.logMuxedErr(n));const{audio:r,video:s,audiovideo:a}=e;if(r){const n=t.audioCodec;let i=Jh(r.codec,n);"mp4a"===i&&(i="mp4a.40.5");const s=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){i&&(i=-1!==i.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");const t=r.metadata;t&&"channelCount"in t&&1!==(t.channelCount||1)&&-1===s.indexOf("firefox")&&(i="mp4a.40.5")}i&&-1!==i.indexOf("mp4a.40.5")&&-1!==s.indexOf("android")&&"audio/mpeg"!==r.container&&(i="mp4a.40.2",this.log("Android: force audio codec to ".concat(i))),n&&n!==i&&this.log('Swapping manifest audio codec "'.concat(n,'" for "').concat(i,'"')),r.levelCodec=i,r.id=Ou,this.log("Init audio buffer, container:".concat(r.container,", codecs[selected/level/parsed]=[").concat(i||"","/").concat(n||"","/").concat(r.codec,"]")),delete e.audiovideo}if(s){s.levelCodec=t.videoCodec,s.id=Ou;const n=s.codec;if(4===(null==n?void 0:n.length))switch(n){case"hvc1":case"hev1":s.codec="hvc1.1.6.L120.90";break;case"av01":s.codec="av01.0.04M.08";break;case"avc1":s.codec="avc1.42e01e"}this.log("Init video buffer, container:".concat(s.container,", codecs[level/parsed]=[").concat(t.videoCodec||"","/").concat(n,"]").concat(s.codec!==n?" parsed-corrected="+s.codec:"").concat(s.supplemental?" supplemental="+s.supplemental:"")),delete e.audiovideo}a&&(this.log("Init audiovideo buffer, container:".concat(a.container,", codecs[level/parsed]=[").concat(t.codecs,"/").concat(a.codec,"]")),delete e.video,delete e.audio);const o=Object.keys(e);if(o.length){if(this.hls.trigger(ku.BUFFER_CODECS,e),!this.hls)return;o.forEach(t=>{const r=e[t].initSegment;null!=r&&r.byteLength&&this.hls.trigger(ku.BUFFER_APPENDING,{type:t,data:r,frag:n,part:null,chunkMeta:i,parent:n.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const t=this.mediaBuffer&&2===this.altAudio?this.mediaBuffer:this.media;return this.getFwdBufferInfo(t,Ou)}get maxBufferLength(){const{levels:t,level:e}=this,n=null==t?void 0:t[e];return n?this.getMaxBufferLength(n.maxBitrate):this.config.maxBufferLength}backtrack(t){this.couldBacktrack=!0,this.backtrackFragment=t,this.resetTransmuxer(),this.flushBufferGap(t),this.fragmentTracker.removeFragment(t),this.fragPrevious=null,this.nextLoadPosition=t.start,this.state=Hp}checkFragmentChanged(){const t=this.media;let e=null;if(t&&t.readyState>1&&!1===t.seeking){const n=t.currentTime;if(bf.isBuffered(t,n)?e=this.getAppendedFrag(n):bf.isBuffered(t,n+.1)&&(e=this.getAppendedFrag(n+.1)),e){this.backtrackFragment=null;const t=this.fragPlaying,n=e.level;t&&e.sn===t.sn&&t.level===n||(this.fragPlaying=e,this.hls.trigger(ku.FRAG_CHANGED,{frag:e}),t&&t.level===n||this.hls.trigger(ku.LEVEL_SWITCHED,{level:n}))}}}get nextLevel(){const t=this.nextBufferedFrag;return t?t.level:-1}get currentFrag(){var t;if(this.fragPlaying)return this.fragPlaying;const e=(null==(t=this.media)?void 0:t.currentTime)||this.lastCurrentTime;return Tu(e)?this.getAppendedFrag(e):null}get currentProgramDateTime(){var t;const e=(null==(t=this.media)?void 0:t.currentTime)||this.lastCurrentTime;if(Tu(e)){const t=this.getLevelDetails(),n=this.currentFrag||(t?kd(null,t.fragments,e):null);if(n){const t=n.programDateTime;if(null!==t){const i=t+1e3*(e-n.start);return new Date(i)}}}return null}get currentLevel(){const t=this.currentFrag;return t?t.level:-1}get nextBufferedFrag(){const t=this.currentFrag;return t?this.followingBufferedFrag(t):null}get forceStartLoad(){return this._forceStartLoad}}class A_ extends ju{constructor(t,e){super("key-loader",e),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=t}abort(t){for(const n in this.keyIdToKeyInfo){const i=this.keyIdToKeyInfo[n].loader;if(i){var e;if(t&&t!==(null==(e=i.context)?void 0:e.frag.type))return;i.abort()}}}detach(){for(const t in this.keyIdToKeyInfo){const e=this.keyIdToKeyInfo[t];(e.mediaKeySessionContext||e.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[t]}}destroy(){this.detach();for(const t in this.keyIdToKeyInfo){const e=this.keyIdToKeyInfo[t].loader;e&&e.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ru.KEY_LOAD_ERROR,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return new gf({type:Cu.NETWORK_ERROR,details:e,fatal:!1,frag:t,response:r,error:n,networkDetails:i})}loadClear(t,e,n){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(e.length)for(let i=0,r=e.length;i<r;i++){const s=e[i];if(t.cc<=s.cc&&(!hh(t)||!hh(s)||t.sn<s.sn)||!n&&i==r-1)return this.emeController.selectKeySystemFormat(s).then(t=>{if(!this.emeController)return;s.setKeyFormat(t);const e=Xf(t);return e?this.emeController.getKeySystemAccess([e]):void 0})}if(this.config.requireKeySystemAccessOnStart){const t=qf(this.config);if(t.length)return this.emeController.getKeySystemAccess(t)}}return null}load(t){return!t.decryptdata&&t.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(t).then(e=>this.loadInternal(t,e)):this.loadInternal(t)}loadInternal(t,e){var n,i;e&&t.setKeyFormat(e);const r=t.decryptdata;if(!r){const n=new Error(e?"Expected frag.decryptdata to be defined after setting format ".concat(e):"Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ".concat(this.emeController&&this.config.emeEnabled,")"));return Promise.reject(this.createKeyLoadError(t,Ru.KEY_LOAD_ERROR,n))}const s=r.uri;if(!s)return Promise.reject(this.createKeyLoadError(t,Ru.KEY_LOAD_ERROR,new Error('Invalid key URI: "'.concat(s,'"'))));const a=C_(r);let o=this.keyIdToKeyInfo[a];if(null!=(n=o)&&n.decryptdata.key)return r.key=o.decryptdata.key,Promise.resolve({frag:t,keyInfo:o});if(this.emeController&&null!=(i=o)&&i.keyLoadPromise){switch(this.emeController.getKeyStatus(o.decryptdata)){case"usable":case"usable-in-future":return o.keyLoadPromise.then(e=>{const{keyInfo:n}=e;return r.key=n.decryptdata.key,{frag:t,keyInfo:n}})}}switch(this.log("".concat(this.keyIdToKeyInfo[a]?"Rel":"L","oading").concat(r.keyId?" keyId: "+th(r.keyId):""," URI: ").concat(r.uri," from ").concat(t.type," ").concat(t.level)),o=this.keyIdToKeyInfo[a]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===r.keyFormat?this.loadKeyHTTP(o,t):this.loadKeyEME(o,t);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(o,t);default:return Promise.reject(this.createKeyLoadError(t,Ru.KEY_LOAD_ERROR,new Error('Key supplied with unsupported METHOD: "'.concat(r.method,'"'))))}}loadKeyEME(t,e){const n={frag:e,keyInfo:t};if(this.emeController&&this.config.emeEnabled){var i;if(!t.decryptdata.keyId&&null!=(i=e.initSegment)&&i.data){const n=function(t){const e=[];return Lh(t,t=>e.push(t.subarray(8,24))),e}(e.initSegment.data);if(n.length){let e=n[0];e.some(t=>0!==t)?(this.log("Using keyId found in init segment ".concat(th(e))),tp.setKeyIdForUri(t.decryptdata.uri,e)):(e=tp.addKeyIdForUri(t.decryptdata.uri),this.log("Generating keyId to patch media ".concat(th(e)))),t.decryptdata.keyId=e}}if(!t.decryptdata.keyId&&!hh(e))return Promise.resolve(n);const r=this.emeController.loadKey(n);return(t.keyLoadPromise=r.then(e=>(t.mediaKeySessionContext=e,n))).catch(n=>{throw t.keyLoadPromise=null,"data"in n&&(n.data.frag=e),n})}return Promise.resolve(n)}loadKeyHTTP(t,e){const n=this.config,i=new(0,n.loader)(n);return e.keyLoader=t.loader=i,t.keyLoadPromise=new Promise((r,s)=>{const a={keyInfo:t,frag:e,responseType:"arraybuffer",url:t.decryptdata.uri},o=n.keyLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:(t,e,n,i)=>{const{frag:a,keyInfo:o}=n,l=C_(o.decryptdata);if(!a.decryptdata||o!==this.keyIdToKeyInfo[l])return s(this.createKeyLoadError(a,Ru.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),i));o.decryptdata.key=a.decryptdata.key=new Uint8Array(t.data),a.keyLoader=null,o.loader=null,r({frag:a,keyInfo:o})},onError:(t,n,i,r)=>{this.resetLoader(n),s(this.createKeyLoadError(e,Ru.KEY_LOAD_ERROR,new Error("HTTP Error ".concat(t.code," loading key ").concat(t.text)),i,Gu({url:a.url,data:void 0},t)))},onTimeout:(t,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(e,Ru.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),i))},onAbort:(t,n,i)=>{this.resetLoader(n),s(this.createKeyLoadError(e,Ru.INTERNAL_ABORTED,new Error("key loading aborted"),i))}};i.load(a,l,c)})}resetLoader(t){const{frag:e,keyInfo:n,url:i}=t,r=n.loader;e.keyLoader===r&&(e.keyLoader=null,n.loader=null);const s=C_(n.decryptdata)||i;delete this.keyIdToKeyInfo[s],r&&r.destroy()}}function C_(t){if(t.keyFormat!==jf){const e=t.keyId;if(e)return th(e)}return t.uri}function R_(t){const{type:e}=t;switch(e){case Pu:return Nu;case Iu:return Fu;default:return Ou}}function k_(t,e){let n=t.url;return void 0!==n&&0!==n.indexOf("data:")||(n=e.url),n}class L_{constructor(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=t,this.registerListeners()}startLoad(t){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:t}=this;t.on(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.on(ku.LEVEL_LOADING,this.onLevelLoading,this),t.on(ku.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(ku.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.on(ku.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:t}=this;t.off(ku.MANIFEST_LOADING,this.onManifestLoading,this),t.off(ku.LEVEL_LOADING,this.onLevelLoading,this),t.off(ku.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(ku.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.off(ku.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(t){const e=this.hls.config,n=e.pLoader,i=e.loader,r=new(n||i)(e);return this.loaders[t.type]=r,r}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(const t in this.loaders){const e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,e){const{url:n}=e;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Lu,url:n,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(t,e){const{id:n,level:i,pathwayId:r,url:s,deliveryDirectives:a,levelInfo:o}=e;this.load({id:n,level:i,pathwayId:r,responseType:"text",type:Du,url:s,deliveryDirectives:a,levelOrTrack:o})}onAudioTrackLoading(t,e){const{id:n,groupId:i,url:r,deliveryDirectives:s,track:a}=e;this.load({id:n,groupId:i,level:null,responseType:"text",type:Pu,url:r,deliveryDirectives:s,levelOrTrack:a})}onSubtitleTrackLoading(t,e){const{id:n,groupId:i,url:r,deliveryDirectives:s,track:a}=e;this.load({id:n,groupId:i,level:null,responseType:"text",type:Iu,url:r,deliveryDirectives:s,levelOrTrack:a})}onLevelsUpdated(t,e){const n=this.loaders[Du];if(n){const t=n.context;t&&!e.levels.some(e=>e===t.levelOrTrack)&&(n.abort(),delete this.loaders[Du])}}load(t){var e;const n=this.hls.config;let i,r=this.getInternalLoader(t);if(r){const e=this.hls.logger,n=r.context;if(n&&n.levelOrTrack===t.levelOrTrack&&(n.url===t.url||n.deliveryDirectives&&!t.deliveryDirectives))return void(n.url===t.url?e.log("[playlist-loader]: ignore ".concat(t.url," ongoing request")):e.log("[playlist-loader]: ignore ".concat(t.url," in favor of ").concat(n.url)));e.log("[playlist-loader]: aborting previous loader for type: ".concat(t.type)),r.abort()}if(i=t.type===Lu?n.manifestLoadPolicy.default:Hu({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(t),Tu(null==(e=t.deliveryDirectives)?void 0:e.part)){let e;if(t.type===Du&&null!==t.level?e=this.hls.levels[t.level].details:t.type===Pu&&null!==t.id?e=this.hls.audioTracks[t.id].details:t.type===Iu&&null!==t.id&&(e=this.hls.subtitleTracks[t.id].details),e){const t=e.partTarget,n=e.targetduration;if(t&&n){const e=1e3*Math.max(3*t,.8*n);i=Hu({},i,{maxTimeToFirstByteMs:Math.min(e,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(e,i.maxTimeToFirstByteMs)})}}}const s=i.errorRetry||i.timeoutRetry||{},a={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:s.maxNumRetry||0,retryDelay:s.retryDelayMs||0,maxRetryDelay:s.maxRetryDelayMs||0},o={onSuccess:(t,e,n,i)=>{const r=this.getInternalLoader(n);this.resetInternalLoader(n.type);const s=t.data;e.parsing.start=performance.now(),op.isMediaPlaylist(s)||n.type!==Lu?this.handleTrackOrLevelPlaylist(t,e,n,i||null,r):this.handleMasterPlaylist(t,e,n,i)},onError:(t,e,n,i)=>{this.handleNetworkError(e,n,!1,t,i)},onTimeout:(t,e,n)=>{this.handleNetworkError(e,n,!0,void 0,t)}};r.load(t,a,o)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:t,startPosition:e},forceStartLoad:n}=this.hls;(t||n)&&(this.hls.logger.log("".concat(t?"auto":"force"," startLoad with configured startPosition ").concat(e)),this.hls.startLoad(e))}handleMasterPlaylist(t,e,n,i){const r=this.hls,s=t.data,a=k_(t,n),o=op.parseMasterPlaylist(s,a);if(o.playlistParsingError)return e.parsing.end=performance.now(),void this.handleManifestParsingError(t,n,o.playlistParsingError,i,e);const{contentSteering:l,levels:c,sessionData:u,sessionKeys:h,startTimeOffset:d,variableList:f}=o;this.variableList=f,c.forEach(t=>{const{unknownCodecs:e}=t;if(e){const{preferManagedMediaSource:n}=this.hls.config;let{audioCodec:i,videoCodec:r}=t;for(let s=e.length;s--;){const a=e[s];jh(a,"audio",n)?(t.audioCodec=i=i?"".concat(i,",").concat(a):a,Vh.audio[i.substring(0,4)]=2,e.splice(s,1)):jh(a,"video",n)&&(t.videoCodec=r=r?"".concat(r,",").concat(a):a,Vh.video[r.substring(0,4)]=2,e.splice(s,1))}}});const{AUDIO:p=[],SUBTITLES:m,"CLOSED-CAPTIONS":g}=op.parseMasterPlaylistMedia(s,a,o);if(p.length){p.some(t=>!t.url)||!c[0].audioCodec||c[0].attrs.AUDIO||(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Cf({}),bitrate:0,url:""}))}r.trigger(ku.MANIFEST_LOADED,{levels:c,audioTracks:p,subtitles:m,captions:g,contentSteering:l,url:a,stats:e,networkDetails:i,sessionData:u,sessionKeys:h,startTimeOffset:d,variableList:f})}handleTrackOrLevelPlaylist(t,e,n,i,r){const s=this.hls,{id:a,level:o,type:l}=n,c=k_(t,n),u=Tu(o)?o:Tu(a)?a:0,h=R_(n),d=op.parseLevelPlaylist(t.data,c,u,h,0,this.variableList);if(l===Lu){const t={attrs:new Cf({}),bitrate:0,details:d,name:"",url:c};d.requestScheduled=e.loading.start+Tp(d,0),s.trigger(ku.MANIFEST_LOADED,{levels:[t],audioTracks:[],url:c,stats:e,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}e.parsing.end=performance.now(),n.levelDetails=d,this.handlePlaylistLoaded(d,t,e,n,i,r)}handleManifestParsingError(t,e,n,i,r){this.hls.trigger(ku.ERROR,{type:Cu.NETWORK_ERROR,details:Ru.MANIFEST_PARSING_ERROR,fatal:e.type===Lu,url:t.url,err:n,error:n,reason:n.message,response:t,context:e,networkDetails:i,stats:r})}handleNetworkError(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s="A network ".concat(n?"timeout":"error"+(i?" (status "+i.code+")":"")," occurred while loading ").concat(t.type);t.type===Du?s+=": ".concat(t.level," id: ").concat(t.id):t.type!==Pu&&t.type!==Iu||(s+=" id: ".concat(t.id,' group-id: "').concat(t.groupId,'"'));const a=new Error(s);this.hls.logger.warn("[playlist-loader]: ".concat(s));let o=Ru.UNKNOWN,l=!1;const c=this.getInternalLoader(t);switch(t.type){case Lu:o=n?Ru.MANIFEST_LOAD_TIMEOUT:Ru.MANIFEST_LOAD_ERROR,l=!0;break;case Du:o=n?Ru.LEVEL_LOAD_TIMEOUT:Ru.LEVEL_LOAD_ERROR,l=!1;break;case Pu:o=n?Ru.AUDIO_TRACK_LOAD_TIMEOUT:Ru.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case Iu:o=n?Ru.SUBTITLE_TRACK_LOAD_TIMEOUT:Ru.SUBTITLE_LOAD_ERROR,l=!1}c&&this.resetInternalLoader(t.type);const u={type:Cu.NETWORK_ERROR,details:o,fatal:l,url:t.url,loader:c,context:t,error:a,networkDetails:e,stats:r};if(i){const n=(null==e?void 0:e.url)||t.url;u.response=Gu({url:n,data:void 0},i)}this.hls.trigger(ku.ERROR,u)}handlePlaylistLoaded(t,e,n,i,r,s){const a=this.hls,{type:o,level:l,levelOrTrack:c,id:u,groupId:h,deliveryDirectives:d}=i,f=k_(e,i),p=R_(i);let m="number"===typeof i.level&&p===Ou?l:void 0;const g=t.playlistParsingError;if(g){if(this.hls.logger.warn("".concat(g," ").concat(t.url)),!a.config.ignorePlaylistParsingErrors)return void a.trigger(ku.ERROR,{type:Cu.NETWORK_ERROR,details:Ru.LEVEL_PARSING_ERROR,fatal:!1,url:f,error:g,reason:g.message,response:e,context:i,level:m,parent:p,networkDetails:r,stats:n});t.playlistParsingError=null}if(!t.fragments.length){const s=t.playlistParsingError=new Error("No Segments found in Playlist");return void a.trigger(ku.ERROR,{type:Cu.NETWORK_ERROR,details:Ru.LEVEL_EMPTY_ERROR,fatal:!1,url:f,error:s,reason:s.message,response:e,context:i,level:m,parent:p,networkDetails:r,stats:n})}switch(t.live&&s&&(s.getCacheAge&&(t.ageHeader=s.getCacheAge()||0),s.getCacheAge&&!isNaN(t.ageHeader)||(t.ageHeader=0)),o){case Lu:case Du:if(m)if(c){if(c!==a.levels[m]){const t=a.levels.indexOf(c);t>-1&&(m=t)}}else m=0;a.trigger(ku.LEVEL_LOADED,{details:t,levelInfo:c||a.levels[0],level:m||0,id:u||0,stats:n,networkDetails:r,deliveryDirectives:d,withoutMultiVariant:o===Lu});break;case Pu:a.trigger(ku.AUDIO_TRACK_LOADED,{details:t,track:c,id:u||0,groupId:h||"",stats:n,networkDetails:r,deliveryDirectives:d});break;case Iu:a.trigger(ku.SUBTITLE_TRACK_LOADED,{details:t,track:c,id:u||0,groupId:h||"",stats:n,networkDetails:r,deliveryDirectives:d})}}}class D_{static get version(){return sm}static isMSESupported(){return T_()}static isSupported(){return function(){if(!T_())return!1;const t=Zu();return"function"===typeof(null==t?void 0:t.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>t.isTypeSupported(Yh(e,"video")))||["mp4a.40.2","fLaC"].some(e=>t.isTypeSupported(Yh(e,"audio"))))}()}static getMediaSource(){return Zu()}static get Events(){return ku}static get MetadataSchema(){return Cm}static get ErrorTypes(){return Cu}static get ErrorDetails(){return Ru}static get DefaultConfig(){return D_.defaultConfig?D_.defaultConfig:u_}static set DefaultConfig(t){D_.defaultConfig=t}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new rm,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const e=this.logger=function(t,e,n){const i=Xu();if("object"===typeof console&&!0===t||"object"===typeof t){const r=["debug","log","info","warn","error"];r.forEach(e=>{i[e]=Ku(e,t,n)});try{i.log('Debug logs enabled for "'.concat(e,'" in hls.js version ',"1.6.15"))}catch(Wq){return Xu()}r.forEach(e=>{qu[e]=Ku(e,t)})}else Hu(qu,i);return i}(t.debug||!1,"Hls instance",t.assetPlayerId),n=this.config=function(t,e,n){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==e.liveMaxLatencyDurationCount&&(void 0===e.liveSyncDurationCount||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==e.liveMaxLatencyDuration&&(void 0===e.liveSyncDuration||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=h_(t),r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach(t=>{const s="".concat("level"===t?"playlist":t,"LoadPolicy"),a=void 0===e[s],o=[];r.forEach(n=>{const r="".concat(t,"Loading").concat(n),l=e[r];if(void 0!==l&&a){o.push(r);const t=i[s].default;switch(e[s]={default:t},n){case"TimeOut":t.maxLoadTimeMs=l,t.maxTimeToFirstByteMs=l;break;case"MaxRetry":t.errorRetry.maxNumRetry=l,t.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":t.errorRetry.retryDelayMs=l,t.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":t.errorRetry.maxRetryDelayMs=l,t.timeoutRetry.maxRetryDelayMs=l}}}),o.length&&n.warn('hls.js config: "'.concat(o.join('", "'),'" setting(s) are deprecated, use "').concat(s,'": ').concat(bd(e[s])))}),Gu(Gu({},i),e)}(D_.DefaultConfig,t,e);this.userConfig=t,n.progressive&&d_(n,e);const{abrController:i,bufferController:r,capLevelController:s,errorController:a,fpsController:o}=n,l=new a(this),c=this.abrController=new i(this),u=new ef(this),h=n.interstitialsController,d=h?this.interstitialsController=new h(this,D_):null,f=this.bufferController=new r(this,u),p=this.capLevelController=new s(this),m=new o(this),g=new L_(this),v=n.contentSteeringController,y=v?new v(this):null,_=this.levelController=new E_(this,y),b=new b_(this),x=new A_(this.config,this.logger),E=this.streamController=new M_(this,u,x),w=this.gapController=new f_(this,u);p.setStreamController(E),m.setStreamController(E);const S=[g,_,E];d&&S.splice(1,0,d),y&&S.splice(1,0,y),this.networkControllers=S;const T=[c,f,w,p,m,b,u];this.audioTrackController=this.createController(n.audioTrackController,S);const M=n.audioStreamController;M&&S.push(this.audioStreamController=new M(this,u,x)),this.subtitleTrackController=this.createController(n.subtitleTrackController,S);const A=n.subtitleStreamController;A&&S.push(this.subtititleStreamController=new A(this,u,x)),this.createController(n.timelineController,T),x.emeController=this.emeController=this.createController(n.emeController,T),this.cmcdController=this.createController(n.cmcdController,T),this.latencyController=this.createController(x_,T),this.coreComponents=T,S.push(l);const C=l.onErrorOut;"function"===typeof C&&this.on(ku.ERROR,C,l),this.on(ku.MANIFEST_LOADED,g.onManifestLoaded,g)}createController(t,e){if(t){const n=new t(this);return e&&e.push(n),n}return null}on(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;this._emitter.on(t,e,n)}once(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;this._emitter.once(t,e,n)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,i=arguments.length>3?arguments[3]:void 0;this._emitter.off(t,e,n,i)}listeners(t){return this._emitter.listeners(t)}emit(t,e,n){return this._emitter.emit(t,e,n)}trigger(t,e){if(this.config.debug)return this.emit(t,t,e);try{return this.emit(t,t,e)}catch(CO){if(this.logger.error("An internal error happened while handling event "+t+'. Error message: "'+CO.message+'". Here is a stacktrace:',CO),!this.triggeringException){this.triggeringException=!0;const n=t===ku.ERROR;this.trigger(ku.ERROR,{type:Cu.OTHER_ERROR,details:Ru.INTERNAL_EXCEPTION,fatal:n,event:t,error:CO}),this.triggeringException=!1}}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){this.logger.log("destroy"),this.trigger(ku.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){if(!t||"media"in t&&!t.media){const e=new Error("attachMedia failed: invalid argument (".concat(t,")"));return void this.trigger(ku.ERROR,{type:Cu.OTHER_ERROR,details:Ru.ATTACH_MEDIA_ERROR,fatal:!0,error:e})}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const e="media"in t,n=e?t.media:t,i=e?t:{media:n};this._media=n,this.trigger(ku.MEDIA_ATTACHING,i)}detachMedia(){this.logger.log("detachMedia"),this.trigger(ku.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const t=this.bufferController.transferMedia();return this.trigger(ku.MEDIA_DETACHING,{transferMedia:t}),t}loadSource(t){this.stopLoad();const e=this.media,n=this._url,i=this._url=sh.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log("loadSource:".concat(i)),e&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(e)),this.trigger(ku.MANIFEST_LOADING,{url:t})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,e=arguments.length>1?arguments[1]:void 0;this.logger.log("startLoad(".concat(t+(e?", <skip seek to start>":""),")")),this.started=!0,this.resumeBuffering();for(let n=0;n<this.networkControllers.length&&(this.networkControllers[n].startLoad(t,e),this.started&&this.networkControllers);n++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].stopLoad(),!this.started&&this.networkControllers);t++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(t=>{t.resumeBuffering&&t.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(t=>{t.pauseBuffering&&t.pauseBuffering()}))}get inFlightFragments(){const t={[Ou]:this.streamController.inFlightFrag};return this.audioStreamController&&(t[Nu]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(t[Fu]=this.subtititleStreamController.inFlightFrag),t}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const t=this._media,e=null==t?void 0:t.currentTime;this.detachMedia(),t&&(this.attachMedia(t),e&&this.startLoad(e))}removeLevel(t){this.levelController.removeLevel(t)}get sessionId(){let t=this._sessionId;return t||(t=this._sessionId=function(){try{return crypto.randomUUID()}catch(CO){try{const t=URL.createObjectURL(new Blob),e=t.toString();return URL.revokeObjectURL(t),e.slice(e.lastIndexOf("/")+1)}catch(CO){let e=(new Date).getTime();const n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return n}}}()),t}get levels(){const t=this.levelController.levels;return t||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){this.logger.log("set currentLevel:".concat(t)),this.levelController.manualLevel=t,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){this.logger.log("set nextLevel:".concat(t)),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){this.logger.log("set loadLevel:".concat(t)),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){this.logger.log("set firstLevel:".concat(t)),this.levelController.firstLevel=t}get startLevel(){const t=this.levelController.startLevel;return-1===t&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:t}set startLevel(t){this.logger.log("set startLevel:".concat(t)),-1!==t&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){const e=!!t;e!==this.config.capLevelToPlayerSize&&(e?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=e)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}set bandwidthEstimate(t){this.abrController.resetEstimator(t)}get abrEwmaDefaultEstimate(){const{bwEstimator:t}=this.abrController;return t?t.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(this.logger.log("set autoLevelCapping:".concat(t)),this._autoLevelCapping=t,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){(function(t){return ud.indexOf(t)>-1})(t)&&this._maxHdcpLevel!==t&&(this._maxHdcpLevel=t,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:t,config:{minAutoBitrate:e}}=this;if(!t)return 0;const n=t.length;for(let i=0;i<n;i++)if(t[i].maxBitrate>=e)return i;return 0}get maxAutoLevel(){const{levels:t,autoLevelCapping:e,maxHdcpLevel:n}=this;let i;if(i=-1===e&&null!=t&&t.length?t.length-1:e,n)for(let r=i;r--;){const e=t[r].attrs["HDCP-LEVEL"];if(e&&e<=n)return r}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(t){this.abrController.nextAutoLevel=t}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(t){var e;return(null==(e=this.audioTrackController)?void 0:e.setAudioOption(t))||null}setSubtitleOption(t){var e;return(null==(e=this.subtitleTrackController)?void 0:e.setSubtitleOption(t))||null}get allAudioTracks(){const t=this.audioTrackController;return t?t.allAudioTracks:[]}get audioTracks(){const t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){const t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){const e=this.audioTrackController;e&&(e.audioTrack=t)}get allSubtitleTracks(){const t=this.subtitleTrackController;return t?t.allSubtitleTracks:[]}get subtitleTracks(){const t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){const t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){const e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}get subtitleDisplay(){const t=this.subtitleTrackController;return!!t&&t.subtitleDisplay}set subtitleDisplay(t){const e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(t){this.latencyController.targetLatency=t}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(t){this.levelController.pathwayPriority=t}get bufferedToEnd(){var t;return!(null==(t=this.bufferController)||!t.bufferedToEnd)}get interstitialsManager(){var t;return(null==(t=this.interstitialsController)?void 0:t.interstitialsManager)||null}getMediaDecodingInfo(t){return od(t,Ed(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.allAudioTracks),navigator.mediaCapabilities)}}D_.defaultConfig=void 0;const P_=["className","name","rotate","size"],I_=t=>{let{className:e,name:n,rotate:i=0,size:r=27}=t;d(t,P_);return(0,m.jsx)("img",{className:e,style:{transform:"rotate(".concat(i,"deg)"),transition:"0.5s"},width:r+"px",height:r+"px",src:"/svg/".concat(n,".svg"),alt:"?"})};Sr.registerPlugin(mu);const O_=t=>{let{scrollerRef:e}=t;const n=(0,i.useRef)(null),r=(0,i.useRef)(null),s=(0,i.useContext)(S),a=(0,i.useContext)(E),o=(0,i.useRef)(null);return(0,i.useEffect)(()=>{if(D_.isSupported()&&o.current){const t=new D_;t.loadSource("/hls/index.m3u8"),t.attachMedia(o.current)}else o.current&&o.current.canPlayType("application/vnd.apple.mpegurl")&&(o.current.src="/hls/index.m3u8")},[o.current]),(0,i.useEffect)(()=>{Sr.to(r.current,{scrollTrigger:{trigger:n.current,scroller:e.current,start:"top top",end:"bottom top",scrub:!0},backgroundPosition:"center 100%"}),Sr.timeline({scrollTrigger:{trigger:n.current,scroller:e.current,start:"top -10%",scrub:!1,onEnter:()=>{a[1]("home")},onLeaveBack:()=>{a[1]("hidden")}}})},[e]),(0,m.jsx)("section",{ref:n,className:Qa,children:(0,m.jsxs)("div",{ref:r,className:"".concat(io),children:[(0,m.jsx)("video",{ref:o,autoPlay:!0,muted:!0,loop:!0,playsInline:!0,className:ro}),(0,m.jsx)("div",{className:"".concat(no)}),(0,m.jsxs)("header",{className:"".concat($a),children:[(0,m.jsxs)("div",{className:to,children:[(0,m.jsx)(F,{className:Ja}),(0,m.jsxs)("nav",{className:Za,children:[(0,m.jsx)(v,{active:!1,title:"\u041e \u043d\u0430\u0441",onClick:()=>s[1]("about")}),(0,m.jsx)(v,{active:!1,title:"\u041d\u043e\u043c\u0435\u0440\u0430",onClick:()=>s[1]("price")})]})]}),(0,m.jsx)("div",{className:eo,children:(0,m.jsx)(x,{title:"\u041f\u043e\u0434\u0430\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443",onClick:()=>{}})})]}),(0,m.jsx)("div",{className:so,children:(0,m.jsxs)("div",{className:ao,children:[(0,m.jsx)("span",{className:oo,children:"\u0416\u0418\u0412\u0418 \u0422\u0410\u041c, \u0413\u0414\u0415 \u041d\u0410\u0427\u0418\u041d\u0410\u0415\u0422\u0421\u042f \u0411\u0423\u0414\u0423\u0429\u0415\u0415"}),(0,m.jsx)("div",{className:lo,children:"\u041a\u043e\u043b\u0438\u0432\u0438\u043d\u0433\u0438 \u0418\u0422-\u043a\u0430\u043c\u043f\u0443\u0441\u0430 \xab\u041d\u0415\u0419\u041c\u0410\u0420\u041a\xbb \u2014 \u044d\u0442\u043e \u0441\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0435 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e \u0434\u043b\u044f \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u043e\u0432 \u0418\u0422-\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0439, \u0438\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0438 \u043c\u043e\u043b\u043e\u0434\u044b\u0445 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0441\u0442\u043e\u0432, \u0433\u0434\u0435 \u0432\u0441\u0451 \u0441\u043e\u0437\u0434\u0430\u043d\u043e \u0434\u043b\u044f \u0444\u043e\u043a\u0443\u0441\u0430 \u043d\u0430 \u0443\u0447\u0451\u0431\u0435, \u0438\u0434\u0435\u044f\u0445 \u0438 \u043b\u0438\u0447\u043d\u043e\u043c \u0440\u0430\u0437\u0432\u0438\u0442\u0438\u0438"}),(0,m.jsx)(I_,{name:"double-arrow",size:30})]})})]})})},N_={main:"AboutComponent_main__dtRxZ",animate_before_first:"AboutComponent_animate_before_first__kG1yt",animate_before_second:"AboutComponent_animate_before_second__qKXUq",animate:"AboutComponent_animate__jQFOH",animated_block:"AboutComponent_animated_block__y4BDs",hint_span:"AboutComponent_hint_span__rOvBe",description_section:"AboutComponent_description_section__ALXjd",word:"AboutComponent_word__5YsVW",content:"AboutComponent_content__4GnI5",image_small:"AboutComponent_image_small__WFM6+",image_medium:"AboutComponent_image_medium__ebGy3",content_text:"AboutComponent_content_text__5ObK0",content_image_left:"AboutComponent_content_image_left__k+4Si",content_image_right:"AboutComponent_content_image_right__LUp+j",text_title:"AboutComponent_text_title__SSUCM",text_paragraph:"AboutComponent_text_paragraph__rFKNR",header_about:"AboutComponent_header_about__v79EU",text_header_animated:"AboutComponent_text_header_animated__KQpdh",embla__slide:"AboutComponent_embla__slide__pa9dY",buttons:"AboutComponent_buttons__49h8x",button:"AboutComponent_button__4ROb7",embla:"AboutComponent_embla__ejHZl",embla__container:"AboutComponent_embla__container__-nVBz",animated_text_words:"AboutComponent_animated_text_words__HTyCv"};function F_(t){return function(t){return"[object Object]"===Object.prototype.toString.call(t)}(t)||Array.isArray(t)}function U_(t,e){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;return JSON.stringify(Object.keys(t.breakpoints||{}))===JSON.stringify(Object.keys(e.breakpoints||{}))&&n.every(n=>{const i=t[n],r=e[n];return"function"===typeof i?"".concat(i)==="".concat(r):F_(i)&&F_(r)?U_(i,r):i===r})}function B_(t){return t.concat().sort((t,e)=>t.name>e.name?1:-1).map(t=>t.options)}function z_(t){return"number"===typeof t}function H_(t){return"string"===typeof t}function V_(t){return"boolean"===typeof t}function G_(t){return"[object Object]"===Object.prototype.toString.call(t)}function j_(t){return Math.abs(t)}function W_(t){return Math.sign(t)}function Y_(t,e){return j_(t-e)}function X_(t){return J_(t).map(Number)}function K_(t){return t[q_(t)]}function q_(t){return Math.max(0,t.length-1)}function Q_(t,e){return e===q_(t)}function Z_(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Array.from(Array(t),(t,n)=>e+n)}function J_(t){return Object.keys(t)}function $_(t,e){return[t,e].reduce((t,e)=>(J_(e).forEach(n=>{const i=t[n],r=e[n],s=G_(i)&&G_(r);t[n]=s?$_(i,r):r}),t),{})}function tb(t,e){return"undefined"!==typeof e.MouseEvent&&t instanceof e.MouseEvent}function eb(){let t=[];const e={add:function(n,i,r){let s,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{passive:!0};if("addEventListener"in n)n.addEventListener(i,r,a),s=()=>n.removeEventListener(i,r,a);else{const t=n;t.addListener(r),s=()=>t.removeListener(r)}return t.push(s),e},clear:function(){t=t.filter(t=>t())}};return e}function nb(t,e,n,i){const r=eb(),s=1e3/60;let a=null,o=0,l=0;function c(t){if(!l)return;a||(a=t,n(),n());const r=t-a;for(a=t,o+=r;o>=s;)n(),o-=s;i(o/s),l&&(l=e.requestAnimationFrame(c))}function u(){e.cancelAnimationFrame(l),a=null,o=0,l=0}return{init:function(){r.add(t,"visibilitychange",()=>{t.hidden&&(a=null,o=0)})},destroy:function(){u(),r.clear()},start:function(){l||(l=e.requestAnimationFrame(c))},stop:u,update:n,render:i}}function ib(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=j_(t-e);function i(e){return e<t}function r(t){return t>e}function s(t){return i(t)||r(t)}return{length:n,max:e,min:t,constrain:function(n){return s(n)?i(n)?t:e:n},reachedAny:s,reachedMax:r,reachedMin:i,removeOffset:function(t){return n?t-n*Math.ceil((t-e)/n):t}}}function rb(t,e,n){const{constrain:i}=ib(0,t),r=t+1;let s=a(e);function a(t){return n?j_((r+t)%r):i(t)}function o(){return s}function l(){return rb(t,o(),n)}const c={get:o,set:function(t){return s=a(t),c},add:function(t){return l().set(o()+t)},clone:l};return c}function sb(t,e,n,i,r,s,a,o,l,c,u,h,d,f,p,m,g,v,y){const{cross:_,direction:b}=t,x=["INPUT","SELECT","TEXTAREA"],E={passive:!1},w=eb(),S=eb(),T=ib(50,225).constrain(f.measure(20)),M={mouse:300,touch:400},A={mouse:500,touch:600},C=p?43:25;let R=!1,k=0,L=0,D=!1,P=!1,I=!1,O=!1;function N(t){if(!tb(t,i)&&t.touches.length>=2)return F(t);const e=s.readPoint(t),n=s.readPoint(t,_),a=Y_(e,k),l=Y_(n,L);if(!P&&!O){if(!t.cancelable)return F(t);if(P=a>l,!P)return F(t)}const u=s.pointerMove(t);a>m&&(I=!0),c.useFriction(.3).useDuration(.75),o.start(),r.add(b(u)),t.preventDefault()}function F(t){const e=u.byDistance(0,!1).index!==h.get(),n=s.pointerUp(t)*(p?A:M)[O?"mouse":"touch"],i=function(t,e){const n=h.add(-1*W_(t)),i=u.byDistance(t,!p).distance;return p||j_(t)<T?i:g&&e?.5*i:u.byIndex(n.get(),0).distance}(b(n),e),r=function(t,e){if(0===t||0===e)return 0;if(j_(t)<=j_(e))return 0;const n=Y_(j_(t),j_(e));return j_(n/t)}(n,i),a=C-10*r,o=v+r/50;P=!1,D=!1,S.clear(),c.useDuration(a).useFriction(o),l.distance(i,!p),O=!1,d.emit("pointerUp")}function U(t){I&&(t.stopPropagation(),t.preventDefault(),I=!1)}return{init:function(t){if(!y)return;function o(o){(V_(y)||y(t,o))&&function(t){const o=tb(t,i);if(O=o,I=p&&o&&!t.buttons&&R,R=Y_(r.get(),a.get())>=2,o&&0!==t.button)return;if(function(t){const e=t.nodeName||"";return x.includes(e)}(t.target))return;D=!0,s.pointerDown(t),c.useFriction(0).useDuration(0),r.set(a),function(){const t=O?n:e;S.add(t,"touchmove",N,E).add(t,"touchend",F).add(t,"mousemove",N,E).add(t,"mouseup",F)}(),k=s.readPoint(t),L=s.readPoint(t,_),d.emit("pointerDown")}(o)}const l=e;w.add(l,"dragstart",t=>t.preventDefault(),E).add(l,"touchmove",()=>{},E).add(l,"touchend",()=>{}).add(l,"touchstart",o).add(l,"mousedown",o).add(l,"touchcancel",F).add(l,"contextmenu",F).add(l,"click",U,!0)},destroy:function(){w.clear(),S.clear()},pointerDown:function(){return D}}}function ab(t,e){let n,i;function r(t){return t.timeStamp}function s(n,i){const r=i||t.scroll,s="client".concat("x"===r?"X":"Y");return(tb(n,e)?n:n.touches[0])[s]}return{pointerDown:function(t){return n=t,i=t,s(t)},pointerMove:function(t){const e=s(t)-s(i),a=r(t)-r(n)>170;return i=t,a&&(n=t),e},pointerUp:function(t){if(!n||!i)return 0;const e=s(i)-s(n),a=r(t)-r(n),o=r(t)-r(i)>170,l=e/a;return a&&!o&&j_(l)>.1?l:0},readPoint:s}}function ob(t,e,n,i,r,s,a){const o=[t].concat(i);let l,c,u=[],h=!1;function d(t){return r.measureSize(a.measure(t))}return{init:function(r){s&&(c=d(t),u=i.map(d),l=new ResizeObserver(n=>{(V_(s)||s(r,n))&&function(n){for(const s of n){if(h)return;const n=s.target===t,a=i.indexOf(s.target),o=n?c:u[a];if(j_(d(n?t:i[a])-o)>=.5){r.reInit(),e.emit("resize");break}}}(n)}),n.requestAnimationFrame(()=>{o.forEach(t=>l.observe(t))}))},destroy:function(){h=!0,l&&l.disconnect()}}}function lb(t,e,n,i,r){const s=r.measure(10),a=r.measure(50),o=ib(.1,.99);let l=!1;function c(){return!l&&(!!t.reachedAny(n.get())&&!!t.reachedAny(e.get()))}return{shouldConstrain:c,constrain:function(r){if(!c())return;const l=t.reachedMin(e.get())?"min":"max",u=j_(t[l]-e.get()),h=n.get()-e.get(),d=o.constrain(u/a);n.subtract(h*d),!r&&j_(h)<s&&(n.set(t.constrain(n.get())),i.useDuration(25).useBaseFriction())},toggleActive:function(t){l=!t}}}function cb(t,e,n,i){const r=e.min+.1,s=e.max+.1,{reachedMin:a,reachedMax:o}=ib(r,s);return{loop:function(e){if(!function(t){return 1===t?o(n.get()):-1===t&&a(n.get())}(e))return;const r=t*(-1*e);i.forEach(t=>t.add(r))}}}function ub(t,e,n,i,r){const{reachedAny:s,removeOffset:a,constrain:o}=i;function l(t){return t.concat().sort((t,e)=>j_(t)-j_(e))[0]}function c(e,i){const r=[e,e+n,e-n];if(!t)return e;if(!i)return l(r);const s=r.filter(t=>W_(t)===i);return s.length?l(s):K_(r)-n}const u={byDistance:function(n,i){const l=r.get()+n,{index:u,distance:h}=function(n){const i=t?a(n):o(n),r=e.map((t,e)=>({diff:c(t-i,0),index:e})).sort((t,e)=>j_(t.diff)-j_(e.diff)),{index:s}=r[0];return{index:s,distance:i}}(l),d=!t&&s(l);return!i||d?{index:u,distance:n}:{index:u,distance:n+c(e[u]-h,0)}},byIndex:function(t,n){return{index:t,distance:c(e[t]-r.get(),n)}},shortcut:c};return u}function hb(t,e,n,i,r,s,a,o){const l={passive:!0,capture:!0};let c=0;function u(t){"Tab"===t.code&&(c=(new Date).getTime())}const h={init:function(h){o&&(s.add(document,"keydown",u,!1),e.forEach((e,u)=>{s.add(e,"focus",e=>{(V_(o)||o(h,e))&&function(e){if((new Date).getTime()-c>10)return;a.emit("slideFocusStart"),t.scrollLeft=0;const s=n.findIndex(t=>t.includes(e));z_(s)&&(r.useDuration(0),i.index(s,0),a.emit("slideFocus"))}(u)},l)}))}};return h}function db(t){let e=t;function n(t){return z_(t)?t:t.get()}return{get:function(){return e},set:function(t){e=n(t)},add:function(t){e+=n(t)},subtract:function(t){e-=n(t)}}}function fb(t,e){const n="x"===t.scroll?function(t){return"translate3d(".concat(t,"px,0px,0px)")}:function(t){return"translate3d(0px,".concat(t,"px,0px)")},i=e.style;let r=null,s=!1;return{clear:function(){s||(i.transform="",e.getAttribute("style")||e.removeAttribute("style"))},to:function(e){if(s)return;const a=(o=t.direction(e),Math.round(100*o)/100);var o;a!==r&&(i.transform=n(a),r=a)},toggleActive:function(t){s=!t}}}function pb(t,e,n,i,r,s,a,o,l){const c=X_(r),u=X_(r).reverse(),h=function(){const t=a[0];return p(f(u,t),n,!1)}().concat(function(){const t=e-a[0]-1;return p(f(c,t),-n,!0)}());function d(t,e){return t.reduce((t,e)=>t-r[e],e)}function f(t,e){return t.reduce((t,n)=>d(t,e)>0?t.concat([n]):t,[])}function p(r,a,c){const u=function(t){return s.map((n,r)=>({start:n-i[r]+.5+t,end:n+e-.5+t}))}(a);return r.map(e=>{const i=c?0:-n,r=c?n:0,s=c?"end":"start",a=u[e][s];return{index:e,loopPoint:a,slideLocation:db(-1),translate:fb(t,l[e]),target:()=>o.get()>a?i:r}})}const m={canLoop:function(){return h.every(t=>{let{index:n}=t;return d(c.filter(t=>t!==n),e)<=.1})},clear:function(){h.forEach(t=>t.translate.clear())},loop:function(){h.forEach(t=>{const{target:e,translate:n,slideLocation:i}=t,r=e();r!==i.get()&&(n.to(r),i.set(r))})},loopPoints:h};return m}function mb(t,e,n){let i,r=!1;return{init:function(s){n&&(i=new MutationObserver(t=>{r||(V_(n)||n(s,t))&&function(t){for(const n of t)if("childList"===n.type){s.reInit(),e.emit("slidesChanged");break}}(t)}),i.observe(t,{childList:!0}))},destroy:function(){i&&i.disconnect(),r=!0}}}function gb(t,e,n,i){const r={};let s,a=null,o=null,l=!1;const c={init:function(){s=new IntersectionObserver(t=>{l||(t.forEach(t=>{const n=e.indexOf(t.target);r[n]=t}),a=null,o=null,n.emit("slidesInView"))},{root:t.parentElement,threshold:i}),e.forEach(t=>s.observe(t))},destroy:function(){s&&s.disconnect(),l=!0},get:function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(t&&a)return a;if(!t&&o)return o;const e=function(t){return J_(r).reduce((e,n)=>{const i=parseInt(n),{isIntersecting:s}=r[i];return(t&&s||!t&&!s)&&e.push(i),e},[])}(t);return t&&(a=e),t||(o=e),e}};return c}function vb(t,e,n,i,r,s,a,o,l){const{startEdge:c,endEdge:u,direction:h}=t,d=z_(n);const f={groupSlides:function(t){return d?function(t,e){return X_(t).filter(t=>t%e===0).map(n=>t.slice(n,n+e))}(t,n):function(t){return t.length?X_(t).reduce((n,d,f)=>{const p=K_(n)||0,m=0===p,g=d===q_(t),v=r[c]-s[p][c],y=r[c]-s[d][u],_=!i&&m?h(a):0,b=j_(y-(!i&&g?h(o):0)-(v+_));return f&&b>e+l&&n.push(d),g&&n.push(t.length),n},[]).map((e,n,i)=>{const r=Math.max(i[n-1]||0);return t.slice(r,e)}):[]}(t)}};return f}function yb(t,e,n,i,r,s,a){const{align:o,axis:l,direction:c,startIndex:u,loop:h,duration:d,dragFree:f,dragThreshold:p,inViewThreshold:m,slidesToScroll:g,skipSnaps:v,containScroll:y,watchResize:_,watchSlides:b,watchDrag:x,watchFocus:E}=s,w={measure:function(t){const{offsetTop:e,offsetLeft:n,offsetWidth:i,offsetHeight:r}=t;return{top:e,right:n+i,bottom:e+r,left:n,width:i,height:r}}},S=w.measure(e),T=n.map(w.measure),M=function(t,e){const n="rtl"===e,i="y"===t,r=!i&&n?-1:1;return{scroll:i?"y":"x",cross:i?"x":"y",startEdge:i?"top":n?"right":"left",endEdge:i?"bottom":n?"left":"right",measureSize:function(t){const{height:e,width:n}=t;return i?e:n},direction:function(t){return t*r}}}(l,c),A=M.measureSize(S),C=function(t){return{measure:function(e){return t*(e/100)}}}(A),R=function(t,e){const n={start:function(){return 0},center:function(t){return i(t)/2},end:i};function i(t){return e-t}const r={measure:function(i,r){return H_(t)?n[t](i):t(e,i,r)}};return r}(o,A),k=!h&&!!y,L=h||!!y,{slideSizes:D,slideSizesWithGaps:P,startGap:I,endGap:O}=function(t,e,n,i,r,s){const{measureSize:a,startEdge:o,endEdge:l}=t,c=n[0]&&r,u=function(){if(!c)return 0;const t=n[0];return j_(e[o]-t[o])}(),h=function(){if(!c)return 0;const t=s.getComputedStyle(K_(i));return parseFloat(t.getPropertyValue("margin-".concat(l)))}(),d=n.map(a),f=n.map((t,e,n)=>{const i=!e,r=Q_(n,e);return i?d[e]+u:r?d[e]+h:n[e+1][o]-t[o]}).map(j_);return{slideSizes:d,slideSizesWithGaps:f,startGap:u,endGap:h}}(M,S,T,n,L,r),N=vb(M,A,g,h,S,T,I,O,2),{snaps:F,snapsAligned:U}=function(t,e,n,i,r){const{startEdge:s,endEdge:a}=t,{groupSlides:o}=r,l=o(i).map(t=>K_(t)[a]-t[0][s]).map(j_).map(e.measure),c=i.map(t=>n[s]-t[s]).map(t=>-j_(t)),u=o(c).map(t=>t[0]).map((t,e)=>t+l[e]);return{snaps:c,snapsAligned:u}}(M,R,S,T,N),B=-K_(F)+K_(P),{snapsContained:z,scrollContainLimit:H}=function(t,e,n,i,r){const s=ib(-e+t,0),a=n.map((t,e)=>{const{min:i,max:r}=s,a=s.constrain(t),o=!e,c=Q_(n,e);return o?r:c||l(i,a)?i:l(r,a)?r:a}).map(t=>parseFloat(t.toFixed(3))),o=function(){const t=a[0],e=K_(a);return ib(a.lastIndexOf(t),a.indexOf(e)+1)}();function l(t,e){return Y_(t,e)<=1}return{snapsContained:function(){if(e<=t+r)return[s.max];if("keepSnaps"===i)return a;const{min:n,max:l}=o;return a.slice(n,l)}(),scrollContainLimit:o}}(A,B,U,y,2),V=k?z:U,{limit:G}=function(t,e,n){const i=e[0];return{limit:ib(n?i-t:K_(e),i)}}(B,V,h),j=rb(q_(V),u,h),W=j.clone(),Y=X_(n),X=nb(i,r,()=>(t=>{let{dragHandler:e,scrollBody:n,scrollBounds:i,options:{loop:r}}=t;r||i.constrain(e.pointerDown()),n.seek()})(ot),t=>((t,e)=>{let{scrollBody:n,translate:i,location:r,offsetLocation:s,previousLocation:a,scrollLooper:o,slideLooper:l,dragHandler:c,animation:u,eventHandler:h,scrollBounds:d,options:{loop:f}}=t;const p=n.settled(),m=!d.shouldConstrain(),g=f?p:p&&m,v=g&&!c.pointerDown();v&&u.stop();const y=r.get()*e+a.get()*(1-e);s.set(y),f&&(o.loop(n.direction()),l.loop()),i.to(s.get()),v&&h.emit("settle"),g||h.emit("scroll")})(ot,t)),K=V[j.get()],q=db(K),Q=db(K),Z=db(K),J=db(K),$=function(t,e,n,i,r,s){let a=0,o=0,l=r,c=s,u=t.get(),h=0;function d(t){return l=t,p}function f(t){return c=t,p}const p={direction:function(){return o},duration:function(){return l},velocity:function(){return a},seek:function(){const e=i.get()-t.get();let r=0;return l?(n.set(t),a+=e/l,a*=c,u+=a,t.add(a),r=u-h):(a=0,n.set(i),t.set(i),r=e),o=W_(r),h=u,p},settled:function(){return j_(i.get()-e.get())<.001},useBaseFriction:function(){return f(s)},useBaseDuration:function(){return d(r)},useFriction:f,useDuration:d};return p}(q,Z,Q,J,d,.68),tt=ub(h,V,B,G,J),et=function(t,e,n,i,r,s,a){function o(r){const o=r.distance,l=r.index!==e.get();s.add(o),o&&(i.duration()?t.start():(t.update(),t.render(1),t.update())),l&&(n.set(e.get()),e.set(r.index),a.emit("select"))}const l={distance:function(t,e){o(r.byDistance(t,e))},index:function(t,n){const i=e.clone().set(t);o(r.byIndex(i.get(),n))}};return l}(X,j,W,$,tt,J,a),nt=function(t){const{max:e,length:n}=t;return{get:function(t){return n?(t-e)/-n:0}}}(G),it=eb(),rt=gb(e,n,a,m),{slideRegistry:st}=function(t,e,n,i,r,s){const{groupSlides:a}=r,{min:o,max:l}=i,c=function(){const i=a(s),r=!t||"keepSnaps"===e;return 1===n.length?[s]:r?i:i.slice(o,l).map((t,e,n)=>{const i=!e,r=Q_(n,e);return i?Z_(K_(n[0])+1):r?Z_(q_(s)-K_(n)[0]+1,K_(n)[0]):t})}();return{slideRegistry:c}}(k,y,V,H,N,Y),at=hb(t,n,st,et,$,it,a,E),ot={ownerDocument:i,ownerWindow:r,eventHandler:a,containerRect:S,slideRects:T,animation:X,axis:M,dragHandler:sb(M,t,i,r,J,ab(M,r),q,X,et,$,tt,j,a,C,f,p,v,.68,x),eventStore:it,percentOfView:C,index:j,indexPrevious:W,limit:G,location:q,offsetLocation:Z,previousLocation:Q,options:s,resizeHandler:ob(e,a,r,n,M,_,w),scrollBody:$,scrollBounds:lb(G,Z,J,$,C),scrollLooper:cb(B,G,Z,[q,Z,Q,J]),scrollProgress:nt,scrollSnapList:V.map(nt.get),scrollSnaps:V,scrollTarget:tt,scrollTo:et,slideLooper:pb(M,A,B,D,P,F,V,Z,n),slideFocus:at,slidesHandler:mb(e,a,b),slidesInView:rt,slideIndexes:Y,slideRegistry:st,slidesToScroll:N,target:J,translate:fb(M,e)};return ot}const _b={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function bb(t){function e(t,e){return $_(t,e||{})}const n={mergeOptions:e,optionsAtMedia:function(n){const i=n.breakpoints||{},r=J_(i).filter(e=>t.matchMedia(e).matches).map(t=>i[t]).reduce((t,n)=>e(t,n),{});return e(n,r)},optionsMediaQueries:function(e){return e.map(t=>J_(t.breakpoints||{})).reduce((t,e)=>t.concat(e),[]).map(t.matchMedia)}};return n}function xb(t,e,n){const i=t.ownerDocument,r=i.defaultView,s=bb(r),a=function(t){let e=[];const n={init:function(n,i){return e=i.filter(e=>{let{options:n}=e;return!1!==t.optionsAtMedia(n).active}),e.forEach(e=>e.init(n,t)),i.reduce((t,e)=>Object.assign(t,{[e.name]:e}),{})},destroy:function(){e=e.filter(t=>t.destroy())}};return n}(s),o=eb(),l=function(){let t,e={};function n(t){return e[t]||[]}const i={init:function(e){t=e},emit:function(e){return n(e).forEach(n=>n(t,e)),i},off:function(t,r){return e[t]=n(t).filter(t=>t!==r),i},on:function(t,r){return e[t]=n(t).concat([r]),i},clear:function(){e={}}};return i}(),{mergeOptions:c,optionsAtMedia:u,optionsMediaQueries:h}=s,{on:d,off:f,emit:p}=l,m=M;let g,v,y,_,b=!1,x=c(_b,xb.globalOptions),E=c(x),w=[];function S(e){const n=yb(t,y,_,i,r,e,l);if(e.loop&&!n.slideLooper.canLoop()){return S(Object.assign({},e,{loop:!1}))}return n}function T(e,n){b||(x=c(x,e),E=u(x),w=n||w,function(){const{container:e,slides:n}=E,i=H_(e)?t.querySelector(e):e;y=i||t.children[0];const r=H_(n)?y.querySelectorAll(n):n;_=[].slice.call(r||y.children)}(),g=S(E),h([x,...w.map(t=>{let{options:e}=t;return e})]).forEach(t=>o.add(t,"change",M)),E.active&&(g.translate.to(g.location.get()),g.animation.init(),g.slidesInView.init(),g.slideFocus.init(k),g.eventHandler.init(k),g.resizeHandler.init(k),g.slidesHandler.init(k),g.options.loop&&g.slideLooper.loop(),y.offsetParent&&_.length&&g.dragHandler.init(k),v=a.init(k,w)))}function M(t,e){const n=R();A(),T(c({startIndex:n},t),e),l.emit("reInit")}function A(){g.dragHandler.destroy(),g.eventStore.clear(),g.translate.clear(),g.slideLooper.clear(),g.resizeHandler.destroy(),g.slidesHandler.destroy(),g.slidesInView.destroy(),g.animation.destroy(),a.destroy(),o.clear()}function C(t,e,n){E.active&&!b&&(g.scrollBody.useBaseFriction().useDuration(!0===e?0:E.duration),g.scrollTo.index(t,n||0))}function R(){return g.index.get()}const k={canScrollNext:function(){return g.index.add(1).get()!==R()},canScrollPrev:function(){return g.index.add(-1).get()!==R()},containerNode:function(){return y},internalEngine:function(){return g},destroy:function(){b||(b=!0,o.clear(),A(),l.emit("destroy"),l.clear())},off:f,on:d,emit:p,plugins:function(){return v},previousScrollSnap:function(){return g.indexPrevious.get()},reInit:m,rootNode:function(){return t},scrollNext:function(t){C(g.index.add(1).get(),t,-1)},scrollPrev:function(t){C(g.index.add(-1).get(),t,1)},scrollProgress:function(){return g.scrollProgress.get(g.offsetLocation.get())},scrollSnapList:function(){return g.scrollSnapList},scrollTo:C,selectedScrollSnap:R,slideNodes:function(){return _},slidesInView:function(){return g.slidesInView.get()},slidesNotInView:function(){return g.slidesInView.get(!1)}};return T(e,n),setTimeout(()=>l.emit("init"),0),k}function Eb(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=(0,i.useRef)(t),r=(0,i.useRef)(e),[s,a]=(0,i.useState)(),[o,l]=(0,i.useState)(),c=(0,i.useCallback)(()=>{s&&s.reInit(n.current,r.current)},[s]);return(0,i.useEffect)(()=>{U_(n.current,t)||(n.current=t,c())},[t,c]),(0,i.useEffect)(()=>{(function(t,e){if(t.length!==e.length)return!1;const n=B_(t),i=B_(e);return n.every((t,e)=>U_(t,i[e]))})(r.current,e)||(r.current=e,c())},[e,c]),(0,i.useEffect)(()=>{if("undefined"!==typeof window&&window.document&&window.document.createElement&&o){xb.globalOptions=Eb.globalOptions;const t=xb(o,n.current,r.current);return a(t),()=>t.destroy()}a(void 0)},[o,a]),[l,s]}xb.globalOptions=void 0,Eb.globalOptions=void 0;const wb="AboutElementComponent_main__YQ24v",Sb="AboutElementComponent_gradient_overlay__KyLx0",Tb="AboutElementComponent_download__8gDm+",Mb="AboutElementComponent_description__lYQxU",Ab="AboutElementComponent_description_text__cXQg+",Cb="AboutElementComponent_title__77q8K",Rb=["title","onClick","showDownload","icon","className","sizeIcon","description"],kb=t=>{let{title:e,onClick:n,showDownload:i=!1,icon:r,className:s,sizeIcon:a=(window.innerWidth<700?40:90),description:o}=t;d(t,Rb);return(0,m.jsxs)("div",{className:"".concat(wb," ").concat(s),onClick:n,children:[(0,m.jsx)("div",{className:Sb}),(0,m.jsxs)("div",{className:Mb,children:[r&&(0,m.jsx)(I_,{name:r,size:a}),(0,m.jsx)("div",{className:Cb,children:e}),o&&(0,m.jsx)("div",{className:Ab,children:o}),i&&(0,m.jsx)("div",{className:Tb,children:"\u0421\u043a\u0430\u0447\u0430\u0442\u044c"})]})]})},Lb=t=>{let{scrollerRef:e}=t;const n=(0,i.useRef)(null),r=(0,i.useRef)(null),[s,a]=Eb({loop:!0});(0,i.useEffect)(()=>{e.current&&(Sr.timeline({scrollTrigger:{trigger:n.current,scroller:e.current,start:"top 30%",scrub:!1,once:!0}}).from(".".concat(N_.text_header_animated),{x:"100vw",opacity:0,stagger:.01,duration:.01}).to(".".concat(N_.text_header_animated),{x:0,opacity:1,stagger:.01,duration:.7}),Sr.timeline({scrollTrigger:{trigger:n.current,scroller:e.current,start:"top 30%",scrub:!1,once:!0}}).from(".".concat(N_.embla),{y:"100vw",opacity:0,duration:.1}).to(".".concat(N_.embla),{y:0,opacity:1,duration:.5,ease:"sine.out"}))},[e]);return(0,m.jsxs)("section",{ref:n,className:N_.main,children:[(0,m.jsx)("div",{className:N_.main_overlay}),(0,m.jsxs)("div",{ref:r,className:N_.description_section,children:[(0,m.jsx)("span",{className:N_.hint_span,children:"\u041e \u041d\u0410\u0421"}),(0,m.jsx)("h1",{className:N_.header_about,children:"\u041a\u041e\u041c\u0424\u041e\u0420\u0422\u041d\u042b\u0415  \u041c\u0415\u0411\u0415\u041b\u0418\u0420\u041e\u0412\u0410\u041d\u041d\u042b\u0415  \u041d\u041e\u041c\u0415\u0420\u0410  \u0421  \u041e\u0411\u0421\u041b\u0423\u0416\u0418\u0412\u0410\u041d\u0418\u0415\u041c  \u0412  \u0426\u0415\u041d\u0422\u0420\u0415  \u0413\u041e\u0420\u041e\u0414\u0410".split(" ").map((t,e)=>(0,m.jsxs)("span",{className:N_.word,children:[t.split("").map((t,e)=>(0,m.jsx)("span",{className:N_.text_header_animated,children:t},e)),(0,m.jsx)("span",{className:N_.space,children:"\xa0"})]},e))}),(0,m.jsx)("div",{className:N_.embla,ref:s,children:(0,m.jsxs)("div",{className:N_.embla__container,children:[(0,m.jsx)("div",{className:N_.embla__slide,children:(0,m.jsx)(kb,{title:"\u0421\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0435 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e",icon:"coworking",description:"\u041d\u043e\u0432\u0430\u044f \u0433\u043e\u0441\u0442\u0438\u043d\u0438\u0446\u0430 \u0441 \u043f\u0440\u043e\u0434\u0443\u043c\u0430\u043d\u043d\u043e\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043e\u0439 \u0438 \u0437\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0434\u043b\u044f \u0436\u0438\u0437\u043d\u0438, \u0440\u0430\u0431\u043e\u0442\u044b \u0438 \u0440\u0430\u0437\u0432\u0438\u0442\u0438\u044f"})}),(0,m.jsx)("div",{className:N_.embla__slide,children:(0,m.jsx)(kb,{title:"\u0412\u043a\u043b\u044e\u0447\u0435\u043d\u043e \u0432\u0441\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0435",icon:"all-inclusive",description:"\u0418\u043d\u0442\u0435\u0440\u043d\u0435\u0442, \u043a\u043e\u043c\u043c\u0443\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0443\u0441\u043b\u0443\u0433\u0438, \u0443\u0431\u043e\u0440\u043a\u0430, \u0441\u043c\u0435\u043d\u0430 \u0431\u0435\u043b\u044c\u044f \u0438 \u043f\u043e\u043b\u043e\u0442\u0435\u043d\u0435\u0446, \u043f\u0440\u0430\u0447\u0435\u0447\u043d\u0430\u044f \u2014 \u0443\u0436\u0435 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u044b \u0432 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c"})}),(0,m.jsx)("div",{className:N_.embla__slide,children:(0,m.jsx)(kb,{title:"\u041a\u043e\u043c\u0444\u043e\u0440\u0442",icon:"comfort",description:"\u0421\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u0438\u043d\u0442\u0435\u0440\u044c\u0435\u0440, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u0430\u044f \u0442\u0435\u0445\u043d\u0438\u043a\u0430, \u0443\u0434\u043e\u0431\u043d\u0430\u044f \u043c\u0435\u0431\u0435\u043b\u044c \u0438 \u0443\u043c\u043d\u044b\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0436\u0438\u0437\u043d\u0438 \u0431\u0435\u0437 \u043b\u0438\u0448\u043d\u0438\u0445 \u0437\u0430\u0431\u043e\u0442"})}),(0,m.jsx)("div",{className:N_.embla__slide,children:(0,m.jsx)(kb,{title:"\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c 24/7",icon:"security",description:"\u041a\u0440\u0443\u0433\u043b\u043e\u0441\u0443\u0442\u043e\u0447\u043d\u0430\u044f \u043e\u0445\u0440\u0430\u043d\u0430, \u0432\u0438\u0434\u0435\u043e\u043d\u0430\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u0435 \u0438 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u0432 \u043a\u043e\u0440\u043f\u0443\u0441\u0430"})}),(0,m.jsx)("div",{className:N_.embla__slide,children:(0,m.jsx)(kb,{title:"\u041a\u043e\u043c\u044c\u044e\u043d\u0438\u0442\u0438",icon:"community",description:"\u0421\u0440\u0435\u0434\u0430 \u0435\u0434\u0438\u043d\u043e\u043c\u044b\u0448\u043b\u0435\u043d\u043d\u0438\u043a\u043e\u0432 \u0434\u043b\u044f \u043e\u0431\u0449\u0435\u043d\u0438\u044f, \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0438 \u0440\u043e\u0441\u0442\u0430"})}),(0,m.jsx)("div",{className:N_.embla__slide,children:(0,m.jsx)(kb,{title:"\u0426\u0435\u043d\u0442\u0440 \u0433\u043e\u0440\u043e\u0434\u0430",icon:"city",description:"\u0412\u044b \u0432 \u044d\u043f\u0438\u0446\u0435\u043d\u0442\u0440\u0435 \u0433\u043e\u0440\u043e\u0434\u0441\u043a\u043e\u0439 \u0436\u0438\u0437\u043d\u0438 \u0438 \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0445 \u0441\u043e\u0431\u044b\u0442\u0438\u0439 \u0433\u043e\u0440\u043e\u0434\u0430"})}),(0,m.jsx)("div",{className:N_.embla__slide,children:(0,m.jsx)(kb,{title:"\u041f\u043e\u0434\u0437\u0435\u043c\u043d\u0430\u044f \u043f\u0430\u0440\u043a\u043e\u0432\u043a\u0430",icon:"parking",description:"\u0422\u0451\u043f\u043b\u0430\u044f \u043f\u043e\u0434\u0437\u0435\u043c\u043d\u0430\u044f \u043f\u0430\u0440\u043a\u043e\u0432\u043a\u0430 \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0435\u0439 \u0438 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043c\u043e\u0442\u043e\u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442\u0430"})})]})}),(0,m.jsxs)("div",{className:"".concat(N_.buttons),children:[(0,m.jsx)("div",{className:N_.button,onClick:()=>a&&a.scrollPrev(),children:"<"}),(0,m.jsx)("div",{className:N_.button,onClick:()=>a&&a.scrollNext(),children:">"})]})]})]})},Db={main:"AccommodationComponent_main__+R7qc",hint_span:"AccommodationComponent_hint_span__KKz55",description_section:"AccommodationComponent_description_section__JhGnD",word:"AccommodationComponent_word__n2Cay",content:"AccommodationComponent_content__DffD4",header_about:"AccommodationComponent_header_about__ASMfe",text_header_animated:"AccommodationComponent_text_header_animated__-KhpH",content_item:"AccommodationComponent_content_item__OaIVY",gradient_overlay:"AccommodationComponent_gradient_overlay__JOXwQ",overlay_items:"AccommodationComponent_overlay_items__QutjB",title_text:"AccommodationComponent_title_text__OGroR",items_content:"AccommodationComponent_items_content__Ncpfh",items_button:"AccommodationComponent_items_button__Q9MDt",item_center:"AccommodationComponent_item_center__n0XYV",content_text:"AccommodationComponent_content_text__qOj+f"},Pb=n.p+"static/media/conditions.bf943da25d23fabcdc7f.webp",Ib=t=>{let{scrollerRef:e}=t;const n=(0,i.useRef)(null),r=(0,i.useRef)(null),s=(0,i.useRef)(null),[a,o]=(0,i.useState)(Pb);(0,i.useEffect)(()=>{e.current&&(Sr.timeline({scrollTrigger:{trigger:n.current,scroller:e.current,start:"top 30%",scrub:!1,once:!0}}).from(".".concat(Db.text_header_animated),{x:"100vw",opacity:0,stagger:.01,duration:.01}).to(".".concat(Db.text_header_animated),{x:0,opacity:1,stagger:.01,duration:.7}),Sr.timeline({scrollTrigger:{trigger:n.current,scroller:e.current,start:"top 10%",scrub:!1,once:!0}}).from(".".concat(Db.content),{y:"100vh",opacity:0,duration:.1}).to(".".concat(Db.content),{y:0,opacity:1,duration:.5,ease:"sine.out"}))},[e]);const l=t=>{window.open("/documents/".concat(t,".pdf"),"_blank")},c="\u0421\u043e\u0431\u0440\u0430\u043b\u0438 \u0432\u0441\u044e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u0437\u0434\u0435\u0441\u044c".toUpperCase();return(0,m.jsx)("section",{ref:n,className:Db.main,children:(0,m.jsxs)("div",{ref:r,className:Db.description_section,children:[(0,m.jsx)("span",{className:Db.hint_span,children:"\u041f\u0420\u041e\u0416\u0418\u0412\u0410\u041d\u0418\u0415"}),(0,m.jsx)("h1",{className:Db.header_about,children:c.split(" ").map((t,e)=>(0,m.jsxs)("span",{className:Db.word,children:[t.split("").map((t,e)=>(0,m.jsx)("span",{className:Db.text_header_animated,children:t},e)),(0,m.jsx)("span",{className:Db.space,children:"\xa0"})]},e))}),(0,m.jsxs)("div",{ref:s,className:Db.content,children:[(0,m.jsx)("div",{className:Db.content_item,children:(0,m.jsx)(kb,{title:"\u041f\u0443\u0431\u043b\u0438\u0447\u043d\u0430\u044f \u043e\u0444\u0435\u0440\u0442\u0430",icon:"document",showDownload:!0,onClick:()=>l("public")})}),(0,m.jsx)("div",{className:Db.content_item,children:(0,m.jsx)(kb,{title:"\u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u044f",icon:"document",showDownload:!0,onClick:()=>l("public")})}),(0,m.jsx)("div",{className:Db.content_item,children:(0,m.jsx)(kb,{title:"\u041f\u0440\u0438\u043a\u0430\u0437 \u043e\u0431 \u043e\u043f\u043b\u0430\u0442\u0435 \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u044f",icon:"document",showDownload:!0,onClick:()=>l("public")})})]})]})})},Ob={main:"PriceComponent_main__e15LC",animate_before_first:"PriceComponent_animate_before_first__oInP4",animate_before_second:"PriceComponent_animate_before_second__UHW5Z",animate:"PriceComponent_animate__WzEXZ",animated_block:"PriceComponent_animated_block__tB9dF",title_slide:"PriceComponent_title_slide__7OOLL",embla:"PriceComponent_embla__b47E4",embla__container:"PriceComponent_embla__container__UF-8O",buttons:"PriceComponent_buttons__7pSXN",button:"PriceComponent_button__16c0g",embla__slide:"PriceComponent_embla__slide__9pu3n",hint_span:"PriceComponent_hint_span__U7Pl2",description_section:"PriceComponent_description_section__BX15j",word:"PriceComponent_word__YAzfv",content:"PriceComponent_content__wwjwk",image_small:"PriceComponent_image_small__LZW3i",image_medium:"PriceComponent_image_medium__YCTC+",content_text:"PriceComponent_content_text__rPf97",content_image_left:"PriceComponent_content_image_left__68cwg",content_image_right:"PriceComponent_content_image_right__QsFw7",text_title:"PriceComponent_text_title__93DKJ",text_paragraph:"PriceComponent_text_paragraph__5Dq3E",header_about:"PriceComponent_header_about__3iNNa",text_header_animated:"PriceComponent_text_header_animated__5Vn8C",animated_text_words:"PriceComponent_animated_text_words__I32pC"},Nb=n.p+"static/media/alpha.24bfaa29552d3ea2d203.webp",Fb=n.p+"static/media/gamma.bf943da25d23fabcdc7f.webp",Ub=n.p+"static/media/omega.acd4815b0c38366756b2.webp",Bb="RoomsSlideComponent_main__0KQmE",zb="RoomsSlideComponent_price__YgOOu",Hb="RoomsSlideComponent_price_text__Z23B5",Vb="RoomsSlideComponent_inner_description__c8RQH",Gb="RoomsSlideComponent_description__1kGSA",jb="RoomsSlideComponent_button__leakJ",Wb="RoomsSlideComponent_description_block__HEqd5",Yb="RoomsSlideComponent_text_description__1wD7R",Xb="RoomsSlideComponent_title__KSZOT",Kb="RoomsSlideComponent_about_list__hsNDI",qb="RoomsSlideComponent_about__IT0vA",Qb=["title","className","image","description","price","about"],Zb=t=>{let{title:e,className:n,image:i,description:r,price:s,about:a}=t;d(t,Qb);Is(),Fs();return(0,m.jsx)("div",{className:"".concat(Bb," ").concat(n),style:{backgroundImage:"url(".concat(i,")")},children:(0,m.jsxs)("div",{className:Gb,children:[(0,m.jsxs)("div",{className:Vb,children:[(0,m.jsxs)("div",{className:Wb,children:[(0,m.jsx)("p",{className:Xb,children:e}),(0,m.jsx)("p",{className:Yb,children:r})]}),(0,m.jsx)("ul",{className:Kb,children:a.map((t,e)=>(0,m.jsx)("li",{className:qb,children:t},e))})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:zb,children:(0,m.jsxs)("span",{className:Hb,children:["\u043e\u0442 ",s.toLocaleString("ru-RU")," \u20bd"]})}),(0,m.jsx)(x,{className:jb,title:"\u041e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443",onClick:()=>{}})]})]})})},Jb=t=>{let{scrollerRef:e}=t;const n=(0,i.useRef)(null),r=(0,i.useRef)(null),[s,a]=Eb({loop:!0});(0,i.useEffect)(()=>{e.current&&(Sr.timeline({scrollTrigger:{trigger:n.current,scroller:e.current,start:"top 30%",scrub:!1,once:!0}}).from(".".concat(Ob.text_header_animated),{x:"100vw",opacity:0,stagger:.01,duration:.01}).to(".".concat(Ob.text_header_animated),{x:0,opacity:1,stagger:.01,duration:.7}),Sr.timeline({scrollTrigger:{trigger:n.current,scroller:e.current,start:"top 30%",scrub:!1,once:!0}}).from(".".concat(Ob.embla),{y:"100vw",opacity:0,duration:.1}).to(".".concat(Ob.embla),{y:0,opacity:1,duration:.5,ease:"sine.out"}))},[e]);return(0,m.jsx)("section",{ref:n,className:Ob.main,children:(0,m.jsxs)("div",{ref:r,className:Ob.description_section,children:[(0,m.jsx)("span",{className:Ob.hint_span,children:"\u0426\u0415\u041d\u042b"}),(0,m.jsx)("h1",{className:Ob.header_about,children:"\u0414\u041e\u0421\u0422\u0423\u041f\u041d\u042b\u0415 \u041a\u0410\u0422\u0415\u0413\u041e\u0420\u0418\u0418 \u041d\u041e\u041c\u0415\u0420\u041e\u0412".split(" ").map((t,e)=>(0,m.jsxs)("span",{className:Ob.word,children:[t.split("").map((t,e)=>(0,m.jsx)("span",{className:Ob.text_header_animated,children:t},e)),(0,m.jsx)("span",{className:Ob.space,children:"\xa0"})]},e))}),(0,m.jsx)("div",{className:Ob.embla,ref:s,children:(0,m.jsxs)("div",{className:Ob.embla__container,children:[(0,m.jsx)("div",{className:Ob.embla__slide,children:(0,m.jsx)(Zb,{title:"\u041d\u043e\u043c\u0435\u0440 \xab\u0410\u043b\u044c\u0444\u0430\xbb",image:Nb,price:12e3,description:"\u0414\u0432\u0443\u0445\u043c\u0435\u0441\u0442\u043d\u043e\u0435 \u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0438\u0435",about:["2 \u043a\u043e\u043c\u043d\u0430\u0442\u044b \u0432 \u0431\u043b\u043e\u043a\u0435","\u0441 \u0431\u0430\u043b\u043a\u043e\u043d\u043e\u043c / \u0431\u0435\u0437 \u0431\u0430\u043b\u043a\u043e\u043d\u0430"]})}),(0,m.jsx)("div",{className:Ob.embla__slide,children:(0,m.jsx)(Zb,{title:"\u041d\u043e\u043c\u0435\u0440 \xab\u0411\u0435\u0442\u0430\xbb",image:Ub,price:17e3,description:"\u041e\u0434\u043d\u043e\u043c\u0435\u0441\u0442\u043d\u043e\u0435 \u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0438\u0435",about:["2 \u043a\u043e\u043c\u043d\u0430\u0442\u044b \u0432 \u0431\u043b\u043e\u043a\u0435","\u0441 \u0431\u0430\u043b\u043a\u043e\u043d\u043e\u043c / \u0431\u0435\u0437 \u0431\u0430\u043b\u043a\u043e\u043d\u0430"]})}),(0,m.jsx)("div",{className:Ob.embla__slide,children:(0,m.jsx)(Zb,{title:"\u041d\u043e\u043c\u0435\u0440 \xab\u0413\u0430\u043c\u043c\u0430\xbb",image:Fb,price:14e3,description:"\u0414\u0432\u0443\u0445\u043c\u0435\u0441\u0442\u043d\u043e\u0435 \u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0438\u0435",about:["1 \u043a\u043e\u043c\u043d\u0430\u0442\u0430 \u0432 \u0431\u043b\u043e\u043a\u0435","\u0441 \u0431\u0430\u043b\u043a\u043e\u043d\u043e\u043c / \u0431\u0435\u0437 \u0431\u0430\u043b\u043a\u043e\u043d\u0430"]})}),(0,m.jsx)("div",{className:Ob.embla__slide,children:(0,m.jsx)(Zb,{title:"\u041d\u043e\u043c\u0435\u0440 \xab\u0414\u0435\u043b\u044c\u0442\u0430\xbb",image:Ub,price:2e4,description:"\u041e\u0434\u043d\u043e\u043c\u0435\u0441\u0442\u043d\u043e\u0435 \u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0438\u0435",about:["2 \u043a\u043e\u043c\u043d\u0430\u0442\u044b \u0432 \u0431\u043b\u043e\u043a\u0435","\u0443\u043b\u0443\u0447\u0448\u0435\u043d\u043d\u0430\u044f \u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u043a\u0430","\u0441 \u0431\u0430\u043b\u043a\u043e\u043d\u043e\u043c / \u0431\u0435\u0437 \u0431\u0430\u043b\u043a\u043e\u043d\u0430"]})})]})}),(0,m.jsxs)("div",{className:Ob.buttons,children:[(0,m.jsx)("div",{className:Ob.button,onClick:()=>a&&a.scrollPrev(),children:"<"}),(0,m.jsx)("div",{className:Ob.button,onClick:()=>a&&a.scrollNext(),children:">"})]})]})})},$b="ContactComponent_main__pf233",tx="ContactComponent_description_section__K643L",ex="ContactComponent_logo__zyHHR",nx="ContactComponent_info_column__blfJ+",ix="ContactComponent_content__AOsmF",rx="ContactComponent_map_column__XlPj8",sx=()=>(0,m.jsx)("footer",{className:$b,children:(0,m.jsx)("div",{className:tx,children:(0,m.jsxs)("div",{className:ix,children:[(0,m.jsx)(F,{className:ex}),(0,m.jsxs)("div",{className:nx,children:[(0,m.jsx)("div",{children:"\u0420\u0435\u0441\u0435\u043f\u0448\u0435\u043d (\u043a\u0440\u0443\u0433\u043b\u043e\u0441\u0443\u0442\u043e\u0447\u043d\u043e):"}),(0,m.jsx)("div",{children:"+7 831 435 13 15"}),(0,m.jsx)("div",{children:"welcome@neimark-it.ru"})]}),(0,m.jsxs)("div",{className:nx,children:[(0,m.jsx)("div",{children:"\u041c\u044b \u0432 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0445 \u0441\u0435\u0442\u044f\u0445:"}),(0,m.jsx)("a",{href:"https://vk.com/neimark_it",children:"\u0412\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u0435"}),(0,m.jsx)("a",{href:"https://t.me/neimarkitlektoriy",children:"\u0422\u0435\u043b\u0435\u0433\u0440\u0430\u043c"})]}),(0,m.jsx)("iframe",{className:rx,src:"https://yandex.ru/map-widget/v1/?from=mapframe&ll=43.981812%2C56.314407&mode=whatshere&whatshere%5Bpoint%5D=43.981813%2C56.314407&whatshere%5Bzoom%5D=17&z=17",width:"100%",height:"100%",frameBorder:"0"})]})})}),ax={main:"FAQComponent_main__OG3yE",animate_before_first:"FAQComponent_animate_before_first__qDmSI",animate_before_second:"FAQComponent_animate_before_second__ALYX4",animate:"FAQComponent_animate__kORjm",animated_block:"FAQComponent_animated_block__DGd2G",hint_span:"FAQComponent_hint_span__6gB-A",description_section:"FAQComponent_description_section__pNh17",word:"FAQComponent_word__vrpM6",content:"FAQComponent_content__8H7ao",faq_block:"FAQComponent_faq_block__4OMWW",image_small:"FAQComponent_image_small__WHw9K",image_medium:"FAQComponent_image_medium__D5KWR",content_text:"FAQComponent_content_text__9tfob",content_image_left:"FAQComponent_content_image_left__+-2Zv",content_image_right:"FAQComponent_content_image_right__r3DqD",text_title:"FAQComponent_text_title__+0NQ2",text_paragraph:"FAQComponent_text_paragraph__szMXL",header_about:"FAQComponent_header_about__cdxUD",text_header_animated:"FAQComponent_text_header_animated__gjgPB",embla__slide:"FAQComponent_embla__slide__Mzfrj",buttons:"FAQComponent_buttons__Ua-zl",button:"FAQComponent_button__D60tI",embla:"FAQComponent_embla__yJGIZ",embla__container:"FAQComponent_embla__container__5w7ql",animated_text_words:"FAQComponent_animated_text_words__xpUv9"},ox="FAQElementComponent_main__8wM6E",lx="FAQElementComponent_question__KGc07",cx="FAQElementComponent_answer__zkMy9",ux="FAQElementComponent_answer_text__QWEag",hx=t=>{let{question:e,answer:n}=t;const[r,s]=(0,i.useState)(!1),a=(0,i.useRef)(null),o=(0,i.useRef)(null);return(0,i.useEffect)(()=>{Sr.to(a.current,{height:r?"auto":0,duration:.5,ease:"power1.inOut"}),Sr.to(o.current,{autoAlpha:r?1:0,duration:.5,ease:"power1.inOut"})},[r]),(0,m.jsxs)("div",{className:"".concat(ox),children:[(0,m.jsxs)("div",{className:lx,onClick:()=>s(t=>!t),children:[(0,m.jsx)("span",{children:e}),(0,m.jsx)(I_,{name:"plus",rotate:r?45:0})]}),(0,m.jsx)("div",{ref:a,className:cx,children:(0,m.jsx)("span",{ref:o,className:ux,children:n})})]})},dx=t=>{let{scrollerRef:e}=t;const n=(0,i.useRef)(null),r=(0,i.useRef)(null);(0,i.useEffect)(()=>{e.current&&Sr.timeline({scrollTrigger:{trigger:n.current,scroller:e.current,start:"top 30%",scrub:!1,once:!0}}).from(".".concat(ax.text_header_animated),{x:"100vw",opacity:0,stagger:.01,duration:.01}).to(".".concat(ax.text_header_animated),{x:0,opacity:1,stagger:.01,duration:.7})},[e]);const s="\u041e\u0442\u0432\u0435\u0447\u0430\u0435\u043c \u043d\u0430 \u0432\u043e\u043f\u0440\u043e\u0441\u044b".toUpperCase();return(0,m.jsxs)("section",{ref:n,className:ax.main,children:[(0,m.jsx)("div",{className:ax.main_overlay}),(0,m.jsxs)("div",{ref:r,className:ax.description_section,children:[(0,m.jsx)("span",{className:ax.hint_span,children:"FAQ"}),(0,m.jsx)("h1",{className:ax.header_about,children:s.split(" ").map((t,e)=>(0,m.jsxs)("span",{className:ax.word,children:[t.split("").map((t,e)=>(0,m.jsx)("span",{className:ax.text_header_animated,children:t},e)),(0,m.jsx)("span",{className:ax.space,children:"\xa0"})]},e))}),(0,m.jsxs)("div",{className:ax.content,children:[(0,m.jsxs)("div",{className:ax.faq_block,children:["\u0423\u0441\u043b\u043e\u0432\u0438\u044f \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u044f",(0,m.jsx)(hx,{question:"\u041c\u043e\u0436\u043d\u043e \u043b\u0438 \u0443\u043a\u0440\u0430\u0448\u0430\u0442\u044c \u043a\u043e\u043c\u043d\u0430\u0442\u0443 (\u0440\u0430\u0437\u043c\u0435\u0449\u0430\u0442\u044c \u043f\u043e\u0441\u0442\u0435\u0440\u044b, \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438)?",answer:"\u0414\u043b\u044f \u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0438\u044f \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0439, \u043d\u0435\u0431\u043e\u043b\u044c\u0448\u0438\u0445 \u043f\u043e\u0441\u0442\u0435\u0440\u043e\u0432 \u0432 \u043a\u043e\u043c\u043d\u0430\u0442\u0430\u0445 \u043f\u0440\u0435\u0434\u0443\u0441\u043c\u043e\u0442\u0440\u0435\u043d\u044b \u043f\u0440\u043e\u0431\u043a\u043e\u0432\u044b\u0435 \u0434\u043e\u0441\u043a\u0438. \u041c\u044b \u0441 \u0440\u0430\u0434\u043e\u0441\u0442\u044c\u044e \u043f\u043e\u043c\u043e\u0436\u0435\u043c \u0438\u0445 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u043e \u0432\u0430\u0448\u0435\u043c\u0443 \u0437\u0432\u043e\u043d\u043a\u0443 \u043d\u0430 \u0440\u0435\u0446\u0435\u043f\u0446\u0438\u044e. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043a\u043b\u0435\u0439 \u0438 \u043d\u0435 \u0441\u0432\u0435\u0440\u043b\u0438\u0442\u0435 \u0441\u0442\u0435\u043d\u044b \u0438 \u043c\u0435\u0431\u0435\u043b\u044c"}),(0,m.jsx)(hx,{question:"\u041c\u043e\u0436\u043d\u043e \u043b\u0438 \u043f\u0440\u0438\u0432\u043e\u0434\u0438\u0442\u044c \u0433\u043e\u0441\u0442\u0435\u0439?",answer:"\u0414\u0430. \u0413\u043e\u0441\u0442\u0438 \u043c\u043e\u0433\u0443\u0442 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c\u0441\u044f \u0432 \u043a\u043e\u0440\u043f\u0443\u0441\u0435 \u0434\u043e 22:00. \u0414\u043b\u044f \u0438\u0445 \u043f\u0440\u0435\u0431\u044b\u0432\u0430\u043d\u0438\u044f \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u043f\u0440\u043e\u043f\u0443\u0441\u043a \u043d\u0430 \u0440\u0435\u0441\u0435\u043f\u0448\u0435\u043d\u0435. \u0417\u0430 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0435 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0438 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0433\u043e\u0441\u0442\u0435\u0439 \u043e\u0442\u0432\u0435\u0442\u0441\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u044c \u043d\u0435\u0441\u0435\u0442 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0430\u044e\u0449\u0438\u0439"}),(0,m.jsx)(hx,{question:"\u041a\u0430\u043c\u043f\u0443\u0441 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043a\u0440\u0443\u0433\u043b\u043e\u0441\u0443\u0442\u043e\u0447\u043d\u043e? ",answer:"\u041a\u0430\u043c\u043f\u0443\u0441 \u043e\u0442\u043a\u0440\u044b\u0442 24/7. \u0421 23:00 \u0434\u0435\u0439\u0441\u0442\u0432\u0443\u0435\u0442 \u043f\u0440\u0430\u0432\u0438\u043b\u043e \u0442\u0438\u0448\u0438\u043d\u044b \u2014 \u043c\u044b \u0443\u0432\u0430\u0436\u0430\u0435\u043c \u0440\u0435\u0436\u0438\u043c \u0441\u043d\u0430 \u0438 \u0443\u0447\u0451\u0431\u044b \u0441\u043e\u0441\u0435\u0434\u0435\u0439"}),(0,m.jsx)(hx,{question:"\u041a\u0442\u043e \u0441\u043b\u0435\u0434\u0438\u0442 \u0437\u0430 \u0447\u0438\u0441\u0442\u043e\u0442\u043e\u0439? ",answer:"\u0412 \u043a\u043e\u043b\u0438\u0432\u0438\u043d\u0433\u0430\u0445 \u043f\u0440\u0435\u0434\u0443\u0441\u043c\u043e\u0442\u0440\u0435\u043d \u043a\u043b\u0438\u043d\u0438\u043d\u0433: \u043c\u044b \u043f\u043e\u0437\u0430\u0431\u043e\u0442\u0438\u043c\u0441\u044f \u043e\u0431 \u0443\u0431\u043e\u0440\u043a\u0435 \u043d\u043e\u043c\u0435\u0440\u043e\u0432, \u043c\u0435\u0441\u0442 \u043e\u0431\u0449\u0435\u0433\u043e \u043f\u0440\u0435\u0431\u044b\u0432\u0430\u043d\u0438\u044f, \u0441\u043c\u0435\u043d\u0435 \u043f\u043e\u0441\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u0431\u0435\u043b\u044c\u044f \u0438 \u043f\u043e\u043b\u043e\u0442\u0435\u043d\u0435\u0446. \u041f\u0440\u043e\u0436\u0438\u0432\u0430\u044e\u0449\u0438\u0445 \u043c\u044b \u043f\u0440\u043e\u0441\u0438\u043c \u0443\u0431\u0438\u0440\u0430\u0442\u044c \u0437\u0430 \u0441\u043e\u0431\u043e\u0439 \u043f\u043e\u0441\u0443\u0434\u0443 \u0438 \u0432\u044b\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0442\u044c \u043c\u0443\u0441\u043e\u0440 \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u044b"}),(0,m.jsx)(hx,{question:"\u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043e \u043b\u0438 \u043a\u0443\u0440\u0435\u043d\u0438\u0435 \u0438 \u0440\u0430\u0441\u043f\u0438\u0442\u0438\u0435 \u0441\u043f\u0438\u0440\u0442\u043d\u044b\u0445 \u043d\u0430\u043f\u0438\u0442\u043a\u043e\u0432?",answer:"\u041c\u044b \u0437\u0430 \u0417\u041e\u0416: \u0430\u043b\u043a\u043e\u0433\u043e\u043b\u044c, \u0442\u0430\u0431\u0430\u043a, \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u044b\u0435 \u0441\u0438\u0433\u0430\u0440\u0435\u0442\u044b \u0438 \u043a\u0430\u043b\u044c\u044f\u043d\u044b \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d\u044b \u043d\u0430 \u0432\u0441\u0435\u0439 \u0442\u0435\u0440\u0440\u0438\u0442\u043e\u0440\u0438\u0438 \u043a\u0430\u043c\u043f\u0443\u0441\u0430 \u2014 \u0434\u043b\u044f \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u044e\u0449\u0438\u0445 \u0438 \u0433\u043e\u0441\u0442\u0435\u0439. \u041c\u044b \u043f\u043e\u043d\u0438\u043c\u0430\u0435\u043c \u0437\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u0443\u044e \u0437\u043e\u043d\u0443 \u0438 \u0440\u0430\u0441\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0435\u043c \u0442\u0430\u043a\u0443\u044e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c"})]}),(0,m.jsxs)("div",{className:ax.faq_block,children:["\u0423\u0441\u043b\u043e\u0432\u0438\u044f \u043e\u043f\u043b\u0430\u0442\u044b",(0,m.jsx)(hx,{question:"\u041a\u0430\u043a \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u043f\u043b\u0430\u0442\u0430?",answer:"\u041e\u043f\u043b\u0430\u0442\u0430 \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0430\u0432\u0430\u043d\u0441\u043e\u043c \u0437\u0430 \u043c\u0435\u0441\u044f\u0446 \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u044f. \u041e\u043f\u043b\u0430\u0442\u0430 \u0437\u0430 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043c\u0435\u0441\u044f\u0446 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u0434\u043e 7 \u0447\u0438\u0441\u043b\u0430"})]}),(0,m.jsxs)("div",{className:ax.faq_block,children:["\u041e\u0441\u043d\u0430\u0449\u0435\u043d\u0438\u0435 \u043c\u0435\u0431\u0435\u043b\u044c\u044e \u0438 \u0442\u0435\u0445\u043d\u0438\u043a\u043e\u0439",(0,m.jsx)(hx,{question:"\u041a\u0430\u043a\u0430\u044f \u043c\u0435\u0431\u0435\u043b\u044c \u0438 \u0442\u0435\u0445\u043d\u0438\u043a\u0430 \u0435\u0441\u0442\u044c \u0432 \u043a\u043e\u043c\u043d\u0430\u0442\u0430\u0445?",answer:"\u041a\u043e\u043c\u043d\u0430\u0442\u044b \u043e\u0441\u043d\u0430\u0449\u0435\u043d\u044b \u0432\u0441\u0435\u0439 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0439 \u043c\u0435\u0431\u0435\u043b\u044c\u044e \u0434\u043b\u044f \u043a\u043e\u043c\u0444\u043e\u0440\u0442\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u043d\u0438\u044f: \u0441\u043f\u0430\u043b\u044c\u043d\u043e\u0435 \u043c\u0435\u0441\u0442\u043e \u0441 \u043f\u043e\u0441\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u0431\u0435\u043b\u044c\u0435\u043c, \u0448\u043a\u0430\u0444 \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0432\u0435\u0449\u0435\u0439, \u043f\u0438\u0441\u044c\u043c\u0435\u043d\u043d\u044b\u0439 \u0441\u0442\u043e\u043b \u0438 \u043a\u0440\u0435\u0441\u043b\u043e. \u041a\u0440\u043e\u043c\u0435 \u0442\u043e\u0433\u043e, \u0432\u043e \u0432\u0441\u0435\u0445 \u043a\u043e\u043c\u043d\u0430\u0442\u0430\u0445 \u0435\u0441\u0442\u044c \u0443\u043c\u043d\u0430\u044f \u0441\u0442\u0430\u043d\u0446\u0438\u044f \u0421\u0411\u0415\u0420. \u0412 \u043a\u0430\u0436\u0434\u043e\u043c \u0431\u043b\u043e\u043a\u0435 \u0438\u043c\u0435\u0435\u0442\u0441\u044f 1 \u0438\u043b\u0438 2 \u0441\u0430\u043d\u0443\u0437\u043b\u0430 \u0438 \u0434\u0443\u0448\u0435\u0432\u0430\u044f \u043a\u0430\u0431\u0438\u043d\u0430, \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430\u0431\u043e\u0440 \u043f\u043e\u043b\u043e\u0442\u0435\u043d\u0435\u0446 \u0441 \u0435\u0436\u0435\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u043e\u0439 \u0437\u0430\u043c\u0435\u043d\u043e\u0439. \u0412 \u043c\u0435\u0441\u0442\u0430\u0445 \u043e\u0431\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0435\u0441\u0442\u044c \u0434\u0438\u0432\u0430\u043d, \u0422\u0412, \u043c\u0438\u043a\u0440\u043e\u0432\u043e\u043b\u043d\u043e\u0432\u043a\u0430 \u0438 \u043c\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0440\u043a\u0430 \u0434\u043b\u044f \u0440\u0430\u0437\u043e\u0433\u0440\u0435\u0432\u0430 \u043f\u0438\u0449\u0438, \u0430\u044d\u0440\u043e\u0433\u0440\u0438\u043b\u044c, \u0445\u043e\u043b\u043e\u0434\u0438\u043b\u044c\u043d\u0438\u043a\u0438"}),(0,m.jsx)(hx,{question:"\u0427\u0442\u043e \u0435\u0441\u0442\u044c \u043d\u0430 \u043a\u0443\u0445\u043d\u044f\u0445 \u0438 \u043d\u0430 \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0447\u0435\u043b\u043e\u0432\u0435\u043a",answer:"\u041d\u0430 \u043a\u0430\u0436\u0434\u043e\u043c \u044d\u0442\u0430\u0436\u0435 \u0435\u0441\u0442\u044c \u0445\u043e\u043b\u043e\u0434\u0438\u043b\u044c\u043d\u0438\u043a\u0438, 2 \u043c\u0438\u043a\u0440\u043e\u0432\u043e\u043b\u043d\u043e\u0432\u043a\u0438, \u043c\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0440\u043a\u0430, \u0430\u044d\u0440\u043e\u0433\u0440\u0438\u043b\u044c, \u043f\u043e\u0441\u0443\u0434\u0430 (\u0447\u0430\u0448\u043a\u0438/\u0441\u0442\u0430\u043a\u0430\u043d\u044b) \u0438 \u043f\u0440\u0438\u0431\u043e\u0440\u044b. \u042d\u0442\u0430\u0436 \u043e\u0431\u044b\u0447\u043d\u043e \u0440\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u043d \u043d\u0430 16\u201318 \u043f\u0440\u043e\u0436\u0438\u0432\u0430\u044e\u0449\u0438\u0445"}),(0,m.jsx)(hx,{question:"\u041c\u043e\u0436\u043d\u043e \u043b\u0438 \u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0441\u0432\u043e\u044e \u0442\u0435\u0445\u043d\u0438\u043a\u0443 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u043c\u0438\u043d\u0438-\u0445\u043e\u043b\u043e\u0434\u0438\u043b\u044c\u043d\u0438\u043a)? \u0427\u0442\u043e \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d\u043e? ",answer:"\u041c\u0435\u043b\u043a\u0443\u044e \u0442\u0435\u0445\u043d\u0438\u043a\u0443 (\u0442\u0435\u043b\u0435\u0444\u043e\u043d\u044b, \u043d\u043e\u0443\u0442\u0431\u0443\u043a\u0438) \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c \u0432 \u0440\u043e\u0437\u0435\u0442\u043a\u0438 \u0432 \u043a\u043e\u043c\u043d\u0430\u0442\u0435. \u0414\u043b\u044f \u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0438\u044f \u043b\u0438\u0447\u043d\u043e\u0439 \u043a\u0440\u0443\u043f\u043d\u043e\u0439 \u0438 \u044d\u043d\u0435\u0440\u0433\u043e\u0451\u043c\u043a\u043e\u0439 \u0442\u0435\u0445\u043d\u0438\u043a\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043d\u0430\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443"}),(0,m.jsx)(hx,{question:"\u041a\u0430\u043a\u043e\u0439 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442 \u0432 \u043a\u0430\u043c\u043f\u0443\u0441\u0435?",answer:"\u0412 \u043a\u043e\u043b\u0438\u0432\u0438\u043d\u0433\u0430\u0445 \u043f\u0440\u0435\u0434\u0443\u0441\u043c\u043e\u0442\u0440\u0435\u043d \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u044b\u0439 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442 24/7, \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u2014 \u0434\u043e 1 \u0413\u0431\u0438\u0442/\u0441. \u042d\u0442\u0430 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0432\u0441\u0435\u043c\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u043c\u0438 \u043e\u043d\u043b\u0430\u0439\u043d-\u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u0430\u043c\u0438 \u0434\u043b\u044f \u0443\u0447\u0451\u0431\u044b. \u0412 \u043d\u043e\u043c\u0435\u0440\u0430\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b Wi-Fi \u0438 \u043f\u0440\u043e\u0432\u043e\u0434\u043d\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435. \u0421\u0435\u0442\u044c \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044f\u044f; \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0432\u043d\u0435\u0448\u043d\u0438\u043c \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u043c \u043d\u0435\u0442"})]}),(0,m.jsxs)("div",{className:ax.faq_block,children:["\u0422\u0435\u0440\u0440\u0438\u0442\u043e\u0440\u0438\u044f \u0438 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u043a\u043e\u043b\u0438\u0432\u0438\u043d\u0433\u043e\u0432",(0,m.jsx)(hx,{question:"\u041d\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u044f \u043f\u043e \u043a\u0430\u043c\u043f\u0443\u0441\u0443 \u0438 \u0434\u043e\u0441\u0442\u0443\u043f \u0432 \u0434\u0440\u0443\u0433\u0438\u0435 \u043a\u043e\u0440\u043f\u0443\u0441\u0430",answer:"\u0421\u043a\u043e\u0440\u043e \u043f\u043e\u044f\u0432\u0438\u0442\u0441\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0441 \u043a\u0430\u0440\u0442\u0430\u043c\u0438 \u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u0430\u043c\u0438; \u043d\u0430 \u0440\u0435\u0446\u0435\u043f\u0446\u0438\u0438 \u0443\u0436\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0431\u0443\u043a\u043b\u0435\u0442\u044b \u0438 \u043a\u0430\u0440\u0442\u044b \u2014 \u043f\u043e\u043c\u043e\u0436\u0435\u043c \u0441 \u043e\u0440\u0438\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c. \u041a\u0430\u0440\u0442\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0432 \u0432\u0430\u0448\u0435\u043c \u043a\u043e\u0440\u043f\u0443\u0441\u0435; \u0432 \u0434\u0440\u0443\u0433\u0438\u0435 \u043a\u043e\u0440\u043f\u0443\u0441\u0430 \u043c\u043e\u0436\u043d\u043e \u0432\u0445\u043e\u0434\u0438\u0442\u044c \u043a\u0430\u043a \u0433\u043e\u0441\u0442\u044c \u0434\u043e 22:00 \u0432 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0438 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0430\u044e\u0449\u0435\u0433\u043e. \u041c\u044b \u0431\u0443\u0434\u0435\u043c \u043e\u0442\u043c\u0435\u0447\u0430\u0442\u044c \u0434\u0430\u0442\u044b \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u0439 \u0437\u043e\u043d \u0434\u043e\u0441\u0443\u0433\u0430 \u0438 \u043d\u043e\u0432\u044b\u0445 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 \u2014 \u0432\u044b \u0441\u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u0431\u044b\u0432\u0430\u0442\u044c \u043d\u0430 \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u044f\u0445 \u0438 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0431\u043e\u043d\u0443\u0441\u044b"})]})]})]})]})},fx="ExcursionComponent_main__TfQYq",px="ExcursionComponent_description_section__+t8ZA",mx="ExcursionComponent_form__OlMwR",gx="ExcursionComponent_form_header__iEB+B",vx="ExcursionComponent_form_body__F-Kla",yx="ExcursionComponent_form_input__y0GCO",_x="ExcursionComponent_form_button__DnW4M",bx="ExcursionComponent_content__VVXpS",xx=()=>(0,m.jsx)("div",{className:fx,children:(0,m.jsx)("div",{className:px,children:(0,m.jsx)("div",{className:bx,children:(0,m.jsxs)("form",{className:mx,children:[(0,m.jsx)("div",{className:gx,children:"\u0417\u0430\u043f\u0438\u0441\u044c \u043d\u0430 \u044d\u043a\u0441\u043a\u0443\u0440\u0441\u0438\u044e \u0432 \u043a\u043e\u043b\u0438\u0432\u0438\u043d\u0433"}),(0,m.jsx)("hr",{}),(0,m.jsxs)("div",{className:vx,children:[(0,m.jsx)("input",{className:yx,placeholder:"\u0418\u043c\u044f",type:"text"}),(0,m.jsx)("input",{className:yx,placeholder:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",type:"text"}),(0,m.jsx)("input",{className:yx,placeholder:"E-mail",type:"email"}),(0,m.jsx)("button",{className:_x,onClick:()=>{},type:"button",children:"\u0417\u0430\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f \u043d\u0430 \u044d\u043a\u0441\u043a\u0443\u0440\u0441\u0438\u044e"})]})]})})})}),Ex=t=>{Object.assign({},(Ya(t),t));const e=(0,i.useContext)(w),n=(0,i.useContext)(E),r=(0,i.useContext)(S),s=(0,i.useRef)(null),a=(0,i.useRef)(null),o=(0,i.useRef)(null),l=(0,i.useRef)(null),c=(0,i.useRef)(null),u=(0,i.useRef)(null);(0,i.useEffect)(()=>{switch("home"===r[0]?n[1]("hidden"):n[1]("home"),r[0]){case"home":{const t=a.current.getBoundingClientRect().top-a.current.parentElement.getBoundingClientRect().top;Sr.to(a.current.parentElement,{scrollTop:a.current.parentElement.scrollTop+t,duration:.4,ease:"power2.inOut"})}break;case"about":{const t=o.current.getBoundingClientRect().top-o.current.parentElement.getBoundingClientRect().top;Sr.to(o.current.parentElement,{scrollTop:o.current.parentElement.scrollTop+t,duration:.4,ease:"power2.inOut"})}break;case"price":{const t=c.current.getBoundingClientRect().top-c.current.parentElement.getBoundingClientRect().top;Sr.to(c.current.parentElement,{scrollTop:c.current.parentElement.scrollTop+t,duration:.4,ease:"power2.inOut"})}break;case"acco":{const t=l.current.getBoundingClientRect().top-l.current.parentElement.getBoundingClientRect().top;Sr.to(l.current.parentElement,{scrollTop:l.current.parentElement.scrollTop+t,duration:.4,ease:"power2.inOut"})}break;case"news":{const t=u.current.getBoundingClientRect().top-u.current.parentElement.getBoundingClientRect().top;Sr.to(u.current.parentElement,{scrollTop:u.current.parentElement.scrollTop+t,duration:.4,ease:"power2.inOut"})}}},[r]);return(0,m.jsx)("main",{className:Xa,children:(0,m.jsxs)("div",{ref:s,className:Ka,onScroll:t=>{a.current.getBoundingClientRect().top,t.currentTarget.getBoundingClientRect().top;const n=o.current.getBoundingClientRect().top-t.currentTarget.getBoundingClientRect().top,i=l.current.getBoundingClientRect().top-t.currentTarget.getBoundingClientRect().top,r=c.current.getBoundingClientRect().top-t.currentTarget.getBoundingClientRect().top;u.current.getBoundingClientRect().top-t.currentTarget.getBoundingClientRect().top<400?e[1]("news"):r<400?e[1]("price"):i<400?e[1]("acco"):n<400?e[1]("about"):e[1]("home")},children:[(0,m.jsx)("div",{ref:a,className:qa}),(0,m.jsx)(O_,{scrollerRef:s}),(0,m.jsx)("div",{ref:o,className:qa}),(0,m.jsx)(Lb,{scrollerRef:s}),(0,m.jsx)("div",{ref:c,className:qa}),(0,m.jsx)(Jb,{scrollerRef:s}),(0,m.jsx)("div",{ref:u,className:qa}),(0,m.jsx)(dx,{scrollerRef:s}),(0,m.jsx)("div",{ref:l,className:qa}),(0,m.jsx)(Ib,{scrollerRef:s}),(0,m.jsx)(xx,{}),(0,m.jsx)(sx,{})]})})},wx=t=>{let{children:e}=t;const n=(0,i.useState)("hidden");return(0,m.jsx)(E.Provider,{value:n,children:e})},Sx=t=>{let{children:e}=t;const n=(0,i.useState)("home");return(0,m.jsx)(w.Provider,{value:n,children:e})},Tx=t=>{let{children:e}=t;const n=(0,i.useState)("home");return(0,m.jsx)(S.Provider,{value:n,children:e})},Mx="RoomPageComponent_main__DgYZO",Ax="RoomPageComponent_description__B9KNQ",Cx="RoomPageComponent_image__dqhL9",Rx="RoomPageComponent_view__HgBBg",kx="RoomPageComponent_overlay_blur__mSoGo",Lx="RoomPageComponent_switch__V0UeK",Dx="RoomPageComponent_layout__DmJHZ",Px="RoomPageComponent_header__b2GuY",Ix="RoomPageComponent_balcony__Wqe1K",Ox="RoomPageComponent_title__dOLOA",Nx="RoomPageComponent_price_container__-5vRr",Fx="RoomPageComponent_price__yG-hu",Ux="RoomPageComponent_description_about__hvB+f",Bx="RoomPageComponent_description_text__yEG7A",zx="RoomPageComponent_button_container__BULef",Hx="RoomPageComponent_button__a40pq",Vx="RoomPageComponent_active__F75u8",Gx={button:"ButtonBorder_button__1ouXv",active:"ButtonBorder_active__Z-FRF",animated_text:"ButtonBorder_animated_text__frYYF"},jx=["active","disabled","className","type","title","onClick","defaultClassName"],Wx=(0,i.forwardRef)((t,e)=>{let{active:n,disabled:i,className:r,type:s,title:a,onClick:o,defaultClassName:l=!0}=t;d(t,jx);return(0,m.jsx)("button",{ref:e,disabled:i,className:"".concat(l&&Gx.button," ").concat(n&&Gx.active," ").concat(r),type:null!==s&&void 0!==s?s:"button",onClick:t=>o(t),children:(0,m.jsx)("span",{className:"".concat(n&&Gx.button_element__highlight),children:a})})});const Yx=n.p+"static/media/room-alpha.1c15eb69d05a2772d53648af4117558e.svg",Xx=n.p+"static/media/room1.f642d27cb6667a8c2bad.jpg",Kx=n.p+"static/media/room2.df3144dc139f3652b155.jpg",qx=n.p+"static/media/room3.0a5191bb3a403ad9369d.jpg";const Qx=n.p+"static/media/marker.30f75dde91b93fc2b372b5925522e32b.svg";function Zx(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function Jx(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function tE(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$x(Object(n),!0).forEach(function(e){Jx(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$x(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function eE(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=s.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Zx(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zx(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nE(t){return nE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nE(t)}const iE="179",rE=0,sE=1,aE=2,oE=100,lE=101,cE=102,uE=200,hE=201,dE=202,fE=203,pE=204,mE=205,gE=206,vE=207,yE=208,_E=209,bE=210,xE=211,EE=212,wE=213,SE=214,TE=0,ME=1,AE=2,CE=3,RE=4,kE=5,LE=6,DE=7,PE=301,IE=302,OE=303,NE=304,FE=306,UE=1e3,BE=1001,zE=1002,HE=1003,VE=1004,GE=1005,jE=1006,WE=1007,YE=1008,XE=1009,KE=1010,qE=1011,QE=1012,ZE=1013,JE=1014,$E=1015,tw=1016,ew=1017,nw=1018,iw=1020,rw=35902,sw=1023,aw=1026,ow=1027,lw=1028,cw=1029,uw=1031,hw=1033,dw=33776,fw=33777,pw=33778,mw=33779,gw=35840,vw=35841,yw=35842,_w=35843,bw=36196,xw=37492,Ew=37496,ww=37808,Sw=37809,Tw=37810,Mw=37811,Aw=37812,Cw=37813,Rw=37814,kw=37815,Lw=37816,Dw=37817,Pw=37818,Iw=37819,Ow=37820,Nw=37821,Fw=36492,Uw=36494,Bw=36495,zw=36284,Hw=36285,Vw=36286,Gw=2300,jw=2301,Ww=2302,Yw=2400,Xw=2401,Kw=2402,qw="",Qw="srgb",Zw="srgb-linear",Jw="linear",$w="srgb",tS=7680,eS=512,nS=513,iS=514,rS=515,sS=516,aS=517,oS=518,lS=519,cS=35044,uS="300 es",hS=2e3,dS=2001;class fS{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){const n=this._listeners;return void 0!==n&&(void 0!==n[t]&&-1!==n[t].indexOf(e))}removeEventListener(t,e){const n=this._listeners;if(void 0===n)return;const i=n[t];if(void 0!==i){const t=i.indexOf(e);-1!==t&&i.splice(t,1)}}dispatchEvent(t){const e=this._listeners;if(void 0===e)return;const n=e[t.type];if(void 0!==n){t.target=this;const e=n.slice(0);for(let n=0,i=e.length;n<i;n++)e[n].call(this,t);t.target=null}}}const pS=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let mS=1234567;const gS=Math.PI/180,vS=180/Math.PI;function yS(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(pS[255&t]+pS[t>>8&255]+pS[t>>16&255]+pS[t>>24&255]+"-"+pS[255&e]+pS[e>>8&255]+"-"+pS[e>>16&15|64]+pS[e>>24&255]+"-"+pS[63&n|128]+pS[n>>8&255]+"-"+pS[n>>16&255]+pS[n>>24&255]+pS[255&i]+pS[i>>8&255]+pS[i>>16&255]+pS[i>>24&255]).toLowerCase()}function _S(t,e,n){return Math.max(e,Math.min(n,t))}function bS(t,e){return(t%e+e)%e}function xS(t,e,n){return(1-n)*t+n*e}function ES(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function wS(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(4294967295*t);case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int32Array:return Math.round(2147483647*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}const SS={DEG2RAD:gS,RAD2DEG:vS,generateUUID:yS,clamp:_S,euclideanModulo:bS,mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},inverseLerp:function(t,e,n){return t!==e?(n-t)/(e-t):0},lerp:xS,damp:function(t,e,n,i){return xS(t,e,1-Math.exp(-n*i))},pingpong:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e-Math.abs(bS(t,2*e)-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){void 0!==t&&(mS=t);let e=mS+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function(t){return t*gS},radToDeg:function(t){return t*vS},isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,i,r){const s=Math.cos,a=Math.sin,o=s(n/2),l=a(n/2),c=s((e+i)/2),u=a((e+i)/2),h=s((e-i)/2),d=a((e-i)/2),f=s((i-e)/2),p=a((i-e)/2);switch(r){case"XYX":t.set(o*u,l*h,l*d,o*c);break;case"YZY":t.set(l*d,o*u,l*h,o*c);break;case"ZXZ":t.set(l*h,l*d,o*u,o*c);break;case"XZX":t.set(o*u,l*p,l*f,o*c);break;case"YXY":t.set(l*f,o*u,l*p,o*c);break;case"ZYZ":t.set(l*p,l*f,o*u,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:wS,denormalize:ES};class TS{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;TS.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=_S(this.x,t.x,e.x),this.y=_S(this.y,t.y,e.y),this}clampScalar(t,e){return this.x=_S(this.x,t,e),this.y=_S(this.y,t,e),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(_S(n,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(_S(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,s=this.y-t.y;return this.x=r*n-s*i+t.x,this.y=r*i+s*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class MS{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=i}static slerpFlat(t,e,n,i,r,s,a){let o=n[i+0],l=n[i+1],c=n[i+2],u=n[i+3];const h=r[s+0],d=r[s+1],f=r[s+2],p=r[s+3];if(0===a)return t[e+0]=o,t[e+1]=l,t[e+2]=c,void(t[e+3]=u);if(1===a)return t[e+0]=h,t[e+1]=d,t[e+2]=f,void(t[e+3]=p);if(u!==p||o!==h||l!==d||c!==f){let t=1-a;const e=o*h+l*d+c*f+u*p,n=e>=0?1:-1,i=1-e*e;if(i>Number.EPSILON){const r=Math.sqrt(i),s=Math.atan2(r,e*n);t=Math.sin(t*s)/r,a=Math.sin(a*s)/r}const r=a*n;if(o=o*t+h*r,l=l*t+d*r,c=c*t+f*r,u=u*t+p*r,t===1-a){const t=1/Math.sqrt(o*o+l*l+c*c+u*u);o*=t,l*=t,c*=t,u*=t}}t[e]=o,t[e+1]=l,t[e+2]=c,t[e+3]=u}static multiplyQuaternionsFlat(t,e,n,i,r,s){const a=n[i],o=n[i+1],l=n[i+2],c=n[i+3],u=r[s],h=r[s+1],d=r[s+2],f=r[s+3];return t[e]=a*f+c*u+o*d-l*h,t[e+1]=o*f+c*h+l*u-a*d,t[e+2]=l*f+c*d+a*h-o*u,t[e+3]=c*f-a*u-o*h-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=t._x,i=t._y,r=t._z,s=t._order,a=Math.cos,o=Math.sin,l=a(n/2),c=a(i/2),u=a(r/2),h=o(n/2),d=o(i/2),f=o(r/2);switch(s){case"XYZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"YXZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"ZXY":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"ZYX":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"YZX":this._x=h*c*u+l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u-h*d*f;break;case"XZY":this._x=h*c*u-l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],i=e[4],r=e[8],s=e[1],a=e[5],o=e[9],l=e[2],c=e[6],u=e[10],h=n+a+u;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(c-o)*t,this._y=(r-l)*t,this._z=(s-i)*t}else if(n>a&&n>u){const t=2*Math.sqrt(1+n-a-u);this._w=(c-o)/t,this._x=.25*t,this._y=(i+s)/t,this._z=(r+l)/t}else if(a>u){const t=2*Math.sqrt(1+a-n-u);this._w=(r-l)/t,this._x=(i+s)/t,this._y=.25*t,this._z=(o+c)/t}else{const t=2*Math.sqrt(1+u-n-a);this._w=(s-i)/t,this._x=(r+l)/t,this._y=(o+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<1e-8?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(_S(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,i=t._y,r=t._z,s=t._w,a=e._x,o=e._y,l=e._z,c=e._w;return this._x=n*c+s*a+i*l-r*o,this._y=i*c+s*o+r*a-n*l,this._z=r*c+s*l+n*o-i*a,this._w=s*c-n*a-i*o-r*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,i=this._y,r=this._z,s=this._w;let a=s*t._w+n*t._x+i*t._y+r*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;const o=1-a*a;if(o<=Number.EPSILON){const t=1-e;return this._w=t*s+e*this._w,this._x=t*n+e*this._x,this._y=t*i+e*this._y,this._z=t*r+e*this._z,this.normalize(),this}const l=Math.sqrt(o),c=Math.atan2(l,a),u=Math.sin((1-e)*c)/l,h=Math.sin(e*c)/l;return this._w=s*u+this._w*h,this._x=n*u+this._x*h,this._y=i*u+this._y*h,this._z=r*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(i*Math.sin(t),i*Math.cos(t),r*Math.sin(e),r*Math.cos(e))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class AS{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;AS.prototype.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(RS.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(RS.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=t.elements,s=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(t){const e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,a=t.z,o=t.w,l=2*(s*i-a*n),c=2*(a*e-r*i),u=2*(r*n-s*e);return this.x=e+o*l+s*u-a*c,this.y=n+o*c+a*l-r*u,this.z=i+o*u+r*c-s*l,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=_S(this.x,t.x,e.x),this.y=_S(this.y,t.y,e.y),this.z=_S(this.z,t.z,e.z),this}clampScalar(t,e){return this.x=_S(this.x,t,e),this.y=_S(this.y,t,e),this.z=_S(this.z,t,e),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(_S(n,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,i=t.y,r=t.z,s=e.x,a=e.y,o=e.z;return this.x=i*o-r*a,this.y=r*s-n*o,this.z=n*a-i*s,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return CS.copy(this).projectOnVector(t),this.sub(CS)}reflect(t){return this.sub(CS.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(_S(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,e=2*Math.random()-1,n=Math.sqrt(1-e*e);return this.x=n*Math.cos(t),this.y=e,this.z=n*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const CS=new AS,RS=new MS;class kS{constructor(t,e,n,i,r,s,a,o,l){kS.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,e,n,i,r,s,a,o,l)}set(t,e,n,i,r,s,a,o,l){const c=this.elements;return c[0]=t,c[1]=i,c[2]=a,c[3]=e,c[4]=r,c[5]=o,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,s=n[0],a=n[3],o=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],f=n[8],p=i[0],m=i[3],g=i[6],v=i[1],y=i[4],_=i[7],b=i[2],x=i[5],E=i[8];return r[0]=s*p+a*v+o*b,r[3]=s*m+a*y+o*x,r[6]=s*g+a*_+o*E,r[1]=l*p+c*v+u*b,r[4]=l*m+c*y+u*x,r[7]=l*g+c*_+u*E,r[2]=h*p+d*v+f*b,r[5]=h*m+d*y+f*x,r[8]=h*g+d*_+f*E,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],c=t[8];return e*s*c-e*a*l-n*r*c+n*a*o+i*r*l-i*s*o}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],c=t[8],u=c*s-a*l,h=a*o-c*r,d=l*r-s*o,f=e*u+n*h+i*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const p=1/f;return t[0]=u*p,t[1]=(i*l-c*n)*p,t[2]=(a*n-i*s)*p,t[3]=h*p,t[4]=(c*e-i*o)*p,t[5]=(i*r-a*e)*p,t[6]=d*p,t[7]=(n*o-l*e)*p,t[8]=(s*e-n*r)*p,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,r,s,a){const o=Math.cos(r),l=Math.sin(r);return this.set(n*o,n*l,-n*(o*s+l*a)+s+t,-i*l,i*o,-i*(-l*s+o*a)+a+e,0,0,1),this}scale(t,e){return this.premultiply(LS.makeScale(t,e)),this}rotate(t){return this.premultiply(LS.makeRotation(-t)),this}translate(t,e){return this.premultiply(LS.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const LS=new kS;function DS(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function PS(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function IS(){const t=PS("canvas");return t.style.display="block",t}const OS={};function NS(t){t in OS||(OS[t]=!0,console.warn(t))}const FS=(new kS).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),US=(new kS).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function BS(){const t={enabled:!0,workingColorSpace:Zw,spaces:{},convert:function(t,e,n){return!1!==this.enabled&&e!==n&&e&&n?(this.spaces[e].transfer===$w&&(t.r=HS(t.r),t.g=HS(t.g),t.b=HS(t.b)),this.spaces[e].primaries!==this.spaces[n].primaries&&(t.applyMatrix3(this.spaces[e].toXYZ),t.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===$w&&(t.r=VS(t.r),t.g=VS(t.g),t.b=VS(t.b)),t):t},workingToColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},colorSpaceToWorking:function(t,e){return this.convert(t,e,this.workingColorSpace)},getPrimaries:function(t){return this.spaces[t].primaries},getTransfer:function(t){return t===qw?Jw:this.spaces[t].transfer},getLuminanceCoefficients:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.workingColorSpace;return t.fromArray(this.spaces[e].luminanceCoefficients)},define:function(t){Object.assign(this.spaces,t)},_getMatrix:function(t,e,n){return t.copy(this.spaces[e].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(t){return this.spaces[t].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.workingColorSpace;return this.spaces[t].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(e,n){return NS("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),t.workingToColorSpace(e,n)},toWorkingColorSpace:function(e,n){return NS("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),t.colorSpaceToWorking(e,n)}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],i=[.3127,.329];return t.define({[Zw]:{primaries:e,whitePoint:i,transfer:Jw,toXYZ:FS,fromXYZ:US,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:Qw},outputColorSpaceConfig:{drawingBufferColorSpace:Qw}},[Qw]:{primaries:e,whitePoint:i,transfer:$w,toXYZ:FS,fromXYZ:US,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:Qw}}}),t}const zS=BS();function HS(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function VS(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let GS;class jS{static getDataURL(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png";if(/^data:/i.test(t.src))return t.src;if("undefined"===typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)e=t;else{void 0===GS&&(GS=PS("canvas")),GS.width=t.width,GS.height=t.height;const n=GS.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=GS}return e.toDataURL(n)}static sRGBToLinear(t){if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap){const e=PS("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const i=n.getImageData(0,0,t.width,t.height),r=i.data;for(let t=0;t<r.length;t++)r[t]=255*HS(r[t]/255);return n.putImageData(i,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*HS(e[t]/255)):e[t]=HS(e[t]);return{data:e,width:t.width,height:t.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let WS=0;class YS{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,Object.defineProperty(this,"id",{value:WS++}),this.uuid=yS(),this.data=t,this.dataReady=!0,this.version=0}getSize(t){const e=this.data;return e instanceof HTMLVideoElement?t.set(e.videoWidth,e.videoHeight,0):e instanceof VideoFrame?t.set(e.displayHeight,e.displayWidth,0):null!==e?t.set(e.width,e.height,e.depth||0):t.set(0,0,0),t}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let t;if(Array.isArray(i)){t=[];for(let e=0,n=i.length;e<n;e++)i[e].isDataTexture?t.push(XS(i[e].image)):t.push(XS(i[e]))}else t=XS(i);n.url=t}return e||(t.images[this.uuid]=n),n}}function XS(t){return"undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?jS.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let KS=0;const qS=new AS;class QS extends fS{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:QS.DEFAULT_IMAGE,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:QS.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:BE,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:BE,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:jE,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:YE,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:sw,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:XE,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:QS.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:qw;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:KS++}),this.uuid=yS(),this.name="",this.source=new YS(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new TS(0,0),this.repeat=new TS(1,1),this.center=new TS(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new kS,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(t&&t.depth&&t.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(qS).x}get height(){return this.source.getSize(qS).y}get depth(){return this.source.getSize(qS).z}get image(){return this.source.data}set image(t){void 0===t&&(t=null),this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.isArrayTexture=t.isArrayTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}setValues(t){for(const e in t){const n=t[e];if(void 0===n){console.warn("THREE.Texture.setValues(): parameter '".concat(e,"' has value of undefined."));continue}const i=this[e];void 0!==i?i&&n&&i.isVector2&&n.isVector2||i&&n&&i.isVector3&&n.isVector3||i&&n&&i.isMatrix3&&n.isMatrix3?i.copy(n):this[e]=n:console.warn("THREE.Texture.setValues(): property '".concat(e,"' does not exist."))}}toJSON(t){const e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case UE:t.x=t.x-Math.floor(t.x);break;case BE:t.x=t.x<0?0:1;break;case zE:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case UE:t.y=t.y-Math.floor(t.y);break;case BE:t.y=t.y<0?0:1;break;case zE:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){!0===t&&this.pmremVersion++}}QS.DEFAULT_IMAGE=null,QS.DEFAULT_MAPPING=300,QS.DEFAULT_ANISOTROPY=1;class ZS{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;ZS.prototype.isVector4=!0,this.x=t,this.y=e,this.z=n,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*e+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*e+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*e+s[7]*n+s[11]*i+s[15]*r,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,i,r;const s=.01,a=.1,o=t.elements,l=o[0],c=o[4],u=o[8],h=o[1],d=o[5],f=o[9],p=o[2],m=o[6],g=o[10];if(Math.abs(c-h)<s&&Math.abs(u-p)<s&&Math.abs(f-m)<s){if(Math.abs(c+h)<a&&Math.abs(u+p)<a&&Math.abs(f+m)<a&&Math.abs(l+d+g-3)<a)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,o=(d+1)/2,v=(g+1)/2,y=(c+h)/4,_=(u+p)/4,b=(f+m)/4;return t>o&&t>v?t<s?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(t),i=y/n,r=_/n):o>v?o<s?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(o),n=y/i,r=b/i):v<s?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(v),n=_/r,i=b/r),this.set(n,i,r,e),this}let v=Math.sqrt((m-f)*(m-f)+(u-p)*(u-p)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(m-f)/v,this.y=(u-p)/v,this.z=(h-c)/v,this.w=Math.acos((l+d+g-1)/2),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this.w=e[15],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=_S(this.x,t.x,e.x),this.y=_S(this.y,t.y,e.y),this.z=_S(this.z,t.z,e.z),this.w=_S(this.w,t.w,e.w),this}clampScalar(t,e){return this.x=_S(this.x,t,e),this.y=_S(this.y,t,e),this.z=_S(this.z,t,e),this.w=_S(this.w,t,e),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(_S(n,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class JS extends fS{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:jE,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=t,this.height=e,this.depth=n.depth,this.scissor=new ZS(0,0,t,e),this.scissorTest=!1,this.viewport=new ZS(0,0,t,e);const i={width:t,height:e,depth:n.depth},r=new QS(i);this.textures=[];const s=n.count;for(let a=0;a<s;a++)this.textures[a]=r.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e={minFilter:jE,generateMipmaps:!1,flipY:!1,internalFormat:null};void 0!==t.mapping&&(e.mapping=t.mapping),void 0!==t.wrapS&&(e.wrapS=t.wrapS),void 0!==t.wrapT&&(e.wrapT=t.wrapT),void 0!==t.wrapR&&(e.wrapR=t.wrapR),void 0!==t.magFilter&&(e.magFilter=t.magFilter),void 0!==t.minFilter&&(e.minFilter=t.minFilter),void 0!==t.format&&(e.format=t.format),void 0!==t.type&&(e.type=t.type),void 0!==t.anisotropy&&(e.anisotropy=t.anisotropy),void 0!==t.colorSpace&&(e.colorSpace=t.colorSpace),void 0!==t.flipY&&(e.flipY=t.flipY),void 0!==t.generateMipmaps&&(e.generateMipmaps=t.generateMipmaps),void 0!==t.internalFormat&&(e.internalFormat=t.internalFormat);for(let n=0;n<this.textures.length;n++){this.textures[n].setValues(e)}}get texture(){return this.textures[0]}set texture(t){this.textures[0]=t}set depthTexture(t){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==t&&(t.renderTarget=this),this._depthTexture=t}get depthTexture(){return this._depthTexture}setSize(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let i=0,r=this.textures.length;i<r;i++)this.textures[i].image.width=t,this.textures[i].image.height=e,this.textures[i].image.depth=n,this.textures[i].isArrayTexture=this.textures[i].image.depth>1;this.dispose()}this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.textures.length=0;for(let e=0,n=t.textures.length;e<n;e++){this.textures[e]=t.textures[e].clone(),this.textures[e].isRenderTargetTexture=!0,this.textures[e].renderTarget=this;const n=Object.assign({},t.textures[e].image);this.textures[e].source=new YS(n)}return this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.resolveDepthBuffer=t.resolveDepthBuffer,this.resolveStencilBuffer=t.resolveStencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class $S extends JS{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.isWebGLRenderTarget=!0}}class tT extends QS{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:n,depth:i},this.magFilter=HE,this.minFilter=HE,this.wrapR=BE,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(t){this.layerUpdates.add(t)}clearLayerUpdates(){this.layerUpdates.clear()}}class eT extends QS{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:n,depth:i},this.magFilter=HE,this.minFilter=HE,this.wrapR=BE,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class nT{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new AS(1/0,1/0,1/0),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new AS(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e+=3)this.expandByPoint(rT.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,n=t.count;e<n;e++)this.expandByPoint(rT.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=rT.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.updateWorldMatrix(!1,!1);const n=t.geometry;if(void 0!==n){const i=n.getAttribute("position");if(!0===e&&void 0!==i&&!0!==t.isInstancedMesh)for(let e=0,n=i.count;e<n;e++)!0===t.isMesh?t.getVertexPosition(e,rT):rT.fromBufferAttribute(i,e),rT.applyMatrix4(t.matrixWorld),this.expandByPoint(rT);else void 0!==t.boundingBox?(null===t.boundingBox&&t.computeBoundingBox(),sT.copy(t.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),sT.copy(n.boundingBox)),sT.applyMatrix4(t.matrixWorld),this.union(sT)}const i=t.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],e);return this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y&&t.max.z>=this.min.z&&t.min.z<=this.max.z}intersectsSphere(t){return this.clampPoint(t.center,rT),rT.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(dT),fT.subVectors(this.max,dT),aT.subVectors(t.a,dT),oT.subVectors(t.b,dT),lT.subVectors(t.c,dT),cT.subVectors(oT,aT),uT.subVectors(lT,oT),hT.subVectors(aT,lT);let e=[0,-cT.z,cT.y,0,-uT.z,uT.y,0,-hT.z,hT.y,cT.z,0,-cT.x,uT.z,0,-uT.x,hT.z,0,-hT.x,-cT.y,cT.x,0,-uT.y,uT.x,0,-hT.y,hT.x,0];return!!gT(e,aT,oT,lT,fT)&&(e=[1,0,0,0,1,0,0,0,1],!!gT(e,aT,oT,lT,fT)&&(pT.crossVectors(cT,uT),e=[pT.x,pT.y,pT.z],gT(e,aT,oT,lT,fT)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,rT).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=.5*this.getSize(rT).length()),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(iT[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),iT[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),iT[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),iT[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),iT[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),iT[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),iT[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),iT[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(iT)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(t){return this.min.fromArray(t.min),this.max.fromArray(t.max),this}}const iT=[new AS,new AS,new AS,new AS,new AS,new AS,new AS,new AS],rT=new AS,sT=new nT,aT=new AS,oT=new AS,lT=new AS,cT=new AS,uT=new AS,hT=new AS,dT=new AS,fT=new AS,pT=new AS,mT=new AS;function gT(t,e,n,i,r){for(let s=0,a=t.length-3;s<=a;s+=3){mT.fromArray(t,s);const a=r.x*Math.abs(mT.x)+r.y*Math.abs(mT.y)+r.z*Math.abs(mT.z),o=e.dot(mT),l=n.dot(mT),c=i.dot(mT);if(Math.max(-Math.max(o,l,c),Math.min(o,l,c))>a)return!1}return!0}const vT=new nT,yT=new AS,_T=new AS;class bT{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new AS,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.isSphere=!0,this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):vT.setFromPoints(t).getCenter(n);let i=0;for(let r=0,s=t.length;r<s;r++)i=Math.max(i,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;yT.subVectors(t,this.center);const e=yT.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.addScaledVector(yT,n/t),this.radius+=n}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(!0===this.center.equals(t.center)?this.radius=Math.max(this.radius,t.radius):(_T.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(yT.copy(t.center).add(_T)),this.expandByPoint(yT.copy(t.center).sub(_T))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(t){return this.radius=t.radius,this.center.fromArray(t.center),this}}const xT=new AS,ET=new AS,wT=new AS,ST=new AS,TT=new AS,MT=new AS,AT=new AS;class CT{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new AS,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new AS(0,0,-1);this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,xT)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=xT.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(xT.copy(this.origin).addScaledVector(this.direction,e),xT.distanceToSquared(t))}distanceSqToSegment(t,e,n,i){ET.copy(t).add(e).multiplyScalar(.5),wT.copy(e).sub(t).normalize(),ST.copy(this.origin).sub(ET);const r=.5*t.distanceTo(e),s=-this.direction.dot(wT),a=ST.dot(this.direction),o=-ST.dot(wT),l=ST.lengthSq(),c=Math.abs(1-s*s);let u,h,d,f;if(c>0)if(u=s*o-a,h=s*a-o,f=r*c,u>=0)if(h>=-f)if(h<=f){const t=1/c;u*=t,h*=t,d=u*(u+s*h+2*a)+h*(s*u+h+2*o)+l}else h=r,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h=-r,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h<=-f?(u=Math.max(0,-(-s*r+a)),h=u>0?-r:Math.min(Math.max(-r,-o),r),d=-u*u+h*(h+2*o)+l):h<=f?(u=0,h=Math.min(Math.max(-r,-o),r),d=h*(h+2*o)+l):(u=Math.max(0,-(s*r+a)),h=u>0?r:Math.min(Math.max(-r,-o),r),d=-u*u+h*(h+2*o)+l);else h=s>0?-r:r,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,u),i&&i.copy(ET).addScaledVector(wT,h),d}intersectSphere(t,e){xT.subVectors(t.center,this.origin);const n=xT.dot(this.direction),i=xT.dot(xT)-n*n,r=t.radius*t.radius;if(i>r)return null;const s=Math.sqrt(r-i),a=n-s,o=n+s;return o<0?null:a<0?this.at(o,e):this.at(a,e)}intersectsSphere(t){return!(t.radius<0)&&this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,i,r,s,a,o;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,i=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,i=(t.min.x-h.x)*l),c>=0?(r=(t.min.y-h.y)*c,s=(t.max.y-h.y)*c):(r=(t.max.y-h.y)*c,s=(t.min.y-h.y)*c),n>s||r>i?null:((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),u>=0?(a=(t.min.z-h.z)*u,o=(t.max.z-h.z)*u):(a=(t.max.z-h.z)*u,o=(t.min.z-h.z)*u),n>o||a>i?null:((a>n||n!==n)&&(n=a),(o<i||i!==i)&&(i=o),i<0?null:this.at(n>=0?n:i,e)))}intersectsBox(t){return null!==this.intersectBox(t,xT)}intersectTriangle(t,e,n,i,r){TT.subVectors(e,t),MT.subVectors(n,t),AT.crossVectors(TT,MT);let s,a=this.direction.dot(AT);if(a>0){if(i)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}ST.subVectors(this.origin,t);const o=s*this.direction.dot(MT.crossVectors(ST,MT));if(o<0)return null;const l=s*this.direction.dot(TT.cross(ST));if(l<0)return null;if(o+l>a)return null;const c=-s*ST.dot(AT);return c<0?null:this.at(c/a,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class RT{constructor(t,e,n,i,r,s,a,o,l,c,u,h,d,f,p,m){RT.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,e,n,i,r,s,a,o,l,c,u,h,d,f,p,m)}set(t,e,n,i,r,s,a,o,l,c,u,h,d,f,p,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=i,g[1]=r,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new RT).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,i=1/kT.setFromMatrixColumn(t,0).length(),r=1/kT.setFromMatrixColumn(t,1).length(),s=1/kT.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,n=t.x,i=t.y,r=t.z,s=Math.cos(n),a=Math.sin(n),o=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if("XYZ"===t.order){const t=s*c,n=s*u,i=a*c,r=a*u;e[0]=o*c,e[4]=-o*u,e[8]=l,e[1]=n+i*l,e[5]=t-r*l,e[9]=-a*o,e[2]=r-t*l,e[6]=i+n*l,e[10]=s*o}else if("YXZ"===t.order){const t=o*c,n=o*u,i=l*c,r=l*u;e[0]=t+r*a,e[4]=i*a-n,e[8]=s*l,e[1]=s*u,e[5]=s*c,e[9]=-a,e[2]=n*a-i,e[6]=r+t*a,e[10]=s*o}else if("ZXY"===t.order){const t=o*c,n=o*u,i=l*c,r=l*u;e[0]=t-r*a,e[4]=-s*u,e[8]=i+n*a,e[1]=n+i*a,e[5]=s*c,e[9]=r-t*a,e[2]=-s*l,e[6]=a,e[10]=s*o}else if("ZYX"===t.order){const t=s*c,n=s*u,i=a*c,r=a*u;e[0]=o*c,e[4]=i*l-n,e[8]=t*l+r,e[1]=o*u,e[5]=r*l+t,e[9]=n*l-i,e[2]=-l,e[6]=a*o,e[10]=s*o}else if("YZX"===t.order){const t=s*o,n=s*l,i=a*o,r=a*l;e[0]=o*c,e[4]=r-t*u,e[8]=i*u+n,e[1]=u,e[5]=s*c,e[9]=-a*c,e[2]=-l*c,e[6]=n*u+i,e[10]=t-r*u}else if("XZY"===t.order){const t=s*o,n=s*l,i=a*o,r=a*l;e[0]=o*c,e[4]=-u,e[8]=l*c,e[1]=t*u+r,e[5]=s*c,e[9]=n*u-i,e[2]=i*u-n,e[6]=a*c,e[10]=r*u+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(DT,t,PT)}lookAt(t,e,n){const i=this.elements;return NT.subVectors(t,e),0===NT.lengthSq()&&(NT.z=1),NT.normalize(),IT.crossVectors(n,NT),0===IT.lengthSq()&&(1===Math.abs(n.z)?NT.x+=1e-4:NT.z+=1e-4,NT.normalize(),IT.crossVectors(n,NT)),IT.normalize(),OT.crossVectors(NT,IT),i[0]=IT.x,i[4]=OT.x,i[8]=NT.x,i[1]=IT.y,i[5]=OT.y,i[9]=NT.y,i[2]=IT.z,i[6]=OT.z,i[10]=NT.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,s=n[0],a=n[4],o=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],b=n[15],x=i[0],E=i[4],w=i[8],S=i[12],T=i[1],M=i[5],A=i[9],C=i[13],R=i[2],k=i[6],L=i[10],D=i[14],P=i[3],I=i[7],O=i[11],N=i[15];return r[0]=s*x+a*T+o*R+l*P,r[4]=s*E+a*M+o*k+l*I,r[8]=s*w+a*A+o*L+l*O,r[12]=s*S+a*C+o*D+l*N,r[1]=c*x+u*T+h*R+d*P,r[5]=c*E+u*M+h*k+d*I,r[9]=c*w+u*A+h*L+d*O,r[13]=c*S+u*C+h*D+d*N,r[2]=f*x+p*T+m*R+g*P,r[6]=f*E+p*M+m*k+g*I,r[10]=f*w+p*A+m*L+g*O,r[14]=f*S+p*C+m*D+g*N,r[3]=v*x+y*T+_*R+b*P,r[7]=v*E+y*M+_*k+b*I,r[11]=v*w+y*A+_*L+b*O,r[15]=v*S+y*C+_*D+b*N,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],s=t[1],a=t[5],o=t[9],l=t[13],c=t[2],u=t[6],h=t[10],d=t[14];return t[3]*(+r*o*u-i*l*u-r*a*h+n*l*h+i*a*d-n*o*d)+t[7]*(+e*o*d-e*l*h+r*s*h-i*s*d+i*l*c-r*o*c)+t[11]*(+e*l*u-e*a*d-r*s*u+n*s*d+r*a*c-n*l*c)+t[15]*(-i*a*c-e*o*u+e*a*h+i*s*u-n*s*h+n*o*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15],v=u*m*l-p*h*l+p*o*d-a*m*d-u*o*g+a*h*g,y=f*h*l-c*m*l-f*o*d+s*m*d+c*o*g-s*h*g,_=c*p*l-f*u*l+f*a*d-s*p*d-c*a*g+s*u*g,b=f*u*o-c*p*o-f*a*h+s*p*h+c*a*m-s*u*m,x=e*v+n*y+i*_+r*b;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/x;return t[0]=v*E,t[1]=(p*h*r-u*m*r-p*i*d+n*m*d+u*i*g-n*h*g)*E,t[2]=(a*m*r-p*o*r+p*i*l-n*m*l-a*i*g+n*o*g)*E,t[3]=(u*o*r-a*h*r-u*i*l+n*h*l+a*i*d-n*o*d)*E,t[4]=y*E,t[5]=(c*m*r-f*h*r+f*i*d-e*m*d-c*i*g+e*h*g)*E,t[6]=(f*o*r-s*m*r-f*i*l+e*m*l+s*i*g-e*o*g)*E,t[7]=(s*h*r-c*o*r+c*i*l-e*h*l-s*i*d+e*o*d)*E,t[8]=_*E,t[9]=(f*u*r-c*p*r-f*n*d+e*p*d+c*n*g-e*u*g)*E,t[10]=(s*p*r-f*a*r+f*n*l-e*p*l-s*n*g+e*a*g)*E,t[11]=(c*a*r-s*u*r-c*n*l+e*u*l+s*n*d-e*a*d)*E,t[12]=b*E,t[13]=(c*p*i-f*u*i+f*n*h-e*p*h-c*n*m+e*u*m)*E,t[14]=(f*a*i-s*p*i-f*n*o+e*p*o+s*n*m-e*a*m)*E,t[15]=(s*u*i-c*a*i+c*n*o-e*u*o-s*n*h+e*a*h)*E,this}scale(t){const e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}makeTranslation(t,e,n){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),i=Math.sin(e),r=1-n,s=t.x,a=t.y,o=t.z,l=r*s,c=r*a;return this.set(l*s+n,l*a-i*o,l*o+i*a,0,l*a+i*o,c*a+n,c*o-i*s,0,l*o-i*a,c*o+i*s,r*o*o+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,i,r,s){return this.set(1,n,r,0,t,1,s,0,e,i,1,0,0,0,0,1),this}compose(t,e,n){const i=this.elements,r=e._x,s=e._y,a=e._z,o=e._w,l=r+r,c=s+s,u=a+a,h=r*l,d=r*c,f=r*u,p=s*c,m=s*u,g=a*u,v=o*l,y=o*c,_=o*u,b=n.x,x=n.y,E=n.z;return i[0]=(1-(p+g))*b,i[1]=(d+_)*b,i[2]=(f-y)*b,i[3]=0,i[4]=(d-_)*x,i[5]=(1-(h+g))*x,i[6]=(m+v)*x,i[7]=0,i[8]=(f+y)*E,i[9]=(m-v)*E,i[10]=(1-(h+p))*E,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,n){const i=this.elements;let r=kT.set(i[0],i[1],i[2]).length();const s=kT.set(i[4],i[5],i[6]).length(),a=kT.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],LT.copy(this);const o=1/r,l=1/s,c=1/a;return LT.elements[0]*=o,LT.elements[1]*=o,LT.elements[2]*=o,LT.elements[4]*=l,LT.elements[5]*=l,LT.elements[6]*=l,LT.elements[8]*=c,LT.elements[9]*=c,LT.elements[10]*=c,e.setFromRotationMatrix(LT),n.x=r,n.y=s,n.z=a,this}makePerspective(t,e,n,i,r,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:hS,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=this.elements,c=2*r/(e-t),u=2*r/(n-i),h=(e+t)/(e-t),d=(n+i)/(n-i);let f,p;if(o)f=r/(s-r),p=s*r/(s-r);else if(a===hS)f=-(s+r)/(s-r),p=-2*s*r/(s-r);else{if(a!==dS)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);f=-s/(s-r),p=-s*r/(s-r)}return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=u,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(t,e,n,i,r,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:hS,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=this.elements,c=2/(e-t),u=2/(n-i),h=-(e+t)/(e-t),d=-(n+i)/(n-i);let f,p;if(o)f=1/(s-r),p=s/(s-r);else if(a===hS)f=-2/(s-r),p=-(s+r)/(s-r);else{if(a!==dS)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);f=-1/(s-r),p=-r/(s-r)}return l[0]=c,l[4]=0,l[8]=0,l[12]=h,l[1]=0,l[5]=u,l[9]=0,l[13]=d,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const kT=new AS,LT=new RT,DT=new AS(0,0,0),PT=new AS(1,1,1),IT=new AS,OT=new AS,NT=new AS,FT=new RT,UT=new MS;class BT{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:BT.DEFAULT_ORDER;this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=t.elements,r=i[0],s=i[4],a=i[8],o=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(e){case"XYZ":this._y=Math.asin(_S(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-_S(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(_S(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,r));break;case"ZYX":this._y=Math.asin(-_S(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(o,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(_S(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-_S(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return FT.makeRotationFromQuaternion(t),this.setFromRotationMatrix(FT,e,n)}setFromVector3(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(t.x,t.y,t.z,e)}reorder(t){return UT.setFromEuler(this),this.setFromQuaternion(UT,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}BT.DEFAULT_ORDER="XYZ";class zT{constructor(){this.mask=1}set(t){this.mask=1<<t>>>0}enable(t){this.mask|=1<<t}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t}disable(t){this.mask&=~(1<<t)}disableAll(){this.mask=0}test(t){return 0!==(this.mask&t.mask)}isEnabled(t){return 0!==(this.mask&1<<t)}}let HT=0;const VT=new AS,GT=new MS,jT=new RT,WT=new AS,YT=new AS,XT=new AS,KT=new MS,qT=new AS(1,0,0),QT=new AS(0,1,0),ZT=new AS(0,0,1),JT={type:"added"},$T={type:"removed"},tM={type:"childadded",child:null},eM={type:"childremoved",child:null};class nM extends fS{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:HT++}),this.uuid=yS(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=nM.DEFAULT_UP.clone();const t=new AS,e=new BT,n=new MS,i=new AS(1,1,1);e._onChange(function(){n.setFromEuler(e,!1)}),n._onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new RT},normalMatrix:{value:new kS}}),this.matrix=new RT,this.matrixWorld=new RT,this.matrixAutoUpdate=nM.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=nM.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new zT,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return GT.setFromAxisAngle(t,e),this.quaternion.multiply(GT),this}rotateOnWorldAxis(t,e){return GT.setFromAxisAngle(t,e),this.quaternion.premultiply(GT),this}rotateX(t){return this.rotateOnAxis(qT,t)}rotateY(t){return this.rotateOnAxis(QT,t)}rotateZ(t){return this.rotateOnAxis(ZT,t)}translateOnAxis(t,e){return VT.copy(t).applyQuaternion(this.quaternion),this.position.add(VT.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(qT,t)}translateY(t){return this.translateOnAxis(QT,t)}translateZ(t){return this.translateOnAxis(ZT,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(jT.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?WT.copy(t):WT.set(t,e,n);const i=this.parent;this.updateWorldMatrix(!0,!1),YT.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?jT.lookAt(YT,WT,this.up):jT.lookAt(WT,YT,this.up),this.quaternion.setFromRotationMatrix(jT),i&&(jT.extractRotation(i.matrixWorld),GT.setFromRotationMatrix(jT),this.quaternion.premultiply(GT.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(JT),tM.child=t,this.dispatchEvent(tM),tM.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent($T),eM.child=t,this.dispatchEvent(eM),eM.child=null),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),jT.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),jT.multiply(t.parent.matrixWorld)),t.applyMatrix4(jT),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(JT),tM.child=t,this.dispatchEvent(tM),tM.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}}getObjectsByProperty(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[t]===e&&n.push(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].getObjectsByProperty(t,e,n);return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(YT,t,XT),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(YT,KT,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,i=e.length;n<i;n++){e[n].updateMatrixWorld(t)}}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++){t[e].updateWorldMatrix(!1,!0)}}}toJSON(t){const e=void 0===t||"string"===typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const i={};function r(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map(t=>Rr(Rr({},t),{},{boundingBox:t.boundingBox?t.boundingBox.toJSON():void 0,boundingSphere:t.boundingSphere?t.boundingSphere.toJSON():void 0})),i.instanceInfo=this._instanceInfo.map(t=>Rr({},t)),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(t),i.indirectTexture=this._indirectTexture.toJSON(t),null!==this._colorsTexture&&(i.colorsTexture=this._colorsTexture.toJSON(t)),null!==this.boundingSphere&&(i.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(i.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,i=n.length;e<i;e++){const i=n[e];r(t.shapes,i)}else r(t.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,i=this.material.length;n<i;n++)e.push(r(t.materials,this.material[n]));i.material=e}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(let e=0;e<this.children.length;e++)i.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];i.animations.push(r(t.animations,n))}}if(e){const e=s(t.geometries),i=s(t.materials),r=s(t.textures),a=s(t.images),o=s(t.shapes),l=s(t.skeletons),c=s(t.animations),u=s(t.nodes);e.length>0&&(n.geometries=e),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),a.length>0&&(n.images=a),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=i,n;function s(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let n=0;n<t.children.length;n++){const e=t.children[n];this.add(e.clone())}return this}}nM.DEFAULT_UP=new AS(0,1,0),nM.DEFAULT_MATRIX_AUTO_UPDATE=!0,nM.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const iM=new AS,rM=new AS,sM=new AS,aM=new AS,oM=new AS,lM=new AS,cM=new AS,uM=new AS,hM=new AS,dM=new AS,fM=new ZS,pM=new ZS,mM=new ZS;class gM{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new AS,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new AS,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new AS;this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,i){i.subVectors(n,e),iM.subVectors(t,e),i.cross(iM);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(t,e,n,i,r){iM.subVectors(i,e),rM.subVectors(n,e),sM.subVectors(t,e);const s=iM.dot(iM),a=iM.dot(rM),o=iM.dot(sM),l=rM.dot(rM),c=rM.dot(sM),u=s*l-a*a;if(0===u)return r.set(0,0,0),null;const h=1/u,d=(l*o-a*c)*h,f=(s*c-a*o)*h;return r.set(1-d-f,f,d)}static containsPoint(t,e,n,i){return null!==this.getBarycoord(t,e,n,i,aM)&&(aM.x>=0&&aM.y>=0&&aM.x+aM.y<=1)}static getInterpolation(t,e,n,i,r,s,a,o){return null===this.getBarycoord(t,e,n,i,aM)?(o.x=0,o.y=0,"z"in o&&(o.z=0),"w"in o&&(o.w=0),null):(o.setScalar(0),o.addScaledVector(r,aM.x),o.addScaledVector(s,aM.y),o.addScaledVector(a,aM.z),o)}static getInterpolatedAttribute(t,e,n,i,r,s){return fM.setScalar(0),pM.setScalar(0),mM.setScalar(0),fM.fromBufferAttribute(t,e),pM.fromBufferAttribute(t,n),mM.fromBufferAttribute(t,i),s.setScalar(0),s.addScaledVector(fM,r.x),s.addScaledVector(pM,r.y),s.addScaledVector(mM,r.z),s}static isFrontFacing(t,e,n,i){return iM.subVectors(n,e),rM.subVectors(t,e),iM.cross(rM).dot(i)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,n,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,i),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return iM.subVectors(this.c,this.b),rM.subVectors(this.a,this.b),.5*iM.cross(rM).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return gM.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return gM.getBarycoord(t,this.a,this.b,this.c,e)}getInterpolation(t,e,n,i,r){return gM.getInterpolation(t,this.a,this.b,this.c,e,n,i,r)}containsPoint(t){return gM.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return gM.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,i=this.b,r=this.c;let s,a;oM.subVectors(i,n),lM.subVectors(r,n),uM.subVectors(t,n);const o=oM.dot(uM),l=lM.dot(uM);if(o<=0&&l<=0)return e.copy(n);hM.subVectors(t,i);const c=oM.dot(hM),u=lM.dot(hM);if(c>=0&&u<=c)return e.copy(i);const h=o*u-c*l;if(h<=0&&o>=0&&c<=0)return s=o/(o-c),e.copy(n).addScaledVector(oM,s);dM.subVectors(t,r);const d=oM.dot(dM),f=lM.dot(dM);if(f>=0&&d<=f)return e.copy(r);const p=d*l-o*f;if(p<=0&&l>=0&&f<=0)return a=l/(l-f),e.copy(n).addScaledVector(lM,a);const m=c*f-d*u;if(m<=0&&u-c>=0&&d-f>=0)return cM.subVectors(r,i),a=(u-c)/(u-c+(d-f)),e.copy(i).addScaledVector(cM,a);const g=1/(m+p+h);return s=p*g,a=h*g,e.copy(n).addScaledVector(oM,s).addScaledVector(lM,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const vM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},yM={h:0,s:0,l:0},_M={h:0,s:0,l:0};function bM(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}class xM{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,n)}set(t,e,n){if(void 0===e&&void 0===n){const e=t;e&&e.isColor?this.copy(e):"number"===typeof e?this.setHex(e):"string"===typeof e&&this.setStyle(e)}else this.setRGB(t,e,n);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qw;return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,zS.colorSpaceToWorking(this,e),this}setRGB(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:zS.workingColorSpace;return this.r=t,this.g=e,this.b=n,zS.colorSpaceToWorking(this,i),this}setHSL(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:zS.workingColorSpace;if(t=bS(t,1),e=_S(e,0,1),n=_S(n,0,1),0===e)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+e):n+e-n*e,r=2*n-i;this.r=bM(r,i,t+1/3),this.g=bM(r,i,t),this.b=bM(r,i,t-1/3)}return zS.colorSpaceToWorking(this,i),this}setStyle(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qw;function i(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}if(e=/^(\w+)\(([^\)]*)\)/.exec(t)){let r;const s=e[1],a=e[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,n);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,n);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(e=/^\#([A-Fa-f\d]+)$/.exec(t)){const i=e[1],r=i.length;if(3===r)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,n);if(6===r)return this.setHex(parseInt(i,16),n);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,n);return this}setColorName(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qw;const n=vM[t.toLowerCase()];return void 0!==n?this.setHex(n,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=HS(t.r),this.g=HS(t.g),this.b=HS(t.b),this}copyLinearToSRGB(t){return this.r=VS(t.r),this.g=VS(t.g),this.b=VS(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qw;return zS.workingToColorSpace(EM.copy(this),t),65536*Math.round(_S(255*EM.r,0,255))+256*Math.round(_S(255*EM.g,0,255))+Math.round(_S(255*EM.b,0,255))}getHexString(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qw;return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zS.workingColorSpace;zS.workingToColorSpace(EM.copy(this),e);const n=EM.r,i=EM.g,r=EM.b,s=Math.max(n,i,r),a=Math.min(n,i,r);let o,l;const c=(a+s)/2;if(a===s)o=0,l=0;else{const t=s-a;switch(l=c<=.5?t/(s+a):t/(2-s-a),s){case n:o=(i-r)/t+(i<r?6:0);break;case i:o=(r-n)/t+2;break;case r:o=(n-i)/t+4}o/=6}return t.h=o,t.s=l,t.l=c,t}getRGB(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zS.workingColorSpace;return zS.workingToColorSpace(EM.copy(this),e),t.r=EM.r,t.g=EM.g,t.b=EM.b,t}getStyle(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qw;zS.workingToColorSpace(EM.copy(this),t);const e=EM.r,n=EM.g,i=EM.b;return t!==Qw?"color(".concat(t," ").concat(e.toFixed(3)," ").concat(n.toFixed(3)," ").concat(i.toFixed(3),")"):"rgb(".concat(Math.round(255*e),",").concat(Math.round(255*n),",").concat(Math.round(255*i),")")}offsetHSL(t,e,n){return this.getHSL(yM),this.setHSL(yM.h+t,yM.s+e,yM.l+n)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(yM),t.getHSL(_M);const n=xS(yM.h,_M.h,e),i=xS(yM.s,_M.s,e),r=xS(yM.l,_M.l,e);return this.setHSL(n,i,r),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,n=this.g,i=this.b,r=t.elements;return this.r=r[0]*e+r[3]*n+r[6]*i,this.g=r[1]*e+r[4]*n+r[7]*i,this.b=r[2]*e+r[5]*n+r[8]*i,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const EM=new xM;xM.NAMES=vM;let wM=0;class SM extends fS{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:wM++}),this.uuid=yS(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=oE,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new xM(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=tS,this.stencilZFail=tS,this.stencilZPass=tS,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!==t>0&&this.version++,this._alphaTest=t}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){console.warn("THREE.Material: parameter '".concat(e,"' has value of undefined."));continue}const i=this[e];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n:console.warn("THREE.Material: '".concat(e,"' is not a property of THREE.").concat(this.type,"."))}}toJSON(t){const e=void 0===t||"string"===typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};function i(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),204!==this.blendSrc&&(n.blendSrc=this.blendSrc),205!==this.blendDst&&(n.blendDst=this.blendDst),this.blendEquation!==oE&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==tS&&(n.stencilFail=this.stencilFail),this.stencilZFail!==tS&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==tS&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),e){const e=i(t.textures),r=i(t.images);e.length>0&&(n.textures=e),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let i=0;i!==t;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}class TM extends SM{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new xM(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new BT,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const MM=new AS,AM=new TS;let CM=0;class RM{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:CM++}),this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=n,this.usage=cS,this.updateRanges=[],this.gpuType=$E,this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)AM.fromBufferAttribute(this,e),AM.applyMatrix3(t),this.setXY(e,AM.x,AM.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)MM.fromBufferAttribute(this,e),MM.applyMatrix3(t),this.setXYZ(e,MM.x,MM.y,MM.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)MM.fromBufferAttribute(this,e),MM.applyMatrix4(t),this.setXYZ(e,MM.x,MM.y,MM.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)MM.fromBufferAttribute(this,e),MM.applyNormalMatrix(t),this.setXYZ(e,MM.x,MM.y,MM.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)MM.fromBufferAttribute(this,e),MM.transformDirection(t),this.setXYZ(e,MM.x,MM.y,MM.z);return this}set(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(t,e),this}getComponent(t,e){let n=this.array[t*this.itemSize+e];return this.normalized&&(n=ES(n,this.array)),n}setComponent(t,e,n){return this.normalized&&(n=wS(n,this.array)),this.array[t*this.itemSize+e]=n,this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=ES(e,this.array)),e}setX(t,e){return this.normalized&&(e=wS(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=ES(e,this.array)),e}setY(t,e){return this.normalized&&(e=wS(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=ES(e,this.array)),e}setZ(t,e){return this.normalized&&(e=wS(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=ES(e,this.array)),e}setW(t,e){return this.normalized&&(e=wS(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.normalized&&(e=wS(e,this.array),n=wS(n,this.array)),this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,i){return t*=this.itemSize,this.normalized&&(e=wS(e,this.array),n=wS(n,this.array),i=wS(i,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t*=this.itemSize,this.normalized&&(e=wS(e,this.array),n=wS(n,this.array),i=wS(i,this.array),r=wS(r,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==cS&&(t.usage=this.usage),t}}class kM extends RM{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class LM extends RM{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class DM extends RM{constructor(t,e,n){super(new Float32Array(t),e,n)}}let PM=0;const IM=new RT,OM=new nM,NM=new AS,FM=new nT,UM=new nT,BM=new AS;class zM extends fS{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:PM++}),this.uuid=yS(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(DS(t)?LM:kM)(t,1):this.index=t,this}setIndirect(t){return this.indirect=t,this}getIndirect(){return this.indirect}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new kS).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return IM.makeRotationFromQuaternion(t),this.applyMatrix4(IM),this}rotateX(t){return IM.makeRotationX(t),this.applyMatrix4(IM),this}rotateY(t){return IM.makeRotationY(t),this.applyMatrix4(IM),this}rotateZ(t){return IM.makeRotationZ(t),this.applyMatrix4(IM),this}translate(t,e,n){return IM.makeTranslation(t,e,n),this.applyMatrix4(IM),this}scale(t,e,n){return IM.makeScale(t,e,n),this.applyMatrix4(IM),this}lookAt(t){return OM.lookAt(t),OM.updateMatrix(),this.applyMatrix4(OM.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(NM).negate(),this.translate(NM.x,NM.y,NM.z),this}setFromPoints(t){const e=this.getAttribute("position");if(void 0===e){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];e.push(i.x,i.y,i.z||0)}this.setAttribute("position",new DM(e,3))}else{const n=Math.min(t.length,e.count);for(let i=0;i<n;i++){const n=t[i];e.setXYZ(i,n.x,n.y,n.z||0)}t.length>e.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),e.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new nT);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new AS(-1/0,-1/0,-1/0),new AS(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,i=e.length;n<i;n++){const t=e[n];FM.setFromBufferAttribute(t),this.morphTargetsRelative?(BM.addVectors(this.boundingBox.min,FM.min),this.boundingBox.expandByPoint(BM),BM.addVectors(this.boundingBox.max,FM.max),this.boundingBox.expandByPoint(BM)):(this.boundingBox.expandByPoint(FM.min),this.boundingBox.expandByPoint(FM.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new bT);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new AS,1/0);if(t){const n=this.boundingSphere.center;if(FM.setFromBufferAttribute(t),e)for(let t=0,r=e.length;t<r;t++){const n=e[t];UM.setFromBufferAttribute(n),this.morphTargetsRelative?(BM.addVectors(FM.min,UM.min),FM.expandByPoint(BM),BM.addVectors(FM.max,UM.max),FM.expandByPoint(BM)):(FM.expandByPoint(UM.min),FM.expandByPoint(UM.max))}FM.getCenter(n);let i=0;for(let e=0,r=t.count;e<r;e++)BM.fromBufferAttribute(t,e),i=Math.max(i,n.distanceToSquared(BM));if(e)for(let r=0,s=e.length;r<s;r++){const s=e[r],a=this.morphTargetsRelative;for(let e=0,r=s.count;e<r;e++)BM.fromBufferAttribute(s,e),a&&(NM.fromBufferAttribute(t,e),BM.add(NM)),i=Math.max(i,n.distanceToSquared(BM))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.position,i=e.normal,r=e.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new RM(new Float32Array(4*n.count),4));const s=this.getAttribute("tangent"),a=[],o=[];for(let w=0;w<n.count;w++)a[w]=new AS,o[w]=new AS;const l=new AS,c=new AS,u=new AS,h=new TS,d=new TS,f=new TS,p=new AS,m=new AS;function g(t,e,i){l.fromBufferAttribute(n,t),c.fromBufferAttribute(n,e),u.fromBufferAttribute(n,i),h.fromBufferAttribute(r,t),d.fromBufferAttribute(r,e),f.fromBufferAttribute(r,i),c.sub(l),u.sub(l),d.sub(h),f.sub(h);const s=1/(d.x*f.y-f.x*d.y);isFinite(s)&&(p.copy(c).multiplyScalar(f.y).addScaledVector(u,-d.y).multiplyScalar(s),m.copy(u).multiplyScalar(d.x).addScaledVector(c,-f.x).multiplyScalar(s),a[t].add(p),a[e].add(p),a[i].add(p),o[t].add(m),o[e].add(m),o[i].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:t.count}]);for(let w=0,S=v.length;w<S;++w){const e=v[w],n=e.start;for(let i=n,r=n+e.count;i<r;i+=3)g(t.getX(i+0),t.getX(i+1),t.getX(i+2))}const y=new AS,_=new AS,b=new AS,x=new AS;function E(t){b.fromBufferAttribute(i,t),x.copy(b);const e=a[t];y.copy(e),y.sub(b.multiplyScalar(b.dot(e))).normalize(),_.crossVectors(x,e);const n=_.dot(o[t])<0?-1:1;s.setXYZW(t,y.x,y.y,y.z,n)}for(let w=0,S=v.length;w<S;++w){const e=v[w],n=e.start;for(let i=n,r=n+e.count;i<r;i+=3)E(t.getX(i+0)),E(t.getX(i+1)),E(t.getX(i+2))}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new RM(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const i=new AS,r=new AS,s=new AS,a=new AS,o=new AS,l=new AS,c=new AS,u=new AS;if(t)for(let h=0,d=t.count;h<d;h+=3){const d=t.getX(h+0),f=t.getX(h+1),p=t.getX(h+2);i.fromBufferAttribute(e,d),r.fromBufferAttribute(e,f),s.fromBufferAttribute(e,p),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),a.fromBufferAttribute(n,d),o.fromBufferAttribute(n,f),l.fromBufferAttribute(n,p),a.add(c),o.add(c),l.add(c),n.setXYZ(d,a.x,a.y,a.z),n.setXYZ(f,o.x,o.y,o.z),n.setXYZ(p,l.x,l.y,l.z)}else for(let t=0,h=e.count;t<h;t+=3)i.fromBufferAttribute(e,t+0),r.fromBufferAttribute(e,t+1),s.fromBufferAttribute(e,t+2),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),n.setXYZ(t+0,c.x,c.y,c.z),n.setXYZ(t+1,c.x,c.y,c.z),n.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)BM.fromBufferAttribute(t,e),BM.normalize(),t.setXYZ(e,BM.x,BM.y,BM.z)}toNonIndexed(){function t(t,e){const n=t.array,i=t.itemSize,r=t.normalized,s=new n.constructor(e.length*i);let a=0,o=0;for(let l=0,c=e.length;l<c;l++){a=t.isInterleavedBufferAttribute?e[l]*t.data.stride+t.offset:e[l]*i;for(let t=0;t<i;t++)s[o++]=n[a++]}return new RM(s,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new zM,n=this.index.array,i=this.attributes;for(const a in i){const r=t(i[a],n);e.setAttribute(a,r)}const r=this.morphAttributes;for(const a in r){const i=[],s=r[a];for(let e=0,r=s.length;e<r;e++){const r=t(s[e],n);i.push(r)}e.morphAttributes[a]=i}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,o=s.length;a<o;a++){const t=s[a];e.addGroup(t.start,t.count,t.materialIndex)}return e}toJSON(){const t={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const o in n){const e=n[o];t.data.attributes[o]=e.toJSON(t.data)}const i={};let r=!1;for(const o in this.morphAttributes){const e=this.morphAttributes[o],n=[];for(let i=0,r=e.length;i<r;i++){const r=e[i];n.push(r.toJSON(t.data))}n.length>0&&(i[o]=n,r=!0)}r&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return null!==a&&(t.data.boundingSphere=a.toJSON()),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone());const i=t.attributes;for(const l in i){const t=i[l];this.setAttribute(l,t.clone(e))}const r=t.morphAttributes;for(const l in r){const t=[],n=r[l];for(let i=0,r=n.length;i<r;i++)t.push(n[i].clone(e));this.morphAttributes[l]=t}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let l=0,c=s.length;l<c;l++){const t=s[l];this.addGroup(t.start,t.count,t.materialIndex)}const a=t.boundingBox;null!==a&&(this.boundingBox=a.clone());const o=t.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const HM=new RT,VM=new CT,GM=new bT,jM=new AS,WM=new AS,YM=new AS,XM=new AS,KM=new AS,qM=new AS,QM=new AS,ZM=new AS;class JM extends nM{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new zM,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new TM;super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}getVertexPosition(t,e){const n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;e.fromBufferAttribute(i,t);const a=this.morphTargetInfluences;if(r&&a){qM.set(0,0,0);for(let n=0,i=r.length;n<i;n++){const i=a[n],o=r[n];0!==i&&(KM.fromBufferAttribute(o,t),s?qM.addScaledVector(KM,i):qM.addScaledVector(KM.sub(e),i))}e.add(qM)}return e}raycast(t,e){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0!==i){if(null===n.boundingSphere&&n.computeBoundingSphere(),GM.copy(n.boundingSphere),GM.applyMatrix4(r),VM.copy(t.ray).recast(t.near),!1===GM.containsPoint(VM.origin)){if(null===VM.intersectSphere(GM,jM))return;if(VM.origin.distanceToSquared(jM)>(t.far-t.near)**2)return}HM.copy(r).invert(),VM.copy(t.ray).applyMatrix4(HM),null!==n.boundingBox&&!1===VM.intersectsBox(n.boundingBox)||this._computeIntersections(t,e,VM)}}_computeIntersections(t,e,n){let i;const r=this.geometry,s=this.material,a=r.index,o=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv1,u=r.attributes.normal,h=r.groups,d=r.drawRange;if(null!==a)if(Array.isArray(s))for(let f=0,p=h.length;f<p;f++){const r=h[f],o=s[r.materialIndex];for(let s=Math.max(r.start,d.start),h=Math.min(a.count,Math.min(r.start+r.count,d.start+d.count));s<h;s+=3){i=$M(this,o,t,n,l,c,u,a.getX(s),a.getX(s+1),a.getX(s+2)),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,e.push(i))}}else{for(let r=Math.max(0,d.start),o=Math.min(a.count,d.start+d.count);r<o;r+=3){i=$M(this,s,t,n,l,c,u,a.getX(r),a.getX(r+1),a.getX(r+2)),i&&(i.faceIndex=Math.floor(r/3),e.push(i))}}else if(void 0!==o)if(Array.isArray(s))for(let f=0,p=h.length;f<p;f++){const r=h[f],a=s[r.materialIndex];for(let s=Math.max(r.start,d.start),h=Math.min(o.count,Math.min(r.start+r.count,d.start+d.count));s<h;s+=3){i=$M(this,a,t,n,l,c,u,s,s+1,s+2),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,e.push(i))}}else{for(let r=Math.max(0,d.start),a=Math.min(o.count,d.start+d.count);r<a;r+=3){i=$M(this,s,t,n,l,c,u,r,r+1,r+2),i&&(i.faceIndex=Math.floor(r/3),e.push(i))}}}}function $M(t,e,n,i,r,s,a,o,l,c){t.getVertexPosition(o,WM),t.getVertexPosition(l,YM),t.getVertexPosition(c,XM);const u=function(t,e,n,i,r,s,a,o){let l;if(l=1===e.side?i.intersectTriangle(a,s,r,!0,o):i.intersectTriangle(r,s,a,0===e.side,o),null===l)return null;ZM.copy(o),ZM.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(ZM);return c<n.near||c>n.far?null:{distance:c,point:ZM.clone(),object:t}}(t,e,n,i,WM,YM,XM,QM);if(u){const t=new AS;gM.getBarycoord(QM,WM,YM,XM,t),r&&(u.uv=gM.getInterpolatedAttribute(r,o,l,c,t,new TS)),s&&(u.uv1=gM.getInterpolatedAttribute(s,o,l,c,t,new TS)),a&&(u.normal=gM.getInterpolatedAttribute(a,o,l,c,t,new AS),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const e={a:o,b:l,c:c,normal:new AS,materialIndex:0};gM.getNormal(WM,YM,XM,e.normal),u.face=e,u.barycoord=t}return u}class tA extends zM{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};const a=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);const o=[],l=[],c=[],u=[];let h=0,d=0;function f(t,e,n,i,r,s,f,p,m,g,v){const y=s/m,_=f/g,b=s/2,x=f/2,E=p/2,w=m+1,S=g+1;let T=0,M=0;const A=new AS;for(let a=0;a<S;a++){const s=a*_-x;for(let o=0;o<w;o++){const h=o*y-b;A[t]=h*i,A[e]=s*r,A[n]=E,l.push(A.x,A.y,A.z),A[t]=0,A[e]=0,A[n]=p>0?1:-1,c.push(A.x,A.y,A.z),u.push(o/m),u.push(1-a/g),T+=1}}for(let a=0;a<g;a++)for(let t=0;t<m;t++){const e=h+t+w*a,n=h+t+w*(a+1),i=h+(t+1)+w*(a+1),r=h+(t+1)+w*a;o.push(e,n,r),o.push(n,i,r),M+=6}a.addGroup(d,M,v),d+=M,h+=T}f("z","y","x",-1,-1,n,e,t,s,r,0),f("z","y","x",1,-1,n,e,-t,s,r,1),f("x","z","y",1,1,t,n,e,i,s,2),f("x","z","y",1,-1,t,n,-e,i,s,3),f("x","y","z",1,-1,t,e,n,i,r,4),f("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(o),this.setAttribute("position",new DM(l,3)),this.setAttribute("normal",new DM(c,3)),this.setAttribute("uv",new DM(u,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new tA(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function eA(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function nA(t){const e={};for(let n=0;n<t.length;n++){const i=eA(t[n]);for(const t in i)e[t]=i[t]}return e}function iA(t){const e=t.getRenderTarget();return null===e?t.outputColorSpace:!0===e.isXRRenderTarget?e.texture.colorSpace:zS.workingColorSpace}const rA={clone:eA,merge:nA};class sA extends SM{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=eA(t.uniforms),this.uniformsGroups=function(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?e.uniforms[i]={type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?e.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?e.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?e.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?e.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?e.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?e.uniforms[i]={type:"m4",value:n.toArray()}:e.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.lights=this.lights,e.clipping=this.clipping;const n={};for(const i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}class aA extends nM{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new RT,this.projectionMatrix=new RT,this.projectionMatrixInverse=new RT,this.coordinateSystem=hS,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const oA=new AS,lA=new TS,cA=new TS;class uA extends aA{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*vS*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*gS*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*vS*Math.atan(Math.tan(.5*gS*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(t,e,n){oA.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),e.set(oA.x,oA.y).multiplyScalar(-t/oA.z),oA.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(oA.x,oA.y).multiplyScalar(-t/oA.z)}getViewSize(t,e){return this.getViewBounds(t,lA,cA),e.subVectors(cA,lA)}setViewOffset(t,e,n,i,r,s){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*gS*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i;const s=this.view;if(null!==this.view&&this.view.enabled){const t=s.fullWidth,a=s.fullHeight;r+=s.offsetX*i/t,e-=s.offsetY*n/a,i*=s.width/t,n*=s.height/a}const a=this.filmOffset;0!==a&&(r+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}const hA=-90;class dA extends nM{constructor(t,e,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new uA(hA,1,t,e);i.layers=this.layers,this.add(i);const r=new uA(hA,1,t,e);r.layers=this.layers,this.add(r);const s=new uA(hA,1,t,e);s.layers=this.layers,this.add(s);const a=new uA(hA,1,t,e);a.layers=this.layers,this.add(a);const o=new uA(hA,1,t,e);o.layers=this.layers,this.add(o);const l=new uA(hA,1,t,e);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const t=this.coordinateSystem,e=this.children.concat(),[n,i,r,s,a,o]=e;for(const l of e)this.remove(l);if(t===hS)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else{if(t!==dS)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1)}for(const l of e)this.add(l),l.updateMatrixWorld()}update(t,e){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==t.coordinateSystem&&(this.coordinateSystem=t.coordinateSystem,this.updateCoordinateSystem());const[r,s,a,o,l,c]=this.children,u=t.getRenderTarget(),h=t.getActiveCubeFace(),d=t.getActiveMipmapLevel(),f=t.xr.enabled;t.xr.enabled=!1;const p=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0,i),t.render(e,r),t.setRenderTarget(n,1,i),t.render(e,s),t.setRenderTarget(n,2,i),t.render(e,a),t.setRenderTarget(n,3,i),t.render(e,o),t.setRenderTarget(n,4,i),t.render(e,l),n.texture.generateMipmaps=p,t.setRenderTarget(n,5,i),t.render(e,c),t.setRenderTarget(u,h,d),t.xr.enabled=f,n.texture.needsPMREMUpdate=!0}}class fA extends QS{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],arguments.length>1&&void 0!==arguments[1]?arguments[1]:PE,arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0,arguments.length>9?arguments[9]:void 0),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class pA extends $S{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,t,e),this.isWebGLCubeRenderTarget=!0;const n={width:t,height:t,depth:1},i=[n,n,n,n,n,n];this.texture=new fA(i),this._setTextureOptions(e),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.colorSpace=e.colorSpace,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={tEquirect:{value:null}},i="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new tA(5,5,5),a=new sA({name:"CubemapFromEquirect",uniforms:eA(n),vertexShader:i,fragmentShader:r,side:1,blending:0});a.uniforms.tEquirect.value=e;const o=new JM(s,a),l=e.minFilter;e.minFilter===YE&&(e.minFilter=jE);return new dA(1,10,this).update(t,o),e.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,n,i);t.setRenderTarget(r)}}class mA extends nM{constructor(){super(),this.isGroup=!0,this.type="Group"}}const gA={type:"move"};class vA{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new mA,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new mA,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new AS,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new AS),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new mA,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new AS,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new AS),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const e=this._hand;if(e)for(const n of t.hand.values())this._getHandJoint(e,n)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let i=null,r=null,s=null;const a=this._targetRay,o=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState){if(l&&t.hand){s=!0;for(const s of t.hand.values()){const t=e.getJointPose(s,n),i=this._getHandJoint(l,s);null!==t&&(i.matrix.fromArray(t.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.matrixWorldNeedsUpdate=!0,i.jointRadius=t.radius),i.visible=null!==t}const i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],a=i.position.distanceTo(r.position),o=.02,c=.005;l.inputState.pinching&&a>o+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&a<=o-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==o&&t.gripSpace&&(r=e.getPose(t.gripSpace,n),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1));null!==a&&(i=e.getPose(t.targetRaySpace,n),null===i&&null!==r&&(i=r),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(gA)))}return null!==a&&(a.visible=null!==i),null!==o&&(o.visible=null!==r),null!==l&&(l.visible=null!==s),this}_getHandJoint(t,e){if(void 0===t.joints[e.jointName]){const n=new mA;n.matrixAutoUpdate=!1,n.visible=!1,t.joints[e.jointName]=n,t.add(n)}return t.joints[e.jointName]}}class yA extends nM{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new BT,this.environmentIntensity=1,this.environmentRotation=new BT,this.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,this.backgroundRotation.copy(t.backgroundRotation),this.environmentIntensity=t.environmentIntensity,this.environmentRotation.copy(t.environmentRotation),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(e.object.backgroundIntensity=this.backgroundIntensity),e.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(e.object.environmentIntensity=this.environmentIntensity),e.object.environmentRotation=this.environmentRotation.toArray(),e}}const _A=new AS,bA=new AS,xA=new kS;class EA{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new AS(1,0,0),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const i=_A.subVectors(n,e).cross(bA.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,e){const n=t.delta(_A),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const r=-(t.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:e.copy(t.start).addScaledVector(n,r)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||xA.getNormalMatrix(t),i=this.coplanarPoint(_A).applyMatrix4(t),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const wA=new bT,SA=new TS(.5,.5),TA=new AS;class MA{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new EA,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new EA,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new EA,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new EA,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new EA,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new EA;this.planes=[t,e,n,i,r,s]}set(t,e,n,i,r,s){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(s),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hS,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.planes,r=t.elements,s=r[0],a=r[1],o=r[2],l=r[3],c=r[4],u=r[5],h=r[6],d=r[7],f=r[8],p=r[9],m=r[10],g=r[11],v=r[12],y=r[13],_=r[14],b=r[15];if(i[0].setComponents(l-s,d-c,g-f,b-v).normalize(),i[1].setComponents(l+s,d+c,g+f,b+v).normalize(),i[2].setComponents(l+a,d+u,g+p,b+y).normalize(),i[3].setComponents(l-a,d-u,g-p,b-y).normalize(),n)i[4].setComponents(o,h,m,_).normalize(),i[5].setComponents(l-o,d-h,g-m,b-_).normalize();else if(i[4].setComponents(l-o,d-h,g-m,b-_).normalize(),e===hS)i[5].setComponents(l+o,d+h,g+m,b+_).normalize();else{if(e!==dS)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e);i[5].setComponents(o,h,m,_).normalize()}return this}intersectsObject(t){if(void 0!==t.boundingSphere)null===t.boundingSphere&&t.computeBoundingSphere(),wA.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const e=t.geometry;null===e.boundingSphere&&e.computeBoundingSphere(),wA.copy(e.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(wA)}intersectsSprite(t){wA.center.set(0,0,0);const e=SA.distanceTo(t.center);return wA.radius=.7071067811865476+e,wA.applyMatrix4(t.matrixWorld),this.intersectsSphere(wA)}intersectsSphere(t){const e=this.planes,n=t.center,i=-t.radius;for(let r=0;r<6;r++){if(e[r].distanceToPoint(n)<i)return!1}return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const i=e[n];if(TA.x=i.normal.x>0?t.max.x:t.min.x,TA.y=i.normal.y>0?t.max.y:t.min.y,TA.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(TA)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class AA extends QS{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:JE,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:HE,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:HE,l=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:aw,u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1;if(c!==aw&&c!==ow)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:t,height:e,depth:u},i,r,s,a,o,c,n,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.source=new YS(Object.assign({},t.image)),this.compareFunction=t.compareFunction,this}toJSON(t){const e=super.toJSON(t);return null!==this.compareFunction&&(e.compareFunction=this.compareFunction),e}}class CA extends zM{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};const r=t/2,s=e/2,a=Math.floor(n),o=Math.floor(i),l=a+1,c=o+1,u=t/a,h=e/o,d=[],f=[],p=[],m=[];for(let g=0;g<c;g++){const t=g*h-s;for(let e=0;e<l;e++){const n=e*u-r;f.push(n,-t,0),p.push(0,0,1),m.push(e/a),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let t=0;t<a;t++){const e=t+l*g,n=t+l*(g+1),i=t+1+l*(g+1),r=t+1+l*g;d.push(e,n,r),d.push(n,i,r)}this.setIndex(d),this.setAttribute("position",new DM(f,3)),this.setAttribute("normal",new DM(p,3)),this.setAttribute("uv",new DM(m,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new CA(t.width,t.height,t.widthSegments,t.heightSegments)}}class RA extends zM{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:s,thetaLength:a},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));const o=Math.min(s+a,Math.PI);let l=0;const c=[],u=new AS,h=new AS,d=[],f=[],p=[],m=[];for(let g=0;g<=n;g++){const d=[],v=g/n;let y=0;0===g&&0===s?y=.5/e:g===n&&o===Math.PI&&(y=-.5/e);for(let n=0;n<=e;n++){const o=n/e;u.x=-t*Math.cos(i+o*r)*Math.sin(s+v*a),u.y=t*Math.cos(s+v*a),u.z=t*Math.sin(i+o*r)*Math.sin(s+v*a),f.push(u.x,u.y,u.z),h.copy(u).normalize(),p.push(h.x,h.y,h.z),m.push(o+y,1-v),d.push(l++)}c.push(d)}for(let g=0;g<n;g++)for(let t=0;t<e;t++){const e=c[g][t+1],i=c[g][t],r=c[g+1][t],a=c[g+1][t+1];(0!==g||s>0)&&d.push(e,i,a),(g!==n-1||o<Math.PI)&&d.push(i,r,a)}this.setIndex(d),this.setAttribute("position",new DM(f,3)),this.setAttribute("normal",new DM(p,3)),this.setAttribute("uv",new DM(m,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new RA(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class kA extends SM{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class LA extends SM{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}function DA(t,e){return t&&t.constructor!==e?"number"===typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t):t}function PA(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}class IA{constructor(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{let s;n:{i:if(!(t<i)){for(let s=n+2;;){if(void 0===i){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(r=i,i=e[++n],t<i)break e}s=e.length;break n}if(!(t>=r)){const a=e[1];t<a&&(n=2,r=a);for(let s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(n===s)break;if(i=r,r=e[--n-1],t>=r)break e}s=n,n=0;break n}break t}for(;n<s;){const i=n+s>>>1;t<e[i]?s=i:n=i+1}if(i=e[n],r=e[n-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i;for(let s=0;s!==i;++s)e[s]=n[r+s];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class OA extends IA{constructor(t,e,n,i){super(t,e,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Yw,endingEnd:Yw}}intervalChanged_(t,e,n){const i=this.parameterPositions;let r=t-2,s=t+1,a=i[r],o=i[s];if(void 0===a)switch(this.getSettings_().endingStart){case Xw:r=t,a=2*e-n;break;case Kw:r=i.length-2,a=e+i[r]-i[r+1];break;default:r=t,a=n}if(void 0===o)switch(this.getSettings_().endingEnd){case Xw:s=t,o=2*n-e;break;case Kw:s=1,o=n+i[1]-i[0];break;default:s=t-1,o=e}const l=.5*(n-e),c=this.valueSize;this._weightPrev=l/(e-a),this._weightNext=l/(o-n),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=t*a,l=o-a,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-e)/(i-e),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,_=d*m-d*p;for(let b=0;b!==a;++b)r[b]=g*s[c+b]+v*s[l+b]+y*s[o+b]+_*s[u+b];return r}}class NA extends IA{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=t*a,l=o-a,c=(n-e)/(i-e),u=1-c;for(let h=0;h!==a;++h)r[h]=s[l+h]*u+s[o+h]*c;return r}}class FA extends IA{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t){return this.copySampleValue_(t-1)}}class UA{constructor(t,e,n,i){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=DA(e,this.TimeBufferType),this.values=DA(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:DA(t.times,Array),values:DA(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new FA(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new NA(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new OA(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case Gw:e=this.InterpolantFactoryMethodDiscrete;break;case jw:e=this.InterpolantFactoryMethodLinear;break;case Ww:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Gw;case this.InterpolantFactoryMethodLinear:return jw;case this.InterpolantFactoryMethodSmooth:return Ww}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]*=t}return this}trim(t,e){const n=this.times,i=n.length;let r=0,s=i-1;for(;r!==i&&n[r]<t;)++r;for(;-1!==s&&n[s]>e;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);const t=this.getValueSize();this.times=n.slice(r,s),this.values=this.values.slice(r*t,s*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let a=0;a!==r;a++){const e=n[a];if("number"===typeof e&&isNaN(e)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,e),t=!1;break}if(null!==s&&s>e){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,e,s),t=!1;break}s=e}if(void 0!==i&&PA(i))for(let a=0,o=i.length;a!==o;++a){const e=i[a];if(isNaN(e)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,e),t=!1;break}}return t}optimize(){const t=this.times.slice(),e=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===Ww,r=t.length-1;let s=1;for(let a=1;a<r;++a){let r=!1;const o=t[a];if(o!==t[a+1]&&(1!==a||o!==t[0]))if(i)r=!0;else{const t=a*n,i=t-n,s=t+n;for(let a=0;a!==n;++a){const n=e[t+a];if(n!==e[i+a]||n!==e[s+a]){r=!0;break}}}if(r){if(a!==s){t[s]=t[a];const i=a*n,r=s*n;for(let t=0;t!==n;++t)e[r+t]=e[i+t]}++s}}if(r>0){t[s]=t[r];for(let t=r*n,i=s*n,a=0;a!==n;++a)e[i+a]=e[t+a];++s}return s!==t.length?(this.times=t.slice(0,s),this.values=e.slice(0,s*n)):(this.times=t,this.values=e),this}clone(){const t=this.times.slice(),e=this.values.slice(),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}UA.prototype.ValueTypeName="",UA.prototype.TimeBufferType=Float32Array,UA.prototype.ValueBufferType=Float32Array,UA.prototype.DefaultInterpolation=jw;class BA extends UA{constructor(t,e,n){super(t,e,n)}}BA.prototype.ValueTypeName="bool",BA.prototype.ValueBufferType=Array,BA.prototype.DefaultInterpolation=Gw,BA.prototype.InterpolantFactoryMethodLinear=void 0,BA.prototype.InterpolantFactoryMethodSmooth=void 0;class zA extends UA{constructor(t,e,n,i){super(t,e,n,i)}}zA.prototype.ValueTypeName="color";class HA extends UA{constructor(t,e,n,i){super(t,e,n,i)}}HA.prototype.ValueTypeName="number";class VA extends IA{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(n-e)/(i-e);let l=t*a;for(let c=l+a;l!==c;l+=4)MS.slerpFlat(r,0,s,l-a,s,l,o);return r}}class GA extends UA{constructor(t,e,n,i){super(t,e,n,i)}InterpolantFactoryMethodLinear(t){return new VA(this.times,this.values,this.getValueSize(),t)}}GA.prototype.ValueTypeName="quaternion",GA.prototype.InterpolantFactoryMethodSmooth=void 0;class jA extends UA{constructor(t,e,n){super(t,e,n)}}jA.prototype.ValueTypeName="string",jA.prototype.ValueBufferType=Array,jA.prototype.DefaultInterpolation=Gw,jA.prototype.InterpolantFactoryMethodLinear=void 0,jA.prototype.InterpolantFactoryMethodSmooth=void 0;class WA extends UA{constructor(t,e,n,i){super(t,e,n,i)}}WA.prototype.ValueTypeName="vector";const YA={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class XA{constructor(t,e,n){const i=this;let r,s=!1,a=0,o=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.abortController=new AbortController,this.itemStart=function(t){o++,!1===s&&void 0!==i.onStart&&i.onStart(t,a,o),s=!0},this.itemEnd=function(t){a++,void 0!==i.onProgress&&i.onProgress(t,a,o),a===o&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(t){void 0!==i.onError&&i.onError(t)},this.resolveURL=function(t){return r?r(t):t},this.setURLModifier=function(t){return r=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],i=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return i}return null},this.abort=function(){return this.abortController.abort(),this.abortController=new AbortController,this}}}const KA=new XA;class qA{constructor(t){this.manager=void 0!==t?t:KA,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise(function(i,r){n.load(t,i,e,r)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}abort(){return this}}qA.DEFAULT_MATERIAL_NAME="__DEFAULT";const QA={};class ZA extends Error{constructor(t,e){super(t),this.response=e}}class JA extends qA{constructor(t){super(t),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=YA.get("file:".concat(t));if(void 0!==r)return this.manager.itemStart(t),setTimeout(()=>{e&&e(r),this.manager.itemEnd(t)},0),r;if(void 0!==QA[t])return void QA[t].push({onLoad:e,onProgress:n,onError:i});QA[t]=[],QA[t].push({onLoad:e,onProgress:n,onError:i});const s=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:"function"===typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),a=this.mimeType,o=this.responseType;fetch(s).then(e=>{if(200===e.status||0===e.status){if(0===e.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===e.body||void 0===e.body.getReader)return e;const n=QA[t],i=e.body.getReader(),r=e.headers.get("X-File-Size")||e.headers.get("Content-Length"),s=r?parseInt(r):0,a=0!==s;let o=0;const l=new ReadableStream({start(t){!function e(){i.read().then(i=>{let{done:r,value:l}=i;if(r)t.close();else{o+=l.byteLength;const i=new ProgressEvent("progress",{lengthComputable:a,loaded:o,total:s});for(let t=0,e=n.length;t<e;t++){const e=n[t];e.onProgress&&e.onProgress(i)}t.enqueue(l),e()}},e=>{t.error(e)})}()}});return new Response(l)}throw new ZA('fetch for "'.concat(e.url,'" responded with ').concat(e.status,": ").concat(e.statusText),e)}).then(t=>{switch(o){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then(t=>(new DOMParser).parseFromString(t,a));case"json":return t.json();default:if(""===a)return t.text();{const e=/charset="?([^;"\s]*)"?/i.exec(a),n=e&&e[1]?e[1].toLowerCase():void 0,i=new TextDecoder(n);return t.arrayBuffer().then(t=>i.decode(t))}}}).then(e=>{YA.add("file:".concat(t),e);const n=QA[t];delete QA[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onLoad&&i.onLoad(e)}}).catch(e=>{const n=QA[t];if(void 0===n)throw this.manager.itemError(t),e;delete QA[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onError&&i.onError(e)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}const $A=new WeakMap;class tC extends qA{constructor(t){super(t)}load(t,e,n,i){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=YA.get("image:".concat(t));if(void 0!==s){if(!0===s.complete)r.manager.itemStart(t),setTimeout(function(){e&&e(s),r.manager.itemEnd(t)},0);else{let t=$A.get(s);void 0===t&&(t=[],$A.set(s,t)),t.push({onLoad:e,onError:i})}return s}const a=PS("img");function o(){c(),e&&e(this);const n=$A.get(this)||[];for(let t=0;t<n.length;t++){const e=n[t];e.onLoad&&e.onLoad(this)}$A.delete(this),r.manager.itemEnd(t)}function l(e){c(),i&&i(e),YA.remove("image:".concat(t));const n=$A.get(this)||[];for(let t=0;t<n.length;t++){const i=n[t];i.onError&&i.onError(e)}$A.delete(this),r.manager.itemError(t),r.manager.itemEnd(t)}function c(){a.removeEventListener("load",o,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",l,!1),"data:"!==t.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),YA.add("image:".concat(t),a),r.manager.itemStart(t),a.src=t,a}}class eC extends aA{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-t,s=n+t,a=i+e,o=i-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=t*this.view.offsetX,s=r+t*this.view.width,a-=e*this.view.offsetY,o=a-e*this.view.height}this.projectionMatrix.makeOrthographic(r,s,a,o,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}new WeakMap;class nC extends uA{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=t}}const iC="\\[\\]\\.:\\/",rC=new RegExp("["+iC+"]","g"),sC="[^"+iC+"]",aC="[^"+iC.replace("\\.","")+"]",oC=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",sC)+/(WCOD+)?/.source.replace("WCOD",aC)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",sC)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",sC)+"$"),lC=["material","materials","bones","map"];class cC{constructor(t,e,n){this.path=e,this.parsedPath=n||cC.parseTrackName(e),this.node=cC.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new cC.Composite(t,e,n):new cC(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(rC,"")}static parseTrackName(t){const e=oC.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const t=n.nodeName.substring(i+1);-1!==lC.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let i=0;i<t.length;i++){const r=t[i];if(r.name===e||r.uuid===e)return r;const s=n(r.children);if(s)return s}return null},i=n(t.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)t[e++]=n[i]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,i=e.propertyName;let r=e.propertyIndex;if(t||(t=cC.findNode(this.rootNode,e.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(n){let i=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===i){i=e;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==i){if(void 0===t[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[i]}}const s=t[i];if(void 0===s){const n=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",t)}let a=this.Versioning.None;this.targetObject=t,!0===t.isMaterial?a=this.Versioning.NeedsUpdate:!0===t.isObject3D&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[r]&&(r=t.morphTargetDictionary[r])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}cC.Composite=class{constructor(t,e,n){const i=n||cC.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}getValue(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},cC.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},cC.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},cC.prototype.GetterByBindingType=[cC.prototype._getValue_direct,cC.prototype._getValue_array,cC.prototype._getValue_arrayElement,cC.prototype._getValue_toArray],cC.prototype.SetterByBindingTypeAndVersioning=[[cC.prototype._setValue_direct,cC.prototype._setValue_direct_setNeedsUpdate,cC.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[cC.prototype._setValue_array,cC.prototype._setValue_array_setNeedsUpdate,cC.prototype._setValue_array_setMatrixWorldNeedsUpdate],[cC.prototype._setValue_arrayElement,cC.prototype._setValue_arrayElement_setNeedsUpdate,cC.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[cC.prototype._setValue_fromArray,cC.prototype._setValue_fromArray_setNeedsUpdate,cC.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);const uC=new RT;class hC{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new CT(t,e),this.near=n,this.far=i,this.camera=null,this.layers=new zT,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}setFromXRController(t){return uC.identity().extractRotation(t.matrixWorld),this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(uC),this}intersectObject(t){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return fC(t,this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),e.sort(dC),e}intersectObjects(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let i=0,r=t.length;i<r;i++)fC(t[i],this,n,e);return n.sort(dC),n}}function dC(t,e){return t.distance-e.distance}function fC(t,e,n,i){let r=!0;if(t.layers.test(e.layers)){!1===t.raycast(e,n)&&(r=!1)}if(!0===r&&!0===i){const i=t.children;for(let t=0,r=i.length;t<r;t++)fC(i[t],e,n,!0)}}function pC(t,e,n,i){const r=function(t){switch(t){case XE:case KE:return{byteLength:1,components:1};case QE:case qE:case tw:return{byteLength:2,components:1};case ew:case nw:return{byteLength:2,components:4};case JE:case ZE:case $E:return{byteLength:4,components:1};case rw:return{byteLength:4,components:3}}throw new Error("Unknown texture type ".concat(t,"."))}(i);switch(n){case 1021:return t*e;case lw:case cw:return t*e/r.components*r.byteLength;case 1030:case uw:return t*e*2/r.components*r.byteLength;case 1022:return t*e*3/r.components*r.byteLength;case sw:case hw:return t*e*4/r.components*r.byteLength;case dw:case fw:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case pw:case mw:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case vw:case _w:return Math.max(t,16)*Math.max(e,8)/4;case gw:case yw:return Math.max(t,8)*Math.max(e,8)/2;case bw:case xw:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case Ew:case ww:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case Sw:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case Tw:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case Mw:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case Aw:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case Cw:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case Rw:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case kw:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case Lw:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case Dw:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case Pw:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case Iw:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case Ow:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case Nw:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case Fw:case Uw:case Bw:return Math.ceil(t/4)*Math.ceil(e/4)*16;case 36283:case zw:return Math.ceil(t/4)*Math.ceil(e/4)*8;case Hw:case Vw:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error("Unable to determine texture byte length for ".concat(n," format."))}function mC(){let t=null,e=!1,n=null,i=null;function r(e,s){n(e,s),i=t.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==n&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function gC(t){const e=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),e.get(t)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const i=e.get(n);i&&(t.deleteBuffer(i.buffer),e.delete(n))},update:function(n,i){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){const t=e.get(n);return void((!t||t.version<n.version)&&e.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}const r=e.get(n);if(void 0===r)e.set(n,function(e,n){const i=e.array,r=e.usage,s=i.byteLength,a=t.createBuffer();let o;if(t.bindBuffer(n,a),t.bufferData(n,i,r),e.onUploadCallback(),i instanceof Float32Array)o=t.FLOAT;else if("undefined"!==typeof Float16Array&&i instanceof Float16Array)o=t.HALF_FLOAT;else if(i instanceof Uint16Array)o=e.isFloat16BufferAttribute?t.HALF_FLOAT:t.UNSIGNED_SHORT;else if(i instanceof Int16Array)o=t.SHORT;else if(i instanceof Uint32Array)o=t.UNSIGNED_INT;else if(i instanceof Int32Array)o=t.INT;else if(i instanceof Int8Array)o=t.BYTE;else if(i instanceof Uint8Array)o=t.UNSIGNED_BYTE;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);o=t.UNSIGNED_BYTE}return{buffer:a,type:o,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version,size:s}}(n,i));else if(r.version<n.version){if(r.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(e,n,i){const r=n.array,s=n.updateRanges;if(t.bindBuffer(i,e),0===s.length)t.bufferSubData(i,0,r);else{s.sort((t,e)=>t.start-e.start);let e=0;for(let t=1;t<s.length;t++){const n=s[e],i=s[t];i.start<=n.start+n.count+1?n.count=Math.max(n.count,i.start+i.count-n.start):(++e,s[e]=i)}s.length=e+1;for(let n=0,a=s.length;n<a;n++){const e=s[n];t.bufferSubData(i,e.start*r.BYTES_PER_ELEMENT,r,e.start,e.count)}n.clearUpdateRanges()}n.onUploadCallback()}(r.buffer,n,i),r.version=n.version}}}}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:iE}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=iE);const vC={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\tfloat depth = unpackRGBAToDepth( texture2D( depths, uv ) );\n\t\t#ifdef USE_REVERSEDEPTHBUF\n\t\t\treturn step( depth, compare );\n\t\t#else\n\t\t\treturn step( compare, depth );\n\t\t#endif\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\t#ifdef USE_REVERSEDEPTHBUF\n\t\t\tfloat hard_shadow = step( distribution.x, compare );\n\t\t#else\n\t\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\t#endif\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_REVERSEDEPTHBUF\n\t\tfloat fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];\n\t#else\n\t\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;\n\t#endif\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},yC={common:{diffuse:{value:new xM(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new kS},alphaMap:{value:null},alphaMapTransform:{value:new kS},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new kS}},envmap:{envMap:{value:null},envMapRotation:{value:new kS},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new kS}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new kS}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new kS},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new kS},normalScale:{value:new TS(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new kS},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new kS}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new kS}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new kS}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new xM(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new xM(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new kS},alphaTest:{value:0},uvTransform:{value:new kS}},sprite:{diffuse:{value:new xM(16777215)},opacity:{value:1},center:{value:new TS(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new kS},alphaMap:{value:null},alphaMapTransform:{value:new kS},alphaTest:{value:0}}},_C={basic:{uniforms:nA([yC.common,yC.specularmap,yC.envmap,yC.aomap,yC.lightmap,yC.fog]),vertexShader:vC.meshbasic_vert,fragmentShader:vC.meshbasic_frag},lambert:{uniforms:nA([yC.common,yC.specularmap,yC.envmap,yC.aomap,yC.lightmap,yC.emissivemap,yC.bumpmap,yC.normalmap,yC.displacementmap,yC.fog,yC.lights,{emissive:{value:new xM(0)}}]),vertexShader:vC.meshlambert_vert,fragmentShader:vC.meshlambert_frag},phong:{uniforms:nA([yC.common,yC.specularmap,yC.envmap,yC.aomap,yC.lightmap,yC.emissivemap,yC.bumpmap,yC.normalmap,yC.displacementmap,yC.fog,yC.lights,{emissive:{value:new xM(0)},specular:{value:new xM(1118481)},shininess:{value:30}}]),vertexShader:vC.meshphong_vert,fragmentShader:vC.meshphong_frag},standard:{uniforms:nA([yC.common,yC.envmap,yC.aomap,yC.lightmap,yC.emissivemap,yC.bumpmap,yC.normalmap,yC.displacementmap,yC.roughnessmap,yC.metalnessmap,yC.fog,yC.lights,{emissive:{value:new xM(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:vC.meshphysical_vert,fragmentShader:vC.meshphysical_frag},toon:{uniforms:nA([yC.common,yC.aomap,yC.lightmap,yC.emissivemap,yC.bumpmap,yC.normalmap,yC.displacementmap,yC.gradientmap,yC.fog,yC.lights,{emissive:{value:new xM(0)}}]),vertexShader:vC.meshtoon_vert,fragmentShader:vC.meshtoon_frag},matcap:{uniforms:nA([yC.common,yC.bumpmap,yC.normalmap,yC.displacementmap,yC.fog,{matcap:{value:null}}]),vertexShader:vC.meshmatcap_vert,fragmentShader:vC.meshmatcap_frag},points:{uniforms:nA([yC.points,yC.fog]),vertexShader:vC.points_vert,fragmentShader:vC.points_frag},dashed:{uniforms:nA([yC.common,yC.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:vC.linedashed_vert,fragmentShader:vC.linedashed_frag},depth:{uniforms:nA([yC.common,yC.displacementmap]),vertexShader:vC.depth_vert,fragmentShader:vC.depth_frag},normal:{uniforms:nA([yC.common,yC.bumpmap,yC.normalmap,yC.displacementmap,{opacity:{value:1}}]),vertexShader:vC.meshnormal_vert,fragmentShader:vC.meshnormal_frag},sprite:{uniforms:nA([yC.sprite,yC.fog]),vertexShader:vC.sprite_vert,fragmentShader:vC.sprite_frag},background:{uniforms:{uvTransform:{value:new kS},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:vC.background_vert,fragmentShader:vC.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new kS}},vertexShader:vC.backgroundCube_vert,fragmentShader:vC.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:vC.cube_vert,fragmentShader:vC.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:vC.equirect_vert,fragmentShader:vC.equirect_frag},distanceRGBA:{uniforms:nA([yC.common,yC.displacementmap,{referencePosition:{value:new AS},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:vC.distanceRGBA_vert,fragmentShader:vC.distanceRGBA_frag},shadow:{uniforms:nA([yC.lights,yC.fog,{color:{value:new xM(0)},opacity:{value:1}}]),vertexShader:vC.shadow_vert,fragmentShader:vC.shadow_frag}};_C.physical={uniforms:nA([_C.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new kS},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new kS},clearcoatNormalScale:{value:new TS(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new kS},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new kS},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new kS},sheen:{value:0},sheenColor:{value:new xM(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new kS},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new kS},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new kS},transmissionSamplerSize:{value:new TS},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new kS},attenuationDistance:{value:0},attenuationColor:{value:new xM(0)},specularColor:{value:new xM(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new kS},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new kS},anisotropyVector:{value:new TS},anisotropyMap:{value:null},anisotropyMapTransform:{value:new kS}}]),vertexShader:vC.meshphysical_vert,fragmentShader:vC.meshphysical_frag};const bC={r:0,b:0,g:0},xC=new BT,EC=new RT;function wC(t,e,n,i,r,s,a){const o=new xM(0);let l,c,u=!0===s?0:1,h=null,d=0,f=null;function p(t){let i=!0===t.isScene?t.background:null;if(i&&i.isTexture){i=(t.backgroundBlurriness>0?n:e).get(i)}return i}function m(e,n){e.getRGB(bC,iA(t)),i.buffers.color.setClear(bC.r,bC.g,bC.b,n,a)}return{getClearColor:function(){return o},setClearColor:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;o.set(t),u=e,m(o,u)},getClearAlpha:function(){return u},setClearAlpha:function(t){u=t,m(o,u)},render:function(e){let n=!1;const r=p(e);null===r?m(o,u):r&&r.isColor&&(m(r,1),n=!0);const s=t.xr.getEnvironmentBlendMode();"additive"===s?i.buffers.color.setClear(0,0,0,1,a):"alpha-blend"===s&&i.buffers.color.setClear(0,0,0,0,a),(t.autoClear||n)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))},addToRenderList:function(e,n){const i=p(n);i&&(i.isCubeTexture||i.mapping===FE)?(void 0===c&&(c=new JM(new tA(1,1,1),new sA({name:"BackgroundCubeMaterial",uniforms:eA(_C.backgroundCube.uniforms),vertexShader:_C.backgroundCube.vertexShader,fragmentShader:_C.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),xC.copy(n.backgroundRotation),xC.x*=-1,xC.y*=-1,xC.z*=-1,i.isCubeTexture&&!1===i.isRenderTargetTexture&&(xC.y*=-1,xC.z*=-1),c.material.uniforms.envMap.value=i,c.material.uniforms.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(EC.makeRotationFromEuler(xC)),c.material.toneMapped=zS.getTransfer(i.colorSpace)!==$w,h===i&&d===i.version&&f===t.toneMapping||(c.material.needsUpdate=!0,h=i,d=i.version,f=t.toneMapping),c.layers.enableAll(),e.unshift(c,c.geometry,c.material,0,0,null)):i&&i.isTexture&&(void 0===l&&(l=new JM(new CA(2,2),new sA({name:"BackgroundMaterial",uniforms:eA(_C.background.uniforms),vertexShader:_C.background.vertexShader,fragmentShader:_C.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=i,l.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,l.material.toneMapped=zS.getTransfer(i.colorSpace)!==$w,!0===i.matrixAutoUpdate&&i.updateMatrix(),l.material.uniforms.uvTransform.value.copy(i.matrix),h===i&&d===i.version&&f===t.toneMapping||(l.material.needsUpdate=!0,h=i,d=i.version,f=t.toneMapping),l.layers.enableAll(),e.unshift(l,l.geometry,l.material,0,0,null))},dispose:function(){void 0!==c&&(c.geometry.dispose(),c.material.dispose(),c=void 0),void 0!==l&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}}}function SC(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),i={},r=c(null);let s=r,a=!1;function o(e){return t.bindVertexArray(e)}function l(e){return t.deleteVertexArray(e)}function c(t){const e=[],i=[],r=[];for(let s=0;s<n;s++)e[s]=0,i[s]=0,r[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:i,attributeDivisors:r,object:t,attributes:{},index:null}}function u(){const t=s.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function h(t){d(t,0)}function d(e,n){const i=s.newAttributes,r=s.enabledAttributes,a=s.attributeDivisors;i[e]=1,0===r[e]&&(t.enableVertexAttribArray(e),r[e]=1),a[e]!==n&&(t.vertexAttribDivisor(e,n),a[e]=n)}function f(){const e=s.newAttributes,n=s.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==e[i]&&(t.disableVertexAttribArray(i),n[i]=0)}function p(e,n,i,r,s,a,o){!0===o?t.vertexAttribIPointer(e,n,i,s,a):t.vertexAttribPointer(e,n,i,r,s,a)}function m(){g(),a=!0,s!==r&&(s=r,o(s.object))}function g(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:function(n,r,l,m,g){let v=!1;const y=function(e,n,r){const s=!0===r.wireframe;let a=i[e.id];void 0===a&&(a={},i[e.id]=a);let o=a[n.id];void 0===o&&(o={},a[n.id]=o);let l=o[s];void 0===l&&(l=c(t.createVertexArray()),o[s]=l);return l}(m,l,r);s!==y&&(s=y,o(s.object)),v=function(t,e,n,i){const r=s.attributes,a=e.attributes;let o=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){const e=r[s];let n=a[s];if(void 0===n&&("instanceMatrix"===s&&t.instanceMatrix&&(n=t.instanceMatrix),"instanceColor"===s&&t.instanceColor&&(n=t.instanceColor)),void 0===e)return!0;if(e.attribute!==n)return!0;if(n&&e.data!==n.data)return!0;o++}}return s.attributesNum!==o||s.index!==i}(n,m,l,g),v&&function(t,e,n,i){const r={},a=e.attributes;let o=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){let e=a[s];void 0===e&&("instanceMatrix"===s&&t.instanceMatrix&&(e=t.instanceMatrix),"instanceColor"===s&&t.instanceColor&&(e=t.instanceColor));const n={};n.attribute=e,e&&e.data&&(n.data=e.data),r[s]=n,o++}}s.attributes=r,s.attributesNum=o,s.index=i}(n,m,l,g),null!==g&&e.update(g,t.ELEMENT_ARRAY_BUFFER),(v||a)&&(a=!1,function(n,i,r,s){u();const a=s.attributes,o=r.getAttributes(),l=i.defaultAttributeValues;for(const c in o){const i=o[c];if(i.location>=0){let r=a[c];if(void 0===r&&("instanceMatrix"===c&&n.instanceMatrix&&(r=n.instanceMatrix),"instanceColor"===c&&n.instanceColor&&(r=n.instanceColor)),void 0!==r){const a=r.normalized,o=r.itemSize,l=e.get(r);if(void 0===l)continue;const c=l.buffer,u=l.type,f=l.bytesPerElement,m=u===t.INT||u===t.UNSIGNED_INT||r.gpuType===ZE;if(r.isInterleavedBufferAttribute){const e=r.data,l=e.stride,g=r.offset;if(e.isInstancedInterleavedBuffer){for(let t=0;t<i.locationSize;t++)d(i.location+t,e.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=e.meshPerAttribute*e.count)}else for(let t=0;t<i.locationSize;t++)h(i.location+t);t.bindBuffer(t.ARRAY_BUFFER,c);for(let t=0;t<i.locationSize;t++)p(i.location+t,o/i.locationSize,u,a,l*f,(g+o/i.locationSize*t)*f,m)}else{if(r.isInstancedBufferAttribute){for(let t=0;t<i.locationSize;t++)d(i.location+t,r.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=r.meshPerAttribute*r.count)}else for(let t=0;t<i.locationSize;t++)h(i.location+t);t.bindBuffer(t.ARRAY_BUFFER,c);for(let t=0;t<i.locationSize;t++)p(i.location+t,o/i.locationSize,u,a,o*f,o/i.locationSize*t*f,m)}}else if(void 0!==l){const e=l[c];if(void 0!==e)switch(e.length){case 2:t.vertexAttrib2fv(i.location,e);break;case 3:t.vertexAttrib3fv(i.location,e);break;case 4:t.vertexAttrib4fv(i.location,e);break;default:t.vertexAttrib1fv(i.location,e)}}}}f()}(n,r,l,m),null!==g&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(g).buffer))},reset:m,resetDefaultState:g,dispose:function(){m();for(const t in i){const e=i[t];for(const t in e){const n=e[t];for(const t in n)l(n[t].object),delete n[t];delete e[t]}delete i[t]}},releaseStatesOfGeometry:function(t){if(void 0===i[t.id])return;const e=i[t.id];for(const n in e){const t=e[n];for(const e in t)l(t[e].object),delete t[e];delete e[n]}delete i[t.id]},releaseStatesOfProgram:function(t){for(const e in i){const n=i[e];if(void 0===n[t.id])continue;const r=n[t.id];for(const t in r)l(r[t].object),delete r[t];delete n[t.id]}},initAttributes:u,enableAttribute:h,disableUnusedAttributes:f}}function TC(t,e,n){let i;function r(e,r,s){0!==s&&(t.drawArraysInstanced(i,e,r,s),n.update(r,i,s))}this.setMode=function(t){i=t},this.render=function(e,r){t.drawArrays(i,e,r),n.update(r,i,1)},this.renderInstances=r,this.renderMultiDraw=function(t,r,s){if(0===s)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,t,0,r,0,s);let a=0;for(let e=0;e<s;e++)a+=r[e];n.update(a,i,1)},this.renderMultiDrawInstances=function(t,s,a,o){if(0===a)return;const l=e.get("WEBGL_multi_draw");if(null===l)for(let e=0;e<t.length;e++)r(t[e],s[e],o[e]);else{l.multiDrawArraysInstancedWEBGL(i,t,0,s,0,o,0,a);let e=0;for(let t=0;t<a;t++)e+=s[t]*o[t];n.update(e,i,1)}}}function MC(t,e,n,i){let r;function s(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let a=void 0!==n.precision?n.precision:"highp";const o=s(a);o!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",o,"instead."),a=o);const l=!0===n.logarithmicDepthBuffer,c=!0===n.reversedDepthBuffer&&e.has("EXT_clip_control"),u=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),h=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const n=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:s,textureFormatReadable:function(e){return e===sw||i.convert(e)===t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const r=n===tw&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(n!==XE&&i.convert(n)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==$E&&!r)},precision:a,logarithmicDepthBuffer:l,reversedDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:t.getParameter(t.MAX_TEXTURE_SIZE),maxCubemapSize:t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:t.getParameter(t.MAX_VERTEX_ATTRIBS),maxVertexUniforms:t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:t.getParameter(t.MAX_VARYING_VECTORS),maxFragmentUniforms:t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:h>0,maxSamples:t.getParameter(t.MAX_SAMPLES)}}function AC(t){const e=this;let n=null,i=0,r=!1,s=!1;const a=new EA,o=new kS,l={value:null,needsUpdate:!1};function c(t,n,i,r){const s=null!==t?t.length:0;let c=null;if(0!==s){if(c=l.value,!0!==r||null===c){const e=i+4*s,r=n.matrixWorldInverse;o.getNormalMatrix(r),(null===c||c.length<e)&&(c=new Float32Array(e));for(let n=0,l=i;n!==s;++n,l+=4)a.copy(t[n]).applyMatrix4(r,o),a.normal.toArray(c,l),c[l+3]=a.constant}l.value=c,l.needsUpdate=!0}return e.numPlanes=s,e.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e){const n=0!==t.length||e||0!==i||r;return r=e,i=t.length,n},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(t,e){n=c(t,e,0)},this.setState=function(a,o,u){const h=a.clippingPlanes,d=a.clipIntersection,f=a.clipShadows,p=t.get(a);if(!r||null===h||0===h.length||s&&!f)s?c(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=i>0);e.numPlanes=i,e.numIntersection=0}();else{const t=s?0:i,e=4*t;let r=p.clippingState||null;l.value=r,r=c(h,o,e,u);for(let i=0;i!==e;++i)r[i]=n[i];p.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function CC(t){let e=new WeakMap;function n(t,e){return e===OE?t.mapping=PE:e===NE&&(t.mapping=IE),t}function i(t){const n=t.target;n.removeEventListener("dispose",i);const r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping;if(s===OE||s===NE){if(e.has(r)){return n(e.get(r).texture,r.mapping)}{const s=r.image;if(s&&s.height>0){const a=new pA(s.height);return a.fromEquirectangularTexture(t,r),e.set(r,a),r.addEventListener("dispose",i),n(a.texture,r.mapping)}return null}}}return r},dispose:function(){e=new WeakMap}}}const RC=[.125,.215,.35,.446,.526,.582],kC=20,LC=new eC,DC=new xM;let PC=null,IC=0,OC=0,NC=!1;const FC=(1+Math.sqrt(5))/2,UC=1/FC,BC=[new AS(-FC,UC,0),new AS(FC,UC,0),new AS(-UC,0,FC),new AS(UC,0,FC),new AS(0,FC,-UC),new AS(0,FC,UC),new AS(-1,1,-1),new AS(1,1,-1),new AS(-1,1,1),new AS(1,1,1)],zC=new AS;class HC{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const{size:s=256,position:a=zC}=r;PC=this._renderer.getRenderTarget(),IC=this._renderer.getActiveCubeFace(),OC=this._renderer.getActiveMipmapLevel(),NC=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(s);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(t,n,i,o,a),e>0&&this._blur(o,0,0,e),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(t,e)}fromCubemap(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=WC(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=jC(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(PC,IC,OC),this._renderer.xr.enabled=NC,t.scissorTest=!1,GC(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===PE||t.mapping===IE?this._setSize(0===t.image.length?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),PC=this._renderer.getRenderTarget(),IC=this._renderer.getActiveCubeFace(),OC=this._renderer.getActiveMipmapLevel(),NC=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=e||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,n={magFilter:jE,minFilter:jE,generateMipmaps:!1,type:tw,format:sw,colorSpace:Zw,depthBuffer:!1},i=VC(t,e,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=VC(t,e,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(t){const e=[],n=[],i=[];let r=t;const s=t-4+1+RC.length;for(let a=0;a<s;a++){const s=Math.pow(2,r);n.push(s);let o=1/s;a>t-4?o=RC[a-t+4-1]:0===a&&(o=0),i.push(o);const l=1/(s-2),c=-l,u=1+l,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=6,f=6,p=3,m=2,g=1,v=new Float32Array(p*f*d),y=new Float32Array(m*f*d),_=new Float32Array(g*f*d);for(let t=0;t<d;t++){const e=t%3*2/3-1,n=t>2?0:-1,i=[e,n,0,e+2/3,n,0,e+2/3,n+1,0,e,n,0,e+2/3,n+1,0,e,n+1,0];v.set(i,p*f*t),y.set(h,m*f*t);const r=[t,t,t,t,t,t];_.set(r,g*f*t)}const b=new zM;b.setAttribute("position",new RM(v,p)),b.setAttribute("uv",new RM(y,m)),b.setAttribute("faceIndex",new RM(_,g)),e.push(b),r>4&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}(i)),this._blurMaterial=function(t,e,n){const i=new Float32Array(kC),r=new AS(0,1,0),s=new sA({name:"SphericalGaussianBlur",defines:{n:kC,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(t,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return s}(i,t,e)}return i}_compileMaterial(t){const e=new JM(this._lodPlanes[0],t);this._renderer.compile(e,LC)}_sceneToCubeUV(t,e,n,i,r){const s=new uA(90,1,e,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],l=this._renderer,c=l.autoClear,u=l.toneMapping;l.getClearColor(DC),l.toneMapping=0,l.autoClear=!1;l.state.buffers.depth.getReversed()&&(l.setRenderTarget(i),l.clearDepth(),l.setRenderTarget(null));const h=new TM({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),d=new JM(new tA,h);let f=!1;const p=t.background;p?p.isColor&&(h.color.copy(p),t.background=null,f=!0):(h.color.copy(DC),f=!0);for(let m=0;m<6;m++){const e=m%3;0===e?(s.up.set(0,a[m],0),s.position.set(r.x,r.y,r.z),s.lookAt(r.x+o[m],r.y,r.z)):1===e?(s.up.set(0,0,a[m]),s.position.set(r.x,r.y,r.z),s.lookAt(r.x,r.y+o[m],r.z)):(s.up.set(0,a[m],0),s.position.set(r.x,r.y,r.z),s.lookAt(r.x,r.y,r.z+o[m]));const n=this._cubeSize;GC(i,e*n,m>2?n:0,n,n),l.setRenderTarget(i),f&&l.render(d,s),l.render(t,s)}d.geometry.dispose(),d.material.dispose(),l.toneMapping=u,l.autoClear=c,t.background=p}_textureToCubeUV(t,e){const n=this._renderer,i=t.mapping===PE||t.mapping===IE;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=WC()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=jC());const r=i?this._cubemapMaterial:this._equirectMaterial,s=new JM(this._lodPlanes[0],r);r.uniforms.envMap.value=t;const a=this._cubeSize;GC(e,0,0,3*a,2*a),n.setRenderTarget(e),n.render(s,LC)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;const i=this._lodPlanes.length;for(let r=1;r<i;r++){const e=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),n=BC[(i-r-1)%BC.length];this._blur(t,r-1,r,e,n)}e.autoClear=n}_blur(t,e,n,i,r){const s=this._pingPongRenderTarget;this._halfBlur(t,s,e,n,i,"latitudinal",r),this._halfBlur(s,t,n,n,i,"longitudinal",r)}_halfBlur(t,e,n,i,r,s,a){const o=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new JM(this._lodPlanes[i],l),u=l.uniforms,h=this._sizeLods[n]-1,d=isFinite(r)?Math.PI/(2*h):2*Math.PI/39,f=r/d,p=isFinite(r)?1+Math.floor(3*f):kC;p>kC&&console.warn("sigmaRadians, ".concat(r,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(kC));const m=[];let g=0;for(let _=0;_<kC;++_){const t=_/f,e=Math.exp(-t*t/2);m.push(e),0===_?g+=e:_<p&&(g+=2*e)}for(let _=0;_<m.length;_++)m[_]=m[_]/g;u.envMap.value=t.texture,u.samples.value=p,u.weights.value=m,u.latitudinal.value="latitudinal"===s,a&&(u.poleAxis.value=a);const{_lodMax:v}=this;u.dTheta.value=d,u.mipInt.value=v-n;const y=this._sizeLods[i];GC(e,3*y*(i>v-4?i-v+4:0),4*(this._cubeSize-y),3*y,2*y),o.setRenderTarget(e),o.render(c,LC)}}function VC(t,e,n){const i=new $S(t,e,n);return i.texture.mapping=FE,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function GC(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function jC(){return new sA({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function WC(){return new sA({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function YC(t){let e=new WeakMap,n=null;function i(t){const n=t.target;n.removeEventListener("dispose",i);const r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping,a=s===OE||s===NE,o=s===PE||s===IE;if(a||o){let s=e.get(r);const l=void 0!==s?s.texture.pmremVersion:0;if(r.isRenderTargetTexture&&r.pmremVersion!==l)return null===n&&(n=new HC(t)),s=a?n.fromEquirectangular(r,s):n.fromCubemap(r,s),s.texture.pmremVersion=r.pmremVersion,e.set(r,s),s.texture;if(void 0!==s)return s.texture;{const l=r.image;return a&&l&&l.height>0||o&&l&&function(t){let e=0;const n=6;for(let i=0;i<n;i++)void 0!==t[i]&&e++;return e===n}(l)?(null===n&&(n=new HC(t)),s=a?n.fromEquirectangular(r):n.fromCubemap(r),s.texture.pmremVersion=r.pmremVersion,e.set(r,s),r.addEventListener("dispose",i),s.texture):null}}}return r},dispose:function(){e=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function XC(t){const e={};function n(n){if(void 0!==e[n])return e[n];let i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(n)}return e[n]=i,i}return{has:function(t){return null!==n(t)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(t){const e=n(t);return null===e&&NS("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function KC(t,e,n,i){const r={},s=new WeakMap;function a(t){const o=t.target;null!==o.index&&e.remove(o.index);for(const n in o.attributes)e.remove(o.attributes[n]);o.removeEventListener("dispose",a),delete r[o.id];const l=s.get(o);l&&(e.remove(l),s.delete(o)),i.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,n.memory.geometries--}function o(t){const n=[],i=t.index,r=t.attributes.position;let a=0;if(null!==i){const t=i.array;a=i.version;for(let e=0,i=t.length;e<i;e+=3){const i=t[e+0],r=t[e+1],s=t[e+2];n.push(i,r,r,s,s,i)}}else{if(void 0===r)return;{const t=r.array;a=r.version;for(let e=0,i=t.length/3-1;e<i;e+=3){const t=e+0,i=e+1,r=e+2;n.push(t,i,i,r,r,t)}}}const o=new(DS(n)?LM:kM)(n,1);o.version=a;const l=s.get(t);l&&e.remove(l),s.set(t,o)}return{get:function(t,e){return!0===r[e.id]||(e.addEventListener("dispose",a),r[e.id]=!0,n.memory.geometries++),e},update:function(n){const i=n.attributes;for(const r in i)e.update(i[r],t.ARRAY_BUFFER)},getWireframeAttribute:function(t){const e=s.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&o(t)}else o(t);return s.get(t)}}}function qC(t,e,n){let i,r,s;function a(e,a,o){0!==o&&(t.drawElementsInstanced(i,a,r,e*s,o),n.update(a,i,o))}this.setMode=function(t){i=t},this.setIndex=function(t){r=t.type,s=t.bytesPerElement},this.render=function(e,a){t.drawElements(i,a,r,e*s),n.update(a,i,1)},this.renderInstances=a,this.renderMultiDraw=function(t,s,a){if(0===a)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,s,0,r,t,0,a);let o=0;for(let e=0;e<a;e++)o+=s[e];n.update(o,i,1)},this.renderMultiDrawInstances=function(t,o,l,c){if(0===l)return;const u=e.get("WEBGL_multi_draw");if(null===u)for(let e=0;e<t.length;e++)a(t[e]/s,o[e],c[e]);else{u.multiDrawElementsInstancedWEBGL(i,o,0,r,t,0,c,0,l);let e=0;for(let t=0;t<l;t++)e+=o[t]*c[t];n.update(e,i,1)}}}function QC(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(n,i,r){switch(e.calls++,i){case t.TRIANGLES:e.triangles+=r*(n/3);break;case t.LINES:e.lines+=r*(n/2);break;case t.LINE_STRIP:e.lines+=r*(n-1);break;case t.LINE_LOOP:e.lines+=r*n;break;case t.POINTS:e.points+=r*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i)}}}}function ZC(t,e,n){const i=new WeakMap,r=new ZS;return{update:function(s,a,o){const l=s.morphTargetInfluences,c=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,u=void 0!==c?c.length:0;let h=i.get(a);if(void 0===h||h.count!==u){void 0!==h&&h.texture.dispose();const d=void 0!==a.morphAttributes.position,f=void 0!==a.morphAttributes.normal,p=void 0!==a.morphAttributes.color,m=a.morphAttributes.position||[],g=a.morphAttributes.normal||[],v=a.morphAttributes.color||[];let y=0;!0===d&&(y=1),!0===f&&(y=2),!0===p&&(y=3);let _=a.attributes.position.count*y,b=1;_>e.maxTextureSize&&(b=Math.ceil(_/e.maxTextureSize),_=e.maxTextureSize);const x=new Float32Array(_*b*4*u),E=new tT(x,_,b,u);E.type=$E,E.needsUpdate=!0;const w=4*y;for(let T=0;T<u;T++){const M=m[T],A=g[T],C=v[T],R=_*b*4*T;for(let k=0;k<M.count;k++){const L=k*w;!0===d&&(r.fromBufferAttribute(M,k),x[R+L+0]=r.x,x[R+L+1]=r.y,x[R+L+2]=r.z,x[R+L+3]=0),!0===f&&(r.fromBufferAttribute(A,k),x[R+L+4]=r.x,x[R+L+5]=r.y,x[R+L+6]=r.z,x[R+L+7]=0),!0===p&&(r.fromBufferAttribute(C,k),x[R+L+8]=r.x,x[R+L+9]=r.y,x[R+L+10]=r.z,x[R+L+11]=4===C.itemSize?r.w:1)}}function S(){E.dispose(),i.delete(a),a.removeEventListener("dispose",S)}h={count:u,texture:E,size:new TS(_,b)},i.set(a,h),a.addEventListener("dispose",S)}if(!0===s.isInstancedMesh&&null!==s.morphTexture)o.getUniforms().setValue(t,"morphTexture",s.morphTexture,n);else{let D=0;for(let I=0;I<l.length;I++)D+=l[I];const P=a.morphTargetsRelative?1:1-D;o.getUniforms().setValue(t,"morphTargetBaseInfluence",P),o.getUniforms().setValue(t,"morphTargetInfluences",l)}o.getUniforms().setValue(t,"morphTargetsTexture",h.texture,n),o.getUniforms().setValue(t,"morphTargetsTextureSize",h.size)}}}function JC(t,e,n,i){let r=new WeakMap;function s(t){const e=t.target;e.removeEventListener("dispose",s),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(a){const o=i.render.frame,l=a.geometry,c=e.get(a,l);if(r.get(c)!==o&&(e.update(c),r.set(c,o)),a.isInstancedMesh&&(!1===a.hasEventListener("dispose",s)&&a.addEventListener("dispose",s),r.get(a)!==o&&(n.update(a.instanceMatrix,t.ARRAY_BUFFER),null!==a.instanceColor&&n.update(a.instanceColor,t.ARRAY_BUFFER),r.set(a,o))),a.isSkinnedMesh){const t=a.skeleton;r.get(t)!==o&&(t.update(),r.set(t,o))}return c},dispose:function(){r=new WeakMap}}}const $C=new QS,tR=new AA(1,1),eR=new tT,nR=new eT,iR=new fA,rR=[],sR=[],aR=new Float32Array(16),oR=new Float32Array(9),lR=new Float32Array(4);function cR(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=rR[r];if(void 0===s&&(s=new Float32Array(r),rR[r]=s),0!==e){i.toArray(s,0);for(let i=1,r=0;i!==e;++i)r+=n,t[i].toArray(s,r)}return s}function uR(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function hR(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function dR(t,e){let n=sR[e];void 0===n&&(n=new Int32Array(e),sR[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function fR(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function pR(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(uR(n,e))return;t.uniform2fv(this.addr,e),hR(n,e)}}function mR(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(uR(n,e))return;t.uniform3fv(this.addr,e),hR(n,e)}}function gR(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(uR(n,e))return;t.uniform4fv(this.addr,e),hR(n,e)}}function vR(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(uR(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),hR(n,e)}else{if(uR(n,i))return;lR.set(i),t.uniformMatrix2fv(this.addr,!1,lR),hR(n,i)}}function yR(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(uR(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),hR(n,e)}else{if(uR(n,i))return;oR.set(i),t.uniformMatrix3fv(this.addr,!1,oR),hR(n,i)}}function _R(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(uR(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),hR(n,e)}else{if(uR(n,i))return;aR.set(i),t.uniformMatrix4fv(this.addr,!1,aR),hR(n,i)}}function bR(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function xR(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(uR(n,e))return;t.uniform2iv(this.addr,e),hR(n,e)}}function ER(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(uR(n,e))return;t.uniform3iv(this.addr,e),hR(n,e)}}function wR(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(uR(n,e))return;t.uniform4iv(this.addr,e),hR(n,e)}}function SR(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function TR(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(uR(n,e))return;t.uniform2uiv(this.addr,e),hR(n,e)}}function MR(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(uR(n,e))return;t.uniform3uiv(this.addr,e),hR(n,e)}}function AR(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(uR(n,e))return;t.uniform4uiv(this.addr,e),hR(n,e)}}function CR(t,e,n){const i=this.cache,r=n.allocateTextureUnit();let s;i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),this.type===t.SAMPLER_2D_SHADOW?(tR.compareFunction=515,s=tR):s=$C,n.setTexture2D(e||s,r)}function RR(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||nR,r)}function kR(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||iR,r)}function LR(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||eR,r)}function DR(t,e){t.uniform1fv(this.addr,e)}function PR(t,e){const n=cR(e,this.size,2);t.uniform2fv(this.addr,n)}function IR(t,e){const n=cR(e,this.size,3);t.uniform3fv(this.addr,n)}function OR(t,e){const n=cR(e,this.size,4);t.uniform4fv(this.addr,n)}function NR(t,e){const n=cR(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function FR(t,e){const n=cR(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function UR(t,e){const n=cR(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function BR(t,e){t.uniform1iv(this.addr,e)}function zR(t,e){t.uniform2iv(this.addr,e)}function HR(t,e){t.uniform3iv(this.addr,e)}function VR(t,e){t.uniform4iv(this.addr,e)}function GR(t,e){t.uniform1uiv(this.addr,e)}function jR(t,e){t.uniform2uiv(this.addr,e)}function WR(t,e){t.uniform3uiv(this.addr,e)}function YR(t,e){t.uniform4uiv(this.addr,e)}function XR(t,e,n){const i=this.cache,r=e.length,s=dR(n,r);uR(i,s)||(t.uniform1iv(this.addr,s),hR(i,s));for(let a=0;a!==r;++a)n.setTexture2D(e[a]||$C,s[a])}function KR(t,e,n){const i=this.cache,r=e.length,s=dR(n,r);uR(i,s)||(t.uniform1iv(this.addr,s),hR(i,s));for(let a=0;a!==r;++a)n.setTexture3D(e[a]||nR,s[a])}function qR(t,e,n){const i=this.cache,r=e.length,s=dR(n,r);uR(i,s)||(t.uniform1iv(this.addr,s),hR(i,s));for(let a=0;a!==r;++a)n.setTextureCube(e[a]||iR,s[a])}function QR(t,e,n){const i=this.cache,r=e.length,s=dR(n,r);uR(i,s)||(t.uniform1iv(this.addr,s),hR(i,s));for(let a=0;a!==r;++a)n.setTexture2DArray(e[a]||eR,s[a])}class ZR{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.type=e.type,this.setValue=function(t){switch(t){case 5126:return fR;case 35664:return pR;case 35665:return mR;case 35666:return gR;case 35674:return vR;case 35675:return yR;case 35676:return _R;case 5124:case 35670:return bR;case 35667:case 35671:return xR;case 35668:case 35672:return ER;case 35669:case 35673:return wR;case 5125:return SR;case 36294:return TR;case 36295:return MR;case 36296:return AR;case 35678:case 36198:case 36298:case 36306:case 35682:return CR;case 35679:case 36299:case 36307:return RR;case 35680:case 36300:case 36308:case 36293:return kR;case 36289:case 36303:case 36311:case 36292:return LR}}(e.type)}}class JR{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.type=e.type,this.size=e.size,this.setValue=function(t){switch(t){case 5126:return DR;case 35664:return PR;case 35665:return IR;case 35666:return OR;case 35674:return NR;case 35675:return FR;case 35676:return UR;case 5124:case 35670:return BR;case 35667:case 35671:return zR;case 35668:case 35672:return HR;case 35669:case 35673:return VR;case 5125:return GR;case 36294:return jR;case 36295:return WR;case 36296:return YR;case 35678:case 36198:case 36298:case 36306:case 35682:return XR;case 35679:case 36299:case 36307:return KR;case 35680:case 36300:case 36308:case 36293:return qR;case 36289:case 36303:case 36311:case 36292:return QR}}(e.type)}}class $R{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,n){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const s=i[r];s.setValue(t,e[s.id],n)}}}const tk=/(\w+)(\])?(\[|\.)?/g;function ek(t,e){t.seq.push(e),t.map[e.id]=e}function nk(t,e,n){const i=t.name,r=i.length;for(tk.lastIndex=0;;){const s=tk.exec(i),a=tk.lastIndex;let o=s[1];const l="]"===s[2],c=s[3];if(l&&(o|=0),void 0===c||"["===c&&a+2===r){ek(n,void 0===c?new ZR(o,t,e):new JR(o,t,e));break}{let t=n.map[o];void 0===t&&(t=new $R(o),ek(n,t)),n=t}}}class ik{constructor(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const n=t.getActiveUniform(e,i);nk(n,t.getUniformLocation(e,n.name),this)}}setValue(t,e,n,i){const r=this.map[e];void 0!==r&&r.setValue(t,n,i)}setOptional(t,e,n){const i=e[n];void 0!==i&&this.setValue(t,n,i)}static upload(t,e,n,i){for(let r=0,s=e.length;r!==s;++r){const s=e[r],a=n[s.id];!1!==a.needsUpdate&&s.setValue(t,a.value,i)}}static seqWithValue(t,e){const n=[];for(let i=0,r=t.length;i!==r;++i){const r=t[i];r.id in e&&n.push(r)}return n}}function rk(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}let sk=0;const ak=new kS;function ok(t,e,n){const i=t.getShaderParameter(e,t.COMPILE_STATUS),r=(t.getShaderInfoLog(e)||"").trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const i=parseInt(s[1]);return n.toUpperCase()+"\n\n"+r+"\n\n"+function(t,e){const n=t.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let a=r;a<s;a++){const t=a+1;i.push("".concat(t===e?">":" "," ").concat(t,": ").concat(n[a]))}return i.join("\n")}(t.getShaderSource(e),i)}return r}function lk(t,e){const n=function(t){zS._getMatrix(ak,zS.workingColorSpace,t);const e="mat3( ".concat(ak.elements.map(t=>t.toFixed(4))," )");switch(zS.getTransfer(t)){case Jw:return[e,"LinearTransferOETF"];case $w:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}(e);return["vec4 ".concat(t,"( vec4 value ) {"),"\treturn ".concat(n[1],"( vec4( value.rgb * ").concat(n[0],", value.a ) );"),"}"].join("\n")}function ck(t,e){let n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Cineon";break;case 4:n="ACESFilmic";break;case 6:n="AgX";break;case 7:n="Neutral";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const uk=new AS;function hk(){zS.getLuminanceCoefficients(uk);const t=uk.x.toFixed(4),e=uk.y.toFixed(4),n=uk.z.toFixed(4);return["float luminance( const in vec3 rgb ) {","\tconst vec3 weights = vec3( ".concat(t,", ").concat(e,", ").concat(n," );"),"\treturn dot( weights, rgb );","}"].join("\n")}function dk(t){return""!==t}function fk(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function pk(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const mk=/^[ \t]*#include +<([\w\d./]+)>/gm;function gk(t){return t.replace(mk,yk)}const vk=new Map;function yk(t,e){let n=vC[e];if(void 0===n){const t=vk.get(e);if(void 0===t)throw new Error("Can not resolve #include <"+e+">");n=vC[t],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,t)}return gk(n)}const _k=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function bk(t){return t.replace(_k,xk)}function xk(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function Ek(t){let e="precision ".concat(t.precision," float;\n\tprecision ").concat(t.precision," int;\n\tprecision ").concat(t.precision," sampler2D;\n\tprecision ").concat(t.precision," samplerCube;\n\tprecision ").concat(t.precision," sampler3D;\n\tprecision ").concat(t.precision," sampler2DArray;\n\tprecision ").concat(t.precision," sampler2DShadow;\n\tprecision ").concat(t.precision," samplerCubeShadow;\n\tprecision ").concat(t.precision," sampler2DArrayShadow;\n\tprecision ").concat(t.precision," isampler2D;\n\tprecision ").concat(t.precision," isampler3D;\n\tprecision ").concat(t.precision," isamplerCube;\n\tprecision ").concat(t.precision," isampler2DArray;\n\tprecision ").concat(t.precision," usampler2D;\n\tprecision ").concat(t.precision," usampler3D;\n\tprecision ").concat(t.precision," usamplerCube;\n\tprecision ").concat(t.precision," usampler2DArray;\n\t");return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function wk(t,e,n,i){const r=t.getContext(),s=n.defines;let a=n.vertexShader,o=n.fragmentShader;const l=function(t){let e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(n),c=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case PE:case IE:e="ENVMAP_TYPE_CUBE";break;case FE:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),u=function(t){let e="ENVMAP_MODE_REFLECTION";t.envMap&&t.envMapMode===IE&&(e="ENVMAP_MODE_REFRACTION");return e}(n),h=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(n),d=function(t){const e=t.envMapCubeUVHeight;if(null===e)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),f=function(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(dk).join("\n")}(n),p=function(t){const e=[];for(const n in t){const i=t[n];!1!==i&&e.push("#define "+n+" "+i)}return e.join("\n")}(s),m=r.createProgram();let g,v,y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(dk).join("\n"),g.length>0&&(g+="\n"),v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(dk).join("\n"),v.length>0&&(v+="\n")):(g=[Ek(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reversedDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(dk).join("\n"),v=[Ek(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reversedDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?vC.tonemapping_pars_fragment:"",0!==n.toneMapping?ck("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",vC.colorspace_pars_fragment,lk("linearToOutputTexel",n.outputColorSpace),hk(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(dk).join("\n")),a=gk(a),a=fk(a,n),a=pk(a,n),o=gk(o),o=fk(o,n),o=pk(o,n),a=bk(a),o=bk(o),!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",g=[f,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in",n.glslVersion===uS?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===uS?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const _=y+g+a,b=y+v+o,x=rk(r,r.VERTEX_SHADER,_),E=rk(r,r.FRAGMENT_SHADER,b);function w(e){if(t.debug.checkShaderErrors){const n=r.getProgramInfoLog(m)||"",i=r.getShaderInfoLog(x)||"",s=r.getShaderInfoLog(E)||"",a=n.trim(),o=i.trim(),l=s.trim();let c=!0,u=!0;if(!1===r.getProgramParameter(m,r.LINK_STATUS))if(c=!1,"function"===typeof t.debug.onShaderError)t.debug.onShaderError(r,m,x,E);else{const t=ok(r,x,"vertex"),n=ok(r,E,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,r.VALIDATE_STATUS)+"\n\nMaterial Name: "+e.name+"\nMaterial Type: "+e.type+"\n\nProgram Info Log: "+a+"\n"+t+"\n"+n)}else""!==a?console.warn("THREE.WebGLProgram: Program Info Log:",a):""!==o&&""!==l||(u=!1);u&&(e.diagnostics={runnable:c,programLog:a,vertexShader:{log:o,prefix:g},fragmentShader:{log:l,prefix:v}})}r.deleteShader(x),r.deleteShader(E),S=new ik(r,m),T=function(t,e){const n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const i=t.getActiveAttrib(e,r),s=i.name;let a=1;i.type===t.FLOAT_MAT2&&(a=2),i.type===t.FLOAT_MAT3&&(a=3),i.type===t.FLOAT_MAT4&&(a=4),n[s]={type:i.type,location:t.getAttribLocation(e,s),locationSize:a}}return n}(r,m)}let S,T;r.attachShader(m,x),r.attachShader(m,E),void 0!==n.index0AttributeName?r.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),this.getUniforms=function(){return void 0===S&&w(this),S},this.getAttributes=function(){return void 0===T&&w(this),T};let M=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===M&&(M=r.getProgramParameter(m,37297)),M},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=sk++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=x,this.fragmentShader=E,this}let Sk=0;class Tk{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,n=t.fragmentShader,i=this._getShaderStage(e),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(t);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(r)&&(s.add(r),r.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const n of e)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;let n=e.get(t);return void 0===n&&(n=new Set,e.set(t,n)),n}_getShaderStage(t){const e=this.shaderCache;let n=e.get(t);return void 0===n&&(n=new Mk(t),e.set(t,n)),n}}class Mk{constructor(t){this.id=Sk++,this.code=t,this.usedTimes=0}}function Ak(t,e,n,i,r,s,a){const o=new zT,l=new Tk,c=new Set,u=[],h=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(t){return c.add(t),0===t?"uv":"uv".concat(t)}return{getParameters:function(s,o,u,g,v){const y=g.fog,_=v.geometry,b=s.isMeshStandardMaterial?g.environment:null,x=(s.isMeshStandardMaterial?n:e).get(s.envMap||b),E=x&&x.mapping===FE?x.image.height:null,w=p[s.type];null!==s.precision&&(f=r.getMaxPrecision(s.precision),f!==s.precision&&console.warn("THREE.WebGLProgram.getParameters:",s.precision,"not supported, using",f,"instead."));const S=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,T=void 0!==S?S.length:0;let M,A,C,R,k=0;if(void 0!==_.morphAttributes.position&&(k=1),void 0!==_.morphAttributes.normal&&(k=2),void 0!==_.morphAttributes.color&&(k=3),w){const t=_C[w];M=t.vertexShader,A=t.fragmentShader}else M=s.vertexShader,A=s.fragmentShader,l.update(s),C=l.getVertexShaderID(s),R=l.getFragmentShaderID(s);const L=t.getRenderTarget(),D=t.state.buffers.depth.getReversed(),P=!0===v.isInstancedMesh,I=!0===v.isBatchedMesh,O=!!s.map,N=!!s.matcap,F=!!x,U=!!s.aoMap,B=!!s.lightMap,z=!!s.bumpMap,H=!!s.normalMap,V=!!s.displacementMap,G=!!s.emissiveMap,j=!!s.metalnessMap,W=!!s.roughnessMap,Y=s.anisotropy>0,X=s.clearcoat>0,K=s.dispersion>0,q=s.iridescence>0,Q=s.sheen>0,Z=s.transmission>0,J=Y&&!!s.anisotropyMap,$=X&&!!s.clearcoatMap,tt=X&&!!s.clearcoatNormalMap,et=X&&!!s.clearcoatRoughnessMap,nt=q&&!!s.iridescenceMap,it=q&&!!s.iridescenceThicknessMap,rt=Q&&!!s.sheenColorMap,st=Q&&!!s.sheenRoughnessMap,at=!!s.specularMap,ot=!!s.specularColorMap,lt=!!s.specularIntensityMap,ct=Z&&!!s.transmissionMap,ut=Z&&!!s.thicknessMap,ht=!!s.gradientMap,dt=!!s.alphaMap,ft=s.alphaTest>0,pt=!!s.alphaHash,mt=!!s.extensions;let gt=0;s.toneMapped&&(null!==L&&!0!==L.isXRRenderTarget||(gt=t.toneMapping));const vt={shaderID:w,shaderType:s.type,shaderName:s.name,vertexShader:M,fragmentShader:A,defines:s.defines,customVertexShaderID:C,customFragmentShaderID:R,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:f,batching:I,batchingColor:I&&null!==v._colorsTexture,instancing:P,instancingColor:P&&null!==v.instanceColor,instancingMorph:P&&null!==v.morphTexture,supportsVertexTextures:d,outputColorSpace:null===L?t.outputColorSpace:!0===L.isXRRenderTarget?L.texture.colorSpace:Zw,alphaToCoverage:!!s.alphaToCoverage,map:O,matcap:N,envMap:F,envMapMode:F&&x.mapping,envMapCubeUVHeight:E,aoMap:U,lightMap:B,bumpMap:z,normalMap:H,displacementMap:d&&V,emissiveMap:G,normalMapObjectSpace:H&&1===s.normalMapType,normalMapTangentSpace:H&&0===s.normalMapType,metalnessMap:j,roughnessMap:W,anisotropy:Y,anisotropyMap:J,clearcoat:X,clearcoatMap:$,clearcoatNormalMap:tt,clearcoatRoughnessMap:et,dispersion:K,iridescence:q,iridescenceMap:nt,iridescenceThicknessMap:it,sheen:Q,sheenColorMap:rt,sheenRoughnessMap:st,specularMap:at,specularColorMap:ot,specularIntensityMap:lt,transmission:Z,transmissionMap:ct,thicknessMap:ut,gradientMap:ht,opaque:!1===s.transparent&&1===s.blending&&!1===s.alphaToCoverage,alphaMap:dt,alphaTest:ft,alphaHash:pt,combine:s.combine,mapUv:O&&m(s.map.channel),aoMapUv:U&&m(s.aoMap.channel),lightMapUv:B&&m(s.lightMap.channel),bumpMapUv:z&&m(s.bumpMap.channel),normalMapUv:H&&m(s.normalMap.channel),displacementMapUv:V&&m(s.displacementMap.channel),emissiveMapUv:G&&m(s.emissiveMap.channel),metalnessMapUv:j&&m(s.metalnessMap.channel),roughnessMapUv:W&&m(s.roughnessMap.channel),anisotropyMapUv:J&&m(s.anisotropyMap.channel),clearcoatMapUv:$&&m(s.clearcoatMap.channel),clearcoatNormalMapUv:tt&&m(s.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:et&&m(s.clearcoatRoughnessMap.channel),iridescenceMapUv:nt&&m(s.iridescenceMap.channel),iridescenceThicknessMapUv:it&&m(s.iridescenceThicknessMap.channel),sheenColorMapUv:rt&&m(s.sheenColorMap.channel),sheenRoughnessMapUv:st&&m(s.sheenRoughnessMap.channel),specularMapUv:at&&m(s.specularMap.channel),specularColorMapUv:ot&&m(s.specularColorMap.channel),specularIntensityMapUv:lt&&m(s.specularIntensityMap.channel),transmissionMapUv:ct&&m(s.transmissionMap.channel),thicknessMapUv:ut&&m(s.thicknessMap.channel),alphaMapUv:dt&&m(s.alphaMap.channel),vertexTangents:!!_.attributes.tangent&&(H||Y),vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!_.attributes.color&&4===_.attributes.color.itemSize,pointsUvs:!0===v.isPoints&&!!_.attributes.uv&&(O||dt),fog:!!y,useFog:!0===s.fog,fogExp2:!!y&&y.isFogExp2,flatShading:!0===s.flatShading&&!1===s.wireframe,sizeAttenuation:!0===s.sizeAttenuation,logarithmicDepthBuffer:h,reversedDepthBuffer:D,skinning:!0===v.isSkinnedMesh,morphTargets:void 0!==_.morphAttributes.position,morphNormals:void 0!==_.morphAttributes.normal,morphColors:void 0!==_.morphAttributes.color,morphTargetsCount:T,morphTextureStride:k,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numLightProbes:o.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:s.dithering,shadowMapEnabled:t.shadowMap.enabled&&u.length>0,shadowMapType:t.shadowMap.type,toneMapping:gt,decodeVideoTexture:O&&!0===s.map.isVideoTexture&&zS.getTransfer(s.map.colorSpace)===$w,decodeVideoTextureEmissive:G&&!0===s.emissiveMap.isVideoTexture&&zS.getTransfer(s.emissiveMap.colorSpace)===$w,premultipliedAlpha:s.premultipliedAlpha,doubleSided:2===s.side,flipSided:1===s.side,useDepthPacking:s.depthPacking>=0,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionClipCullDistance:mt&&!0===s.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(mt&&!0===s.extensions.multiDraw||I)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:s.customProgramCacheKey()};return vt.vertexUv1s=c.has(1),vt.vertexUv2s=c.has(2),vt.vertexUv3s=c.has(3),c.clear(),vt},getProgramCacheKey:function(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.customVertexShaderID),n.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(!function(t,e){t.push(e.precision),t.push(e.outputColorSpace),t.push(e.envMapMode),t.push(e.envMapCubeUVHeight),t.push(e.mapUv),t.push(e.alphaMapUv),t.push(e.lightMapUv),t.push(e.aoMapUv),t.push(e.bumpMapUv),t.push(e.normalMapUv),t.push(e.displacementMapUv),t.push(e.emissiveMapUv),t.push(e.metalnessMapUv),t.push(e.roughnessMapUv),t.push(e.anisotropyMapUv),t.push(e.clearcoatMapUv),t.push(e.clearcoatNormalMapUv),t.push(e.clearcoatRoughnessMapUv),t.push(e.iridescenceMapUv),t.push(e.iridescenceThicknessMapUv),t.push(e.sheenColorMapUv),t.push(e.sheenRoughnessMapUv),t.push(e.specularMapUv),t.push(e.specularColorMapUv),t.push(e.specularIntensityMapUv),t.push(e.transmissionMapUv),t.push(e.thicknessMapUv),t.push(e.combine),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.morphTargetsCount),t.push(e.morphAttributeCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numSpotLightMaps),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.numSpotLightShadowsWithMaps),t.push(e.numLightProbes),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.depthPacking)}(n,e),function(t,e){o.disableAll(),e.supportsVertexTextures&&o.enable(0);e.instancing&&o.enable(1);e.instancingColor&&o.enable(2);e.instancingMorph&&o.enable(3);e.matcap&&o.enable(4);e.envMap&&o.enable(5);e.normalMapObjectSpace&&o.enable(6);e.normalMapTangentSpace&&o.enable(7);e.clearcoat&&o.enable(8);e.iridescence&&o.enable(9);e.alphaTest&&o.enable(10);e.vertexColors&&o.enable(11);e.vertexAlphas&&o.enable(12);e.vertexUv1s&&o.enable(13);e.vertexUv2s&&o.enable(14);e.vertexUv3s&&o.enable(15);e.vertexTangents&&o.enable(16);e.anisotropy&&o.enable(17);e.alphaHash&&o.enable(18);e.batching&&o.enable(19);e.dispersion&&o.enable(20);e.batchingColor&&o.enable(21);e.gradientMap&&o.enable(22);t.push(o.mask),o.disableAll(),e.fog&&o.enable(0);e.useFog&&o.enable(1);e.flatShading&&o.enable(2);e.logarithmicDepthBuffer&&o.enable(3);e.reversedDepthBuffer&&o.enable(4);e.skinning&&o.enable(5);e.morphTargets&&o.enable(6);e.morphNormals&&o.enable(7);e.morphColors&&o.enable(8);e.premultipliedAlpha&&o.enable(9);e.shadowMapEnabled&&o.enable(10);e.doubleSided&&o.enable(11);e.flipSided&&o.enable(12);e.useDepthPacking&&o.enable(13);e.dithering&&o.enable(14);e.transmission&&o.enable(15);e.sheen&&o.enable(16);e.opaque&&o.enable(17);e.pointsUvs&&o.enable(18);e.decodeVideoTexture&&o.enable(19);e.decodeVideoTextureEmissive&&o.enable(20);e.alphaToCoverage&&o.enable(21);t.push(o.mask)}(n,e),n.push(t.outputColorSpace)),n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){const e=p[t.type];let n;if(e){const t=_C[e];n=rA.clone(t.uniforms)}else n=t.uniforms;return n},acquireProgram:function(e,n){let i;for(let t=0,r=u.length;t<r;t++){const e=u[t];if(e.cacheKey===n){i=e,++i.usedTimes;break}}return void 0===i&&(i=new wk(t,n,e,s),u.push(i)),i},releaseProgram:function(t){if(0===--t.usedTimes){const e=u.indexOf(t);u[e]=u[u.length-1],u.pop(),t.destroy()}},releaseShaderCache:function(t){l.remove(t)},programs:u,dispose:function(){l.dispose()}}}function Ck(){let t=new WeakMap;return{has:function(e){return t.has(e)},get:function(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,i){t.get(e)[n]=i},dispose:function(){t=new WeakMap}}}function Rk(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function kk(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Lk(){const t=[];let e=0;const n=[],i=[],r=[];function s(n,i,r,s,a,o){let l=t[e];return void 0===l?(l={id:n.id,object:n,geometry:i,material:r,groupOrder:s,renderOrder:n.renderOrder,z:a,group:o},t[e]=l):(l.id=n.id,l.object=n,l.geometry=i,l.material=r,l.groupOrder=s,l.renderOrder=n.renderOrder,l.z=a,l.group=o),e++,l}return{opaque:n,transmissive:i,transparent:r,init:function(){e=0,n.length=0,i.length=0,r.length=0},push:function(t,e,a,o,l,c){const u=s(t,e,a,o,l,c);a.transmission>0?i.push(u):!0===a.transparent?r.push(u):n.push(u)},unshift:function(t,e,a,o,l,c){const u=s(t,e,a,o,l,c);a.transmission>0?i.unshift(u):!0===a.transparent?r.unshift(u):n.unshift(u)},finish:function(){for(let n=e,i=t.length;n<i;n++){const e=t[n];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.group=null}},sort:function(t,e){n.length>1&&n.sort(t||Rk),i.length>1&&i.sort(e||kk),r.length>1&&r.sort(e||kk)}}}function Dk(){let t=new WeakMap;return{get:function(e,n){const i=t.get(e);let r;return void 0===i?(r=new Lk,t.set(e,[r])):n>=i.length?(r=new Lk,i.push(r)):r=i[n],r},dispose:function(){t=new WeakMap}}}function Pk(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new AS,color:new xM};break;case"SpotLight":n={position:new AS,direction:new AS,color:new xM,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new AS,color:new xM,distance:0,decay:0};break;case"HemisphereLight":n={direction:new AS,skyColor:new xM,groundColor:new xM};break;case"RectAreaLight":n={color:new xM,position:new AS,halfWidth:new AS,halfHeight:new AS}}return t[e.id]=n,n}}}let Ik=0;function Ok(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Nk(t){const e=new Pk,n=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new TS};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new TS,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let o=0;o<9;o++)i.probe.push(new AS);const r=new AS,s=new RT,a=new RT;return{setup:function(r){let s=0,a=0,o=0;for(let t=0;t<9;t++)i.probe[t].set(0,0,0);let l=0,c=0,u=0,h=0,d=0,f=0,p=0,m=0,g=0,v=0,y=0;r.sort(Ok);for(let t=0,b=r.length;t<b;t++){const _=r[t],b=_.color,x=_.intensity,E=_.distance,w=_.shadow&&_.shadow.map?_.shadow.map.texture:null;if(_.isAmbientLight)s+=b.r*x,a+=b.g*x,o+=b.b*x;else if(_.isLightProbe){for(let t=0;t<9;t++)i.probe[t].addScaledVector(_.sh.coefficients[t],x);y++}else if(_.isDirectionalLight){const t=e.get(_);if(t.color.copy(_.color).multiplyScalar(_.intensity),_.castShadow){const t=_.shadow,e=n.get(_);e.shadowIntensity=t.intensity,e.shadowBias=t.bias,e.shadowNormalBias=t.normalBias,e.shadowRadius=t.radius,e.shadowMapSize=t.mapSize,i.directionalShadow[l]=e,i.directionalShadowMap[l]=w,i.directionalShadowMatrix[l]=_.shadow.matrix,f++}i.directional[l]=t,l++}else if(_.isSpotLight){const t=e.get(_);t.position.setFromMatrixPosition(_.matrixWorld),t.color.copy(b).multiplyScalar(x),t.distance=E,t.coneCos=Math.cos(_.angle),t.penumbraCos=Math.cos(_.angle*(1-_.penumbra)),t.decay=_.decay,i.spot[u]=t;const r=_.shadow;if(_.map&&(i.spotLightMap[g]=_.map,g++,r.updateMatrices(_),_.castShadow&&v++),i.spotLightMatrix[u]=r.matrix,_.castShadow){const t=n.get(_);t.shadowIntensity=r.intensity,t.shadowBias=r.bias,t.shadowNormalBias=r.normalBias,t.shadowRadius=r.radius,t.shadowMapSize=r.mapSize,i.spotShadow[u]=t,i.spotShadowMap[u]=w,m++}u++}else if(_.isRectAreaLight){const t=e.get(_);t.color.copy(b).multiplyScalar(x),t.halfWidth.set(.5*_.width,0,0),t.halfHeight.set(0,.5*_.height,0),i.rectArea[h]=t,h++}else if(_.isPointLight){const t=e.get(_);if(t.color.copy(_.color).multiplyScalar(_.intensity),t.distance=_.distance,t.decay=_.decay,_.castShadow){const t=_.shadow,e=n.get(_);e.shadowIntensity=t.intensity,e.shadowBias=t.bias,e.shadowNormalBias=t.normalBias,e.shadowRadius=t.radius,e.shadowMapSize=t.mapSize,e.shadowCameraNear=t.camera.near,e.shadowCameraFar=t.camera.far,i.pointShadow[c]=e,i.pointShadowMap[c]=w,i.pointShadowMatrix[c]=_.shadow.matrix,p++}i.point[c]=t,c++}else if(_.isHemisphereLight){const t=e.get(_);t.skyColor.copy(_.color).multiplyScalar(x),t.groundColor.copy(_.groundColor).multiplyScalar(x),i.hemi[d]=t,d++}}h>0&&(!0===t.has("OES_texture_float_linear")?(i.rectAreaLTC1=yC.LTC_FLOAT_1,i.rectAreaLTC2=yC.LTC_FLOAT_2):(i.rectAreaLTC1=yC.LTC_HALF_1,i.rectAreaLTC2=yC.LTC_HALF_2)),i.ambient[0]=s,i.ambient[1]=a,i.ambient[2]=o;const _=i.hash;_.directionalLength===l&&_.pointLength===c&&_.spotLength===u&&_.rectAreaLength===h&&_.hemiLength===d&&_.numDirectionalShadows===f&&_.numPointShadows===p&&_.numSpotShadows===m&&_.numSpotMaps===g&&_.numLightProbes===y||(i.directional.length=l,i.spot.length=u,i.rectArea.length=h,i.point.length=c,i.hemi.length=d,i.directionalShadow.length=f,i.directionalShadowMap.length=f,i.pointShadow.length=p,i.pointShadowMap.length=p,i.spotShadow.length=m,i.spotShadowMap.length=m,i.directionalShadowMatrix.length=f,i.pointShadowMatrix.length=p,i.spotLightMatrix.length=m+g-v,i.spotLightMap.length=g,i.numSpotLightShadowsWithMaps=v,i.numLightProbes=y,_.directionalLength=l,_.pointLength=c,_.spotLength=u,_.rectAreaLength=h,_.hemiLength=d,_.numDirectionalShadows=f,_.numPointShadows=p,_.numSpotShadows=m,_.numSpotMaps=g,_.numLightProbes=y,i.version=Ik++)},setupView:function(t,e){let n=0,o=0,l=0,c=0,u=0;const h=e.matrixWorldInverse;for(let d=0,f=t.length;d<f;d++){const e=t[d];if(e.isDirectionalLight){const t=i.directional[n];t.direction.setFromMatrixPosition(e.matrixWorld),r.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(r),t.direction.transformDirection(h),n++}else if(e.isSpotLight){const t=i.spot[l];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),t.direction.setFromMatrixPosition(e.matrixWorld),r.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(r),t.direction.transformDirection(h),l++}else if(e.isRectAreaLight){const t=i.rectArea[c];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),a.identity(),s.copy(e.matrixWorld),s.premultiply(h),a.extractRotation(s),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),t.halfWidth.applyMatrix4(a),t.halfHeight.applyMatrix4(a),c++}else if(e.isPointLight){const t=i.point[o];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),o++}else if(e.isHemisphereLight){const t=i.hemi[u];t.direction.setFromMatrixPosition(e.matrixWorld),t.direction.transformDirection(h),u++}}},state:i}}function Fk(t){const e=new Nk(t),n=[],i=[];const r={lightsArray:n,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:function(t){r.camera=t,n.length=0,i.length=0},state:r,setupLights:function(){e.setup(n)},setupLightsView:function(t){e.setupView(n,t)},pushLight:function(t){n.push(t)},pushShadow:function(t){i.push(t)}}}function Uk(t){let e=new WeakMap;return{get:function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=e.get(n);let s;return void 0===r?(s=new Fk(t),e.set(n,[s])):i>=r.length?(s=new Fk(t),r.push(s)):s=r[i],s},dispose:function(){e=new WeakMap}}}function Bk(t,e,n){let i=new MA;const r=new TS,s=new TS,a=new ZS,o=new kA({depthPacking:3201}),l=new LA,c={},u=n.maxTextureSize,h={[rE]:1,[sE]:0,[aE]:2},d=new sA({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new TS},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new zM;p.setAttribute("position",new RM(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new JM(p,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let v=this.type;function y(n,i){const s=e.update(m);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,f.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new $S(r.x,r.y)),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(i,null,s,d,m,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(i,null,s,f,m,null)}function _(e,n,i,r){let s=null;const a=!0===i.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(void 0!==a)s=a;else if(s=!0===i.isPointLight?l:o,t.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0||!0===n.alphaToCoverage){const t=s.uuid,e=n.uuid;let i=c[t];void 0===i&&(i={},c[t]=i);let r=i[e];void 0===r&&(r=s.clone(),i[e]=r,n.addEventListener("dispose",x)),s=r}if(s.visible=n.visible,s.wireframe=n.wireframe,s.side=3===r?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:h[n.side],s.alphaMap=n.alphaMap,s.alphaTest=!0===n.alphaToCoverage?.5:n.alphaTest,s.map=n.map,s.clipShadows=n.clipShadows,s.clippingPlanes=n.clippingPlanes,s.clipIntersection=n.clipIntersection,s.displacementMap=n.displacementMap,s.displacementScale=n.displacementScale,s.displacementBias=n.displacementBias,s.wireframeLinewidth=n.wireframeLinewidth,s.linewidth=n.linewidth,!0===i.isPointLight&&!0===s.isMeshDistanceMaterial){t.properties.get(s).light=i}return s}function b(n,r,s,a,o){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===o)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);const i=e.update(n),l=n.material;if(Array.isArray(l)){const e=i.groups;for(let c=0,u=e.length;c<u;c++){const u=e[c],h=l[u.materialIndex];if(h&&h.visible){const e=_(n,h,a,o);n.onBeforeShadow(t,n,r,s,i,e,u),t.renderBufferDirect(s,null,i,e,n,u),n.onAfterShadow(t,n,r,s,i,e,u)}}}else if(l.visible){const e=_(n,l,a,o);n.onBeforeShadow(t,n,r,s,i,e,null),t.renderBufferDirect(s,null,i,e,n,null),n.onAfterShadow(t,n,r,s,i,e,null)}}const l=n.children;for(let t=0,e=l.length;t<e;t++)b(l[t],r,s,a,o)}function x(t){t.target.removeEventListener("dispose",x);for(const e in c){const n=c[e],i=t.target.uuid;if(i in n){n[i].dispose(),delete n[i]}}}this.render=function(e,n,o){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),c=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),d=t.state;d.setBlending(0),d.buffers.depth.getReversed()?d.buffers.color.setClear(0,0,0,0):d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);const f=3!==v&&3===this.type,p=3===v&&3!==this.type;for(let m=0,g=e.length;m<g;m++){const l=e[m],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;r.copy(c.mapSize);const h=c.getFrameExtents();if(r.multiply(h),s.copy(c.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/h.x),r.x=s.x*h.x,c.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/h.y),r.y=s.y*h.y,c.mapSize.y=s.y)),null===c.map||!0===f||!0===p){const t=3!==this.type?{minFilter:HE,magFilter:HE}:{};null!==c.map&&c.map.dispose(),c.map=new $S(r.x,r.y,t),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}t.setRenderTarget(c.map),t.clear();const g=c.getViewportCount();for(let t=0;t<g;t++){const e=c.getViewport(t);a.set(s.x*e.x,s.y*e.y,s.x*e.z,s.y*e.w),d.viewport(a),c.updateMatrices(l,t),i=c.getFrustum(),b(n,o,c.camera,l,this.type)}!0!==c.isPointLightShadow&&3===this.type&&y(c,o),c.needsUpdate=!1}v=this.type,g.needsUpdate=!1,t.setRenderTarget(l,c,h)}}const zk={[TE]:1,[AE]:6,[RE]:7,[CE]:5,[ME]:0,[LE]:2,[DE]:4,[kE]:3};function Hk(t,e){const n=new function(){let e=!1;const n=new ZS;let i=null;const r=new ZS(0,0,0,0);return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,s,a,o){!0===o&&(e*=a,i*=a,s*=a),n.set(e,i,s,a),!1===r.equals(n)&&(t.clearColor(e,i,s,a),r.copy(n))},reset:function(){e=!1,i=null,r.set(-1,0,0,0)}}},i=new function(){let n=!1,i=!1,r=null,s=null,a=null;return{setReversed:function(t){if(i!==t){const n=e.get("EXT_clip_control");t?n.clipControlEXT(n.LOWER_LEFT_EXT,n.ZERO_TO_ONE_EXT):n.clipControlEXT(n.LOWER_LEFT_EXT,n.NEGATIVE_ONE_TO_ONE_EXT),i=t;const r=a;a=null,this.setClear(r)}},getReversed:function(){return i},setTest:function(e){e?z(t.DEPTH_TEST):H(t.DEPTH_TEST)},setMask:function(e){r===e||n||(t.depthMask(e),r=e)},setFunc:function(e){if(i&&(e=zk[e]),s!==e){switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:default:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL)}s=e}},setLocked:function(t){n=t},setClear:function(e){a!==e&&(i&&(e=1-e),t.clearDepth(e),a=e)},reset:function(){n=!1,r=null,s=null,a=null,i=!1}}},r=new function(){let e=!1,n=null,i=null,r=null,s=null,a=null,o=null,l=null,c=null;return{setTest:function(n){e||(n?z(t.STENCIL_TEST):H(t.STENCIL_TEST))},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,a){i===e&&r===n&&s===a||(t.stencilFunc(e,n,a),i=e,r=n,s=a)},setOp:function(e,n,i){a===e&&o===n&&l===i||(t.stencilOp(e,n,i),a=e,o=n,l=i)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,i=null,r=null,s=null,a=null,o=null,l=null,c=null}}},s=new WeakMap,a=new WeakMap;let o={},l={},c=new WeakMap,u=[],h=null,d=!1,f=null,p=null,m=null,g=null,v=null,y=null,_=null,b=new xM(0,0,0),x=0,E=!1,w=null,S=null,T=null,M=null,A=null;const C=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let R=!1,k=0;const L=t.getParameter(t.VERSION);-1!==L.indexOf("WebGL")?(k=parseFloat(/^WebGL (\d)/.exec(L)[1]),R=k>=1):-1!==L.indexOf("OpenGL ES")&&(k=parseFloat(/^OpenGL ES (\d)/.exec(L)[1]),R=k>=2);let D=null,P={};const I=t.getParameter(t.SCISSOR_BOX),O=t.getParameter(t.VIEWPORT),N=(new ZS).fromArray(I),F=(new ZS).fromArray(O);function U(e,n,i,r){const s=new Uint8Array(4),a=t.createTexture();t.bindTexture(e,a),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let o=0;o<i;o++)e===t.TEXTURE_3D||e===t.TEXTURE_2D_ARRAY?t.texImage3D(n,0,t.RGBA,1,1,r,0,t.RGBA,t.UNSIGNED_BYTE,s):t.texImage2D(n+o,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,s);return a}const B={};function z(e){!0!==o[e]&&(t.enable(e),o[e]=!0)}function H(e){!1!==o[e]&&(t.disable(e),o[e]=!1)}B[t.TEXTURE_2D]=U(t.TEXTURE_2D,t.TEXTURE_2D,1),B[t.TEXTURE_CUBE_MAP]=U(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),B[t.TEXTURE_2D_ARRAY]=U(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),B[t.TEXTURE_3D]=U(t.TEXTURE_3D,t.TEXTURE_3D,1,1),n.setClear(0,0,0,1),i.setClear(1),r.setClear(0),z(t.DEPTH_TEST),i.setFunc(3),W(!1),Y(1),z(t.CULL_FACE),j(0);const V={[oE]:t.FUNC_ADD,[lE]:t.FUNC_SUBTRACT,[cE]:t.FUNC_REVERSE_SUBTRACT};V[103]=t.MIN,V[104]=t.MAX;const G={[uE]:t.ZERO,[hE]:t.ONE,[dE]:t.SRC_COLOR,[pE]:t.SRC_ALPHA,[bE]:t.SRC_ALPHA_SATURATE,[yE]:t.DST_COLOR,[gE]:t.DST_ALPHA,[fE]:t.ONE_MINUS_SRC_COLOR,[mE]:t.ONE_MINUS_SRC_ALPHA,[_E]:t.ONE_MINUS_DST_COLOR,[vE]:t.ONE_MINUS_DST_ALPHA,[xE]:t.CONSTANT_COLOR,[EE]:t.ONE_MINUS_CONSTANT_COLOR,[wE]:t.CONSTANT_ALPHA,[SE]:t.ONE_MINUS_CONSTANT_ALPHA};function j(e,n,i,r,s,a,o,l,c,u){if(0!==e){if(!1===d&&(z(t.BLEND),d=!0),5===e)s=s||n,a=a||i,o=o||r,n===p&&s===v||(t.blendEquationSeparate(V[n],V[s]),p=n,v=s),i===m&&r===g&&a===y&&o===_||(t.blendFuncSeparate(G[i],G[r],G[a],G[o]),m=i,g=r,y=a,_=o),!1!==l.equals(b)&&c===x||(t.blendColor(l.r,l.g,l.b,c),b.copy(l),x=c),f=e,E=!1;else if(e!==f||u!==E){if(p===oE&&v===oE||(t.blendEquation(t.FUNC_ADD),p=oE,v=oE),u)switch(e){case 1:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case 2:t.blendFunc(t.ONE,t.ONE);break;case 3:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case 4:t.blendFuncSeparate(t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ZERO,t.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case 2:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE,t.ONE,t.ONE);break;case 3:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case 4:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}m=null,g=null,y=null,_=null,b.set(0,0,0),x=0,f=e,E=u}}else!0===d&&(H(t.BLEND),d=!1)}function W(e){w!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),w=e)}function Y(e){0!==e?(z(t.CULL_FACE),e!==S&&(1===e?t.cullFace(t.BACK):2===e?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):H(t.CULL_FACE),S=e}function X(e,n,i){e?(z(t.POLYGON_OFFSET_FILL),M===n&&A===i||(t.polygonOffset(n,i),M=n,A=i)):H(t.POLYGON_OFFSET_FILL)}return{buffers:{color:n,depth:i,stencil:r},enable:z,disable:H,bindFramebuffer:function(e,n){return l[e]!==n&&(t.bindFramebuffer(e,n),l[e]=n,e===t.DRAW_FRAMEBUFFER&&(l[t.FRAMEBUFFER]=n),e===t.FRAMEBUFFER&&(l[t.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(e,n){let i=u,r=!1;if(e){i=c.get(n),void 0===i&&(i=[],c.set(n,i));const s=e.textures;if(i.length!==s.length||i[0]!==t.COLOR_ATTACHMENT0){for(let e=0,n=s.length;e<n;e++)i[e]=t.COLOR_ATTACHMENT0+e;i.length=s.length,r=!0}}else i[0]!==t.BACK&&(i[0]=t.BACK,r=!0);r&&t.drawBuffers(i)},useProgram:function(e){return h!==e&&(t.useProgram(e),h=e,!0)},setBlending:j,setMaterial:function(e,s){2===e.side?H(t.CULL_FACE):z(t.CULL_FACE);let a=1===e.side;s&&(a=!a),W(a),1===e.blending&&!1===e.transparent?j(0):j(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.blendColor,e.blendAlpha,e.premultipliedAlpha),i.setFunc(e.depthFunc),i.setTest(e.depthTest),i.setMask(e.depthWrite),n.setMask(e.colorWrite);const o=e.stencilWrite;r.setTest(o),o&&(r.setMask(e.stencilWriteMask),r.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),r.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),X(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?z(t.SAMPLE_ALPHA_TO_COVERAGE):H(t.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:W,setCullFace:Y,setLineWidth:function(e){e!==T&&(R&&t.lineWidth(e),T=e)},setPolygonOffset:X,setScissorTest:function(e){e?z(t.SCISSOR_TEST):H(t.SCISSOR_TEST)},activeTexture:function(e){void 0===e&&(e=t.TEXTURE0+C-1),D!==e&&(t.activeTexture(e),D=e)},bindTexture:function(e,n,i){void 0===i&&(i=null===D?t.TEXTURE0+C-1:D);let r=P[i];void 0===r&&(r={type:void 0,texture:void 0},P[i]=r),r.type===e&&r.texture===n||(D!==i&&(t.activeTexture(i),D=i),t.bindTexture(e,n||B[e]),r.type=e,r.texture=n)},unbindTexture:function(){const e=P[D];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D(...arguments)}catch(CO){console.error("THREE.WebGLState:",CO)}},compressedTexImage3D:function(){try{t.compressedTexImage3D(...arguments)}catch(CO){console.error("THREE.WebGLState:",CO)}},texImage2D:function(){try{t.texImage2D(...arguments)}catch(CO){console.error("THREE.WebGLState:",CO)}},texImage3D:function(){try{t.texImage3D(...arguments)}catch(CO){console.error("THREE.WebGLState:",CO)}},updateUBOMapping:function(e,n){let i=a.get(n);void 0===i&&(i=new WeakMap,a.set(n,i));let r=i.get(e);void 0===r&&(r=t.getUniformBlockIndex(n,e.name),i.set(e,r))},uniformBlockBinding:function(e,n){const i=a.get(n).get(e);s.get(n)!==i&&(t.uniformBlockBinding(n,i,e.__bindingPointIndex),s.set(n,i))},texStorage2D:function(){try{t.texStorage2D(...arguments)}catch(CO){console.error("THREE.WebGLState:",CO)}},texStorage3D:function(){try{t.texStorage3D(...arguments)}catch(CO){console.error("THREE.WebGLState:",CO)}},texSubImage2D:function(){try{t.texSubImage2D(...arguments)}catch(CO){console.error("THREE.WebGLState:",CO)}},texSubImage3D:function(){try{t.texSubImage3D(...arguments)}catch(CO){console.error("THREE.WebGLState:",CO)}},compressedTexSubImage2D:function(){try{t.compressedTexSubImage2D(...arguments)}catch(CO){console.error("THREE.WebGLState:",CO)}},compressedTexSubImage3D:function(){try{t.compressedTexSubImage3D(...arguments)}catch(CO){console.error("THREE.WebGLState:",CO)}},scissor:function(e){!1===N.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),N.copy(e))},viewport:function(e){!1===F.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),F.copy(e))},reset:function(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),i.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),o={},D=null,P={},l={},c=new WeakMap,u=[],h=null,d=!1,f=null,p=null,m=null,g=null,v=null,y=null,_=null,b=new xM(0,0,0),x=0,E=!1,w=null,S=null,T=null,M=null,A=null,N.set(0,0,t.canvas.width,t.canvas.height),F.set(0,0,t.canvas.width,t.canvas.height),n.reset(),i.reset(),r.reset()}}}function Vk(t,e,n,i,r,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l="undefined"!==typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new TS,u=new WeakMap;let h;const d=new WeakMap;let f=!1;try{f="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(Yq){}function p(t,e){return f?new OffscreenCanvas(t,e):PS("canvas")}function m(t,e,n){let i=1;const r=G(t);if((r.width>n||r.height>n)&&(i=n/Math.max(r.width,r.height)),i<1){if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!==typeof VideoFrame&&t instanceof VideoFrame){const n=Math.floor(i*r.width),s=Math.floor(i*r.height);void 0===h&&(h=p(n,s));const a=e?p(n,s):h;a.width=n,a.height=s;return a.getContext("2d").drawImage(t,0,0,n,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+r.width+"x"+r.height+") to ("+n+"x"+s+")."),a}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+r.width+"x"+r.height+")."),t}return t}function g(t){return t.generateMipmaps}function v(e){t.generateMipmap(e)}function y(e){return e.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:e.isWebGL3DRenderTarget?t.TEXTURE_3D:e.isWebGLArrayRenderTarget||e.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function _(n,i,r,s){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let o=i;if(i===t.RED&&(r===t.FLOAT&&(o=t.R32F),r===t.HALF_FLOAT&&(o=t.R16F),r===t.UNSIGNED_BYTE&&(o=t.R8)),i===t.RED_INTEGER&&(r===t.UNSIGNED_BYTE&&(o=t.R8UI),r===t.UNSIGNED_SHORT&&(o=t.R16UI),r===t.UNSIGNED_INT&&(o=t.R32UI),r===t.BYTE&&(o=t.R8I),r===t.SHORT&&(o=t.R16I),r===t.INT&&(o=t.R32I)),i===t.RG&&(r===t.FLOAT&&(o=t.RG32F),r===t.HALF_FLOAT&&(o=t.RG16F),r===t.UNSIGNED_BYTE&&(o=t.RG8)),i===t.RG_INTEGER&&(r===t.UNSIGNED_BYTE&&(o=t.RG8UI),r===t.UNSIGNED_SHORT&&(o=t.RG16UI),r===t.UNSIGNED_INT&&(o=t.RG32UI),r===t.BYTE&&(o=t.RG8I),r===t.SHORT&&(o=t.RG16I),r===t.INT&&(o=t.RG32I)),i===t.RGB_INTEGER&&(r===t.UNSIGNED_BYTE&&(o=t.RGB8UI),r===t.UNSIGNED_SHORT&&(o=t.RGB16UI),r===t.UNSIGNED_INT&&(o=t.RGB32UI),r===t.BYTE&&(o=t.RGB8I),r===t.SHORT&&(o=t.RGB16I),r===t.INT&&(o=t.RGB32I)),i===t.RGBA_INTEGER&&(r===t.UNSIGNED_BYTE&&(o=t.RGBA8UI),r===t.UNSIGNED_SHORT&&(o=t.RGBA16UI),r===t.UNSIGNED_INT&&(o=t.RGBA32UI),r===t.BYTE&&(o=t.RGBA8I),r===t.SHORT&&(o=t.RGBA16I),r===t.INT&&(o=t.RGBA32I)),i===t.RGB&&r===t.UNSIGNED_INT_5_9_9_9_REV&&(o=t.RGB9_E5),i===t.RGBA){const e=a?Jw:zS.getTransfer(s);r===t.FLOAT&&(o=t.RGBA32F),r===t.HALF_FLOAT&&(o=t.RGBA16F),r===t.UNSIGNED_BYTE&&(o=e===$w?t.SRGB8_ALPHA8:t.RGBA8),r===t.UNSIGNED_SHORT_4_4_4_4&&(o=t.RGBA4),r===t.UNSIGNED_SHORT_5_5_5_1&&(o=t.RGB5_A1)}return o!==t.R16F&&o!==t.R32F&&o!==t.RG16F&&o!==t.RG32F&&o!==t.RGBA16F&&o!==t.RGBA32F||e.get("EXT_color_buffer_float"),o}function b(e,n){let i;return e?null===n||n===JE||n===iw?i=t.DEPTH24_STENCIL8:n===$E?i=t.DEPTH32F_STENCIL8:n===QE&&(i=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===n||n===JE||n===iw?i=t.DEPTH_COMPONENT24:n===$E?i=t.DEPTH_COMPONENT32F:n===QE&&(i=t.DEPTH_COMPONENT16),i}function x(t,e){return!0===g(t)||t.isFramebufferTexture&&t.minFilter!==HE&&t.minFilter!==jE?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function E(t){const e=t.target;e.removeEventListener("dispose",E),function(t){const e=i.get(t);if(void 0===e.__webglInit)return;const n=t.source,r=d.get(n);if(r){const i=r[e.__cacheKey];i.usedTimes--,0===i.usedTimes&&S(t),0===Object.keys(r).length&&d.delete(n)}i.remove(t)}(e),e.isVideoTexture&&u.delete(e)}function w(e){const n=e.target;n.removeEventListener("dispose",w),function(e){const n=i.get(e);e.depthTexture&&(e.depthTexture.dispose(),i.remove(e.depthTexture));if(e.isWebGLCubeRenderTarget)for(let i=0;i<6;i++){if(Array.isArray(n.__webglFramebuffer[i]))for(let e=0;e<n.__webglFramebuffer[i].length;e++)t.deleteFramebuffer(n.__webglFramebuffer[i][e]);else t.deleteFramebuffer(n.__webglFramebuffer[i]);n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[i])}else{if(Array.isArray(n.__webglFramebuffer))for(let e=0;e<n.__webglFramebuffer.length;e++)t.deleteFramebuffer(n.__webglFramebuffer[e]);else t.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&t.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let e=0;e<n.__webglColorRenderbuffer.length;e++)n.__webglColorRenderbuffer[e]&&t.deleteRenderbuffer(n.__webglColorRenderbuffer[e]);n.__webglDepthRenderbuffer&&t.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const r=e.textures;for(let s=0,o=r.length;s<o;s++){const e=i.get(r[s]);e.__webglTexture&&(t.deleteTexture(e.__webglTexture),a.memory.textures--),i.remove(r[s])}i.remove(e)}(n)}function S(e){const n=i.get(e);t.deleteTexture(n.__webglTexture);const r=e.source;delete d.get(r)[n.__cacheKey],a.memory.textures--}let T=0;function M(e,r){const s=i.get(e);if(e.isVideoTexture&&function(t){const e=a.render.frame;u.get(t)!==e&&(u.set(t,e),t.update())}(e),!1===e.isRenderTargetTexture&&!0!==e.isExternalTexture&&e.version>0&&s.__version!==e.version){const t=e.image;if(null===t)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==t.complete)return void P(s,e,r);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}else e.isExternalTexture&&(s.__webglTexture=e.sourceTexture?e.sourceTexture:null);n.bindTexture(t.TEXTURE_2D,s.__webglTexture,t.TEXTURE0+r)}const A={[UE]:t.REPEAT,[BE]:t.CLAMP_TO_EDGE,[zE]:t.MIRRORED_REPEAT},C={[HE]:t.NEAREST,[VE]:t.NEAREST_MIPMAP_NEAREST,[GE]:t.NEAREST_MIPMAP_LINEAR,[jE]:t.LINEAR,[WE]:t.LINEAR_MIPMAP_NEAREST,[YE]:t.LINEAR_MIPMAP_LINEAR},R={[eS]:t.NEVER,[lS]:t.ALWAYS,[nS]:t.LESS,[rS]:t.LEQUAL,[iS]:t.EQUAL,[oS]:t.GEQUAL,[sS]:t.GREATER,[aS]:t.NOTEQUAL};function k(n,s){if(s.type!==$E||!1!==e.has("OES_texture_float_linear")||s.magFilter!==jE&&s.magFilter!==WE&&s.magFilter!==GE&&s.magFilter!==YE&&s.minFilter!==jE&&s.minFilter!==WE&&s.minFilter!==GE&&s.minFilter!==YE||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(n,t.TEXTURE_WRAP_S,A[s.wrapS]),t.texParameteri(n,t.TEXTURE_WRAP_T,A[s.wrapT]),n!==t.TEXTURE_3D&&n!==t.TEXTURE_2D_ARRAY||t.texParameteri(n,t.TEXTURE_WRAP_R,A[s.wrapR]),t.texParameteri(n,t.TEXTURE_MAG_FILTER,C[s.magFilter]),t.texParameteri(n,t.TEXTURE_MIN_FILTER,C[s.minFilter]),s.compareFunction&&(t.texParameteri(n,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(n,t.TEXTURE_COMPARE_FUNC,R[s.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){if(s.magFilter===HE)return;if(s.minFilter!==GE&&s.minFilter!==YE)return;if(s.type===$E&&!1===e.has("OES_texture_float_linear"))return;if(s.anisotropy>1||i.get(s).__currentAnisotropy){const a=e.get("EXT_texture_filter_anisotropic");t.texParameterf(n,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy}}}function L(e,n){let i=!1;void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",E));const r=n.source;let s=d.get(r);void 0===s&&(s={},d.set(r,s));const o=function(t){const e=[];return e.push(t.wrapS),e.push(t.wrapT),e.push(t.wrapR||0),e.push(t.magFilter),e.push(t.minFilter),e.push(t.anisotropy),e.push(t.internalFormat),e.push(t.format),e.push(t.type),e.push(t.generateMipmaps),e.push(t.premultiplyAlpha),e.push(t.flipY),e.push(t.unpackAlignment),e.push(t.colorSpace),e.join()}(n);if(o!==e.__cacheKey){void 0===s[o]&&(s[o]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,i=!0),s[o].usedTimes++;const r=s[e.__cacheKey];void 0!==r&&(s[e.__cacheKey].usedTimes--,0===r.usedTimes&&S(n)),e.__cacheKey=o,e.__webglTexture=s[o].texture}return i}function D(t,e,n){return Math.floor(Math.floor(t/n)/e)}function P(e,a,o){let l=t.TEXTURE_2D;(a.isDataArrayTexture||a.isCompressedArrayTexture)&&(l=t.TEXTURE_2D_ARRAY),a.isData3DTexture&&(l=t.TEXTURE_3D);const c=L(e,a),u=a.source;n.bindTexture(l,e.__webglTexture,t.TEXTURE0+o);const h=i.get(u);if(u.version!==h.__version||!0===c){n.activeTexture(t.TEXTURE0+o);const e=zS.getPrimaries(zS.workingColorSpace),i=a.colorSpace===qw?null:zS.getPrimaries(a.colorSpace),d=a.colorSpace===qw||e===i?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,a.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);let f=m(a.image,!1,r.maxTextureSize);f=V(a,f);const p=s.convert(a.format,a.colorSpace),y=s.convert(a.type);let E,w=_(a.internalFormat,p,y,a.colorSpace,a.isVideoTexture);k(l,a);const S=a.mipmaps,T=!0!==a.isVideoTexture,M=void 0===h.__version||!0===c,A=u.dataReady,C=x(a,f);if(a.isDepthTexture)w=b(a.format===ow,a.type),M&&(T?n.texStorage2D(t.TEXTURE_2D,1,w,f.width,f.height):n.texImage2D(t.TEXTURE_2D,0,w,f.width,f.height,0,p,y,null));else if(a.isDataTexture)if(S.length>0){T&&M&&n.texStorage2D(t.TEXTURE_2D,C,w,S[0].width,S[0].height);for(let e=0,i=S.length;e<i;e++)E=S[e],T?A&&n.texSubImage2D(t.TEXTURE_2D,e,0,0,E.width,E.height,p,y,E.data):n.texImage2D(t.TEXTURE_2D,e,w,E.width,E.height,0,p,y,E.data);a.generateMipmaps=!1}else T?(M&&n.texStorage2D(t.TEXTURE_2D,C,w,f.width,f.height),A&&function(e,i,r,s){const a=e.updateRanges;if(0===a.length)n.texSubImage2D(t.TEXTURE_2D,0,0,0,i.width,i.height,r,s,i.data);else{a.sort((t,e)=>t.start-e.start);let o=0;for(let t=1;t<a.length;t++){const e=a[o],n=a[t],r=e.start+e.count,s=D(n.start,i.width,4),l=D(e.start,i.width,4);n.start<=r+1&&s===l&&D(n.start+n.count-1,i.width,4)===s?e.count=Math.max(e.count,n.start+n.count-e.start):(++o,a[o]=n)}a.length=o+1;const l=t.getParameter(t.UNPACK_ROW_LENGTH),c=t.getParameter(t.UNPACK_SKIP_PIXELS),u=t.getParameter(t.UNPACK_SKIP_ROWS);t.pixelStorei(t.UNPACK_ROW_LENGTH,i.width);for(let e=0,h=a.length;e<h;e++){const o=a[e],l=Math.floor(o.start/4),c=Math.ceil(o.count/4),u=l%i.width,h=Math.floor(l/i.width),d=c,f=1;t.pixelStorei(t.UNPACK_SKIP_PIXELS,u),t.pixelStorei(t.UNPACK_SKIP_ROWS,h),n.texSubImage2D(t.TEXTURE_2D,0,u,h,d,f,r,s,i.data)}e.clearUpdateRanges(),t.pixelStorei(t.UNPACK_ROW_LENGTH,l),t.pixelStorei(t.UNPACK_SKIP_PIXELS,c),t.pixelStorei(t.UNPACK_SKIP_ROWS,u)}}(a,f,p,y)):n.texImage2D(t.TEXTURE_2D,0,w,f.width,f.height,0,p,y,f.data);else if(a.isCompressedTexture)if(a.isCompressedArrayTexture){T&&M&&n.texStorage3D(t.TEXTURE_2D_ARRAY,C,w,S[0].width,S[0].height,f.depth);for(let e=0,i=S.length;e<i;e++)if(E=S[e],a.format!==sw)if(null!==p)if(T){if(A)if(a.layerUpdates.size>0){const i=pC(E.width,E.height,a.format,a.type);for(const r of a.layerUpdates){const s=E.data.subarray(r*i/E.data.BYTES_PER_ELEMENT,(r+1)*i/E.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,r,E.width,E.height,1,p,s)}a.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,E.width,E.height,f.depth,p,E.data)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,e,w,E.width,E.height,f.depth,0,E.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else T?A&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,E.width,E.height,f.depth,p,y,E.data):n.texImage3D(t.TEXTURE_2D_ARRAY,e,w,E.width,E.height,f.depth,0,p,y,E.data)}else{T&&M&&n.texStorage2D(t.TEXTURE_2D,C,w,S[0].width,S[0].height);for(let e=0,i=S.length;e<i;e++)E=S[e],a.format!==sw?null!==p?T?A&&n.compressedTexSubImage2D(t.TEXTURE_2D,e,0,0,E.width,E.height,p,E.data):n.compressedTexImage2D(t.TEXTURE_2D,e,w,E.width,E.height,0,E.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):T?A&&n.texSubImage2D(t.TEXTURE_2D,e,0,0,E.width,E.height,p,y,E.data):n.texImage2D(t.TEXTURE_2D,e,w,E.width,E.height,0,p,y,E.data)}else if(a.isDataArrayTexture)if(T){if(M&&n.texStorage3D(t.TEXTURE_2D_ARRAY,C,w,f.width,f.height,f.depth),A)if(a.layerUpdates.size>0){const e=pC(f.width,f.height,a.format,a.type);for(const i of a.layerUpdates){const r=f.data.subarray(i*e/f.data.BYTES_PER_ELEMENT,(i+1)*e/f.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,i,f.width,f.height,1,p,y,r)}a.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,f.width,f.height,f.depth,p,y,f.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,w,f.width,f.height,f.depth,0,p,y,f.data);else if(a.isData3DTexture)T?(M&&n.texStorage3D(t.TEXTURE_3D,C,w,f.width,f.height,f.depth),A&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,f.width,f.height,f.depth,p,y,f.data)):n.texImage3D(t.TEXTURE_3D,0,w,f.width,f.height,f.depth,0,p,y,f.data);else if(a.isFramebufferTexture){if(M)if(T)n.texStorage2D(t.TEXTURE_2D,C,w,f.width,f.height);else{let e=f.width,i=f.height;for(let r=0;r<C;r++)n.texImage2D(t.TEXTURE_2D,r,w,e,i,0,p,y,null),e>>=1,i>>=1}}else if(S.length>0){if(T&&M){const e=G(S[0]);n.texStorage2D(t.TEXTURE_2D,C,w,e.width,e.height)}for(let e=0,i=S.length;e<i;e++)E=S[e],T?A&&n.texSubImage2D(t.TEXTURE_2D,e,0,0,p,y,E):n.texImage2D(t.TEXTURE_2D,e,w,p,y,E);a.generateMipmaps=!1}else if(T){if(M){const e=G(f);n.texStorage2D(t.TEXTURE_2D,C,w,e.width,e.height)}A&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,p,y,f)}else n.texImage2D(t.TEXTURE_2D,0,w,p,y,f);g(a)&&v(l),h.__version=u.version,a.onUpdate&&a.onUpdate(a)}e.__version=a.version}function I(e,r,a,l,c,u){const h=s.convert(a.format,a.colorSpace),d=s.convert(a.type),f=_(a.internalFormat,h,d,a.colorSpace),p=i.get(r),m=i.get(a);if(m.__renderTarget=r,!p.__hasExternalTextures){const e=Math.max(1,r.width>>u),i=Math.max(1,r.height>>u);c===t.TEXTURE_3D||c===t.TEXTURE_2D_ARRAY?n.texImage3D(c,u,f,e,i,r.depth,0,h,d,null):n.texImage2D(c,u,f,e,i,0,h,d,null)}n.bindFramebuffer(t.FRAMEBUFFER,e),H(r)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,l,c,m.__webglTexture,0,z(r)):(c===t.TEXTURE_2D||c>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,l,c,m.__webglTexture,u),n.bindFramebuffer(t.FRAMEBUFFER,null)}function O(e,n,i){if(t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer){const r=n.depthTexture,s=r&&r.isDepthTexture?r.type:null,a=b(n.stencilBuffer,s),l=n.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,c=z(n);H(n)?o.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,c,a,n.width,n.height):i?t.renderbufferStorageMultisample(t.RENDERBUFFER,c,a,n.width,n.height):t.renderbufferStorage(t.RENDERBUFFER,a,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,l,t.RENDERBUFFER,e)}else{const e=n.textures;for(let r=0;r<e.length;r++){const a=e[r],l=s.convert(a.format,a.colorSpace),c=s.convert(a.type),u=_(a.internalFormat,l,c,a.colorSpace),h=z(n);i&&!1===H(n)?t.renderbufferStorageMultisample(t.RENDERBUFFER,h,u,n.width,n.height):H(n)?o.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,h,u,n.width,n.height):t.renderbufferStorage(t.RENDERBUFFER,u,n.width,n.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function N(e,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,e),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const s=i.get(r.depthTexture);s.__renderTarget=r,s.__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),M(r.depthTexture,0);const a=s.__webglTexture,l=z(r);if(r.depthTexture.format===aw)H(r)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,a,0,l):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,a,0);else{if(r.depthTexture.format!==ow)throw new Error("Unknown depthTexture format");H(r)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,a,0,l):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,a,0)}}function F(e){const r=i.get(e),s=!0===e.isWebGLCubeRenderTarget;if(r.__boundDepthTexture!==e.depthTexture){const t=e.depthTexture;if(r.__depthDisposeCallback&&r.__depthDisposeCallback(),t){const e=()=>{delete r.__boundDepthTexture,delete r.__depthDisposeCallback,t.removeEventListener("dispose",e)};t.addEventListener("dispose",e),r.__depthDisposeCallback=e}r.__boundDepthTexture=t}if(e.depthTexture&&!r.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");const t=e.texture.mipmaps;t&&t.length>0?N(r.__webglFramebuffer[0],e):N(r.__webglFramebuffer,e)}else if(s){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)if(n.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer[i]),void 0===r.__webglDepthbuffer[i])r.__webglDepthbuffer[i]=t.createRenderbuffer(),O(r.__webglDepthbuffer[i],e,!1);else{const n=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,s=r.__webglDepthbuffer[i];t.bindRenderbuffer(t.RENDERBUFFER,s),t.framebufferRenderbuffer(t.FRAMEBUFFER,n,t.RENDERBUFFER,s)}}else{const i=e.texture.mipmaps;if(i&&i.length>0?n.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer[0]):n.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer),void 0===r.__webglDepthbuffer)r.__webglDepthbuffer=t.createRenderbuffer(),O(r.__webglDepthbuffer,e,!1);else{const n=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,i=r.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,i),t.framebufferRenderbuffer(t.FRAMEBUFFER,n,t.RENDERBUFFER,i)}}n.bindFramebuffer(t.FRAMEBUFFER,null)}const U=[],B=[];function z(t){return Math.min(r.maxSamples,t.samples)}function H(t){const n=i.get(t);return t.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function V(t,e){const n=t.colorSpace,i=t.format,r=t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||n!==Zw&&n!==qw&&(zS.getTransfer(n)===$w?i===sw&&r===XE||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",n)),e}function G(t){return"undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement?(c.width=t.naturalWidth||t.width,c.height=t.naturalHeight||t.height):"undefined"!==typeof VideoFrame&&t instanceof VideoFrame?(c.width=t.displayWidth,c.height=t.displayHeight):(c.width=t.width,c.height=t.height),c}this.allocateTextureUnit=function(){const t=T;return t>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+r.maxTextures),T+=1,t},this.resetTextureUnits=function(){T=0},this.setTexture2D=M,this.setTexture2DArray=function(e,r){const s=i.get(e);!1===e.isRenderTargetTexture&&e.version>0&&s.__version!==e.version?P(s,e,r):n.bindTexture(t.TEXTURE_2D_ARRAY,s.__webglTexture,t.TEXTURE0+r)},this.setTexture3D=function(e,r){const s=i.get(e);!1===e.isRenderTargetTexture&&e.version>0&&s.__version!==e.version?P(s,e,r):n.bindTexture(t.TEXTURE_3D,s.__webglTexture,t.TEXTURE0+r)},this.setTextureCube=function(e,a){const o=i.get(e);e.version>0&&o.__version!==e.version?function(e,a,o){if(6!==a.image.length)return;const l=L(e,a),c=a.source;n.bindTexture(t.TEXTURE_CUBE_MAP,e.__webglTexture,t.TEXTURE0+o);const u=i.get(c);if(c.version!==u.__version||!0===l){n.activeTexture(t.TEXTURE0+o);const e=zS.getPrimaries(zS.workingColorSpace),i=a.colorSpace===qw?null:zS.getPrimaries(a.colorSpace),h=a.colorSpace===qw||e===i?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,a.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,h);const d=a.isCompressedTexture||a.image[0].isCompressedTexture,f=a.image[0]&&a.image[0].isDataTexture,p=[];for(let t=0;t<6;t++)p[t]=d||f?f?a.image[t].image:a.image[t]:m(a.image[t],!0,r.maxCubemapSize),p[t]=V(a,p[t]);const y=p[0],b=s.convert(a.format,a.colorSpace),E=s.convert(a.type),w=_(a.internalFormat,b,E,a.colorSpace),S=!0!==a.isVideoTexture,T=void 0===u.__version||!0===l,M=c.dataReady;let A,C=x(a,y);if(k(t.TEXTURE_CUBE_MAP,a),d){S&&T&&n.texStorage2D(t.TEXTURE_CUBE_MAP,C,w,y.width,y.height);for(let e=0;e<6;e++){A=p[e].mipmaps;for(let i=0;i<A.length;i++){const r=A[i];a.format!==sw?null!==b?S?M&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,0,0,r.width,r.height,b,r.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,w,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):S?M&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,0,0,r.width,r.height,b,E,r.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,w,r.width,r.height,0,b,E,r.data)}}}else{if(A=a.mipmaps,S&&T){A.length>0&&C++;const e=G(p[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,C,w,e.width,e.height)}for(let e=0;e<6;e++)if(f){S?M&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,p[e].width,p[e].height,b,E,p[e].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,w,p[e].width,p[e].height,0,b,E,p[e].data);for(let i=0;i<A.length;i++){const r=A[i].image[e].image;S?M&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i+1,0,0,r.width,r.height,b,E,r.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i+1,w,r.width,r.height,0,b,E,r.data)}}else{S?M&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,b,E,p[e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,w,b,E,p[e]);for(let i=0;i<A.length;i++){const r=A[i];S?M&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i+1,0,0,b,E,r.image[e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i+1,w,b,E,r.image[e])}}}g(a)&&v(t.TEXTURE_CUBE_MAP),u.__version=c.version,a.onUpdate&&a.onUpdate(a)}e.__version=a.version}(o,e,a):n.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture,t.TEXTURE0+a)},this.rebindTextures=function(e,n,r){const s=i.get(e);void 0!==n&&I(s.__webglFramebuffer,e,e.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),void 0!==r&&F(e)},this.setupRenderTarget=function(e){const r=e.texture,o=i.get(e),l=i.get(r);e.addEventListener("dispose",w);const c=e.textures,u=!0===e.isWebGLCubeRenderTarget,h=c.length>1;if(h||(void 0===l.__webglTexture&&(l.__webglTexture=t.createTexture()),l.__version=r.version,a.memory.textures++),u){o.__webglFramebuffer=[];for(let e=0;e<6;e++)if(r.mipmaps&&r.mipmaps.length>0){o.__webglFramebuffer[e]=[];for(let n=0;n<r.mipmaps.length;n++)o.__webglFramebuffer[e][n]=t.createFramebuffer()}else o.__webglFramebuffer[e]=t.createFramebuffer()}else{if(r.mipmaps&&r.mipmaps.length>0){o.__webglFramebuffer=[];for(let e=0;e<r.mipmaps.length;e++)o.__webglFramebuffer[e]=t.createFramebuffer()}else o.__webglFramebuffer=t.createFramebuffer();if(h)for(let e=0,n=c.length;e<n;e++){const n=i.get(c[e]);void 0===n.__webglTexture&&(n.__webglTexture=t.createTexture(),a.memory.textures++)}if(e.samples>0&&!1===H(e)){o.__webglMultisampledFramebuffer=t.createFramebuffer(),o.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,o.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const i=c[n];o.__webglColorRenderbuffer[n]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,o.__webglColorRenderbuffer[n]);const r=s.convert(i.format,i.colorSpace),a=s.convert(i.type),l=_(i.internalFormat,r,a,i.colorSpace,!0===e.isXRRenderTarget),u=z(e);t.renderbufferStorageMultisample(t.RENDERBUFFER,u,l,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+n,t.RENDERBUFFER,o.__webglColorRenderbuffer[n])}t.bindRenderbuffer(t.RENDERBUFFER,null),e.depthBuffer&&(o.__webglDepthRenderbuffer=t.createRenderbuffer(),O(o.__webglDepthRenderbuffer,e,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(u){n.bindTexture(t.TEXTURE_CUBE_MAP,l.__webglTexture),k(t.TEXTURE_CUBE_MAP,r);for(let n=0;n<6;n++)if(r.mipmaps&&r.mipmaps.length>0)for(let i=0;i<r.mipmaps.length;i++)I(o.__webglFramebuffer[n][i],e,r,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+n,i);else I(o.__webglFramebuffer[n],e,r,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);g(r)&&v(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(h){for(let r=0,s=c.length;r<s;r++){const s=c[r],a=i.get(s);let l=t.TEXTURE_2D;(e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&(l=e.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(l,a.__webglTexture),k(l,s),I(o.__webglFramebuffer,e,s,t.COLOR_ATTACHMENT0+r,l,0),g(s)&&v(l)}n.unbindTexture()}else{let i=t.TEXTURE_2D;if((e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&(i=e.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(i,l.__webglTexture),k(i,r),r.mipmaps&&r.mipmaps.length>0)for(let n=0;n<r.mipmaps.length;n++)I(o.__webglFramebuffer[n],e,r,t.COLOR_ATTACHMENT0,i,n);else I(o.__webglFramebuffer,e,r,t.COLOR_ATTACHMENT0,i,0);g(r)&&v(i),n.unbindTexture()}e.depthBuffer&&F(e)},this.updateRenderTargetMipmap=function(t){const e=t.textures;for(let r=0,s=e.length;r<s;r++){const s=e[r];if(g(s)){const e=y(t),r=i.get(s).__webglTexture;n.bindTexture(e,r),v(e),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(e.samples>0)if(!1===H(e)){const r=e.textures,s=e.width,a=e.height;let o=t.COLOR_BUFFER_BIT;const c=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,u=i.get(e),h=r.length>1;if(h)for(let e=0;e<r.length;e++)n.bindFramebuffer(t.FRAMEBUFFER,u.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,u.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer);const d=e.texture.mipmaps;d&&d.length>0?n.bindFramebuffer(t.DRAW_FRAMEBUFFER,u.__webglFramebuffer[0]):n.bindFramebuffer(t.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let n=0;n<r.length;n++){if(e.resolveDepthBuffer&&(e.depthBuffer&&(o|=t.DEPTH_BUFFER_BIT),e.stencilBuffer&&e.resolveStencilBuffer&&(o|=t.STENCIL_BUFFER_BIT)),h){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,u.__webglColorRenderbuffer[n]);const e=i.get(r[n]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)}t.blitFramebuffer(0,0,s,a,0,0,s,a,o,t.NEAREST),!0===l&&(U.length=0,B.length=0,U.push(t.COLOR_ATTACHMENT0+n),e.depthBuffer&&!1===e.resolveDepthBuffer&&(U.push(c),B.push(c),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,B)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,U))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),h)for(let e=0;e<r.length;e++){n.bindFramebuffer(t.FRAMEBUFFER,u.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,u.__webglColorRenderbuffer[e]);const s=i.get(r[e]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,u.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,s,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}else if(e.depthBuffer&&!1===e.resolveDepthBuffer&&l){const n=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=F,this.setupFrameBufferTexture=I,this.useMultisampledRTT=H}function Gk(t,e){return{convert:function(n){let i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qw;const s=zS.getTransfer(r);if(n===XE)return t.UNSIGNED_BYTE;if(n===ew)return t.UNSIGNED_SHORT_4_4_4_4;if(n===nw)return t.UNSIGNED_SHORT_5_5_5_1;if(n===rw)return t.UNSIGNED_INT_5_9_9_9_REV;if(n===KE)return t.BYTE;if(n===qE)return t.SHORT;if(n===QE)return t.UNSIGNED_SHORT;if(n===ZE)return t.INT;if(n===JE)return t.UNSIGNED_INT;if(n===$E)return t.FLOAT;if(n===tw)return t.HALF_FLOAT;if(1021===n)return t.ALPHA;if(1022===n)return t.RGB;if(n===sw)return t.RGBA;if(n===aw)return t.DEPTH_COMPONENT;if(n===ow)return t.DEPTH_STENCIL;if(n===lw)return t.RED;if(n===cw)return t.RED_INTEGER;if(1030===n)return t.RG;if(n===uw)return t.RG_INTEGER;if(n===hw)return t.RGBA_INTEGER;if(n===dw||n===fw||n===pw||n===mw)if(s===$w){if(i=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(n===dw)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===fw)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===pw)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===mw)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=e.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(n===dw)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===fw)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===pw)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===mw)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===gw||n===vw||n===yw||n===_w){if(i=e.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(n===gw)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===vw)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===yw)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===_w)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===bw||n===xw||n===Ew){if(i=e.get("WEBGL_compressed_texture_etc"),null===i)return null;if(n===bw||n===xw)return s===$w?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===Ew)return s===$w?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(n===ww||n===Sw||n===Tw||n===Mw||n===Aw||n===Cw||n===Rw||n===kw||n===Lw||n===Dw||n===Pw||n===Iw||n===Ow||n===Nw){if(i=e.get("WEBGL_compressed_texture_astc"),null===i)return null;if(n===ww)return s===$w?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Sw)return s===$w?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Tw)return s===$w?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Mw)return s===$w?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Aw)return s===$w?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Cw)return s===$w?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Rw)return s===$w?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===kw)return s===$w?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===Lw)return s===$w?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Dw)return s===$w?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Pw)return s===$w?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Iw)return s===$w?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Ow)return s===$w?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Nw)return s===$w?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===Fw||n===Uw||n===Bw){if(i=e.get("EXT_texture_compression_bptc"),null===i)return null;if(n===Fw)return s===$w?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Uw)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Bw)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===n||n===zw||n===Hw||n===Vw){if(i=e.get("EXT_texture_compression_rgtc"),null===i)return null;if(n===Fw)return i.COMPRESSED_RED_RGTC1_EXT;if(n===zw)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Hw)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Vw)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===iw?t.UNSIGNED_INT_24_8:void 0!==t[n]?t[n]:null}}}class jk extends QS{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.sourceTexture=t,this.isExternalTexture=!0}}class Wk{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(t,e){if(null===this.texture){const n=new jk(t.texture);t.depthNear===e.depthNear&&t.depthFar===e.depthFar||(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=n}}getMesh(t){if(null!==this.texture&&null===this.mesh){const e=t.cameras[0].viewport,n=new sA({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:e.z},depthHeight:{value:e.w}}});this.mesh=new JM(new CA(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Yk extends fS{constructor(t,e){super();const n=this;let i=null,r=1,s=null,a="local-floor",o=1,l=null,c=null,u=null,h=null,d=null,f=null;const p=new Wk,m={},g=e.getContextAttributes();let v=null,y=null;const _=[],b=[],x=new TS;let E=null;const w=new uA;w.viewport=new ZS;const S=new uA;S.viewport=new ZS;const T=[w,S],M=new nC;let A=null,C=null;function R(t){const e=b.indexOf(t.inputSource);if(-1===e)return;const n=_[e];void 0!==n&&(n.update(t.inputSource,t.frame,l||s),n.dispatchEvent({type:t.type,data:t.inputSource}))}function k(){i.removeEventListener("select",R),i.removeEventListener("selectstart",R),i.removeEventListener("selectend",R),i.removeEventListener("squeeze",R),i.removeEventListener("squeezestart",R),i.removeEventListener("squeezeend",R),i.removeEventListener("end",k),i.removeEventListener("inputsourceschange",L);for(let t=0;t<_.length;t++){const e=b[t];null!==e&&(b[t]=null,_[t].disconnect(e))}A=null,C=null,p.reset();for(const t in m)delete m[t];t.setRenderTarget(v),d=null,h=null,u=null,i=null,y=null,N.stop(),n.isPresenting=!1,t.setPixelRatio(E),t.setSize(x.width,x.height,!1),n.dispatchEvent({type:"sessionend"})}function L(t){for(let e=0;e<t.removed.length;e++){const n=t.removed[e],i=b.indexOf(n);i>=0&&(b[i]=null,_[i].disconnect(n))}for(let e=0;e<t.added.length;e++){const n=t.added[e];let i=b.indexOf(n);if(-1===i){for(let t=0;t<_.length;t++){if(t>=b.length){b.push(n),i=t;break}if(null===b[t]){b[t]=n,i=t;break}}if(-1===i)break}const r=_[i];r&&r.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=_[t];return void 0===e&&(e=new vA,_[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=_[t];return void 0===e&&(e=new vA,_[t]=e),e.getGripSpace()},this.getHand=function(t){let e=_[t];return void 0===e&&(e=new vA,_[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){r=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){a=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(t){l=t},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return u},this.getFrame=function(){return f},this.getSession=function(){return i},this.setSession=async function(c){if(i=c,null!==i){v=t.getRenderTarget(),i.addEventListener("select",R),i.addEventListener("selectstart",R),i.addEventListener("selectend",R),i.addEventListener("squeeze",R),i.addEventListener("squeezestart",R),i.addEventListener("squeezeend",R),i.addEventListener("end",k),i.addEventListener("inputsourceschange",L),!0!==g.xrCompatible&&await e.makeXRCompatible(),E=t.getPixelRatio(),t.getSize(x),"undefined"!==typeof XRWebGLBinding&&(u=new XRWebGLBinding(i,e));if(null!==u&&"createProjectionLayer"in XRWebGLBinding.prototype){let n=null,s=null,a=null;g.depth&&(a=g.stencil?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT24,n=g.stencil?ow:aw,s=g.stencil?iw:JE);const o={colorFormat:e.RGBA8,depthFormat:a,scaleFactor:r};h=u.createProjectionLayer(o),i.updateRenderState({layers:[h]}),t.setPixelRatio(1),t.setSize(h.textureWidth,h.textureHeight,!1),y=new $S(h.textureWidth,h.textureHeight,{format:sw,type:XE,depthTexture:new AA(h.textureWidth,h.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:g.stencil,colorSpace:t.outputColorSpace,samples:g.antialias?4:0,resolveDepthBuffer:!1===h.ignoreDepthValues,resolveStencilBuffer:!1===h.ignoreDepthValues})}else{const n={antialias:g.antialias,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:r};d=new XRWebGLLayer(i,e,n),i.updateRenderState({baseLayer:d}),t.setPixelRatio(1),t.setSize(d.framebufferWidth,d.framebufferHeight,!1),y=new $S(d.framebufferWidth,d.framebufferHeight,{format:sw,type:XE,colorSpace:t.outputColorSpace,stencilBuffer:g.stencil,resolveDepthBuffer:!1===d.ignoreDepthValues,resolveStencilBuffer:!1===d.ignoreDepthValues})}y.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await i.requestReferenceSpace(a),N.setContext(i),N.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==i)return i.environmentBlendMode},this.getDepthTexture=function(){return p.getDepthTexture()};const D=new AS,P=new AS;function I(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===i)return;let e=t.near,n=t.far;null!==p.texture&&(p.depthNear>0&&(e=p.depthNear),p.depthFar>0&&(n=p.depthFar)),M.near=S.near=w.near=e,M.far=S.far=w.far=n,A===M.near&&C===M.far||(i.updateRenderState({depthNear:M.near,depthFar:M.far}),A=M.near,C=M.far),M.layers.mask=6|t.layers.mask,w.layers.mask=3&M.layers.mask,S.layers.mask=5&M.layers.mask;const r=t.parent,s=M.cameras;I(M,r);for(let i=0;i<s.length;i++)I(s[i],r);2===s.length?function(t,e,n){D.setFromMatrixPosition(e.matrixWorld),P.setFromMatrixPosition(n.matrixWorld);const i=D.distanceTo(P),r=e.projectionMatrix.elements,s=n.projectionMatrix.elements,a=r[14]/(r[10]-1),o=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],u=(r[8]-1)/r[0],h=(s[8]+1)/s[0],d=a*u,f=a*h,p=i/(-u+h),m=p*-u;if(e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(p),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert(),-1===r[10])t.projectionMatrix.copy(e.projectionMatrix),t.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const e=a+p,n=o+p,r=d-m,s=f+(i-m),u=l*o/n*e,h=c*o/n*e;t.projectionMatrix.makePerspective(r,s,u,h,e,n),t.projectionMatrixInverse.copy(t.projectionMatrix).invert()}}(M,w,S):M.projectionMatrix.copy(w.projectionMatrix),function(t,e,n){null===n?t.matrix.copy(e.matrixWorld):(t.matrix.copy(n.matrixWorld),t.matrix.invert(),t.matrix.multiply(e.matrixWorld));t.matrix.decompose(t.position,t.quaternion,t.scale),t.updateMatrixWorld(!0),t.projectionMatrix.copy(e.projectionMatrix),t.projectionMatrixInverse.copy(e.projectionMatrixInverse),t.isPerspectiveCamera&&(t.fov=2*vS*Math.atan(1/t.projectionMatrix.elements[5]),t.zoom=1)}(t,M,r)},this.getCamera=function(){return M},this.getFoveation=function(){if(null!==h||null!==d)return o},this.setFoveation=function(t){o=t,null!==h&&(h.fixedFoveation=t),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=t)},this.hasDepthSensing=function(){return null!==p.texture},this.getDepthSensingMesh=function(){return p.getMesh(M)},this.getCameraTexture=function(t){return m[t]};let O=null;const N=new mC;N.setAnimationLoop(function(e,r){if(c=r.getViewerPose(l||s),f=r,null!==c){const e=c.views;null!==d&&(t.setRenderTargetFramebuffer(y,d.framebuffer),t.setRenderTarget(y));let n=!1;e.length!==M.cameras.length&&(M.cameras.length=0,n=!0);for(let i=0;i<e.length;i++){const r=e[i];let s=null;if(null!==d)s=d.getViewport(r);else{const e=u.getViewSubImage(h,r);s=e.viewport,0===i&&(t.setRenderTargetTextures(y,e.colorTexture,e.depthStencilTexture),t.setRenderTarget(y))}let a=T[i];void 0===a&&(a=new uA,a.layers.enable(i),a.viewport=new ZS,T[i]=a),a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),a.projectionMatrix.fromArray(r.projectionMatrix),a.projectionMatrixInverse.copy(a.projectionMatrix).invert(),a.viewport.set(s.x,s.y,s.width,s.height),0===i&&(M.matrix.copy(a.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),!0===n&&M.cameras.push(a)}const r=i.enabledFeatures;if(r&&r.includes("depth-sensing")&&"gpu-optimized"==i.depthUsage&&u){const t=u.getDepthInformation(e[0]);t&&t.isValid&&t.texture&&p.init(t,i.renderState)}if(r&&r.includes("camera-access")&&(t.state.unbindTexture(),u))for(let t=0;t<e.length;t++){const n=e[t].camera;if(n){let t=m[n];t||(t=new jk,m[n]=t);const e=u.getCameraImage(n);t.sourceTexture=e}}}for(let t=0;t<_.length;t++){const e=b[t],n=_[t];null!==e&&void 0!==n&&n.update(e,r,l||s)}O&&O(e,r),r.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:r}),f=null}),this.setAnimationLoop=function(t){O=t},this.dispose=function(){}}}const Xk=new BT,Kk=new RT;function qk(t,e){function n(t,e){!0===t.matrixAutoUpdate&&t.updateMatrix(),e.value.copy(t.matrix)}function i(t,i){t.opacity.value=i.opacity,i.color&&t.diffuse.value.copy(i.color),i.emissive&&t.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(t.map.value=i.map,n(i.map,t.mapTransform)),i.alphaMap&&(t.alphaMap.value=i.alphaMap,n(i.alphaMap,t.alphaMapTransform)),i.bumpMap&&(t.bumpMap.value=i.bumpMap,n(i.bumpMap,t.bumpMapTransform),t.bumpScale.value=i.bumpScale,1===i.side&&(t.bumpScale.value*=-1)),i.normalMap&&(t.normalMap.value=i.normalMap,n(i.normalMap,t.normalMapTransform),t.normalScale.value.copy(i.normalScale),1===i.side&&t.normalScale.value.negate()),i.displacementMap&&(t.displacementMap.value=i.displacementMap,n(i.displacementMap,t.displacementMapTransform),t.displacementScale.value=i.displacementScale,t.displacementBias.value=i.displacementBias),i.emissiveMap&&(t.emissiveMap.value=i.emissiveMap,n(i.emissiveMap,t.emissiveMapTransform)),i.specularMap&&(t.specularMap.value=i.specularMap,n(i.specularMap,t.specularMapTransform)),i.alphaTest>0&&(t.alphaTest.value=i.alphaTest);const r=e.get(i),s=r.envMap,a=r.envMapRotation;s&&(t.envMap.value=s,Xk.copy(a),Xk.x*=-1,Xk.y*=-1,Xk.z*=-1,s.isCubeTexture&&!1===s.isRenderTargetTexture&&(Xk.y*=-1,Xk.z*=-1),t.envMapRotation.value.setFromMatrix4(Kk.makeRotationFromEuler(Xk)),t.flipEnvMap.value=s.isCubeTexture&&!1===s.isRenderTargetTexture?-1:1,t.reflectivity.value=i.reflectivity,t.ior.value=i.ior,t.refractionRatio.value=i.refractionRatio),i.lightMap&&(t.lightMap.value=i.lightMap,t.lightMapIntensity.value=i.lightMapIntensity,n(i.lightMap,t.lightMapTransform)),i.aoMap&&(t.aoMap.value=i.aoMap,t.aoMapIntensity.value=i.aoMapIntensity,n(i.aoMap,t.aoMapTransform))}return{refreshFogUniforms:function(e,n){n.color.getRGB(e.fogColor.value,iA(t)),n.isFog?(e.fogNear.value=n.near,e.fogFar.value=n.far):n.isFogExp2&&(e.fogDensity.value=n.density)},refreshMaterialUniforms:function(t,r,s,a,o){r.isMeshBasicMaterial||r.isMeshLambertMaterial?i(t,r):r.isMeshToonMaterial?(i(t,r),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(t,r)):r.isMeshPhongMaterial?(i(t,r),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4)}(t,r)):r.isMeshStandardMaterial?(i(t,r),function(t,e){t.metalness.value=e.metalness,e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap,n(e.metalnessMap,t.metalnessMapTransform));t.roughness.value=e.roughness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap,n(e.roughnessMap,t.roughnessMapTransform));e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}(t,r),r.isMeshPhysicalMaterial&&function(t,e,i){t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap,n(e.sheenColorMap,t.sheenColorMapTransform)),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap,n(e.sheenRoughnessMap,t.sheenRoughnessMapTransform)));e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap,n(e.clearcoatMap,t.clearcoatMapTransform)),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap,n(e.clearcoatRoughnessMap,t.clearcoatRoughnessMapTransform)),e.clearcoatNormalMap&&(t.clearcoatNormalMap.value=e.clearcoatNormalMap,n(e.clearcoatNormalMap,t.clearcoatNormalMapTransform),t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),1===e.side&&t.clearcoatNormalScale.value.negate()));e.dispersion>0&&(t.dispersion.value=e.dispersion);e.iridescence>0&&(t.iridescence.value=e.iridescence,t.iridescenceIOR.value=e.iridescenceIOR,t.iridescenceThicknessMinimum.value=e.iridescenceThicknessRange[0],t.iridescenceThicknessMaximum.value=e.iridescenceThicknessRange[1],e.iridescenceMap&&(t.iridescenceMap.value=e.iridescenceMap,n(e.iridescenceMap,t.iridescenceMapTransform)),e.iridescenceThicknessMap&&(t.iridescenceThicknessMap.value=e.iridescenceThicknessMap,n(e.iridescenceThicknessMap,t.iridescenceThicknessMapTransform)));e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=i.texture,t.transmissionSamplerSize.value.set(i.width,i.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap,n(e.transmissionMap,t.transmissionMapTransform)),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap,n(e.thicknessMap,t.thicknessMapTransform)),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor));e.anisotropy>0&&(t.anisotropyVector.value.set(e.anisotropy*Math.cos(e.anisotropyRotation),e.anisotropy*Math.sin(e.anisotropyRotation)),e.anisotropyMap&&(t.anisotropyMap.value=e.anisotropyMap,n(e.anisotropyMap,t.anisotropyMapTransform)));t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap,n(e.specularColorMap,t.specularColorMapTransform));e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap,n(e.specularIntensityMap,t.specularIntensityMapTransform))}(t,r,o)):r.isMeshMatcapMaterial?(i(t,r),function(t,e){e.matcap&&(t.matcap.value=e.matcap)}(t,r)):r.isMeshDepthMaterial?i(t,r):r.isMeshDistanceMaterial?(i(t,r),function(t,n){const i=e.get(n).light;t.referencePosition.value.setFromMatrixPosition(i.matrixWorld),t.nearDistance.value=i.shadow.camera.near,t.farDistance.value=i.shadow.camera.far}(t,r)):r.isMeshNormalMaterial?i(t,r):r.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,e.map&&(t.map.value=e.map,n(e.map,t.mapTransform))}(t,r),r.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,r)):r.isPointsMaterial?function(t,e,i,r){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*i,t.scale.value=.5*r,e.map&&(t.map.value=e.map,n(e.map,t.uvTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,n(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,r,s,a):r.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map,n(e.map,t.mapTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,n(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,r):r.isShadowMaterial?(t.color.value.copy(r.color),t.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function Qk(t,e,n,i){let r={},s={},a=[];const o=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function l(t,e,n,i){const r=t.value,s=e+"_"+n;if(void 0===i[s])return i[s]="number"===typeof r||"boolean"===typeof r?r:r.clone(),!0;{const t=i[s];if("number"===typeof r||"boolean"===typeof r){if(t!==r)return i[s]=r,!0}else if(!1===t.equals(r))return t.copy(r),!0}return!1}function c(t){const e={boundary:0,storage:0};return"number"===typeof t||"boolean"===typeof t?(e.boundary=4,e.storage=4):t.isVector2?(e.boundary=8,e.storage=8):t.isVector3||t.isColor?(e.boundary=16,e.storage=12):t.isVector4?(e.boundary=16,e.storage=16):t.isMatrix3?(e.boundary=48,e.storage=48):t.isMatrix4?(e.boundary=64,e.storage=64):t.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",t),e}function u(e){const n=e.target;n.removeEventListener("dispose",u);const i=a.indexOf(n.__bindingPointIndex);a.splice(i,1),t.deleteBuffer(r[n.id]),delete r[n.id],delete s[n.id]}return{bind:function(t,e){const n=e.program;i.uniformBlockBinding(t,n)},update:function(n,h){let d=r[n.id];void 0===d&&(!function(t){const e=t.uniforms;let n=0;const i=16;for(let s=0,a=e.length;s<a;s++){const t=Array.isArray(e[s])?e[s]:[e[s]];for(let e=0,r=t.length;e<r;e++){const r=t[e],s=Array.isArray(r.value)?r.value:[r.value];for(let t=0,e=s.length;t<e;t++){const e=c(s[t]),a=n%i,o=a%e.boundary,l=a+o;n+=o,0!==l&&i-l<e.storage&&(n+=i-l),r.__data=new Float32Array(e.storage/Float32Array.BYTES_PER_ELEMENT),r.__offset=n,n+=e.storage}}}const r=n%i;r>0&&(n+=i-r);t.__size=n,t.__cache={}}(n),d=function(e){const n=function(){for(let t=0;t<o;t++)if(-1===a.indexOf(t))return a.push(t),t;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();e.__bindingPointIndex=n;const i=t.createBuffer(),r=e.__size,s=e.usage;return t.bindBuffer(t.UNIFORM_BUFFER,i),t.bufferData(t.UNIFORM_BUFFER,r,s),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,n,i),i}(n),r[n.id]=d,n.addEventListener("dispose",u));const f=h.program;i.updateUBOMapping(n,f);const p=e.render.frame;s[n.id]!==p&&(!function(e){const n=r[e.id],i=e.uniforms,s=e.__cache;t.bindBuffer(t.UNIFORM_BUFFER,n);for(let r=0,a=i.length;r<a;r++){const e=Array.isArray(i[r])?i[r]:[i[r]];for(let n=0,i=e.length;n<i;n++){const i=e[n];if(!0===l(i,r,n,s)){const e=i.__offset,n=Array.isArray(i.value)?i.value:[i.value];let r=0;for(let s=0;s<n.length;s++){const a=n[s],o=c(a);"number"===typeof a||"boolean"===typeof a?(i.__data[0]=a,t.bufferSubData(t.UNIFORM_BUFFER,e+r,i.__data)):a.isMatrix3?(i.__data[0]=a.elements[0],i.__data[1]=a.elements[1],i.__data[2]=a.elements[2],i.__data[3]=0,i.__data[4]=a.elements[3],i.__data[5]=a.elements[4],i.__data[6]=a.elements[5],i.__data[7]=0,i.__data[8]=a.elements[6],i.__data[9]=a.elements[7],i.__data[10]=a.elements[8],i.__data[11]=0):(a.toArray(i.__data,r),r+=o.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,e,i.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}(n),s[n.id]=p)},dispose:function(){for(const e in r)t.deleteBuffer(r[e]);a=[],r={},s={}}}}class Zk{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{canvas:e=IS(),context:n=null,depth:i=!0,stencil:r=!1,alpha:s=!1,antialias:a=!1,premultipliedAlpha:o=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:u=!1,reversedDepthBuffer:h=!1}=t;let d;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!==typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");d=n.getContextAttributes().alpha}else d=s;const f=new Uint32Array(4),p=new Int32Array(4);let m=null,g=null;const v=[],y=[];this.domElement=e,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=0,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const _=this;let b=!1;this._outputColorSpace=Qw;let x=0,E=0,w=null,S=-1,T=null;const M=new ZS,A=new ZS;let C=null;const R=new xM(0);let k=0,L=e.width,D=e.height,P=1,I=null,O=null;const N=new ZS(0,0,L,D),F=new ZS(0,0,L,D);let U=!1;const B=new MA;let z=!1,H=!1;const V=new RT,G=new AS,j=new ZS,W={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Y=!1;function X(){return null===w?P:1}let K,q,Q,Z,J,$,tt,et,nt,it,rt,st,at,ot,lt,ct,ut,ht,dt,ft,pt,mt,gt,vt,yt=n;function _t(t,n){return e.getContext(t,n)}try{const t={alpha:!0,depth:i,stencil:r,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r".concat(iE)),e.addEventListener("webglcontextlost",Et,!1),e.addEventListener("webglcontextrestored",wt,!1),e.addEventListener("webglcontextcreationerror",St,!1),null===yt){const e="webgl2";if(yt=_t(e,t),null===yt)throw _t(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(CO){throw console.error("THREE.WebGLRenderer: "+CO.message),CO}function bt(){K=new XC(yt),K.init(),mt=new Gk(yt,K),q=new MC(yt,K,t,mt),Q=new Hk(yt,K),q.reversedDepthBuffer&&h&&Q.buffers.depth.setReversed(!0),Z=new QC(yt),J=new Ck,$=new Vk(yt,K,Q,J,q,mt,Z),tt=new CC(_),et=new YC(_),nt=new gC(yt),gt=new SC(yt,nt),it=new KC(yt,nt,Z,gt),rt=new JC(yt,it,nt,Z),dt=new ZC(yt,q,$),ct=new AC(J),st=new Ak(_,tt,et,K,q,gt,ct),at=new qk(_,J),ot=new Dk,lt=new Uk(K),ht=new wC(_,tt,et,Q,rt,d,o),ut=new Bk(_,rt,q),vt=new Qk(yt,Z,q,Q),ft=new TC(yt,K,Z),pt=new qC(yt,K,Z),Z.programs=st.programs,_.capabilities=q,_.extensions=K,_.properties=J,_.renderLists=ot,_.shadowMap=ut,_.state=Q,_.info=Z}bt();const xt=new Yk(_,yt);function Et(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),b=!0}function wt(){console.log("THREE.WebGLRenderer: Context Restored."),b=!1;const t=Z.autoReset,e=ut.enabled,n=ut.autoUpdate,i=ut.needsUpdate,r=ut.type;bt(),Z.autoReset=t,ut.enabled=e,ut.autoUpdate=n,ut.needsUpdate=i,ut.type=r}function St(t){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",t.statusMessage)}function Tt(t){const e=t.target;e.removeEventListener("dispose",Tt),function(t){(function(t){const e=J.get(t).programs;void 0!==e&&(e.forEach(function(t){st.releaseProgram(t)}),t.isShaderMaterial&&st.releaseShaderCache(t))})(t),J.remove(t)}(e)}function Mt(t,e,n){!0===t.transparent&&2===t.side&&!1===t.forceSinglePass?(t.side=1,t.needsUpdate=!0,Nt(t,e,n),t.side=0,t.needsUpdate=!0,Nt(t,e,n),t.side=2):Nt(t,e,n)}this.xr=xt,this.getContext=function(){return yt},this.getContextAttributes=function(){return yt.getContextAttributes()},this.forceContextLoss=function(){const t=K.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=K.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return P},this.setPixelRatio=function(t){void 0!==t&&(P=t,this.setSize(L,D,!1))},this.getSize=function(t){return t.set(L,D)},this.setSize=function(t,n){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];xt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(L=t,D=n,e.width=Math.floor(t*P),e.height=Math.floor(n*P),!0===i&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return t.set(L*P,D*P).floor()},this.setDrawingBufferSize=function(t,n,i){L=t,D=n,P=i,e.width=Math.floor(t*i),e.height=Math.floor(n*i),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return t.copy(M)},this.getViewport=function(t){return t.copy(N)},this.setViewport=function(t,e,n,i){t.isVector4?N.set(t.x,t.y,t.z,t.w):N.set(t,e,n,i),Q.viewport(M.copy(N).multiplyScalar(P).round())},this.getScissor=function(t){return t.copy(F)},this.setScissor=function(t,e,n,i){t.isVector4?F.set(t.x,t.y,t.z,t.w):F.set(t,e,n,i),Q.scissor(A.copy(F).multiplyScalar(P).round())},this.getScissorTest=function(){return U},this.setScissorTest=function(t){Q.setScissorTest(U=t)},this.setOpaqueSort=function(t){I=t},this.setTransparentSort=function(t){O=t},this.getClearColor=function(t){return t.copy(ht.getClearColor())},this.setClearColor=function(){ht.setClearColor(...arguments)},this.getClearAlpha=function(){return ht.getClearAlpha()},this.setClearAlpha=function(){ht.setClearAlpha(...arguments)},this.clear=function(){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){let t=!1;if(null!==w){const e=w.texture.format;t=e===hw||e===uw||e===cw}if(t){const t=w.texture.type,e=t===XE||t===JE||t===QE||t===iw||t===ew||t===nw,n=ht.getClearColor(),i=ht.getClearAlpha(),r=n.r,s=n.g,a=n.b;e?(f[0]=r,f[1]=s,f[2]=a,f[3]=i,yt.clearBufferuiv(yt.COLOR,0,f)):(p[0]=r,p[1]=s,p[2]=a,p[3]=i,yt.clearBufferiv(yt.COLOR,0,p))}else n|=yt.COLOR_BUFFER_BIT}t&&(n|=yt.DEPTH_BUFFER_BIT),e&&(n|=yt.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),yt.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Et,!1),e.removeEventListener("webglcontextrestored",wt,!1),e.removeEventListener("webglcontextcreationerror",St,!1),ht.dispose(),ot.dispose(),lt.dispose(),J.dispose(),tt.dispose(),et.dispose(),rt.dispose(),gt.dispose(),vt.dispose(),st.dispose(),xt.dispose(),xt.removeEventListener("sessionstart",Ct),xt.removeEventListener("sessionend",Rt),kt.stop()},this.renderBufferDirect=function(t,e,n,i,r,s){null===e&&(e=W);const a=r.isMesh&&r.matrixWorld.determinant()<0,o=function(t,e,n,i,r){!0!==e.isScene&&(e=W);$.resetTextureUnits();const s=e.fog,a=i.isMeshStandardMaterial?e.environment:null,o=null===w?_.outputColorSpace:!0===w.isXRRenderTarget?w.texture.colorSpace:Zw,l=(i.isMeshStandardMaterial?et:tt).get(i.envMap||a),c=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!n.attributes.tangent&&(!!i.normalMap||i.anisotropy>0),h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,f=!!n.morphAttributes.color;let p=0;i.toneMapped&&(null!==w&&!0!==w.isXRRenderTarget||(p=_.toneMapping));const m=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==m?m.length:0,y=J.get(i),b=g.state.lights;if(!0===z&&(!0===H||t!==T)){const e=t===T&&i.id===S;ct.setState(i,t,e)}let x=!1;i.version===y.__version?y.needsLights&&y.lightsStateVersion!==b.state.version||y.outputColorSpace!==o||r.isBatchedMesh&&!1===y.batching?x=!0:r.isBatchedMesh||!0!==y.batching?r.isBatchedMesh&&!0===y.batchingColor&&null===r.colorTexture||r.isBatchedMesh&&!1===y.batchingColor&&null!==r.colorTexture||r.isInstancedMesh&&!1===y.instancing?x=!0:r.isInstancedMesh||!0!==y.instancing?r.isSkinnedMesh&&!1===y.skinning?x=!0:r.isSkinnedMesh||!0!==y.skinning?r.isInstancedMesh&&!0===y.instancingColor&&null===r.instanceColor||r.isInstancedMesh&&!1===y.instancingColor&&null!==r.instanceColor||r.isInstancedMesh&&!0===y.instancingMorph&&null===r.morphTexture||r.isInstancedMesh&&!1===y.instancingMorph&&null!==r.morphTexture||y.envMap!==l||!0===i.fog&&y.fog!==s?x=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===ct.numPlanes&&y.numIntersection===ct.numIntersection?(y.vertexAlphas!==c||y.vertexTangents!==u||y.morphTargets!==h||y.morphNormals!==d||y.morphColors!==f||y.toneMapping!==p||y.morphTargetsCount!==v)&&(x=!0):x=!0:x=!0:x=!0:x=!0:(x=!0,y.__version=i.version);let E=y.currentProgram;!0===x&&(E=Nt(i,e,r));let M=!1,A=!1,C=!1;const R=E.getUniforms(),k=y.uniforms;Q.useProgram(E.program)&&(M=!0,A=!0,C=!0);i.id!==S&&(S=i.id,A=!0);if(M||T!==t){Q.buffers.depth.getReversed()&&!0!==t.reversedDepth&&(t._reversedDepth=!0,t.updateProjectionMatrix()),R.setValue(yt,"projectionMatrix",t.projectionMatrix),R.setValue(yt,"viewMatrix",t.matrixWorldInverse);const e=R.map.cameraPosition;void 0!==e&&e.setValue(yt,G.setFromMatrixPosition(t.matrixWorld)),q.logarithmicDepthBuffer&&R.setValue(yt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&R.setValue(yt,"isOrthographic",!0===t.isOrthographicCamera),T!==t&&(T=t,A=!0,C=!0)}if(r.isSkinnedMesh){R.setOptional(yt,r,"bindMatrix"),R.setOptional(yt,r,"bindMatrixInverse");const t=r.skeleton;t&&(null===t.boneTexture&&t.computeBoneTexture(),R.setValue(yt,"boneTexture",t.boneTexture,$))}r.isBatchedMesh&&(R.setOptional(yt,r,"batchingTexture"),R.setValue(yt,"batchingTexture",r._matricesTexture,$),R.setOptional(yt,r,"batchingIdTexture"),R.setValue(yt,"batchingIdTexture",r._indirectTexture,$),R.setOptional(yt,r,"batchingColorTexture"),null!==r._colorsTexture&&R.setValue(yt,"batchingColorTexture",r._colorsTexture,$));const L=n.morphAttributes;void 0===L.position&&void 0===L.normal&&void 0===L.color||dt.update(r,n,E);(A||y.receiveShadow!==r.receiveShadow)&&(y.receiveShadow=r.receiveShadow,R.setValue(yt,"receiveShadow",r.receiveShadow));i.isMeshGouraudMaterial&&null!==i.envMap&&(k.envMap.value=l,k.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);i.isMeshStandardMaterial&&null===i.envMap&&null!==e.environment&&(k.envMapIntensity.value=e.environmentIntensity);A&&(R.setValue(yt,"toneMappingExposure",_.toneMappingExposure),y.needsLights&&(O=C,(I=k).ambientLightColor.needsUpdate=O,I.lightProbe.needsUpdate=O,I.directionalLights.needsUpdate=O,I.directionalLightShadows.needsUpdate=O,I.pointLights.needsUpdate=O,I.pointLightShadows.needsUpdate=O,I.spotLights.needsUpdate=O,I.spotLightShadows.needsUpdate=O,I.rectAreaLights.needsUpdate=O,I.hemisphereLights.needsUpdate=O),s&&!0===i.fog&&at.refreshFogUniforms(k,s),at.refreshMaterialUniforms(k,i,P,D,g.state.transmissionRenderTarget[t.id]),ik.upload(yt,Ft(y),k,$));var I,O;i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(ik.upload(yt,Ft(y),k,$),i.uniformsNeedUpdate=!1);i.isSpriteMaterial&&R.setValue(yt,"center",r.center);if(R.setValue(yt,"modelViewMatrix",r.modelViewMatrix),R.setValue(yt,"normalMatrix",r.normalMatrix),R.setValue(yt,"modelMatrix",r.matrixWorld),i.isShaderMaterial||i.isRawShaderMaterial){const t=i.uniformsGroups;for(let e=0,n=t.length;e<n;e++){const n=t[e];vt.update(n,E),vt.bind(n,E)}}return E}(t,e,n,i,r);Q.setMaterial(i,a);let l=n.index,c=1;if(!0===i.wireframe){if(l=it.getWireframeAttribute(n),void 0===l)return;c=2}const u=n.drawRange,h=n.attributes.position;let d=u.start*c,f=(u.start+u.count)*c;null!==s&&(d=Math.max(d,s.start*c),f=Math.min(f,(s.start+s.count)*c)),null!==l?(d=Math.max(d,0),f=Math.min(f,l.count)):void 0!==h&&null!==h&&(d=Math.max(d,0),f=Math.min(f,h.count));const p=f-d;if(p<0||p===1/0)return;let m;gt.setup(r,i,o,n,l);let v=ft;if(null!==l&&(m=nt.get(l),v=pt,v.setIndex(m)),r.isMesh)!0===i.wireframe?(Q.setLineWidth(i.wireframeLinewidth*X()),v.setMode(yt.LINES)):v.setMode(yt.TRIANGLES);else if(r.isLine){let t=i.linewidth;void 0===t&&(t=1),Q.setLineWidth(t*X()),r.isLineSegments?v.setMode(yt.LINES):r.isLineLoop?v.setMode(yt.LINE_LOOP):v.setMode(yt.LINE_STRIP)}else r.isPoints?v.setMode(yt.POINTS):r.isSprite&&v.setMode(yt.TRIANGLES);if(r.isBatchedMesh)if(null!==r._multiDrawInstances)NS("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),v.renderMultiDrawInstances(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount,r._multiDrawInstances);else if(K.get("WEBGL_multi_draw"))v.renderMultiDraw(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount);else{const t=r._multiDrawStarts,e=r._multiDrawCounts,n=r._multiDrawCount,s=l?nt.get(l).bytesPerElement:1,a=J.get(i).currentProgram.getUniforms();for(let i=0;i<n;i++)a.setValue(yt,"_gl_DrawID",i),v.render(t[i]/s,e[i])}else if(r.isInstancedMesh)v.renderInstances(d,p,r.count);else if(n.isInstancedBufferGeometry){const t=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,e=Math.min(n.instanceCount,t);v.renderInstances(d,p,e)}else v.render(d,p)},this.compile=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===n&&(n=t),g=lt.get(n),g.init(e),y.push(g),n.traverseVisible(function(t){t.isLight&&t.layers.test(e.layers)&&(g.pushLight(t),t.castShadow&&g.pushShadow(t))}),t!==n&&t.traverseVisible(function(t){t.isLight&&t.layers.test(e.layers)&&(g.pushLight(t),t.castShadow&&g.pushShadow(t))}),g.setupLights();const i=new Set;return t.traverse(function(t){if(!(t.isMesh||t.isPoints||t.isLine||t.isSprite))return;const e=t.material;if(e)if(Array.isArray(e))for(let r=0;r<e.length;r++){const s=e[r];Mt(s,n,t),i.add(s)}else Mt(e,n,t),i.add(e)}),g=y.pop(),i},this.compileAsync=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.compile(t,e,n);return new Promise(e=>{function n(){i.forEach(function(t){J.get(t).currentProgram.isReady()&&i.delete(t)}),0!==i.size?setTimeout(n,10):e(t)}null!==K.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)})};let At=null;function Ct(){kt.stop()}function Rt(){kt.start()}const kt=new mC;function Lt(t,e,n,i){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)g.pushLight(t),t.castShadow&&g.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||B.intersectsSprite(t)){i&&j.setFromMatrixPosition(t.matrixWorld).applyMatrix4(V);const e=rt.update(t),r=t.material;r.visible&&m.push(t,e,r,n,j.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(!t.frustumCulled||B.intersectsObject(t))){const e=rt.update(t),r=t.material;if(i&&(void 0!==t.boundingSphere?(null===t.boundingSphere&&t.computeBoundingSphere(),j.copy(t.boundingSphere.center)):(null===e.boundingSphere&&e.computeBoundingSphere(),j.copy(e.boundingSphere.center)),j.applyMatrix4(t.matrixWorld).applyMatrix4(V)),Array.isArray(r)){const i=e.groups;for(let s=0,a=i.length;s<a;s++){const a=i[s],o=r[a.materialIndex];o&&o.visible&&m.push(t,e,o,n,j.z,a)}}else r.visible&&m.push(t,e,r,n,j.z,null)}const r=t.children;for(let s=0,a=r.length;s<a;s++)Lt(r[s],e,n,i)}function Dt(t,e,n,i){const r=t.opaque,s=t.transmissive,a=t.transparent;g.setupLightsView(n),!0===z&&ct.setGlobalState(_.clippingPlanes,n),i&&Q.viewport(M.copy(i)),r.length>0&&It(r,e,n),s.length>0&&It(s,e,n),a.length>0&&It(a,e,n),Q.buffers.depth.setTest(!0),Q.buffers.depth.setMask(!0),Q.buffers.color.setMask(!0),Q.setPolygonOffset(!1)}function Pt(t,e,n,i){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===g.state.transmissionRenderTarget[i.id]&&(g.state.transmissionRenderTarget[i.id]=new $S(1,1,{generateMipmaps:!0,type:K.has("EXT_color_buffer_half_float")||K.has("EXT_color_buffer_float")?tw:XE,minFilter:YE,samples:4,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:zS.workingColorSpace}));const s=g.state.transmissionRenderTarget[i.id],a=i.viewport||M;s.setSize(a.z*_.transmissionResolutionScale,a.w*_.transmissionResolutionScale);const o=_.getRenderTarget(),l=_.getActiveCubeFace(),c=_.getActiveMipmapLevel();_.setRenderTarget(s),_.getClearColor(R),k=_.getClearAlpha(),k<1&&_.setClearColor(16777215,.5),_.clear(),Y&&ht.render(n);const u=_.toneMapping;_.toneMapping=0;const h=i.viewport;if(void 0!==i.viewport&&(i.viewport=void 0),g.setupLightsView(i),!0===z&&ct.setGlobalState(_.clippingPlanes,i),It(t,n,i),$.updateMultisampleRenderTarget(s),$.updateRenderTargetMipmap(s),!1===K.has("WEBGL_multisampled_render_to_texture")){let t=!1;for(let r=0,s=e.length;r<s;r++){const s=e[r],a=s.object,o=s.geometry,l=s.material,c=s.group;if(2===l.side&&a.layers.test(i.layers)){const e=l.side;l.side=1,l.needsUpdate=!0,Ot(a,n,i,o,l,c),l.side=e,l.needsUpdate=!0,t=!0}}!0===t&&($.updateMultisampleRenderTarget(s),$.updateRenderTargetMipmap(s))}_.setRenderTarget(o,l,c),_.setClearColor(R,k),void 0!==h&&(i.viewport=h),_.toneMapping=u}function It(t,e,n){const i=!0===e.isScene?e.overrideMaterial:null;for(let r=0,s=t.length;r<s;r++){const s=t[r],a=s.object,o=s.geometry,l=s.group;let c=s.material;!0===c.allowOverride&&null!==i&&(c=i),a.layers.test(n.layers)&&Ot(a,e,n,o,c,l)}}function Ot(t,e,n,i,r,s){t.onBeforeRender(_,e,n,i,r,s),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),r.onBeforeRender(_,e,n,i,t,s),!0===r.transparent&&2===r.side&&!1===r.forceSinglePass?(r.side=1,r.needsUpdate=!0,_.renderBufferDirect(n,e,i,r,t,s),r.side=0,r.needsUpdate=!0,_.renderBufferDirect(n,e,i,r,t,s),r.side=2):_.renderBufferDirect(n,e,i,r,t,s),t.onAfterRender(_,e,n,i,r,s)}function Nt(t,e,n){!0!==e.isScene&&(e=W);const i=J.get(t),r=g.state.lights,s=g.state.shadowsArray,a=r.state.version,o=st.getParameters(t,r.state,s,e,n),l=st.getProgramCacheKey(o);let c=i.programs;i.environment=t.isMeshStandardMaterial?e.environment:null,i.fog=e.fog,i.envMap=(t.isMeshStandardMaterial?et:tt).get(t.envMap||i.environment),i.envMapRotation=null!==i.environment&&null===t.envMap?e.environmentRotation:t.envMapRotation,void 0===c&&(t.addEventListener("dispose",Tt),c=new Map,i.programs=c);let u=c.get(l);if(void 0!==u){if(i.currentProgram===u&&i.lightsStateVersion===a)return Ut(t,o),u}else o.uniforms=st.getUniforms(t),t.onBeforeCompile(o,_),u=st.acquireProgram(o,l),c.set(l,u),i.uniforms=o.uniforms;const h=i.uniforms;return(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(h.clippingPlanes=ct.uniform),Ut(t,o),i.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),i.lightsStateVersion=a,i.needsLights&&(h.ambientLightColor.value=r.state.ambient,h.lightProbe.value=r.state.probe,h.directionalLights.value=r.state.directional,h.directionalLightShadows.value=r.state.directionalShadow,h.spotLights.value=r.state.spot,h.spotLightShadows.value=r.state.spotShadow,h.rectAreaLights.value=r.state.rectArea,h.ltc_1.value=r.state.rectAreaLTC1,h.ltc_2.value=r.state.rectAreaLTC2,h.pointLights.value=r.state.point,h.pointLightShadows.value=r.state.pointShadow,h.hemisphereLights.value=r.state.hemi,h.directionalShadowMap.value=r.state.directionalShadowMap,h.directionalShadowMatrix.value=r.state.directionalShadowMatrix,h.spotShadowMap.value=r.state.spotShadowMap,h.spotLightMatrix.value=r.state.spotLightMatrix,h.spotLightMap.value=r.state.spotLightMap,h.pointShadowMap.value=r.state.pointShadowMap,h.pointShadowMatrix.value=r.state.pointShadowMatrix),i.currentProgram=u,i.uniformsList=null,u}function Ft(t){if(null===t.uniformsList){const e=t.currentProgram.getUniforms();t.uniformsList=ik.seqWithValue(e.seq,t.uniforms)}return t.uniformsList}function Ut(t,e){const n=J.get(t);n.outputColorSpace=e.outputColorSpace,n.batching=e.batching,n.batchingColor=e.batchingColor,n.instancing=e.instancing,n.instancingColor=e.instancingColor,n.instancingMorph=e.instancingMorph,n.skinning=e.skinning,n.morphTargets=e.morphTargets,n.morphNormals=e.morphNormals,n.morphColors=e.morphColors,n.morphTargetsCount=e.morphTargetsCount,n.numClippingPlanes=e.numClippingPlanes,n.numIntersection=e.numClipIntersection,n.vertexAlphas=e.vertexAlphas,n.vertexTangents=e.vertexTangents,n.toneMapping=e.toneMapping}kt.setAnimationLoop(function(t){At&&At(t)}),"undefined"!==typeof self&&kt.setContext(self),this.setAnimationLoop=function(t){At=t,xt.setAnimationLoop(t),null===t?kt.stop():kt.start()},xt.addEventListener("sessionstart",Ct),xt.addEventListener("sessionend",Rt),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===b)return;if(!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),null===e.parent&&!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),!0===xt.enabled&&!0===xt.isPresenting&&(!0===xt.cameraAutoUpdate&&xt.updateCamera(e),e=xt.getCamera()),!0===t.isScene&&t.onBeforeRender(_,t,e,w),g=lt.get(t,y.length),g.init(e),y.push(g),V.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),B.setFromProjectionMatrix(V,hS,e.reversedDepth),H=this.localClippingEnabled,z=ct.init(this.clippingPlanes,H),m=ot.get(t,v.length),m.init(),v.push(m),!0===xt.enabled&&!0===xt.isPresenting){const t=_.xr.getDepthSensingMesh();null!==t&&Lt(t,e,-1/0,_.sortObjects)}Lt(t,e,0,_.sortObjects),m.finish(),!0===_.sortObjects&&m.sort(I,O),Y=!1===xt.enabled||!1===xt.isPresenting||!1===xt.hasDepthSensing(),Y&&ht.addToRenderList(m,t),this.info.render.frame++,!0===z&&ct.beginShadows();const n=g.state.shadowsArray;ut.render(n,t,e),!0===z&&ct.endShadows(),!0===this.info.autoReset&&this.info.reset();const i=m.opaque,r=m.transmissive;if(g.setupLights(),e.isArrayCamera){const n=e.cameras;if(r.length>0)for(let e=0,s=n.length;e<s;e++){Pt(i,r,t,n[e])}Y&&ht.render(t);for(let e=0,i=n.length;e<i;e++){const i=n[e];Dt(m,t,i,i.viewport)}}else r.length>0&&Pt(i,r,t,e),Y&&ht.render(t),Dt(m,t,e);null!==w&&0===E&&($.updateMultisampleRenderTarget(w),$.updateRenderTargetMipmap(w)),!0===t.isScene&&t.onAfterRender(_,t,e),gt.resetDefaultState(),S=-1,T=null,y.pop(),y.length>0?(g=y[y.length-1],!0===z&&ct.setGlobalState(_.clippingPlanes,g.state.camera)):g=null,v.pop(),m=v.length>0?v[v.length-1]:null},this.getActiveCubeFace=function(){return x},this.getActiveMipmapLevel=function(){return E},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(t,e,n){const i=J.get(t);i.__autoAllocateDepthBuffer=!1===t.resolveDepthBuffer,!1===i.__autoAllocateDepthBuffer&&(i.__useRenderToTexture=!1),J.get(t.texture).__webglTexture=e,J.get(t.depthTexture).__webglTexture=i.__autoAllocateDepthBuffer?void 0:n,i.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(t,e){const n=J.get(t);n.__webglFramebuffer=e,n.__useDefaultFramebuffer=void 0===e};const Bt=yt.createFramebuffer();this.setRenderTarget=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;w=t,x=e,E=n;let i=!0,r=null,s=!1,a=!1;if(t){const o=J.get(t);if(void 0!==o.__useDefaultFramebuffer)Q.bindFramebuffer(yt.FRAMEBUFFER,null),i=!1;else if(void 0===o.__webglFramebuffer)$.setupRenderTarget(t);else if(o.__hasExternalTextures)$.rebindTextures(t,J.get(t.texture).__webglTexture,J.get(t.depthTexture).__webglTexture);else if(t.depthBuffer){const e=t.depthTexture;if(o.__boundDepthTexture!==e){if(null!==e&&J.has(e)&&(t.width!==e.image.width||t.height!==e.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");$.setupDepthRenderbuffer(t)}}const l=t.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(a=!0);const c=J.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=Array.isArray(c[e])?c[e][n]:c[e],s=!0):r=t.samples>0&&!1===$.useMultisampledRTT(t)?J.get(t).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,M.copy(t.viewport),A.copy(t.scissor),C=t.scissorTest}else M.copy(N).multiplyScalar(P).floor(),A.copy(F).multiplyScalar(P).floor(),C=U;0!==n&&(r=Bt);if(Q.bindFramebuffer(yt.FRAMEBUFFER,r)&&i&&Q.drawBuffers(t,r),Q.viewport(M),Q.scissor(A),Q.setScissorTest(C),s){const i=J.get(t.texture);yt.framebufferTexture2D(yt.FRAMEBUFFER,yt.COLOR_ATTACHMENT0,yt.TEXTURE_CUBE_MAP_POSITIVE_X+e,i.__webglTexture,n)}else if(a){const i=e;for(let e=0;e<t.textures.length;e++){const r=J.get(t.textures[e]);yt.framebufferTextureLayer(yt.FRAMEBUFFER,yt.COLOR_ATTACHMENT0+e,r.__webglTexture,n,i)}}else if(null!==t&&0!==n){const e=J.get(t.texture);yt.framebufferTexture2D(yt.FRAMEBUFFER,yt.COLOR_ATTACHMENT0,yt.TEXTURE_2D,e.__webglTexture,n)}S=-1},this.readRenderTargetPixels=function(t,e,n,i,r,s,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=J.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(l=l[a]),l){Q.bindFramebuffer(yt.FRAMEBUFFER,l);try{const a=t.textures[o],l=a.format,c=a.type;if(!q.textureFormatReadable(l))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!q.textureTypeReadable(c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");e>=0&&e<=t.width-i&&n>=0&&n<=t.height-r&&(t.textures.length>1&&yt.readBuffer(yt.COLOR_ATTACHMENT0+o),yt.readPixels(e,n,i,r,mt.convert(l),mt.convert(c),s))}finally{const t=null!==w?J.get(w).__webglFramebuffer:null;Q.bindFramebuffer(yt.FRAMEBUFFER,t)}}},this.readRenderTargetPixelsAsync=async function(t,e,n,i,r,s,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;if(!t||!t.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=J.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(l=l[a]),l){if(e>=0&&e<=t.width-i&&n>=0&&n<=t.height-r){Q.bindFramebuffer(yt.FRAMEBUFFER,l);const a=t.textures[o],c=a.format,u=a.type;if(!q.textureFormatReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!q.textureTypeReadable(u))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const h=yt.createBuffer();yt.bindBuffer(yt.PIXEL_PACK_BUFFER,h),yt.bufferData(yt.PIXEL_PACK_BUFFER,s.byteLength,yt.STREAM_READ),t.textures.length>1&&yt.readBuffer(yt.COLOR_ATTACHMENT0+o),yt.readPixels(e,n,i,r,mt.convert(c),mt.convert(u),0);const d=null!==w?J.get(w).__webglFramebuffer:null;Q.bindFramebuffer(yt.FRAMEBUFFER,d);const f=yt.fenceSync(yt.SYNC_GPU_COMMANDS_COMPLETE,0);return yt.flush(),await function(t,e,n){return new Promise(function(i,r){setTimeout(function s(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:r();break;case t.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:i()}},n)})}(yt,f,4),yt.bindBuffer(yt.PIXEL_PACK_BUFFER,h),yt.getBufferSubData(yt.PIXEL_PACK_BUFFER,0,s),yt.deleteBuffer(h),yt.deleteSync(f),s}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=Math.pow(2,-n),r=Math.floor(t.image.width*i),s=Math.floor(t.image.height*i),a=null!==e?e.x:0,o=null!==e?e.y:0;$.setTexture2D(t,0),yt.copyTexSubImage2D(yt.TEXTURE_2D,n,0,0,a,o,r,s),Q.unbindTexture()};const zt=yt.createFramebuffer(),Ht=yt.createFramebuffer();this.copyTextureToTexture=function(t,e){let n,i,r,s,a,o,l,c,u,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;null===p&&(0!==f?(NS("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),p=f,f=0):p=0);const m=t.isCompressedTexture?t.mipmaps[p]:t.image;if(null!==h)n=h.max.x-h.min.x,i=h.max.y-h.min.y,r=h.isBox3?h.max.z-h.min.z:1,s=h.min.x,a=h.min.y,o=h.isBox3?h.min.z:0;else{const e=Math.pow(2,-f);n=Math.floor(m.width*e),i=Math.floor(m.height*e),r=t.isDataArrayTexture?m.depth:t.isData3DTexture?Math.floor(m.depth*e):1,s=0,a=0,o=0}null!==d?(l=d.x,c=d.y,u=d.z):(l=0,c=0,u=0);const g=mt.convert(e.format),v=mt.convert(e.type);let y;e.isData3DTexture?($.setTexture3D(e,0),y=yt.TEXTURE_3D):e.isDataArrayTexture||e.isCompressedArrayTexture?($.setTexture2DArray(e,0),y=yt.TEXTURE_2D_ARRAY):($.setTexture2D(e,0),y=yt.TEXTURE_2D),yt.pixelStorei(yt.UNPACK_FLIP_Y_WEBGL,e.flipY),yt.pixelStorei(yt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),yt.pixelStorei(yt.UNPACK_ALIGNMENT,e.unpackAlignment);const _=yt.getParameter(yt.UNPACK_ROW_LENGTH),b=yt.getParameter(yt.UNPACK_IMAGE_HEIGHT),x=yt.getParameter(yt.UNPACK_SKIP_PIXELS),E=yt.getParameter(yt.UNPACK_SKIP_ROWS),w=yt.getParameter(yt.UNPACK_SKIP_IMAGES);yt.pixelStorei(yt.UNPACK_ROW_LENGTH,m.width),yt.pixelStorei(yt.UNPACK_IMAGE_HEIGHT,m.height),yt.pixelStorei(yt.UNPACK_SKIP_PIXELS,s),yt.pixelStorei(yt.UNPACK_SKIP_ROWS,a),yt.pixelStorei(yt.UNPACK_SKIP_IMAGES,o);const S=t.isDataArrayTexture||t.isData3DTexture,T=e.isDataArrayTexture||e.isData3DTexture;if(t.isDepthTexture){const h=J.get(t),d=J.get(e),m=J.get(h.__renderTarget),g=J.get(d.__renderTarget);Q.bindFramebuffer(yt.READ_FRAMEBUFFER,m.__webglFramebuffer),Q.bindFramebuffer(yt.DRAW_FRAMEBUFFER,g.__webglFramebuffer);for(let v=0;v<r;v++)S&&(yt.framebufferTextureLayer(yt.READ_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,J.get(t).__webglTexture,f,o+v),yt.framebufferTextureLayer(yt.DRAW_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,J.get(e).__webglTexture,p,u+v)),yt.blitFramebuffer(s,a,n,i,l,c,n,i,yt.DEPTH_BUFFER_BIT,yt.NEAREST);Q.bindFramebuffer(yt.READ_FRAMEBUFFER,null),Q.bindFramebuffer(yt.DRAW_FRAMEBUFFER,null)}else if(0!==f||t.isRenderTargetTexture||J.has(t)){const h=J.get(t),d=J.get(e);Q.bindFramebuffer(yt.READ_FRAMEBUFFER,zt),Q.bindFramebuffer(yt.DRAW_FRAMEBUFFER,Ht);for(let t=0;t<r;t++)S?yt.framebufferTextureLayer(yt.READ_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,h.__webglTexture,f,o+t):yt.framebufferTexture2D(yt.READ_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,yt.TEXTURE_2D,h.__webglTexture,f),T?yt.framebufferTextureLayer(yt.DRAW_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,d.__webglTexture,p,u+t):yt.framebufferTexture2D(yt.DRAW_FRAMEBUFFER,yt.COLOR_ATTACHMENT0,yt.TEXTURE_2D,d.__webglTexture,p),0!==f?yt.blitFramebuffer(s,a,n,i,l,c,n,i,yt.COLOR_BUFFER_BIT,yt.NEAREST):T?yt.copyTexSubImage3D(y,p,l,c,u+t,s,a,n,i):yt.copyTexSubImage2D(y,p,l,c,s,a,n,i);Q.bindFramebuffer(yt.READ_FRAMEBUFFER,null),Q.bindFramebuffer(yt.DRAW_FRAMEBUFFER,null)}else T?t.isDataTexture||t.isData3DTexture?yt.texSubImage3D(y,p,l,c,u,n,i,r,g,v,m.data):e.isCompressedArrayTexture?yt.compressedTexSubImage3D(y,p,l,c,u,n,i,r,g,m.data):yt.texSubImage3D(y,p,l,c,u,n,i,r,g,v,m):t.isDataTexture?yt.texSubImage2D(yt.TEXTURE_2D,p,l,c,n,i,g,v,m.data):t.isCompressedTexture?yt.compressedTexSubImage2D(yt.TEXTURE_2D,p,l,c,m.width,m.height,g,m.data):yt.texSubImage2D(yt.TEXTURE_2D,p,l,c,n,i,g,v,m);yt.pixelStorei(yt.UNPACK_ROW_LENGTH,_),yt.pixelStorei(yt.UNPACK_IMAGE_HEIGHT,b),yt.pixelStorei(yt.UNPACK_SKIP_PIXELS,x),yt.pixelStorei(yt.UNPACK_SKIP_ROWS,E),yt.pixelStorei(yt.UNPACK_SKIP_IMAGES,w),0===p&&e.generateMipmaps&&yt.generateMipmap(y),Q.unbindTexture()},this.copyTextureToTexture3D=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return NS('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(t,e,n,i,r)},this.initRenderTarget=function(t){void 0===J.get(t).__webglFramebuffer&&$.setupRenderTarget(t)},this.initTexture=function(t){t.isCubeTexture?$.setTextureCube(t,0):t.isData3DTexture?$.setTexture3D(t,0):t.isDataArrayTexture||t.isCompressedArrayTexture?$.setTexture2DArray(t,0):$.setTexture2D(t,0),Q.unbindTexture()},this.resetState=function(){x=0,E=0,w=null,Q.reset(),gt.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return hS}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t;const e=this.getContext();e.drawingBufferColorSpace=zS._getDrawingBufferColorSpace(t),e.unpackColorSpace=zS._getUnpackColorSpace()}}var Jk=Object.defineProperty,$k=(t,e)=>{for(var n in e)Jk(t,n,{get:e[n],enumerable:!0})},tL={};$k(tL,{ACTIONS:()=>hL,ANIMATION_MIN_DURATION:()=>nL,CAPTURE_EVENTS_CLASS:()=>uL,CTRLZOOM_TIMEOUT:()=>oL,DBLCLICK_DELAY:()=>rL,EASINGS:()=>mL,ICONS:()=>pL,IDS:()=>dL,KEY_CODES:()=>fL,LONGTOUCH_DELAY:()=>sL,MOVE_THRESHOLD:()=>iL,SPHERE_RADIUS:()=>lL,TWOFINGERSOVERLAY_DELAY:()=>aL,VIEWER_DATA:()=>cL});var eL,nL=500,iL=4,rL=300,sL=500,aL=100,oL=2e3,lL=10,cL="photoSphereViewer",uL="psv--capture-event",hL=(t=>(t.ROTATE_UP="ROTATE_UP",t.ROTATE_DOWN="ROTATE_DOWN",t.ROTATE_RIGHT="ROTATE_RIGHT",t.ROTATE_LEFT="ROTATE_LEFT",t.ZOOM_IN="ZOOM_IN",t.ZOOM_OUT="ZOOM_OUT",t))(hL||{}),dL={MENU:"menu",TWO_FINGERS:"twoFingers",CTRL_ZOOM:"ctrlZoom",ERROR:"error",DESCRIPTION:"description"},fL={Enter:"Enter",Control:"Control",Escape:"Escape",Space:" ",PageUp:"PageUp",PageDown:"PageDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Delete:"Delete",Plus:"+",Minus:"-"},pL={arrow:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="40 40 432 432"><g transform="rotate(0, 256, 256)"><path fill="currentColor" d="M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z"/></g>\x3c!-- Created by Flatart from the Noun Project --\x3e</svg>\n',close:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g fill="currentColor" transform=" translate(50, 50) rotate(45)"><rect x="-5" y="-65" width="10" height="130"/><rect x="-65" y="-5" width="130" height="10"/></g></svg>',download:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path fill="currentColor" d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/>\x3c!--Created by Michael Zenaty from the Noun Project--\x3e</svg>\n',fullscreenIn:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/>\x3c!--Created by Garrett Knoll from the Noun Project--\x3e</svg>\n',fullscreenOut:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/>\x3c!--Created by Garrett Knoll from the Noun Project--\x3e</svg>\n',info:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="currentColor" d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle fill="currentColor" cx="39.3" cy="9.2" r="8.2"/>\x3c!--Created by Arafat Uddin from the Noun Project--\x3e</svg>\n',menu:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 80 80"><g fill="currentColor"><circle r="10" cx="20" cy="20"/><circle r="10" cx="50" cy="20"/><circle r="10" cx="80" cy="20"/><circle r="10" cx="20" cy="50"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="80" cy="50"/><circle r="10" cx="20" cy="80"/><circle r="10" cx="50" cy="80"/><circle r="10" cx="80" cy="80"/></g>\x3c!-- Created by Richard Kun\xe1k from the Noun Project--\x3e</svg>\n',zoomIn:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/>\x3c!--Created by Ryan Canning from the Noun Project--\x3e</svg>\n',zoomOut:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M4.006 6.746h7.459V8.73H4.006z"/>\x3c!--Created by Ryan Canning from the Noun Project--\x3e</svg>\n'},mL={linear:t=>t,inQuad:t=>t*t,outQuad:t=>t*(2-t),inOutQuad:t=>t<.5?2*t*t:(4-2*t)*t-1,inCubic:t=>t*t*t,outCubic:t=>--t*t*t+1,inOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,inQuart:t=>t*t*t*t,outQuart:t=>1- --t*t*t*t,inOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,inQuint:t=>t*t*t*t*t,outQuint:t=>1+--t*t*t*t*t,inOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t,inSine:t=>1-Math.cos(t*(Math.PI/2)),outSine:t=>Math.sin(t*(Math.PI/2)),inOutSine:t=>.5-.5*Math.cos(Math.PI*t),inExpo:t=>Math.pow(2,10*(t-1)),outExpo:t=>1-Math.pow(2,-10*t),inOutExpo:t=>(t=2*t-1)<0?.5*Math.pow(2,10*t):1-.5*Math.pow(2,-10*t),inCirc:t=>1-Math.sqrt(1-t*t),outCirc:t=>Math.sqrt(1-(t-1)*(t-1)),inOutCirc:t=>(t*=2)<1?.5-.5*Math.sqrt(1-t*t):.5+.5*Math.sqrt(1-(t-=2)*t)},gL={};function vL(t,e){let n=t%e;return n<0&&(n+=e),n}function yL(t){return t.reduce((t,e)=>t+e,0)}function _L(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function bL(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function xL(t,e){return[0,2*Math.PI,2*-Math.PI].reduce((n,i)=>{const r=e-t+i;return Math.abs(r)<Math.abs(n)?r:n},1/0)}function EL(t,e){return Math.acos(Math.cos(t.pitch)*Math.cos(e.pitch)*Math.cos(t.yaw-e.yaw)+Math.sin(t.pitch)*Math.sin(e.pitch))}function wL(t,e){let[n,i]=t,[r,s]=e;n-r>Math.PI?n-=2*Math.PI:n-r<-Math.PI&&(n+=2*Math.PI);const a=(r-n)*Math.cos((i+s)/2),o=s-i;return Math.sqrt(a*a+o*o)}function SL(t){return"string"===typeof t?t.match(/^[a-z]/i)?document.getElementById(t):document.querySelector(t):t}function TL(t,e,n){void 0===n?t.classList.toggle(e):n?t.classList.add(e):n||t.classList.remove(e)}function ML(t,e){t.classList.add(...e.split(" ").filter(t=>!!t))}function AL(t,e){t.classList.remove(...e.split(" ").filter(t=>!!t))}function CL(t,e){let n=t;do{if(n===e)return!0;n=n.parentElement}while(n);return!1}function RL(t,e){if(null===t||void 0===t||!t.matches)return null;let n=t;do{if(n.matches(e))return n;n=n.parentElement}while(n);return null}function kL(t){return(null===t||void 0===t?void 0:t.composedPath()[0])||null}function LL(t,e){return t?t.composedPath().find(t=>(t instanceof HTMLElement||t instanceof SVGElement)&&t.matches(e)):null}function DL(t){let e=0,n=0,i=t;for(;i;)e+=i.offsetLeft-i.scrollLeft+i.clientLeft,n+=i.offsetTop-i.scrollTop+i.clientTop,i=i.offsetParent;return e-=window.scrollX,n-=window.scrollY,{x:e,y:n}}function PL(t,e){return window.getComputedStyle(t).getPropertyValue(e)}function IL(t){if(t.touches.length<2)return null;const e={x:t.touches[0].clientX,y:t.touches[0].clientY},n={x:t.touches[1].clientX,y:t.touches[1].clientY};return{distance:_L(e,n),angle:bL(e,n),center:{x:(e.x+n.x)/2,y:(e.y+n.y)/2}}}function OL(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?t===eL:document.fullscreenElement===t}function NL(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(eL=t,t.classList.add("psv-fullscreen-emulation"),document.dispatchEvent(new Event("fullscreenchange"))):t.requestFullscreen()}function FL(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(eL.classList.remove("psv-fullscreen-emulation"),eL=null,document.dispatchEvent(new Event("fullscreenchange"))):document.exitFullscreen()}function UL(t,e){let n,i=!1,r=!1,s=!1,a=!1;return"+"===e?n=e:e.split("+").forEach(t=>{switch(t){case"Shift":i=!0;break;case"Ctrl":r=!0;break;case"Alt":s=!0;break;case"Meta":a=!0;break;case"Plus":n="+";break;case"Minus":n="-";break;default:n=t}}),i===t.shiftKey&&r===t.ctrlKey&&s===t.altKey&&a===t.metaKey&&n===t.key}function BL(t){return t.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,(t,e)=>(e>0?"-":"")+t.toLowerCase())}function zL(t,e){let n=!1;return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];n||(n=!0,setTimeout(()=>{t.apply(this,r),n=!1},e))}}function HL(t){if("object"!==typeof t||null===t||"[object Object]"!==Object.prototype.toString.call(t))return!1;if(null===Object.getPrototypeOf(t))return!0;let e=t;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function VL(t,e){const n=e;return function t(e,i){return Array.isArray(i)?(e&&Array.isArray(e)?e.length=0:e=[],i.forEach((n,i)=>{e[i]=t(null,n)})):"object"===typeof i?(e&&!Array.isArray(e)||(e={}),Object.keys(i).forEach(r=>{"__proto__"!==r&&("object"===typeof i[r]&&i[r]&&HL(i[r])?i[r]!==n&&(e[r]?t(e[r],i[r]):e[r]=t(null,i[r])):e[r]=i[r])})):e=i,e}(t,e)}function GL(t){return VL(null,t)}function jL(t){return!t||0===Object.keys(t).length&&t.constructor===Object}function WL(t){return null===t||void 0===t}function YL(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)if(!WL(i))return i;return null}function XL(t,e){if(t===e)return!0;if(KL(t)&&KL(e)){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n of Object.keys(t))if(!XL(t[n],e[n]))return!1;return!0}return!1}function KL(t){return"object"===typeof t&&null!==t}$k(gL,{Animation:()=>ED,Dynamic:()=>wD,MultiDynamic:()=>SD,PressHandler:()=>TD,Slider:()=>AD,SliderDirection:()=>MD,addClasses:()=>ML,angle:()=>bL,applyEulerInverse:()=>gD,checkClosedShadowDom:()=>bD,checkStylesheet:()=>yD,checkVersion:()=>_D,cleanCssPosition:()=>cD,clone:()=>GL,createTexture:()=>pD,cssPositionIsOrdered:()=>uD,dasherize:()=>BL,deepEqual:()=>XL,deepmerge:()=>VL,distance:()=>_L,exitFullscreen:()=>FL,firstNonNull:()=>YL,getAbortError:()=>JL,getAngle:()=>EL,getClosest:()=>RL,getConfigParser:()=>vD,getElement:()=>SL,getEventTarget:()=>kL,getMatchingTarget:()=>LL,getPosition:()=>DL,getShortestArc:()=>xL,getStyleProperty:()=>PL,getTouchData:()=>IL,getXMPValue:()=>nD,greatArcDistance:()=>wL,hasParent:()=>CL,invertResolvableBoolean:()=>ZL,isAbortError:()=>$L,isEmpty:()=>jL,isExtendedPosition:()=>eD,isFullscreenEnabled:()=>OL,isNil:()=>WL,isPlainObject:()=>HL,keyPressMatch:()=>UL,logWarn:()=>tD,mergePanoData:()=>xD,parseAngle:()=>fD,parsePoint:()=>lD,parseSpeed:()=>hD,removeClasses:()=>AL,requestFullscreen:()=>NL,resolveBoolean:()=>QL,speedToDuration:()=>dD,sum:()=>yL,throttle:()=>zL,toggleClass:()=>TL,wrap:()=>vL});var qL=class t extends Error{constructor(e,n){var i;super(n&&n instanceof Error?"".concat(e,": ").concat(n.message):e),this.name="PSVError",null===(i=Error.captureStackTrace)||void 0===i||i.call(Error,this,t)}};function QL(t,e){HL(t)?(e(t.initial,!0),t.promise.then(t=>e(t,!1))):e(t,!0)}function ZL(t){return{initial:!t.initial,promise:t.promise.then(t=>!t)}}function JL(){const t=new Error("Loading was aborted.");return t.name="AbortError",t}function $L(t){return"AbortError"===(null===t||void 0===t?void 0:t.name)}function tD(t){console.warn("PhotoSphereViewer: ".concat(t))}function eD(t){return!(!t||Array.isArray(t))&&[["textureX","textureY"],["yaw","pitch"]].some(e=>{let[n,i]=e;return void 0!==t[n]&&void 0!==t[i]})}function nD(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.match("<GPano:"+e+">(.*)</GPano:"+e+">");if(null!==i){const t=n?parseInt(i[1],10):parseFloat(i[1]);return isNaN(t)?null:t}if(i=t.match("GPano:"+e+'="(.*?)"'),null!==i){const t=n?parseInt(i[1],10):parseFloat(i[1]);return isNaN(t)?null:t}return null}var iD={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},rD=["left","center","right"],sD=["top","center","bottom"],aD=[...rD,...sD],oD="center";function lD(t){if(!t)return{x:.5,y:.5};if("object"===typeof t)return t;let e=t.toLocaleLowerCase().split(" ").slice(0,2);1===e.length&&(e=iD[e[0]]?[e[0],oD]:[e[0],e[0]]);const n="left"!==e[1]&&"right"!==e[1]&&"top"!==e[0]&&"bottom"!==e[0];e=e.map(t=>iD[t]||t),n||e.reverse();const i=e.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return i?{x:parseFloat(i[1])/100,y:parseFloat(i[2])/100}:{x:.5,y:.5}}function cD(t){let{allowCenter:e,cssOrder:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{allowCenter:!0,cssOrder:!0};return t?("string"===typeof t&&(t=t.split(" ")),1===t.length&&(t[0]===oD?t=[oD,oD]:-1!==rD.indexOf(t[0])?t=[oD,t[0]]:-1!==sD.indexOf(t[0])&&(t=[t[0],oD])),2!==t.length||-1===aD.indexOf(t[0])||-1===aD.indexOf(t[1])?(tD("Unparsable position ".concat(t)),null):e||t[0]!==oD||t[1]!==oD?(n&&!uD(t)&&(t=[t[1],t[0]]),t[1]===oD&&-1!==rD.indexOf(t[0])&&(t=[oD,t[0]]),t[0]===oD&&-1!==sD.indexOf(t[1])&&(t=[t[1],oD]),t):(tD("Invalid position center center"),null)):null}function uD(t){return-1!==sD.indexOf(t[0])&&-1!==rD.indexOf(t[1])}function hD(t){let e;if("string"===typeof t){const n=t.toString().trim();let i=parseFloat(n.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));const r=n.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(r.match(/(pm|per minute)$/)&&(i/=60),r){case"dpm":case"degrees per minute":case"dps":case"degrees per second":e=SS.degToRad(i);break;case"rdpm":case"radians per minute":case"rdps":case"radians per second":e=i;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":e=i*Math.PI*2;break;default:throw new qL('Unknown speed unit "'.concat(r,'"'))}}else e=t;return e}function dD(t,e){if("number"!==typeof t){const n=hD(t);return e/Math.abs(n)*1e3}return Math.abs(t)}function fD(t){let e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;if("string"===typeof t){const n=t.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!n)throw new qL('Unknown angle "'.concat(t,'"'));const i=parseFloat(n[1]),r=n[2];if(r)switch(r){case"deg":case"degs":e=SS.degToRad(i);break;case"rad":case"rads":e=i;break;default:throw new qL('Unknown angle unit "'.concat(r,'"'))}else e=i}else{if("number"!==typeof t||isNaN(t))throw new qL('Unknown angle "'.concat(t,'"'));e=t}return e=vL(n?e+Math.PI:e,2*Math.PI),n?SS.clamp(e-Math.PI,-Math.PI/(i?2:1),Math.PI/(i?2:1)):e}function pD(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new QS(t);return n.needsUpdate=!0,n.minFilter=e?YE:jE,n.generateMipmaps=e,n.anisotropy=e?2:1,n}var mD=new MS;function gD(t,e){mD.setFromEuler(e).invert(),t.applyQuaternion(mD)}function vD(t,e){const n=function(n){const i=GL(Rr(Rr({},t),n)),r={};for(let[s,a]of Object.entries(i)){if(e&&s in e)a=e[s](a,{rawConfig:i,defValue:t[s]});else if(!(s in t)){tD("Unknown option ".concat(s));continue}r[s]=a}return r};return n.defaults=t,n.parsers=e||{},n}function yD(t,e){"true"!==PL(t,"--psv-".concat(e,"-loaded"))&&console.error('PhotoSphereViewer: stylesheet "@photo-sphere-viewer/'.concat(e,'/index.css" is not loaded'))}function _D(t,e,n){e&&e!==n&&console.error("PhotoSphereViewer: @photo-sphere-viewer/".concat(t," is in version ").concat(e," but @photo-sphere-viewer/core is in version ").concat(n))}function bD(t){do{if(t instanceof ShadowRoot&&"closed"===t.mode)return void console.error("PhotoSphereViewer: closed shadow DOM detected, the viewer might not work as expected");t=t.parentNode}while(t)}function xD(t,e,n,i){const r={isEquirectangular:!0,fullWidth:YL(null===n||void 0===n?void 0:n.fullWidth,null===i||void 0===i?void 0:i.fullWidth),fullHeight:YL(null===n||void 0===n?void 0:n.fullHeight,null===i||void 0===i?void 0:i.fullHeight),croppedWidth:t,croppedHeight:e,croppedX:YL(null===n||void 0===n?void 0:n.croppedX,null===i||void 0===i?void 0:i.croppedX),croppedY:YL(null===n||void 0===n?void 0:n.croppedY,null===i||void 0===i?void 0:i.croppedY),poseHeading:YL(null===n||void 0===n?void 0:n.poseHeading,null===i||void 0===i?void 0:i.poseHeading,0),posePitch:YL(null===n||void 0===n?void 0:n.posePitch,null===i||void 0===i?void 0:i.posePitch,0),poseRoll:YL(null===n||void 0===n?void 0:n.poseRoll,null===i||void 0===i?void 0:i.poseRoll,0),initialHeading:null===i||void 0===i?void 0:i.initialHeading,initialPitch:null===i||void 0===i?void 0:i.initialPitch,initialFov:null===i||void 0===i?void 0:i.initialFov};return r.fullWidth||r.fullHeight||(r.fullWidth=Math.max(t,2*e),r.fullHeight=Math.round(r.fullWidth/2)),r.fullWidth||(r.fullWidth=2*r.fullHeight),r.fullHeight||(r.fullHeight=Math.round(r.fullWidth/2)),null===r.croppedX&&(r.croppedX=Math.round((r.fullWidth-t)/2)),null===r.croppedY&&(r.croppedY=Math.round((r.fullHeight-e)/2)),Math.abs(r.fullWidth-2*r.fullHeight)>1&&(tD("Invalid panoData, fullWidth should be twice fullHeight"),r.fullHeight=Math.round(r.fullWidth/2)),r.croppedX+r.croppedWidth>r.fullWidth&&(tD("Invalid panoData, croppedX + croppedWidth > fullWidth"),r.croppedX=r.fullWidth-r.croppedWidth),r.croppedY+r.croppedHeight>r.fullHeight&&(tD("Invalid panoData, croppedY + croppedHeight > fullHeight"),r.croppedY=r.fullHeight-r.croppedHeight),r.croppedX<0&&(tD("Invalid panoData, croppedX < 0"),r.croppedX=0),r.croppedY<0&&(tD("Invalid panoData, croppedY < 0"),r.croppedY=0),r}var ED=class{constructor(t){this.easing=mL.linear,this.callbacks=[],this.resolved=!1,this.cancelled=!1,this.options=t,t?(t.easing&&(this.easing="function"===typeof t.easing?t.easing:mL[t.easing]||mL.linear),this.delayTimeout=setTimeout(()=>{this.delayTimeout=void 0,this.animationFrame=window.requestAnimationFrame(t=>this.__run(t))},t.delay||0)):this.resolved=!0}__run(t){if(this.cancelled)return;this.start||(this.start=t);const e=(t-this.start)/this.options.duration,n={};if(e<1){for(const[t,i]of Object.entries(this.options.properties))if(i){const r=i.start+(i.end-i.start)*this.easing(e);n[t]=r}this.options.onTick(n,e),this.animationFrame=window.requestAnimationFrame(t=>this.__run(t))}else{for(const[t,e]of Object.entries(this.options.properties))e&&(n[t]=e.end);this.options.onTick(n,1),this.__resolve(!0),this.animationFrame=void 0}}__resolve(t){t?this.resolved=!0:this.cancelled=!0,this.callbacks.forEach(e=>e(t)),this.callbacks.length=0}then(t){return this.resolved||this.cancelled?Promise.resolve(this.resolved).then(t):new Promise(t=>{this.callbacks.push(t)}).then(t)}cancel(){this.cancelled||this.resolved||(this.__resolve(!1),this.delayTimeout&&(window.clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0))}},wD=class{constructor(t,e){if(this.fn=t,this.mode=0,this.speed=0,this.speedMult=0,this.currentSpeed=0,this.target=0,this.__current=0,this.min=e.min,this.max=e.max,this.wrap=e.wrap,this.current=e.defaultValue,this.wrap&&0!==this.min)throw new qL("invalid config");this.fn&&this.fn(this.current)}get current(){return this.__current}set current(t){this.__current=t}setSpeed(t){this.speed=t}goto(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.mode=2,this.target=this.wrap?vL(t,this.max):SS.clamp(t,this.min,this.max),this.speedMult=e}step(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;0===e?this.setValue(this.current+t):(2!==this.mode&&(this.target=this.current),this.goto(this.target+t,e))}roll(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.mode=1,this.target=t?-1/0:1/0,this.speedMult=e}stop(){this.mode=0}setValue(t){return this.target=this.wrap?vL(t,this.max):SS.clamp(t,this.min,this.max),this.mode=0,this.currentSpeed=0,this.target!==this.current&&(this.current=this.target,this.fn&&this.fn(this.current),!0)}update(t){if(2===this.mode){this.wrap&&Math.abs(this.target-this.current)>this.max/2&&(this.current=this.current<this.target?this.current+this.max:this.current-this.max);const t=this.currentSpeed*this.currentSpeed/(this.speed*this.speedMult*4);Math.abs(this.target-this.current)<=t&&(this.mode=0)}let e=0===this.mode?0:this.speed*this.speedMult;this.target<this.current&&(e=-e),this.currentSpeed<e?this.currentSpeed=Math.min(e,this.currentSpeed+t/1e3*this.speed*this.speedMult*2):this.currentSpeed>e&&(this.currentSpeed=Math.max(e,this.currentSpeed-t/1e3*this.speed*this.speedMult*2));let n=null;return this.current>this.target&&this.currentSpeed?n=Math.max(this.target,this.current+this.currentSpeed*t/1e3):this.current<this.target&&this.currentSpeed&&(n=Math.min(this.target,this.current+this.currentSpeed*t/1e3)),null!==n&&(n=this.wrap?vL(n,this.max):SS.clamp(n,this.min,this.max),n!==this.current)&&(this.current=n,this.fn&&this.fn(this.current),!0)}},SD=class{constructor(t,e){this.fn=t,this.dynamics=e,this.fn&&this.fn(this.current)}get current(){return Object.entries(this.dynamics).reduce((t,e)=>{let[n,i]=e;return t[n]=i.current,t},{})}setSpeed(t){for(const e of Object.values(this.dynamics))e.setSpeed(t)}goto(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;for(const[n,i]of Object.entries(t))this.dynamics[n].goto(i,e)}step(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(0===e)this.setValue(Object.keys(t).reduce((e,n)=>(e[n]=t[n]+this.dynamics[n].current,e),{}));else for(const[n,i]of Object.entries(t))this.dynamics[n].step(i,e)}roll(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;for(const[n,i]of Object.entries(t))this.dynamics[n].roll(i,e)}stop(){for(const t of Object.values(this.dynamics))t.stop()}setValue(t){let e=!1;for(const[n,i]of Object.entries(t))e=this.dynamics[n].setValue(i)||e;return e&&this.fn&&this.fn(this.current),e}update(t){let e=!1;for(const n of Object.values(this.dynamics))e=n.update(t)||e;return e&&this.fn&&this.fn(this.current),e}},TD=class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200;this.delay=t,this.time=0,this.delay=t}get pending(){return 0!==this.time}down(t){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.time=(new Date).getTime(),this.data=t}up(t){if(!this.time)return;Date.now()-this.time<this.delay?this.timeout=setTimeout(()=>{t(this.data),this.timeout=void 0,this.time=0,this.data=void 0},this.delay):(t(this.data),this.time=0,this.data=void 0)}},MD=(t=>(t.VERTICAL="VERTICAL",t.HORIZONTAL="HORIZONTAL",t))(MD||{}),AD=class{constructor(t,e,n){this.container=t,this.direction=e,this.listener=n,this.mousedown=!1,this.mouseover=!1,this.container.addEventListener("click",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("touchmove",this,!0),window.addEventListener("mouseup",this),window.addEventListener("touchend",this)}get isVertical(){return"VERTICAL"===this.direction}get isHorizontal(){return"HORIZONTAL"===this.direction}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this)}handleEvent(t){switch(t.type){case"click":t.stopPropagation();break;case"mousedown":this.__onMouseDown(t);break;case"mouseenter":this.__onMouseEnter(t);break;case"mouseleave":this.__onMouseLeave(t);break;case"touchstart":this.__onTouchStart(t);break;case"mousemove":this.__onMouseMove(t);break;case"touchmove":this.__onTouchMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchend":this.__onTouchEnd(t)}}__onMouseDown(t){this.mousedown=!0,this.__update(t.clientX,t.clientY,!0)}__onMouseEnter(t){this.mouseover=!0,this.__update(t.clientX,t.clientY,!0)}__onTouchStart(t){this.mouseover=!0,this.mousedown=!0;const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}__onMouseMove(t){(this.mousedown||this.mouseover)&&(t.stopPropagation(),this.__update(t.clientX,t.clientY,!0))}__onTouchMove(t){if(this.mousedown||this.mouseover){t.stopPropagation();const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}}__onMouseUp(t){this.mousedown&&(this.mousedown=!1,this.__update(t.clientX,t.clientY,!1))}__onMouseLeave(t){this.mouseover&&(this.mouseover=!1,this.__update(t.clientX,t.clientY,!0))}__onTouchEnd(t){if(this.mousedown){this.mouseover=!1,this.mousedown=!1;const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!1)}}__update(t,e,n){const i=this.container.getBoundingClientRect();let r;r=this.isVertical?SS.clamp((i.bottom-e)/i.height,0,1):SS.clamp((t-i.left)/i.width,0,1),this.listener({value:r,click:!n,mousedown:this.mousedown,mouseover:this.mouseover,cursor:{clientX:t,clientY:e}})}},CD={};$k(CD,{BeforeAnimateEvent:()=>PD,BeforeRenderEvent:()=>OD,BeforeRotateEvent:()=>FD,ClickEvent:()=>BD,ConfigChangedEvent:()=>HD,DoubleClickEvent:()=>GD,FullscreenEvent:()=>WD,HideNotificationEvent:()=>XD,HideOverlayEvent:()=>qD,HidePanelEvent:()=>ZD,HideTooltipEvent:()=>$D,KeypressEvent:()=>eP,LoadProgressEvent:()=>iP,ObjectEnterEvent:()=>NP,ObjectEvent:()=>IP,ObjectHoverEvent:()=>zP,ObjectLeaveEvent:()=>UP,PanoramaErrorEvent:()=>cP,PanoramaLoadEvent:()=>sP,PanoramaLoadedEvent:()=>oP,PositionUpdatedEvent:()=>fP,ReadyEvent:()=>vP,RenderEvent:()=>_P,RollUpdatedEvent:()=>mP,ShowNotificationEvent:()=>xP,ShowOverlayEvent:()=>wP,ShowPanelEvent:()=>TP,ShowTooltipEvent:()=>AP,SizeUpdatedEvent:()=>RP,StopAllEvent:()=>LP,TransitionDoneEvent:()=>hP,ViewerEvent:()=>LD,ZoomUpdatedEvent:()=>PP});var RD=class extends Event{constructor(t){super(t,{cancelable:arguments.length>1&&void 0!==arguments[1]&&arguments[1]})}},kD=class extends EventTarget{dispatchEvent(t){return super.dispatchEvent(t)}addEventListener(t,e,n){super.addEventListener(t,e,n)}removeEventListener(t,e,n){super.removeEventListener(t,e,n)}},LD=class extends RD{},DD=class t extends LD{constructor(e,n){super(t.type,!0),this.position=e,this.zoomLevel=n}};DD.type="before-animate";var PD=DD,ID=class t extends LD{constructor(e,n){super(t.type),this.timestamp=e,this.elapsed=n}};ID.type="before-render";var OD=ID,ND=class t extends LD{constructor(e){super(t.type,!0),this.position=e}};ND.type="before-rotate";var FD=ND,UD=class t extends LD{constructor(e){super(t.type),this.data=e}};UD.type="click";var BD=UD,zD=class t extends LD{constructor(e){super(t.type),this.options=e}containsOptions(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.some(t=>this.options.includes(t))}};zD.type="config-changed";var HD=zD,VD=class t extends LD{constructor(e){super(t.type),this.data=e}};VD.type="dblclick";var GD=VD,jD=class t extends LD{constructor(e){super(t.type),this.fullscreenEnabled=e}};jD.type="fullscreen";var WD=jD,YD=class t extends LD{constructor(e){super(t.type),this.notificationId=e}};YD.type="hide-notification";var XD=YD,KD=class t extends LD{constructor(e){super(t.type),this.overlayId=e}};KD.type="hide-overlay";var qD=KD,QD=class t extends LD{constructor(e){super(t.type),this.panelId=e}};QD.type="hide-panel";var ZD=QD,JD=class t extends LD{constructor(e){super(t.type),this.tooltipData=e}};JD.type="hide-tooltip";var $D=JD,tP=class t extends LD{constructor(e,n){super(t.type,!0),this.key=e,this.originalEvent=n}matches(t){return UL(this.originalEvent,t)}};tP.type="key-press";var eP=tP,nP=class t extends LD{constructor(e){super(t.type),this.progress=e}};nP.type="load-progress";var iP=nP,rP=class t extends LD{constructor(e){super(t.type),this.panorama=e}};rP.type="panorama-load";var sP=rP,aP=class t extends LD{constructor(e){super(t.type),this.data=e}};aP.type="panorama-loaded";var oP=aP,lP=class t extends LD{constructor(e,n){super(t.type),this.panorama=e,this.error=n}};lP.type="panorama-error";var cP=lP,uP=class t extends LD{constructor(e){super(t.type),this.completed=e}};uP.type="transition-done";var hP=uP,dP=class t extends LD{constructor(e){super(t.type),this.position=e}};dP.type="position-updated";var fP=dP,pP=class t extends LD{constructor(e){super(t.type),this.roll=e}};pP.type="roll-updated";var mP=pP,gP=class t extends LD{constructor(){super(t.type)}};gP.type="ready";var vP=gP,yP=class t extends LD{constructor(){super(t.type)}};yP.type="render";var _P=yP,bP=class t extends LD{constructor(e){super(t.type),this.notificationId=e}};bP.type="show-notification";var xP=bP,EP=class t extends LD{constructor(e){super(t.type),this.overlayId=e}};EP.type="show-overlay";var wP=EP,SP=class t extends LD{constructor(e){super(t.type),this.panelId=e}};SP.type="show-panel";var TP=SP,MP=class t extends LD{constructor(e,n){super(t.type),this.tooltip=e,this.tooltipData=n}};MP.type="show-tooltip";var AP=MP,CP=class t extends LD{constructor(e){super(t.type),this.size=e}};CP.type="size-updated";var RP=CP,kP=class t extends LD{constructor(){super(t.type)}};kP.type="stop-all";var LP=kP,DP=class t extends LD{constructor(e){super(t.type),this.zoomLevel=e}};DP.type="zoom-updated";var PP=DP,IP=class extends LD{constructor(t,e,n,i,r){super(t),this.originalEvent=e,this.object=n,this.viewerPoint=i,this.userDataKey=r}},OP=class t extends IP{constructor(e,n,i,r){super(t.type,e,n,i,r)}};OP.type="enter-object";var NP=OP,FP=class t extends IP{constructor(e,n,i,r){super(t.type,e,n,i,r)}};FP.type="leave-object";var UP=FP,BP=class t extends IP{constructor(e,n,i,r){super(t.type,e,n,i,r)}};BP.type="hover-object";var zP=BP,HP=class{constructor(t){this.viewer=t}init(){}destroy(){}supportsTransition(t){return!1}supportsPreload(t){return!1}textureCoordsToSphericalCoords(t,e){throw new qL("Current adapter does not support texture coordinates.")}sphericalCoordsToTextureCoords(t,e){throw new qL("Current adapter does not support texture coordinates.")}};function VP(t){if(t)for(const[,e]of[["_",t],...Object.entries(t)])if(e.prototype instanceof HP)return _D(e.id,e.VERSION,"5.14.0"),e;return null}HP.supportsDownload=!1;var GP="".concat(cL,"_touchSupport"),jP={loaded:!1,pixelRatio:1,isWebGLSupported:!1,maxTextureWidth:0,isTouchEnabled:null,__maxCanvasWidth:null,isIphone:!1,get maxCanvasWidth(){return null===this.__maxCanvasWidth&&(this.__maxCanvasWidth=function(t){let e=t,n=!1;const i=document.createElement("canvas"),r=i.getContext("2d");i.width=1,i.height=1;for(;e>1024&&!n;){const t=document.createElement("canvas"),i=t.getContext("2d");t.width=e,t.height=e/2;try{i.fillStyle="white",i.fillRect(e-1,e/2-1,1,1),r.drawImage(t,e-1,e/2-1,1,1,0,0,1,1),r.getImageData(0,0,1,1).data[0]>0&&(n=!0)}catch(s){}t.width=0,t.height=0,n||(e/=2)}if(n)return e;throw new qL("Unable to detect system capabilities")}(this.maxTextureWidth)),this.__maxCanvasWidth},load(){if(!this.loaded){const t=function(){try{return document.createElement("canvas").getContext("webgl2")}catch(t){return null}}();this.pixelRatio=window.devicePixelRatio||1,this.isWebGLSupported=!!t,this.maxTextureWidth=t?t.getParameter(t.MAX_TEXTURE_SIZE):0,this.isTouchEnabled=function(){let t="ontouchstart"in window||navigator.maxTouchPoints>0;GP in localStorage&&(t="true"===localStorage[GP]);const e=new Promise(e=>{const n=()=>{window.removeEventListener("mousedown",i),window.removeEventListener("touchstart",r),clearTimeout(a)},i=()=>{n(),localStorage[GP]=!1,e(!1)},r=()=>{n(),localStorage[GP]=!0,e(!0)},s=()=>{n(),localStorage[GP]=t,e(t)};window.addEventListener("mousedown",i,!1),window.addEventListener("touchstart",r,!1);const a=setTimeout(s,1e4)});return{initial:t,promise:e}}(),this.isIphone=/iPhone/i.test(navigator.userAgent),this.loaded=!0}if(!jP.isWebGLSupported)throw new qL("WebGL 2 is not supported.");if(0===jP.maxTextureWidth)throw new qL("Unable to detect system capabilities")}};var WP=vD({resolution:64,useXmpData:!0,blur:!1},{resolution:t=>{if(!t||!SS.isPowerOfTwo(t))throw new qL("EquirectangularAdapter resolution must be power of two.");return t}}),YP=class t extends HP{static withConfig(e){return[t,e]}constructor(t,e){super(t),this.config=WP(e),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2}supportsTransition(){return!0}supportsPreload(){return!0}textureCoordsToSphericalCoords(t,e){if(WL(t.textureX)||WL(t.textureY))throw new qL("Texture position is missing 'textureX' or 'textureY'");const n=(t.textureX+e.croppedX)/e.fullWidth*Math.PI*2,i=(t.textureY+e.croppedY)/e.fullHeight*Math.PI;return{yaw:n>=Math.PI?n-Math.PI:n+Math.PI,pitch:Math.PI/2-i}}sphericalCoordsToTextureCoords(t,e){const n=t.yaw/Math.PI/2*e.fullWidth,i=t.pitch/Math.PI*e.fullHeight;let r=Math.round(t.yaw<Math.PI?n+e.fullWidth/2:n-e.fullWidth/2)-e.croppedX,s=Math.round(e.fullHeight/2-i)-e.croppedY;return(r<0||r>e.croppedWidth||s<0||s>e.croppedHeight)&&(r=s=void 0),{textureX:r,textureY:s}}async loadTexture(t){let e,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.config.useXmpData;if("string"!==typeof t&&("object"!==typeof t||!t.path))return Promise.reject(new qL("Invalid panorama url, are you using the right adapter?"));e="string"===typeof t?{path:t,data:i}:Rr({data:i},t);const s=await this.viewer.textureLoader.loadFile(e.path,n?t=>this.viewer.textureLoader.dispatchProgress(t):null,e.path),a=r?await this.loadXMP(s):null,o=await this.viewer.textureLoader.blobToImage(s);"function"===typeof e.data&&(e.data=e.data(o,a));const l=xD(o.width,o.height,e.data,a);return{panorama:t,texture:this.createEquirectangularTexture(o),panoData:l,cacheKey:e.path}}async loadXMP(t){const e=await this.loadBlobAsString(t),n=e.indexOf("<x:xmpmeta");if(-1===n)return null;const i=e.indexOf("</x:xmpmeta>",n);if(-1===i)return null;const r=e.substring(n,i);return r.includes("GPano:")?{fullWidth:nD(r,"FullPanoWidthPixels"),fullHeight:nD(r,"FullPanoHeightPixels"),croppedWidth:nD(r,"CroppedAreaImageWidthPixels"),croppedHeight:nD(r,"CroppedAreaImageHeightPixels"),croppedX:nD(r,"CroppedAreaLeftPixels"),croppedY:nD(r,"CroppedAreaTopPixels"),poseHeading:nD(r,"PoseHeadingDegrees",!1),posePitch:nD(r,"PosePitchDegrees",!1),poseRoll:nD(r,"PoseRollDegrees",!1),initialHeading:nD(r,"InitialViewHeadingDegrees",!1),initialPitch:nD(r,"InitialViewPitchDegrees",!1),initialFov:nD(r,"InitialHorizontalFOVDegrees",!1)}:null}loadBlobAsString(t){return new Promise((e,n)=>{const i=new FileReader;i.onload=()=>e(i.result),i.onerror=n,i.readAsText(t)})}createEquirectangularTexture(t){if(this.config.blur||t.width>jP.maxTextureWidth){const e=Math.min(1,jP.maxCanvasWidth/t.width),n=new OffscreenCanvas(Math.floor(t.width*e),Math.floor(t.height*e)),i=n.getContext("2d");return this.config.blur&&(i.filter="blur(".concat(n.width/2048,"px)")),i.drawImage(t,0,0,n.width,n.height),pD(n)}return pD(t)}createMesh(t){const e=t.croppedX/t.fullWidth*2*Math.PI,n=t.croppedWidth/t.fullWidth*2*Math.PI,i=t.croppedY/t.fullHeight*Math.PI,r=t.croppedHeight/t.fullHeight*Math.PI,s=new RA(lL,Math.round(this.SPHERE_SEGMENTS/(2*Math.PI)*n),Math.round(this.SPHERE_HORIZONTAL_SEGMENTS/Math.PI*r),-Math.PI/2+e,n,i,r).scale(-1,1,1),a=new TM({depthTest:!1,depthWrite:!1});return new JM(s,a)}setTexture(t,e){t.material.map=e.texture}setTextureOpacity(t,e){t.material.opacity=e,t.material.transparent=e<1}disposeTexture(t){let{texture:e}=t;e.dispose()}disposeMesh(t){t.geometry.dispose(),t.material.dispose()}};YP.id="equirectangular",YP.VERSION="5.14.0",YP.supportsDownload=!0;var XP=YP,KP=class t extends XP{static withConfig(e){return[t,e]}constructor(t,e){var n;super(t,{resolution:null!==(n=null===e||void 0===e?void 0:e.resolution)&&void 0!==n?n:64,useXmpData:!1})}async loadTexture(t,e){const n=await super.loadTexture(t,e,null,!1);return n.panoData=null,n}createMesh(){const t=new RA(lL,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS).scale(-1,1,1).toNonIndexed(),e=t.getAttribute("uv"),n=t.getAttribute("normal");for(let r=0;r<e.count;r++)for(let t=0;t<3;t++){const i=3*r+t,s=n.getX(i),a=n.getY(i),o=n.getZ(i),l=.947;if(r<e.count/6){const t=0===s&&0===o?1:Math.acos(a)/Math.sqrt(s*s+o*o)*(2/Math.PI);e.setXY(i,s*(l/4)*t+1/4,o*(l/2)*t+.5)}else{const t=0===s&&0===o?1:Math.acos(-a)/Math.sqrt(s*s+o*o)*(2/Math.PI);e.setXY(i,l/4*-s*t+3/4,o*(l/2)*t+.5)}}t.rotateX(-Math.PI/2),t.rotateY(Math.PI);const i=new TM({depthTest:!1,depthWrite:!1});return new JM(t,i)}};KP.id="dual-fisheye",KP.VERSION="5.14.0";var qP=class t{constructor(e,n){var i;this.parent=e,this.children=[],this.state={visible:!0},this.viewer=e instanceof t?e.viewer:e,this.container=document.createElement(null!==(i=n.tagName)&&void 0!==i?i:"div"),this.container.className=n.className||"",this.parent.children.push(this),this.parent.container.appendChild(this.container)}destroy(){this.parent.container.removeChild(this.container);const t=this.parent.children.indexOf(this);-1!==t&&this.parent.children.splice(t,1),this.children.slice().forEach(t=>t.destroy()),this.children.length=0}toggle(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.isVisible())?this.show():this.hide()}hide(t){this.container.style.display="none",this.state.visible=!1}show(t){this.container.style.display="",this.state.visible=!0}isVisible(){return this.state.visible}},QP=vD({id:null,tagName:null,className:null,title:null,hoverScale:!1,collapsable:!1,tabbable:!0,icon:null,iconActive:null}),ZP=class extends qP{constructor(t,e){var n;(super(t,{tagName:e.tagName,className:"psv-button ".concat(e.hoverScale?"psv-button--hover-scale":""," ").concat(e.className||"")}),this.state={visible:!0,enabled:!0,supported:!0,collapsed:!1,active:!1,width:0},this.config=QP(e),e.id||(this.config.id=this.constructor.id),e.icon&&this.__setIcon(e.icon),this.state.width=this.container.offsetWidth,this.config.title)?this.container.title=null!==(n=this.viewer.config.lang[this.config.title])&&void 0!==n?n:this.config.title:this.id&&this.id in this.viewer.config.lang&&(this.container.title=this.viewer.config.lang[this.id]);e.tabbable&&(this.container.tabIndex=0),this.container.addEventListener("click",t=>{this.state.enabled&&this.onClick(),t.stopPropagation()}),this.container.addEventListener("keydown",t=>{t.key===fL.Enter&&this.state.enabled&&(this.onClick(),t.stopPropagation())})}get id(){return this.config.id}get title(){return this.container.title}get content(){return this.container.innerHTML}get width(){return this.state.width}get collapsable(){return this.config.collapsable}show(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isVisible()||(this.state.visible=!0,this.state.collapsed||(this.container.style.display=""),t&&this.viewer.navbar.autoSize())}hide(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isVisible()&&(this.state.visible=!1,this.container.style.display="none",t&&this.viewer.navbar.autoSize())}checkSupported(){QL(this.isSupported(),(t,e)=>{this.state&&(this.state.supported=t,e?t||this.hide():this.toggle(t))})}autoSize(){}isSupported(){return!0}toggleActive(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.state.active;t!==this.state.active&&(this.state.active=t,TL(this.container,"psv-button--active",this.state.active),this.config.iconActive&&this.__setIcon(this.state.active?this.config.iconActive:this.config.icon))}disable(){this.container.classList.add("psv-button--disabled"),this.state.enabled=!1}enable(){this.container.classList.remove("psv-button--disabled"),this.state.enabled=!0}collapse(){this.state.collapsed=!0,this.container.style.display="none"}uncollapse(){this.state.collapsed=!1,this.state.visible&&(this.container.style.display="")}__setIcon(t){this.container.innerHTML=t,ML(this.container.querySelector("svg"),"psv-button-svg")}},JP=class extends ZP{constructor(t,e){var n,i,r;(super(t,{id:null!==(n=e.id)&&void 0!==n?n:"psvButton-".concat(Math.random().toString(36).substring(2)),className:"psv-custom-button ".concat(e.className||""),hoverScale:!1,collapsable:!1!==e.collapsable,tabbable:!1!==e.tabbable,title:e.title}),this.customOnClick=e.onClick,e.content)&&("string"===typeof e.content?this.container.innerHTML=e.content:(this.container.classList.add("psv-custom-button--no-padding"),e.content.style.height="100%",null===(i=(r=e.content).attachViewer)||void 0===i||i.call(r,this.viewer),this.container.appendChild(e.content)));this.state.width=this.container.offsetWidth,e.disabled&&this.disable(),!1===e.visible&&this.hide()}onClick(){var t;null===(t=this.customOnClick)||void 0===t||t.call(this,this.viewer)}},$P=class extends ZP{constructor(t){super(t,{className:"psv-description-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:pL.info}),this.mode=0,this.viewer.addEventListener(XD.type,this),this.viewer.addEventListener(xP.type,this),this.viewer.addEventListener(ZD.type,this),this.viewer.addEventListener(TP.type,this),this.viewer.addEventListener(HD.type,this)}destroy(){this.viewer.removeEventListener(XD.type,this),this.viewer.removeEventListener(xP.type,this),this.viewer.removeEventListener(ZD.type,this),this.viewer.removeEventListener(TP.type,this),this.viewer.removeEventListener(HD.type,this),super.destroy()}handleEvent(t){if(t instanceof HD)return void(t.containsOptions("description")&&this.autoSize(!0));if(!this.mode)return;let e=!1;t instanceof XD?e=1===this.mode:t instanceof xP?e=1===this.mode&&t.notificationId!==dL.DESCRIPTION:t instanceof ZD?e=2===this.mode:t instanceof TP&&(e=2===this.mode&&t.panelId!==dL.DESCRIPTION),e&&(this.toggleActive(!1),this.mode=0)}onClick(){this.mode?this.__close():this.__open()}hide(t){super.hide(t),this.mode&&this.__close()}autoSize(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]){const t=this.viewer.navbar.getButton("caption",!1),e=t&&!t.isVisible(),n=!!this.viewer.config.description;e||n?this.show(!1):this.hide(!1)}}__close(){switch(this.mode){case 1:this.viewer.notification.hide(dL.DESCRIPTION);break;case 2:this.viewer.panel.hide(dL.DESCRIPTION)}}__open(){this.toggleActive(!0),this.viewer.config.description?(this.mode=2,this.viewer.panel.show({id:dL.DESCRIPTION,content:"".concat(this.viewer.config.caption?"<p>".concat(this.viewer.config.caption,"</p>"):"").concat(this.viewer.config.description)})):(this.mode=1,this.viewer.notification.show({id:dL.DESCRIPTION,content:this.viewer.config.caption}))}};$P.id="description";var tI=class extends ZP{constructor(t){super(t,{tagName:"a",className:"psv-download-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:pL.download}),this.viewer.addEventListener(HD.type,this),this.viewer.addEventListener(oP.type,this)}destroy(){this.viewer.removeEventListener(HD.type,this),this.viewer.removeEventListener(oP.type,this),super.destroy()}handleEvent(t){t instanceof HD?(t.containsOptions("downloadUrl")&&this.checkSupported(),t.containsOptions("downloadUrl","downloadName")&&this.__update()):t instanceof oP&&this.__update()}onClick(){}checkSupported(){this.viewer.adapter.constructor.supportsDownload||this.viewer.config.downloadUrl?this.show():this.hide()}__update(){const t=this.container;t.href=this.viewer.config.downloadUrl||this.viewer.config.panorama,t.target="_blank",t.href.startsWith("data:")&&!this.viewer.config.downloadName?t.download="panorama."+t.href.substring(0,t.href.indexOf(";")).split("/").pop():t.download=this.viewer.config.downloadName||t.href.split("/").pop()}};tI.id="download";var eI=class extends ZP{constructor(t){super(t,{className:"psv-fullscreen-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:pL.fullscreenIn,iconActive:pL.fullscreenOut}),this.viewer.addEventListener(WD.type,this)}destroy(){this.viewer.removeEventListener(WD.type,this),super.destroy()}handleEvent(t){t instanceof WD&&this.toggleActive(t.fullscreenEnabled)}onClick(){this.viewer.toggleFullscreen()}};eI.id="fullscreen";var nI=class extends ZP{constructor(t){super(t,{className:"psv-menu-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:pL.menu}),this.viewer.addEventListener(TP.type,this),this.viewer.addEventListener(ZD.type,this),super.hide()}destroy(){this.viewer.removeEventListener(TP.type,this),this.viewer.removeEventListener(ZD.type,this),super.destroy()}handleEvent(t){t instanceof TP?this.toggleActive(t.panelId===dL.MENU):t instanceof ZD&&this.toggleActive(!1)}onClick(){this.state.active?this.__hideMenu():this.__showMenu()}hide(t){super.hide(t),this.__hideMenu()}show(t){super.show(t),this.state.active&&this.__showMenu()}__showMenu(){var t,e;this.viewer.panel.show({id:dL.MENU,content:(t=this.viewer.navbar.collapsed,e=this.viewer.config.lang.menu,'\n<div class="psv-panel-menu psv-panel-menu--stripped">\n  <h1 class="psv-panel-menu-title">'.concat(pL.menu," ").concat(e,'</h1>\n  <ul class="psv-panel-menu-list">\n    ').concat(t.map(t=>'\n    <li data-psv-button="'.concat(t.id,'" class="psv-panel-menu-item" tabindex="0">\n      <span class="psv-panel-menu-item-icon">').concat(t.content,'</span>\n      <span class="psv-panel-menu-item-label">').concat(t.title,"</span>\n    </li>\n    ")).join(""),"\n  </ul>\n</div>\n")),noMargin:!0,clickHandler:t=>{const e=t?RL(t,".psv-panel-menu-item"):void 0,n=e?e.dataset.psvButton:void 0;n&&(this.viewer.navbar.getButton(n).onClick(),this.__hideMenu())}})}__hideMenu(){this.viewer.panel.hide(dL.MENU)}};function iI(t){let e=0;switch(t){case 0:e=90;break;case 1:e=-90;break;case 3:e=180;break;default:e=0}return pL.arrow.replace("rotate(0","rotate(".concat(e))}nI.id="menu";var rI=class extends ZP{constructor(t,e){super(t,{className:"psv-move-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:iI(e)}),this.direction=e,this.handler=new TD,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown();break;case"mouseup":case"touchend":this.__onMouseUp();break;case"keydown":t.key===fL.Enter&&this.__onMouseDown();break;case"keyup":t.key===fL.Enter&&this.__onMouseUp()}}onClick(){}isSupported(){return ZL(jP.isTouchEnabled)}__onMouseDown(){if(!this.state.enabled)return;const t={};switch(this.direction){case 0:t.pitch=!1;break;case 1:t.pitch=!0;break;case 3:t.yaw=!1;break;default:t.yaw=!0}this.viewer.stopAll(),this.viewer.dynamics.position.roll(t),this.handler.down()}__onMouseUp(){this.state.enabled&&this.handler.up(()=>{this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer()})}};rI.groupId="move";var sI=class extends rI{constructor(t){super(t,1)}};sI.id="moveDown";var aI=class extends rI{constructor(t){super(t,2)}};aI.id="moveLeft";var oI=class extends rI{constructor(t){super(t,3)}};oI.id="moveRight";var lI=class extends rI{constructor(t){super(t,0)}};lI.id="moveUp";var cI=class extends ZP{constructor(t,e,n){super(t,{className:"psv-zoom-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:e}),this.direction=n,this.handler=new TD,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown();break;case"mouseup":case"touchend":this.__onMouseUp();break;case"keydown":t.key===fL.Enter&&this.__onMouseDown();break;case"keyup":t.key===fL.Enter&&this.__onMouseUp()}}onClick(){}isSupported(){return ZL(jP.isTouchEnabled)}__onMouseDown(){this.state.enabled&&(this.viewer.dynamics.zoom.roll(1===this.direction),this.handler.down())}__onMouseUp(){this.state.enabled&&this.handler.up(()=>this.viewer.dynamics.zoom.stop())}};cI.groupId="zoom";var uI=class extends cI{constructor(t){super(t,pL.zoomIn,0)}};uI.id="zoomIn";var hI=class extends cI{constructor(t){super(t,pL.zoomOut,1)}};hI.id="zoomOut";var dI=class extends ZP{constructor(t){super(t,{className:"psv-zoom-range",hoverScale:!1,collapsable:!1,tabbable:!1}),this.zoomRange=document.createElement("div"),this.zoomRange.className="psv-zoom-range-line",this.container.appendChild(this.zoomRange),this.zoomValue=document.createElement("div"),this.zoomValue.className="psv-zoom-range-handle",this.zoomRange.appendChild(this.zoomValue),this.slider=new AD(this.container,"HORIZONTAL",t=>this.__onSliderUpdate(t)),this.mediaMinWidth=parseInt(PL(this.container,"max-width"),10),this.viewer.addEventListener(PP.type,this),this.viewer.state.ready?this.__moveZoomValue(this.viewer.getZoomLevel()):this.viewer.addEventListener(vP.type,this)}destroy(){this.slider.destroy(),this.viewer.removeEventListener(PP.type,this),this.viewer.removeEventListener(vP.type,this),super.destroy()}handleEvent(t){t instanceof PP?this.__moveZoomValue(t.zoomLevel):t instanceof vP&&this.__moveZoomValue(this.viewer.getZoomLevel())}onClick(){}isSupported(){return ZL(jP.isTouchEnabled)}autoSize(){this.state.supported&&(this.viewer.state.size.width<=this.mediaMinWidth&&this.state.visible?this.hide(!1):this.viewer.state.size.width>this.mediaMinWidth&&!this.state.visible&&this.show(!1))}__moveZoomValue(t){this.zoomValue.style.left=t/100*this.zoomRange.offsetWidth-this.zoomValue.offsetWidth/2+"px"}__onSliderUpdate(t){t.mousedown&&this.viewer.zoom(100*t.value)}};dI.id="zoomRange",dI.groupId="zoom";var fI=class extends kD{constructor(t){super(),this.viewer=t}init(){}destroy(){}},pI=class extends fI{constructor(t,e){super(t),this.config=this.constructor.configParser(e)}setOption(t,e){this.setOptions({[t]:e})}setOptions(t){const e=Rr(Rr({},this.config),t),n=this.constructor,i=n.configParser,r=n.readonlyOptions,s=n.id;for(let[a,o]of Object.entries(t))a in i.defaults?r.includes(a)?tD("".concat(s,': Option "').concat(a,'" cannot be updated')):(a in i.parsers&&(o=i.parsers[a](o,{rawConfig:e,defValue:i.defaults[a]})),this.config[a]=o):tD("".concat(s,': Unknown option "').concat(a,'"'))}};function mI(t){if(t)for(const[,e]of[["_",t],...Object.entries(t)])if(e.prototype instanceof fI)return _D(e.id,e.VERSION,"5.14.0"),e;return null}pI.readonlyOptions=[];var gI={panorama:null,container:null,adapter:[XP,null],plugins:[],caption:null,description:null,downloadUrl:null,downloadName:null,loadingImg:null,loadingTxt:"",size:null,fisheye:0,minFov:30,maxFov:90,defaultZoomLvl:50,defaultYaw:0,defaultPitch:0,sphereCorrection:null,moveSpeed:1,zoomSpeed:1,moveInertia:.8,mousewheel:!0,mousemove:!0,mousewheelCtrlKey:!1,touchmoveTwoFingers:!1,panoData:null,requestHeaders:null,canvasBackground:"#000",defaultTransition:{speed:1500,rotation:!0,effect:"fade"},rendererParameters:{alpha:!0,antialias:!0},withCredentials:()=>!1,navbar:["zoom","move","download","description","caption","fullscreen"],lang:{zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",moveUp:"Move up",moveDown:"Move down",moveLeft:"Move left",moveRight:"Move right",description:"Description",download:"Download",fullscreen:"Fullscreen",loading:"Loading...",menu:"Menu",close:"Close",twoFingers:"Use two fingers to navigate",ctrlZoom:"Use ctrl + scroll to zoom the image",loadError:"The panorama cannot be loaded",webglError:"Your browser does not seem to support WebGL"},keyboard:"fullscreen",keyboardActions:{[fL.ArrowUp]:"ROTATE_UP",[fL.ArrowDown]:"ROTATE_DOWN",[fL.ArrowRight]:"ROTATE_RIGHT",[fL.ArrowLeft]:"ROTATE_LEFT",[fL.PageUp]:"ZOOM_IN",[fL.PageDown]:"ZOOM_OUT",[fL.Plus]:"ZOOM_IN",[fL.Minus]:"ZOOM_OUT"}},vI={panorama:"Use setPanorama method to change the panorama",panoData:"Use setPanorama method to change the panorama",container:"Cannot change viewer container",adapter:"Cannot change adapter",plugins:"Cannot change plugins"},yI={container:t=>{if(!t)throw new qL("No value given for container.");return t},adapter:(t,e)=>{let{defValue:n}=e;if(!(t=t?Array.isArray(t)?[VP(t[0]),t[1]]:[VP(t),null]:n)[0])throw new qL("An undefined value was given for adapter.");if(!t[0].id)throw new qL("Adapter has no id.");return t},defaultYaw:t=>fD(t),defaultPitch:t=>fD(t,!0),defaultZoomLvl:t=>SS.clamp(t,0,100),minFov:(t,e)=>{let{rawConfig:n}=e;return n.maxFov<t&&(tD("maxFov cannot be lower than minFov"),t=n.maxFov),SS.clamp(t,1,179)},maxFov:(t,e)=>{let{rawConfig:n}=e;return t<n.minFov&&(t=n.minFov),SS.clamp(t,1,179)},moveInertia:(t,e)=>{let{defValue:n}=e;return!0===t?n:!1===t?0:t},lang:t=>Rr(Rr({},gI.lang),t),fisheye:t=>!0===t?1:!1===t?0:t,requestHeaders:t=>t&&"object"===typeof t?()=>t:"function"===typeof t?t:null,withCredentials:t=>"boolean"===typeof t?()=>t:"function"===typeof t?t:()=>!1,defaultTransition:(t,e)=>{let{defValue:n}=e;return null===t||0===t.speed?null:Rr(Rr({},n),t)},rendererParameters:(t,e)=>{let{defValue:n}=e;return Rr(Rr({},t),n)},plugins:t=>t.map((t,e)=>{if(!(t=Array.isArray(t)?[mI(t[0]),t[1]]:[mI(t),null])[0])throw new qL("An undefined value was given for plugin ".concat(e,"."));if(!t[0].id)throw new qL("Plugin ".concat(e," has no id."));return t}),navbar:t=>!1===t?null:!0===t?GL(gI.navbar):"string"===typeof t?t.split(/[ ,]/):t},_I=vD(gI,yI),bI=class extends ZP{constructor(t){super(t,{className:"psv-caption",hoverScale:!1,collapsable:!1,tabbable:!0}),this.contentWidth=0,this.state.width=0,this.contentElt=document.createElement("div"),this.contentElt.className="psv-caption-content",this.container.appendChild(this.contentElt),this.setCaption(this.viewer.config.caption)}hide(){this.contentElt.style.display="none",this.state.visible=!1}show(){this.contentElt.style.display="",this.state.visible=!0}onClick(){}setCaption(t){this.show(),this.contentElt.innerHTML=null!==t&&void 0!==t?t:"",this.contentElt.innerHTML?this.contentWidth=this.contentElt.offsetWidth:this.contentWidth=0,this.autoSize()}autoSize(){this.toggle(this.container.offsetWidth>=this.contentWidth),this.__refreshButton()}__refreshButton(){var t;null===(t=this.viewer.navbar.getButton($P.id,!1))||void 0===t||t.autoSize(!0)}};bI.id="caption";var xI={},EI={};function wI(t,e){if(!t.id)throw new qL("Button id is required");if(xI[t.id]=t,t.groupId&&(EI[t.groupId]=EI[t.groupId]||[]).push(t),e){const n=gI.navbar;switch(e){case"start":n.unshift(t.id);break;case"end":n.push(t.id);break;default:{const[i,r]=e.split(":"),s=n.indexOf(i);if(!i||!r||-1===s)throw new qL("Invalid defaultPosition ".concat(e));n.splice(s+("right"===r?1:0),0,t.id)}}}}[hI,dI,uI,$P,bI,tI,eI,aI,oI,lI,sI].forEach(t=>wI(t));var SI=class extends qP{constructor(t){super(t,{className:"psv-navbar ".concat(uL)}),this.collapsed=[],this.state.visible=!1}show(){this.viewer.container.classList.add("psv--has-navbar"),this.container.classList.add("psv-navbar--open"),this.state.visible=!0}hide(){this.viewer.container.classList.remove("psv--has-navbar"),this.container.classList.remove("psv-navbar--open"),this.state.visible=!1}setButtons(t){this.children.slice().forEach(t=>t.destroy()),this.children.length=0,-1!==t.indexOf(bI.id)&&-1===t.indexOf($P.id)&&t.splice(t.indexOf(bI.id),0,$P.id),t.forEach(t=>{"object"===typeof t?new JP(this,t):xI[t]?new xI[t](this):EI[t]?EI[t].forEach(t=>{new t(this)}):tD("Unknown button ".concat(t))}),new nI(this),this.children.forEach(t=>{t instanceof ZP&&t.checkSupported()}),this.autoSize()}setCaption(t){this.children.some(e=>e instanceof bI&&(e.setCaption(t),!0))}getButton(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.children.find(e=>e instanceof ZP&&e.id===t);return!n&&e&&tD('button "'.concat(t,'" not found in the navbar')),n}focusButton(t){var e,n;this.isVisible()&&(null===(e=(null===(n=this.getButton(t,!1))||void 0===n?void 0:n.container)||this.container.firstElementChild)||void 0===e||e.focus())}autoSize(){var t;this.children.forEach(t=>{t instanceof ZP&&t.autoSize()});const e=this.container.offsetWidth;let n=0;const i=[];this.children.forEach(t=>{t.isVisible()&&t instanceof ZP&&(n+=t.width,t.collapsable&&i.push(t))}),0!==n&&(e<n&&i.length>0?(i.forEach(t=>t.collapse()),this.collapsed=i,this.getButton(nI.id).show(!1)):e>=n&&this.collapsed.length>0&&(this.collapsed.forEach(t=>t.uncollapse()),this.collapsed=[],this.getButton(nI.id).hide(!1)),null===(t=this.getButton(bI.id,!1))||void 0===t||t.autoSize())}};YA.enabled=!1;var TI={enabled:!0,maxItems:10,ttl:600,items:{},purgeInterval:null,init(){YA.enabled&&(tD("ThreeJS cache should be disabled"),YA.enabled=!1),!this.purgeInterval&&this.enabled&&(this.purgeInterval=setInterval(()=>this.purge(),6e4))},add(t,e,n){var i;this.enabled&&e&&(this.items[e]=null!==(i=this.items[e])&&void 0!==i?i:{files:{},lastAccess:null},this.items[e].files[t]=n,this.items[e].lastAccess=Date.now())},get(t,e){if(this.enabled&&e&&this.items[e])return this.items[e].lastAccess=Date.now(),this.items[e].files[t]},remove(t,e){this.enabled&&e&&this.items[e]&&(delete this.items[e].files[t],0===Object.keys(this.items[e].files).length&&delete this.items[e])},purge(){Object.entries(this.items).sort((t,e)=>{let[,n]=t,[,i]=e;return i.lastAccess-n.lastAccess}).forEach((t,e)=>{let[n,{lastAccess:i}]=t;e>0&&(Date.now()-i>=1e3*this.ttl||e>=this.maxItems)&&delete this.items[n]})}},MI=class extends qP{constructor(t){super(t,{className:"psv-loader-container"}),this.loader=document.createElement("div"),this.loader.className="psv-loader",this.container.appendChild(this.loader),this.size=this.loader.offsetWidth,this.canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.canvas.setAttribute("class","psv-loader-canvas"),this.canvas.setAttribute("viewBox","0 0 ".concat(this.size," ").concat(this.size)),this.loader.appendChild(this.canvas),this.textColor=PL(this.loader,"color"),this.color=PL(this.canvas,"color"),this.border=parseInt(PL(this.loader,"--psv-loader-border"),10),this.thickness=parseInt(PL(this.loader,"--psv-loader-tickness"),10);const e=this.size/2;this.canvas.innerHTML='\n            <circle cx="'.concat(e,'" cy="').concat(e,'" r="').concat(e,'" fill="').concat(this.color,'"/>\n            <path d="" fill="none" stroke="').concat(this.textColor,'" stroke-width="').concat(this.thickness,'" stroke-linecap="round"/>\n        '),this.viewer.addEventListener(HD.type,this),this.__updateContent(),this.hide()}destroy(){this.viewer.removeEventListener(HD.type,this),super.destroy()}handleEvent(t){t instanceof HD&&t.containsOptions("loadingImg","loadingTxt","lang")&&this.__updateContent()}setProgress(t){this.container.classList.remove("psv-loader--undefined");const e=SS.clamp(t,0,99.999)/100*Math.PI*2,n=this.size/2,i=n,r=this.thickness/2+this.border,s=(this.size-this.thickness)/2-this.border,a=Math.sin(e)*s+n,o=-Math.cos(e)*s+n,l=t>50?"1":"0";this.canvas.querySelector("path").setAttributeNS(null,"d","M ".concat(i," ").concat(r," A ").concat(s," ").concat(s," 0 ").concat(l," 1 ").concat(a," ").concat(o))}showUndefined(){this.show(),this.setProgress(25),this.container.classList.add("psv-loader--undefined")}__updateContent(){const t=this.loader.querySelector(".psv-loader-image, .psv-loader-text");let e;if(t&&this.loader.removeChild(t),this.viewer.config.loadingImg?(e=document.createElement("img"),e.className="psv-loader-image",e.src=this.viewer.config.loadingImg):null!==this.viewer.config.loadingTxt&&(e=document.createElement("div"),e.className="psv-loader-text",e.innerHTML=this.viewer.config.loadingTxt||this.viewer.config.lang.loading),e){const t=Math.round(Math.sqrt(2*Math.pow(this.size/2-this.thickness/2-this.border,2)));e.style.maxWidth=t+"px",e.style.maxHeight=t+"px",this.loader.appendChild(e)}}},AI=class extends qP{constructor(t){super(t,{className:"psv-notification"}),this.state={visible:!1,contentId:null,timeout:null},this.content=document.createElement("div"),this.content.className="psv-notification-content",this.container.appendChild(this.content),this.content.addEventListener("click",()=>this.hide())}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new qL("Notification cannot be toggled")}show(t){this.state.timeout&&(clearTimeout(this.state.timeout),this.state.timeout=null),"string"===typeof t&&(t={content:t}),this.state.contentId=t.id||null,this.content.innerHTML=t.content,this.container.classList.add("psv-notification--visible"),this.state.visible=!0,this.viewer.dispatchEvent(new xP(this.state.contentId)),t.timeout&&(this.state.timeout=setTimeout(()=>this.hide(this.state.contentId),t.timeout))}hide(t){if(this.isVisible(t)){const t=this.state.contentId;this.container.classList.remove("psv-notification--visible"),this.state.visible=!1,this.state.contentId=null,this.viewer.dispatchEvent(new XD(t))}}},CI=class extends qP{constructor(t){super(t,{className:"psv-overlay ".concat(uL)}),this.state={visible:!1,contentId:null,dismissible:!0},this.image=document.createElement("div"),this.image.className="psv-overlay-image",this.container.appendChild(this.image),this.title=document.createElement("div"),this.title.className="psv-overlay-title",this.container.appendChild(this.title),this.text=document.createElement("div"),this.text.className="psv-overlay-text",this.container.appendChild(this.text),this.container.addEventListener("click",this),this.viewer.addEventListener(eP.type,this),super.hide()}destroy(){this.viewer.removeEventListener(eP.type,this),super.destroy()}handleEvent(t){"click"===t.type?this.isVisible()&&this.state.dismissible&&(this.hide(),t.stopPropagation()):t instanceof eP&&this.isVisible()&&this.state.dismissible&&t.matches(fL.Escape)&&(this.hide(),t.preventDefault())}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new qL("Overlay cannot be toggled")}show(t){"string"===typeof t&&(t={title:t}),this.state.contentId=t.id||null,this.state.dismissible=!1!==t.dismissible,this.image.innerHTML=t.image||"",this.title.innerHTML=t.title||"",this.text.innerHTML=t.text||"",super.show(),this.viewer.dispatchEvent(new wP(this.state.contentId))}hide(t){if(this.isVisible(t)){const t=this.state.contentId;super.hide(),this.state.contentId=null,this.viewer.dispatchEvent(new qD(t))}}},RI="psv-panel-content--no-interaction",kI=class extends qP{constructor(t){super(t,{className:"psv-panel ".concat(uL)}),this.state={visible:!1,contentId:null,mouseX:0,mouseY:0,mousedown:!1,clickHandler:null,keyHandler:null,width:{}};const e=document.createElement("div");e.className="psv-panel-resizer",this.container.appendChild(e);const n=document.createElement("div");n.className="psv-panel-close-button",n.innerHTML=pL.close,n.title=t.config.lang.close,this.container.appendChild(n),this.content=document.createElement("div"),this.content.className="psv-panel-content",this.container.appendChild(this.content),n.addEventListener("click",()=>this.hide()),e.addEventListener("mousedown",this),e.addEventListener("touchstart",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this),this.viewer.container.addEventListener("mousemove",this),this.viewer.container.addEventListener("touchmove",this),this.viewer.addEventListener(eP.type,this)}destroy(){this.viewer.removeEventListener(eP.type,this),this.viewer.container.removeEventListener("mousemove",this),this.viewer.container.removeEventListener("touchmove",this),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown(t);break;case"touchstart":this.__onTouchStart(t);break;case"mousemove":this.__onMouseMove(t);break;case"touchmove":this.__onTouchMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchend":this.__onTouchEnd(t);break;case eP.type:this.__onKeyPress(t)}}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new qL("Panel cannot be toggled")}show(t){"string"===typeof t&&(t={content:t});const e=this.isVisible(t.id);this.state.contentId=t.id||null,this.state.visible=!0,this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),t.id&&this.state.width[t.id]?this.container.style.width=this.state.width[t.id]:t.width?this.container.style.width=t.width:this.container.style.width=null,this.content.innerHTML=t.content,this.content.scrollTop=0,this.container.classList.add("psv-panel--open"),TL(this.content,"psv-panel-content--no-margin",!0===t.noMargin),t.clickHandler&&(this.state.clickHandler=e=>{t.clickHandler(kL(e))},this.state.keyHandler=e=>{e.key===fL.Enter&&t.clickHandler(kL(e))},this.content.addEventListener("click",this.state.clickHandler),this.content.addEventListener("keydown",this.state.keyHandler),e||setTimeout(()=>{var t;null===(t=this.content.querySelector("a,button,[tabindex]"))||void 0===t||t.focus()},300)),this.viewer.dispatchEvent(new TP(this.state.contentId))}hide(t){if(this.isVisible(t)){const t=this.state.contentId;this.state.visible=!1,this.state.contentId=null,this.content.innerHTML=null,this.container.classList.remove("psv-panel--open"),this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),this.viewer.dispatchEvent(new ZD(t))}}__onMouseDown(t){t.stopPropagation(),this.__startResize(t.clientX,t.clientY)}__onTouchStart(t){if(t.stopPropagation(),1===t.touches.length){const e=t.touches[0];this.__startResize(e.clientX,e.clientY)}}__onMouseUp(t){this.state.mousedown&&(t.stopPropagation(),this.state.mousedown=!1,this.content.classList.remove(RI))}__onTouchEnd(t){this.state.mousedown&&(t.stopPropagation(),0===t.touches.length&&(this.state.mousedown=!1,this.content.classList.remove(RI)))}__onMouseMove(t){this.state.mousedown&&(t.stopPropagation(),this.__resize(t.clientX,t.clientY))}__onTouchMove(t){if(this.state.mousedown){const e=t.touches[0];this.__resize(e.clientX,e.clientY)}}__onKeyPress(t){this.isVisible()&&t.matches(fL.Escape)&&(this.hide(),t.preventDefault())}__startResize(t,e){this.state.mouseX=t,this.state.mouseY=e,this.state.mousedown=!0,this.content.classList.add(RI)}__resize(t,e){const n=t,i=e,r=Math.max(200,this.container.offsetWidth-(n-this.state.mouseX))+"px";this.state.contentId&&(this.state.width[this.state.contentId]=r),this.container.style.width=r,this.state.mouseX=n,this.state.mouseY=i}},LI=class extends qP{constructor(t,e){super(t,{className:"psv-tooltip"}),this.state={visible:!0,arrow:0,border:0,state:0,width:0,height:0,pos:"",config:null,data:null,hideTimeout:null},this.content=document.createElement("div"),this.content.className="psv-tooltip-content",this.container.appendChild(this.content),this.arrow=document.createElement("div"),this.arrow.className="psv-tooltip-arrow",this.container.appendChild(this.arrow),this.container.addEventListener("transitionend",this),this.container.addEventListener("touchdown",t=>t.stopPropagation()),this.container.addEventListener("mousedown",t=>t.stopPropagation()),this.container.style.top="-1000px",this.container.style.left="-1000px",this.show(e)}handleEvent(t){"transitionend"===t.type&&this.__onTransitionEnd(t)}destroy(){clearTimeout(this.state.hideTimeout),delete this.state.data,super.destroy()}toggle(){throw new qL("Tooltip cannot be toggled")}show(t){if(0!==this.state.state)throw new qL("Initialized tooltip cannot be re-initialized");t.className&&ML(this.container,t.className),t.style&&Object.assign(this.container.style,t.style),this.state.state=3,this.update(t.content,t),this.state.data=t.data,this.state.state=1,this.viewer.dispatchEvent(new AP(this,this.state.data)),this.__waitImages()}update(t,e){this.content.innerHTML=t;const n=this.container.getBoundingClientRect();this.state.width=n.right-n.left,this.state.height=n.bottom-n.top,this.state.arrow=parseInt(PL(this.arrow,"border-top-width"),10),this.state.border=parseInt(PL(this.container,"border-top-left-radius"),10),this.move(null!==e&&void 0!==e?e:this.state.config),this.__waitImages()}move(t){var e,n,i;if(1!==this.state.state&&3!==this.state.state)throw new qL("Uninitialized tooltip cannot be moved");t.box=null!==(e=null!==(n=t.box)&&void 0!==n?n:null===(i=this.state.config)||void 0===i?void 0:i.box)&&void 0!==e?e:{width:0,height:0},this.state.config=t;const r=this.container,s=this.arrow,a={posClass:cD(t.position,{allowCenter:!1,cssOrder:!1})||["top","center"],width:this.state.width,height:this.state.height,top:0,left:0,arrowTop:0,arrowLeft:0};this.__computeTooltipPosition(a,t);let o=null,l=null;if(a.top<0?o="bottom":a.top+a.height>this.viewer.state.size.height&&(o="top"),a.left<0?l="right":a.left+a.width>this.viewer.state.size.width&&(l="left"),l||o){const e=uD(a.posClass);o&&(a.posClass[e?0:1]=o),l&&(a.posClass[e?1:0]=l),this.__computeTooltipPosition(a,t)}r.style.top=a.top+"px",r.style.left=a.left+"px",s.style.top=a.arrowTop+"px",s.style.left=a.arrowLeft+"px";const c=a.posClass.join("-");c!==this.state.pos&&(r.classList.remove("psv-tooltip--".concat(this.state.pos)),this.state.pos=c,r.classList.add("psv-tooltip--".concat(this.state.pos)))}hide(){this.container.classList.remove("psv-tooltip--visible"),this.state.state=2,this.viewer.dispatchEvent(new $D(this.state.data));const t=parseFloat(PL(this.container,"transition-duration"));this.state.hideTimeout=setTimeout(()=>{this.destroy()},2*t)}__onTransitionEnd(t){if("transform"===t.propertyName)switch(this.state.state){case 1:this.container.classList.add("psv-tooltip--visible"),this.state.state=3;break;case 2:this.state.state=0,this.destroy()}}__computeTooltipPosition(t,e){const n=this.state.arrow,i=e.top,r=t.height,s=e.left,a=t.width,o=n+this.state.border,l=e.box.width/2+2*n,c=e.box.height/2+2*n;switch(t.posClass.join("-")){case"top-left":t.top=i-c-r,t.left=s+o-a,t.arrowTop=r,t.arrowLeft=a-o-n;break;case"top-center":t.top=i-c-r,t.left=s-a/2,t.arrowTop=r,t.arrowLeft=a/2-n;break;case"top-right":t.top=i-c-r,t.left=s-o,t.arrowTop=r,t.arrowLeft=n;break;case"bottom-left":t.top=i+c,t.left=s+o-a,t.arrowTop=2*-n,t.arrowLeft=a-o-n;break;case"bottom-center":t.top=i+c,t.left=s-a/2,t.arrowTop=2*-n,t.arrowLeft=a/2-n;break;case"bottom-right":t.top=i+c,t.left=s-o,t.arrowTop=2*-n,t.arrowLeft=n;break;case"left-top":t.top=i+o-r,t.left=s-l-a,t.arrowTop=r-o-n,t.arrowLeft=a;break;case"center-left":t.top=i-r/2,t.left=s-l-a,t.arrowTop=r/2-n,t.arrowLeft=a;break;case"left-bottom":t.top=i-o,t.left=s-l-a,t.arrowTop=n,t.arrowLeft=a;break;case"right-top":t.top=i+o-r,t.left=s+l,t.arrowTop=r-o-n,t.arrowLeft=2*-n;break;case"center-right":t.top=i-r/2,t.left=s+l,t.arrowTop=r/2-n,t.arrowLeft=2*-n;break;case"right-bottom":t.top=i-o,t.left=s+l,t.arrowTop=n,t.arrowLeft=2*-n}}__waitImages(){const t=this.content.querySelectorAll("img");if(t.length>0){const e=[];t.forEach(t=>{t.complete||e.push(new Promise(e=>{t.onload=e,t.onerror=e}))}),e.length&&Promise.all(e).then(()=>{if(1===this.state.state||3===this.state.state){const t=this.container.getBoundingClientRect();this.state.width=t.right-t.left,this.state.height=t.bottom-t.top,this.move(this.state.config)}})}}},DI=class{constructor(t){this.viewer=t,this.config=t.config,this.state=t.state}destroy(){}},PI=new AS,II=new BT(0,0,0,"ZXY"),OI=class extends DI{constructor(t){super(t)}fovToZoomLevel(t){const e=Math.round((t-this.config.minFov)/(this.config.maxFov-this.config.minFov)*100);return SS.clamp(e-2*(e-50),0,100)}zoomLevelToFov(t){return this.config.maxFov+t/100*(this.config.minFov-this.config.maxFov)}vFovToHFov(t){return SS.radToDeg(2*Math.atan(Math.tan(SS.degToRad(t)/2)*this.state.aspect))}hFovToVFov(t){return SS.radToDeg(2*Math.atan(Math.tan(SS.degToRad(t)/2)/this.state.aspect))}getAnimationProperties(t,e,n){const i=!WL(e),r=!WL(n),s={};let a=null;if(i){const n=this.viewer.getPosition(),i=xL(n.yaw,e.yaw);s.yaw={start:n.yaw,end:n.yaw+i},s.pitch={start:n.pitch,end:e.pitch},a=dD(t,EL(n,e))}if(r){const e=this.viewer.getZoomLevel(),i=Math.abs(n-e);s.zoom={start:e,end:n},null===a&&(a=dD(t,Math.PI/4*i/100))}return a=null===a?"number"===typeof t?t:nL:Math.max(nL,a),{duration:a,properties:s}}getTransitionOptions(t){var e;let n;const i=null!==(e=this.config.defaultTransition)&&void 0!==e?e:gI.defaultTransition;return n=!1===t.transition||null===t.transition?null:!0===t.transition?Rr({},i):"object"===typeof t.transition?Rr(Rr({},i),t.transition):this.config.defaultTransition,n}textureCoordsToSphericalCoords(t){var e;if(null===(e=this.state.textureData)||void 0===e||!e.panoData)throw new qL("Current adapter does not support texture coordinates or no texture has been loaded");const n=this.viewer.adapter.textureCoordsToSphericalCoords(t,this.state.textureData.panoData);return II.equals(this.viewer.renderer.panoramaPose)&&II.equals(this.viewer.renderer.sphereCorrection)?n:(this.sphericalCoordsToVector3(n,PI),PI.applyEuler(this.viewer.renderer.panoramaPose),PI.applyEuler(this.viewer.renderer.sphereCorrection),this.vector3ToSphericalCoords(PI))}sphericalCoordsToTextureCoords(t){var e;if(null===(e=this.state.textureData)||void 0===e||!e.panoData)throw new qL("Current adapter does not support texture coordinates or no texture has been loaded");return II.equals(this.viewer.renderer.panoramaPose)&&II.equals(this.viewer.renderer.sphereCorrection)||(this.sphericalCoordsToVector3(t,PI),gD(PI,this.viewer.renderer.sphereCorrection),gD(PI,this.viewer.renderer.panoramaPose),t=this.vector3ToSphericalCoords(PI)),this.viewer.adapter.sphericalCoordsToTextureCoords(t,this.state.textureData.panoData)}sphericalCoordsToVector3(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lL;return e||(e=new AS),e.x=n*-Math.cos(t.pitch)*Math.sin(t.yaw),e.y=n*Math.sin(t.pitch),e.z=n*Math.cos(t.pitch)*Math.cos(t.yaw),e}vector3ToSphericalCoords(t){const e=Math.acos(t.y/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)),n=Math.atan2(t.x,t.z);return{yaw:n<0?-n:2*Math.PI-n,pitch:Math.PI/2-e}}viewerCoordsToVector3(t){const e=this.viewer.renderer.getIntersections(t).filter(t=>t.object.userData[cL]);return e.length?e[0].point:null}viewerCoordsToSphericalCoords(t){const e=this.viewerCoordsToVector3(t);return e?this.vector3ToSphericalCoords(e):null}vector3ToViewerCoords(t){const e=t.clone();return e.project(this.viewer.renderer.camera),{x:Math.round((e.x+1)/2*this.state.size.width),y:Math.round((1-e.y)/2*this.state.size.height)}}sphericalCoordsToViewerCoords(t){return this.sphericalCoordsToVector3(t,PI),this.vector3ToViewerCoords(PI)}isPointVisible(t){let e,n;if(t instanceof AS)e=t,n=this.vector3ToViewerCoords(t);else{if(!eD(t))return!1;e=this.sphericalCoordsToVector3(t,PI),n=this.vector3ToViewerCoords(e)}return e.dot(this.viewer.state.direction)>0&&n.x>=0&&n.x<=this.viewer.state.size.width&&n.y>=0&&n.y<=this.viewer.state.size.height}cleanPosition(t){if("yaw"in t||"pitch"in t){if(!("yaw"in t)||!("pitch"in t))throw new qL("Position is missing 'yaw' or 'pitch'");return{yaw:fD(t.yaw),pitch:fD(t.pitch,!0)}}return this.textureCoordsToSphericalCoords(t)}cleanSphereCorrection(t){return{pan:fD((null===t||void 0===t?void 0:t.pan)||0),tilt:fD((null===t||void 0===t?void 0:t.tilt)||0,!0),roll:fD((null===t||void 0===t?void 0:t.roll)||0,!0,!1)}}cleanPanoramaPose(t){return{pan:SS.degToRad((null===t||void 0===t?void 0:t.poseHeading)||0),tilt:SS.degToRad((null===t||void 0===t?void 0:t.posePitch)||0),roll:SS.degToRad((null===t||void 0===t?void 0:t.poseRoll)||0)}}cleanPanoramaOptions(t,e){return null!==e&&void 0!==e&&e.isEquirectangular?(WL(t.zoom)&&!WL(e.initialFov)&&(t=Rr(Rr({},t),{},{zoom:this.fovToZoomLevel(this.hFovToVFov(e.initialFov))})),!WL(t.position)||WL(e.initialHeading)||WL(e.initialPitch)||(t=Rr(Rr({},t),{},{position:{yaw:fD(e.initialHeading),pitch:fD(e.initialPitch,!0)}})),t):t}},NI=class t{constructor(){this.$=t.IDLE}is(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.some(t=>this.$&t)}set(t){this.$=t}add(t){this.$|=t}remove(t){this.$&=~t}};NI.IDLE=0,NI.CLICK=1,NI.MOVING=2;var FI=NI,UI=class extends DI{constructor(t){super(t),this.data={startMouseX:0,startMouseY:0,mouseX:0,mouseY:0,pinchDist:0,moveDelta:{yaw:0,pitch:0,zoom:0},accumulatorFactor:0,ctrlKeyDown:!1,dblclickData:null,dblclickTimeout:null,longtouchTimeout:null,twofingersTimeout:null,ctrlZoomTimeout:null},this.step=new FI,this.keyHandler=new TD,this.resizeObserver=new ResizeObserver(zL(()=>this.viewer.autoSize(),50)),this.moveThreshold=iL*jP.pixelRatio}init(){window.addEventListener("keydown",this,{passive:!1}),window.addEventListener("keyup",this),this.viewer.container.addEventListener("mousedown",this),window.addEventListener("mousemove",this,{passive:!1}),window.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchstart",this,{passive:!1}),window.addEventListener("touchmove",this,{passive:!1}),window.addEventListener("touchend",this,{passive:!1}),this.viewer.container.addEventListener("wheel",this,{passive:!1}),document.addEventListener("fullscreenchange",this),this.resizeObserver.observe(this.viewer.container),this.viewer.addEventListener(OD.type,this),this.viewer.addEventListener(LP.type,this)}destroy(){window.removeEventListener("keydown",this),window.removeEventListener("keyup",this),this.viewer.container.removeEventListener("mousedown",this),window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchstart",this),window.removeEventListener("touchmove",this),window.removeEventListener("touchend",this),this.viewer.container.removeEventListener("wheel",this),document.removeEventListener("fullscreenchange",this),this.resizeObserver.disconnect(),this.viewer.removeEventListener(OD.type,this),this.viewer.removeEventListener(LP.type,this),clearTimeout(this.data.dblclickTimeout),clearTimeout(this.data.longtouchTimeout),clearTimeout(this.data.twofingersTimeout),clearTimeout(this.data.ctrlZoomTimeout),super.destroy()}handleEvent(t){switch(t.type){case"keydown":this.__onKeyDown(t);break;case"keyup":this.__onKeyUp();break;case"mousemove":this.__onMouseMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchmove":this.__onTouchMove(t);break;case"touchend":this.__onTouchEnd(t);break;case"fullscreenchange":this.__onFullscreenChange();break;case OD.type:this.__applyMoveDelta();break;case LP.type:this.__clearMoveDelta()}if(!LL(t,"."+uL))switch(t.type){case"mousedown":this.__onMouseDown(t);break;case"touchstart":this.__onTouchStart(t);break;case"wheel":this.__onMouseWheel(t)}}__onKeyDown(t){if(this.config.mousewheelCtrlKey&&(this.data.ctrlKeyDown=t.key===fL.Control,this.data.ctrlKeyDown&&(clearTimeout(this.data.ctrlZoomTimeout),this.viewer.overlay.hide(dL.CTRL_ZOOM))),this.viewer.dispatchEvent(new eP(t.key,t))&&this.state.keyboardEnabled&&this.config.keyboardActions&&!this.keyHandler.pending)for(const[e,n]of Object.entries(this.config.keyboardActions))if(UL(t,e)){if("function"===typeof n)n(this.viewer,t);else{switch("ZOOM_IN"!==n&&"ZOOM_OUT"!==n&&this.viewer.stopAll(),n){case"ROTATE_UP":this.viewer.dynamics.position.roll({pitch:!1});break;case"ROTATE_DOWN":this.viewer.dynamics.position.roll({pitch:!0});break;case"ROTATE_RIGHT":this.viewer.dynamics.position.roll({yaw:!1});break;case"ROTATE_LEFT":this.viewer.dynamics.position.roll({yaw:!0});break;case"ZOOM_IN":this.viewer.dynamics.zoom.roll(!1);break;case"ZOOM_OUT":this.viewer.dynamics.zoom.roll(!0)}this.keyHandler.down(n)}return void t.preventDefault()}}__onKeyUp(){this.data.ctrlKeyDown=!1,this.state.keyboardEnabled&&this.keyHandler.up(t=>{"ZOOM_IN"===t||"ZOOM_OUT"===t?this.viewer.dynamics.zoom.stop():(this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer())})}__onMouseDown(t){this.step.add(FI.CLICK),this.data.startMouseX=t.clientX,this.data.startMouseY=t.clientY,this.config.mousemove&&t.preventDefault()}__onMouseUp(t){this.step.is(FI.CLICK,FI.MOVING)&&this.__stopMove(t.clientX,t.clientY,t,2===t.button)}__onMouseMove(t){this.config.mousemove&&this.step.is(FI.CLICK,FI.MOVING)&&(t.preventDefault(),this.__doMove(t.clientX,t.clientY)),this.__handleObjectsEvents(t)}__onTouchStart(t){1===t.touches.length?(this.step.add(FI.CLICK),this.data.startMouseX=t.touches[0].clientX,this.data.startMouseY=t.touches[0].clientY,this.data.longtouchTimeout||(this.data.longtouchTimeout=setTimeout(()=>{const e=t.touches[0];this.__stopMove(e.clientX,e.clientY,t,!0),this.data.longtouchTimeout=null},sL))):2===t.touches.length&&(this.step.set(FI.IDLE),this.__cancelLongTouch(),this.config.mousemove&&(this.__cancelTwoFingersOverlay(),this.__startMoveZoom(t),t.preventDefault()))}__onTouchEnd(t){if(this.__cancelLongTouch(),this.step.is(FI.CLICK,FI.MOVING))if(t.preventDefault(),this.__cancelTwoFingersOverlay(),1===t.touches.length)this.__stopMove(this.data.mouseX,this.data.mouseY);else if(0===t.touches.length){const e=t.changedTouches[0];this.__stopMove(e.clientX,e.clientY,t)}}__onTouchMove(t){if(this.__cancelLongTouch(),this.config.mousemove)if(1===t.touches.length){if(this.config.touchmoveTwoFingers)this.step.is(FI.CLICK)&&!this.data.twofingersTimeout&&(this.data.twofingersTimeout=setTimeout(()=>{this.viewer.overlay.show({id:dL.TWO_FINGERS,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z"/>\x3c!--Created by AomAm from the Noun Project--\x3e</svg>\n',title:this.config.lang.twoFingers})},aL));else if(this.step.is(FI.CLICK,FI.MOVING)){t.preventDefault();const e=t.touches[0];this.__doMove(e.clientX,e.clientY)}}else this.__doMoveZoom(t),this.__cancelTwoFingersOverlay()}__cancelLongTouch(){this.data.longtouchTimeout&&(clearTimeout(this.data.longtouchTimeout),this.data.longtouchTimeout=null)}__cancelTwoFingersOverlay(){this.config.touchmoveTwoFingers&&(this.data.twofingersTimeout&&(clearTimeout(this.data.twofingersTimeout),this.data.twofingersTimeout=null),this.viewer.overlay.hide(dL.TWO_FINGERS))}__onMouseWheel(t){if(!this.config.mousewheel||!t.deltaY)return;if(this.config.mousewheelCtrlKey&&!this.data.ctrlKeyDown)return this.viewer.overlay.show({id:dL.CTRL_ZOOM,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 17 79 79"><path fill="currentColor" d="M38.1 29.27c-.24 0-.44.2-.44.45v10.7a.45.45 0 00.9 0v-10.7c0-.25-.2-.45-.45-.45zm10.2 26.66a11.54 11.54 0 01-8.48-6.14.45.45 0 10-.8.41 12.45 12.45 0 009.22 6.62.45.45 0 00.07-.9zm24.55-13.08a23.04 23.04 0 00-22.56-23v7.07l-.01.05a2.83 2.83 0 012.39 2.78v14.03l.09-.02h8.84v-9.22a.45.45 0 11.9 0v9.22h10.35v-.9zm0 27.33V44.66H62.5c-.02 2.01-.52 4-1.47 5.76a.45.45 0 01-.61.18.45.45 0 01-.19-.61 11.54 11.54 0 001.36-5.33h-8.83l-.1-.01a2.83 2.83 0 01-2.83 2.84h-.04-.04a2.83 2.83 0 01-2.83-2.83v-14.9a2.82 2.82 0 012.47-2.8v-7.11a23.04 23.04 0 00-22.57 23v.91h14.72V29.88a8.2 8.2 0 015.02-7.57c.22-.1.5.01.59.24.1.23-.01.5-.24.6a7.3 7.3 0 00-4.47 6.73v13.88h3.9a.45.45 0 110 .9h-3.9v.15a7.32 7.32 0 0011.23 6.17.45.45 0 01.49.76 8.22 8.22 0 01-12.62-6.93v-.15H26.82v25.52a23.04 23.04 0 0023.01 23.01 23.04 23.04 0 0023.02-23.01zm1.8-27.33v27.33A24.85 24.85 0 0149.84 95a24.85 24.85 0 01-24.82-24.82V42.85a24.85 24.85 0 0124.82-24.82 24.85 24.85 0 0124.83 24.82zM57.98 29.88v9.36a.45.45 0 11-.9 0v-9.36a7.28 7.28 0 00-3.4-6.17.45.45 0 01.49-.76 8.18 8.18 0 013.8 6.93z"/>\x3c!-- Created by Icon Island from the Noun Project --\x3e</svg>\n',title:this.config.lang.ctrlZoom}),clearTimeout(this.data.ctrlZoomTimeout),void(this.data.ctrlZoomTimeout=setTimeout(()=>this.viewer.overlay.hide(dL.CTRL_ZOOM),oL));t.preventDefault(),t.stopPropagation();const e=t.deltaY/Math.abs(t.deltaY)*5*this.config.zoomSpeed;0!==e&&this.viewer.dynamics.zoom.step(-e,5)}__onFullscreenChange(){const t=this.viewer.isFullscreenEnabled();"fullscreen"===this.config.keyboard&&(t?this.viewer.startKeyboardControl():this.viewer.stopKeyboardControl()),this.viewer.dispatchEvent(new WD(t))}__resetMove(){this.step.set(FI.IDLE),this.data.mouseX=0,this.data.mouseY=0,this.data.startMouseX=0,this.data.startMouseY=0}__startMoveZoom(t){this.viewer.stopAll(),this.__resetMove();const e=IL(t);this.step.set(FI.MOVING),this.data.accumulatorFactor=this.config.moveInertia,({distance:this.data.pinchDist,center:{x:this.data.mouseX,y:this.data.mouseY}}=e)}__stopMove(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.step.is(FI.CLICK)&&!this.__moveThresholdReached(t,e)&&this.__doClick(t,e,n,i),this.config.moveInertia&&(this.data.accumulatorFactor=Math.pow(this.config.moveInertia,.5)),this.__resetMove(),this.viewer.resetIdleTimer()}__doClick(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=this.viewer.container.getBoundingClientRect(),s=t-r.left,a=e-r.top,o=this.viewer.renderer.getIntersections({x:s,y:a}),l=o.find(t=>t.object.userData[cL]);if(l){const r=this.viewer.dataHelper.vector3ToSphericalCoords(l.point),u={rightclick:i,originalEvent:n,target:kL(n),clientX:t,clientY:e,viewerX:s,viewerY:a,yaw:r.yaw,pitch:r.pitch,objects:o.map(t=>t.object).filter(t=>!t.userData[cL])};try{const t=this.viewer.dataHelper.sphericalCoordsToTextureCoords(u);Object.assign(u,t)}catch(c){}this.data.dblclickTimeout?(Math.abs(this.data.dblclickData.clientX-u.clientX)<this.moveThreshold&&Math.abs(this.data.dblclickData.clientY-u.clientY)<this.moveThreshold&&this.viewer.dispatchEvent(new GD(this.data.dblclickData)),clearTimeout(this.data.dblclickTimeout),this.data.dblclickTimeout=null,this.data.dblclickData=null):(this.viewer.dispatchEvent(new BD(u)),this.data.dblclickData=GL(u),this.data.dblclickTimeout=setTimeout(()=>{this.data.dblclickTimeout=null,this.data.dblclickData=null},rL))}}__handleObjectsEvents(t){if(!jL(this.state.objectsObservers)&&t.composedPath().includes(this.viewer.container)){const e=DL(this.viewer.container),n={x:t.clientX-e.x,y:t.clientY-e.y},i=this.viewer.renderer.getIntersections(n),r=(e,i,r)=>{this.viewer.dispatchEvent(new r(t,e,n,i))};for(const[t,s]of Object.entries(this.state.objectsObservers)){const e=i.find(e=>e.object.userData[t]);e?(s&&e.object!==s&&(r(s,t,UP),this.state.objectsObservers[t]=null),s?r(e.object,t,zP):(this.state.objectsObservers[t]=e.object,r(e.object,t,NP))):s&&(r(s,t,UP),this.state.objectsObservers[t]=null)}}}__doMove(t,e){if(this.step.is(FI.CLICK)&&this.__moveThresholdReached(t,e))this.viewer.stopAll(),this.__resetMove(),this.step.set(FI.MOVING),this.data.mouseX=t,this.data.mouseY=e,this.data.accumulatorFactor=this.config.moveInertia;else if(this.step.is(FI.MOVING)){const n=(t-this.data.mouseX)*Math.cos(this.state.roll)-(e-this.data.mouseY)*Math.sin(this.state.roll),i=(e-this.data.mouseY)*Math.cos(this.state.roll)+(t-this.data.mouseX)*Math.sin(this.state.roll),r={yaw:this.config.moveSpeed*(n/this.state.size.width)*SS.degToRad(this.state.hFov),pitch:this.config.moveSpeed*(i/this.state.size.height)*SS.degToRad(this.state.vFov)};this.data.moveDelta.yaw+=r.yaw,this.data.moveDelta.pitch+=r.pitch,this.data.mouseX=t,this.data.mouseY=e}}__moveThresholdReached(t,e){return Math.abs(t-this.data.startMouseX)>=this.moveThreshold||Math.abs(e-this.data.startMouseY)>=this.moveThreshold}__doMoveZoom(t){if(this.step.is(FI.MOVING)){t.preventDefault();const e=IL(t);this.__doMove(e.center.x,e.center.y),this.data.moveDelta.zoom+=this.config.zoomSpeed*((e.distance-this.data.pinchDist)/jP.pixelRatio),this.data.pinchDist=e.distance}}__applyMoveDelta(){const t=.001;if(Math.abs(this.data.moveDelta.yaw)>0||Math.abs(this.data.moveDelta.pitch)>0){const e=this.viewer.getPosition();this.viewer.rotate({yaw:e.yaw-this.data.moveDelta.yaw*(1-this.config.moveInertia),pitch:e.pitch+this.data.moveDelta.pitch*(1-this.config.moveInertia)}),this.data.moveDelta.yaw*=this.data.accumulatorFactor,this.data.moveDelta.pitch*=this.data.accumulatorFactor,Math.abs(this.data.moveDelta.yaw)<=t&&(this.data.moveDelta.yaw=0),Math.abs(this.data.moveDelta.pitch)<=t&&(this.data.moveDelta.pitch=0)}if(Math.abs(this.data.moveDelta.zoom)>0){const e=this.viewer.getZoomLevel();this.viewer.zoom(e+this.data.moveDelta.zoom*(1-this.config.moveInertia)),this.data.moveDelta.zoom*=this.config.moveInertia,Math.abs(this.data.moveDelta.zoom)<=t&&(this.data.moveDelta.zoom=0)}}__clearMoveDelta(){this.data.moveDelta.yaw=0,this.data.moveDelta.pitch=0,this.data.moveDelta.zoom=0}};zS.enabled=!1;var BI=new TS,zI=new RT,HI=new nT,VI=class extends DI{constructor(t){super(t),this.frustumNeedsUpdate=!0,this.renderer=new Zk(this.config.rendererParameters),this.renderer.setPixelRatio(jP.pixelRatio),this.renderer.outputColorSpace=Zw,this.renderer.toneMapping=1,this.renderer.domElement.className="psv-canvas",this.renderer.domElement.style.background=this.config.canvasBackground,this.scene=new yA,this.camera=new uA(50,16/9,.1,2*lL),this.camera.matrixAutoUpdate=!1;const e=new JM(new RA(lL).scale(-1,1,1),new TM({opacity:0,transparent:!0,depthTest:!1,depthWrite:!1}));e.userData={[cL]:!0},this.scene.add(e),this.raycaster=new hC,this.frustum=new MA,this.container=document.createElement("div"),this.container.className="psv-canvas-container",this.container.appendChild(this.renderer.domElement),this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",t=>t.preventDefault()),this.viewer.addEventListener(RP.type,this),this.viewer.addEventListener(PP.type,this),this.viewer.addEventListener(fP.type,this),this.viewer.addEventListener(mP.type,this),this.viewer.addEventListener(HD.type,this),this.hide()}get panoramaPose(){return this.mesh.rotation}get sphereCorrection(){return this.meshContainer.rotation}init(){this.show(),this.renderer.setAnimationLoop(t=>this.__renderLoop(t))}destroy(){this.renderer.setAnimationLoop(null),this.cleanScene(this.scene),this.renderer.dispose(),this.viewer.container.removeChild(this.container),this.viewer.removeEventListener(RP.type,this),this.viewer.removeEventListener(PP.type,this),this.viewer.removeEventListener(fP.type,this),this.viewer.removeEventListener(mP.type,this),this.viewer.removeEventListener(HD.type,this),super.destroy()}handleEvent(t){switch(t.type){case RP.type:this.__onSizeUpdated();break;case PP.type:this.__onZoomUpdated();break;case fP.type:case mP.type:this.__onPositionUpdated();break;case HD.type:t.containsOptions("fisheye")&&this.__onPositionUpdated(),t.containsOptions("canvasBackground")&&(this.renderer.domElement.style.background=this.config.canvasBackground)}}hide(){this.container.style.opacity="0"}show(){this.container.style.opacity="1"}setCustomRenderer(t){this.customRenderer=t?t(this.renderer):null,this.viewer.needsUpdate()}__onSizeUpdated(){this.renderer.setSize(this.state.size.width,this.state.size.height),this.camera.aspect=this.state.aspect,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onZoomUpdated(){this.camera.fov=this.state.vFov,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onPositionUpdated(){this.camera.position.set(0,0,0),this.camera.lookAt(this.state.direction),this.config.fisheye&&this.camera.position.copy(this.state.direction).multiplyScalar(this.config.fisheye/2).negate(),this.camera.rotateZ(-this.state.roll),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__renderLoop(t){const e=this.timestamp?t-this.timestamp:0;this.timestamp=t,this.viewer.dispatchEvent(new OD(t,e)),this.viewer.dynamics.update(e),(this.state.needsUpdate||this.state.continuousUpdateCount>0)&&(this.state.needsUpdate=!1,(this.customRenderer||this.renderer).render(this.scene,this.camera),this.viewer.dispatchEvent(new _P))}setTexture(t){this.meshContainer||(this.meshContainer=new mA,this.scene.add(this.meshContainer)),this.state.textureData&&this.viewer.adapter.disposeTexture(this.state.textureData),this.mesh&&(this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh)),this.mesh=this.viewer.adapter.createMesh(t.panoData),this.viewer.adapter.setTexture(this.mesh,t,!1),this.meshContainer.add(this.mesh),this.state.textureData=t,this.viewer.needsUpdate()}setPanoramaPose(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.mesh;const n=this.viewer.dataHelper.cleanPanoramaPose(t);e.rotation.set(n.tilt,n.pan,n.roll,"YXZ")}setSphereCorrection(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.meshContainer;const n=this.viewer.dataHelper.cleanSphereCorrection(t);e.rotation.set(n.tilt,n.pan,n.roll,"YXZ")}transition(t,e,n){const i="fade"===n.effect||n.rotation,r=!WL(e.position),s=!WL(e.zoom),a=new PD(r?this.viewer.dataHelper.cleanPosition(e.position):void 0,e.zoom);this.viewer.dispatchEvent(a);const o=new mA,l=this.viewer.adapter.createMesh(t.panoData);if(this.viewer.adapter.setTexture(l,t,!0),this.viewer.adapter.setTextureOpacity(l,0),this.setPanoramaPose(t.panoData,l),this.setSphereCorrection(e.sphereCorrection,o),r&&!n.rotation){const t=this.viewer.getPosition(),e=new AS(0,1,0);o.rotateOnWorldAxis(e,a.position.yaw-t.yaw);const n=new AS(0,1,0).cross(this.camera.getWorldDirection(new AS)).normalize();o.rotateOnWorldAxis(n,a.position.pitch-t.pitch)}o.add(l),this.scene.add(o),this.renderer.setRenderTarget(new $S),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null);const{duration:c,properties:u}=this.viewer.dataHelper.getAnimationProperties(n.speed,n.rotation?a.position:null,i?a.zoomLevel:null),h=new ED({properties:Rr(Rr({},u),{},{opacity:{start:0,end:1}}),duration:c,easing:"inOutCubic",onTick:t=>{switch(n.effect){case"fade":this.viewer.adapter.setTextureOpacity(l,t.opacity);break;case"black":case"white":t.opacity<.5?this.renderer.toneMappingExposure="black"===n.effect?SS.mapLinear(t.opacity,0,.5,1,0):SS.mapLinear(t.opacity,0,.5,1,5):(this.renderer.toneMappingExposure="black"===n.effect?SS.mapLinear(t.opacity,.5,1,0,1):SS.mapLinear(t.opacity,.5,1,5,1),this.mesh.visible=!1,this.viewer.adapter.setTextureOpacity(l,1),s&&!i&&this.viewer.dynamics.zoom.setValue(a.zoomLevel))}r&&n.rotation&&this.viewer.dynamics.position.setValue({yaw:t.yaw,pitch:t.pitch}),s&&i&&this.viewer.dynamics.zoom.setValue(t.zoom),this.viewer.needsUpdate()}});return h.then(i=>{o.remove(l),this.scene.remove(o),i?(this.viewer.adapter.disposeTexture(this.state.textureData),this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh),this.mesh=l,this.meshContainer.add(l),this.state.textureData=t,this.setPanoramaPose(t.panoData),this.setSphereCorrection(e.sphereCorrection),r&&!n.rotation&&this.viewer.rotate(e.position)):(this.viewer.adapter.disposeTexture(t),this.viewer.adapter.disposeMesh(l))}),h}getIntersections(t){var e;BI.x=2*t.x/this.state.size.width-1,BI.y=-2*t.y/this.state.size.height+1,this.raycaster.setFromCamera(BI,this.camera);const n=this.raycaster.intersectObjects(this.scene.children,!0).filter(t=>t.object.visible).filter(t=>t.object.isMesh&&!!t.object.userData);return null!==(e=this.customRenderer)&&void 0!==e&&e.getIntersections&&n.push(...this.customRenderer.getIntersections(this.raycaster,BI)),n}isObjectVisible(t){if(!t)return!1;if(this.frustumNeedsUpdate&&(zI.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.frustum.setFromProjectionMatrix(zI),this.frustumNeedsUpdate=!1),t.isVector3)return this.frustum.containsPoint(t);if(t.isMesh&&t.geometry){const e=t;return e.geometry.boundingBox||e.geometry.computeBoundingBox(),HI.copy(e.geometry.boundingBox).applyMatrix4(e.matrixWorld),this.frustum.intersectsBox(HI)}return!!t.isObject3D&&this.frustum.intersectsObject(t)}addObject(t){this.scene.add(t)}removeObject(t){this.scene.remove(t)}cleanScene(t){const e=t=>{var e;null===(e=t.map)||void 0===e||e.dispose(),t.uniforms&&Object.values(t.uniforms).forEach(t=>{var e,n;null===(e=t.value)||void 0===e||null===(n=e.dispose)||void 0===n||n.call(e)}),t.dispose()};t.traverse(n=>{var i,r;(null===(i=n.geometry)||void 0===i||i.dispose(),n.material&&(Array.isArray(n.material)?n.material.forEach(t=>{e(t)}):e(n.material)),n instanceof yA)||(null===(r=n.dispose)||void 0===r||r.call(n));n!==t&&this.cleanScene(n)})}},GI=class extends tC{constructor(){super(...arguments),this._abortController=new AbortController}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}load(t,e,n,i){const r=this._abortController.signal,s=super.load(t,t=>{o(),e(t)},n,t=>{if(o(),r.aborted){const t=new Error;t.name="AbortError",t.message="The operation was aborted.",i(t)}else i(t)});function a(){s.src=""}function o(){r.removeEventListener("abort",a,!1)}return r.addEventListener("abort",a,!1),s}},jI=class extends DI{constructor(t){super(t),this.fileLoader=new JA,this.fileLoader.setResponseType("blob"),this.imageLoader=new GI}destroy(){this.abortLoading(),super.destroy()}abortLoading(){var t,e;null===(t=(e=this.fileLoader).abort)||void 0===t||t.call(e),this.imageLoader.abort()}loadFile(t,e,n){const i=TI.get(t,n);if(i){if(i instanceof Blob)return null===e||void 0===e||e(100),Promise.resolve(i);TI.remove(t,n)}this.config.requestHeaders&&this.fileLoader.setRequestHeader(this.config.requestHeaders(t)),this.fileLoader.setWithCredentials(this.config.withCredentials(t));let r=0;return null===e||void 0===e||e(r),this.fileLoader.loadAsync(t,t=>{if(t.lengthComputable){const n=t.loaded/t.total*100;n>r&&(r=n,null===e||void 0===e||e(r))}}).then(i=>(r=100,null===e||void 0===e||e(r),TI.add(t,n,i),i))}loadImage(t,e,n){const i=TI.get(t,n);return i?(null===e||void 0===e||e(100),i instanceof Blob?this.blobToImage(i):Promise.resolve(i)):e||this.config.requestHeaders?this.loadFile(t,e,n).then(t=>this.blobToImage(t)):(this.imageLoader.setWithCredentials(this.config.withCredentials(t)),this.imageLoader.loadAsync(t).then(e=>(TI.add(t,n,e),e)))}blobToImage(t){return new Promise((e,n)=>{const i=document.createElement("img");i.onload=()=>{URL.revokeObjectURL(i.src),e(i)},i.onerror=n,i.src=URL.createObjectURL(t)})}preloadPanorama(t){return this.viewer.adapter.supportsPreload(t)?this.viewer.adapter.loadTexture(t,!1):Promise.reject(new qL("Current adapter does not support preload"))}dispatchProgress(t){this.viewer.loader.setProgress(t),this.viewer.dispatchEvent(new iP(Math.round(t)))}},WI=class extends DI{constructor(t){super(t),this.zoom=new wD(t=>{this.viewer.state.vFov=this.viewer.dataHelper.zoomLevelToFov(t),this.viewer.state.hFov=this.viewer.dataHelper.vFovToHFov(this.viewer.state.vFov),this.viewer.dispatchEvent(new PP(t))},{defaultValue:this.viewer.config.defaultZoomLvl,min:0,max:100,wrap:!1}),this.position=new SD(t=>{this.viewer.dataHelper.sphericalCoordsToVector3(t,this.viewer.state.direction),this.viewer.dispatchEvent(new fP(t))},{yaw:new wD(null,{defaultValue:this.config.defaultYaw,min:0,max:2*Math.PI,wrap:!0}),pitch:new wD(null,{defaultValue:this.config.defaultPitch,min:-Math.PI/2,max:Math.PI/2,wrap:!1})}),this.roll=new wD(t=>{this.viewer.state.roll=t,this.viewer.dispatchEvent(new mP(t))},{defaultValue:0,min:-Math.PI,max:Math.PI,wrap:!1}),this.updateSpeeds()}updateSpeeds(){this.zoom.setSpeed(50*this.config.zoomSpeed),this.position.setSpeed(SS.degToRad(50*this.config.moveSpeed)),this.roll.setSpeed(SS.degToRad(50*this.config.moveSpeed))}update(t){this.zoom.update(t),this.position.update(t),this.roll.update(t)}},YI=class{constructor(){this.ready=!1,this.needsUpdate=!1,this.continuousUpdateCount=0,this.keyboardEnabled=!1,this.direction=new AS(0,0,lL),this.roll=0,this.vFov=60,this.hFov=60,this.aspect=1,this.animation=null,this.transitionAnimation=null,this.loadingPromise=null,this.idleTime=-1,this.objectsObservers={},this.size={width:0,height:0}}},XI=class extends kD{constructor(t){var e,n;if(super(),this.plugins={},this.children=[],this.parent=SL(t.container),!this.parent)throw new qL('"container" element not found.');this.parent[cL]=this,this.container=document.createElement("div"),this.container.classList.add("psv-container"),this.parent.appendChild(this.container),bD(this.parent),yD(this.container,"core"),this.state=new YI,this.config=_I(t),this.__setSize(this.config.size),this.overlay=new CI(this);try{jP.load()}catch(Yq){return console.error(Yq),void this.showError(this.config.lang.webglError)}TI.init(),this.adapter=new this.config.adapter[0](this,this.config.adapter[1]),this.renderer=new VI(this),this.textureLoader=new jI(this),this.eventsHandler=new UI(this),this.dataHelper=new OI(this),this.dynamics=new WI(this),null===(e=(n=this.adapter).init)||void 0===e||e.call(n),this.loader=new MI(this),this.navbar=new SI(this),this.panel=new kI(this),this.notification=new AI(this),this.autoSize(),this.setCursor(null),QL(jP.isTouchEnabled,t=>{TL(this.container,"psv--is-touch",t)}),this.config.plugins.forEach(t=>{let[e,n]=t;this.plugins[e.id]=new e(this,n)});for(const r of Object.values(this.plugins)){var i;null===(i=r.init)||void 0===i||i.call(r)}this.config.navbar&&this.navbar.setButtons(this.config.navbar),this.state.loadingPromise||(this.config.panorama?this.setPanorama(this.config.panorama,{sphereCorrection:this.config.sphereCorrection,panoData:this.config.panoData}):this.loader.show())}destroy(){var t,e,n,i,r,s;this.stopAll(),this.stopKeyboardControl(),this.exitFullscreen();for(const[a,o]of Object.entries(this.plugins))o.destroy(),delete this.plugins[a];this.children.slice().forEach(t=>t.destroy()),this.children.length=0,null===(t=this.eventsHandler)||void 0===t||t.destroy(),null===(e=this.renderer)||void 0===e||e.destroy(),null===(n=this.textureLoader)||void 0===n||n.destroy(),null===(i=this.dataHelper)||void 0===i||i.destroy(),null===(r=this.adapter)||void 0===r||r.destroy(),null===(s=this.dynamics)||void 0===s||s.destroy(),this.parent.removeChild(this.container),delete this.parent[cL]}init(){this.eventsHandler.init(),this.renderer.init(),this.config.navbar&&this.navbar.show(),"always"===this.config.keyboard&&this.startKeyboardControl(),this.resetIdleTimer(),this.state.ready=!0,this.dispatchEvent(new vP)}resetIdleTimer(){this.state.idleTime=performance.now()}disableIdleTimer(){this.state.idleTime=-1}getPlugin(t){if("string"===typeof t)return this.plugins[t];{const e=mI(t);return e?this.plugins[e.id]:null}}getPosition(){return this.dataHelper.cleanPosition(this.dynamics.position.current)}getZoomLevel(){return this.dynamics.zoom.current}getSize(){return Rr({},this.state.size)}isFullscreenEnabled(){return OL(this.parent,jP.isIphone)}needsUpdate(){this.state.needsUpdate=!0}needsContinuousUpdate(t){t?this.state.continuousUpdateCount++:this.state.continuousUpdateCount>0&&this.state.continuousUpdateCount--}autoSize(){this.container.clientWidth===this.state.size.width&&this.container.clientHeight===this.state.size.height||(this.state.size.width=Math.round(this.container.clientWidth),this.state.size.height=Math.round(this.container.clientHeight),this.state.aspect=this.state.size.width/this.state.size.height,this.state.hFov=this.dataHelper.vFovToHFov(this.state.vFov),this.dispatchEvent(new RP(this.getSize())),this.navbar.autoSize())}setPanorama(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.textureLoader.abortLoading(),null===(e=this.state.transitionAnimation)||void 0===e||e.cancel();const i=this.dataHelper.getTransitionOptions(n);void 0===n.showLoader&&(n.showLoader=!0),void 0===n.caption&&(n.caption=this.config.caption),void 0===n.description&&(n.description=this.config.description),n.panoData||"function"!==typeof this.config.panoData||(n.panoData=this.config.panoData),this.hideError(),this.resetIdleTimer(),this.config.panorama=t,this.config.caption=n.caption,this.config.description=n.description,this.config.sphereCorrection=n.sphereCorrection,"function"===typeof this.config.panoData&&"function"!==typeof n.panoData||(this.config.panoData=n.panoData);const r=e=>{if($L(e))return!1;if(this.loader.hide(),this.state.loadingPromise=null,e)throw this.navbar.setCaption(null),this.showError(this.config.lang.loadError),console.error(e),this.dispatchEvent(new cP(t,e)),e;return this.navbar.setCaption(this.config.caption),!0};this.navbar.setCaption("<em>".concat(this.config.lang.loading,"</em>")),!n.showLoader&&this.state.ready||this.loader.show(),this.dispatchEvent(new sP(t));const s=this.adapter.loadTexture(this.config.panorama,!0,n.panoData).then(t=>{if(t.panorama!==this.config.panorama)throw this.adapter.disposeTexture(t),JL();const e=this.dataHelper.cleanPanoramaOptions(n,t.panoData);return WL(e.zoom)&&WL(e.position)||this.stopAll(),{textureData:t,cleanOptions:e}});return i&&this.state.ready&&this.adapter.supportsTransition(this.config.panorama)?this.state.loadingPromise=s.then(t=>{let{textureData:e,cleanOptions:n}=t;return this.loader.hide(),this.dispatchEvent(new oP(e)),this.state.transitionAnimation=this.renderer.transition(e,n,i),this.state.transitionAnimation}).then(t=>{if(this.state.transitionAnimation=null,this.dispatchEvent(new hP(t)),!t)throw JL()}).then(()=>r(),t=>r(t)):this.state.loadingPromise=s.then(t=>{let{textureData:e,cleanOptions:i}=t;this.renderer.show(),this.renderer.setTexture(e),this.renderer.setPanoramaPose(e.panoData),this.renderer.setSphereCorrection(n.sphereCorrection),this.state.ready||this.init(),this.dispatchEvent(new oP(e)),WL(i.zoom)||this.zoom(i.zoom),WL(i.position)||this.rotate(i.position)}).then(()=>r(),t=>r(t)),this.state.loadingPromise}setOptions(t){const e=Rr(Rr({},this.config),t);for(let[n,i]of Object.entries(t))if(n in gI)if(n in vI)tD(vI[n]);else switch(n in yI&&(i=yI[n](i,{rawConfig:e,defValue:gI[n]})),this.config[n]=i,n){case"mousemove":this.state.cursorOverride||this.setCursor(null);break;case"caption":this.navbar.setCaption(this.config.caption);break;case"size":this.resize(this.config.size);break;case"sphereCorrection":this.renderer.setSphereCorrection(this.config.sphereCorrection);break;case"navbar":case"lang":this.navbar.setButtons(this.config.navbar);break;case"moveSpeed":case"zoomSpeed":this.dynamics.updateSpeeds();break;case"minFov":case"maxFov":this.dynamics.zoom.setValue(this.dataHelper.fovToZoomLevel(this.state.vFov)),this.dispatchEvent(new PP(this.getZoomLevel()));break;case"keyboard":"always"===this.config.keyboard?this.startKeyboardControl():this.stopKeyboardControl()}else tD("Unknown option ".concat(n));this.needsUpdate(),this.dispatchEvent(new HD(Object.keys(t)))}setOption(t,e){this.setOptions({[t]:e})}showError(t){this.overlay.show({id:dL.ERROR,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="15 15 70 70"><path fill="currentColor" d="M50,16.2c-18.6,0-33.8,15.1-33.8,33.8S31.4,83.7,50,83.7S83.8,68.6,83.8,50S68.6,16.2,50,16.2z M50,80.2c-16.7,0-30.2-13.6-30.2-30.2S33.3,19.7,50,19.7S80.3,33.3,80.3,50S66.7,80.2,50,80.2z"/><rect fill="currentColor" x="48" y="31.7" width="4" height="28"/><rect fill="currentColor" x="48" y="63.2" width="4" height="5"/>\x3c!--Created by Shastry from the Noun Project--\x3e</svg>\n',title:t,dismissible:!1})}hideError(){this.overlay.hide(dL.ERROR)}rotate(t){const e=new FD(this.dataHelper.cleanPosition(t));this.dispatchEvent(e),e.defaultPrevented||this.dynamics.position.setValue(e.position)}zoom(t){this.dynamics.zoom.setValue(t)}zoomIn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.dynamics.zoom.step(t)}zoomOut(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.dynamics.zoom.step(-t)}animate(t){const e=eD(t),n=!WL(t.zoom),i=new PD(e?this.dataHelper.cleanPosition(t):void 0,t.zoom);if(this.dispatchEvent(i),i.defaultPrevented)return;this.stopAll();const{duration:r,properties:s}=this.dataHelper.getAnimationProperties(t.speed,i.position,i.zoomLevel);return r?(this.state.animation=new ED({properties:s,duration:r,easing:t.easing||"inOutSine",onTick:t=>{e&&this.dynamics.position.setValue({yaw:t.yaw,pitch:t.pitch}),n&&this.dynamics.zoom.setValue(t.zoom)}}),this.state.animation.then(()=>{this.state.animation=null,this.resetIdleTimer()}),this.state.animation):(e&&this.rotate(i.position),n&&this.zoom(i.zoomLevel),new ED(null))}stopAnimation(){return this.state.animation?(this.state.animation.cancel(),this.state.animation):Promise.resolve()}resize(t){this.__setSize(t),this.autoSize()}__setSize(t){["width","height"].forEach(e=>{null!==t&&void 0!==t&&t[e]&&(/^[0-9.]+$/.test(t[e])&&(t[e]+="px"),this.parent.style[e]=t[e])})}enterFullscreen(){this.isFullscreenEnabled()||NL(this.parent,jP.isIphone)}exitFullscreen(){this.isFullscreenEnabled()&&FL(jP.isIphone)}toggleFullscreen(){this.isFullscreenEnabled()?this.exitFullscreen():this.enterFullscreen()}startKeyboardControl(){this.state.keyboardEnabled=!0}stopKeyboardControl(){this.state.keyboardEnabled=!1}createTooltip(t){return new LI(this,t)}setCursor(t){this.state.cursorOverride=t,this.container.style.cursor=t||(this.config.mousemove?"move":"default")}observeObjects(t){this.state.objectsObservers[t]||(this.state.objectsObservers[t]=null)}unobserveObjects(t){delete this.state.objectsObservers[t]}stopAll(){return this.dispatchEvent(new LP),this.disableIdleTimer(),this.stopAnimation()}};function KI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qI={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,n="~";function i(){}function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(t,e,i,s,a){if("function"!==typeof i)throw new TypeError("The listener must be a function");var o=new r(i,s||t,a),l=n?n+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],o]:t._events[l].push(o):(t._events[l]=o,t._eventsCount++),t}function a(t,e){0===--t._eventsCount?t._events=new i:delete t._events[e]}function o(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),o.prototype.eventNames=function(){var t,i,r=[];if(0===this._eventsCount)return r;for(i in t=this._events)e.call(t,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},o.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,a=new Array(s);r<s;r++)a[r]=i[r].fn;return a},o.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},o.prototype.emit=function(t,e,i,r,s,a){var o=n?n+t:t;if(!this._events[o])return!1;var l,c,u=this._events[o],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,r),!0;case 5:return u.fn.call(u.context,e,i,r,s),!0;case 6:return u.fn.call(u.context,e,i,r,s,a),!0}for(c=1,l=new Array(h-1);c<h;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var d,f=u.length;for(c=0;c<f;c++)switch(u[c].once&&this.removeListener(t,u[c].fn,void 0,!0),h){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,e);break;case 3:u[c].fn.call(u[c].context,e,i);break;case 4:u[c].fn.call(u[c].context,e,i,r);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];u[c].fn.apply(u[c].context,l)}}return!0},o.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},o.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},o.prototype.removeListener=function(t,e,i,r){var s=n?n+t:t;if(!this._events[s])return this;if(!e)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==e||r&&!o.once||i&&o.context!==i||a(this,s);else{for(var l=0,c=[],u=o.length;l<u;l++)(o[l].fn!==e||r&&!o[l].once||i&&o[l].context!==i)&&c.push(o[l]);c.length?this._events[s]=1===c.length?c[0]:c:a(this,s)}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&a(this,e)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o}(qI);var QI=new(KI(qI.exports)),ZI={on:function(t,e){return QI.on(t,e)},once:function(t,e){return QI.once(t,e)},off:function(t,e){return QI.off(t,e)},emit:function(t,e){return QI.emit(t,e)}};Object.freeze(ZI);var JI=["src","height","width","hideNavbarButton","containerClass","littlePlanet","onPositionChange","onZoomChange","onClick","onDblclick","onReady"],$I=["zoom","fullscreen"];function tO(t){return null==t?$I:Array.isArray(t)?t:"string"===typeof t?""!==t&&[t]:!!t&&$I}var eO=(0,i.forwardRef)(function(t,e){var n=function(){var t=eE((0,i.useState)(),2),e=t[0],n=t[1],r=(0,i.useCallback)(function(t){t&&t!==e&&n(t)},[e]);return[e,r]}(),r=eE(n,2),s=r[0],a=r[1],o=(0,i.useMemo)(function(){return t},[t.panorama,t.src,t.size,t.canvasBackground,t.navbar,t.height,t.width,t.containerClass,t.hideNavbarButton||!0,t.littlePlanet,t.fishEye,t.lang,t.onPositionChange,t.onZoomChange,t.onClick,t.onDblclick,t.onReady,t.moveSpeed,t.zoomSpeed,t.moveInertia,t.mousewheel,t.mousemove,t.mousewheelCtrlKey,t.touchmoveTwoFingers,t.panoData,t.requestHeaders,t.withCredentials,t.keyboard,t.keyboardActions,t.plugins,t.adapter,t.sphereCorrection,t.minFov,t.maxFov,t.defaultZoomLvl,t.defaultYaw,t.defaultPitch,t.caption,t.description,t.downloadUrl,t.downloadName,t.loadingImg,t.loadingTxt,t.rendererParameters,t.defaultTransition]),l=(0,i.useRef)(null),c=130,u=eE((0,i.useState)(-90),1)[0],h=eE((0,i.useState)(2),1)[0],d=eE((0,i.useState)(0),1)[0],f=eE((0,i.useState)($I),2),p=f[0],m=f[1],g=(0,i.useRef)(!0);(0,i.useEffect)(function(){function t(){var t,e,n=window.innerWidth/window.innerHeight;c=Math.floor((n-(t=.5))*(115-(e=140))/(1.8-t)+e)}return window.addEventListener("resize",t),t(),function(){return window.removeEventListener("resize",t)}},[]),(0,i.useEffect)(function(){if(s&&!l.current){var e,n,i,r,a,f,p,v,y,_=new XI(tE(tE({},function(t){var e=tE({},t);for(var n in e)JI.includes(n)&&delete e[n];return e}(o)),{},{container:s,panorama:o.panorama||o.src,size:{height:o.height,width:o.width||"100px"},fisheye:o.littlePlanet?h:o.fisheye||!1,minFov:null!==(e=o.minFov)&&void 0!==e?e:30,maxFov:o.littlePlanet?c:null!==(n=o.maxFov)&&void 0!==n?n:90,defaultZoomLvl:o.littlePlanet?d:null!==(i=o.defaultZoomLvl)&&void 0!==i?i:50,defaultYaw:null!==(r=o.defaultYaw)&&void 0!==r?r:0,defaultPitch:o.littlePlanet?u:null!==(a=o.defaultPitch)&&void 0!==a?a:0,sphereCorrection:o.sphereCorrection||{pan:0,tilt:0,roll:0},moveSpeed:o.moveSpeed||1,zoomSpeed:o.zoomSpeed||1,moveInertia:null===(f=o.moveInertia)||void 0===f||f,mousewheel:!o.littlePlanet&&(null===(p=o.mousewheel)||void 0===p||p),mousemove:null===(v=o.mousemove)||void 0===v||v,mousewheelCtrlKey:o.mousewheelCtrlKey||!1,touchmoveTwoFingers:o.touchmoveTwoFingers||!1,panoData:o.panoData||void 0,requestHeaders:o.requestHeaders||void 0,withCredentials:o.withCredentials||!1,navbar:tO(o.navbar),lang:o.lang||{},keyboard:o.keyboard||"fullscreen",plugins:null!==(y=o.plugins)&&void 0!==y?y:[]}));_.addEventListener("ready",function(){o.onReady&&o.onReady(_)},{once:!0}),_.addEventListener("click",function(t){o.onClick&&o.onClick(t,_),o.littlePlanet&&g.current&&(g.current=!1,_.animate({yaw:0,pitch:u,zoom:75,speed:"3rpm"}).then(function(){_.animate({yaw:0,pitch:0,zoom:90,speed:"10rpm"}).then(function(){var t;_.setOption("maxFov",o.maxFov||70),_.setOption("mousewheel",null===(t=o.mousewheel)||void 0===t||t)})}))}),_.addEventListener("dblclick",function(t){o.onDblclick&&o.onDblclick(t,_)}),_.addEventListener("zoom-updated",function(t){o.onZoomChange&&o.onZoomChange(t,_)}),_.addEventListener("position-updated",function(t){o.onPositionChange&&o.onPositionChange(t.position.pitch,t.position.yaw,_)});var b=tO(o.navbar);if(o.littlePlanet){var x,E,w={id:"resetLittlePlanetButton",content:(null===(x=t.lang)||void 0===x?void 0:x.littlePlanetIcon)||'<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="none">\n                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 20C16.4183 20 20 16.4183 20 12C20 11.8805 19.9974 11.7615 19.9922 11.6433C20.2479 11.4141 20.4882 11.1864 20.7118 10.9611C21.0037 10.6672 21.002 10.1923 20.708 9.90049C20.4336 9.628 20.0014 9.61143 19.7077 9.84972C19.4023 8.75248 18.8688 7.75024 18.1616 6.89725C18.4607 6.84611 18.7436 6.8084 19.0087 6.784C19.4212 6.74604 19.7247 6.38089 19.6868 5.96842C19.6488 5.55595 19.2837 5.25235 18.8712 5.29032C18.4474 5.32932 17.9972 5.39638 17.5262 5.48921C17.3267 5.52851 17.1614 5.64353 17.0543 5.79852C15.6765 4.67424 13.917 4 12 4C7.58172 4 4 7.58172 4 12C4 12.2776 4.01414 12.552 4.04175 12.8223C3.78987 12.7532 3.50899 12.8177 3.31137 13.0159C2.97651 13.3517 2.67596 13.6846 2.415 14.0113C2.15647 14.3349 2.20924 14.8069 2.53287 15.0654C2.8565 15.3239 3.32843 15.2711 3.58696 14.9475C3.78866 14.695 4.02466 14.4302 4.2938 14.1557C4.60754 15.2796 5.16056 16.3037 5.8945 17.1697C5.66824 17.3368 5.54578 17.6248 5.60398 17.919C5.68437 18.3253 6.07894 18.5896 6.48528 18.5092C6.7024 18.4662 6.92455 18.4177 7.15125 18.3637C8.49656 19.3903 10.1771 20 12 20ZM7.15125 18.3637C6.69042 18.012 6.26891 17.6114 5.8945 17.1697C5.98073 17.106 6.08204 17.0599 6.19417 17.0377C7.19089 16.8405 8.33112 16.5084 9.55581 16.0486C9.94359 15.903 10.376 16.0994 10.5216 16.4872C10.6671 16.8749 10.4708 17.3073 10.083 17.4529C9.05325 17.8395 8.0653 18.1459 7.15125 18.3637ZM19.7077 9.84972C19.6869 9.86663 19.6667 9.88483 19.6474 9.90431C18.9609 10.5957 18.0797 11.3337 17.0388 12.0753C16.7014 12.3157 16.6228 12.784 16.8631 13.1213C17.1035 13.4587 17.5718 13.5373 17.9091 13.297C18.6809 12.7471 19.3806 12.1912 19.9922 11.6433C19.965 11.0246 19.8676 10.4241 19.7077 9.84972ZM20.9366 5.37924C20.5336 5.28378 20.1294 5.53313 20.034 5.93619C19.9385 6.33925 20.1879 6.74339 20.5909 6.83886C20.985 6.93219 21.1368 7.07125 21.1932 7.16142C21.2565 7.26269 21.3262 7.52732 21.0363 8.10938C20.8516 8.48014 21.0025 8.93042 21.3732 9.1151C21.744 9.29979 22.1943 9.14894 22.379 8.77818C22.7566 8.02003 22.9422 7.12886 22.4648 6.36582C22.1206 5.81574 21.5416 5.52252 20.9366 5.37924ZM2.81481 16.2501C2.94057 15.8555 2.72259 15.4336 2.32793 15.3078C1.93327 15.1821 1.51138 15.4 1.38562 15.7947C1.19392 16.3963 1.17354 17.0573 1.53488 17.6349C1.98775 18.3587 2.84153 18.6413 3.68907 18.7224C4.1014 18.7619 4.46765 18.4596 4.50712 18.0473C4.54658 17.635 4.24432 17.2687 3.83199 17.2293C3.13763 17.1628 2.88355 16.9624 2.80651 16.8393C2.75679 16.7598 2.70479 16.5954 2.81481 16.2501ZM15.7504 14.704C16.106 14.4915 16.2218 14.0309 16.0093 13.6754C15.7967 13.3199 15.3362 13.204 14.9807 13.4166C14.4991 13.7045 13.9974 13.9881 13.4781 14.2648C12.9445 14.5491 12.4132 14.8149 11.8883 15.0615C11.5134 15.2376 11.3522 15.6843 11.5283 16.0592C11.7044 16.4341 12.1511 16.5953 12.526 16.4192C13.0739 16.1618 13.6277 15.8847 14.1834 15.5887C14.7242 15.3005 15.2474 15.0048 15.7504 14.704Z" fill="rgba(255,255,255,.7)"/>\n                </svg>',title:(null===(E=t.lang)||void 0===E?void 0:E.littlePlanetButton)||"Reset Little Planet",className:"resetLittlePlanetButton",onClick:function(){g.current=!0,_.setOption("maxFov",c),_.setOption("mousewheel",!1),_.animate({yaw:0,pitch:u,zoom:d,speed:"10rpm"})}};!1===b||b.find(function(t){return"object"===nE(t)&&"resetLittlePlanetButton"===(null===t||void 0===t?void 0:t.id)})||b.splice(1,0,w)}if(o.hideNavbarButton){var S={id:"hideNavbarButton",content:'<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="none">\n                            <g clip-path="url(#clip0_429_11083)">\n                            <path d="M7 7.00006L17 17.0001M7 17.0001L17 7.00006" stroke="rgba(255,255,255,.7)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>\n                            </g>\n                            <defs>\n                            <clipPath id="clip0_429_11083">\n                            <rect width="24" height="24" fill="white"/>\n                            </clipPath>\n                            </defs>\n                            </svg>',title:"Hide Navbar",className:"hideNavbarButton",onClick:function(){_.navbar.hide();var t=document.createElement("a");t.className="showNavbarButton",t.innerHTML='<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 26 26" style="enable-background:new 0 0 26 26;" xml:space="preserve" class="icon icon-back-to-top">\n                                        <g>\n                                        <path d="M13.8,1.3L21.6,9c0.1,0.1,0.1,0.3,0.2,0.4c0.1,0.1,0.1,0.3,0.1,0.4s0,0.3-0.1,0.4c-0.1,0.1-0.1,0.3-0.3,0.4\n                                            c-0.1,0.1-0.2,0.2-0.4,0.3c-0.2,0.1-0.3,0.1-0.4,0.1c-0.1,0-0.3,0-0.4-0.1c-0.2-0.1-0.3-0.2-0.4-0.3L14.2,5l0,19.1\n                                            c0,0.2-0.1,0.3-0.1,0.5c0,0.1-0.1,0.3-0.3,0.4c-0.1,0.1-0.2,0.2-0.4,0.3c-0.1,0.1-0.3,0.1-0.5,0.1c-0.1,0-0.3,0-0.4-0.1\n                                            c-0.1-0.1-0.3-0.1-0.4-0.3c-0.1-0.1-0.2-0.2-0.3-0.4c-0.1-0.1-0.1-0.3-0.1-0.5l0-19.1l-5.7,5.7C6,10.8,5.8,10.9,5.7,11\n                                            c-0.1,0.1-0.3,0.1-0.4,0.1c-0.2,0-0.3,0-0.4-0.1c-0.1-0.1-0.3-0.2-0.4-0.3c-0.1-0.1-0.1-0.2-0.2-0.4C4.1,10.2,4,10.1,4.1,9.9\n                                            c0-0.1,0-0.3,0.1-0.4c0-0.1,0.1-0.3,0.3-0.4l7.7-7.8c0.1,0,0.2-0.1,0.2-0.1c0,0,0.1-0.1,0.2-0.1c0.1,0,0.2,0,0.2-0.1\n                                            c0.1,0,0.1,0,0.2,0c0,0,0.1,0,0.2,0c0.1,0,0.2,0,0.2,0.1c0.1,0,0.1,0.1,0.2,0.1C13.7,1.2,13.8,1.2,13.8,1.3z"></path>\n                                        </g>\n                                        </svg>',t.title="Show Navbar",t.onclick=function(e){e.preventDefault(),_.navbar.show(),t.remove()},document.body.appendChild(t)}};!1===b||b.find(function(t){return"object"===nE(t)&&"hideNavbarButton"===(null===t||void 0===t?void 0:t.id)})||b.push(S)}!1!==b?(_.setOption("navbar",b),m(b)):_.navbar.hide(),ZI.on("animate",function(t){_.animate(t)}).on("stop-animation",function(){_.stopAnimation()}).on("destroy",function(){_.destroy()}).on("rotate",function(t){_.rotate(t)}).on("setOption",function(t){var e=t.option,n=t.value;_.setOption(e,n)}).on("setOptions",function(t){_.setOptions(t)}).on("zoom",function(t){_.zoom(t)}).on("zoomIn",function(t){_.zoomIn(t)}).on("zoomOut",function(t){_.zoomOut(t)}).on("resize",function(t){_.resize(t)}).on("enterFullscreen",function(){_.enterFullscreen()}).on("exitFullscreen",function(){_.exitFullscreen()}).on("toggleFullscreen",function(){_.toggleFullscreen()}).on("needsContinuousUpdate",function(t){_.needsContinuousUpdate(t)}).on("observeObjects",function(t){_.observeObjects(t)}).on("unobserveObjects",function(t){_.unobserveObjects(t)}).on("setCursor",function(t){_.setCursor(t)}).on("setPanorama",function(t){_.setPanorama(t.path,t.options)}).on("showError",function(t){_.showError(t)}).on("hideError",function(){_.hideError()}).on("startKeyboardControl",function(){_.startKeyboardControl()}).on("stopKeyboardControl",function(){_.stopKeyboardControl()}),l.current=_}},[s,o]),(0,i.useEffect)(function(){var t,e,n,i,r=l.current;r&&r.container&&r.container.parentNode&&(r&&r.container&&r.container.parentNode&&(null===(t=r.renderer)||void 0===t||null===(e=t.renderer)||void 0===e||e.dispose(),null===(n=r.renderer)||void 0===n||null===(i=n.renderer)||void 0===i||i.forceContextLoss(),r.destroy()))},[l]),(0,i.useEffect)(function(){var t,e=null!==(t=o.panorama)&&void 0!==t?t:o.src;l.current&&e&&l.current.setPanorama(e,{})},[o.src,o.panorama]);return(0,i.useImperativeHandle)(e,function(){return{animate:function(t){ZI.emit("animate",t)},destroy:function(){ZI.emit("destroy",{})},createTooltip:function(t){var e;return null===(e=l.current)||void 0===e?void 0:e.createTooltip(t)},needsContinuousUpdate:function(t){ZI.emit("needsContinuousUpdate",t)},observeObjects:function(t){ZI.emit("observeObjects",t)},unobserveObjects:function(t){ZI.emit("unobserveObjects",t)},setCursor:function(t){ZI.emit("setCursor",t)},stopAnimation:function(){ZI.emit("stop-animation",{})},rotate:function(t){ZI.emit("rotate",t)},setOption:function(t,e){ZI.emit("setOption",{option:t,value:e})},setOptions:function(t){var e;return null===(e=l.current)||void 0===e?void 0:e.setOptions(t)},getCurrentNavbar:function(){return p},zoom:function(t){ZI.emit("zoom",t)},zoomIn:function(t){ZI.emit("zoomIn",{step:t})},zoomOut:function(t){ZI.emit("zoomOut",{step:t})},resize:function(t){var e;return null===(e=l.current)||void 0===e?void 0:e.resize(t)},enterFullscreen:function(){var t;return null===(t=l.current)||void 0===t?void 0:t.enterFullscreen()},exitFullscreen:function(){var t;return null===(t=l.current)||void 0===t?void 0:t.exitFullscreen()},toggleFullscreen:function(){var t;return null===(t=l.current)||void 0===t?void 0:t.toggleFullscreen()},isFullscreenEnabled:function(){var t;return null===(t=l.current)||void 0===t?void 0:t.isFullscreenEnabled()},getPlugin:function(t){var e;return null===(e=l.current)||void 0===e?void 0:e.getPlugin(t)},getPosition:function(){var t;return null===(t=l.current)||void 0===t?void 0:t.getPosition()},getZoomLevel:function(){var t;return null===(t=l.current)||void 0===t?void 0:t.getZoomLevel()},getSize:function(){var t;return null===(t=l.current)||void 0===t?void 0:t.getSize()},needsUpdate:function(){var t;return null===(t=l.current)||void 0===t?void 0:t.needsUpdate()},autoSize:function(){var t;return null===(t=l.current)||void 0===t?void 0:t.autoSize()},setPanorama:function(t,e){var n;return null===(n=l.current)||void 0===n?void 0:n.setPanorama(t,e)},showError:function(t){var e;return null===(e=l.current)||void 0===e?void 0:e.showError(t)},hideError:function(){var t;return null===(t=l.current)||void 0===t?void 0:t.hideError()},startKeyboardControl:function(){var t;return null===(t=l.current)||void 0===t?void 0:t.startKeyboardControl()},stopKeyboardControl:function(){var t;return null===(t=l.current)||void 0===t?void 0:t.stopKeyboardControl()}}},[l.current,s,o,e]),i.createElement("div",{className:o.containerClass||"view-container",ref:a})});eO.displayName="ReactPhotoSphereViewer";const nO=1e3,iO=1001,rO=1002,sO=1006,aO=1008,oO=1009,lO=1015,cO=1023,uO=2300,hO=2301,dO=2302,fO=2400,pO=2401,mO=2402,gO="srgb",vO="srgb-linear",yO="linear",_O="srgb",bO=7680,xO=35044,EO=2e3,wO=2001;Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function SO(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}const TO={};let MO=null;function AO(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i="THREE."+e.shift();MO?MO("warn",i,...e):console.warn(i,...e)}function CO(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i="THREE."+e.shift();MO?MO("error",i,...e):console.error(i,...e)}function RO(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.join(" ");i in TO||(TO[i]=!0,AO(...e))}class kO{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){const n=this._listeners;return void 0!==n&&(void 0!==n[t]&&-1!==n[t].indexOf(e))}removeEventListener(t,e){const n=this._listeners;if(void 0===n)return;const i=n[t];if(void 0!==i){const t=i.indexOf(e);-1!==t&&i.splice(t,1)}}dispatchEvent(t){const e=this._listeners;if(void 0===e)return;const n=e[t.type];if(void 0!==n){t.target=this;const e=n.slice(0);for(let n=0,i=e.length;n<i;n++)e[n].call(this,t);t.target=null}}}const LO=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let DO=1234567;const PO=Math.PI/180,IO=180/Math.PI;function OO(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(LO[255&t]+LO[t>>8&255]+LO[t>>16&255]+LO[t>>24&255]+"-"+LO[255&e]+LO[e>>8&255]+"-"+LO[e>>16&15|64]+LO[e>>24&255]+"-"+LO[63&n|128]+LO[n>>8&255]+"-"+LO[n>>16&255]+LO[n>>24&255]+LO[255&i]+LO[i>>8&255]+LO[i>>16&255]+LO[i>>24&255]).toLowerCase()}function NO(t,e,n){return Math.max(e,Math.min(n,t))}function FO(t,e){return(t%e+e)%e}function UO(t,e,n){return(1-n)*t+n*e}function BO(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function zO(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(4294967295*t);case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int32Array:return Math.round(2147483647*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}const HO={DEG2RAD:PO,RAD2DEG:IO,generateUUID:OO,clamp:NO,euclideanModulo:FO,mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},inverseLerp:function(t,e,n){return t!==e?(n-t)/(e-t):0},lerp:UO,damp:function(t,e,n,i){return UO(t,e,1-Math.exp(-n*i))},pingpong:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e-Math.abs(FO(t,2*e)-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){void 0!==t&&(DO=t);let e=DO+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function(t){return t*PO},radToDeg:function(t){return t*IO},isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,i,r){const s=Math.cos,a=Math.sin,o=s(n/2),l=a(n/2),c=s((e+i)/2),u=a((e+i)/2),h=s((e-i)/2),d=a((e-i)/2),f=s((i-e)/2),p=a((i-e)/2);switch(r){case"XYX":t.set(o*u,l*h,l*d,o*c);break;case"YZY":t.set(l*d,o*u,l*h,o*c);break;case"ZXZ":t.set(l*h,l*d,o*u,o*c);break;case"XZX":t.set(o*u,l*p,l*f,o*c);break;case"YXY":t.set(l*f,o*u,l*p,o*c);break;case"ZYZ":t.set(l*p,l*f,o*u,o*c);break;default:AO("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:zO,denormalize:BO};class VO{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;VO.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=NO(this.x,t.x,e.x),this.y=NO(this.y,t.y,e.y),this}clampScalar(t,e){return this.x=NO(this.x,t,e),this.y=NO(this.y,t,e),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(NO(n,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(NO(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,s=this.y-t.y;return this.x=r*n-s*i+t.x,this.y=r*i+s*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class GO{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=i}static slerpFlat(t,e,n,i,r,s,a){let o=n[i+0],l=n[i+1],c=n[i+2],u=n[i+3],h=r[s+0],d=r[s+1],f=r[s+2],p=r[s+3];if(a<=0)return t[e+0]=o,t[e+1]=l,t[e+2]=c,void(t[e+3]=u);if(a>=1)return t[e+0]=h,t[e+1]=d,t[e+2]=f,void(t[e+3]=p);if(u!==p||o!==h||l!==d||c!==f){let t=o*h+l*d+c*f+u*p;t<0&&(h=-h,d=-d,f=-f,p=-p,t=-t);let e=1-a;if(t<.9995){const n=Math.acos(t),i=Math.sin(n);e=Math.sin(e*n)/i,o=o*e+h*(a=Math.sin(a*n)/i),l=l*e+d*a,c=c*e+f*a,u=u*e+p*a}else{o=o*e+h*a,l=l*e+d*a,c=c*e+f*a,u=u*e+p*a;const t=1/Math.sqrt(o*o+l*l+c*c+u*u);o*=t,l*=t,c*=t,u*=t}}t[e]=o,t[e+1]=l,t[e+2]=c,t[e+3]=u}static multiplyQuaternionsFlat(t,e,n,i,r,s){const a=n[i],o=n[i+1],l=n[i+2],c=n[i+3],u=r[s],h=r[s+1],d=r[s+2],f=r[s+3];return t[e]=a*f+c*u+o*d-l*h,t[e+1]=o*f+c*h+l*u-a*d,t[e+2]=l*f+c*d+a*h-o*u,t[e+3]=c*f-a*u-o*h-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=t._x,i=t._y,r=t._z,s=t._order,a=Math.cos,o=Math.sin,l=a(n/2),c=a(i/2),u=a(r/2),h=o(n/2),d=o(i/2),f=o(r/2);switch(s){case"XYZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"YXZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"ZXY":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"ZYX":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"YZX":this._x=h*c*u+l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u-h*d*f;break;case"XZY":this._x=h*c*u-l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u+h*d*f;break;default:AO("Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],i=e[4],r=e[8],s=e[1],a=e[5],o=e[9],l=e[2],c=e[6],u=e[10],h=n+a+u;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(c-o)*t,this._y=(r-l)*t,this._z=(s-i)*t}else if(n>a&&n>u){const t=2*Math.sqrt(1+n-a-u);this._w=(c-o)/t,this._x=.25*t,this._y=(i+s)/t,this._z=(r+l)/t}else if(a>u){const t=2*Math.sqrt(1+a-n-u);this._w=(r-l)/t,this._x=(i+s)/t,this._y=.25*t,this._z=(o+c)/t}else{const t=2*Math.sqrt(1+u-n-a);this._w=(s-i)/t,this._x=(r+l)/t,this._y=(o+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<1e-8?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(NO(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,i=t._y,r=t._z,s=t._w,a=e._x,o=e._y,l=e._z,c=e._w;return this._x=n*c+s*a+i*l-r*o,this._y=i*c+s*o+r*a-n*l,this._z=r*c+s*l+n*o-i*a,this._w=s*c-n*a-i*o-r*l,this._onChangeCallback(),this}slerp(t,e){if(e<=0)return this;if(e>=1)return this.copy(t);let n=t._x,i=t._y,r=t._z,s=t._w,a=this.dot(t);a<0&&(n=-n,i=-i,r=-r,s=-s,a=-a);let o=1-e;if(a<.9995){const t=Math.acos(a),l=Math.sin(t);o=Math.sin(o*t)/l,e=Math.sin(e*t)/l,this._x=this._x*o+n*e,this._y=this._y*o+i*e,this._z=this._z*o+r*e,this._w=this._w*o+s*e,this._onChangeCallback()}else this._x=this._x*o+n*e,this._y=this._y*o+i*e,this._z=this._z*o+r*e,this._w=this._w*o+s*e,this.normalize();return this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(i*Math.sin(t),i*Math.cos(t),r*Math.sin(e),r*Math.cos(e))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class jO{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;jO.prototype.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(YO.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(YO.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=t.elements,s=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(t){const e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,a=t.z,o=t.w,l=2*(s*i-a*n),c=2*(a*e-r*i),u=2*(r*n-s*e);return this.x=e+o*l+s*u-a*c,this.y=n+o*c+a*l-r*u,this.z=i+o*u+r*c-s*l,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=NO(this.x,t.x,e.x),this.y=NO(this.y,t.y,e.y),this.z=NO(this.z,t.z,e.z),this}clampScalar(t,e){return this.x=NO(this.x,t,e),this.y=NO(this.y,t,e),this.z=NO(this.z,t,e),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(NO(n,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,i=t.y,r=t.z,s=e.x,a=e.y,o=e.z;return this.x=i*o-r*a,this.y=r*s-n*o,this.z=n*a-i*s,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return WO.copy(this).projectOnVector(t),this.sub(WO)}reflect(t){return this.sub(WO.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(NO(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,e=2*Math.random()-1,n=Math.sqrt(1-e*e);return this.x=n*Math.cos(t),this.y=e,this.z=n*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const WO=new jO,YO=new GO;class XO{constructor(t,e,n,i,r,s,a,o,l){XO.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,e,n,i,r,s,a,o,l)}set(t,e,n,i,r,s,a,o,l){const c=this.elements;return c[0]=t,c[1]=i,c[2]=a,c[3]=e,c[4]=r,c[5]=o,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,s=n[0],a=n[3],o=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],f=n[8],p=i[0],m=i[3],g=i[6],v=i[1],y=i[4],_=i[7],b=i[2],x=i[5],E=i[8];return r[0]=s*p+a*v+o*b,r[3]=s*m+a*y+o*x,r[6]=s*g+a*_+o*E,r[1]=l*p+c*v+u*b,r[4]=l*m+c*y+u*x,r[7]=l*g+c*_+u*E,r[2]=h*p+d*v+f*b,r[5]=h*m+d*y+f*x,r[8]=h*g+d*_+f*E,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],c=t[8];return e*s*c-e*a*l-n*r*c+n*a*o+i*r*l-i*s*o}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],c=t[8],u=c*s-a*l,h=a*o-c*r,d=l*r-s*o,f=e*u+n*h+i*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const p=1/f;return t[0]=u*p,t[1]=(i*l-c*n)*p,t[2]=(a*n-i*s)*p,t[3]=h*p,t[4]=(c*e-i*o)*p,t[5]=(i*r-a*e)*p,t[6]=d*p,t[7]=(n*o-l*e)*p,t[8]=(s*e-n*r)*p,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,r,s,a){const o=Math.cos(r),l=Math.sin(r);return this.set(n*o,n*l,-n*(o*s+l*a)+s+t,-i*l,i*o,-i*(-l*s+o*a)+a+e,0,0,1),this}scale(t,e){return this.premultiply(KO.makeScale(t,e)),this}rotate(t){return this.premultiply(KO.makeRotation(-t)),this}translate(t,e){return this.premultiply(KO.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const KO=new XO,qO=(new XO).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),QO=(new XO).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function ZO(){const t={enabled:!0,workingColorSpace:vO,spaces:{},convert:function(t,e,n){return!1!==this.enabled&&e!==n&&e&&n?(this.spaces[e].transfer===_O&&(t.r=$O(t.r),t.g=$O(t.g),t.b=$O(t.b)),this.spaces[e].primaries!==this.spaces[n].primaries&&(t.applyMatrix3(this.spaces[e].toXYZ),t.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===_O&&(t.r=tN(t.r),t.g=tN(t.g),t.b=tN(t.b)),t):t},workingToColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},colorSpaceToWorking:function(t,e){return this.convert(t,e,this.workingColorSpace)},getPrimaries:function(t){return this.spaces[t].primaries},getTransfer:function(t){return""===t?yO:this.spaces[t].transfer},getToneMappingMode:function(t){return this.spaces[t].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.workingColorSpace;return t.fromArray(this.spaces[e].luminanceCoefficients)},define:function(t){Object.assign(this.spaces,t)},_getMatrix:function(t,e,n){return t.copy(this.spaces[e].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(t){return this.spaces[t].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.workingColorSpace;return this.spaces[t].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(e,n){return RO("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),t.workingToColorSpace(e,n)},toWorkingColorSpace:function(e,n){return RO("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),t.colorSpaceToWorking(e,n)}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],i=[.3127,.329];return t.define({[vO]:{primaries:e,whitePoint:i,transfer:yO,toXYZ:qO,fromXYZ:QO,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:gO},outputColorSpaceConfig:{drawingBufferColorSpace:gO}},[gO]:{primaries:e,whitePoint:i,transfer:_O,toXYZ:qO,fromXYZ:QO,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:gO}}}),t}const JO=ZO();function $O(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function tN(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let eN;class nN{static getDataURL(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png";if(/^data:/i.test(t.src))return t.src;if("undefined"===typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)e=t;else{void 0===eN&&(eN=SO("canvas")),eN.width=t.width,eN.height=t.height;const n=eN.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=eN}return e.toDataURL(n)}static sRGBToLinear(t){if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap){const e=SO("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const i=n.getImageData(0,0,t.width,t.height),r=i.data;for(let t=0;t<r.length;t++)r[t]=255*$O(r[t]/255);return n.putImageData(i,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*$O(e[t]/255)):e[t]=$O(e[t]);return{data:e,width:t.width,height:t.height}}return AO("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let iN=0;class rN{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,Object.defineProperty(this,"id",{value:iN++}),this.uuid=OO(),this.data=t,this.dataReady=!0,this.version=0}getSize(t){const e=this.data;return"undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement?t.set(e.videoWidth,e.videoHeight,0):e instanceof VideoFrame?t.set(e.displayHeight,e.displayWidth,0):null!==e?t.set(e.width,e.height,e.depth||0):t.set(0,0,0),t}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let t;if(Array.isArray(i)){t=[];for(let e=0,n=i.length;e<n;e++)i[e].isDataTexture?t.push(sN(i[e].image)):t.push(sN(i[e]))}else t=sN(i);n.url=t}return e||(t.images[this.uuid]=n),n}}function sN(t){return"undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?nN.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(AO("Texture: Unable to serialize Texture."),{})}let aN=0;const oN=new jO;class lN extends kO{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lN.DEFAULT_IMAGE,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lN.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:iO,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:iO,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:sO,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:aO,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:cO,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:oO,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:lN.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"";super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:aN++}),this.uuid=OO(),this.name="",this.source=new rN(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new VO(0,0),this.repeat=new VO(1,1),this.center=new VO(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new XO,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(t&&t.depth&&t.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(oN).x}get height(){return this.source.getSize(oN).y}get depth(){return this.source.getSize(oN).z}get image(){return this.source.data}set image(t){void 0===t&&(t=null),this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.isArrayTexture=t.isArrayTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}setValues(t){for(const e in t){const n=t[e];if(void 0===n){AO("Texture.setValues(): parameter '".concat(e,"' has value of undefined."));continue}const i=this[e];void 0!==i?i&&n&&i.isVector2&&n.isVector2||i&&n&&i.isVector3&&n.isVector3||i&&n&&i.isMatrix3&&n.isMatrix3?i.copy(n):this[e]=n:AO("Texture.setValues(): property '".concat(e,"' does not exist."))}}toJSON(t){const e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case nO:t.x=t.x-Math.floor(t.x);break;case iO:t.x=t.x<0?0:1;break;case rO:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case nO:t.y=t.y-Math.floor(t.y);break;case iO:t.y=t.y<0?0:1;break;case rO:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){!0===t&&this.pmremVersion++}}lN.DEFAULT_IMAGE=null,lN.DEFAULT_MAPPING=300,lN.DEFAULT_ANISOTROPY=1;class cN{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;cN.prototype.isVector4=!0,this.x=t,this.y=e,this.z=n,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*e+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*e+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*e+s[7]*n+s[11]*i+s[15]*r,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,i,r;const s=.01,a=.1,o=t.elements,l=o[0],c=o[4],u=o[8],h=o[1],d=o[5],f=o[9],p=o[2],m=o[6],g=o[10];if(Math.abs(c-h)<s&&Math.abs(u-p)<s&&Math.abs(f-m)<s){if(Math.abs(c+h)<a&&Math.abs(u+p)<a&&Math.abs(f+m)<a&&Math.abs(l+d+g-3)<a)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,o=(d+1)/2,v=(g+1)/2,y=(c+h)/4,_=(u+p)/4,b=(f+m)/4;return t>o&&t>v?t<s?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(t),i=y/n,r=_/n):o>v?o<s?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(o),n=y/i,r=b/i):v<s?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(v),n=_/r,i=b/r),this.set(n,i,r,e),this}let v=Math.sqrt((m-f)*(m-f)+(u-p)*(u-p)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(m-f)/v,this.y=(u-p)/v,this.z=(h-c)/v,this.w=Math.acos((l+d+g-1)/2),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this.w=e[15],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=NO(this.x,t.x,e.x),this.y=NO(this.y,t.y,e.y),this.z=NO(this.z,t.z,e.z),this.w=NO(this.w,t.w,e.w),this}clampScalar(t,e){return this.x=NO(this.x,t,e),this.y=NO(this.y,t,e),this.z=NO(this.z,t,e),this.w=NO(this.w,t,e),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(NO(n,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class uN{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new jO(1/0,1/0,1/0),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new jO(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e+=3)this.expandByPoint(dN.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,n=t.count;e<n;e++)this.expandByPoint(dN.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=dN.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.updateWorldMatrix(!1,!1);const n=t.geometry;if(void 0!==n){const i=n.getAttribute("position");if(!0===e&&void 0!==i&&!0!==t.isInstancedMesh)for(let e=0,n=i.count;e<n;e++)!0===t.isMesh?t.getVertexPosition(e,dN):dN.fromBufferAttribute(i,e),dN.applyMatrix4(t.matrixWorld),this.expandByPoint(dN);else void 0!==t.boundingBox?(null===t.boundingBox&&t.computeBoundingBox(),fN.copy(t.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),fN.copy(n.boundingBox)),fN.applyMatrix4(t.matrixWorld),this.union(fN)}const i=t.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],e);return this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y&&t.max.z>=this.min.z&&t.min.z<=this.max.z}intersectsSphere(t){return this.clampPoint(t.center,dN),dN.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(bN),xN.subVectors(this.max,bN),pN.subVectors(t.a,bN),mN.subVectors(t.b,bN),gN.subVectors(t.c,bN),vN.subVectors(mN,pN),yN.subVectors(gN,mN),_N.subVectors(pN,gN);let e=[0,-vN.z,vN.y,0,-yN.z,yN.y,0,-_N.z,_N.y,vN.z,0,-vN.x,yN.z,0,-yN.x,_N.z,0,-_N.x,-vN.y,vN.x,0,-yN.y,yN.x,0,-_N.y,_N.x,0];return!!SN(e,pN,mN,gN,xN)&&(e=[1,0,0,0,1,0,0,0,1],!!SN(e,pN,mN,gN,xN)&&(EN.crossVectors(vN,yN),e=[EN.x,EN.y,EN.z],SN(e,pN,mN,gN,xN)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,dN).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=.5*this.getSize(dN).length()),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(hN[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),hN[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),hN[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),hN[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),hN[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),hN[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),hN[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),hN[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(hN)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(t){return this.min.fromArray(t.min),this.max.fromArray(t.max),this}}const hN=[new jO,new jO,new jO,new jO,new jO,new jO,new jO,new jO],dN=new jO,fN=new uN,pN=new jO,mN=new jO,gN=new jO,vN=new jO,yN=new jO,_N=new jO,bN=new jO,xN=new jO,EN=new jO,wN=new jO;function SN(t,e,n,i,r){for(let s=0,a=t.length-3;s<=a;s+=3){wN.fromArray(t,s);const a=r.x*Math.abs(wN.x)+r.y*Math.abs(wN.y)+r.z*Math.abs(wN.z),o=e.dot(wN),l=n.dot(wN),c=i.dot(wN);if(Math.max(-Math.max(o,l,c),Math.min(o,l,c))>a)return!1}return!0}const TN=new uN,MN=new jO,AN=new jO;class CN{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new jO,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.isSphere=!0,this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):TN.setFromPoints(t).getCenter(n);let i=0;for(let r=0,s=t.length;r<s;r++)i=Math.max(i,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;MN.subVectors(t,this.center);const e=MN.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.addScaledVector(MN,n/t),this.radius+=n}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(!0===this.center.equals(t.center)?this.radius=Math.max(this.radius,t.radius):(AN.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(MN.copy(t.center).add(AN)),this.expandByPoint(MN.copy(t.center).sub(AN))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(t){return this.radius=t.radius,this.center.fromArray(t.center),this}}const RN=new jO,kN=new jO,LN=new jO,DN=new jO,PN=new jO,IN=new jO,ON=new jO;class NN{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new jO,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new jO(0,0,-1);this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,RN)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=RN.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(RN.copy(this.origin).addScaledVector(this.direction,e),RN.distanceToSquared(t))}distanceSqToSegment(t,e,n,i){kN.copy(t).add(e).multiplyScalar(.5),LN.copy(e).sub(t).normalize(),DN.copy(this.origin).sub(kN);const r=.5*t.distanceTo(e),s=-this.direction.dot(LN),a=DN.dot(this.direction),o=-DN.dot(LN),l=DN.lengthSq(),c=Math.abs(1-s*s);let u,h,d,f;if(c>0)if(u=s*o-a,h=s*a-o,f=r*c,u>=0)if(h>=-f)if(h<=f){const t=1/c;u*=t,h*=t,d=u*(u+s*h+2*a)+h*(s*u+h+2*o)+l}else h=r,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h=-r,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h<=-f?(u=Math.max(0,-(-s*r+a)),h=u>0?-r:Math.min(Math.max(-r,-o),r),d=-u*u+h*(h+2*o)+l):h<=f?(u=0,h=Math.min(Math.max(-r,-o),r),d=h*(h+2*o)+l):(u=Math.max(0,-(s*r+a)),h=u>0?r:Math.min(Math.max(-r,-o),r),d=-u*u+h*(h+2*o)+l);else h=s>0?-r:r,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,u),i&&i.copy(kN).addScaledVector(LN,h),d}intersectSphere(t,e){RN.subVectors(t.center,this.origin);const n=RN.dot(this.direction),i=RN.dot(RN)-n*n,r=t.radius*t.radius;if(i>r)return null;const s=Math.sqrt(r-i),a=n-s,o=n+s;return o<0?null:a<0?this.at(o,e):this.at(a,e)}intersectsSphere(t){return!(t.radius<0)&&this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,i,r,s,a,o;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,i=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,i=(t.min.x-h.x)*l),c>=0?(r=(t.min.y-h.y)*c,s=(t.max.y-h.y)*c):(r=(t.max.y-h.y)*c,s=(t.min.y-h.y)*c),n>s||r>i?null:((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),u>=0?(a=(t.min.z-h.z)*u,o=(t.max.z-h.z)*u):(a=(t.max.z-h.z)*u,o=(t.min.z-h.z)*u),n>o||a>i?null:((a>n||n!==n)&&(n=a),(o<i||i!==i)&&(i=o),i<0?null:this.at(n>=0?n:i,e)))}intersectsBox(t){return null!==this.intersectBox(t,RN)}intersectTriangle(t,e,n,i,r){PN.subVectors(e,t),IN.subVectors(n,t),ON.crossVectors(PN,IN);let s,a=this.direction.dot(ON);if(a>0){if(i)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}DN.subVectors(this.origin,t);const o=s*this.direction.dot(IN.crossVectors(DN,IN));if(o<0)return null;const l=s*this.direction.dot(PN.cross(DN));if(l<0)return null;if(o+l>a)return null;const c=-s*DN.dot(ON);return c<0?null:this.at(c/a,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class FN{constructor(t,e,n,i,r,s,a,o,l,c,u,h,d,f,p,m){FN.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,e,n,i,r,s,a,o,l,c,u,h,d,f,p,m)}set(t,e,n,i,r,s,a,o,l,c,u,h,d,f,p,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=i,g[1]=r,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new FN).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,i=1/UN.setFromMatrixColumn(t,0).length(),r=1/UN.setFromMatrixColumn(t,1).length(),s=1/UN.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,n=t.x,i=t.y,r=t.z,s=Math.cos(n),a=Math.sin(n),o=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if("XYZ"===t.order){const t=s*c,n=s*u,i=a*c,r=a*u;e[0]=o*c,e[4]=-o*u,e[8]=l,e[1]=n+i*l,e[5]=t-r*l,e[9]=-a*o,e[2]=r-t*l,e[6]=i+n*l,e[10]=s*o}else if("YXZ"===t.order){const t=o*c,n=o*u,i=l*c,r=l*u;e[0]=t+r*a,e[4]=i*a-n,e[8]=s*l,e[1]=s*u,e[5]=s*c,e[9]=-a,e[2]=n*a-i,e[6]=r+t*a,e[10]=s*o}else if("ZXY"===t.order){const t=o*c,n=o*u,i=l*c,r=l*u;e[0]=t-r*a,e[4]=-s*u,e[8]=i+n*a,e[1]=n+i*a,e[5]=s*c,e[9]=r-t*a,e[2]=-s*l,e[6]=a,e[10]=s*o}else if("ZYX"===t.order){const t=s*c,n=s*u,i=a*c,r=a*u;e[0]=o*c,e[4]=i*l-n,e[8]=t*l+r,e[1]=o*u,e[5]=r*l+t,e[9]=n*l-i,e[2]=-l,e[6]=a*o,e[10]=s*o}else if("YZX"===t.order){const t=s*o,n=s*l,i=a*o,r=a*l;e[0]=o*c,e[4]=r-t*u,e[8]=i*u+n,e[1]=u,e[5]=s*c,e[9]=-a*c,e[2]=-l*c,e[6]=n*u+i,e[10]=t-r*u}else if("XZY"===t.order){const t=s*o,n=s*l,i=a*o,r=a*l;e[0]=o*c,e[4]=-u,e[8]=l*c,e[1]=t*u+r,e[5]=s*c,e[9]=n*u-i,e[2]=i*u-n,e[6]=a*c,e[10]=r*u+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(zN,t,HN)}lookAt(t,e,n){const i=this.elements;return jN.subVectors(t,e),0===jN.lengthSq()&&(jN.z=1),jN.normalize(),VN.crossVectors(n,jN),0===VN.lengthSq()&&(1===Math.abs(n.z)?jN.x+=1e-4:jN.z+=1e-4,jN.normalize(),VN.crossVectors(n,jN)),VN.normalize(),GN.crossVectors(jN,VN),i[0]=VN.x,i[4]=GN.x,i[8]=jN.x,i[1]=VN.y,i[5]=GN.y,i[9]=jN.y,i[2]=VN.z,i[6]=GN.z,i[10]=jN.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,s=n[0],a=n[4],o=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],b=n[15],x=i[0],E=i[4],w=i[8],S=i[12],T=i[1],M=i[5],A=i[9],C=i[13],R=i[2],k=i[6],L=i[10],D=i[14],P=i[3],I=i[7],O=i[11],N=i[15];return r[0]=s*x+a*T+o*R+l*P,r[4]=s*E+a*M+o*k+l*I,r[8]=s*w+a*A+o*L+l*O,r[12]=s*S+a*C+o*D+l*N,r[1]=c*x+u*T+h*R+d*P,r[5]=c*E+u*M+h*k+d*I,r[9]=c*w+u*A+h*L+d*O,r[13]=c*S+u*C+h*D+d*N,r[2]=f*x+p*T+m*R+g*P,r[6]=f*E+p*M+m*k+g*I,r[10]=f*w+p*A+m*L+g*O,r[14]=f*S+p*C+m*D+g*N,r[3]=v*x+y*T+_*R+b*P,r[7]=v*E+y*M+_*k+b*I,r[11]=v*w+y*A+_*L+b*O,r[15]=v*S+y*C+_*D+b*N,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],s=t[1],a=t[5],o=t[9],l=t[13],c=t[2],u=t[6],h=t[10],d=t[14];return t[3]*(+r*o*u-i*l*u-r*a*h+n*l*h+i*a*d-n*o*d)+t[7]*(+e*o*d-e*l*h+r*s*h-i*s*d+i*l*c-r*o*c)+t[11]*(+e*l*u-e*a*d-r*s*u+n*s*d+r*a*c-n*l*c)+t[15]*(-i*a*c-e*o*u+e*a*h+i*s*u-n*s*h+n*o*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15],v=u*m*l-p*h*l+p*o*d-a*m*d-u*o*g+a*h*g,y=f*h*l-c*m*l-f*o*d+s*m*d+c*o*g-s*h*g,_=c*p*l-f*u*l+f*a*d-s*p*d-c*a*g+s*u*g,b=f*u*o-c*p*o-f*a*h+s*p*h+c*a*m-s*u*m,x=e*v+n*y+i*_+r*b;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/x;return t[0]=v*E,t[1]=(p*h*r-u*m*r-p*i*d+n*m*d+u*i*g-n*h*g)*E,t[2]=(a*m*r-p*o*r+p*i*l-n*m*l-a*i*g+n*o*g)*E,t[3]=(u*o*r-a*h*r-u*i*l+n*h*l+a*i*d-n*o*d)*E,t[4]=y*E,t[5]=(c*m*r-f*h*r+f*i*d-e*m*d-c*i*g+e*h*g)*E,t[6]=(f*o*r-s*m*r-f*i*l+e*m*l+s*i*g-e*o*g)*E,t[7]=(s*h*r-c*o*r+c*i*l-e*h*l-s*i*d+e*o*d)*E,t[8]=_*E,t[9]=(f*u*r-c*p*r-f*n*d+e*p*d+c*n*g-e*u*g)*E,t[10]=(s*p*r-f*a*r+f*n*l-e*p*l-s*n*g+e*a*g)*E,t[11]=(c*a*r-s*u*r-c*n*l+e*u*l+s*n*d-e*a*d)*E,t[12]=b*E,t[13]=(c*p*i-f*u*i+f*n*h-e*p*h-c*n*m+e*u*m)*E,t[14]=(f*a*i-s*p*i-f*n*o+e*p*o+s*n*m-e*a*m)*E,t[15]=(s*u*i-c*a*i+c*n*o-e*u*o-s*n*h+e*a*h)*E,this}scale(t){const e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}makeTranslation(t,e,n){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),i=Math.sin(e),r=1-n,s=t.x,a=t.y,o=t.z,l=r*s,c=r*a;return this.set(l*s+n,l*a-i*o,l*o+i*a,0,l*a+i*o,c*a+n,c*o-i*s,0,l*o-i*a,c*o+i*s,r*o*o+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,i,r,s){return this.set(1,n,r,0,t,1,s,0,e,i,1,0,0,0,0,1),this}compose(t,e,n){const i=this.elements,r=e._x,s=e._y,a=e._z,o=e._w,l=r+r,c=s+s,u=a+a,h=r*l,d=r*c,f=r*u,p=s*c,m=s*u,g=a*u,v=o*l,y=o*c,_=o*u,b=n.x,x=n.y,E=n.z;return i[0]=(1-(p+g))*b,i[1]=(d+_)*b,i[2]=(f-y)*b,i[3]=0,i[4]=(d-_)*x,i[5]=(1-(h+g))*x,i[6]=(m+v)*x,i[7]=0,i[8]=(f+y)*E,i[9]=(m-v)*E,i[10]=(1-(h+p))*E,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,n){const i=this.elements;let r=UN.set(i[0],i[1],i[2]).length();const s=UN.set(i[4],i[5],i[6]).length(),a=UN.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],BN.copy(this);const o=1/r,l=1/s,c=1/a;return BN.elements[0]*=o,BN.elements[1]*=o,BN.elements[2]*=o,BN.elements[4]*=l,BN.elements[5]*=l,BN.elements[6]*=l,BN.elements[8]*=c,BN.elements[9]*=c,BN.elements[10]*=c,e.setFromRotationMatrix(BN),n.x=r,n.y=s,n.z=a,this}makePerspective(t,e,n,i,r,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:EO,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=this.elements,c=2*r/(e-t),u=2*r/(n-i),h=(e+t)/(e-t),d=(n+i)/(n-i);let f,p;if(o)f=r/(s-r),p=s*r/(s-r);else if(a===EO)f=-(s+r)/(s-r),p=-2*s*r/(s-r);else{if(a!==wO)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);f=-s/(s-r),p=-s*r/(s-r)}return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=u,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(t,e,n,i,r,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:EO,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=this.elements,c=2/(e-t),u=2/(n-i),h=-(e+t)/(e-t),d=-(n+i)/(n-i);let f,p;if(o)f=1/(s-r),p=s/(s-r);else if(a===EO)f=-2/(s-r),p=-(s+r)/(s-r);else{if(a!==wO)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);f=-1/(s-r),p=-r/(s-r)}return l[0]=c,l[4]=0,l[8]=0,l[12]=h,l[1]=0,l[5]=u,l[9]=0,l[13]=d,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const UN=new jO,BN=new FN,zN=new jO(0,0,0),HN=new jO(1,1,1),VN=new jO,GN=new jO,jN=new jO,WN=new FN,YN=new GO;class XN{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:XN.DEFAULT_ORDER;this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=t.elements,r=i[0],s=i[4],a=i[8],o=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(e){case"XYZ":this._y=Math.asin(NO(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-NO(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(NO(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,r));break;case"ZYX":this._y=Math.asin(-NO(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(o,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(NO(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-NO(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:AO("Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return WN.makeRotationFromQuaternion(t),this.setFromRotationMatrix(WN,e,n)}setFromVector3(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(t.x,t.y,t.z,e)}reorder(t){return YN.setFromEuler(this),this.setFromQuaternion(YN,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}XN.DEFAULT_ORDER="XYZ";class KN{constructor(){this.mask=1}set(t){this.mask=1<<t>>>0}enable(t){this.mask|=1<<t}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t}disable(t){this.mask&=~(1<<t)}disableAll(){this.mask=0}test(t){return 0!==(this.mask&t.mask)}isEnabled(t){return 0!==(this.mask&1<<t)}}let qN=0;const QN=new jO,ZN=new GO,JN=new FN,$N=new jO,tF=new jO,eF=new jO,nF=new GO,iF=new jO(1,0,0),rF=new jO(0,1,0),sF=new jO(0,0,1),aF={type:"added"},oF={type:"removed"},lF={type:"childadded",child:null},cF={type:"childremoved",child:null};class uF extends kO{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:qN++}),this.uuid=OO(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=uF.DEFAULT_UP.clone();const t=new jO,e=new XN,n=new GO,i=new jO(1,1,1);e._onChange(function(){n.setFromEuler(e,!1)}),n._onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new FN},normalMatrix:{value:new XO}}),this.matrix=new FN,this.matrixWorld=new FN,this.matrixAutoUpdate=uF.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=uF.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new KN,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return ZN.setFromAxisAngle(t,e),this.quaternion.multiply(ZN),this}rotateOnWorldAxis(t,e){return ZN.setFromAxisAngle(t,e),this.quaternion.premultiply(ZN),this}rotateX(t){return this.rotateOnAxis(iF,t)}rotateY(t){return this.rotateOnAxis(rF,t)}rotateZ(t){return this.rotateOnAxis(sF,t)}translateOnAxis(t,e){return QN.copy(t).applyQuaternion(this.quaternion),this.position.add(QN.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(iF,t)}translateY(t){return this.translateOnAxis(rF,t)}translateZ(t){return this.translateOnAxis(sF,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(JN.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?$N.copy(t):$N.set(t,e,n);const i=this.parent;this.updateWorldMatrix(!0,!1),tF.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?JN.lookAt(tF,$N,this.up):JN.lookAt($N,tF,this.up),this.quaternion.setFromRotationMatrix(JN),i&&(JN.extractRotation(i.matrixWorld),ZN.setFromRotationMatrix(JN),this.quaternion.premultiply(ZN.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(CO("Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(aF),lF.child=t,this.dispatchEvent(lF),lF.child=null):CO("Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(oF),cF.child=t,this.dispatchEvent(cF),cF.child=null),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),JN.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),JN.multiply(t.parent.matrixWorld)),t.applyMatrix4(JN),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(aF),lF.child=t,this.dispatchEvent(lF),lF.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}}getObjectsByProperty(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[t]===e&&n.push(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].getObjectsByProperty(t,e,n);return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(tF,t,eF),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(tF,nF,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,i=e.length;n<i;n++){e[n].updateMatrixWorld(t)}}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++){t[e].updateWorldMatrix(!1,!0)}}}toJSON(t){const e=void 0===t||"string"===typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const i={};function r(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map(t=>Rr(Rr({},t),{},{boundingBox:t.boundingBox?t.boundingBox.toJSON():void 0,boundingSphere:t.boundingSphere?t.boundingSphere.toJSON():void 0})),i.instanceInfo=this._instanceInfo.map(t=>Rr({},t)),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(t),i.indirectTexture=this._indirectTexture.toJSON(t),null!==this._colorsTexture&&(i.colorsTexture=this._colorsTexture.toJSON(t)),null!==this.boundingSphere&&(i.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(i.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,i=n.length;e<i;e++){const i=n[e];r(t.shapes,i)}else r(t.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,i=this.material.length;n<i;n++)e.push(r(t.materials,this.material[n]));i.material=e}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(let e=0;e<this.children.length;e++)i.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];i.animations.push(r(t.animations,n))}}if(e){const e=s(t.geometries),i=s(t.materials),r=s(t.textures),a=s(t.images),o=s(t.shapes),l=s(t.skeletons),c=s(t.animations),u=s(t.nodes);e.length>0&&(n.geometries=e),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),a.length>0&&(n.images=a),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=i,n;function s(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let n=0;n<t.children.length;n++){const e=t.children[n];this.add(e.clone())}return this}}uF.DEFAULT_UP=new jO(0,1,0),uF.DEFAULT_MATRIX_AUTO_UPDATE=!0,uF.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const hF=new jO,dF=new jO,fF=new jO,pF=new jO,mF=new jO,gF=new jO,vF=new jO,yF=new jO,_F=new jO,bF=new jO,xF=new cN,EF=new cN,wF=new cN;class SF{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new jO,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new jO,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new jO;this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,i){i.subVectors(n,e),hF.subVectors(t,e),i.cross(hF);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(t,e,n,i,r){hF.subVectors(i,e),dF.subVectors(n,e),fF.subVectors(t,e);const s=hF.dot(hF),a=hF.dot(dF),o=hF.dot(fF),l=dF.dot(dF),c=dF.dot(fF),u=s*l-a*a;if(0===u)return r.set(0,0,0),null;const h=1/u,d=(l*o-a*c)*h,f=(s*c-a*o)*h;return r.set(1-d-f,f,d)}static containsPoint(t,e,n,i){return null!==this.getBarycoord(t,e,n,i,pF)&&(pF.x>=0&&pF.y>=0&&pF.x+pF.y<=1)}static getInterpolation(t,e,n,i,r,s,a,o){return null===this.getBarycoord(t,e,n,i,pF)?(o.x=0,o.y=0,"z"in o&&(o.z=0),"w"in o&&(o.w=0),null):(o.setScalar(0),o.addScaledVector(r,pF.x),o.addScaledVector(s,pF.y),o.addScaledVector(a,pF.z),o)}static getInterpolatedAttribute(t,e,n,i,r,s){return xF.setScalar(0),EF.setScalar(0),wF.setScalar(0),xF.fromBufferAttribute(t,e),EF.fromBufferAttribute(t,n),wF.fromBufferAttribute(t,i),s.setScalar(0),s.addScaledVector(xF,r.x),s.addScaledVector(EF,r.y),s.addScaledVector(wF,r.z),s}static isFrontFacing(t,e,n,i){return hF.subVectors(n,e),dF.subVectors(t,e),hF.cross(dF).dot(i)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,n,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,i),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return hF.subVectors(this.c,this.b),dF.subVectors(this.a,this.b),.5*hF.cross(dF).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return SF.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return SF.getBarycoord(t,this.a,this.b,this.c,e)}getInterpolation(t,e,n,i,r){return SF.getInterpolation(t,this.a,this.b,this.c,e,n,i,r)}containsPoint(t){return SF.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return SF.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,i=this.b,r=this.c;let s,a;mF.subVectors(i,n),gF.subVectors(r,n),yF.subVectors(t,n);const o=mF.dot(yF),l=gF.dot(yF);if(o<=0&&l<=0)return e.copy(n);_F.subVectors(t,i);const c=mF.dot(_F),u=gF.dot(_F);if(c>=0&&u<=c)return e.copy(i);const h=o*u-c*l;if(h<=0&&o>=0&&c<=0)return s=o/(o-c),e.copy(n).addScaledVector(mF,s);bF.subVectors(t,r);const d=mF.dot(bF),f=gF.dot(bF);if(f>=0&&d<=f)return e.copy(r);const p=d*l-o*f;if(p<=0&&l>=0&&f<=0)return a=l/(l-f),e.copy(n).addScaledVector(gF,a);const m=c*f-d*u;if(m<=0&&u-c>=0&&d-f>=0)return vF.subVectors(r,i),a=(u-c)/(u-c+(d-f)),e.copy(i).addScaledVector(vF,a);const g=1/(m+p+h);return s=p*g,a=h*g,e.copy(n).addScaledVector(mF,s).addScaledVector(gF,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const TF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},MF={h:0,s:0,l:0},AF={h:0,s:0,l:0};function CF(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}class RF{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,n)}set(t,e,n){if(void 0===e&&void 0===n){const e=t;e&&e.isColor?this.copy(e):"number"===typeof e?this.setHex(e):"string"===typeof e&&this.setStyle(e)}else this.setRGB(t,e,n);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gO;return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,JO.colorSpaceToWorking(this,e),this}setRGB(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:JO.workingColorSpace;return this.r=t,this.g=e,this.b=n,JO.colorSpaceToWorking(this,i),this}setHSL(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:JO.workingColorSpace;if(t=FO(t,1),e=NO(e,0,1),n=NO(n,0,1),0===e)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+e):n+e-n*e,r=2*n-i;this.r=CF(r,i,t+1/3),this.g=CF(r,i,t),this.b=CF(r,i,t-1/3)}return JO.colorSpaceToWorking(this,i),this}setStyle(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gO;function i(e){void 0!==e&&parseFloat(e)<1&&AO("Color: Alpha component of "+t+" will be ignored.")}if(e=/^(\w+)\(([^\)]*)\)/.exec(t)){let r;const s=e[1],a=e[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,n);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,n);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,n);break;default:AO("Color: Unknown color model "+t)}}else if(e=/^\#([A-Fa-f\d]+)$/.exec(t)){const i=e[1],r=i.length;if(3===r)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,n);if(6===r)return this.setHex(parseInt(i,16),n);AO("Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,n);return this}setColorName(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gO;const n=TF[t.toLowerCase()];return void 0!==n?this.setHex(n,e):AO("Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=$O(t.r),this.g=$O(t.g),this.b=$O(t.b),this}copyLinearToSRGB(t){return this.r=tN(t.r),this.g=tN(t.g),this.b=tN(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gO;return JO.workingToColorSpace(kF.copy(this),t),65536*Math.round(NO(255*kF.r,0,255))+256*Math.round(NO(255*kF.g,0,255))+Math.round(NO(255*kF.b,0,255))}getHexString(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gO;return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JO.workingColorSpace;JO.workingToColorSpace(kF.copy(this),e);const n=kF.r,i=kF.g,r=kF.b,s=Math.max(n,i,r),a=Math.min(n,i,r);let o,l;const c=(a+s)/2;if(a===s)o=0,l=0;else{const t=s-a;switch(l=c<=.5?t/(s+a):t/(2-s-a),s){case n:o=(i-r)/t+(i<r?6:0);break;case i:o=(r-n)/t+2;break;case r:o=(n-i)/t+4}o/=6}return t.h=o,t.s=l,t.l=c,t}getRGB(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JO.workingColorSpace;return JO.workingToColorSpace(kF.copy(this),e),t.r=kF.r,t.g=kF.g,t.b=kF.b,t}getStyle(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gO;JO.workingToColorSpace(kF.copy(this),t);const e=kF.r,n=kF.g,i=kF.b;return t!==gO?"color(".concat(t," ").concat(e.toFixed(3)," ").concat(n.toFixed(3)," ").concat(i.toFixed(3),")"):"rgb(".concat(Math.round(255*e),",").concat(Math.round(255*n),",").concat(Math.round(255*i),")")}offsetHSL(t,e,n){return this.getHSL(MF),this.setHSL(MF.h+t,MF.s+e,MF.l+n)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(MF),t.getHSL(AF);const n=UO(MF.h,AF.h,e),i=UO(MF.s,AF.s,e),r=UO(MF.l,AF.l,e);return this.setHSL(n,i,r),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,n=this.g,i=this.b,r=t.elements;return this.r=r[0]*e+r[3]*n+r[6]*i,this.g=r[1]*e+r[4]*n+r[7]*i,this.b=r[2]*e+r[5]*n+r[8]*i,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const kF=new RF;RF.NAMES=TF;let LF=0;class DF extends kO{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:LF++}),this.uuid=OO(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new RF(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=bO,this.stencilZFail=bO,this.stencilZPass=bO,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!==t>0&&this.version++,this._alphaTest=t}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){AO("Material: parameter '".concat(e,"' has value of undefined."));continue}const i=this[e];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n:AO("Material: '".concat(e,"' is not a property of THREE.").concat(this.type,"."))}}toJSON(t){const e=void 0===t||"string"===typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};function i(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(t).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(t).uuid),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),204!==this.blendSrc&&(n.blendSrc=this.blendSrc),205!==this.blendDst&&(n.blendDst=this.blendDst),100!==this.blendEquation&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==bO&&(n.stencilFail=this.stencilFail),this.stencilZFail!==bO&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==bO&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),e){const e=i(t.textures),r=i(t.images);e.length>0&&(n.textures=e),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let i=0;i!==t;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}class PF extends DF{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new RF(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new XN,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const IF=new jO,OF=new VO;let NF=0;class FF{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:NF++}),this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=n,this.usage=xO,this.updateRanges=[],this.gpuType=lO,this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)OF.fromBufferAttribute(this,e),OF.applyMatrix3(t),this.setXY(e,OF.x,OF.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)IF.fromBufferAttribute(this,e),IF.applyMatrix3(t),this.setXYZ(e,IF.x,IF.y,IF.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)IF.fromBufferAttribute(this,e),IF.applyMatrix4(t),this.setXYZ(e,IF.x,IF.y,IF.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)IF.fromBufferAttribute(this,e),IF.applyNormalMatrix(t),this.setXYZ(e,IF.x,IF.y,IF.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)IF.fromBufferAttribute(this,e),IF.transformDirection(t),this.setXYZ(e,IF.x,IF.y,IF.z);return this}set(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(t,e),this}getComponent(t,e){let n=this.array[t*this.itemSize+e];return this.normalized&&(n=BO(n,this.array)),n}setComponent(t,e,n){return this.normalized&&(n=zO(n,this.array)),this.array[t*this.itemSize+e]=n,this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=BO(e,this.array)),e}setX(t,e){return this.normalized&&(e=zO(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=BO(e,this.array)),e}setY(t,e){return this.normalized&&(e=zO(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=BO(e,this.array)),e}setZ(t,e){return this.normalized&&(e=zO(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=BO(e,this.array)),e}setW(t,e){return this.normalized&&(e=zO(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.normalized&&(e=zO(e,this.array),n=zO(n,this.array)),this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,i){return t*=this.itemSize,this.normalized&&(e=zO(e,this.array),n=zO(n,this.array),i=zO(i,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t*=this.itemSize,this.normalized&&(e=zO(e,this.array),n=zO(n,this.array),i=zO(i,this.array),r=zO(r,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==xO&&(t.usage=this.usage),t}}class UF extends FF{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class BF extends FF{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class zF extends FF{constructor(t,e,n){super(new Float32Array(t),e,n)}}let HF=0;const VF=new FN,GF=new uF,jF=new jO,WF=new uN,YF=new uN,XF=new jO;class KF extends kO{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:HF++}),this.uuid=OO(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(function(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}(t)?BF:UF)(t,1):this.index=t,this}setIndirect(t){return this.indirect=t,this}getIndirect(){return this.indirect}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new XO).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return VF.makeRotationFromQuaternion(t),this.applyMatrix4(VF),this}rotateX(t){return VF.makeRotationX(t),this.applyMatrix4(VF),this}rotateY(t){return VF.makeRotationY(t),this.applyMatrix4(VF),this}rotateZ(t){return VF.makeRotationZ(t),this.applyMatrix4(VF),this}translate(t,e,n){return VF.makeTranslation(t,e,n),this.applyMatrix4(VF),this}scale(t,e,n){return VF.makeScale(t,e,n),this.applyMatrix4(VF),this}lookAt(t){return GF.lookAt(t),GF.updateMatrix(),this.applyMatrix4(GF.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(jF).negate(),this.translate(jF.x,jF.y,jF.z),this}setFromPoints(t){const e=this.getAttribute("position");if(void 0===e){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];e.push(i.x,i.y,i.z||0)}this.setAttribute("position",new zF(e,3))}else{const n=Math.min(t.length,e.count);for(let i=0;i<n;i++){const n=t[i];e.setXYZ(i,n.x,n.y,n.z||0)}t.length>e.count&&AO("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),e.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new uN);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return CO("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new jO(-1/0,-1/0,-1/0),new jO(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,i=e.length;n<i;n++){const t=e[n];WF.setFromBufferAttribute(t),this.morphTargetsRelative?(XF.addVectors(this.boundingBox.min,WF.min),this.boundingBox.expandByPoint(XF),XF.addVectors(this.boundingBox.max,WF.max),this.boundingBox.expandByPoint(XF)):(this.boundingBox.expandByPoint(WF.min),this.boundingBox.expandByPoint(WF.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&CO('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new CN);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return CO("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new jO,1/0);if(t){const n=this.boundingSphere.center;if(WF.setFromBufferAttribute(t),e)for(let t=0,r=e.length;t<r;t++){const n=e[t];YF.setFromBufferAttribute(n),this.morphTargetsRelative?(XF.addVectors(WF.min,YF.min),WF.expandByPoint(XF),XF.addVectors(WF.max,YF.max),WF.expandByPoint(XF)):(WF.expandByPoint(YF.min),WF.expandByPoint(YF.max))}WF.getCenter(n);let i=0;for(let e=0,r=t.count;e<r;e++)XF.fromBufferAttribute(t,e),i=Math.max(i,n.distanceToSquared(XF));if(e)for(let r=0,s=e.length;r<s;r++){const s=e[r],a=this.morphTargetsRelative;for(let e=0,r=s.count;e<r;e++)XF.fromBufferAttribute(s,e),a&&(jF.fromBufferAttribute(t,e),XF.add(jF)),i=Math.max(i,n.distanceToSquared(XF))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&CO('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void CO("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.position,i=e.normal,r=e.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new FF(new Float32Array(4*n.count),4));const s=this.getAttribute("tangent"),a=[],o=[];for(let w=0;w<n.count;w++)a[w]=new jO,o[w]=new jO;const l=new jO,c=new jO,u=new jO,h=new VO,d=new VO,f=new VO,p=new jO,m=new jO;function g(t,e,i){l.fromBufferAttribute(n,t),c.fromBufferAttribute(n,e),u.fromBufferAttribute(n,i),h.fromBufferAttribute(r,t),d.fromBufferAttribute(r,e),f.fromBufferAttribute(r,i),c.sub(l),u.sub(l),d.sub(h),f.sub(h);const s=1/(d.x*f.y-f.x*d.y);isFinite(s)&&(p.copy(c).multiplyScalar(f.y).addScaledVector(u,-d.y).multiplyScalar(s),m.copy(u).multiplyScalar(d.x).addScaledVector(c,-f.x).multiplyScalar(s),a[t].add(p),a[e].add(p),a[i].add(p),o[t].add(m),o[e].add(m),o[i].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:t.count}]);for(let w=0,S=v.length;w<S;++w){const e=v[w],n=e.start;for(let i=n,r=n+e.count;i<r;i+=3)g(t.getX(i+0),t.getX(i+1),t.getX(i+2))}const y=new jO,_=new jO,b=new jO,x=new jO;function E(t){b.fromBufferAttribute(i,t),x.copy(b);const e=a[t];y.copy(e),y.sub(b.multiplyScalar(b.dot(e))).normalize(),_.crossVectors(x,e);const n=_.dot(o[t])<0?-1:1;s.setXYZW(t,y.x,y.y,y.z,n)}for(let w=0,S=v.length;w<S;++w){const e=v[w],n=e.start;for(let i=n,r=n+e.count;i<r;i+=3)E(t.getX(i+0)),E(t.getX(i+1)),E(t.getX(i+2))}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new FF(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const i=new jO,r=new jO,s=new jO,a=new jO,o=new jO,l=new jO,c=new jO,u=new jO;if(t)for(let h=0,d=t.count;h<d;h+=3){const d=t.getX(h+0),f=t.getX(h+1),p=t.getX(h+2);i.fromBufferAttribute(e,d),r.fromBufferAttribute(e,f),s.fromBufferAttribute(e,p),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),a.fromBufferAttribute(n,d),o.fromBufferAttribute(n,f),l.fromBufferAttribute(n,p),a.add(c),o.add(c),l.add(c),n.setXYZ(d,a.x,a.y,a.z),n.setXYZ(f,o.x,o.y,o.z),n.setXYZ(p,l.x,l.y,l.z)}else for(let t=0,h=e.count;t<h;t+=3)i.fromBufferAttribute(e,t+0),r.fromBufferAttribute(e,t+1),s.fromBufferAttribute(e,t+2),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),n.setXYZ(t+0,c.x,c.y,c.z),n.setXYZ(t+1,c.x,c.y,c.z),n.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)XF.fromBufferAttribute(t,e),XF.normalize(),t.setXYZ(e,XF.x,XF.y,XF.z)}toNonIndexed(){function t(t,e){const n=t.array,i=t.itemSize,r=t.normalized,s=new n.constructor(e.length*i);let a=0,o=0;for(let l=0,c=e.length;l<c;l++){a=t.isInterleavedBufferAttribute?e[l]*t.data.stride+t.offset:e[l]*i;for(let t=0;t<i;t++)s[o++]=n[a++]}return new FF(s,i,r)}if(null===this.index)return AO("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new KF,n=this.index.array,i=this.attributes;for(const a in i){const r=t(i[a],n);e.setAttribute(a,r)}const r=this.morphAttributes;for(const a in r){const i=[],s=r[a];for(let e=0,r=s.length;e<r;e++){const r=t(s[e],n);i.push(r)}e.morphAttributes[a]=i}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,o=s.length;a<o;a++){const t=s[a];e.addGroup(t.start,t.count,t.materialIndex)}return e}toJSON(){const t={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const o in n){const e=n[o];t.data.attributes[o]=e.toJSON(t.data)}const i={};let r=!1;for(const o in this.morphAttributes){const e=this.morphAttributes[o],n=[];for(let i=0,r=e.length;i<r;i++){const r=e[i];n.push(r.toJSON(t.data))}n.length>0&&(i[o]=n,r=!0)}r&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return null!==a&&(t.data.boundingSphere=a.toJSON()),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone());const i=t.attributes;for(const l in i){const t=i[l];this.setAttribute(l,t.clone(e))}const r=t.morphAttributes;for(const l in r){const t=[],n=r[l];for(let i=0,r=n.length;i<r;i++)t.push(n[i].clone(e));this.morphAttributes[l]=t}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let l=0,c=s.length;l<c;l++){const t=s[l];this.addGroup(t.start,t.count,t.materialIndex)}const a=t.boundingBox;null!==a&&(this.boundingBox=a.clone());const o=t.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const qF=new FN,QF=new NN,ZF=new CN,JF=new jO,$F=new jO,tU=new jO,eU=new jO,nU=new jO,iU=new jO,rU=new jO,sU=new jO;class aU extends uF{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new KF,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new PF;super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}getVertexPosition(t,e){const n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;e.fromBufferAttribute(i,t);const a=this.morphTargetInfluences;if(r&&a){iU.set(0,0,0);for(let n=0,i=r.length;n<i;n++){const i=a[n],o=r[n];0!==i&&(nU.fromBufferAttribute(o,t),s?iU.addScaledVector(nU,i):iU.addScaledVector(nU.sub(e),i))}e.add(iU)}return e}raycast(t,e){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0!==i){if(null===n.boundingSphere&&n.computeBoundingSphere(),ZF.copy(n.boundingSphere),ZF.applyMatrix4(r),QF.copy(t.ray).recast(t.near),!1===ZF.containsPoint(QF.origin)){if(null===QF.intersectSphere(ZF,JF))return;if(QF.origin.distanceToSquared(JF)>(t.far-t.near)**2)return}qF.copy(r).invert(),QF.copy(t.ray).applyMatrix4(qF),null!==n.boundingBox&&!1===QF.intersectsBox(n.boundingBox)||this._computeIntersections(t,e,QF)}}_computeIntersections(t,e,n){let i;const r=this.geometry,s=this.material,a=r.index,o=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv1,u=r.attributes.normal,h=r.groups,d=r.drawRange;if(null!==a)if(Array.isArray(s))for(let f=0,p=h.length;f<p;f++){const r=h[f],o=s[r.materialIndex];for(let s=Math.max(r.start,d.start),h=Math.min(a.count,Math.min(r.start+r.count,d.start+d.count));s<h;s+=3){i=oU(this,o,t,n,l,c,u,a.getX(s),a.getX(s+1),a.getX(s+2)),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,e.push(i))}}else{for(let r=Math.max(0,d.start),o=Math.min(a.count,d.start+d.count);r<o;r+=3){i=oU(this,s,t,n,l,c,u,a.getX(r),a.getX(r+1),a.getX(r+2)),i&&(i.faceIndex=Math.floor(r/3),e.push(i))}}else if(void 0!==o)if(Array.isArray(s))for(let f=0,p=h.length;f<p;f++){const r=h[f],a=s[r.materialIndex];for(let s=Math.max(r.start,d.start),h=Math.min(o.count,Math.min(r.start+r.count,d.start+d.count));s<h;s+=3){i=oU(this,a,t,n,l,c,u,s,s+1,s+2),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,e.push(i))}}else{for(let r=Math.max(0,d.start),a=Math.min(o.count,d.start+d.count);r<a;r+=3){i=oU(this,s,t,n,l,c,u,r,r+1,r+2),i&&(i.faceIndex=Math.floor(r/3),e.push(i))}}}}function oU(t,e,n,i,r,s,a,o,l,c){t.getVertexPosition(o,$F),t.getVertexPosition(l,tU),t.getVertexPosition(c,eU);const u=function(t,e,n,i,r,s,a,o){let l;if(l=1===e.side?i.intersectTriangle(a,s,r,!0,o):i.intersectTriangle(r,s,a,0===e.side,o),null===l)return null;sU.copy(o),sU.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(sU);return c<n.near||c>n.far?null:{distance:c,point:sU.clone(),object:t}}(t,e,n,i,$F,tU,eU,rU);if(u){const t=new jO;SF.getBarycoord(rU,$F,tU,eU,t),r&&(u.uv=SF.getInterpolatedAttribute(r,o,l,c,t,new VO)),s&&(u.uv1=SF.getInterpolatedAttribute(s,o,l,c,t,new VO)),a&&(u.normal=SF.getInterpolatedAttribute(a,o,l,c,t,new jO),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const e={a:o,b:l,c:c,normal:new jO,materialIndex:0};SF.getNormal($F,tU,eU,e.normal),u.face=e,u.barycoord=t}return u}function lU(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(AO("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}class cU extends DF{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=lU(t.uniforms),this.uniformsGroups=function(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?e.uniforms[i]={type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?e.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?e.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?e.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?e.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?e.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?e.uniforms[i]={type:"m4",value:n.toArray()}:e.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.lights=this.lights,e.clipping=this.clipping;const n={};for(const i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}class uU extends uF{constructor(){super(),this.isGroup=!0,this.type="Group"}}class hU extends uF{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new XN,this.environmentIntensity=1,this.environmentRotation=new XN,this.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,this.backgroundRotation.copy(t.backgroundRotation),this.environmentIntensity=t.environmentIntensity,this.environmentRotation.copy(t.environmentRotation),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(e.object.backgroundIntensity=this.backgroundIntensity),e.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(e.object.environmentIntensity=this.environmentIntensity),e.object.environmentRotation=this.environmentRotation.toArray(),e}}class dU extends lN{constructor(t,e,n,i){super(t,e,n,i,arguments.length>4&&void 0!==arguments[4]?arguments[4]:sO,arguments.length>5&&void 0!==arguments[5]?arguments[5]:sO,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const r=this;"requestVideoFrameCallback"in t&&(this._requestVideoFrameCallbackId=t.requestVideoFrameCallback(function e(){r.needsUpdate=!0,r._requestVideoFrameCallbackId=t.requestVideoFrameCallback(e)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;!1==="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){0!==this._requestVideoFrameCallbackId&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class fU extends KF{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};const r=t/2,s=e/2,a=Math.floor(n),o=Math.floor(i),l=a+1,c=o+1,u=t/a,h=e/o,d=[],f=[],p=[],m=[];for(let g=0;g<c;g++){const t=g*h-s;for(let e=0;e<l;e++){const n=e*u-r;f.push(n,-t,0),p.push(0,0,1),m.push(e/a),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let t=0;t<a;t++){const e=t+l*g,n=t+l*(g+1),i=t+1+l*(g+1),r=t+1+l*g;d.push(e,n,r),d.push(n,i,r)}this.setIndex(d),this.setAttribute("position",new zF(f,3)),this.setAttribute("normal",new zF(p,3)),this.setAttribute("uv",new zF(m,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new fU(t.width,t.height,t.widthSegments,t.heightSegments)}}function pU(t,e){return t&&t.constructor!==e?"number"===typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t):t}function mU(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}class gU{constructor(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{let s;n:{i:if(!(t<i)){for(let s=n+2;;){if(void 0===i){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(r=i,i=e[++n],t<i)break e}s=e.length;break n}if(!(t>=r)){const a=e[1];t<a&&(n=2,r=a);for(let s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(n===s)break;if(i=r,r=e[--n-1],t>=r)break e}s=n,n=0;break n}break t}for(;n<s;){const i=n+s>>>1;t<e[i]?s=i:n=i+1}if(i=e[n],r=e[n-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i;for(let s=0;s!==i;++s)e[s]=n[r+s];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class vU extends gU{constructor(t,e,n,i){super(t,e,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:fO,endingEnd:fO}}intervalChanged_(t,e,n){const i=this.parameterPositions;let r=t-2,s=t+1,a=i[r],o=i[s];if(void 0===a)switch(this.getSettings_().endingStart){case pO:r=t,a=2*e-n;break;case mO:r=i.length-2,a=e+i[r]-i[r+1];break;default:r=t,a=n}if(void 0===o)switch(this.getSettings_().endingEnd){case pO:s=t,o=2*n-e;break;case mO:s=1,o=n+i[1]-i[0];break;default:s=t-1,o=e}const l=.5*(n-e),c=this.valueSize;this._weightPrev=l/(e-a),this._weightNext=l/(o-n),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=t*a,l=o-a,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-e)/(i-e),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,_=d*m-d*p;for(let b=0;b!==a;++b)r[b]=g*s[c+b]+v*s[l+b]+y*s[o+b]+_*s[u+b];return r}}class yU extends gU{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=t*a,l=o-a,c=(n-e)/(i-e),u=1-c;for(let h=0;h!==a;++h)r[h]=s[l+h]*u+s[o+h]*c;return r}}class _U extends gU{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t){return this.copySampleValue_(t-1)}}class bU{constructor(t,e,n,i){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=pU(e,this.TimeBufferType),this.values=pU(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:pU(t.times,Array),values:pU(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new _U(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new yU(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new vU(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case uO:e=this.InterpolantFactoryMethodDiscrete;break;case hO:e=this.InterpolantFactoryMethodLinear;break;case dO:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return AO("KeyframeTrack:",e),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return uO;case this.InterpolantFactoryMethodLinear:return hO;case this.InterpolantFactoryMethodSmooth:return dO}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]*=t}return this}trim(t,e){const n=this.times,i=n.length;let r=0,s=i-1;for(;r!==i&&n[r]<t;)++r;for(;-1!==s&&n[s]>e;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);const t=this.getValueSize();this.times=n.slice(r,s),this.values=this.values.slice(r*t,s*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!==0&&(CO("KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,i=this.values,r=n.length;0===r&&(CO("KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let a=0;a!==r;a++){const e=n[a];if("number"===typeof e&&isNaN(e)){CO("KeyframeTrack: Time is not a valid number.",this,a,e),t=!1;break}if(null!==s&&s>e){CO("KeyframeTrack: Out of order keys.",this,a,e,s),t=!1;break}s=e}if(void 0!==i&&mU(i))for(let a=0,o=i.length;a!==o;++a){const e=i[a];if(isNaN(e)){CO("KeyframeTrack: Value is not a valid number.",this,a,e),t=!1;break}}return t}optimize(){const t=this.times.slice(),e=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===dO,r=t.length-1;let s=1;for(let a=1;a<r;++a){let r=!1;const o=t[a];if(o!==t[a+1]&&(1!==a||o!==t[0]))if(i)r=!0;else{const t=a*n,i=t-n,s=t+n;for(let a=0;a!==n;++a){const n=e[t+a];if(n!==e[i+a]||n!==e[s+a]){r=!0;break}}}if(r){if(a!==s){t[s]=t[a];const i=a*n,r=s*n;for(let t=0;t!==n;++t)e[r+t]=e[i+t]}++s}}if(r>0){t[s]=t[r];for(let t=r*n,i=s*n,a=0;a!==n;++a)e[i+a]=e[t+a];++s}return s!==t.length?(this.times=t.slice(0,s),this.values=e.slice(0,s*n)):(this.times=t,this.values=e),this}clone(){const t=this.times.slice(),e=this.values.slice(),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}bU.prototype.ValueTypeName="",bU.prototype.TimeBufferType=Float32Array,bU.prototype.ValueBufferType=Float32Array,bU.prototype.DefaultInterpolation=hO;class xU extends bU{constructor(t,e,n){super(t,e,n)}}xU.prototype.ValueTypeName="bool",xU.prototype.ValueBufferType=Array,xU.prototype.DefaultInterpolation=uO,xU.prototype.InterpolantFactoryMethodLinear=void 0,xU.prototype.InterpolantFactoryMethodSmooth=void 0;class EU extends bU{constructor(t,e,n,i){super(t,e,n,i)}}EU.prototype.ValueTypeName="color";class wU extends bU{constructor(t,e,n,i){super(t,e,n,i)}}wU.prototype.ValueTypeName="number";class SU extends gU{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(n-e)/(i-e);let l=t*a;for(let c=l+a;l!==c;l+=4)GO.slerpFlat(r,0,s,l-a,s,l,o);return r}}class TU extends bU{constructor(t,e,n,i){super(t,e,n,i)}InterpolantFactoryMethodLinear(t){return new SU(this.times,this.values,this.getValueSize(),t)}}TU.prototype.ValueTypeName="quaternion",TU.prototype.InterpolantFactoryMethodSmooth=void 0;class MU extends bU{constructor(t,e,n){super(t,e,n)}}MU.prototype.ValueTypeName="string",MU.prototype.ValueBufferType=Array,MU.prototype.DefaultInterpolation=uO,MU.prototype.InterpolantFactoryMethodLinear=void 0,MU.prototype.InterpolantFactoryMethodSmooth=void 0;class AU extends bU{constructor(t,e,n,i){super(t,e,n,i)}}AU.prototype.ValueTypeName="vector";class CU{constructor(t,e,n){const i=this;let r,s=!1,a=0,o=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this._abortController=null,this.itemStart=function(t){o++,!1===s&&void 0!==i.onStart&&i.onStart(t,a,o),s=!0},this.itemEnd=function(t){a++,void 0!==i.onProgress&&i.onProgress(t,a,o),a===o&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(t){void 0!==i.onError&&i.onError(t)},this.resolveURL=function(t){return r?r(t):t},this.setURLModifier=function(t){return r=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],i=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return i}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const RU=new CU;class kU{constructor(t){this.manager=void 0!==t?t:RU,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise(function(i,r){n.load(t,i,e,r)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}abort(){return this}}kU.DEFAULT_MATERIAL_NAME="__DEFAULT";Error;new WeakMap;new WeakMap;const LU="\\[\\]\\.:\\/",DU=new RegExp("["+LU+"]","g"),PU="[^"+LU+"]",IU="[^"+LU.replace("\\.","")+"]",OU=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",PU)+/(WCOD+)?/.source.replace("WCOD",IU)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",PU)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",PU)+"$"),NU=["material","materials","bones","map"];class FU{constructor(t,e,n){this.path=e,this.parsedPath=n||FU.parseTrackName(e),this.node=FU.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new FU.Composite(t,e,n):new FU(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(DU,"")}static parseTrackName(t){const e=OU.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const t=n.nodeName.substring(i+1);-1!==NU.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let i=0;i<t.length;i++){const r=t[i];if(r.name===e||r.uuid===e)return r;const s=n(r.children);if(s)return s}return null},i=n(t.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)t[e++]=n[i]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,i=e.propertyName;let r=e.propertyIndex;if(t||(t=FU.findNode(this.rootNode,e.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void AO("PropertyBinding: No target node found for track: "+this.path+".");if(n){let i=e.objectIndex;switch(n){case"materials":if(!t.material)return void CO("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void CO("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void CO("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===i){i=e;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void CO("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void CO("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[n])return void CO("PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==i){if(void 0===t[i])return void CO("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[i]}}const s=t[i];if(void 0===s){return void CO("PropertyBinding: Trying to update property for track: "+e.nodeName+"."+i+" but it wasn't found.",t)}let a=this.Versioning.None;this.targetObject=t,!0===t.isMaterial?a=this.Versioning.NeedsUpdate:!0===t.isObject3D&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!t.geometry)return void CO("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void CO("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[r]&&(r=t.morphTargetDictionary[r])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}FU.Composite=class{constructor(t,e,n){const i=n||FU.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}getValue(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},FU.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},FU.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},FU.prototype.GetterByBindingType=[FU.prototype._getValue_direct,FU.prototype._getValue_array,FU.prototype._getValue_arrayElement,FU.prototype._getValue_toArray],FU.prototype.SetterByBindingTypeAndVersioning=[[FU.prototype._setValue_direct,FU.prototype._setValue_direct_setNeedsUpdate,FU.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[FU.prototype._setValue_array,FU.prototype._setValue_array_setNeedsUpdate,FU.prototype._setValue_array_setMatrixWorldNeedsUpdate],[FU.prototype._setValue_arrayElement,FU.prototype._setValue_arrayElement_setNeedsUpdate,FU.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[FU.prototype._setValue_fromArray,FU.prototype._setValue_fromArray_setNeedsUpdate,FU.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"181"}})),"undefined"!==typeof window&&(window.__THREE__?AO("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="181");var UU=Object.defineProperty;((t,e)=>{for(var n in e)UU(t,n,{get:e[n],enumerable:!0})})({},{EnterMarkerEvent:()=>XU,GotoMarkerDoneEvent:()=>GU,HideMarkersEvent:()=>eB,LeaveMarkerEvent:()=>WU,MarkerVisibilityEvent:()=>HU,MarkersPluginEvent:()=>BU,RenderMarkersListEvent:()=>oB,SelectMarkerEvent:()=>qU,SelectMarkerListEvent:()=>ZU,SetMarkersEvent:()=>iB,ShowMarkersEvent:()=>sB,UnselectMarkerEvent:()=>$U});var BU=class extends RD{},zU=class t extends BU{constructor(e,n){super(t.type),this.marker=e,this.visible=n}};zU.type="marker-visibility";var HU=zU,VU=class t extends BU{constructor(e){super(t.type),this.marker=e}};VU.type="goto-marker-done";var GU=VU,jU=class t extends BU{constructor(e){super(t.type),this.marker=e}};jU.type="leave-marker";var WU=jU,YU=class t extends BU{constructor(e){super(t.type),this.marker=e}};YU.type="enter-marker";var XU=YU,KU=class t extends BU{constructor(e,n,i){super(t.type),this.marker=e,this.doubleClick=n,this.rightClick=i}};KU.type="select-marker";var qU=KU,QU=class t extends BU{constructor(e){super(t.type),this.marker=e}};QU.type="select-marker-list";var ZU=QU,JU=class t extends BU{constructor(e){super(t.type),this.marker=e}};JU.type="unselect-marker";var $U=JU,tB=class t extends BU{constructor(){super(t.type)}};tB.type="hide-markers";var eB=tB,nB=class t extends BU{constructor(e){super(t.type),this.markers=e}};nB.type="set-markers";var iB=nB,rB=class t extends BU{constructor(){super(t.type)}};rB.type="show-markers";var sB=rB,aB=class t extends BU{constructor(e){super(t.type),this.markers=e}};aB.type="render-markers-list";var oB=aB,lB=class extends ZP{constructor(t){super(t,{className:"psv-markers-button",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 9 81 81"><path fill="currentColor" d="M50.5 90S22.9 51.9 22.9 36.6 35.2 9 50.5 9s27.6 12.4 27.6 27.6S50.5 90 50.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11z"/>\x3c!--Created by Rohith M S from the Noun Project--\x3e</svg>\n',hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.plugin.addEventListener(sB.type,this),this.plugin.addEventListener(eB.type,this),this.toggleActive(!0))}destroy(){this.plugin&&(this.plugin.removeEventListener(sB.type,this),this.plugin.removeEventListener(eB.type,this)),super.destroy()}isSupported(){return!!this.plugin}handleEvent(t){t instanceof sB?this.toggleActive(!0):t instanceof eB&&this.toggleActive(!1)}onClick(){this.plugin.toggleAllMarkers()}};lB.id="markers";var cB='<svg xmlns="http://www.w3.org/2000/svg" viewBox="9 9 81 81"><path fill="currentColor" d="M37.5 90S9.9 51.9 9.9 36.6 22.2 9 37.5 9s27.6 12.4 27.6 27.6S37.5 90 37.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11zM86.7 55H70c-1.8 0-3.3-1.5-3.3-3.3s1.5-3.3 3.3-3.3h16.7c1.8 0 3.3 1.5 3.3 3.3S88.5 55 86.7 55zm0-25h-15a3.3 3.3 0 0 1-3.3-3.3c0-1.8 1.5-3.3 3.3-3.3h15c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3zM56.5 73h30c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3h-30a3.3 3.3 0 0 1-3.3-3.3 3.2 3.2 0 0 1 3.3-3.3z"/>\x3c!--Created by Rohith M S from the Noun Project--\x3e</svg>\n',uB="http://www.w3.org/2000/svg",hB="psvMarker",dB=gL.dasherize(hB),fB="marker",pB="markersList",mB={amount:2,duration:100,easing:"linear"},gB=(t,e)=>'\n<div class="psv-panel-menu psv-panel-menu--stripped">\n    <h1 class="psv-panel-menu-title">'.concat(cB," ").concat(e,'</h1>\n    <ul class="psv-panel-menu-list">\n    ').concat(t.map(t=>"\n        <li data-".concat(dB,'="').concat(t.id,'" class="psv-panel-menu-item" tabindex="0">\n          ').concat("image"===t.type?'<span class="psv-panel-menu-item-icon"><img src="'.concat(t.definition,'"/></span>'):"",'\n          <span class="psv-panel-menu-item-label">').concat(t.getListContent(),"</span>\n        </li>\n    ")).join(""),"\n    </ul>\n</div>\n"),vB=class extends ZP{constructor(t){super(t,{className:" psv-markers-list-button",icon:cB,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.viewer.addEventListener(CD.ShowPanelEvent.type,this),this.viewer.addEventListener(CD.HidePanelEvent.type,this))}destroy(){this.viewer.removeEventListener(CD.ShowPanelEvent.type,this),this.viewer.removeEventListener(CD.HidePanelEvent.type,this),super.destroy()}isSupported(){return!!this.plugin}handleEvent(t){t instanceof CD.ShowPanelEvent?this.toggleActive(t.panelId===pB):t instanceof CD.HidePanelEvent&&this.toggleActive(!1)}onClick(){this.plugin.toggleMarkersList()}};vB.id="markersList";var yB=new jO,_B=new GO,bB=new jO,xB=class extends uF{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.createElement("div");super(),this.isCSS3DObject=!0,this.element=t,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof t.element.ownerDocument.defaultView.Element&&null!==t.element.parentNode&&t.element.remove()})})}copy(t,e){return super.copy(t,e),this.element=t.element.cloneNode(!0),this}},EB=new FN,wB=new FN,SB=class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this;let n,i,r,s;const a={camera:{style:""},objects:new WeakMap},o=void 0!==t.element?t.element:document.createElement("div");o.style.overflow="hidden",this.domElement=o;const l=document.createElement("div");l.style.transformOrigin="0 0",l.style.pointerEvents="none",o.appendChild(l);const c=document.createElement("div");function u(t){return Math.abs(t)<1e-10?0:t}function h(t){const e=t.elements;return"matrix3d("+u(e[0])+","+u(-e[1])+","+u(e[2])+","+u(e[3])+","+u(e[4])+","+u(-e[5])+","+u(e[6])+","+u(e[7])+","+u(e[8])+","+u(-e[9])+","+u(e[10])+","+u(e[11])+","+u(e[12])+","+u(-e[13])+","+u(e[14])+","+u(e[15])+")"}function d(t){const e=t.elements;return"translate(-50%,-50%)"+("matrix3d("+u(e[0])+","+u(e[1])+","+u(e[2])+","+u(e[3])+","+u(-e[4])+","+u(-e[5])+","+u(-e[6])+","+u(-e[7])+","+u(e[8])+","+u(e[9])+","+u(e[10])+","+u(e[11])+","+u(e[12])+","+u(e[13])+","+u(e[14])+","+u(e[15])+")")}function f(t){t.isCSS3DObject&&(t.element.style.display="none");for(let e=0,n=t.children.length;e<n;e++)f(t.children[e])}function p(t,n,i,r){if(!1!==t.visible){if(t.isCSS3DObject){const r=!0===t.layers.test(i.layers),s=t.element;if(s.style.display=!0===r?"":"none",!0===r){let r;t.onBeforeRender(e,n,i),t.isCSS3DSprite?(EB.copy(i.matrixWorldInverse),EB.transpose(),0!==t.rotation2D&&EB.multiply(wB.makeRotationZ(t.rotation2D)),t.matrixWorld.decompose(yB,_B,bB),EB.setPosition(yB),EB.scale(bB),EB.elements[3]=0,EB.elements[7]=0,EB.elements[11]=0,EB.elements[15]=1,r=d(EB)):r=d(t.matrixWorld);const o=a.objects.get(t);if(void 0===o||o.style!==r){s.style.transform=r;const e={style:r};a.objects.set(t,e)}s.parentNode!==c&&c.appendChild(s),t.onAfterRender(e,n,i)}}for(let e=0,s=t.children.length;e<s;e++)p(t.children[e],n,i,r)}else f(t)}c.style.transformStyle="preserve-3d",l.appendChild(c),this.getSize=function(){return{width:n,height:i}},this.render=function(t,e){const o=e.projectionMatrix.elements[5]*s;let d,f;e.view&&e.view.enabled?(l.style.transform="translate( ".concat(-e.view.offsetX*(n/e.view.width),"px, ").concat(-e.view.offsetY*(i/e.view.height),"px )"),l.style.transform+="scale( ".concat(e.view.fullWidth/e.view.width,", ").concat(e.view.fullHeight/e.view.height," )")):l.style.transform="",!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),null===e.parent&&!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),e.isOrthographicCamera&&(d=-(e.right+e.left)/2,f=(e.top+e.bottom)/2);const m=e.view&&e.view.enabled?e.view.height/e.view.fullHeight:1,g=e.isOrthographicCamera?"scale( ".concat(m," )scale(")+o+")translate("+u(d)+"px,"+u(f)+"px)"+h(e.matrixWorldInverse):"scale( ".concat(m," )translateZ(")+o+"px)"+h(e.matrixWorldInverse),v=(e.isPerspectiveCamera?"perspective("+o+"px) ":"")+g+"translate("+r+"px,"+s+"px)";a.camera.style!==v&&(c.style.transform=v,a.camera.style=v),p(t,t,e,g)},this.setSize=function(t,e){n=t,i=e,r=n/2,s=i/2,o.style.width=t+"px",o.style.height=e+"px",l.style.width=t+"px",l.style.height=e+"px",c.style.width=t+"px",c.style.height=e+"px"}}},TB=class{constructor(t){this.viewer=t,this.element=document.createElement("div"),this.element.className="psv-markers-css3d-container",this.renderer=new SB({element:this.element}),this.scene=new hU,this.intersectionObserver=new IntersectionObserver(t=>{t.forEach(t=>{const e=t.target[hB];e.config.visible&&(e.viewportIntersection=t.isIntersecting)})},{root:this.element}),t.addEventListener(CD.ReadyEvent.type,this,{once:!0}),t.addEventListener(CD.SizeUpdatedEvent.type,this),t.addEventListener(CD.RenderEvent.type,this)}handleEvent(t){switch(t.type){case CD.ReadyEvent.type:case CD.SizeUpdatedEvent.type:this.updateSize();break;case CD.RenderEvent.type:this.render()}}destroy(){this.viewer.removeEventListener(CD.ReadyEvent.type,this),this.viewer.removeEventListener(CD.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(CD.RenderEvent.type,this),this.intersectionObserver.disconnect()}updateSize(){const t=this.viewer.getSize();this.renderer.setSize(t.width,t.height)}render(){this.renderer.render(this.scene,this.viewer.renderer.camera)}addObject(t){this.scene.add(t.threeElement),this.intersectionObserver.observe(t.domElement)}removeObject(t){this.scene.remove(t.threeElement),this.intersectionObserver.unobserve(t.domElement)}},MB=(t=>(t.image="image",t.html="html",t.element="element",t.imageLayer="imageLayer",t.videoLayer="videoLayer",t.elementLayer="elementLayer",t.polygon="polygon",t.polygonPixels="polygonPixels",t.polyline="polyline",t.polylinePixels="polylinePixels",t.square="square",t.rect="rect",t.circle="circle",t.ellipse="ellipse",t.path="path",t))(MB||{});function AB(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[];if(Object.keys(MB).forEach(e=>{t[e]&&n.push(e)}),0===n.length&&!e)throw new qL("missing marker content, either ".concat(Object.keys(MB).join(", ")));if(n.length>1)throw new qL("multiple marker content, either ".concat(Object.keys(MB).join(", ")));return n[0]}var CB=class{constructor(t,e,n){if(this.viewer=t,this.plugin=e,this.state={anchor:null,visible:!1,staticTooltip:!1,position:null,position2D:null,positions3D:null,size:null},!n.id)throw new qL("missing marker id");this.type=AB(n),this.createElement(),this.update(n)}get id(){return this.config.id}get data(){return this.config.data}get domElement(){return null}get threeElement(){return null}get video(){return null}destroy(){delete this.viewer,delete this.plugin,delete this.element,this.hideTooltip()}is3d(){return!1}isNormal(){return!1}isPoly(){return!1}isSvg(){return!1}isCss3d(){return!1}update(t){const e=AB(t,!0);if(void 0!==e&&e!==this.type)throw new qL("cannot change marker ".concat(t.id," type"));if(this.config=gL.deepmerge(this.config,t),"string"===typeof this.config.tooltip&&(this.config.tooltip={content:this.config.tooltip}),this.config.tooltip&&!this.config.tooltip.trigger&&(this.config.tooltip.trigger="hover"),gL.isNil(this.config.visible)&&(this.config.visible=!0),gL.isNil(this.config.zIndex)&&(this.config.zIndex=1),gL.isNil(this.config.opacity)&&(this.config.opacity=1),this.config.rotation){const t=this.config.rotation;this.config.rotation="object"===typeof t?{yaw:t.yaw?gL.parseAngle(t.yaw,!0,!1):0,pitch:t.pitch?gL.parseAngle(t.pitch,!0,!1):0,roll:t.roll?gL.parseAngle(t.roll,!0,!1):0}:{yaw:0,pitch:0,roll:gL.parseAngle(t,!0,!1)}}else this.config.rotation={yaw:0,pitch:0,roll:0};this.state.anchor=gL.parsePoint(this.config.anchor)}getListContent(){var t;return this.config.listContent?this.config.listContent:null!==(t=this.config.tooltip)&&void 0!==t&&t.content?this.config.tooltip.content:this.config.html?this.config.html:this.id}showTooltip(t,e){var n;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.state.visible&&null!==(n=this.config.tooltip)&&void 0!==n&&n.content&&this.state.position2D){const n=Rr(Rr({},this.config.tooltip),{},{style:{pointerEvents:this.state.staticTooltip?"auto":"none"},data:this,top:0,left:0});if(this.isPoly()||this.is3d()||this.isCss3d())if(t||e){const i=gL.getPosition(this.viewer.container);n.top=e-i.y+10,n.left=t-i.x,n.box={width:20,height:20}}else n.top=this.state.position2D.y,n.left=this.state.position2D.x;else{const t=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);let e=this.state.size.width,i=this.state.size.height;this.config.hoverScale&&!this.state.staticTooltip&&(e*=this.config.hoverScale.amount,i*=this.config.hoverScale.amount),n.top=t.y-i*this.state.anchor.y+i/2,n.left=t.x-e*this.state.anchor.x+e/2,n.box={width:e,height:i}}this.tooltip?i?this.tooltip.update(this.config.tooltip.content,n):this.tooltip.move(n):this.tooltip=this.viewer.createTooltip(n)}}hideTooltip(){this.tooltip&&(this.tooltip.hide(),this.tooltip=null)}},RB=class extends CB{get domElement(){return this.element}constructor(t,e,n){super(t,e,n)}afterCreateElement(){this.element[hB]=this}destroy(){delete this.element[hB],super.destroy()}update(t){super.update(t);const e=this.domElement;e.id="psv-marker-".concat(this.config.id),e.setAttribute("class","psv-marker"),this.state.visible&&e.classList.add("psv-marker--visible"),this.config.tooltip&&e.classList.add("psv-marker--has-tooltip"),this.config.content&&e.classList.add("psv-marker--has-content"),this.config.className&&gL.addClasses(e,this.config.className),e.style.opacity="".concat(this.config.opacity),e.style.zIndex="".concat(30+this.config.zIndex),this.config.style&&Object.assign(e.style,this.config.style)}},kB=class extends RB{constructor(t,e,n){super(t,e,n)}afterCreateElement(){super.afterCreateElement(),this.domElement.addEventListener("transitionend",()=>{this.domElement.style.transition=""})}render(t){let{viewerPosition:e,zoomLevel:n,hoveringMarker:i}=t;this.__updateSize();const r=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);r.x-=this.state.size.width*this.state.anchor.x,r.y-=this.state.size.height*this.state.anchor.y;return this.state.positions3D[0].dot(this.viewer.state.direction)>0&&r.x+this.state.size.width>=0&&r.x-this.state.size.width<=this.viewer.state.size.width&&r.y+this.state.size.height>=0&&r.y-this.state.size.height<=this.viewer.state.size.height?(this.domElement.style.translate="".concat(r.x,"px ").concat(r.y,"px 0px"),this.applyScale({zoomLevel:n,viewerPosition:e,mouseover:this===i}),r):null}update(t){if(super.update(t),!gL.isExtendedPosition(this.config.position))throw new qL("missing marker ".concat(this.id," position"));try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(Wq){throw new qL("invalid marker ".concat(this.id," position"),Wq)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const e=this.domElement;e.classList.add("psv-marker--normal"),this.config.scale&&Array.isArray(this.config.scale)&&(this.config.scale={zoom:this.config.scale}),"boolean"===typeof this.config.hoverScale?this.config.hoverScale=this.config.hoverScale?this.plugin.config.defaultHoverScale||mB:null:"number"===typeof this.config.hoverScale?this.config.hoverScale={amount:this.config.hoverScale}:this.config.hoverScale||(this.config.hoverScale=this.plugin.config.defaultHoverScale),this.config.hoverScale&&(this.config.hoverScale=Rr(Rr({},this.plugin.config.defaultHoverScale),this.config.hoverScale)),e.style.rotate=0!==this.config.rotation.roll?HO.radToDeg(this.config.rotation.roll)+"deg":null,e.style.transformOrigin="".concat(100*this.state.anchor.x,"% ").concat(100*this.state.anchor.y,"%")}__updateSize(){if(!this.needsUpdateSize)return;const t=this.domElement,e=!this.state.visible||!this.state.size;if(e&&t.classList.add("psv-marker--transparent"),this.isSvg()){const e=t.firstElementChild.getBoundingClientRect();this.state.size={width:e.width,height:e.height}}else this.state.size={width:t.offsetWidth,height:t.offsetHeight};e&&t.classList.remove("psv-marker--transparent"),this.isSvg()&&(t.style.width=this.state.size.width+"px",t.style.height=this.state.size.height+"px"),"element"!==this.type&&(this.needsUpdateSize=!1)}applyScale(t){let{zoomLevel:e,viewerPosition:n,mouseover:i}=t;null!==i&&this.config.hoverScale&&(this.domElement.style.transition="scale ".concat(this.config.hoverScale.duration,"ms ").concat(this.config.hoverScale.easing));let r=1;if("function"===typeof this.config.scale)r=this.config.scale(e,n);else if(this.config.scale){if(Array.isArray(this.config.scale.zoom)){const[t,n]=this.config.scale.zoom;r*=t+(n-t)*tL.EASINGS.inQuad(e/100)}if(Array.isArray(this.config.scale.yaw)){const[t,e]=this.config.scale.yaw,i=HO.degToRad(this.viewer.state.hFov)/2,s=Math.abs(gL.getShortestArc(this.state.position.yaw,n.yaw));r*=e+(t-e)*tL.EASINGS.outQuad(Math.max(0,(i-s)/i))}}i&&this.config.hoverScale&&(r*=this.config.hoverScale.amount),this.domElement.style.scale="".concat(r)}},LB=class extends cU{get map(){return this.uniforms.map.value}set map(t){this.uniforms.map.value=t}set alpha(t){this.uniforms.alpha.value=t}get offset(){return this.uniforms.offset.value}get repeat(){return this.uniforms.repeat.value}set chromaKey(t){if(this.uniforms.keying.value=!0===(null===t||void 0===t?void 0:t.enabled),null!==t&&void 0!==t&&t.enabled){var e,n,i;if("object"===typeof t.color&&"r"in t.color)this.uniforms.color.value.set(t.color.r/255,t.color.g/255,t.color.b/255);else this.uniforms.color.value.set(null!==(i=t.color)&&void 0!==i?i:65280);this.uniforms.similarity.value=null!==(e=t.similarity)&&void 0!==e?e:.2,this.uniforms.smoothness.value=null!==(n=t.smoothness)&&void 0!==n?n:.2}}constructor(t){var e;super({transparent:!0,depthTest:!1,depthWrite:!1,uniforms:{map:{value:null===t||void 0===t?void 0:t.map},repeat:{value:new VO(1,1)},offset:{value:new VO(0,0)},alpha:{value:null!==(e=null===t||void 0===t?void 0:t.alpha)&&void 0!==e?e:1},keying:{value:!1},color:{value:new RF(65280)},similarity:{value:.2},smoothness:{value:.2},spill:{value:.1}},vertexShader:"varying vec2 vUv;\nuniform vec2 repeat;\nuniform vec2 offset;\n\nvoid main() {\n    vUv = uv * repeat + offset;\n    gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );\n}\n",fragmentShader:"// https://www.8thwall.com/playground/chromakey-threejs\n\nuniform sampler2D map;\nuniform float alpha;\nuniform bool keying;\nuniform vec3 color;\nuniform float similarity;\nuniform float smoothness;\nuniform float spill;\n\nvarying vec2 vUv;\n\nvec2 RGBtoUV(vec3 rgb) {\n    return vec2(\n        rgb.r * -0.169 + rgb.g * -0.331 + rgb.b *  0.5    + 0.5,\n        rgb.r *  0.5   + rgb.g * -0.419 + rgb.b * -0.081  + 0.5\n    );\n}\n\nvoid main(void) {\n    gl_FragColor = texture2D(map, vUv);\n\n    if (keying) {\n        float chromaDist = distance(RGBtoUV(gl_FragColor.rgb), RGBtoUV(color));\n\n        float baseMask = chromaDist - similarity;\n        float fullMask = pow(clamp(baseMask / smoothness, 0., 1.), 1.5);\n        gl_FragColor.a *= fullMask * alpha;\n\n        float spillVal = pow(clamp(baseMask / spill, 0., 1.), 1.5);\n        float desat = clamp(gl_FragColor.r * 0.2126 + gl_FragColor.g * 0.7152 + gl_FragColor.b * 0.0722, 0., 1.);\n        gl_FragColor.rgb = mix(vec3(desat, desat, desat), gl_FragColor.rgb, spillVal);\n    } else {\n        gl_FragColor.a *= alpha;\n    }\n}\n"}),this.chromaKey=null===t||void 0===t?void 0:t.chromaKey}};function DB(t,e,n){const[i,r]=t,[s,a]=e,o=gL.greatArcDistance(t,e),l=Math.sin((1-n)*o)/Math.sin(o),c=Math.sin(n*o)/Math.sin(o),u=l*Math.cos(r)*Math.cos(i)+c*Math.cos(a)*Math.cos(s),h=l*Math.cos(r)*Math.sin(i)+c*Math.cos(a)*Math.sin(s),d=l*Math.sin(r)+c*Math.sin(a);return[Math.atan2(h,u),Math.atan2(d,Math.sqrt(u*u+h*h))]}function PB(t){return t.reduce((t,e)=>t.add(e),new jO).normalize()}function IB(t){const e=function(t){const e=[t[0]];let n=0;for(let i=1;i<t.length;i++){const r=t[i-1][0]-t[i][0];r>Math.PI?n+=1:r<-Math.PI&&(n-=1),e.push([t[i][0]+2*n*Math.PI,t[i][1]])}return e}(t);let n=0;const i=[];for(let s=0;s<e.length-1;s++){const t=gL.greatArcDistance(e[s],e[s+1])*tL.SPHERE_RADIUS;i.push(t),n+=t}let r=0;for(let s=0;s<e.length-1;s++){if(r+i[s]>n/2){const t=(n/2-r)/i[s];return DB(e[s],e[s+1],t)}r+=i[s]}return e[Math.round(e.length/2)]}var OB=new jO,NB=new jO,FB=new jO,UB=new jO,BB=new jO,zB=new jO;function HB(t,e,n){OB.copy(n).normalize(),NB.crossVectors(t,e).normalize(),FB.crossVectors(NB,t).normalize(),UB.copy(t).multiplyScalar(-OB.dot(FB)),BB.copy(FB).multiplyScalar(OB.dot(t));const i=(new jO).addVectors(UB,BB).normalize();return zB.crossVectors(i,OB),i.applyAxisAngle(zB,.01).multiplyScalar(tL.SPHERE_RADIUS)}var VB=class extends CB{get threeElement(){return this.element}get threeMesh(){return this.threeElement.children[0]}get video(){return"videoLayer"===this.type?this.threeMesh.material.map.image:null}constructor(t,e,n){super(t,e,n)}is3d(){return!0}createElement(){const t=new LB({alpha:0}),e=new fU(1,1),n=new aU(e,t);n.userData={[hB]:this},Object.defineProperty(n,"visible",{enumerable:!0,get:function(){return this.userData[hB].config.visible},set:function(t){this.userData[hB].config.visible=t}}),this.element=(new uU).add(n),"videoLayer"===this.type&&this.viewer.needsContinuousUpdate(!0)}destroy(){delete this.threeMesh.userData[hB],"videoLayer"===this.type&&(this.video.pause(),this.viewer.needsContinuousUpdate(!1)),super.destroy()}render(){return this.viewer.renderer.isObjectVisible(this.threeMesh)?this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position):null}update(t){super.update(t);const e=this.threeMesh,n=e.parent,i=e.material;if(gL.isExtendedPosition(this.config.position)){try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(Wq){throw new qL("invalid marker ".concat(this.id," position"),Wq)}if(!this.config.size)throw new qL("missing marker ".concat(this.id," size"));this.state.size=this.config.size,e.scale.set(this.config.size.width/100,this.config.size.height/100,1),e.position.set(e.scale.x*(.5-this.state.anchor.x),e.scale.y*(this.state.anchor.y-.5),0),e.rotation.set(0,0,0),this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position,n.position),n.lookAt(0,n.position.y,0),e.rotateY(-this.config.rotation.yaw),e.rotateX(-this.config.rotation.pitch),e.rotateZ(-this.config.rotation.roll);const t=e.geometry.getAttribute("position");this.state.positions3D=[0,1,3,2].map(n=>{const i=new jO;return i.fromBufferAttribute(t,n),e.localToWorld(i)})}else{var r;if(4!==(null===(r=this.config.position)||void 0===r?void 0:r.length))throw new qL("missing marker ".concat(this.id," position"));let t;try{t=this.config.position.map(t=>this.viewer.dataHelper.cleanPosition(t))}catch(Wq){throw new qL("invalid marker ".concat(this.id," position"),Wq)}const n=t.map(t=>this.viewer.dataHelper.sphericalCoordsToVector3(t)),s=PB(n);this.state.position=this.viewer.dataHelper.vector3ToSphericalCoords(s),this.state.positions3D=n;const a=e.geometry.getAttribute("position");[n[0],n[1],n[3],n[2]].forEach((t,e)=>{a.setX(e,t.x),a.setY(e,t.y),a.setZ(e,t.z)}),a.needsUpdate=!0,this.__setTextureWrap(i)}switch(this.type){case"videoLayer":if(this.definition!==this.config.videoLayer){var s,a;null===(s=i.map)||void 0===s||s.dispose();const t=function(t){let{src:e,withCredentials:n,muted:i,autoplay:r}=t;const s=document.createElement("video");return s.crossOrigin=n?"use-credentials":"anonymous",s.loop=!0,s.playsInline=!0,s.autoplay=r,s.muted=i,s.preload="metadata",e instanceof MediaStream?s.srcObject=e:s.src=e,s}({src:this.config.videoLayer,withCredentials:this.viewer.config.withCredentials(this.config.videoLayer),muted:!0,autoplay:null===(a=this.config.autoplay)||void 0===a||a}),n=new dU(t);i.map=n,i.alpha=0,t.addEventListener("loadedmetadata",()=>{this.viewer&&(i.alpha=this.config.opacity,gL.isExtendedPosition(this.config.position)||(e.material.userData[hB]={width:t.videoWidth,height:t.videoHeight},this.__setTextureWrap(i)))},{once:!0}),t.autoplay&&t.play(),this.definition=this.config.videoLayer}else i.alpha=this.config.opacity;break;case"imageLayer":if(this.definition!==this.config.imageLayer){var o;null===(o=i.map)||void 0===o||o.dispose();const t=new lN;i.map=t,i.alpha=0,this.viewer.textureLoader.loadImage(this.config.imageLayer).then(n=>{this.viewer&&(gL.isExtendedPosition(this.config.position)||(e.material.userData[hB]={width:n.width,height:n.height},this.__setTextureWrap(i)),t.image=n,t.anisotropy=4,t.needsUpdate=!0,i.alpha=this.config.opacity,this.viewer.needsUpdate())}),this.definition=this.config.imageLayer}else i.alpha=this.config.opacity}i.chromaKey=this.config.chromaKey,e.renderOrder=1e3+this.config.zIndex,e.geometry.boundingBox=null}__setTextureWrap(t){const e=t.userData[hB];if(!e||!e.height||!e.width)return t.repeat.set(1,1),void t.offset.set(0,0);const n=this.config.position.map(t=>this.viewer.dataHelper.cleanPosition(t)),i=(gL.greatArcDistance([n[0].yaw,n[0].pitch],[n[1].yaw,n[1].pitch])+gL.greatArcDistance([n[3].yaw,n[3].pitch],[n[2].yaw,n[2].pitch]))/(gL.greatArcDistance([n[1].yaw,n[1].pitch],[n[2].yaw,n[2].pitch])+gL.greatArcDistance([n[0].yaw,n[0].pitch],[n[3].yaw,n[3].pitch])),r=e.width/e.height;let s=0,a=0;i<r?s=r-i:a=1/r-1/i,t.repeat.set(1-s,1-a),t.offset.set(s/2,a/2)}},GB=class extends RB{constructor(t,e,n){super(t,e,n),this.viewportIntersection=!1}get threeElement(){return this.object}isCss3d(){return!0}createElement(){this.element=document.createElement("div"),this.object=new xB(this.element),this.object.userData={[hB]:this},Object.defineProperty(this.object,"visible",{enumerable:!0,get:function(){return this.userData[hB].config.visible},set:function(t){this.userData[hB].config.visible=t}}),this.afterCreateElement()}destroy(){delete this.object.userData[hB],delete this.object,super.destroy()}render(t){let{viewerPosition:e,zoomLevel:n}=t;const i=this.domElement;this.state.size={width:i.offsetWidth,height:i.offsetHeight};if(this.state.positions3D[0].dot(this.viewer.state.direction)>0&&this.viewportIntersection){var r,s;const t=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position);return null===(r=(s=this.config.elementLayer).updateMarker)||void 0===r||r.call(s,{marker:this,position:t,viewerPosition:e,zoomLevel:n,viewerSize:this.viewer.state.size}),t}return null}update(t){if(super.update(t),!gL.isExtendedPosition(this.config.position))throw new qL("missing marker ".concat(this.id," position"));try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(Wq){throw new qL("invalid marker ".concat(this.id," position"),Wq)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const e=this.threeElement,n=this.domElement;n.classList.add("psv-marker--css3d"),n.childNodes.forEach(t=>t.remove()),n.appendChild(this.config.elementLayer),this.config.elementLayer.style.display="block",e.position.copy(this.state.positions3D[0]).multiplyScalar(100),e.lookAt(0,100*this.state.positions3D[0].y,0),e.rotateY(-this.config.rotation.yaw),e.rotateX(-this.config.rotation.pitch),e.rotateZ(-this.config.rotation.roll)}},jB=class extends kB{constructor(t,e,n){super(t,e,n)}isNormal(){return!0}createElement(){this.element=document.createElement("div"),this.afterCreateElement()}render(t){const e=super.render(t);var n,i;e&&"element"===this.type&&(null===(n=(i=this.config.element).updateMarker)||void 0===n||n.call(i,{marker:this,position:e,viewerPosition:t.viewerPosition,zoomLevel:t.zoomLevel,viewerSize:this.viewer.state.size}));return e}update(t){super.update(t);const e=this.domElement;if(this.config.image&&!this.config.size)throw new qL("missing marker ".concat(this.id," size"));switch(this.config.size?(this.needsUpdateSize=!1,this.state.size=this.config.size,e.style.width=this.config.size.width+"px",e.style.height=this.config.size.height+"px"):this.needsUpdateSize=!0,this.type){case"image":this.definition=this.config.image,e.style.backgroundImage='url("'.concat(this.config.image,'")');break;case"html":this.definition=this.config.html,e.innerHTML=this.config.html;break;case"element":this.definition!==this.config.element&&(this.definition=this.config.element,e.childNodes.forEach(t=>t.remove()),e.appendChild(this.config.element),this.config.element.style.display="block")}}},WB=class extends RB{constructor(t,e,n){super(t,e,n)}createElement(){this.element=document.createElementNS(uB,"path"),this.element[hB]=this}isPoly(){return!0}get isPixels(){return"polygonPixels"===this.type||"polylinePixels"===this.type}get isPolygon(){return"polygon"===this.type||"polygonPixels"===this.type}get isPolyline(){return"polyline"===this.type||"polylinePixels"===this.type}get coords(){return this.definition}render(){const t=this.__getAllPolyPositions();if(t[0].length>(this.isPolygon?2:1)){const e=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position),n=t.filter(t=>t.length>0).map(t=>{let n="M";return n+=t.map(t=>"".concat(t.x-e.x,",").concat(t.y-e.y)).join("L"),this.isPolygon&&(n+="Z"),n}).join(" ");return this.domElement.setAttributeNS(null,"d",n),this.domElement.setAttributeNS(null,"transform","translate(".concat(e.x," ").concat(e.y,")")),e}return null}update(t){super.update(t);const e=this.domElement;e.classList.add("psv-marker--poly"),this.config.svgStyle?(Object.entries(this.config.svgStyle).forEach(t=>{let[n,i]=t;e.setAttributeNS(null,gL.dasherize(n),i)}),this.isPolyline&&!this.config.svgStyle.fill&&e.setAttributeNS(null,"fill","none")):this.isPolygon?e.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"):this.isPolyline&&(e.setAttributeNS(null,"fill","none"),e.setAttributeNS(null,"stroke","rgb(0,0,0)"));try{let t=this.config[this.type];if(!Array.isArray(t[0])&&"object"!==typeof t[0])for(let e=0;e<t.length;e++)t.splice(e,2,[t[e],t[e+1]]);if(Array.isArray(t[0][0])||"object"===typeof t[0][0]||(t=[t]),this.isPolyline&&t.length>1)throw new qL("polylines cannot have holes");this.isPixels?this.definition=t.map(t=>t.map(t=>{let e;return e=gL.isExtendedPosition(t)?this.viewer.dataHelper.cleanPosition(t):this.viewer.dataHelper.textureCoordsToSphericalCoords({textureX:t[0],textureY:t[1]}),[e.yaw,e.pitch]})):this.definition=t.map(t=>t.map(t=>{let e;return e=gL.isExtendedPosition(t)?this.viewer.dataHelper.cleanPosition(t):this.viewer.dataHelper.cleanPosition({yaw:t[0],pitch:t[1]}),[e.yaw,e.pitch]}))}catch(Wq){throw new qL("invalid marker ".concat(this.id," position"),Wq)}if(this.positions3D=this.coords.map(t=>t.map(t=>this.viewer.dataHelper.sphericalCoordsToVector3({yaw:t[0],pitch:t[1]}))),this.isPolygon){const t=PB(this.positions3D[0]);this.state.position=this.viewer.dataHelper.vector3ToSphericalCoords(t)}else{const t=IB(this.coords[0]);this.state.position={yaw:t[0],pitch:t[1]}}this.state.positions3D=this.positions3D[0]}__getAllPolyPositions(){return this.positions3D.map(t=>this.__getPolyPositions(t))}__getPolyPositions(t){const e=t.length,n=t.map(t=>({vector:t,visible:t.dot(this.viewer.state.direction)>0})),i=[];return n.forEach((t,r)=>{if(!t.visible){[0===r?n[e-1]:n[r-1],r===e-1?n[0]:n[r+1]].forEach(e=>{e.visible&&i.push({visible:e.vector,invisible:t.vector,index:r})})}}),i.reverse().forEach(t=>{n.splice(t.index,0,{vector:HB(t.visible,t.invisible,this.viewer.state.direction),visible:!0})}),n.filter(t=>t.visible).map(t=>this.viewer.dataHelper.vector3ToViewerCoords(t.vector))}},YB=class extends kB{get svgElement(){return this.domElement.firstElementChild}constructor(t,e,n){super(t,e,n)}isSvg(){return!0}createElement(){const t="square"===this.type?"rect":this.type,e=document.createElementNS(uB,t);this.element=document.createElementNS(uB,"svg"),this.element.appendChild(e),this.afterCreateElement()}update(t){super.update(t);const e=this.svgElement;switch(this.needsUpdateSize=!0,this.type){case"square":this.definition={x:0,y:0,width:this.config.square,height:this.config.square};break;case"rect":Array.isArray(this.config.rect)?this.definition={x:0,y:0,width:this.config.rect[0],height:this.config.rect[1]}:this.definition={x:0,y:0,width:this.config.rect.width,height:this.config.rect.height};break;case"circle":this.definition={cx:this.config.circle,cy:this.config.circle,r:this.config.circle};break;case"ellipse":Array.isArray(this.config.ellipse)?this.definition={cx:this.config.ellipse[0],cy:this.config.ellipse[1],rx:this.config.ellipse[0],ry:this.config.ellipse[1]}:this.definition={cx:this.config.ellipse.rx,cy:this.config.ellipse.ry,rx:this.config.ellipse.rx,ry:this.config.ellipse.ry};break;case"path":this.definition={d:this.config.path}}Object.entries(this.definition).forEach(t=>{let[n,i]=t;e.setAttributeNS(null,n,i)}),this.config.svgStyle?Object.entries(this.config.svgStyle).forEach(t=>{let[n,i]=t;e.setAttributeNS(null,gL.dasherize(n),i)}):e.setAttributeNS(null,"fill","rgba(0,0,0,0.5)")}},XB=gL.getConfigParser({clickEventOnMarker:!1,gotoMarkerSpeed:"8rpm",markers:null,defaultHoverScale:null},{defaultHoverScale:t=>t?(!0===t&&(t=mB),"number"===typeof t&&(t={amount:t}),Rr(Rr({},mB),t)):null});var KB=class t extends pI{constructor(t,e){super(t,e),this.markers={},this.state={allVisible:!0,showAllTooltips:!1,currentMarker:null,hoveringMarker:null,needsReRender:!1,lastClientX:null,lastClientY:null},this.container=document.createElement("div"),this.container.className="psv-markers",this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",t=>t.preventDefault()),this.svgContainer=document.createElementNS(uB,"svg"),this.svgContainer.setAttribute("class","psv-markers-svg-container"),this.container.appendChild(this.svgContainer),this.css3DContainer=new TB(t),this.container.appendChild(this.css3DContainer.element),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0)}static withConfig(e){return[t,e]}init(){super.init(),gL.checkStylesheet(this.viewer.container,"markers-plugin"),this.viewer.addEventListener(CD.ClickEvent.type,this),this.viewer.addEventListener(CD.DoubleClickEvent.type,this),this.viewer.addEventListener(CD.RenderEvent.type,this),this.viewer.addEventListener(CD.ConfigChangedEvent.type,this),this.viewer.addEventListener(CD.ObjectEnterEvent.type,this),this.viewer.addEventListener(CD.ObjectHoverEvent.type,this),this.viewer.addEventListener(CD.ObjectLeaveEvent.type,this),this.viewer.addEventListener(CD.ReadyEvent.type,this,{once:!0})}destroy(){this.clearMarkers(!1),this.viewer.unobserveObjects(hB),this.viewer.removeEventListener(CD.ClickEvent.type,this),this.viewer.removeEventListener(CD.DoubleClickEvent.type,this),this.viewer.removeEventListener(CD.RenderEvent.type,this),this.viewer.removeEventListener(CD.ObjectEnterEvent.type,this),this.viewer.removeEventListener(CD.ObjectHoverEvent.type,this),this.viewer.removeEventListener(CD.ObjectLeaveEvent.type,this),this.viewer.removeEventListener(CD.ReadyEvent.type,this),this.css3DContainer.destroy(),this.viewer.container.removeChild(this.container),super.destroy()}handleEvent(t){var e;switch(t.type){case CD.ReadyEvent.type:this.config.markers&&(this.setMarkers(this.config.markers),delete this.config.markers);break;case CD.RenderEvent.type:this.renderMarkers();break;case CD.ClickEvent.type:this.__onClick(t,!1);break;case CD.DoubleClickEvent.type:this.__onClick(t,!0);break;case CD.ObjectEnterEvent.type:case CD.ObjectLeaveEvent.type:case CD.ObjectHoverEvent.type:if(t.userDataKey===hB){const n=t.originalEvent,i=t.object.userData[hB];switch(t.type){case CD.ObjectEnterEvent.type:null!==(e=i.config.style)&&void 0!==e&&e.cursor?this.viewer.setCursor(i.config.style.cursor):(i.config.tooltip||i.config.content)&&this.viewer.setCursor("pointer"),this.__onEnterMarker(n,i);break;case CD.ObjectLeaveEvent.type:this.viewer.setCursor(null),this.__onLeaveMarker(i);break;case CD.ObjectHoverEvent.type:this.__onHoverMarker(n,i)}}break;case"mouseenter":{const e=this.__getTargetMarker(gL.getEventTarget(t));this.__onEnterMarker(t,e);break}case"mouseleave":{const e=this.__getTargetMarker(gL.getEventTarget(t));this.__onLeaveMarker(e);break}case"mousemove":{const e=this.__getTargetMarker(gL.getEventTarget(t),!0);this.__onHoverMarker(t,e);break}}}toggleAllMarkers(){this.state.allVisible?this.hideAllMarkers():this.showAllMarkers()}showAllMarkers(){this.state.allVisible=!0,Object.values(this.markers).forEach(t=>{t.config.visible=!0}),this.renderMarkers(),this.dispatchEvent(new sB)}hideAllMarkers(){this.state.allVisible=!1,Object.values(this.markers).forEach(t=>{t.config.visible=!1}),this.renderMarkers(),this.dispatchEvent(new eB)}toggleAllTooltips(){this.state.showAllTooltips?this.hideAllTooltips():this.showAllTooltips()}showAllTooltips(){this.state.showAllTooltips=!0,Object.values(this.markers).forEach(t=>{t.state.staticTooltip=!0,t.showTooltip()})}hideAllTooltips(){this.state.showAllTooltips=!1,Object.values(this.markers).forEach(t=>{t.state.staticTooltip=!1,t.hideTooltip()})}getNbMarkers(){return Object.keys(this.markers).length}getMarkers(){return Object.values(this.markers)}addMarker(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.markers[t.id])throw new qL('marker "'.concat(t.id,'" already exists'));const n=new(function(t){switch(AB(t,!1)){case"image":case"html":case"element":return jB;case"imageLayer":case"videoLayer":return VB;case"elementLayer":return GB;case"polygon":case"polyline":case"polygonPixels":case"polylinePixels":return WB;case"square":case"rect":case"circle":case"ellipse":case"path":return YB;default:throw new qL("invalid marker type")}}(t))(this.viewer,this,t);n.isPoly()?this.svgContainer.appendChild(n.domElement):n.isCss3d()?this.css3DContainer.addObject(n):n.is3d()?this.viewer.renderer.addObject(n.threeElement):this.container.appendChild(n.domElement),this.markers[n.id]=n,this.state.showAllTooltips&&(n.state.staticTooltip=!0),e&&this.__afterChangeMarkers()}getMarker(t){const e="object"===typeof t?t.id:t;if(!this.markers[e])throw new qL('cannot find marker "'.concat(e,'"'));return this.markers[e]}getCurrentMarker(){return this.state.currentMarker}updateMarker(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.getMarker(t.id);var i;(n.update(t),e)&&(this.__afterChangeMarkers(),(n===this.state.hoveringMarker&&"hover"===(null===(i=n.config.tooltip)||void 0===i?void 0:i.trigger)||n.state.staticTooltip)&&n.showTooltip(this.state.lastClientX,this.state.lastClientY,!0))}removeMarker(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.getMarker(t);n.isPoly()?this.svgContainer.removeChild(n.domElement):n.isCss3d()?this.css3DContainer.removeObject(n):n.is3d()?this.viewer.renderer.removeObject(n.threeElement):this.container.removeChild(n.domElement),this.state.hoveringMarker===n&&(this.state.hoveringMarker=null),this.state.currentMarker===n&&(this.state.currentMarker=null),n.destroy(),delete this.markers[n.id],e&&this.__afterChangeMarkers()}removeMarkers(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.forEach(t=>this.removeMarker(t,!1)),e&&this.__afterChangeMarkers()}setMarkers(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.clearMarkers(!1),null===t||void 0===t||t.forEach(t=>{this.addMarker(t,!1)}),e&&this.__afterChangeMarkers()}clearMarkers(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Object.keys(this.markers).forEach(t=>{this.removeMarker(t,!1)}),t&&this.__afterChangeMarkers()}gotoMarker(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.config.gotoMarkerSpeed;const n=this.getMarker(t);return e?this.viewer.animate(Rr(Rr({},n.state.position),{},{zoom:n.config.zoomLvl,speed:e})).then(()=>{this.dispatchEvent(new GU(n))}):(this.viewer.rotate(n.state.position),gL.isNil(n.config.zoomLvl)||this.viewer.zoom(n.config.zoomLvl),this.dispatchEvent(new GU(n)),Promise.resolve())}hideMarker(t){this.toggleMarker(t,!1)}showMarker(t){this.toggleMarker(t,!0)}showMarkerTooltip(t){const e=this.getMarker(t);e.state.staticTooltip=!0,e.showTooltip()}hideMarkerTooltip(t){const e=this.getMarker(t);e.state.staticTooltip=!1,e.hideTooltip()}toggleMarker(t,e){const n=this.getMarker(t);n.config.visible=gL.isNil(e)?!n.config.visible:e,this.renderMarkers()}showMarkerPanel(t){const e=this.getMarker(t);e.config.content?this.viewer.panel.show({id:fB,content:e.config.content}):this.hideMarkerPanel()}hideMarkerPanel(){this.viewer.panel.hide(fB)}toggleMarkersList(){this.viewer.panel.isVisible(pB)?this.hideMarkersList():this.showMarkersList()}showMarkersList(){let t=[];Object.values(this.markers).forEach(e=>{e.config.visible&&!e.config.hideList&&t.push(e)});const e=new oB(t);this.dispatchEvent(e),t=e.markers,this.viewer.panel.show({id:pB,content:gB(t,this.viewer.config.lang[lB.id]),noMargin:!0,clickHandler:t=>{const e=gL.getClosest(t,".psv-panel-menu-item"),n=e?e.dataset[hB]:void 0;if(n){const t=this.getMarker(n);this.dispatchEvent(new ZU(t)),this.gotoMarker(t.id),this.hideMarkersList()}}})}hideMarkersList(){this.viewer.panel.hide(pB)}renderMarkers(){if(this.state.needsReRender)return void(this.state.needsReRender=!1);const t=this.viewer.getZoomLevel(),e=this.viewer.getPosition(),n=this.state.hoveringMarker;Object.values(this.markers).forEach(i=>{let r=i.config.visible,s=!1,a=null;r&&(a=i.render({viewerPosition:e,zoomLevel:t,hoveringMarker:n}),r=!!a),s=i.state.visible!==r,i.state.visible=r,i.state.position2D=a,i.domElement&&gL.toggleClass(i.domElement,"psv-marker--visible",r),r?i.state.staticTooltip?i.showTooltip():i!==this.state.hoveringMarker&&i.hideTooltip():i.hideTooltip(),s&&(this.dispatchEvent(new HU(i,r)),(i.is3d()||i.isCss3d())&&(this.state.needsReRender=!0))}),this.state.needsReRender&&this.viewer.needsUpdate()}__getTargetMarker(t){if(t instanceof Node){const e=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?gL.getClosest(t,".psv-marker"):t;return e?e[hB]:void 0}return Array.isArray(t)?t.map(t=>t.userData[hB]).filter(t=>!!t).sort((t,e)=>e.config.zIndex-t.config.zIndex)[0]:null}__onEnterMarker(t,e){var n;e&&(this.state.hoveringMarker=e,this.state.lastClientX=t.clientX,this.state.lastClientY=t.clientY,this.dispatchEvent(new XU(e)),e instanceof kB&&e.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!0}),e.state.staticTooltip||"hover"!==(null===(n=e.config.tooltip)||void 0===n?void 0:n.trigger)||e.showTooltip(t.clientX,t.clientY))}__onLeaveMarker(t){var e;t&&(this.dispatchEvent(new WU(t)),t instanceof kB&&t.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!1}),this.state.hoveringMarker=null,t.state.staticTooltip||"hover"!==(null===(e=t.config.tooltip)||void 0===e?void 0:e.trigger)?t.state.staticTooltip&&t.showTooltip():t.hideTooltip())}__onHoverMarker(t,e){var n;e&&(this.state.lastClientX=t.clientX,this.state.lastClientY=t.clientY,(e.isPoly()||e.is3d()||e.isCss3d())&&"hover"===(null===(n=e.config.tooltip)||void 0===n?void 0:n.trigger)&&e.showTooltip(t.clientX,t.clientY))}__onClick(t,e){const n=this.__getTargetMarker(t.data.objects),i=this.__getTargetMarker(t.data.target,!0)||n;var r,s;this.state.currentMarker&&this.state.currentMarker!==i&&(this.dispatchEvent(new $U(this.state.currentMarker)),this.viewer.panel.hide(fB),this.state.showAllTooltips||"click"!==(null===(r=this.state.currentMarker.config.tooltip)||void 0===r?void 0:r.trigger)||this.hideMarkerTooltip(this.state.currentMarker.id),this.state.currentMarker=null);i&&(this.state.currentMarker=i,this.dispatchEvent(new qU(i,e,t.data.rightclick)),this.config.clickEventOnMarker?t.data.marker=i:t.stopImmediatePropagation(),this.markers[i.id]&&!t.data.rightclick&&("click"===(null===(s=i.config.tooltip)||void 0===s?void 0:s.trigger)?i.tooltip?this.hideMarkerTooltip(i.id):this.showMarkerTooltip(i.id):this.showMarkerPanel(i.id)))}__afterChangeMarkers(){this.__refreshUi(),this.__checkObjectsObserver(),this.viewer.needsUpdate(),this.dispatchEvent(new iB(this.getMarkers()))}__refreshUi(){var t,e;const n=Object.values(this.markers).filter(t=>!t.config.hideList).length;0===n?(this.viewer.panel.hide(fB),this.viewer.panel.hide(pB)):this.viewer.panel.isVisible(pB)?this.showMarkersList():this.viewer.panel.isVisible(fB)&&(this.state.currentMarker?this.showMarkerPanel(this.state.currentMarker.id):this.viewer.panel.hide()),null===(t=this.viewer.navbar.getButton(lB.id,!1))||void 0===t||t.toggle(n>0),null===(e=this.viewer.navbar.getButton(vB.id,!1))||void 0===e||e.toggle(n>0)}__checkObjectsObserver(){const t=Object.values(this.markers).some(t=>t.is3d());t?this.viewer.observeObjects(hB):this.viewer.unobserveObjects(hB)}};KB.id="markers",KB.VERSION="5.14.0",KB.configParser=XB,KB.readonlyOptions=["markers"];var qB=KB;gI.lang[lB.id]="Markers",gI.lang[vB.id]="Markers list",wI(lB,"caption:left"),wI(vB,"caption:left");const QB="\u041d\u043e\u043c\u0435\u0440 \u0410\u043b\u044c\u0444\u0430",ZB="\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u043e\u0435 \u0440\u0430\u0437\u043c\u0435\u0449\u0435\u043d\u0438\u0435 \u0432 \u0434\u0432\u0443\u0445\u043a\u043e\u043c\u043d\u0430\u0442\u043d\u043e\u043c \u043d\u043e\u043c\u0435\u0440\u0435",JB=12500,$B="\u043f\u0440\u043e\u0441\u0442\u043e\u0440\u043d\u044b\u0439 \u0447\u0435\u0442\u044b\u0440\u0435\u0445\u043c\u0435\u0441\u0442\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u043f\u043b\u043e\u0449\u0430\u0434\u044c\u044e 35,5 \u043c\xb2. \u0414\u0432\u0435 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0435 \u0441\u043f\u0430\u043b\u044c\u043d\u0438 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044e\u0442 \u043b\u0438\u0447\u043d\u043e\u0435 \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e \u043a\u0430\u0436\u0434\u043e\u043c\u0443, \u0434\u0432\u0430 \u0441\u0430\u043d\u0443\u0437\u043b\u0430 \u0438\u0437\u0431\u0430\u0432\u043b\u044f\u044e\u0442 \u043e\u0442 \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439 \u043f\u043e \u0443\u0442\u0440\u0430\u043c. \u0415\u0441\u0442\u044c \u043f\u0440\u0438\u0445\u043e\u0436\u0430\u044f \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u043d\u043e\u0433\u043e \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0432\u0435\u0449\u0435\u0439",tz=t=>{Object.assign({},(Ya(t),t));const e=(0,i.useContext)(E),n=(0,i.useContext)(w),r=(0,i.useContext)(S),s=Is(),a=(0,i.useRef)(null),[o,l]=(Fs(),(0,i.useState)(!1)),[c,u]=(0,i.useState)(2),[h,d]=(0,i.useState)("layout"),[f,p]=(0,i.useState)("kitchen"),g={kitchen:{image:Xx,markers:[{id:"bathroom",image:Qx,size:{width:100,height:100},position:{yaw:"160.5deg",pitch:"-0.1deg"},tooltip:"\u0412\u0430\u043d\u043d\u0430\u044f \u043a\u043e\u043c\u043d\u0430\u0442\u0430"},{id:"bedroom",image:Qx,size:{width:100,height:100},position:{yaw:"230.5deg",pitch:"-0.1deg"},tooltip:"\u0416\u0438\u043b\u0430\u044f \u043a\u043e\u043c\u043d\u0430\u0442\u0430"}]},bedroom:{image:qx,markers:[{id:"kitchen",image:Qx,size:{width:100,height:100},position:{yaw:"110.5deg",pitch:"-0.1deg"},tooltip:"\u041a\u0443\u0445\u043d\u044f"},{id:"bathroom",image:Qx,size:{width:100,height:100},position:{yaw:"10.5deg",pitch:"-0.1deg"},tooltip:"\u0412\u0430\u043d\u043d\u0430\u044f \u043a\u043e\u043c\u043d\u0430\u0442\u0430"}]},bathroom:{image:Kx,markers:[{id:"kitchen",image:Qx,size:{width:100,height:100},position:{yaw:"270.5deg",pitch:"-0.1deg"},tooltip:"\u041a\u0443\u0445\u043d\u044f"}]}};(0,i.useEffect)(()=>{e[1]("room"),n[1]("price"),s.state||r[1]("price")},[]);const v=t=>{t.clearMarkers(!0),g[f].markers.forEach(e=>{t.addMarker(Rr({},e))}),g[f].markers.forEach(e=>{t.getMarker(e.id).domElement.addEventListener("click",()=>{p(e.id)})})};(0,i.useEffect)(()=>{if(a.current){const t=a.current.getPlugin(qB);if(!t)return;v(t)}},[f]);return(0,m.jsxs)("main",{className:Mx,children:[(0,m.jsxs)("div",{className:Ax,children:[(0,m.jsx)("div",{className:Px,children:QB}),(0,m.jsx)("div",{className:Ox,children:ZB}),(0,m.jsxs)("div",{className:Ix,children:[(0,m.jsx)(Wx,{className:"".concat(Hx," ").concat(!o&&Vx),title:"\u0411\u0435\u0437 \u0431\u0430\u043b\u043a\u043e\u043da",onClick:()=>l(!1)}),(0,m.jsx)(Wx,{className:"".concat(Hx," ").concat(o&&Vx),title:"\u0421 \u0431\u0430\u043b\u043a\u043e\u043d\u043e\u043c",onClick:()=>l(!0)})]}),(0,m.jsxs)("div",{className:Ix,children:[(0,m.jsx)(Wx,{className:"".concat(Hx," ").concat(2===c&&Vx),title:"2 \u044d\u0442\u0430\u0436",onClick:()=>u(2)}),(0,m.jsx)(Wx,{className:"".concat(Hx," ").concat(3===c&&Vx),title:"3 \u044d\u0442\u0430\u0436",onClick:()=>u(3)}),(0,m.jsx)(Wx,{className:"".concat(Hx," ").concat(4===c&&Vx),title:"4 \u044d\u0442\u0430\u0436",onClick:()=>u(4)}),(0,m.jsx)(Wx,{className:"".concat(Hx," ").concat(5===c&&Vx),title:"5 \u044d\u0442\u0430\u0436",onClick:()=>u(5)}),(0,m.jsx)(Wx,{className:"".concat(Hx," ").concat(6===c&&Vx),title:"6 \u044d\u0442\u0430\u0436",onClick:()=>u(6)})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:Ux,children:"\u041e \u043d\u043e\u043c\u0435\u0440\u0435"}),(0,m.jsx)("div",{className:Bx,children:$B})]}),(0,m.jsx)("div",{className:Nx,children:(0,m.jsxs)("div",{className:Fx,children:[JB," \u20bd/\u043c\u0435\u0441."]})}),(0,m.jsx)("div",{className:zx,children:(0,m.jsx)(Wx,{className:Hx,title:"\u041f\u043e\u0434\u0430\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443",onClick:()=>{}})})]}),(0,m.jsxs)("div",{className:Rx,style:{backgroundImage:"url(image/".concat("layout"===h?"room-alpha.svg":"room1.jpg",")")},children:[(0,m.jsx)("div",{className:kx}),(0,m.jsxs)("div",{className:Lx,children:[(0,m.jsx)("div",{children:(0,m.jsx)(Wx,{title:"\u041f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u043a\u0430 \u043d\u043e\u043c\u0435\u0440\u0430",active:"layout"===h,onClick:()=>d("layout")})}),(0,m.jsx)("div",{children:(0,m.jsx)(Wx,{title:"3\u0434 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u043d\u043e\u043c\u0435\u0440\u0430",active:"3d"===h,onClick:()=>d("3d")})})]}),(0,m.jsx)("div",{className:Dx,children:"layout"===h?(0,m.jsx)("img",{className:Cx,src:Yx}):(0,m.jsx)(eO,{src:g[f].image,height:"100%",width:"100%",littlePlanet:!1,navbar:[],plugins:[[qB,Rr({},g[f].markers)]],onReady:t=>{a.current=t;const e=a.current.getPlugin(qB);e&&v(e)}})})]})]})},ez="SearchPageComponent_main__PnAOq",nz="SearchPageComponent_filters__GIl-1",iz="SearchPageComponent_description_filter__qW7JT",rz="SearchPageComponent_item__o903z",sz="SearchPageComponent_item_date_start__l7Pb4",az="SearchPageComponent_item_date__rOtZA",oz="SearchPageComponent_results__7Od9b",lz="SearchPageComponent_button__G09ga",cz="SearchPageComponent_list__3kDI2";function uz(t){var e,n,i="";if("string"==typeof t||"number"==typeof t)i+=t;else if("object"==typeof t)if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=uz(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function hz(){for(var t,e,n=0,i="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=uz(t))&&(i&&(i+=" "),i+=e);return i}Math.pow(10,8);const dz=6048e5,fz=6e4,pz=36e5,mz=Symbol.for("constructDateFrom");function gz(t,e){return"function"===typeof t?t(e):t&&"object"===typeof t&&mz in t?t[mz](e):t instanceof Date?new t.constructor(e):new Date(e)}function vz(t,e){return gz(e||t,t)}function yz(t,e){var n;const i=()=>gz(null===e||void 0===e?void 0:e.in,NaN),r=null!==(n=null===e||void 0===e?void 0:e.additionalDigits)&&void 0!==n?n:2,s=function(t){const e={},n=t.split(_z.dateTimeDelimiter);let i;if(n.length>2)return e;/:/.test(n[0])?i=n[0]:(e.date=n[0],i=n[1],_z.timeZoneDelimiter.test(e.date)&&(e.date=t.split(_z.timeZoneDelimiter)[0],i=t.substr(e.date.length,t.length)));if(i){const t=_z.timezone.exec(i);t?(e.time=i.replace(t[1],""),e.timezone=t[1]):e.time=i}return e}(t);let a;if(s.date){const t=function(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),i=t.match(n);if(!i)return{year:NaN,restDateString:""};const r=i[1]?parseInt(i[1]):null,s=i[2]?parseInt(i[2]):null;return{year:null===s?r:100*s,restDateString:t.slice((i[1]||i[2]).length)}}(s.date,r);a=function(t,e){if(null===e)return new Date(NaN);const n=t.match(bz);if(!n)return new Date(NaN);const i=!!n[4],r=wz(n[1]),s=wz(n[2])-1,a=wz(n[3]),o=wz(n[4]),l=wz(n[5])-1;if(i)return function(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}(0,o,l)?function(t,e,n){const i=new Date(0);i.setUTCFullYear(t,0,4);const r=i.getUTCDay()||7,s=7*(e-1)+n+1-r;return i.setUTCDate(i.getUTCDate()+s),i}(e,o,l):new Date(NaN);{const t=new Date(0);return function(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(Tz[e]||(Mz(t)?29:28))}(e,s,a)&&function(t,e){return e>=1&&e<=(Mz(t)?366:365)}(e,r)?(t.setUTCFullYear(e,s,Math.max(r,a)),t):new Date(NaN)}}(t.restDateString,t.year)}if(!a||isNaN(+a))return i();const o=+a;let l,c=0;if(s.time&&(c=function(t){const e=t.match(xz);if(!e)return NaN;const n=Sz(e[1]),i=Sz(e[2]),r=Sz(e[3]);if(!function(t,e,n){if(24===t)return 0===e&&0===n;return n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}(n,i,r))return NaN;return n*pz+i*fz+1e3*r}(s.time),isNaN(c)))return i();if(!s.timezone){const t=new Date(o+c),n=vz(0,null===e||void 0===e?void 0:e.in);return n.setFullYear(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()),n.setHours(t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()),n}return l=function(t){if("Z"===t)return 0;const e=t.match(Ez);if(!e)return 0;const n="+"===e[1]?-1:1,i=parseInt(e[2]),r=e[3]&&parseInt(e[3])||0;if(!function(t,e){return e>=0&&e<=59}(0,r))return NaN;return n*(i*pz+r*fz)}(s.timezone),isNaN(l)?i():vz(o+c+l,null===e||void 0===e?void 0:e.in)}const _z={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},bz=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,xz=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Ez=/^([+-])(\d{2})(?::?(\d{2}))?$/;function wz(t){return t?parseInt(t):1}function Sz(t){return t&&parseFloat(t.replace(",","."))||0}const Tz=[31,null,31,30,31,30,31,31,30,31,30,31];function Mz(t){return t%400===0||t%4===0&&t%100!==0}const Az={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function Cz(t){return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const Rz={date:Cz({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:Cz({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:Cz({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},kz={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function Lz(t){return(e,n)=>{let i;if("formatting"===(null!==n&&void 0!==n&&n.context?String(n.context):"standalone")&&t.formattingValues){const e=t.defaultFormattingWidth||t.defaultWidth,r=null!==n&&void 0!==n&&n.width?String(n.width):e;i=t.formattingValues[r]||t.formattingValues[e]}else{const e=t.defaultWidth,r=null!==n&&void 0!==n&&n.width?String(n.width):t.defaultWidth;i=t.values[r]||t.values[e]}return i[t.argumentCallback?t.argumentCallback(e):e]}}const Dz={ordinalNumber:(t,e)=>{const n=Number(t),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:Lz({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:Lz({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:t=>t-1}),month:Lz({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:Lz({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:Lz({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function Pz(t){return function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=n.width,r=i&&t.matchPatterns[i]||t.matchPatterns[t.defaultMatchWidth],s=e.match(r);if(!s)return null;const a=s[0],o=i&&t.parsePatterns[i]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(o)?function(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n;return}(o,t=>t.test(a)):function(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n;return}(o,t=>t.test(a));let c;c=t.valueCallback?t.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;return{value:c,rest:e.slice(a.length)}}}const Iz={ordinalNumber:(Oz={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:t=>parseInt(t,10)},function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.match(Oz.matchPattern);if(!n)return null;const i=n[0],r=t.match(Oz.parsePattern);if(!r)return null;let s=Oz.valueCallback?Oz.valueCallback(r[0]):r[0];return s=e.valueCallback?e.valueCallback(s):s,{value:s,rest:t.slice(i.length)}}),era:Pz({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:Pz({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:t=>t+1}),month:Pz({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:Pz({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:Pz({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})};var Oz;const Nz={code:"en-US",formatDistance:(t,e,n)=>{let i;const r=Az[t];return i="string"===typeof r?r:1===e?r.one:r.other.replace("{{count}}",e.toString()),null!==n&&void 0!==n&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i},formatLong:Rz,formatRelative:(t,e,n,i)=>kz[t],localize:Dz,match:Iz,options:{weekStartsOn:0,firstWeekContainsDate:1}},Fz=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});default:return e.date({width:"full"})}},Uz=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});default:return e.time({width:"full"})}},Bz={p:Uz,P:(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],i=n[1],r=n[2];if(!r)return Fz(t,e);let s;switch(i){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;default:s=e.dateTime({width:"full"})}return s.replace("{{date}}",Fz(i,e)).replace("{{time}}",Uz(r,e))}},zz=/^D+$/,Hz=/^Y+$/,Vz=["D","DD","YY","YYYY"];function Gz(t){return zz.test(t)}function jz(t){return Hz.test(t)}function Wz(t,e,n){const i=function(t,e,n){const i="Y"===t[0]?"years":"days of the month";return"Use `".concat(t.toLowerCase(),"` instead of `").concat(t,"` (in `").concat(e,"`) for formatting ").concat(i," to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md")}(t,e,n);if(console.warn(i),Vz.includes(t))throw new RangeError(i)}let Yz={};function Xz(){return Yz}function Kz(){return Object.assign({},Xz())}function qz(t,e){const n=function(t){var e;return"function"===typeof t&&(null===(e=t.prototype)||void 0===e?void 0:e.constructor)===t}(e)?new e(0):gz(e,0);return n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),n.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),n}class Qz{constructor(){Ar(this,"subPriority",0)}validate(t,e){return!0}}class Zz extends Qz{constructor(t,e,n,i,r){super(),this.value=t,this.validateValue=e,this.setValue=n,this.priority=i,r&&(this.subPriority=r)}validate(t,e){return this.validateValue(t,this.value,e)}set(t,e,n){return this.setValue(t,e,this.value,n)}}class Jz extends Qz{constructor(t,e){super(),Ar(this,"priority",10),Ar(this,"subPriority",-1),this.context=t||(t=>gz(e,t))}set(t,e){return e.timestampIsSet?t:gz(t,qz(t,this.context))}}class $z{run(t,e,n,i){const r=this.parse(t,e,n,i);return r?{setter:new Zz(r.value,this.validate,this.set,this.priority,this.subPriority),rest:r.rest}:null}validate(t,e,n){return!0}}const tH=/^(1[0-2]|0?\d)/,eH=/^(3[0-1]|[0-2]?\d)/,nH=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,iH=/^(5[0-3]|[0-4]?\d)/,rH=/^(2[0-3]|[0-1]?\d)/,sH=/^(2[0-4]|[0-1]?\d)/,aH=/^(1[0-1]|0?\d)/,oH=/^(1[0-2]|0?\d)/,lH=/^[0-5]?\d/,cH=/^[0-5]?\d/,uH=/^\d/,hH=/^\d{1,2}/,dH=/^\d{1,3}/,fH=/^\d{1,4}/,pH=/^-?\d+/,mH=/^-?\d/,gH=/^-?\d{1,2}/,vH=/^-?\d{1,3}/,yH=/^-?\d{1,4}/,_H=/^([+-])(\d{2})(\d{2})?|Z/,bH=/^([+-])(\d{2})(\d{2})|Z/,xH=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,EH=/^([+-])(\d{2}):(\d{2})|Z/,wH=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function SH(t,e){return t?{value:e(t.value),rest:t.rest}:t}function TH(t,e){const n=e.match(t);return n?{value:parseInt(n[0],10),rest:e.slice(n[0].length)}:null}function MH(t,e){const n=e.match(t);if(!n)return null;if("Z"===n[0])return{value:0,rest:e.slice(1)};const i="+"===n[1]?1:-1,r=n[2]?parseInt(n[2],10):0,s=n[3]?parseInt(n[3],10):0,a=n[5]?parseInt(n[5],10):0;return{value:i*(r*pz+s*fz+1e3*a),rest:e.slice(n[0].length)}}function AH(t){return TH(pH,t)}function CH(t,e){switch(t){case 1:return TH(uH,e);case 2:return TH(hH,e);case 3:return TH(dH,e);case 4:return TH(fH,e);default:return TH(new RegExp("^\\d{1,"+t+"}"),e)}}function RH(t,e){switch(t){case 1:return TH(mH,e);case 2:return TH(gH,e);case 3:return TH(vH,e);case 4:return TH(yH,e);default:return TH(new RegExp("^-?\\d{1,"+t+"}"),e)}}function kH(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function LH(t,e){const n=e>0,i=n?e:1-e;let r;if(i<=50)r=t||100;else{const e=i+50;r=t+100*Math.trunc(e/100)-(t>=e%100?100:0)}return n?r:1-r}function DH(t){return t%400===0||t%4===0&&t%100!==0}function PH(t,e){var n,i,r,s,a,o;const l=Xz(),c=null!==(n=null!==(i=null!==(r=null!==(s=null===e||void 0===e?void 0:e.weekStartsOn)&&void 0!==s?s:null===e||void 0===e||null===(a=e.locale)||void 0===a||null===(a=a.options)||void 0===a?void 0:a.weekStartsOn)&&void 0!==r?r:l.weekStartsOn)&&void 0!==i?i:null===(o=l.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==n?n:0,u=vz(t,null===e||void 0===e?void 0:e.in),h=u.getDay(),d=(h<c?7:0)+h-c;return u.setDate(u.getDate()-d),u.setHours(0,0,0,0),u}function IH(t,e){var n,i,r,s,a,o;const l=vz(t,null===e||void 0===e?void 0:e.in),c=l.getFullYear(),u=Xz(),h=null!==(n=null!==(i=null!==(r=null!==(s=null===e||void 0===e?void 0:e.firstWeekContainsDate)&&void 0!==s?s:null===e||void 0===e||null===(a=e.locale)||void 0===a||null===(a=a.options)||void 0===a?void 0:a.firstWeekContainsDate)&&void 0!==r?r:u.firstWeekContainsDate)&&void 0!==i?i:null===(o=u.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==n?n:1,d=gz((null===e||void 0===e?void 0:e.in)||t,0);d.setFullYear(c+1,0,h),d.setHours(0,0,0,0);const f=PH(d,e),p=gz((null===e||void 0===e?void 0:e.in)||t,0);p.setFullYear(c,0,h),p.setHours(0,0,0,0);const m=PH(p,e);return+l>=+f?c+1:+l>=+m?c:c-1}function OH(t,e){return PH(t,Rr(Rr({},e),{},{weekStartsOn:1}))}function NH(t,e){var n,i,r,s,a,o;const l=Xz(),c=null!==(n=null!==(i=null!==(r=null!==(s=null===e||void 0===e?void 0:e.firstWeekContainsDate)&&void 0!==s?s:null===e||void 0===e||null===(a=e.locale)||void 0===a||null===(a=a.options)||void 0===a?void 0:a.firstWeekContainsDate)&&void 0!==r?r:l.firstWeekContainsDate)&&void 0!==i?i:null===(o=l.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==n?n:1,u=IH(t,e),h=gz((null===e||void 0===e?void 0:e.in)||t,0);h.setFullYear(u,0,c),h.setHours(0,0,0,0);return PH(h,e)}function FH(t,e){const n=vz(t,null===e||void 0===e?void 0:e.in),i=+PH(n,e)-+NH(n,e);return Math.round(i/dz)+1}function UH(t,e,n){const i=vz(t,null===n||void 0===n?void 0:n.in),r=FH(i,n)-e;return i.setDate(i.getDate()-7*r),vz(i,null===n||void 0===n?void 0:n.in)}function BH(t,e){const n=vz(t,null===e||void 0===e?void 0:e.in),i=n.getFullYear(),r=gz(n,0);r.setFullYear(i+1,0,4),r.setHours(0,0,0,0);const s=OH(r),a=gz(n,0);a.setFullYear(i,0,4),a.setHours(0,0,0,0);const o=OH(a);return n.getTime()>=s.getTime()?i+1:n.getTime()>=o.getTime()?i:i-1}function zH(t,e){const n=BH(t,e),i=gz((null===e||void 0===e?void 0:e.in)||t,0);return i.setFullYear(n,0,4),i.setHours(0,0,0,0),OH(i)}function HH(t,e){const n=vz(t,null===e||void 0===e?void 0:e.in),i=+OH(n)-+zH(n);return Math.round(i/dz)+1}function VH(t,e,n){const i=vz(t,null===n||void 0===n?void 0:n.in),r=HH(i,n)-e;return i.setDate(i.getDate()-7*r),i}const GH=[31,28,31,30,31,30,31,31,30,31,30,31],jH=[31,29,31,30,31,30,31,31,30,31,30,31];function WH(t,e,n){const i=vz(t,null===n||void 0===n?void 0:n.in);return isNaN(e)?gz((null===n||void 0===n?void 0:n.in)||t,NaN):e?(i.setDate(i.getDate()+e),i):i}function YH(t,e,n){var i,r,s,a,o,l;const c=Xz(),u=null!==(i=null!==(r=null!==(s=null!==(a=null===n||void 0===n?void 0:n.weekStartsOn)&&void 0!==a?a:null===n||void 0===n||null===(o=n.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==s?s:c.weekStartsOn)&&void 0!==r?r:null===(l=c.locale)||void 0===l||null===(l=l.options)||void 0===l?void 0:l.weekStartsOn)&&void 0!==i?i:0,h=vz(t,null===n||void 0===n?void 0:n.in),d=h.getDay(),f=7-u;return WH(h,e<0||e>6?e-(d+f)%7:((e%7+7)%7+f)%7-(d+f)%7,n)}function XH(t,e){const n=vz(t,null===e||void 0===e?void 0:e.in).getDay();return 0===n?7:n}function KH(t,e,n){const i=vz(t,null===n||void 0===n?void 0:n.in);return WH(i,e-XH(i,n),n)}function qH(t){const e=vz(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}const QH={G:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",140),Ar(this,"incompatibleTokens",["R","u","t","T"])}parse(t,e,n){switch(e){case"G":case"GG":case"GGG":return n.era(t,{width:"abbreviated"})||n.era(t,{width:"narrow"});case"GGGGG":return n.era(t,{width:"narrow"});default:return n.era(t,{width:"wide"})||n.era(t,{width:"abbreviated"})||n.era(t,{width:"narrow"})}}set(t,e,n){return e.era=n,t.setFullYear(n,0,1),t.setHours(0,0,0,0),t}},y:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",130),Ar(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(t,e,n){const i=t=>({year:t,isTwoDigitYear:"yy"===e});switch(e){case"y":return SH(CH(4,t),i);case"yo":return SH(n.ordinalNumber(t,{unit:"year"}),i);default:return SH(CH(e.length,t),i)}}validate(t,e){return e.isTwoDigitYear||e.year>0}set(t,e,n){const i=t.getFullYear();if(n.isTwoDigitYear){const e=LH(n.year,i);return t.setFullYear(e,0,1),t.setHours(0,0,0,0),t}const r="era"in e&&1!==e.era?1-n.year:n.year;return t.setFullYear(r,0,1),t.setHours(0,0,0,0),t}},Y:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",130),Ar(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(t,e,n){const i=t=>({year:t,isTwoDigitYear:"YY"===e});switch(e){case"Y":return SH(CH(4,t),i);case"Yo":return SH(n.ordinalNumber(t,{unit:"year"}),i);default:return SH(CH(e.length,t),i)}}validate(t,e){return e.isTwoDigitYear||e.year>0}set(t,e,n,i){const r=IH(t,i);if(n.isTwoDigitYear){const e=LH(n.year,r);return t.setFullYear(e,0,i.firstWeekContainsDate),t.setHours(0,0,0,0),PH(t,i)}const s="era"in e&&1!==e.era?1-n.year:n.year;return t.setFullYear(s,0,i.firstWeekContainsDate),t.setHours(0,0,0,0),PH(t,i)}},R:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",130),Ar(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(t,e){return RH("R"===e?4:e.length,t)}set(t,e,n){const i=gz(t,0);return i.setFullYear(n,0,4),i.setHours(0,0,0,0),OH(i)}},u:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",130),Ar(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(t,e){return RH("u"===e?4:e.length,t)}set(t,e,n){return t.setFullYear(n,0,1),t.setHours(0,0,0,0),t}},Q:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",120),Ar(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,e,n){switch(e){case"Q":case"QQ":return CH(e.length,t);case"Qo":return n.ordinalNumber(t,{unit:"quarter"});case"QQQ":return n.quarter(t,{width:"abbreviated",context:"formatting"})||n.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(t,{width:"narrow",context:"formatting"});default:return n.quarter(t,{width:"wide",context:"formatting"})||n.quarter(t,{width:"abbreviated",context:"formatting"})||n.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,e){return e>=1&&e<=4}set(t,e,n){return t.setMonth(3*(n-1),1),t.setHours(0,0,0,0),t}},q:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",120),Ar(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,e,n){switch(e){case"q":case"qq":return CH(e.length,t);case"qo":return n.ordinalNumber(t,{unit:"quarter"});case"qqq":return n.quarter(t,{width:"abbreviated",context:"standalone"})||n.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(t,{width:"narrow",context:"standalone"});default:return n.quarter(t,{width:"wide",context:"standalone"})||n.quarter(t,{width:"abbreviated",context:"standalone"})||n.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,e){return e>=1&&e<=4}set(t,e,n){return t.setMonth(3*(n-1),1),t.setHours(0,0,0,0),t}},M:new class extends $z{constructor(){super(...arguments),Ar(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),Ar(this,"priority",110)}parse(t,e,n){const i=t=>t-1;switch(e){case"M":return SH(TH(tH,t),i);case"MM":return SH(CH(2,t),i);case"Mo":return SH(n.ordinalNumber(t,{unit:"month"}),i);case"MMM":return n.month(t,{width:"abbreviated",context:"formatting"})||n.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(t,{width:"narrow",context:"formatting"});default:return n.month(t,{width:"wide",context:"formatting"})||n.month(t,{width:"abbreviated",context:"formatting"})||n.month(t,{width:"narrow",context:"formatting"})}}validate(t,e){return e>=0&&e<=11}set(t,e,n){return t.setMonth(n,1),t.setHours(0,0,0,0),t}},L:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",110),Ar(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(t,e,n){const i=t=>t-1;switch(e){case"L":return SH(TH(tH,t),i);case"LL":return SH(CH(2,t),i);case"Lo":return SH(n.ordinalNumber(t,{unit:"month"}),i);case"LLL":return n.month(t,{width:"abbreviated",context:"standalone"})||n.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(t,{width:"narrow",context:"standalone"});default:return n.month(t,{width:"wide",context:"standalone"})||n.month(t,{width:"abbreviated",context:"standalone"})||n.month(t,{width:"narrow",context:"standalone"})}}validate(t,e){return e>=0&&e<=11}set(t,e,n){return t.setMonth(n,1),t.setHours(0,0,0,0),t}},w:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",100),Ar(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(t,e,n){switch(e){case"w":return TH(iH,t);case"wo":return n.ordinalNumber(t,{unit:"week"});default:return CH(e.length,t)}}validate(t,e){return e>=1&&e<=53}set(t,e,n,i){return PH(UH(t,n,i),i)}},I:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",100),Ar(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(t,e,n){switch(e){case"I":return TH(iH,t);case"Io":return n.ordinalNumber(t,{unit:"week"});default:return CH(e.length,t)}}validate(t,e){return e>=1&&e<=53}set(t,e,n){return OH(VH(t,n))}},d:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",90),Ar(this,"subPriority",1),Ar(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(t,e,n){switch(e){case"d":return TH(eH,t);case"do":return n.ordinalNumber(t,{unit:"date"});default:return CH(e.length,t)}}validate(t,e){const n=DH(t.getFullYear()),i=t.getMonth();return n?e>=1&&e<=jH[i]:e>=1&&e<=GH[i]}set(t,e,n){return t.setDate(n),t.setHours(0,0,0,0),t}},D:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",90),Ar(this,"subpriority",1),Ar(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(t,e,n){switch(e){case"D":case"DD":return TH(nH,t);case"Do":return n.ordinalNumber(t,{unit:"date"});default:return CH(e.length,t)}}validate(t,e){return DH(t.getFullYear())?e>=1&&e<=366:e>=1&&e<=365}set(t,e,n){return t.setMonth(0,n),t.setHours(0,0,0,0),t}},E:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",90),Ar(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(t,e,n){switch(e){case"E":case"EE":case"EEE":return n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});default:return n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"})}}validate(t,e){return e>=0&&e<=6}set(t,e,n,i){return(t=YH(t,n,i)).setHours(0,0,0,0),t}},e:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",90),Ar(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(t,e,n,i){const r=t=>{const e=7*Math.floor((t-1)/7);return(t+i.weekStartsOn+6)%7+e};switch(e){case"e":case"ee":return SH(CH(e.length,t),r);case"eo":return SH(n.ordinalNumber(t,{unit:"day"}),r);case"eee":return n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"eeeee":return n.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});default:return n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"})}}validate(t,e){return e>=0&&e<=6}set(t,e,n,i){return(t=YH(t,n,i)).setHours(0,0,0,0),t}},c:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",90),Ar(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(t,e,n,i){const r=t=>{const e=7*Math.floor((t-1)/7);return(t+i.weekStartsOn+6)%7+e};switch(e){case"c":case"cc":return SH(CH(e.length,t),r);case"co":return SH(n.ordinalNumber(t,{unit:"day"}),r);case"ccc":return n.day(t,{width:"abbreviated",context:"standalone"})||n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"});case"ccccc":return n.day(t,{width:"narrow",context:"standalone"});case"cccccc":return n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"});default:return n.day(t,{width:"wide",context:"standalone"})||n.day(t,{width:"abbreviated",context:"standalone"})||n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"})}}validate(t,e){return e>=0&&e<=6}set(t,e,n,i){return(t=YH(t,n,i)).setHours(0,0,0,0),t}},i:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",90),Ar(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(t,e,n){const i=t=>0===t?7:t;switch(e){case"i":case"ii":return CH(e.length,t);case"io":return n.ordinalNumber(t,{unit:"day"});case"iii":return SH(n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"}),i);case"iiiii":return SH(n.day(t,{width:"narrow",context:"formatting"}),i);case"iiiiii":return SH(n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"}),i);default:return SH(n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"}),i)}}validate(t,e){return e>=1&&e<=7}set(t,e,n){return(t=KH(t,n)).setHours(0,0,0,0),t}},a:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",80),Ar(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(t,e,n){switch(e){case"a":case"aa":case"aaa":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(t,{width:"narrow",context:"formatting"});default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,e,n){return t.setHours(kH(n),0,0,0),t}},b:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",80),Ar(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(t,e,n){switch(e){case"b":case"bb":case"bbb":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(t,{width:"narrow",context:"formatting"});default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,e,n){return t.setHours(kH(n),0,0,0),t}},B:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",80),Ar(this,"incompatibleTokens",["a","b","t","T"])}parse(t,e,n){switch(e){case"B":case"BB":case"BBB":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(t,{width:"narrow",context:"formatting"});default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,e,n){return t.setHours(kH(n),0,0,0),t}},h:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",70),Ar(this,"incompatibleTokens",["H","K","k","t","T"])}parse(t,e,n){switch(e){case"h":return TH(oH,t);case"ho":return n.ordinalNumber(t,{unit:"hour"});default:return CH(e.length,t)}}validate(t,e){return e>=1&&e<=12}set(t,e,n){const i=t.getHours()>=12;return i&&n<12?t.setHours(n+12,0,0,0):i||12!==n?t.setHours(n,0,0,0):t.setHours(0,0,0,0),t}},H:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",70),Ar(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(t,e,n){switch(e){case"H":return TH(rH,t);case"Ho":return n.ordinalNumber(t,{unit:"hour"});default:return CH(e.length,t)}}validate(t,e){return e>=0&&e<=23}set(t,e,n){return t.setHours(n,0,0,0),t}},K:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",70),Ar(this,"incompatibleTokens",["h","H","k","t","T"])}parse(t,e,n){switch(e){case"K":return TH(aH,t);case"Ko":return n.ordinalNumber(t,{unit:"hour"});default:return CH(e.length,t)}}validate(t,e){return e>=0&&e<=11}set(t,e,n){return t.getHours()>=12&&n<12?t.setHours(n+12,0,0,0):t.setHours(n,0,0,0),t}},k:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",70),Ar(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(t,e,n){switch(e){case"k":return TH(sH,t);case"ko":return n.ordinalNumber(t,{unit:"hour"});default:return CH(e.length,t)}}validate(t,e){return e>=1&&e<=24}set(t,e,n){const i=n<=24?n%24:n;return t.setHours(i,0,0,0),t}},m:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",60),Ar(this,"incompatibleTokens",["t","T"])}parse(t,e,n){switch(e){case"m":return TH(lH,t);case"mo":return n.ordinalNumber(t,{unit:"minute"});default:return CH(e.length,t)}}validate(t,e){return e>=0&&e<=59}set(t,e,n){return t.setMinutes(n,0,0),t}},s:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",50),Ar(this,"incompatibleTokens",["t","T"])}parse(t,e,n){switch(e){case"s":return TH(cH,t);case"so":return n.ordinalNumber(t,{unit:"second"});default:return CH(e.length,t)}}validate(t,e){return e>=0&&e<=59}set(t,e,n){return t.setSeconds(n,0),t}},S:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",30),Ar(this,"incompatibleTokens",["t","T"])}parse(t,e){return SH(CH(e.length,t),t=>Math.trunc(t*Math.pow(10,3-e.length)))}set(t,e,n){return t.setMilliseconds(n),t}},X:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",10),Ar(this,"incompatibleTokens",["t","T","x"])}parse(t,e){switch(e){case"X":return MH(_H,t);case"XX":return MH(bH,t);case"XXXX":return MH(xH,t);case"XXXXX":return MH(wH,t);default:return MH(EH,t)}}set(t,e,n){return e.timestampIsSet?t:gz(t,t.getTime()-qH(t)-n)}},x:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",10),Ar(this,"incompatibleTokens",["t","T","X"])}parse(t,e){switch(e){case"x":return MH(_H,t);case"xx":return MH(bH,t);case"xxxx":return MH(xH,t);case"xxxxx":return MH(wH,t);default:return MH(EH,t)}}set(t,e,n){return e.timestampIsSet?t:gz(t,t.getTime()-qH(t)-n)}},t:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",40),Ar(this,"incompatibleTokens","*")}parse(t){return AH(t)}set(t,e,n){return[gz(t,1e3*n),{timestampIsSet:!0}]}},T:new class extends $z{constructor(){super(...arguments),Ar(this,"priority",20),Ar(this,"incompatibleTokens","*")}parse(t){return AH(t)}set(t,e,n){return[gz(t,n),{timestampIsSet:!0}]}}},ZH=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,JH=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,$H=/^'([^]*?)'?$/,tV=/''/g,eV=/\S/,nV=/[a-zA-Z]/;function iV(t,e,n,i){var r,s,a,o,l,c,u,h,d,f,p,m,g,v;const y=()=>gz((null===i||void 0===i?void 0:i.in)||n,NaN),_=Kz(),b=null!==(r=null!==(s=null===i||void 0===i?void 0:i.locale)&&void 0!==s?s:_.locale)&&void 0!==r?r:Nz,x=null!==(a=null!==(o=null!==(l=null!==(c=null===i||void 0===i?void 0:i.firstWeekContainsDate)&&void 0!==c?c:null===i||void 0===i||null===(u=i.locale)||void 0===u||null===(u=u.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==l?l:_.firstWeekContainsDate)&&void 0!==o?o:null===(h=_.locale)||void 0===h||null===(h=h.options)||void 0===h?void 0:h.firstWeekContainsDate)&&void 0!==a?a:1,E=null!==(d=null!==(f=null!==(p=null!==(m=null===i||void 0===i?void 0:i.weekStartsOn)&&void 0!==m?m:null===i||void 0===i||null===(g=i.locale)||void 0===g||null===(g=g.options)||void 0===g?void 0:g.weekStartsOn)&&void 0!==p?p:_.weekStartsOn)&&void 0!==f?f:null===(v=_.locale)||void 0===v||null===(v=v.options)||void 0===v?void 0:v.weekStartsOn)&&void 0!==d?d:0;if(!e)return t?y():vz(n,null===i||void 0===i?void 0:i.in);const w={firstWeekContainsDate:x,weekStartsOn:E,locale:b},S=[new Jz(null===i||void 0===i?void 0:i.in,n)],T=e.match(JH).map(t=>{const e=t[0];if(e in Bz){return(0,Bz[e])(t,b.formatLong)}return t}).join("").match(ZH),M=[];for(let k of T){null!==i&&void 0!==i&&i.useAdditionalWeekYearTokens||!jz(k)||Wz(k,e,t),null!==i&&void 0!==i&&i.useAdditionalDayOfYearTokens||!Gz(k)||Wz(k,e,t);const n=k[0],r=QH[n];if(r){const{incompatibleTokens:e}=r;if(Array.isArray(e)){const t=M.find(t=>e.includes(t.token)||t.token===n);if(t)throw new RangeError("The format string mustn't contain `".concat(t.fullToken,"` and `").concat(k,"` at the same time"))}else if("*"===r.incompatibleTokens&&M.length>0)throw new RangeError("The format string mustn't contain `".concat(k,"` and any other token at the same time"));M.push({token:n,fullToken:k});const i=r.run(t,k,b.match,w);if(!i)return y();S.push(i.setter),t=i.rest}else{if(n.match(nV))throw new RangeError("Format string contains an unescaped latin alphabet character `"+n+"`");if("''"===k?k="'":"'"===n&&(k=rV(k)),0!==t.indexOf(k))return y();t=t.slice(k.length)}}if(t.length>0&&eV.test(t))return y();const A=S.map(t=>t.priority).sort((t,e)=>e-t).filter((t,e,n)=>n.indexOf(t)===e).map(t=>S.filter(e=>e.priority===t).sort((t,e)=>e.subPriority-t.subPriority)).map(t=>t[0]);let C=vz(n,null===i||void 0===i?void 0:i.in);if(isNaN(+C))return y();const R={};for(const k of A){if(!k.validate(C,w))return y();const t=k.set(C,R,w);Array.isArray(t)?(C=t[0],Object.assign(R,t[1])):C=t}return C}function rV(t){return t.match($H)[1].replace(tV,"'")}function sV(t){return t instanceof Date||"object"===typeof t&&"[object Date]"===Object.prototype.toString.call(t)}function aV(t){return!(!sV(t)&&"number"!==typeof t||isNaN(+vz(t)))}function oV(t,e){return+vz(t)<+vz(e)}function lV(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];const r=gz.bind(null,t||n.find(t=>"object"===typeof t));return n.map(r)}function cV(t,e){const n=vz(t,null===e||void 0===e?void 0:e.in);return n.setHours(0,0,0,0),n}function uV(t,e,n){const[i,r]=lV(null===n||void 0===n?void 0:n.in,t,e),s=cV(i),a=cV(r),o=+s-qH(s),l=+a-qH(a);return Math.round((o-l)/864e5)}function hV(t,e){const n=vz(t,null===e||void 0===e?void 0:e.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function dV(t,e){const n=vz(t,null===e||void 0===e?void 0:e.in);return uV(n,hV(n))+1}function fV(t,e){return(t<0?"-":"")+Math.abs(t).toString().padStart(e,"0")}const pV={y(t,e){const n=t.getFullYear(),i=n>0?n:1-n;return fV("yy"===e?i%100:i,e.length)},M(t,e){const n=t.getMonth();return"M"===e?String(n+1):fV(n+1,2)},d:(t,e)=>fV(t.getDate(),e.length),a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(t,e)=>fV(t.getHours()%12||12,e.length),H:(t,e)=>fV(t.getHours(),e.length),m:(t,e)=>fV(t.getMinutes(),e.length),s:(t,e)=>fV(t.getSeconds(),e.length),S(t,e){const n=e.length,i=t.getMilliseconds();return fV(Math.trunc(i*Math.pow(10,n-3)),e.length)}},mV="midnight",gV="noon",vV="morning",yV="afternoon",_V="evening",bV="night",xV={G:function(t,e,n){const i=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});default:return n.era(i,{width:"wide"})}},y:function(t,e,n){if("yo"===e){const e=t.getFullYear(),i=e>0?e:1-e;return n.ordinalNumber(i,{unit:"year"})}return pV.y(t,e)},Y:function(t,e,n,i){const r=IH(t,i),s=r>0?r:1-r;if("YY"===e){return fV(s%100,2)}return"Yo"===e?n.ordinalNumber(s,{unit:"year"}):fV(s,e.length)},R:function(t,e){return fV(BH(t),e.length)},u:function(t,e){return fV(t.getFullYear(),e.length)},Q:function(t,e,n){const i=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(i);case"QQ":return fV(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(t,e,n){const i=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(i);case"qq":return fV(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(t,e,n){const i=t.getMonth();switch(e){case"M":case"MM":return pV.M(t,e);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(t,e,n){const i=t.getMonth();switch(e){case"L":return String(i+1);case"LL":return fV(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(t,e,n,i){const r=FH(t,i);return"wo"===e?n.ordinalNumber(r,{unit:"week"}):fV(r,e.length)},I:function(t,e,n){const i=HH(t);return"Io"===e?n.ordinalNumber(i,{unit:"week"}):fV(i,e.length)},d:function(t,e,n){return"do"===e?n.ordinalNumber(t.getDate(),{unit:"date"}):pV.d(t,e)},D:function(t,e,n){const i=dV(t);return"Do"===e?n.ordinalNumber(i,{unit:"dayOfYear"}):fV(i,e.length)},E:function(t,e,n){const i=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(t,e,n,i){const r=t.getDay(),s=(r-i.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return fV(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(t,e,n,i){const r=t.getDay(),s=(r-i.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return fV(s,e.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(t,e,n){const i=t.getDay(),r=0===i?7:i;switch(e){case"i":return String(r);case"ii":return fV(r,e.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(t,e,n){const i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,n){const i=t.getHours();let r;switch(r=12===i?gV:0===i?mV:i/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(t,e,n){const i=t.getHours();let r;switch(r=i>=17?_V:i>=12?yV:i>=4?vV:bV,e){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(t,e,n){if("ho"===e){let e=t.getHours()%12;return 0===e&&(e=12),n.ordinalNumber(e,{unit:"hour"})}return pV.h(t,e)},H:function(t,e,n){return"Ho"===e?n.ordinalNumber(t.getHours(),{unit:"hour"}):pV.H(t,e)},K:function(t,e,n){const i=t.getHours()%12;return"Ko"===e?n.ordinalNumber(i,{unit:"hour"}):fV(i,e.length)},k:function(t,e,n){let i=t.getHours();return 0===i&&(i=24),"ko"===e?n.ordinalNumber(i,{unit:"hour"}):fV(i,e.length)},m:function(t,e,n){return"mo"===e?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):pV.m(t,e)},s:function(t,e,n){return"so"===e?n.ordinalNumber(t.getSeconds(),{unit:"second"}):pV.s(t,e)},S:function(t,e){return pV.S(t,e)},X:function(t,e,n){const i=t.getTimezoneOffset();if(0===i)return"Z";switch(e){case"X":return wV(i);case"XXXX":case"XX":return SV(i);default:return SV(i,":")}},x:function(t,e,n){const i=t.getTimezoneOffset();switch(e){case"x":return wV(i);case"xxxx":case"xx":return SV(i);default:return SV(i,":")}},O:function(t,e,n){const i=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+EV(i,":");default:return"GMT"+SV(i,":")}},z:function(t,e,n){const i=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+EV(i,":");default:return"GMT"+SV(i,":")}},t:function(t,e,n){return fV(Math.trunc(+t/1e3),e.length)},T:function(t,e,n){return fV(+t,e.length)}};function EV(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=t>0?"-":"+",i=Math.abs(t),r=Math.trunc(i/60),s=i%60;return 0===s?n+String(r):n+String(r)+e+fV(s,2)}function wV(t,e){if(t%60===0){return(t>0?"-":"+")+fV(Math.abs(t)/60,2)}return SV(t,e)}function SV(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=t>0?"-":"+",i=Math.abs(t);return n+fV(Math.trunc(i/60),2)+e+fV(i%60,2)}const TV=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,MV=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,AV=/^'([^]*?)'?$/,CV=/''/g,RV=/[a-zA-Z]/;function kV(t,e,n){var i,r,s,a,o,l,c,u,h,d,f,p,m,g;const v=Xz(),y=null!==(i=null!==(r=null===n||void 0===n?void 0:n.locale)&&void 0!==r?r:v.locale)&&void 0!==i?i:Nz,_=null!==(s=null!==(a=null!==(o=null!==(l=null===n||void 0===n?void 0:n.firstWeekContainsDate)&&void 0!==l?l:null===n||void 0===n||null===(c=n.locale)||void 0===c||null===(c=c.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==o?o:v.firstWeekContainsDate)&&void 0!==a?a:null===(u=v.locale)||void 0===u||null===(u=u.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==s?s:1,b=null!==(h=null!==(d=null!==(f=null!==(p=null===n||void 0===n?void 0:n.weekStartsOn)&&void 0!==p?p:null===n||void 0===n||null===(m=n.locale)||void 0===m||null===(m=m.options)||void 0===m?void 0:m.weekStartsOn)&&void 0!==f?f:v.weekStartsOn)&&void 0!==d?d:null===(g=v.locale)||void 0===g||null===(g=g.options)||void 0===g?void 0:g.weekStartsOn)&&void 0!==h?h:0,x=vz(t,null===n||void 0===n?void 0:n.in);if(!aV(x))throw new RangeError("Invalid time value");let E=e.match(MV).map(t=>{const e=t[0];if("p"===e||"P"===e){return(0,Bz[e])(t,y.formatLong)}return t}).join("").match(TV).map(t=>{if("''"===t)return{isToken:!1,value:"'"};const e=t[0];if("'"===e)return{isToken:!1,value:LV(t)};if(xV[e])return{isToken:!0,value:t};if(e.match(RV))throw new RangeError("Format string contains an unescaped latin alphabet character `"+e+"`");return{isToken:!1,value:t}});y.localize.preprocessor&&(E=y.localize.preprocessor(x,E));const w={firstWeekContainsDate:_,weekStartsOn:b,locale:y};return E.map(i=>{if(!i.isToken)return i.value;const r=i.value;(null!==n&&void 0!==n&&n.useAdditionalWeekYearTokens||!jz(r))&&(null!==n&&void 0!==n&&n.useAdditionalDayOfYearTokens||!Gz(r))||Wz(r,e,String(t));return(0,xV[r[0]])(x,r,y.localize,w)}).join("")}function LV(t){const e=t.match(AV);return e?e[1].replace(CV,"'"):t}function DV(t,e,n){const i=vz(t,null===n||void 0===n?void 0:n.in);return i.setHours(e),i}function PV(t,e,n){const i=vz(t,null===n||void 0===n?void 0:n.in);return i.setMinutes(e),i}function IV(t,e,n){const i=vz(t,null===n||void 0===n?void 0:n.in);return i.setSeconds(e),i}function OV(t,e){const n=vz(t,null===e||void 0===e?void 0:e.in);return n.setDate(1),n.setHours(0,0,0,0),n}function NV(t,e){const n=vz(t,null===e||void 0===e?void 0:e.in),i=n.getMonth(),r=i-i%3;return n.setMonth(r,1),n.setHours(0,0,0,0),n}function FV(t,e){const n=vz(t,null===e||void 0===e?void 0:e.in);return n.setHours(23,59,59,999),n}function UV(t,e){var n,i,r,s,a,o;const l=Xz(),c=null!==(n=null!==(i=null!==(r=null!==(s=null===e||void 0===e?void 0:e.weekStartsOn)&&void 0!==s?s:null===e||void 0===e||null===(a=e.locale)||void 0===a||null===(a=a.options)||void 0===a?void 0:a.weekStartsOn)&&void 0!==r?r:l.weekStartsOn)&&void 0!==i?i:null===(o=l.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==n?n:0,u=vz(t,null===e||void 0===e?void 0:e.in),h=u.getDay(),d=6+(h<c?-7:0)-(h-c);return u.setDate(u.getDate()+d),u.setHours(23,59,59,999),u}function BV(t,e){const n=vz(t,null===e||void 0===e?void 0:e.in),i=n.getMonth();return n.setFullYear(n.getFullYear(),i+1,0),n.setHours(23,59,59,999),n}function zV(t,e,n){const[i,r]=lV(null===n||void 0===n?void 0:n.in,t,e);return i.getFullYear()===r.getFullYear()}function HV(t,e,n){const[i,r]=lV(null===n||void 0===n?void 0:n.in,t,e);return i.getFullYear()===r.getFullYear()&&i.getMonth()===r.getMonth()}function VV(t,e,n){const[i,r]=lV(null===n||void 0===n?void 0:n.in,t,e);return+NV(i)===+NV(r)}function GV(t,e,n){const[i,r]=lV(null===n||void 0===n?void 0:n.in,t,e);return+cV(i)===+cV(r)}function jV(t,e){return+vz(t)===+vz(e)}function WV(t,e,n){const i=+vz(t,null===n||void 0===n?void 0:n.in),[r,s]=[+vz(e.start,null===n||void 0===n?void 0:n.in),+vz(e.end,null===n||void 0===n?void 0:n.in)].sort((t,e)=>t-e);return i>=r&&i<=s}function YV(t,e){const n=vz(t,null===e||void 0===e?void 0:e.in),i=n.getFullYear(),r=n.getMonth(),s=gz(n,0);return s.setFullYear(i,r+1,0),s.setHours(0,0,0,0),s.getDate()}function XV(t,e,n){const i=vz(t,null===n||void 0===n?void 0:n.in),r=i.getFullYear(),s=i.getDate(),a=gz((null===n||void 0===n?void 0:n.in)||t,0);a.setFullYear(r,e,15),a.setHours(0,0,0,0);const o=YV(a);return i.setMonth(e,Math.min(s,o)),i}function KV(t,e,n){const i=vz(t,null===n||void 0===n?void 0:n.in),r=e-(Math.trunc(i.getMonth()/3)+1);return XV(i,i.getMonth()+3*r)}function qV(t,e){return vz(t,null===e||void 0===e?void 0:e.in).getFullYear()}function QV(t,e){return vz(t,null===e||void 0===e?void 0:e.in).getMonth()}function ZV(t,e){const n=vz(t,null===e||void 0===e?void 0:e.in),i=n.getFullYear();return n.setFullYear(i+1,0,0),n.setHours(23,59,59,999),n}function JV(t,e){const n=vz(t,null===e||void 0===e?void 0:e.in);return Math.trunc(n.getMonth()/3)+1}function $V(t,e){return vz(t,null===e||void 0===e?void 0:e.in).getHours()}function tG(t,e){return vz(t,null===e||void 0===e?void 0:e.in).getMinutes()}function eG(t){return vz(t).getSeconds()}function nG(t,e,n){const i=vz(t,null===n||void 0===n?void 0:n.in);if(isNaN(e))return gz((null===n||void 0===n?void 0:n.in)||t,NaN);if(!e)return i;const r=i.getDate(),s=gz((null===n||void 0===n?void 0:n.in)||t,i.getTime());s.setMonth(i.getMonth()+e+1,0);return r>=s.getDate()?s:(i.setFullYear(s.getFullYear(),s.getMonth(),r),i)}function iG(t,e,n){return nG(t,-e,n)}function rG(t,e,n){const[i,r]=lV(null===n||void 0===n?void 0:n.in,t,e);return 12*(i.getFullYear()-r.getFullYear())+(i.getMonth()-r.getMonth())}function sG(t,e,n){return nG(t,3*e,n)}function aG(t,e,n){return sG(t,-e,n)}function oG(t,e,n){const[i,r]=lV(null===n||void 0===n?void 0:n.in,t,e);return 4*(i.getFullYear()-r.getFullYear())+(JV(i)-JV(r))}function lG(t,e,n){return nG(t,12*e,n)}function cG(t,e,n){return lG(t,-e,n)}function uG(t,e,n){const[i,r]=lV(null===n||void 0===n?void 0:n.in,t,e);return i.getFullYear()-r.getFullYear()}function hG(t,e){let n,i=null===e||void 0===e?void 0:e.in;return t.forEach(t=>{i||"object"!==typeof t||(i=gz.bind(null,t));const e=vz(t,i);(!n||n>e||isNaN(+e))&&(n=e)}),gz(i,n||NaN)}function dG(t,e){let n,i=null===e||void 0===e?void 0:e.in;return t.forEach(t=>{i||"object"!==typeof t||(i=gz.bind(null,t));const e=vz(t,i);(!n||n<e||isNaN(+e))&&(n=e)}),gz(i,n||NaN)}function fG(t,e,n){return gz((null===n||void 0===n?void 0:n.in)||t,+vz(t)+e)}function pG(t,e,n){return fG(t,e*pz,n)}function mG(t,e,n){const i=vz(t,null===n||void 0===n?void 0:n.in);return i.setTime(i.getTime()+e*fz),i}function gG(t,e,n){return fG(t,1e3*e,n)}function vG(t,e){return+vz(t)>+vz(e)}function yG(t,e){return vz(t,null===e||void 0===e?void 0:e.in).getDay()}function _G(t,e){return vz(t,null===e||void 0===e?void 0:e.in).getDate()}function bG(t,e,n){return WH(t,7*e,n)}function xG(t){return+vz(t)}function EG(t,e,n){const i=vz(t,null===n||void 0===n?void 0:n.in);return isNaN(+i)?gz((null===n||void 0===n?void 0:n.in)||t,NaN):(i.setFullYear(e),i)}function wG(t,e,n){const[i,r]=lV(null===n||void 0===n?void 0:n.in,t,e),s=SG(i,r),a=Math.abs(uV(i,r));i.setDate(i.getDate()-s*a);const o=s*(a-Number(SG(i,r)===-s));return 0===o?0:o}function SG(t,e){const n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function TG(t,e,n){return bG(t,-e,n)}function MG(t,e,n){return WH(t,-e,n)}var AG="undefined"!==typeof document?i.useLayoutEffect:function(){};const CG=Rr({},r).useInsertionEffect||(t=>t());function RG(){return"undefined"!==typeof window}function kG(t){return PG(t)?(t.nodeName||"").toLowerCase():"#document"}function LG(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function DG(t){var e;return null==(e=(PG(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function PG(t){return!!RG()&&(t instanceof Node||t instanceof LG(t).Node)}function IG(t){return!!RG()&&(t instanceof Element||t instanceof LG(t).Element)}function OG(t){return!!RG()&&(t instanceof HTMLElement||t instanceof LG(t).HTMLElement)}function NG(t){return!(!RG()||"undefined"===typeof ShadowRoot)&&(t instanceof ShadowRoot||t instanceof LG(t).ShadowRoot)}const FG=new Set(["inline","contents"]);function UG(t){const{overflow:e,overflowX:n,overflowY:i,display:r}=QG(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!FG.has(r)}const BG=new Set(["table","td","th"]);function zG(t){return BG.has(kG(t))}const HG=[":popover-open",":modal"];function VG(t){return HG.some(e=>{try{return t.matches(e)}catch(n){return!1}})}const GG=["transform","translate","scale","rotate","perspective"],jG=["transform","translate","scale","rotate","perspective","filter"],WG=["paint","layout","strict","content"];function YG(t){const e=XG(),n=IG(t)?QG(t):t;return GG.some(t=>!!n[t]&&"none"!==n[t])||!!n.containerType&&"normal"!==n.containerType||!e&&!!n.backdropFilter&&"none"!==n.backdropFilter||!e&&!!n.filter&&"none"!==n.filter||jG.some(t=>(n.willChange||"").includes(t))||WG.some(t=>(n.contain||"").includes(t))}function XG(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const KG=new Set(["html","body","#document"]);function qG(t){return KG.has(kG(t))}function QG(t){return LG(t).getComputedStyle(t)}function ZG(t){return IG(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function JG(t){if("html"===kG(t))return t;const e=t.assignedSlot||t.parentNode||NG(t)&&t.host||DG(t);return NG(e)?e.host:e}function $G(t){const e=JG(t);return qG(e)?t.ownerDocument?t.ownerDocument.body:t.body:OG(e)&&UG(e)?e:$G(e)}function tj(t,e,n){var i;void 0===e&&(e=[]),void 0===n&&(n=!0);const r=$G(t),s=r===(null==(i=t.ownerDocument)?void 0:i.body),a=LG(r);if(s){const t=ej(a);return e.concat(a,a.visualViewport||[],UG(r)?r:[],t&&n?tj(t):[])}return e.concat(r,tj(r,[],n))}function ej(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}var nj=n(396);const ij=Math.min,rj=Math.max,sj=Math.round,aj=Math.floor,oj=t=>({x:t,y:t}),lj={left:"right",right:"left",bottom:"top",top:"bottom"},cj={start:"end",end:"start"};function uj(t,e){return"function"===typeof t?t(e):t}function hj(t){return t.split("-")[0]}function dj(t){return t.split("-")[1]}function fj(t){return"y"===t?"height":"width"}const pj=new Set(["top","bottom"]);function mj(t){return pj.has(hj(t))?"y":"x"}function gj(t){return"x"===mj(t)?"y":"x"}function vj(t){return t.replace(/start|end/g,t=>cj[t])}const yj=["left","right"],_j=["right","left"],bj=["top","bottom"],xj=["bottom","top"];function Ej(t,e,n,i){const r=dj(t);let s=function(t,e,n){switch(t){case"top":case"bottom":return n?e?_j:yj:e?yj:_j;case"left":case"right":return e?bj:xj;default:return[]}}(hj(t),"start"===n,i);return r&&(s=s.map(t=>t+"-"+r),e&&(s=s.concat(s.map(vj)))),s}function wj(t){return t.replace(/left|right|bottom|top/g,t=>lj[t])}function Sj(t){return"number"!==typeof t?function(t){return Rr({top:0,right:0,bottom:0,left:0},t)}(t):{top:t,right:t,bottom:t,left:t}}function Tj(t){const{x:e,y:n,width:i,height:r}=t;return{width:i,height:r,top:n,left:e,right:e+i,bottom:n+r,x:e,y:n}}const Mj=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"];function Aj(t,e,n){let{reference:i,floating:r}=t;const s=mj(e),a=gj(e),o=fj(a),l=hj(e),c="y"===s,u=i.x+i.width/2-r.width/2,h=i.y+i.height/2-r.height/2,d=i[o]/2-r[o]/2;let f;switch(l){case"top":f={x:u,y:i.y-r.height};break;case"bottom":f={x:u,y:i.y+i.height};break;case"right":f={x:i.x+i.width,y:h};break;case"left":f={x:i.x-r.width,y:h};break;default:f={x:i.x,y:i.y}}switch(dj(e)){case"start":f[a]-=d*(n&&c?-1:1);break;case"end":f[a]+=d*(n&&c?-1:1)}return f}async function Cj(t,e){var n;void 0===e&&(e={});const{x:i,y:r,platform:s,rects:a,elements:o,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:d=!1,padding:f=0}=uj(e,t),p=Sj(f),m=o[d?"floating"===h?"reference":"floating":h],g=Tj(await s.getClippingRect({element:null==(n=await(null==s.isElement?void 0:s.isElement(m)))||n?m:m.contextElement||await(null==s.getDocumentElement?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),v="floating"===h?{x:i,y:r,width:a.floating.width,height:a.floating.height}:a.reference,y=await(null==s.getOffsetParent?void 0:s.getOffsetParent(o.floating)),_=await(null==s.isElement?void 0:s.isElement(y))&&await(null==s.getScale?void 0:s.getScale(y))||{x:1,y:1},b=Tj(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:v,offsetParent:y,strategy:l}):v);return{top:(g.top-b.top+p.top)/_.y,bottom:(b.bottom-g.bottom+p.bottom)/_.y,left:(g.left-b.left+p.left)/_.x,right:(b.right-g.right+p.right)/_.x}}const Rj=new Set(["left","top"]);function kj(t){const e=QG(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const r=OG(t),s=r?t.offsetWidth:n,a=r?t.offsetHeight:i,o=sj(n)!==s||sj(i)!==a;return o&&(n=s,i=a),{width:n,height:i,$:o}}function Lj(t){return IG(t)?t:t.contextElement}function Dj(t){const e=Lj(t);if(!OG(e))return oj(1);const n=e.getBoundingClientRect(),{width:i,height:r,$:s}=kj(e);let a=(s?sj(n.width):n.width)/i,o=(s?sj(n.height):n.height)/r;return a&&Number.isFinite(a)||(a=1),o&&Number.isFinite(o)||(o=1),{x:a,y:o}}const Pj=oj(0);function Ij(t){const e=LG(t);return XG()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:Pj}function Oj(t,e,n,i){void 0===e&&(e=!1),void 0===n&&(n=!1);const r=t.getBoundingClientRect(),s=Lj(t);let a=oj(1);e&&(i?IG(i)&&(a=Dj(i)):a=Dj(t));const o=function(t,e,n){return void 0===e&&(e=!1),!(!n||e&&n!==LG(t))&&e}(s,n,i)?Ij(s):oj(0);let l=(r.left+o.x)/a.x,c=(r.top+o.y)/a.y,u=r.width/a.x,h=r.height/a.y;if(s){const t=LG(s),e=i&&IG(i)?LG(i):i;let n=t,r=ej(n);for(;r&&i&&e!==n;){const t=Dj(r),e=r.getBoundingClientRect(),i=QG(r),s=e.left+(r.clientLeft+parseFloat(i.paddingLeft))*t.x,a=e.top+(r.clientTop+parseFloat(i.paddingTop))*t.y;l*=t.x,c*=t.y,u*=t.x,h*=t.y,l+=s,c+=a,n=LG(r),r=ej(n)}}return Tj({width:u,height:h,x:l,y:c})}function Nj(t,e){const n=ZG(t).scrollLeft;return e?e.left+n:Oj(DG(t)).left+n}function Fj(t,e){const n=t.getBoundingClientRect();return{x:n.left+e.scrollLeft-Nj(t,n),y:n.top+e.scrollTop}}const Uj=new Set(["absolute","fixed"]);function Bj(t,e,n){let i;if("viewport"===e)i=function(t,e){const n=LG(t),i=DG(t),r=n.visualViewport;let s=i.clientWidth,a=i.clientHeight,o=0,l=0;if(r){s=r.width,a=r.height;const t=XG();(!t||t&&"fixed"===e)&&(o=r.offsetLeft,l=r.offsetTop)}const c=Nj(i);if(c<=0){const t=i.ownerDocument,e=t.body,n=getComputedStyle(e),r="CSS1Compat"===t.compatMode&&parseFloat(n.marginLeft)+parseFloat(n.marginRight)||0,a=Math.abs(i.clientWidth-e.clientWidth-r);a<=25&&(s-=a)}else c<=25&&(s+=c);return{width:s,height:a,x:o,y:l}}(t,n);else if("document"===e)i=function(t){const e=DG(t),n=ZG(t),i=t.ownerDocument.body,r=rj(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),s=rj(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let a=-n.scrollLeft+Nj(t);const o=-n.scrollTop;return"rtl"===QG(i).direction&&(a+=rj(e.clientWidth,i.clientWidth)-r),{width:r,height:s,x:a,y:o}}(DG(t));else if(IG(e))i=function(t,e){const n=Oj(t,!0,"fixed"===e),i=n.top+t.clientTop,r=n.left+t.clientLeft,s=OG(t)?Dj(t):oj(1);return{width:t.clientWidth*s.x,height:t.clientHeight*s.y,x:r*s.x,y:i*s.y}}(e,n);else{const n=Ij(t);i={x:e.x-n.x,y:e.y-n.y,width:e.width,height:e.height}}return Tj(i)}function zj(t,e){const n=JG(t);return!(n===e||!IG(n)||qG(n))&&("fixed"===QG(n).position||zj(n,e))}function Hj(t,e,n){const i=OG(e),r=DG(e),s="fixed"===n,a=Oj(t,!0,s,e);let o={scrollLeft:0,scrollTop:0};const l=oj(0);function c(){l.x=Nj(r)}if(i||!i&&!s)if(("body"!==kG(e)||UG(r))&&(o=ZG(e)),i){const t=Oj(e,!0,s,e);l.x=t.x+e.clientLeft,l.y=t.y+e.clientTop}else r&&c();s&&!i&&r&&c();const u=!r||i||s?oj(0):Fj(r,o);return{x:a.left+o.scrollLeft-l.x-u.x,y:a.top+o.scrollTop-l.y-u.y,width:a.width,height:a.height}}function Vj(t){return"static"===QG(t).position}function Gj(t,e){if(!OG(t)||"fixed"===QG(t).position)return null;if(e)return e(t);let n=t.offsetParent;return DG(t)===n&&(n=n.ownerDocument.body),n}function jj(t,e){const n=LG(t);if(VG(t))return n;if(!OG(t)){let e=JG(t);for(;e&&!qG(e);){if(IG(e)&&!Vj(e))return e;e=JG(e)}return n}let i=Gj(t,e);for(;i&&zG(i)&&Vj(i);)i=Gj(i,e);return i&&qG(i)&&Vj(i)&&!YG(i)?n:i||function(t){let e=JG(t);for(;OG(e)&&!qG(e);){if(YG(e))return e;if(VG(e))return null;e=JG(e)}return null}(t)||n}const Wj={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{elements:e,rect:n,offsetParent:i,strategy:r}=t;const s="fixed"===r,a=DG(i),o=!!e&&VG(e.floating);if(i===a||o&&s)return n;let l={scrollLeft:0,scrollTop:0},c=oj(1);const u=oj(0),h=OG(i);if((h||!h&&!s)&&(("body"!==kG(i)||UG(a))&&(l=ZG(i)),OG(i))){const t=Oj(i);c=Dj(i),u.x=t.x+i.clientLeft,u.y=t.y+i.clientTop}const d=!a||h||s?oj(0):Fj(a,l);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+d.x,y:n.y*c.y-l.scrollTop*c.y+u.y+d.y}},getDocumentElement:DG,getClippingRect:function(t){let{element:e,boundary:n,rootBoundary:i,strategy:r}=t;const s=[..."clippingAncestors"===n?VG(e)?[]:function(t,e){const n=e.get(t);if(n)return n;let i=tj(t,[],!1).filter(t=>IG(t)&&"body"!==kG(t)),r=null;const s="fixed"===QG(t).position;let a=s?JG(t):t;for(;IG(a)&&!qG(a);){const e=QG(a),n=YG(a);n||"fixed"!==e.position||(r=null),(s?!n&&!r:!n&&"static"===e.position&&r&&Uj.has(r.position)||UG(a)&&!n&&zj(t,a))?i=i.filter(t=>t!==a):r=e,a=JG(a)}return e.set(t,i),i}(e,this._c):[].concat(n),i],a=s[0],o=s.reduce((t,n)=>{const i=Bj(e,n,r);return t.top=rj(i.top,t.top),t.right=ij(i.right,t.right),t.bottom=ij(i.bottom,t.bottom),t.left=rj(i.left,t.left),t},Bj(e,a,r));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},getOffsetParent:jj,getElementRects:async function(t){const e=this.getOffsetParent||jj,n=this.getDimensions,i=await n(t.floating);return{reference:Hj(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}},getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){const{width:e,height:n}=kj(t);return{width:e,height:n}},getScale:Dj,isElement:IG,isRTL:function(t){return"rtl"===QG(t).direction}};function Yj(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Xj(t,e,n,i){void 0===i&&(i={});const{ancestorScroll:r=!0,ancestorResize:s=!0,elementResize:a="function"===typeof ResizeObserver,layoutShift:o="function"===typeof IntersectionObserver,animationFrame:l=!1}=i,c=Lj(t),u=r||s?[...c?tj(c):[],...tj(e)]:[];u.forEach(t=>{r&&t.addEventListener("scroll",n,{passive:!0}),s&&t.addEventListener("resize",n)});const h=c&&o?function(t,e){let n,i=null;const r=DG(t);function s(){var t;clearTimeout(n),null==(t=i)||t.disconnect(),i=null}return function a(o,l){void 0===o&&(o=!1),void 0===l&&(l=1),s();const c=t.getBoundingClientRect(),{left:u,top:h,width:d,height:f}=c;if(o||e(),!d||!f)return;const p={rootMargin:-aj(h)+"px "+-aj(r.clientWidth-(u+d))+"px "+-aj(r.clientHeight-(h+f))+"px "+-aj(u)+"px",threshold:rj(0,ij(1,l))||1};let m=!0;function g(e){const i=e[0].intersectionRatio;if(i!==l){if(!m)return a();i?a(!1,i):n=setTimeout(()=>{a(!1,1e-7)},1e3)}1!==i||Yj(c,t.getBoundingClientRect())||a(),m=!1}try{i=new IntersectionObserver(g,Rr(Rr({},p),{},{root:r.ownerDocument}))}catch(v){i=new IntersectionObserver(g,p)}i.observe(t)}(!0),s}(c,n):null;let d,f=-1,p=null;a&&(p=new ResizeObserver(t=>{let[i]=t;i&&i.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var t;null==(t=p)||t.observe(e)})),n()}),c&&!l&&p.observe(c),p.observe(e));let m=l?Oj(t):null;return l&&function e(){const i=Oj(t);m&&!Yj(m,i)&&n();m=i,d=requestAnimationFrame(e)}(),n(),()=>{var t;u.forEach(t=>{r&&t.removeEventListener("scroll",n),s&&t.removeEventListener("resize",n)}),null==h||h(),null==(t=p)||t.disconnect(),p=null,l&&cancelAnimationFrame(d)}}const Kj=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){var n,i;const{x:r,y:s,placement:a,middlewareData:o}=e,l=await async function(t,e){const{placement:n,platform:i,elements:r}=t,s=await(null==i.isRTL?void 0:i.isRTL(r.floating)),a=hj(n),o=dj(n),l="y"===mj(n),c=Rj.has(a)?-1:1,u=s&&l?-1:1,h=uj(e,t);let{mainAxis:d,crossAxis:f,alignmentAxis:p}="number"===typeof h?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return o&&"number"===typeof p&&(f="end"===o?-1*p:p),l?{x:f*u,y:d*c}:{x:d*c,y:f*u}}(e,t);return a===(null==(n=o.offset)?void 0:n.placement)&&null!=(i=o.arrow)&&i.alignmentOffset?{}:{x:r+l.x,y:s+l.y,data:Rr(Rr({},l),{},{placement:a})}}}},qj=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var n,i;const{placement:r,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:c}=e,u=uj(t,e),{mainAxis:h=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:v=!0}=u,y=d(u,Mj);if(null!=(n=s.arrow)&&n.alignmentOffset)return{};const _=hj(r),b=mj(o),x=hj(o)===o,E=await(null==l.isRTL?void 0:l.isRTL(c.floating)),w=p||(x||!v?[wj(o)]:function(t){const e=wj(t);return[vj(t),e,vj(e)]}(o)),S="none"!==g;!p&&S&&w.push(...Ej(o,v,g,E));const T=[o,...w],M=await Cj(e,y),A=[];let C=(null==(i=s.flip)?void 0:i.overflows)||[];if(h&&A.push(M[_]),f){const t=function(t,e,n){void 0===n&&(n=!1);const i=dj(t),r=gj(t),s=fj(r);let a="x"===r?i===(n?"end":"start")?"right":"left":"start"===i?"bottom":"top";return e.reference[s]>e.floating[s]&&(a=wj(a)),[a,wj(a)]}(r,a,E);A.push(M[t[0]],M[t[1]])}if(C=[...C,{placement:r,overflows:A}],!A.every(t=>t<=0)){var R,k;const t=((null==(R=s.flip)?void 0:R.index)||0)+1,e=T[t];if(e){if(!("alignment"===f&&b!==mj(e))||C.every(t=>mj(t.placement)!==b||t.overflows[0]>0))return{data:{index:t,overflows:C},reset:{placement:e}}}let n=null==(k=C.filter(t=>t.overflows[0]<=0).sort((t,e)=>t.overflows[1]-e.overflows[1])[0])?void 0:k.placement;if(!n)switch(m){case"bestFit":{var L;const t=null==(L=C.filter(t=>{if(S){const e=mj(t.placement);return e===b||"y"===e}return!0}).map(t=>[t.placement,t.overflows.filter(t=>t>0).reduce((t,e)=>t+e,0)]).sort((t,e)=>t[1]-e[1])[0])?void 0:L[0];t&&(n=t);break}case"initialPlacement":n=o}if(r!==n)return{reset:{placement:n}}}return{}}}},Qj=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:i,placement:r,rects:s,platform:a,elements:o,middlewareData:l}=e,{element:c,padding:u=0}=uj(t,e)||{};if(null==c)return{};const h=Sj(u),d={x:n,y:i},f=gj(r),p=fj(f),m=await a.getDimensions(c),g="y"===f,v=g?"top":"left",y=g?"bottom":"right",_=g?"clientHeight":"clientWidth",b=s.reference[p]+s.reference[f]-d[f]-s.floating[p],x=d[f]-s.reference[f],E=await(null==a.getOffsetParent?void 0:a.getOffsetParent(c));let w=E?E[_]:0;w&&await(null==a.isElement?void 0:a.isElement(E))||(w=o.floating[_]||s.floating[p]);const S=b/2-x/2,T=w/2-m[p]/2-1,M=ij(h[v],T),A=ij(h[y],T),C=M,R=w-m[p]-A,k=w/2-m[p]/2+S,L=rj(C,ij(k,R));const D=!l.arrow&&null!=dj(r)&&k!==L&&s.reference[p]/2-(k<C?M:A)-m[p]/2<0,P=D?k<C?k-C:k-R:0;return{[f]:d[f]+P,data:Rr({[f]:L,centerOffset:k-L-P},D&&{alignmentOffset:P}),reset:D}}}),Zj=(t,e,n)=>{const i=new Map,r=Rr({platform:Wj},n),s=Rr(Rr({},r.platform),{},{_c:i});return(async(t,e,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:a}=n,o=s.filter(Boolean),l=await(null==a.isRTL?void 0:a.isRTL(e));let c=await a.getElementRects({reference:t,floating:e,strategy:r}),{x:u,y:h}=Aj(c,i,l),d=i,f={},p=0;for(let m=0;m<o.length;m++){const{name:n,fn:s}=o[m],{x:g,y:v,data:y,reset:_}=await s({x:u,y:h,initialPlacement:i,placement:d,strategy:r,middlewareData:f,rects:c,platform:a,elements:{reference:t,floating:e}});u=null!=g?g:u,h=null!=v?v:h,f=Rr(Rr({},f),{},{[n]:Rr(Rr({},f[n]),y)}),_&&p<=50&&(p++,"object"===typeof _&&(_.placement&&(d=_.placement),_.rects&&(c=!0===_.rects?await a.getElementRects({reference:t,floating:e,strategy:r}):_.rects),({x:u,y:h}=Aj(c,d,l))),m=-1)}return{x:u,y:h,placement:d,strategy:r,middlewareData:f}})(t,e,Rr(Rr({},r),{},{platform:s}))};var Jj="undefined"!==typeof document?i.useLayoutEffect:function(){};function $j(t,e){if(t===e)return!0;if(typeof t!==typeof e)return!1;if("function"===typeof t&&t.toString()===e.toString())return!0;let n,i,r;if(t&&e&&"object"===typeof t){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(i=n;0!==i--;)if(!$j(t[i],e[i]))return!1;return!0}if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(i=n;0!==i--;)if(!{}.hasOwnProperty.call(e,r[i]))return!1;for(i=n;0!==i--;){const n=r[i];if(("_owner"!==n||!t.$$typeof)&&!$j(t[n],e[n]))return!1}return!0}return t!==t&&e!==e}function tW(t){if("undefined"===typeof window)return 1;return(t.ownerDocument.defaultView||window).devicePixelRatio||1}function eW(t,e){const n=tW(t);return Math.round(e*n)/n}function nW(t){const e=i.useRef(t);return Jj(()=>{e.current=t}),e}const iW=(t,e)=>Rr(Rr({},Kj(t)),{},{options:[t,e]}),rW=(t,e)=>Rr(Rr({},(t=>({name:"arrow",options:t,fn(e){const{element:n,padding:i}="function"===typeof t?t(e):t;return n&&(r=n,{}.hasOwnProperty.call(r,"current"))?null!=n.current?Qj({element:n.current,padding:i}).fn(e):{}:n?Qj({element:n,padding:i}).fn(e):{};var r}}))(t)),{},{options:[t,e]}),sW=["transform"],aW=["context","width","height","tipRadius","strokeWidth","staticOffset","stroke","d","style"];const oW="ArrowLeft",lW="ArrowRight",cW="ArrowUp",uW="ArrowDown";const hW=[oW,lW],dW=[cW,uW],fW=Rr({},r);let pW=!1,mW=0;const gW=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+mW++;const vW=fW.useId||function(){const[t,e]=i.useState(()=>pW?gW():void 0);return AG(()=>{null==t&&e(gW())},[]),i.useEffect(()=>{pW=!0},[]),t};const yW=i.forwardRef(function(t,e){const{context:{placement:n,elements:{floating:r},middlewareData:{arrow:s,shift:a}},width:o=14,height:l=7,tipRadius:c=0,strokeWidth:u=0,staticOffset:h,stroke:f,d:p,style:{transform:g}={}}=t,v=d(t.style,sW),y=d(t,aW);const _=vW(),[b,x]=i.useState(!1);if(AG(()=>{if(!r)return;"rtl"===QG(r).direction&&x(!0)},[r]),!r)return null;const[E,w]=n.split("-"),S="top"===E||"bottom"===E;let T=h;(S&&null!=a&&a.x||!S&&null!=a&&a.y)&&(T=null);const M=2*u,A=M/2,C=o/2*(c/-8+1),R=l/2*c/4,k=!!p,L=T&&"end"===w?"bottom":"top";let D=T&&"end"===w?"right":"left";T&&b&&(D="end"===w?"left":"right");const P=null!=(null==s?void 0:s.x)?T||s.x:"",I=null!=(null==s?void 0:s.y)?T||s.y:"",O=p||"M0,0 H"+o+" L"+(o-C)+","+(l-R)+" Q"+o/2+","+l+" "+C+","+(l-R)+" Z",N={top:k?"rotate(180deg)":"",left:k?"rotate(90deg)":"rotate(-90deg)",bottom:k?"":"rotate(180deg)",right:k?"rotate(-90deg)":"rotate(90deg)"}[E];return(0,m.jsxs)("svg",Rr(Rr({},y),{},{"aria-hidden":!0,ref:e,width:k?o:o+M,height:o,viewBox:"0 0 "+o+" "+(l>o?l:o),style:Rr({position:"absolute",pointerEvents:"none",[D]:P,[L]:I,[E]:S||k?"100%":"calc(100% - "+M/2+"px)",transform:[N,g].filter(t=>!!t).join(" ")},v),children:[M>0&&(0,m.jsx)("path",{clipPath:"url(#"+_+")",fill:"none",stroke:f,strokeWidth:M+(p?0:1),d:O}),(0,m.jsx)("path",{stroke:M&&!p?y.fill:"none",d:O}),(0,m.jsx)("clipPath",{id:_,children:(0,m.jsx)("rect",{x:-A,y:A*(k?-1:1),width:o+M,height:o})})]}))});function _W(){const t=new Map;return{emit(e,n){var i;null==(i=t.get(e))||i.forEach(t=>t(n))},on(e,n){t.has(e)||t.set(e,new Set),t.get(e).add(n)},off(e,n){var i;null==(i=t.get(e))||i.delete(n)}}}const bW=i.createContext(null),xW=i.createContext(null),EW=()=>{var t;return(null==(t=i.useContext(bW))?void 0:t.id)||null},wW=()=>i.useContext(xW);function SW(t){const{open:e=!1,onOpenChange:n,elements:r}=t,s=vW(),a=i.useRef({}),[o]=i.useState(()=>_W()),l=null!=EW();const[c,u]=i.useState(r.reference),h=function(t){const e=i.useRef(()=>{});return CG(()=>{e.current=t}),i.useCallback(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return null==e.current?void 0:e.current(...n)},[])}((t,e,i)=>{a.current.openEvent=t?e:void 0,o.emit("openchange",{open:t,event:e,reason:i,nested:l}),null==n||n(t,e,i)}),d=i.useMemo(()=>({setPositionReference:u}),[]),f=i.useMemo(()=>({reference:c||r.reference||null,floating:r.floating||null,domReference:r.reference}),[c,r.reference,r.floating]);return i.useMemo(()=>({dataRef:a,open:e,onOpenChange:h,elements:f,events:o,floatingId:s,refs:d}),[e,h,f,o,s,d])}function TW(t){void 0===t&&(t={});const{nodeId:e}=t,n=SW(Rr(Rr({},t),{},{elements:Rr({reference:null,floating:null},t.elements)})),r=t.rootContext||n,s=r.elements,[a,o]=i.useState(null),[l,c]=i.useState(null),u=(null==s?void 0:s.domReference)||a,h=i.useRef(null),d=wW();AG(()=>{u&&(h.current=u)},[u]);const f=function(t){void 0===t&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:a,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=t,[h,d]=i.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,p]=i.useState(r);$j(f,r)||p(r);const[m,g]=i.useState(null),[v,y]=i.useState(null),_=i.useCallback(t=>{t!==w.current&&(w.current=t,g(t))},[]),b=i.useCallback(t=>{t!==S.current&&(S.current=t,y(t))},[]),x=a||m,E=o||v,w=i.useRef(null),S=i.useRef(null),T=i.useRef(h),M=null!=c,A=nW(c),C=nW(s),R=nW(u),k=i.useCallback(()=>{if(!w.current||!S.current)return;const t={placement:e,strategy:n,middleware:f};C.current&&(t.platform=C.current),Zj(w.current,S.current,t).then(t=>{const e=Rr(Rr({},t),{},{isPositioned:!1!==R.current});L.current&&!$j(T.current,e)&&(T.current=e,nj.flushSync(()=>{d(e)}))})},[f,e,n,C,R]);Jj(()=>{!1===u&&T.current.isPositioned&&(T.current.isPositioned=!1,d(t=>Rr(Rr({},t),{},{isPositioned:!1})))},[u]);const L=i.useRef(!1);Jj(()=>(L.current=!0,()=>{L.current=!1}),[]),Jj(()=>{if(x&&(w.current=x),E&&(S.current=E),x&&E){if(A.current)return A.current(x,E,k);k()}},[x,E,k,A,M]);const D=i.useMemo(()=>({reference:w,floating:S,setReference:_,setFloating:b}),[_,b]),P=i.useMemo(()=>({reference:x,floating:E}),[x,E]),I=i.useMemo(()=>{const t={position:n,left:0,top:0};if(!P.floating)return t;const e=eW(P.floating,h.x),i=eW(P.floating,h.y);return l?Rr(Rr({},t),{},{transform:"translate("+e+"px, "+i+"px)"},tW(P.floating)>=1.5&&{willChange:"transform"}):{position:n,left:e,top:i}},[n,l,P.floating,h.x,h.y]);return i.useMemo(()=>Rr(Rr({},h),{},{update:k,refs:D,elements:P,floatingStyles:I}),[h,k,D,P,I])}(Rr(Rr({},t),{},{elements:Rr(Rr({},s),l&&{reference:l})})),p=i.useCallback(t=>{const e=IG(t)?{getBoundingClientRect:()=>t.getBoundingClientRect(),getClientRects:()=>t.getClientRects(),contextElement:t}:t;c(e),f.refs.setReference(e)},[f.refs]),m=i.useCallback(t=>{(IG(t)||null===t)&&(h.current=t,o(t)),(IG(f.refs.reference.current)||null===f.refs.reference.current||null!==t&&!IG(t))&&f.refs.setReference(t)},[f.refs]),g=i.useMemo(()=>Rr(Rr({},f.refs),{},{setReference:m,setPositionReference:p,domReference:h}),[f.refs,m,p]),v=i.useMemo(()=>Rr(Rr({},f.elements),{},{domReference:u}),[f.elements,u]),y=i.useMemo(()=>Rr(Rr(Rr({},f),r),{},{refs:g,elements:v,nodeId:e}),[f,g,v,e,r]);return AG(()=>{r.dataRef.current.floatingContext=y;const t=null==d?void 0:d.nodesRef.current.find(t=>t.id===e);t&&(t.context=y)}),i.useMemo(()=>Rr(Rr({},f),{},{context:y,refs:g,elements:v}),[f,g,v,y])}var MW=function(t,e){return MW=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},MW(t,e)};function AW(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}MW(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var CW=function(){return CW=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},CW.apply(this,arguments)};function RW(t,e,n){if(n||2===arguments.length)for(var i,r=0,s=e.length;r<s;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}"function"===typeof SuppressedError&&SuppressedError;var kW,LW=function(t){var e=t.showTimeSelectOnly,n=void 0!==e&&e,r=t.showTime,s=void 0!==r&&r,a=t.className,o=t.children,l=t.inline,c=n?"Choose Time":"Choose Date".concat(s?" and Time":"");return i.createElement("div",{className:a,"aria-label":c,role:l?void 0:"dialog","aria-modal":l?void 0:"true"},o)},DW=function(t){var e=t.children,n=t.onClickOutside,r=t.className,s=t.containerRef,a=t.style,o=function(t,e){var n=(0,i.useRef)(null),r=(0,i.useRef)(t);(0,i.useEffect)(function(){r.current=t},[t]);var s=(0,i.useCallback)(function(t){var i,s=t.composed&&t.composedPath&&t.composedPath().find(function(t){return t instanceof Node})||t.target;n.current&&!n.current.contains(s)&&(e&&s instanceof HTMLElement&&s.classList.contains(e)||null===(i=r.current)||void 0===i||i.call(r,t))},[e]);return(0,i.useEffect)(function(){return document.addEventListener("mousedown",s),function(){document.removeEventListener("mousedown",s)}},[s]),n}(n,t.ignoreClass);return i.createElement("div",{className:r,style:a,ref:function(t){o.current=t,s&&(s.current=t)}},e)};function PW(){return"undefined"!==typeof window?window:globalThis}!function(t){t.ArrowUp="ArrowUp",t.ArrowDown="ArrowDown",t.ArrowLeft="ArrowLeft",t.ArrowRight="ArrowRight",t.PageUp="PageUp",t.PageDown="PageDown",t.Home="Home",t.End="End",t.Enter="Enter",t.Space=" ",t.Tab="Tab",t.Escape="Escape",t.Backspace="Backspace",t.X="x"}(kW||(kW={}));function IW(t){if(null==t)return new Date;var e="string"===typeof t?yz(t):vz(t);return NW(e)?e:new Date}function OW(t,e,n,i,r){void 0===r&&(r=IW());for(var s=eY(n)||eY(tY()),a=0,o=Array.isArray(e)?e:[e];a<o.length;a++){var l=o[a],c=iV(t,l,r,{locale:s,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});if(NW(c)&&(!i||t===FW(c,l,n)))return c}return null}function NW(t,e){return aV(t)&&!oV(t,new Date("1/1/1800"))}function FW(t,e,n){if("en"===n)return kV(t,e,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var i=n?eY(n):void 0;return n&&!i&&console.warn('A locale object was not found for the provided string ["'.concat(n,'"].')),kV(t,e,{locale:i=i||eY(tY()),useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function UW(t,e){var n=e.dateFormat,i=e.locale,r=Array.isArray(n)&&n.length>0?n[0]:n;return t&&FW(t,r,i)||""}function BW(t,e){var n=e.hour,i=void 0===n?0:n,r=e.minute,s=void 0===r?0:r,a=e.second;return DV(PV(IV(t,void 0===a?0:a),s),i)}function zW(t){return cV(t)}function HW(t,e,n){return PH(t,{locale:eY(e||tY()),weekStartsOn:n})}function VW(t){return OV(t)}function GW(t){return hV(t)}function jW(t){return NV(t)}function WW(){return cV(IW())}function YW(t){return FV(t)}function XW(t){return BV(t)}function KW(t,e){return t&&e?zV(t,e):!t&&!e}function qW(t,e){return t&&e?HV(t,e):!t&&!e}function QW(t,e){return t&&e?VV(t,e):!t&&!e}function ZW(t,e){return t&&e?GV(t,e):!t&&!e}function JW(t,e){return t&&e?jV(t,e):!t&&!e}function $W(t,e,n){var i,r=cV(e),s=FV(n);try{i=WV(t,{start:r,end:s})}catch(Yq){i=!1}return i}function tY(){return PW().__localeId__}function eY(t){if("string"===typeof t){var e=PW();return e.__localeData__?e.__localeData__[t]:void 0}return t}function nY(t,e){return FW(XV(IW(),t),"LLLL",e)}function iY(t,e){return FW(XV(IW(),t),"LLL",e)}function rY(t,e){var n=void 0===e?{}:e,i=n.minDate,r=n.maxDate,s=n.excludeDates,a=n.excludeDateIntervals,o=n.includeDates,l=n.includeDateIntervals,c=n.filterDate;return!!n.disabled||(fY(t,{minDate:i,maxDate:r})||s&&s.some(function(e){return e instanceof Date?ZW(t,e):ZW(t,e.date)})||a&&a.some(function(e){var n=e.start,i=e.end;return WV(t,{start:n,end:i})})||o&&!o.some(function(e){return ZW(t,e)})||l&&!l.some(function(e){var n=e.start,i=e.end;return WV(t,{start:n,end:i})})||c&&!c(IW(t))||!1)}function sY(t,e){var n=void 0===e?{}:e,i=n.excludeDates,r=n.excludeDateIntervals;return r&&r.length>0?r.some(function(e){var n=e.start,i=e.end;return WV(t,{start:n,end:i})}):i&&i.some(function(e){var n;return e instanceof Date?ZW(t,e):ZW(t,null!==(n=e.date)&&void 0!==n?n:new Date)})||!1}function aY(t,e){var n=void 0===e?{}:e,i=n.minDate,r=n.maxDate,s=n.excludeDates,a=n.includeDates,o=n.filterDate;return fY(t,{minDate:i?OV(i):void 0,maxDate:r?BV(r):void 0})||(null===s||void 0===s?void 0:s.some(function(e){return qW(t,e instanceof Date?e:e.date)}))||a&&!a.some(function(e){return qW(t,e)})||o&&!o(IW(t))||!1}function oY(t,e,n,i){var r=qV(t),s=QV(t),a=qV(e),o=QV(e),l=qV(i);return r===a&&r===l?s<=n&&n<=o:r<a&&(l===r&&s<=n||l===a&&o>=n||l<a&&l>r)}function lY(t,e){var n=void 0===e?{}:e,i=n.minDate,r=n.maxDate,s=n.excludeDates,a=n.includeDates;return fY(t,{minDate:i,maxDate:r})||s&&s.some(function(e){return qW(e instanceof Date?e:e.date,t)})||a&&!a.some(function(e){return qW(e,t)})||!1}function cY(t,e){var n=void 0===e?{}:e,i=n.minDate,r=n.maxDate,s=n.excludeDates,a=n.includeDates,o=n.filterDate;return!!n.disabled||(fY(t,{minDate:i,maxDate:r})||(null===s||void 0===s?void 0:s.some(function(e){return QW(t,e instanceof Date?e:e.date)}))||a&&!a.some(function(e){return QW(t,e)})||o&&!o(IW(t))||!1)}function uY(t,e,n){if(!e||!n)return!1;if(!aV(e)||!aV(n))return!1;var i=qV(e),r=qV(n);return i<=t&&r>=t}function hY(t,e){var n=void 0===e?{}:e,i=n.minDate,r=n.maxDate,s=n.excludeDates,a=n.includeDates,o=n.filterDate;if(n.disabled)return!0;var l=new Date(t,0,1);return fY(l,{minDate:i?hV(i):void 0,maxDate:r?ZV(r):void 0})||(null===s||void 0===s?void 0:s.some(function(t){return KW(l,t instanceof Date?t:t.date)}))||a&&!a.some(function(t){return KW(l,t)})||o&&!o(IW(l))||!1}function dY(t,e,n,i){var r=qV(t),s=JV(t),a=qV(e),o=JV(e),l=qV(i);return r===a&&r===l?s<=n&&n<=o:r<a&&(l===r&&s<=n||l===a&&o>=n||l<a&&l>r)}function fY(t,e){var n,i=void 0===e?{}:e,r=i.minDate,s=i.maxDate;return null!==(n=r&&uV(t,r)<0||s&&uV(t,s)>0)&&void 0!==n&&n}function pY(t,e){return e.some(function(e){return $V(e)===$V(t)&&tG(e)===tG(t)&&eG(e)===eG(t)})}function mY(t,e){var n=void 0===e?{}:e,i=n.excludeTimes,r=n.includeTimes,s=n.filterTime;return i&&pY(t,i)||r&&!pY(t,r)||s&&!s(t)||!1}function gY(t,e){var n=e.minTime,i=e.maxTime;if(!n||!i)throw new Error("Both minTime and maxTime props required");var r=IW();r=IV(r=PV(r=DV(r,$V(t)),tG(t)),eG(t));var s=IW();s=IV(s=PV(s=DV(s,$V(n)),tG(n)),eG(n));var a,o=IW();o=IV(o=PV(o=DV(o,$V(i)),tG(i)),eG(i));try{a=!WV(r,{start:s,end:o})}catch(Yq){a=!1}return a}function vY(t,e){var n=void 0===e?{}:e,i=n.minDate,r=n.includeDates,s=iG(t,1);return i&&rG(i,s)>0||r&&r.every(function(t){return rG(t,s)>0})||!1}function yY(t,e){var n=void 0===e?{}:e,i=n.maxDate,r=n.includeDates,s=nG(t,1);return i&&rG(s,i)>0||r&&r.every(function(t){return rG(s,t)>0})||!1}function _Y(t,e){var n=void 0===e?{}:e,i=n.minDate,r=n.includeDates,s=cG(t,1);return i&&uG(i,s)>0||r&&r.every(function(t){return uG(t,s)>0})||!1}function bY(t,e){var n=void 0===e?{}:e,i=n.maxDate,r=n.includeDates,s=lG(t,1);return i&&uG(s,i)>0||r&&r.every(function(t){return uG(s,t)>0})||!1}function xY(t){var e=t.minDate,n=t.includeDates;return n&&e?hG(n.filter(function(t){return uV(t,e)>=0})):n?hG(n):e}function EY(t){var e=t.maxDate,n=t.includeDates;return n&&e?dG(n.filter(function(t){return uV(t,e)<=0})):n?dG(n):e}function wY(t,e){var n;void 0===t&&(t=[]),void 0===e&&(e="react-datepicker__day--highlighted");for(var i=new Map,r=0,s=t.length;r<s;r++){var a=t[r];if(sV(a)){var o=FW(a,"MM.dd.yyyy");(f=i.get(o)||[]).includes(e)||(f.push(e),i.set(o,f))}else if("object"===typeof a){var l=null!==(n=Object.keys(a)[0])&&void 0!==n?n:"",c=a[l];if("string"===typeof l&&Array.isArray(c))for(var u=0,h=c.length;u<h;u++){var d=c[u];if(d){var f;o=FW(d,"MM.dd.yyyy");(f=i.get(o)||[]).includes(l)||(f.push(l),i.set(o,f))}}}}return i}function SY(t,e){void 0===t&&(t=[]),void 0===e&&(e="react-datepicker__day--holidays");var n=new Map;return t.forEach(function(t){var i=t.date,r=t.holidayName;if(sV(i)){var s=FW(i,"MM.dd.yyyy"),a=n.get(s)||{className:"",holidayNames:[]};if(!("className"in a)||a.className!==e||(o=a.holidayNames,l=[r],o.length!==l.length||!o.every(function(t,e){return t===l[e]}))){var o,l;a.className=e;var c=a.holidayNames;a.holidayNames=c?RW(RW([],c,!0),[r],!1):[r],n.set(s,a)}}}),n}function TY(t,e,n,i,r){for(var s=r.length,a=[],o=0;o<s;o++){var l=t,c=r[o];c&&(l=gG(l=mG(l=pG(l,$V(c)),tG(c)),eG(c)));var u=mG(t,(n+1)*i);vG(l,e)&&oV(l,u)&&void 0!=c&&a.push(c)}return a}function MY(t){return t<10?"0".concat(t):"".concat(t)}function AY(t,e){void 0===e&&(e=12);var n=Math.ceil(qV(t)/e)*e;return{startPeriod:n-(e-1),endPeriod:n}}function CY(t){var e=t.getSeconds(),n=t.getMilliseconds();return vz(t.getTime()-1e3*e-n)}function RY(t){if(!sV(t))throw new Error("Invalid date");var e=new Date(t);return e.setHours(0,0,0,0),e}function kY(t,e){if(!sV(t)||!sV(e))throw new Error("Invalid date received");return oV(RY(t),RY(e))}function LY(t){return t.key===kW.Space}var DY,PY=function(t){function e(e){var n=t.call(this,e)||this;return n.inputRef=i.createRef(),n.onTimeChange=function(t){var e,i;n.setState({time:t});var r=n.props.date,s=r instanceof Date&&!isNaN(+r)?r:new Date;if(null===t||void 0===t?void 0:t.includes(":")){var a=t.split(":"),o=a[0],l=a[1];s.setHours(Number(o)),s.setMinutes(Number(l))}null===(i=(e=n.props).onChange)||void 0===i||i.call(e,s)},n.renderTimeInput=function(){var t=n.state.time,e=n.props,r=e.date,s=e.timeString,a=e.customTimeInput;return a?(0,i.cloneElement)(a,{date:r,value:t,onChange:n.onTimeChange}):i.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:n.inputRef,onClick:function(){var t;null===(t=n.inputRef.current)||void 0===t||t.focus()},required:!0,value:t,onChange:function(t){n.onTimeChange(t.target.value||s)}})},n.state={time:n.props.timeString},n}return AW(e,t),e.getDerivedStateFromProps=function(t,e){return t.timeString!==e.time?{time:t.timeString}:null},e.prototype.render=function(){return i.createElement("div",{className:"react-datepicker__input-time-container"},i.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),i.createElement("div",{className:"react-datepicker-time__input-container"},i.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},e}(i.Component),IY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dayEl=(0,i.createRef)(),e.handleClick=function(t){!e.isDisabled()&&e.props.onClick&&e.props.onClick(t)},e.handleMouseEnter=function(t){!e.isDisabled()&&e.props.onMouseEnter&&e.props.onMouseEnter(t)},e.handleOnKeyDown=function(t){var n,i;t.key===kW.Space&&(t.preventDefault(),t.key=kW.Enter),null===(i=(n=e.props).handleOnKeyDown)||void 0===i||i.call(n,t)},e.isSameDay=function(t){return ZW(e.props.day,t)},e.isKeyboardSelected=function(){var t;if(e.props.disabledKeyboardNavigation)return!1;var n=e.props.selectsMultiple?null===(t=e.props.selectedDates)||void 0===t?void 0:t.some(function(t){return e.isSameDayOrWeek(t)}):e.isSameDayOrWeek(e.props.selected),i=e.props.preSelection&&e.isDisabled(e.props.preSelection);return!n&&e.isSameDayOrWeek(e.props.preSelection)&&!i},e.isDisabled=function(t){return void 0===t&&(t=e.props.day),rY(t,{minDate:e.props.minDate,maxDate:e.props.maxDate,excludeDates:e.props.excludeDates,excludeDateIntervals:e.props.excludeDateIntervals,includeDateIntervals:e.props.includeDateIntervals,includeDates:e.props.includeDates,filterDate:e.props.filterDate,disabled:e.props.disabled})},e.isExcluded=function(){return sY(e.props.day,{excludeDates:e.props.excludeDates,excludeDateIntervals:e.props.excludeDateIntervals})},e.isStartOfWeek=function(){return ZW(e.props.day,HW(e.props.day,e.props.locale,e.props.calendarStartDay))},e.isSameWeek=function(t){return e.props.showWeekPicker&&ZW(t,HW(e.props.day,e.props.locale,e.props.calendarStartDay))},e.isSameDayOrWeek=function(t){return e.isSameDay(t)||e.isSameWeek(t)},e.getHighLightedClass=function(){var t=e.props,n=t.day,i=t.highlightDates;if(!i)return!1;var r=FW(n,"MM.dd.yyyy");return i.get(r)},e.getHolidaysClass=function(){var t,n=e.props,i=n.day,r=n.holidays;if(!r)return[void 0];var s=FW(i,"MM.dd.yyyy");return r.has(s)?[null===(t=r.get(s))||void 0===t?void 0:t.className]:[void 0]},e.isInRange=function(){var t=e.props,n=t.day,i=t.startDate,r=t.endDate;return!(!i||!r)&&$W(n,i,r)},e.isInSelectingRange=function(){var t,n=e.props,i=n.day,r=n.selectsStart,s=n.selectsEnd,a=n.selectsRange,o=n.selectsDisabledDaysInRange,l=n.startDate,c=n.swapRange,u=n.endDate,h=null!==(t=e.props.selectingDate)&&void 0!==t?t:e.props.preSelection;if(!(r||s||a)||!h||!o&&e.isDisabled())return!1;if(r&&u&&(oV(h,u)||JW(h,u)))return $W(i,h,u);if(s&&l&&(vG(h,l)||JW(h,l)))return $W(i,l,h);if(a&&l&&!u){if(JW(h,l))return $W(i,l,h);if(vG(h,l))return $W(i,l,h);if(c&&oV(h,l))return $W(i,h,l)}return!1},e.isSelectingRangeStart=function(){var t;if(!e.isInSelectingRange())return!1;var n=e.props,i=n.day,r=n.startDate,s=n.selectsStart,a=n.swapRange,o=n.selectsRange,l=null!==(t=e.props.selectingDate)&&void 0!==t?t:e.props.preSelection;return ZW(i,s||o&&a&&r&&l&&oV(l,r)?l:r)},e.isSelectingRangeEnd=function(){var t;if(!e.isInSelectingRange())return!1;var n=e.props,i=n.day,r=n.endDate,s=n.selectsEnd,a=n.selectsRange,o=n.swapRange,l=n.startDate,c=null!==(t=e.props.selectingDate)&&void 0!==t?t:e.props.preSelection;return ZW(i,s?c:a&&o&&l&&c?oV(c,l)?l:c:a?c:r)},e.isRangeStart=function(){var t=e.props,n=t.day,i=t.startDate,r=t.endDate;return!(!i||!r)&&ZW(i,n)},e.isRangeEnd=function(){var t=e.props,n=t.day,i=t.startDate,r=t.endDate;return!(!i||!r)&&ZW(r,n)},e.isWeekend=function(){var t=yG(e.props.day);return 0===t||6===t},e.isAfterMonth=function(){return void 0!==e.props.month&&(e.props.month+1)%12===QV(e.props.day)},e.isBeforeMonth=function(){return void 0!==e.props.month&&(QV(e.props.day)+1)%12===e.props.month},e.isCurrentDay=function(){return e.isSameDay(IW())},e.isSelected=function(){var t;return e.props.selectsMultiple?null===(t=e.props.selectedDates)||void 0===t?void 0:t.some(function(t){return e.isSameDayOrWeek(t)}):e.isSameDayOrWeek(e.props.selected)},e.getClassNames=function(t){return hz("react-datepicker__day",e.props.dayClassName?e.props.dayClassName(t):void 0,"react-datepicker__day--"+function(t,e){return FW(t,"ddd",e)}(e.props.day),{"react-datepicker__day--disabled":e.isDisabled(),"react-datepicker__day--excluded":e.isExcluded(),"react-datepicker__day--selected":e.isSelected(),"react-datepicker__day--keyboard-selected":e.isKeyboardSelected(),"react-datepicker__day--range-start":e.isRangeStart(),"react-datepicker__day--range-end":e.isRangeEnd(),"react-datepicker__day--in-range":e.isInRange(),"react-datepicker__day--in-selecting-range":e.isInSelectingRange(),"react-datepicker__day--selecting-range-start":e.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":e.isSelectingRangeEnd(),"react-datepicker__day--today":e.isCurrentDay(),"react-datepicker__day--weekend":e.isWeekend(),"react-datepicker__day--outside-month":e.isAfterMonth()||e.isBeforeMonth()},e.getHighLightedClass(),e.getHolidaysClass())},e.getAriaLabel=function(){var t=e.props,n=t.day,i=t.ariaLabelPrefixWhenEnabled,r=void 0===i?"Choose":i,s=t.ariaLabelPrefixWhenDisabled,a=void 0===s?"Not available":s,o=e.isDisabled()||e.isExcluded()?a:r;return"".concat(o," ").concat(FW(n,"PPPP",e.props.locale))},e.getTitle=function(){var t=e.props,n=t.day,i=t.holidays,r=void 0===i?new Map:i,s=t.excludeDates,a=FW(n,"MM.dd.yyyy"),o=[];return r.has(a)&&o.push.apply(o,r.get(a).holidayNames),e.isExcluded()&&o.push(null===s||void 0===s?void 0:s.filter(function(t){return t instanceof Date?ZW(t,n):ZW(null===t||void 0===t?void 0:t.date,n)}).map(function(t){if(!(t instanceof Date))return null===t||void 0===t?void 0:t.message})),o.join(", ")},e.getTabIndex=function(){var t=e.props.selected,n=e.props.preSelection;return(!e.props.showWeekPicker||!e.props.showWeekNumber&&e.isStartOfWeek())&&(e.isKeyboardSelected()||e.isSameDay(t)&&ZW(n,t))?0:-1},e.handleFocusDay=function(){var t;e.shouldFocusDay()&&(null===(t=e.dayEl.current)||void 0===t||t.focus({preventScroll:!0}))},e.renderDayContents=function(){return e.props.monthShowsDuplicateDaysEnd&&e.isAfterMonth()||e.props.monthShowsDuplicateDaysStart&&e.isBeforeMonth()?null:e.props.renderDayContents?e.props.renderDayContents(_G(e.props.day),e.props.day):_G(e.props.day)},e.render=function(){return i.createElement("div",{ref:e.dayEl,className:e.getClassNames(e.props.day),onKeyDown:e.handleOnKeyDown,onClick:e.handleClick,onMouseEnter:e.props.usePointerEvent?void 0:e.handleMouseEnter,onPointerEnter:e.props.usePointerEvent?e.handleMouseEnter:void 0,tabIndex:e.getTabIndex(),"aria-label":e.getAriaLabel(),role:"gridcell",title:e.getTitle(),"aria-disabled":e.isDisabled(),"aria-current":e.isCurrentDay()?"date":void 0,"aria-selected":e.isSelected()||e.isInRange()},e.renderDayContents(),""!==e.getTitle()&&i.createElement("span",{className:"overlay"},e.getTitle()))},e}return AW(e,t),e.prototype.componentDidMount=function(){this.handleFocusDay()},e.prototype.componentDidUpdate=function(){this.handleFocusDay()},e.prototype.shouldFocusDay=function(){var t=!1;return 0===this.getTabIndex()&&this.isSameDay(this.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(t=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(t=!1),this.isDayActiveElement()&&(t=!0),this.isDuplicateDay()&&(t=!1)),t},e.prototype.isDayActiveElement=function(){var t,e,n;return(null===(e=null===(t=this.props.containerRef)||void 0===t?void 0:t.current)||void 0===e?void 0:e.contains(document.activeElement))&&(null===(n=document.activeElement)||void 0===n?void 0:n.classList.contains("react-datepicker__day"))},e.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},e}(i.Component),OY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.weekNumberEl=(0,i.createRef)(),e.handleClick=function(t){e.props.onClick&&e.props.onClick(t)},e.handleOnKeyDown=function(t){var n,i;t.key===kW.Space&&(t.preventDefault(),t.key=kW.Enter),null===(i=(n=e.props).handleOnKeyDown)||void 0===i||i.call(n,t)},e.isKeyboardSelected=function(){return!e.props.disabledKeyboardNavigation&&!ZW(e.props.date,e.props.selected)&&ZW(e.props.date,e.props.preSelection)},e.getTabIndex=function(){return e.props.showWeekPicker&&e.props.showWeekNumber&&(e.isKeyboardSelected()||ZW(e.props.date,e.props.selected)&&ZW(e.props.preSelection,e.props.selected))?0:-1},e.handleFocusWeekNumber=function(t){var n=!1;0===e.getTabIndex()&&!(null===t||void 0===t?void 0:t.isInputFocused)&&ZW(e.props.date,e.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(n=!0),e.props.inline&&!e.props.shouldFocusDayInline&&(n=!1),e.props.containerRef&&e.props.containerRef.current&&e.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(n=!0)),n&&e.weekNumberEl.current&&e.weekNumberEl.current.focus({preventScroll:!0})},e}return AW(e,t),Object.defineProperty(e,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},e.prototype.componentDidUpdate=function(t){this.handleFocusWeekNumber(t)},e.prototype.render=function(){var t=this.props,n=t.weekNumber,r=t.isWeekDisabled,s=t.ariaLabelPrefix,a=void 0===s?e.defaultProps.ariaLabelPrefix:s,o=t.onClick,l={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!o&&!r,"react-datepicker__week-number--selected":!!o&&ZW(this.props.date,this.props.selected)};return i.createElement("div",{ref:this.weekNumberEl,className:hz(l),"aria-label":"".concat(a," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex(),role:"gridcell"},n)},e}(i.Component),NY=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.isDisabled=function(t){return rY(t,{minDate:n.props.minDate,maxDate:n.props.maxDate,excludeDates:n.props.excludeDates,excludeDateIntervals:n.props.excludeDateIntervals,includeDateIntervals:n.props.includeDateIntervals,includeDates:n.props.includeDates,filterDate:n.props.filterDate})},n.handleDayClick=function(t,e){n.props.onDayClick&&n.props.onDayClick(t,e)},n.handleDayMouseEnter=function(t){n.props.onDayMouseEnter&&n.props.onDayMouseEnter(t)},n.handleWeekClick=function(t,i,r){for(var s,a,o,l=new Date(t),c=0;c<7;c++){var u=new Date(t);if(u.setDate(u.getDate()+c),!n.isDisabled(u)){l=u;break}}"function"===typeof n.props.onWeekSelect&&n.props.onWeekSelect(l,i,r),n.props.showWeekPicker&&n.handleDayClick(l,r),(null!==(s=n.props.shouldCloseOnSelect)&&void 0!==s?s:e.defaultProps.shouldCloseOnSelect)&&(null===(o=(a=n.props).setOpen)||void 0===o||o.call(a,!1))},n.formatWeekNumber=function(t){return n.props.formatWeekNumber?n.props.formatWeekNumber(t):function(t){return HH(t)}(t)},n.isWeekDisabled=function(){for(var t=n.startOfWeek(),e=WH(t,6),i=new Date(t);i<=e;){if(!n.isDisabled(i))return!1;i=WH(i,1)}return!0},n.renderDays=function(){var t=n.startOfWeek(),r=[],s=n.formatWeekNumber(t);if(n.props.showWeekNumber){var a=n.props.onWeekSelect||n.props.showWeekPicker?n.handleWeekClick.bind(n,t,s):void 0;r.push(i.createElement(OY,CW({key:"W"},e.defaultProps,n.props,{weekNumber:s,isWeekDisabled:n.isWeekDisabled(),date:t,onClick:a})))}return r.concat([0,1,2,3,4,5,6].map(function(r){var s=WH(t,r);return i.createElement(IY,CW({},e.defaultProps,n.props,{ariaLabelPrefixWhenEnabled:n.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:n.props.disabledDayAriaLabelPrefix,key:s.valueOf(),day:s,onClick:n.handleDayClick.bind(n,s),onMouseEnter:n.handleDayMouseEnter.bind(n,s)}))}))},n.startOfWeek=function(){return HW(n.props.day,n.props.locale,n.props.calendarStartDay)},n.isKeyboardSelected=function(){return!n.props.disabledKeyboardNavigation&&!ZW(n.startOfWeek(),n.props.selected)&&ZW(n.startOfWeek(),n.props.preSelection)},n}return AW(e,t),Object.defineProperty(e,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),e.prototype.render=function(){var t={"react-datepicker__week":!0,"react-datepicker__week--selected":ZW(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()},e=this.props.weekClassName?this.props.weekClassName(this.startOfWeek()):void 0;return i.createElement("div",{className:hz(t,e),role:"row"},this.renderDays())},e}(i.Component),FY="two_columns",UY="three_columns",BY="four_columns",zY=((DY={})[FY]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},DY[UY]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},DY[BY]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},DY);function HY(t,e){return t?BY:e?FY:UY}var VY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.MONTH_REFS=RW([],Array(12),!0).map(function(){return(0,i.createRef)()}),e.QUARTER_REFS=RW([],Array(4),!0).map(function(){return(0,i.createRef)()}),e.isDisabled=function(t){return rY(t,{minDate:e.props.minDate,maxDate:e.props.maxDate,excludeDates:e.props.excludeDates,excludeDateIntervals:e.props.excludeDateIntervals,includeDateIntervals:e.props.includeDateIntervals,includeDates:e.props.includeDates,filterDate:e.props.filterDate,disabled:e.props.disabled})},e.isExcluded=function(t){return sY(t,{excludeDates:e.props.excludeDates,excludeDateIntervals:e.props.excludeDateIntervals})},e.handleDayClick=function(t,n){var i,r;null===(r=(i=e.props).onDayClick)||void 0===r||r.call(i,t,n,e.props.orderInDisplay)},e.handleDayMouseEnter=function(t){var n,i;null===(i=(n=e.props).onDayMouseEnter)||void 0===i||i.call(n,t)},e.handleMouseLeave=function(){var t,n;null===(n=(t=e.props).onMouseLeave)||void 0===n||n.call(t)},e.isRangeStartMonth=function(t){var n=e.props,i=n.day,r=n.startDate,s=n.endDate;return!(!r||!s)&&qW(XV(i,t),r)},e.isRangeStartQuarter=function(t){var n=e.props,i=n.day,r=n.startDate,s=n.endDate;return!(!r||!s)&&QW(KV(i,t),r)},e.isRangeEndMonth=function(t){var n=e.props,i=n.day,r=n.startDate,s=n.endDate;return!(!r||!s)&&qW(XV(i,t),s)},e.isRangeEndQuarter=function(t){var n=e.props,i=n.day,r=n.startDate,s=n.endDate;return!(!r||!s)&&QW(KV(i,t),s)},e.isInSelectingRangeMonth=function(t){var n,i=e.props,r=i.day,s=i.selectsStart,a=i.selectsEnd,o=i.selectsRange,l=i.startDate,c=i.endDate,u=null!==(n=e.props.selectingDate)&&void 0!==n?n:e.props.preSelection;return!(!(s||a||o)||!u)&&(s&&c?oY(u,c,t,r):(a&&l||!(!o||!l||c))&&oY(l,u,t,r))},e.isSelectingMonthRangeStart=function(t){var n;if(!e.isInSelectingRangeMonth(t))return!1;var i=e.props,r=i.day,s=i.startDate,a=i.selectsStart,o=XV(r,t),l=null!==(n=e.props.selectingDate)&&void 0!==n?n:e.props.preSelection;return qW(o,a?l:s)},e.isSelectingMonthRangeEnd=function(t){var n;if(!e.isInSelectingRangeMonth(t))return!1;var i=e.props,r=i.day,s=i.endDate,a=i.selectsEnd,o=i.selectsRange,l=XV(r,t),c=null!==(n=e.props.selectingDate)&&void 0!==n?n:e.props.preSelection;return qW(l,a||o?c:s)},e.isInSelectingRangeQuarter=function(t){var n,i=e.props,r=i.day,s=i.selectsStart,a=i.selectsEnd,o=i.selectsRange,l=i.startDate,c=i.endDate,u=null!==(n=e.props.selectingDate)&&void 0!==n?n:e.props.preSelection;return!(!(s||a||o)||!u)&&(s&&c?dY(u,c,t,r):(a&&l||!(!o||!l||c))&&dY(l,u,t,r))},e.isWeekInMonth=function(t){var n=e.props.day,i=WH(t,6);return qW(t,n)||qW(i,n)},e.isCurrentMonth=function(t,e){return qV(t)===qV(IW())&&e===QV(IW())},e.isCurrentQuarter=function(t,e){return qV(t)===qV(IW())&&e===JV(IW())},e.isSelectedMonth=function(t,e,n){return QV(n)===e&&qV(t)===qV(n)},e.isSelectMonthInList=function(t,n,i){return i.some(function(i){return e.isSelectedMonth(t,n,i)})},e.isSelectedQuarter=function(t,e,n){return JV(n)===e&&qV(t)===qV(n)},e.isSelectQuarterInList=function(t,n,i){return i.some(function(i){return e.isSelectedQuarter(t,n,i)})},e.isMonthSelected=function(){var t=e.props,n=t.day,i=t.selected,r=t.selectedDates,s=t.selectsMultiple,a=QV(n);return s?null===r||void 0===r?void 0:r.some(function(t){return e.isSelectedMonth(n,a,t)}):!!i&&e.isSelectedMonth(n,a,i)},e.isQuarterSelected=function(){var t=e.props,n=t.day,i=t.selected,r=t.selectedDates,s=t.selectsMultiple,a=JV(n);return s?null===r||void 0===r?void 0:r.some(function(t){return e.isSelectedQuarter(n,a,t)}):!!i&&e.isSelectedQuarter(n,a,i)},e.renderWeeks=function(){if(!NW(e.props.day))return[];for(var t=[],n=e.props.fixedHeight,r=0,s=!1,a=HW(VW(e.props.day),e.props.locale,e.props.calendarStartDay),o=e.props.selected?function(t){return e.props.showWeekPicker?HW(t,e.props.locale,e.props.calendarStartDay):e.props.selected}(e.props.selected):void 0,l=e.props.preSelection?function(t){return e.props.showWeekPicker?HW(t,e.props.locale,e.props.calendarStartDay):e.props.preSelection}(e.props.preSelection):void 0;t.push(i.createElement(NY,CW({},e.props,{ariaLabelPrefix:e.props.weekAriaLabelPrefix,key:r,day:a,month:QV(e.props.day),onDayClick:e.handleDayClick,onDayMouseEnter:e.handleDayMouseEnter,selected:o,preSelection:l,showWeekNumber:e.props.showWeekNumbers}))),!s;){r++,a=bG(a,1);var c=n&&r>=6,u=!n&&!e.isWeekInMonth(a);if(c||u){if(!e.props.peekNextMonth)break;s=!0}}return t},e.onMonthClick=function(t,n){var i=e.isMonthDisabledForLabelDate(n),r=i.isDisabled,s=i.labelDate;r||e.handleDayClick(VW(s),t)},e.onMonthMouseEnter=function(t){var n=e.isMonthDisabledForLabelDate(t),i=n.isDisabled,r=n.labelDate;i||e.handleDayMouseEnter(VW(r))},e.handleMonthNavigation=function(t,n){var i,r,s,a;null===(r=(i=e.props).setPreSelection)||void 0===r||r.call(i,n),null===(a=null===(s=e.MONTH_REFS[t])||void 0===s?void 0:s.current)||void 0===a||a.focus()},e.handleKeyboardNavigation=function(t,n,i){var r,s=e.props,a=s.selected,o=s.preSelection,l=s.setPreSelection,c=s.minDate,u=s.maxDate,h=s.showFourColumnMonthYearPicker,d=s.showTwoColumnMonthYearPicker;if(o){var f=HY(h,d),p=e.getVerticalOffset(f),m=null===(r=zY[f])||void 0===r?void 0:r.grid,g=function(t,e,n){var i,r,s=e,a=n;switch(t){case kW.ArrowRight:s=nG(e,1),a=11===n?0:n+1;break;case kW.ArrowLeft:s=iG(e,1),a=0===n?11:n-1;break;case kW.ArrowUp:s=iG(e,p),a=(null===(i=null===m||void 0===m?void 0:m[0])||void 0===i?void 0:i.includes(n))?n+12-p:n-p;break;case kW.ArrowDown:s=nG(e,p),a=(null===(r=null===m||void 0===m?void 0:m[m.length-1])||void 0===r?void 0:r.includes(n))?n-12+p:n+p}return{newCalculatedDate:s,newCalculatedMonth:a}};if(n!==kW.Enter){var v=function(t,n,i){for(var r=t,s=!1,a=0,o=g(r,n,i),l=o.newCalculatedDate,h=o.newCalculatedMonth;!s;){if(a>=40){l=n,h=i;break}var d;if(c&&l<c)r=kW.ArrowRight,l=(d=g(r,l,h)).newCalculatedDate,h=d.newCalculatedMonth;if(u&&l>u)r=kW.ArrowLeft,l=(d=g(r,l,h)).newCalculatedDate,h=d.newCalculatedMonth;if(lY(l,e.props))l=(d=g(r,l,h)).newCalculatedDate,h=d.newCalculatedMonth;else s=!0;a++}return{newCalculatedDate:l,newCalculatedMonth:h}}(n,o,i),y=v.newCalculatedDate,_=v.newCalculatedMonth;switch(n){case kW.ArrowRight:case kW.ArrowLeft:case kW.ArrowUp:case kW.ArrowDown:e.handleMonthNavigation(_,y)}}else e.isMonthDisabled(i)||(e.onMonthClick(t,i),null===l||void 0===l||l(a))}},e.getVerticalOffset=function(t){var e,n;return null!==(n=null===(e=zY[t])||void 0===e?void 0:e.verticalNavigationOffset)&&void 0!==n?n:0},e.onMonthKeyDown=function(t,n){var i=e.props,r=i.disabledKeyboardNavigation,s=i.handleOnMonthKeyDown,a=t.key;a!==kW.Tab&&t.preventDefault(),r||e.handleKeyboardNavigation(t,a,n),s&&s(t)},e.onQuarterClick=function(t,n){var i=KV(e.props.day,n);cY(i,e.props)||e.handleDayClick(jW(i),t)},e.onQuarterMouseEnter=function(t){var n=KV(e.props.day,t);cY(n,e.props)||e.handleDayMouseEnter(jW(n))},e.handleQuarterNavigation=function(t,n){var i,r,s,a;e.isDisabled(n)||e.isExcluded(n)||(null===(r=(i=e.props).setPreSelection)||void 0===r||r.call(i,n),null===(a=null===(s=e.QUARTER_REFS[t-1])||void 0===s?void 0:s.current)||void 0===a||a.focus())},e.onQuarterKeyDown=function(t,n){var i,r,s=t.key;if(!e.props.disabledKeyboardNavigation)switch(s){case kW.Enter:e.onQuarterClick(t,n),null===(r=(i=e.props).setPreSelection)||void 0===r||r.call(i,e.props.selected);break;case kW.ArrowRight:if(!e.props.preSelection)break;e.handleQuarterNavigation(4===n?1:n+1,sG(e.props.preSelection,1));break;case kW.ArrowLeft:if(!e.props.preSelection)break;e.handleQuarterNavigation(1===n?4:n-1,aG(e.props.preSelection,1))}},e.isMonthDisabledForLabelDate=function(t){var n,i=e.props,r=i.day,s=i.disabled,a=i.minDate,o=i.maxDate,l=i.excludeDates,c=i.includeDates,u=XV(r,t);return s?{isDisabled:!0,labelDate:XV(r,t)}:{isDisabled:null!==(n=(a||o||l||c)&&aY(u,e.props))&&void 0!==n&&n,labelDate:u}},e.isMonthDisabled=function(t){return e.isMonthDisabledForLabelDate(t).isDisabled},e.getMonthClassNames=function(t){var n=e.props,i=n.day,r=n.startDate,s=n.endDate,a=n.preSelection,o=n.monthClassName,l=o?o(XV(i,t)):void 0,c=e.getSelection();return hz("react-datepicker__month-text","react-datepicker__month-".concat(t),l,{"react-datepicker__month-text--disabled":e.isMonthDisabled(t),"react-datepicker__month-text--selected":c?e.isSelectMonthInList(i,t,c):void 0,"react-datepicker__month-text--keyboard-selected":!e.props.disabledKeyboardNavigation&&a&&e.isSelectedMonth(i,t,a)&&!e.isMonthSelected()&&!e.isMonthDisabled(t),"react-datepicker__month-text--in-selecting-range":e.isInSelectingRangeMonth(t),"react-datepicker__month-text--in-range":r&&s?oY(r,s,t,i):void 0,"react-datepicker__month-text--range-start":e.isRangeStartMonth(t),"react-datepicker__month-text--range-end":e.isRangeEndMonth(t),"react-datepicker__month-text--selecting-range-start":e.isSelectingMonthRangeStart(t),"react-datepicker__month-text--selecting-range-end":e.isSelectingMonthRangeEnd(t),"react-datepicker__month-text--today":e.isCurrentMonth(i,t)})},e.getTabIndex=function(t){if(null==e.props.preSelection)return"-1";var n=QV(e.props.preSelection),i=e.isMonthDisabledForLabelDate(n).isDisabled;return t!==n||i||e.props.disabledKeyboardNavigation?"-1":"0"},e.getQuarterTabIndex=function(t){if(null==e.props.preSelection)return"-1";var n=JV(e.props.preSelection),i=cY(e.props.day,e.props);return t!==n||i||e.props.disabledKeyboardNavigation?"-1":"0"},e.getAriaLabel=function(t){var n=e.props,i=n.chooseDayAriaLabelPrefix,r=void 0===i?"Choose":i,s=n.disabledDayAriaLabelPrefix,a=void 0===s?"Not available":s,o=n.day,l=n.locale,c=XV(o,t),u=e.isDisabled(c)||e.isExcluded(c)?a:r;return"".concat(u," ").concat(FW(c,"MMMM yyyy",l))},e.getQuarterClassNames=function(t){var n=e.props,i=n.day,r=n.startDate,s=n.endDate,a=n.minDate,o=n.maxDate,l=n.excludeDates,c=n.includeDates,u=n.filterDate,h=n.preSelection,d=n.disabledKeyboardNavigation,f=n.disabled,p=(a||o||l||c||u||f)&&cY(KV(i,t),e.props),m=e.getSelection();return hz("react-datepicker__quarter-text","react-datepicker__quarter-".concat(t),{"react-datepicker__quarter-text--disabled":p,"react-datepicker__quarter-text--selected":m?e.isSelectQuarterInList(i,t,m):void 0,"react-datepicker__quarter-text--keyboard-selected":!d&&h&&e.isSelectedQuarter(i,t,h)&&!e.isQuarterSelected()&&!p,"react-datepicker__quarter-text--in-selecting-range":e.isInSelectingRangeQuarter(t),"react-datepicker__quarter-text--in-range":r&&s?dY(r,s,t,i):void 0,"react-datepicker__quarter-text--range-start":e.isRangeStartQuarter(t),"react-datepicker__quarter-text--range-end":e.isRangeEndQuarter(t),"react-datepicker__quarter-text--today":e.isCurrentQuarter(i,t)})},e.getMonthContent=function(t){var n=e.props,i=n.showFullMonthYearPicker,r=n.renderMonthContent,s=n.locale,a=n.day,o=iY(t,s),l=nY(t,s);return r?r(t,o,l,a):i?l:o},e.getQuarterContent=function(t){var n,i=e.props,r=i.renderQuarterContent,s=function(t,e){return FW(KV(IW(),t),"QQQ",e)}(t,i.locale);return null!==(n=null===r||void 0===r?void 0:r(t,s))&&void 0!==n?n:s},e.renderMonths=function(){var t,n=e.props,r=n.showTwoColumnMonthYearPicker,s=n.showFourColumnMonthYearPicker,a=n.day,o=n.selected,l=null===(t=zY[HY(s,r)])||void 0===t?void 0:t.grid;return null===l||void 0===l?void 0:l.map(function(t,n){return i.createElement("div",{className:"react-datepicker__month-wrapper",key:n},t.map(function(t,n){return i.createElement("div",{ref:e.MONTH_REFS[t],key:n,onClick:function(n){e.onMonthClick(n,t)},onKeyDown:function(n){LY(n)&&(n.preventDefault(),n.key=kW.Enter),e.onMonthKeyDown(n,t)},onMouseEnter:e.props.usePointerEvent?void 0:function(){return e.onMonthMouseEnter(t)},onPointerEnter:e.props.usePointerEvent?function(){return e.onMonthMouseEnter(t)}:void 0,tabIndex:Number(e.getTabIndex(t)),className:e.getMonthClassNames(t),"aria-disabled":e.isMonthDisabled(t),role:"option","aria-label":e.getAriaLabel(t),"aria-current":e.isCurrentMonth(a,t)?"date":void 0,"aria-selected":o?e.isSelectedMonth(a,t,o):void 0},e.getMonthContent(t))}))})},e.renderQuarters=function(){var t=e.props,n=t.day,r=t.selected;return i.createElement("div",{className:"react-datepicker__quarter-wrapper"},[1,2,3,4].map(function(t,s){return i.createElement("div",{key:s,ref:e.QUARTER_REFS[s],role:"option",onClick:function(n){e.onQuarterClick(n,t)},onKeyDown:function(n){e.onQuarterKeyDown(n,t)},onMouseEnter:e.props.usePointerEvent?void 0:function(){return e.onQuarterMouseEnter(t)},onPointerEnter:e.props.usePointerEvent?function(){return e.onQuarterMouseEnter(t)}:void 0,className:e.getQuarterClassNames(t),"aria-selected":r?e.isSelectedQuarter(n,t,r):void 0,tabIndex:Number(e.getQuarterTabIndex(t)),"aria-current":e.isCurrentQuarter(n,t)?"date":void 0},e.getQuarterContent(t))}))},e.getClassNames=function(){var t=e.props,n=t.selectingDate,i=t.selectsStart,r=t.selectsEnd;return hz("react-datepicker__month",{"react-datepicker__month--selecting-range":n&&(i||r)},{"react-datepicker__monthPicker":t.showMonthYearPicker},{"react-datepicker__quarterPicker":t.showQuarterYearPicker},{"react-datepicker__weekPicker":t.showWeekPicker})},e}return AW(e,t),e.prototype.getSelection=function(){var t=this.props,e=t.selected,n=t.selectedDates;return t.selectsMultiple?n:e?[e]:void 0},e.prototype.render=function(){var t=this.props,e=t.showMonthYearPicker,n=t.showQuarterYearPicker,r=t.day,s=t.ariaLabelPrefix,a=void 0===s?"Month ":s,o=a?a.trim()+" ":"",l=NW(r)?"".concat(o).concat(FW(r,"MMMM, yyyy",this.props.locale)):"";return e||n?i.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":l,role:"listbox"},e?this.renderMonths():this.renderQuarters()):i.createElement("div",{role:"table"},this.props.dayNamesHeader&&i.createElement("div",{role:"rowgroup"},this.props.dayNamesHeader),i.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":l,role:"rowgroup"},this.renderWeeks()))},e}(i.Component),GY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.monthOptionButtonsRef={},e.isSelectedMonth=function(t){return e.props.month===t},e.handleOptionKeyDown=function(t,n){var i;switch(n.key){case"Enter":n.preventDefault(),e.onChange(t);break;case"Escape":n.preventDefault(),e.props.onCancel();break;case"ArrowUp":case"ArrowDown":n.preventDefault();var r=(t+("ArrowUp"===n.key?-1:1)+e.props.monthNames.length)%e.props.monthNames.length;null===(i=e.monthOptionButtonsRef[r])||void 0===i||i.focus()}},e.renderOptions=function(){return e.monthOptionButtonsRef={},e.props.monthNames.map(function(t,n){return i.createElement("div",{ref:function(t){e.monthOptionButtonsRef[n]=t,e.isSelectedMonth(n)&&(null===t||void 0===t||t.focus())},role:"button",tabIndex:0,className:e.isSelectedMonth(n)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:t,onClick:e.onChange.bind(e,n),onKeyDown:e.handleOptionKeyDown.bind(e,n),"aria-selected":e.isSelectedMonth(n)?"true":void 0},e.isSelectedMonth(n)?i.createElement("span",{className:"react-datepicker__month-option--selected"},"\u2713"):"",t)})},e.onChange=function(t){return e.props.onChange(t)},e.handleClickOutside=function(){return e.props.onCancel()},e}return AW(e,t),e.prototype.render=function(){return i.createElement(DW,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},e}(i.Component),jY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={dropdownVisible:!1},e.renderSelectOptions=function(t){return t.map(function(t,e){return i.createElement("option",{key:t,value:e},t)})},e.renderSelectMode=function(t){return i.createElement("select",{value:e.props.month,className:"react-datepicker__month-select",onChange:function(t){return e.onChange(parseInt(t.target.value))}},e.renderSelectOptions(t))},e.renderReadView=function(t,n){return i.createElement("button",{key:"read",type:"button",style:{visibility:t?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:e.toggleDropdown},i.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),i.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},n[e.props.month]))},e.renderDropdown=function(t){return i.createElement(GY,CW({key:"dropdown"},e.props,{monthNames:t,onChange:e.onChange,onCancel:e.toggleDropdown}))},e.renderScrollMode=function(t){var n=e.state.dropdownVisible,i=[e.renderReadView(!n,t)];return n&&i.unshift(e.renderDropdown(t)),i},e.onChange=function(t){e.toggleDropdown(),t!==e.props.month&&e.props.onChange(t)},e.toggleDropdown=function(){return e.setState({dropdownVisible:!e.state.dropdownVisible})},e}return AW(e,t),e.prototype.render=function(){var t,e=this,n=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(t){return iY(t,e.props.locale)}:function(t){return nY(t,e.props.locale)});switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode(n);break;case"select":t=this.renderSelectMode(n)}return i.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},t)},e}(i.Component);function WY(t,e){for(var n=[],i=VW(t),r=VW(e);!vG(i,r);)n.push(IW(i)),i=nG(i,1);return n}var YY=function(t){function e(e){var n=t.call(this,e)||this;return n.renderOptions=function(){return n.state.monthYearsList.map(function(t){var e=xG(t),r=KW(n.props.date,t)&&qW(n.props.date,t);return i.createElement("div",{className:r?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:e,onClick:n.onChange.bind(n,e),"aria-selected":r?"true":void 0},r?i.createElement("span",{className:"react-datepicker__month-year-option--selected"},"\u2713"):"",FW(t,n.props.dateFormat,n.props.locale))})},n.onChange=function(t){return n.props.onChange(t)},n.handleClickOutside=function(){n.props.onCancel()},n.state={monthYearsList:WY(n.props.minDate,n.props.maxDate)},n}return AW(e,t),e.prototype.render=function(){var t=hz({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return i.createElement(DW,{className:t,onClickOutside:this.handleClickOutside},this.renderOptions())},e}(i.Component),XY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={dropdownVisible:!1},e.renderSelectOptions=function(){for(var t=VW(e.props.minDate),n=VW(e.props.maxDate),r=[];!vG(t,n);){var s=xG(t);r.push(i.createElement("option",{key:s,value:s},FW(t,e.props.dateFormat,e.props.locale))),t=nG(t,1)}return r},e.onSelectChange=function(t){e.onChange(parseInt(t.target.value))},e.renderSelectMode=function(){return i.createElement("select",{value:xG(VW(e.props.date)),className:"react-datepicker__month-year-select",onChange:e.onSelectChange},e.renderSelectOptions())},e.renderReadView=function(t){var n=FW(e.props.date,e.props.dateFormat,e.props.locale);return i.createElement("div",{key:"read",style:{visibility:t?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:e.toggleDropdown},i.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),i.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},n))},e.renderDropdown=function(){return i.createElement(YY,CW({key:"dropdown"},e.props,{onChange:e.onChange,onCancel:e.toggleDropdown}))},e.renderScrollMode=function(){var t=e.state.dropdownVisible,n=[e.renderReadView(!t)];return t&&n.unshift(e.renderDropdown()),n},e.onChange=function(t){e.toggleDropdown();var n=IW(t);KW(e.props.date,n)&&qW(e.props.date,n)||e.props.onChange(n)},e.toggleDropdown=function(){return e.setState({dropdownVisible:!e.state.dropdownVisible})},e}return AW(e,t),e.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode()}return i.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},t)},e}(i.Component),KY=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.state={height:null},n.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var t,i,r;n.list&&(n.list.scrollTop=null!==(r=n.centerLi&&e.calcCenterPosition(n.props.monthRef?n.props.monthRef.clientHeight-(null!==(i=null===(t=n.header)||void 0===t?void 0:t.clientHeight)&&void 0!==i?i:0):n.list.clientHeight,n.centerLi))&&void 0!==r?r:0)})},n.handleClick=function(t){var e,i;(n.props.minTime||n.props.maxTime)&&gY(t,n.props)||(n.props.excludeTimes||n.props.includeTimes||n.props.filterTime)&&mY(t,n.props)||null===(i=(e=n.props).onChange)||void 0===i||i.call(e,t)},n.isSelectedTime=function(t){return n.props.selected&&(e=n.props.selected,i=t,CY(e).getTime()===CY(i).getTime());var e,i},n.isDisabledTime=function(t){return(n.props.minTime||n.props.maxTime)&&gY(t,n.props)||(n.props.excludeTimes||n.props.includeTimes||n.props.filterTime)&&mY(t,n.props)},n.liClasses=function(t){var i,r=["react-datepicker__time-list-item",n.props.timeClassName?n.props.timeClassName(t):void 0];return n.isSelectedTime(t)&&r.push("react-datepicker__time-list-item--selected"),n.isDisabledTime(t)&&r.push("react-datepicker__time-list-item--disabled"),n.props.injectTimes&&(3600*$V(t)+60*tG(t)+eG(t))%(60*(null!==(i=n.props.intervals)&&void 0!==i?i:e.defaultProps.intervals))!==0&&r.push("react-datepicker__time-list-item--injected"),r.join(" ")},n.handleOnKeyDown=function(t,e){var i,r;t.key===kW.Space&&(t.preventDefault(),t.key=kW.Enter),(t.key===kW.ArrowUp||t.key===kW.ArrowLeft)&&t.target instanceof HTMLElement&&t.target.previousSibling&&(t.preventDefault(),t.target.previousSibling instanceof HTMLElement&&t.target.previousSibling.focus()),(t.key===kW.ArrowDown||t.key===kW.ArrowRight)&&t.target instanceof HTMLElement&&t.target.nextSibling&&(t.preventDefault(),t.target.nextSibling instanceof HTMLElement&&t.target.nextSibling.focus()),t.key===kW.Enter&&n.handleClick(e),null===(r=(i=n.props).handleOnKeyDown)||void 0===r||r.call(i,t)},n.renderTimes=function(){for(var t,r=[],s="string"===typeof n.props.format?n.props.format:"p",a=null!==(t=n.props.intervals)&&void 0!==t?t:e.defaultProps.intervals,o=n.props.selected||n.props.openToDate||IW(),l=zW(o),c=n.props.injectTimes&&n.props.injectTimes.sort(function(t,e){return t.getTime()-e.getTime()}),u=60*function(t){var e=new Date(t.getFullYear(),t.getMonth(),t.getDate()),n=new Date(t.getFullYear(),t.getMonth(),t.getDate(),24);return Math.round((+n-+e)/36e5)}(o),h=u/a,d=0;d<h;d++){var f=mG(l,d*a);if(r.push(f),c){var p=TY(l,f,d,a,c);r=r.concat(p)}}var m=r.reduce(function(t,e){return e.getTime()<=o.getTime()?e:t},r[0]);return r.map(function(t){return i.createElement("li",{key:t.valueOf(),onClick:n.handleClick.bind(n,t),className:n.liClasses(t),ref:function(e){t===m&&(n.centerLi=e)},onKeyDown:function(e){n.handleOnKeyDown(e,t)},tabIndex:t===m?0:-1,role:"option","aria-selected":n.isSelectedTime(t)?"true":void 0,"aria-disabled":n.isDisabledTime(t)?"true":void 0},FW(t,s,n.props.locale))})},n.renderTimeCaption=function(){return!1===n.props.showTimeCaption?i.createElement(i.Fragment,null):i.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(n.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(t){n.header=t}},i.createElement("div",{className:"react-datepicker-time__header"},n.props.timeCaption))},n}return AW(e,t),Object.defineProperty(e,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},e.prototype.componentWillUnmount=function(){var t;null===(t=this.resizeObserver)||void 0===t||t.disconnect()},e.prototype.observeDatePickerHeightChanges=function(){var t=this,e=this.props.monthRef;this.updateContainerHeight(),e&&(this.resizeObserver=new ResizeObserver(function(){t.updateContainerHeight()}),this.resizeObserver.observe(e))},e.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},e.prototype.render=function(){var t,n=this,r=this.state.height;return i.createElement("div",{className:"react-datepicker__time-container ".concat((null!==(t=this.props.todayButton)&&void 0!==t?t:e.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),i.createElement("div",{className:"react-datepicker__time"},i.createElement("div",{className:"react-datepicker__time-box"},i.createElement("ul",{className:"react-datepicker__time-list",ref:function(t){n.list=t},style:r?{height:r}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},e.calcCenterPosition=function(t,e){return e.offsetTop-(t/2-e.clientHeight/2)},e}(i.Component),qY=function(t){function e(e){var n=t.call(this,e)||this;return n.YEAR_REFS=RW([],Array(n.props.yearItemNumber),!0).map(function(){return(0,i.createRef)()}),n.isDisabled=function(t){return rY(t,{minDate:n.props.minDate,maxDate:n.props.maxDate,excludeDates:n.props.excludeDates,includeDates:n.props.includeDates,filterDate:n.props.filterDate})},n.isExcluded=function(t){return sY(t,{excludeDates:n.props.excludeDates})},n.selectingDate=function(){var t;return null!==(t=n.props.selectingDate)&&void 0!==t?t:n.props.preSelection},n.updateFocusOnPaginate=function(t){window.requestAnimationFrame(function(){var e,i;null===(i=null===(e=n.YEAR_REFS[t])||void 0===e?void 0:e.current)||void 0===i||i.focus()})},n.handleYearClick=function(t,e){n.props.onDayClick&&n.props.onDayClick(t,e)},n.handleYearNavigation=function(t,e){var i,r,s,a,o=n.props,l=o.date,c=o.yearItemNumber;if(void 0!==l&&void 0!==c){var u=AY(l,c).startPeriod;n.isDisabled(e)||n.isExcluded(e)||(null===(r=(i=n.props).setPreSelection)||void 0===r||r.call(i,e),t-u<0?n.updateFocusOnPaginate(c-(u-t)):t-u>=c?n.updateFocusOnPaginate(Math.abs(c-(t-u))):null===(a=null===(s=n.YEAR_REFS[t-u])||void 0===s?void 0:s.current)||void 0===a||a.focus())}},n.isSameDay=function(t,e){return ZW(t,e)},n.isCurrentYear=function(t){return t===qV(IW())},n.isRangeStart=function(t){return n.props.startDate&&n.props.endDate&&KW(EG(IW(),t),n.props.startDate)},n.isRangeEnd=function(t){return n.props.startDate&&n.props.endDate&&KW(EG(IW(),t),n.props.endDate)},n.isInRange=function(t){return uY(t,n.props.startDate,n.props.endDate)},n.isInSelectingRange=function(t){var e=n.props,i=e.selectsStart,r=e.selectsEnd,s=e.selectsRange,a=e.startDate,o=e.endDate;return!(!(i||r||s)||!n.selectingDate())&&(i&&o?uY(t,n.selectingDate(),o):(r&&a||!(!s||!a||o))&&uY(t,a,n.selectingDate()))},n.isSelectingRangeStart=function(t){var e;if(!n.isInSelectingRange(t))return!1;var i=n.props,r=i.startDate,s=i.selectsStart,a=EG(IW(),t);return KW(a,s?null!==(e=n.selectingDate())&&void 0!==e?e:null:null!==r&&void 0!==r?r:null)},n.isSelectingRangeEnd=function(t){var e;if(!n.isInSelectingRange(t))return!1;var i=n.props,r=i.endDate,s=i.selectsEnd,a=i.selectsRange,o=EG(IW(),t);return KW(o,s||a?null!==(e=n.selectingDate())&&void 0!==e?e:null:null!==r&&void 0!==r?r:null)},n.isKeyboardSelected=function(t){if(!n.props.disabledKeyboardNavigation&&void 0!==n.props.date&&null!=n.props.preSelection){var e=n.props,i=e.minDate,r=e.maxDate,s=e.excludeDates,a=e.includeDates,o=e.filterDate,l=e.selected,c=GW(EG(n.props.date,t)),u=(i||r||s||a||o)&&hY(t,n.props),h=!!l&&ZW(c,GW(l)),d=ZW(c,GW(n.props.preSelection));return!n.props.inline&&!h&&d&&!u}},n.isSelectedYear=function(t){var e=n.props,i=e.selectsMultiple,r=e.selected,s=e.selectedDates;return i?null===s||void 0===s?void 0:s.some(function(e){return t===qV(e)}):!!r&&t===qV(r)},n.onYearClick=function(t,e){var i=n.props.date;void 0!==i&&n.handleYearClick(GW(EG(i,e)),t)},n.onYearKeyDown=function(t,e){var i,r,s=t.key,a=n.props,o=a.date,l=a.yearItemNumber,c=a.handleOnKeyDown;if(s!==kW.Tab&&t.preventDefault(),!n.props.disabledKeyboardNavigation)switch(s){case kW.Enter:if(null==n.props.selected)break;n.onYearClick(t,e),null===(r=(i=n.props).setPreSelection)||void 0===r||r.call(i,n.props.selected);break;case kW.ArrowRight:if(null==n.props.preSelection)break;n.handleYearNavigation(e+1,lG(n.props.preSelection,1));break;case kW.ArrowLeft:if(null==n.props.preSelection)break;n.handleYearNavigation(e-1,cG(n.props.preSelection,1));break;case kW.ArrowUp:if(void 0===o||void 0===l||null==n.props.preSelection)break;var u=AY(o,l).startPeriod;if((f=e-(d=3))<u){var h=l%d;e>=u&&e<u+h?d=h:d+=h,f=e-d}n.handleYearNavigation(f,cG(n.props.preSelection,d));break;case kW.ArrowDown:if(void 0===o||void 0===l||null==n.props.preSelection)break;var d,f,p=AY(o,l).endPeriod;if((f=e+(d=3))>p){h=l%d;e<=p&&e>p-h?d=h:d+=h,f=e+d}n.handleYearNavigation(f,lG(n.props.preSelection,d))}c&&c(t)},n.getYearClassNames=function(t){var e=n.props,i=e.date,r=e.disabled,s=e.minDate,a=e.maxDate,o=e.excludeDates,l=e.includeDates,c=e.filterDate,u=e.yearClassName;return hz("react-datepicker__year-text","react-datepicker__year-".concat(t),i?null===u||void 0===u?void 0:u(EG(i,t)):void 0,{"react-datepicker__year-text--selected":n.isSelectedYear(t),"react-datepicker__year-text--disabled":(s||a||o||l||c||r)&&hY(t,n.props),"react-datepicker__year-text--keyboard-selected":n.isKeyboardSelected(t),"react-datepicker__year-text--range-start":n.isRangeStart(t),"react-datepicker__year-text--range-end":n.isRangeEnd(t),"react-datepicker__year-text--in-range":n.isInRange(t),"react-datepicker__year-text--in-selecting-range":n.isInSelectingRange(t),"react-datepicker__year-text--selecting-range-start":n.isSelectingRangeStart(t),"react-datepicker__year-text--selecting-range-end":n.isSelectingRangeEnd(t),"react-datepicker__year-text--today":n.isCurrentYear(t)})},n.getYearTabIndex=function(t){if(n.props.disabledKeyboardNavigation||null==n.props.preSelection)return"-1";var e=qV(n.props.preSelection),i=hY(t,n.props);return t!==e||i?"-1":"0"},n.getYearContent=function(t){return n.props.renderYearContent?n.props.renderYearContent(t):t},n}return AW(e,t),e.prototype.render=function(){var t=this,e=[],n=this.props,r=n.date,s=n.yearItemNumber,a=n.onYearMouseEnter,o=n.onYearMouseLeave;if(void 0===r)return null;for(var l=AY(r,s),c=l.startPeriod,u=l.endPeriod,h=function(n){e.push(i.createElement("div",{ref:d.YEAR_REFS[n-c],onClick:function(e){t.onYearClick(e,n)},onKeyDown:function(e){LY(e)&&(e.preventDefault(),e.key=kW.Enter),t.onYearKeyDown(e,n)},tabIndex:Number(d.getYearTabIndex(n)),className:d.getYearClassNames(n),onMouseEnter:d.props.usePointerEvent?void 0:function(t){return a(t,n)},onPointerEnter:d.props.usePointerEvent?function(t){return a(t,n)}:void 0,onMouseLeave:d.props.usePointerEvent?void 0:function(t){return o(t,n)},onPointerLeave:d.props.usePointerEvent?function(t){return o(t,n)}:void 0,key:n,"aria-current":d.isCurrentYear(n)?"date":void 0},d.getYearContent(n)))},d=this,f=c;f<=u;f++)h(f);return i.createElement("div",{className:"react-datepicker__year"},i.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},e))},e}(i.Component);function QY(t,e,n,i){for(var r=[],s=0;s<2*e+1;s++){var a=t+e-s,o=!0;n&&(o=qV(n)<=a),i&&o&&(o=qV(i)>=a),o&&r.push(a)}return r}var ZY=function(t){function e(e){var n=t.call(this,e)||this;n.yearOptionButtonsRef={},n.handleOptionKeyDown=function(t,e){var i;switch(e.key){case"Enter":e.preventDefault(),n.onChange(t);break;case"Escape":e.preventDefault(),n.props.onCancel();break;case"ArrowUp":case"ArrowDown":e.preventDefault();var r=t+("ArrowUp"===e.key?1:-1);n.yearOptionButtonsRef[r]&&(null===(i=n.yearOptionButtonsRef[r])||void 0===i||i.focus())}},n.renderOptions=function(){n.yearOptionButtonsRef={};var t=n.props.year,e=n.state.yearsList.map(function(e){return i.createElement("div",{ref:function(i){n.yearOptionButtonsRef[e]=i,e===t&&(null===i||void 0===i||i.focus())},role:"button",tabIndex:0,className:t===e?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:e,onClick:n.onChange.bind(n,e),onKeyDown:n.handleOptionKeyDown.bind(n,e),"aria-selected":t===e?"true":void 0},t===e?i.createElement("span",{className:"react-datepicker__year-option--selected"},"\u2713"):"",e)}),r=n.props.minDate?qV(n.props.minDate):null,s=n.props.maxDate?qV(n.props.maxDate):null;return s&&n.state.yearsList.find(function(t){return t===s})||e.unshift(i.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:n.incrementYears},i.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),r&&n.state.yearsList.find(function(t){return t===r})||e.push(i.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:n.decrementYears},i.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),e},n.onChange=function(t){n.props.onChange(t)},n.handleClickOutside=function(){n.props.onCancel()},n.shiftYears=function(t){var e=n.state.yearsList.map(function(e){return e+t});n.setState({yearsList:e})},n.incrementYears=function(){return n.shiftYears(1)},n.decrementYears=function(){return n.shiftYears(-1)};var r=e.yearDropdownItemNumber,s=e.scrollableYearDropdown,a=r||(s?10:5);return n.state={yearsList:QY(n.props.year,a,n.props.minDate,n.props.maxDate)},n.dropdownRef=(0,i.createRef)(),n}return AW(e,t),e.prototype.componentDidMount=function(){var t=this.dropdownRef.current;if(t){var e=t.children?Array.from(t.children):null,n=e?e.find(function(t){return t.ariaSelected}):null;t.scrollTop=n&&n instanceof HTMLElement?n.offsetTop+(n.clientHeight-t.clientHeight)/2:(t.scrollHeight-t.clientHeight)/2}},e.prototype.render=function(){var t=hz({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return i.createElement(DW,{className:t,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},e}(i.Component),JY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={dropdownVisible:!1},e.renderSelectOptions=function(){for(var t=e.props.minDate?qV(e.props.minDate):1900,n=e.props.maxDate?qV(e.props.maxDate):2100,r=[],s=t;s<=n;s++)r.push(i.createElement("option",{key:s,value:s},s));return r},e.onSelectChange=function(t){e.onChange(parseInt(t.target.value))},e.renderSelectMode=function(){return i.createElement("select",{value:e.props.year,className:"react-datepicker__year-select",onChange:e.onSelectChange},e.renderSelectOptions())},e.renderReadView=function(t){return i.createElement("button",{key:"read",type:"button",style:{visibility:t?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:e.toggleDropdown},i.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),i.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},e.props.year))},e.renderDropdown=function(){return i.createElement(ZY,CW({key:"dropdown"},e.props,{onChange:e.onChange,onCancel:e.toggleDropdown}))},e.renderScrollMode=function(){var t=e.state.dropdownVisible,n=[e.renderReadView(!t)];return t&&n.unshift(e.renderDropdown()),n},e.onChange=function(t){e.toggleDropdown(),t!==e.props.year&&e.props.onChange(t)},e.toggleDropdown=function(t){e.setState({dropdownVisible:!e.state.dropdownVisible},function(){e.props.adjustDateOnChange&&e.handleYearChange(e.props.date,t)})},e.handleYearChange=function(t,n){var i;null===(i=e.onSelect)||void 0===i||i.call(e,t,n),e.setOpen()},e.onSelect=function(t,n){var i,r;null===(r=(i=e.props).onSelect)||void 0===r||r.call(i,t,n)},e.setOpen=function(){var t,n;null===(n=(t=e.props).setOpen)||void 0===n||n.call(t,!0)},e}return AW(e,t),e.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode()}return i.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},t)},e}(i.Component),$Y=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],tX="react-datepicker-ignore-onclickoutside",eX=function(t){function e(n){var r=t.call(this,n)||this;return r.monthContainer=void 0,r.handleClickOutside=function(t){r.props.onClickOutside(t)},r.setClickOutsideRef=function(){return r.containerRef.current},r.handleDropdownFocus=function(t){var e,n;(function(t){var e=(t.className||"").split(/\s+/);return $Y.some(function(t){return e.indexOf(t)>=0})})(t.target)&&(null===(n=(e=r.props).onDropdownFocus)||void 0===n||n.call(e,t))},r.getDateInView=function(){var t=r.props,e=t.preSelection,n=t.selected,i=t.openToDate,s=xY(r.props),a=EY(r.props),o=IW(),l=i||n||e;return l||(s&&oV(o,s)?s:a&&vG(o,a)?a:o)},r.increaseMonth=function(){r.setState(function(t){return{date:nG(t.date,1)}},function(){return r.handleMonthChange(r.state.date)})},r.decreaseMonth=function(){r.setState(function(t){return{date:iG(t.date,1)}},function(){return r.handleMonthChange(r.state.date)})},r.handleDayClick=function(t,e,n){r.props.onSelect(t,e,n),r.props.setPreSelection&&r.props.setPreSelection(t)},r.handleDayMouseEnter=function(t){r.setState({selectingDate:t}),r.props.onDayMouseEnter&&r.props.onDayMouseEnter(t)},r.handleMonthMouseLeave=function(){r.setState({selectingDate:void 0}),r.props.onMonthMouseLeave&&r.props.onMonthMouseLeave()},r.handleYearMouseEnter=function(t,e){r.setState({selectingDate:EG(IW(),e)}),r.props.onYearMouseEnter&&r.props.onYearMouseEnter(t,e)},r.handleYearMouseLeave=function(t,e){r.props.onYearMouseLeave&&r.props.onYearMouseLeave(t,e)},r.handleYearChange=function(t){var e,n,i,s;null===(n=(e=r.props).onYearChange)||void 0===n||n.call(e,t),r.setState({isRenderAriaLiveMessage:!0}),r.props.adjustDateOnChange&&(r.props.onSelect(t),null===(s=(i=r.props).setOpen)||void 0===s||s.call(i,!0)),r.props.setPreSelection&&r.props.setPreSelection(t)},r.getEnabledPreSelectionDateForMonth=function(t){if(!rY(t,r.props))return t;for(var e=VW(t),n=wG(XW(t),e),i=null,s=0;s<=n;s++){var a=WH(e,s);if(!rY(a,r.props)){i=a;break}}return i},r.handleMonthChange=function(t){var e,n,i,s=null!==(e=r.getEnabledPreSelectionDateForMonth(t))&&void 0!==e?e:t;r.handleCustomMonthChange(s),r.props.adjustDateOnChange&&(r.props.onSelect(s),null===(i=(n=r.props).setOpen)||void 0===i||i.call(n,!0)),r.props.setPreSelection&&r.props.setPreSelection(s)},r.handleCustomMonthChange=function(t){var e,n;null===(n=(e=r.props).onMonthChange)||void 0===n||n.call(e,t),r.setState({isRenderAriaLiveMessage:!0})},r.handleMonthYearChange=function(t){r.handleYearChange(t),r.handleMonthChange(t)},r.changeYear=function(t){r.setState(function(e){return{date:EG(e.date,Number(t))}},function(){return r.handleYearChange(r.state.date)})},r.changeMonth=function(t){r.setState(function(e){return{date:XV(e.date,Number(t))}},function(){return r.handleMonthChange(r.state.date)})},r.changeMonthYear=function(t){r.setState(function(e){return{date:EG(XV(e.date,QV(t)),qV(t))}},function(){return r.handleMonthYearChange(r.state.date)})},r.header=function(t){if(void 0===t&&(t=r.state.date),!NW(t))return[];var e=r.props.disabled,n=HW(t,r.props.locale,r.props.calendarStartDay),s=[];return r.props.showWeekNumbers&&s.push(i.createElement("div",{key:"W",className:"react-datepicker__day-name ".concat(e?"react-datepicker__day-name--disabled":""),role:"columnheader"},i.createElement("span",{className:"react-datepicker__sr-only"},"Week number"),i.createElement("span",{"aria-hidden":"true"},r.props.weekLabel||"#"))),s.concat([0,1,2,3,4,5,6].map(function(t){var s=WH(n,t),a=r.formatWeekday(s,r.props.locale),o=r.props.weekDayClassName?r.props.weekDayClassName(s):void 0;return i.createElement("div",{key:t,role:"columnheader",className:hz("react-datepicker__day-name",o,e?"react-datepicker__day-name--disabled":"")},i.createElement("span",{className:"react-datepicker__sr-only"},FW(s,"EEEE",r.props.locale)),i.createElement("span",{"aria-hidden":"true"},a))}))},r.formatWeekday=function(t,e){return r.props.formatWeekDay?function(t,e,n){return e(FW(t,"EEEE",n))}(t,r.props.formatWeekDay,e):r.props.useWeekdaysShort?function(t,e){return FW(t,"EEE",e)}(t,e):function(t,e){return FW(t,"EEEEEE",e)}(t,e)},r.decreaseYear=function(){r.setState(function(t){var n;return{date:cG(t.date,r.props.showYearPicker?null!==(n=r.props.yearItemNumber)&&void 0!==n?n:e.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.clearSelectingDate=function(){r.setState({selectingDate:void 0})},r.renderPreviousButton=function(){var t,n,s;if(!r.props.renderCustomHeader){var a,o=null!==(t=r.props.monthsShown)&&void 0!==t?t:e.defaultProps.monthsShown,l=r.props.showPreviousMonths?o-1:0,c=null!==(n=r.props.monthSelectedIn)&&void 0!==n?n:l,u=iG(r.state.date,c);switch(!0){case r.props.disabled:a=!0;break;case r.props.showMonthYearPicker:a=_Y(r.state.date,r.props);break;case r.props.showYearPicker:a=function(t,e){var n=void 0===e?{}:e,i=n.minDate,r=n.yearItemNumber,s=void 0===r?12:r,a=AY(GW(cG(t,s)),s).endPeriod,o=i&&qV(i);return o&&o>a||!1}(r.state.date,r.props);break;case r.props.showQuarterYearPicker:a=function(t,e){var n=void 0===e?{}:e,i=n.minDate,r=n.includeDates,s=aG(hV(t),1);return i&&oG(i,s)>0||r&&r.every(function(t){return oG(t,s)>0})||!1}(r.state.date,r.props);break;default:a=vY(u,r.props)}if(((null!==(s=r.props.forceShowMonthNavigation)&&void 0!==s?s:e.defaultProps.forceShowMonthNavigation)||r.props.showDisabledMonthNavigation||!a)&&!r.props.showTimeSelectOnly){var h=["react-datepicker__navigation","react-datepicker__navigation--previous"],d=r.decreaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(d=r.decreaseYear),a&&r.props.showDisabledMonthNavigation&&(h.push("react-datepicker__navigation--previous--disabled"),d=void 0);var f=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,p=r.props,m=p.previousMonthButtonLabel,g=void 0===m?e.defaultProps.previousMonthButtonLabel:m,v=p.previousYearButtonLabel,y=void 0===v?e.defaultProps.previousYearButtonLabel:v,_=r.props,b=_.previousMonthAriaLabel,x=void 0===b?"string"===typeof g?g:"Previous Month":b,E=_.previousYearAriaLabel,w=void 0===E?"string"===typeof y?y:"Previous Year":E;return i.createElement("button",{type:"button",className:h.join(" "),onClick:d,onKeyDown:r.props.handleOnKeyDown,"aria-label":f?w:x},i.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"].join(" ")},f?y:g))}}},r.increaseYear=function(){r.setState(function(t){var n;return{date:lG(t.date,r.props.showYearPicker?null!==(n=r.props.yearItemNumber)&&void 0!==n?n:e.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.renderNextButton=function(){var t;if(!r.props.renderCustomHeader){var n;switch(!0){case r.props.disabled:n=!0;break;case r.props.showMonthYearPicker:n=bY(r.state.date,r.props);break;case r.props.showYearPicker:n=function(t,e){var n=void 0===e?{}:e,i=n.maxDate,r=n.yearItemNumber,s=void 0===r?12:r,a=AY(lG(t,s),s).startPeriod,o=i&&qV(i);return o&&o<a||!1}(r.state.date,r.props);break;case r.props.showQuarterYearPicker:n=function(t,e){var n=void 0===e?{}:e,i=n.maxDate,r=n.includeDates,s=sG(ZV(t),1);return i&&oG(s,i)>0||r&&r.every(function(t){return oG(s,t)>0})||!1}(r.state.date,r.props);break;default:n=yY(r.state.date,r.props)}if(((null!==(t=r.props.forceShowMonthNavigation)&&void 0!==t?t:e.defaultProps.forceShowMonthNavigation)||r.props.showDisabledMonthNavigation||!n)&&!r.props.showTimeSelectOnly){var s=["react-datepicker__navigation","react-datepicker__navigation--next"];r.props.showTimeSelect&&s.push("react-datepicker__navigation--next--with-time"),r.props.todayButton&&s.push("react-datepicker__navigation--next--with-today-button");var a=r.increaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(a=r.increaseYear),n&&r.props.showDisabledMonthNavigation&&(s.push("react-datepicker__navigation--next--disabled"),a=void 0);var o=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,l=r.props,c=l.nextMonthButtonLabel,u=void 0===c?e.defaultProps.nextMonthButtonLabel:c,h=l.nextYearButtonLabel,d=void 0===h?e.defaultProps.nextYearButtonLabel:h,f=r.props,p=f.nextMonthAriaLabel,m=void 0===p?"string"===typeof u?u:"Next Month":p,g=f.nextYearAriaLabel,v=void 0===g?"string"===typeof d?d:"Next Year":g;return i.createElement("button",{type:"button",className:s.join(" "),onClick:a,onKeyDown:r.props.handleOnKeyDown,"aria-label":o?v:m},i.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"].join(" ")},o?d:u))}}},r.renderCurrentMonth=function(t){void 0===t&&(t=r.state.date);var e=["react-datepicker__current-month"];return r.props.showYearDropdown&&e.push("react-datepicker__current-month--hasYearDropdown"),r.props.showMonthDropdown&&e.push("react-datepicker__current-month--hasMonthDropdown"),r.props.showMonthYearDropdown&&e.push("react-datepicker__current-month--hasMonthYearDropdown"),i.createElement("h2",{className:e.join(" ")},NW(t)?FW(t,r.props.dateFormat,r.props.locale):"")},r.renderYearDropdown=function(t){if(void 0===t&&(t=!1),r.props.showYearDropdown&&!t)return i.createElement(JY,CW({},e.defaultProps,r.props,{date:r.state.date,onChange:r.changeYear,year:qV(r.state.date)}))},r.renderMonthDropdown=function(t){if(void 0===t&&(t=!1),r.props.showMonthDropdown&&!t)return i.createElement(jY,CW({},e.defaultProps,r.props,{month:QV(r.state.date),onChange:r.changeMonth}))},r.renderMonthYearDropdown=function(t){if(void 0===t&&(t=!1),r.props.showMonthYearDropdown&&!t)return i.createElement(XY,CW({},e.defaultProps,r.props,{date:r.state.date,onChange:r.changeMonthYear}))},r.handleTodayButtonClick=function(t){r.props.onSelect(WW(),t),r.props.setPreSelection&&r.props.setPreSelection(WW())},r.renderTodayButton=function(){if(r.props.todayButton&&!r.props.showTimeSelectOnly)return i.createElement("div",{className:"react-datepicker__today-button",onClick:r.handleTodayButtonClick},r.props.todayButton)},r.renderDayNamesHeader=function(t){return i.createElement("div",{className:"react-datepicker__day-names",role:"row"},r.header(t))},r.renderDefaultHeader=function(t){var e=t.monthDate,n=t.i;return i.createElement("div",{className:"react-datepicker__header ".concat(r.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},r.renderCurrentMonth(e),i.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(r.props.dropdownMode),onFocus:r.handleDropdownFocus},r.renderMonthDropdown(0!==n),r.renderMonthYearDropdown(0!==n),r.renderYearDropdown(0!==n)))},r.renderCustomHeader=function(t){var e,n,s=t.monthDate,a=t.i;if(r.props.showTimeSelect&&!r.state.monthContainer||r.props.showTimeSelectOnly)return null;var o,l=r.props,c=l.showYearPicker,u=l.yearItemNumber;if(c){var h=AY(s,u);o={startYear:h.startPeriod,endYear:h.endPeriod}}var d=vY(r.state.date,r.props),f=yY(r.state.date,r.props),p=_Y(r.state.date,r.props),m=bY(r.state.date,r.props);return i.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:r.props.onDropdownFocus},null===(n=(e=r.props).renderCustomHeader)||void 0===n?void 0:n.call(e,CW(CW(CW({},r.state),c&&{visibleYearsRange:o}),{customHeaderCount:a,monthDate:s,changeMonth:r.changeMonth,changeYear:r.changeYear,decreaseMonth:r.decreaseMonth,increaseMonth:r.increaseMonth,decreaseYear:r.decreaseYear,increaseYear:r.increaseYear,prevMonthButtonDisabled:d,nextMonthButtonDisabled:f,prevYearButtonDisabled:p,nextYearButtonDisabled:m})))},r.renderYearHeader=function(t){var n=t.monthDate,s=r.props,a=s.showYearPicker,o=s.yearItemNumber,l=AY(n,void 0===o?e.defaultProps.yearItemNumber:o),c=l.startPeriod,u=l.endPeriod;return i.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},a?"".concat(c," - ").concat(u):qV(n))},r.renderHeader=function(t){var e=t.monthDate,n=t.i,i={monthDate:e,i:void 0===n?0:n};switch(!0){case void 0!==r.props.renderCustomHeader:return r.renderCustomHeader(i);case r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker:return r.renderYearHeader(i);default:return r.renderDefaultHeader(i)}},r.renderMonths=function(){var t,n;if(!r.props.showTimeSelectOnly&&!r.props.showYearPicker){for(var s=[],a=null!==(t=r.props.monthsShown)&&void 0!==t?t:e.defaultProps.monthsShown,o=r.props.showPreviousMonths?a-1:0,l=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?lG(r.state.date,o):iG(r.state.date,o),c=null!==(n=r.props.monthSelectedIn)&&void 0!==n?n:o,u=0;u<a;++u){var h=u-c+o,d=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?lG(l,h):nG(l,h),f="month-".concat(u),p=u<a-1,m=u>0;s.push(i.createElement("div",{key:f,ref:function(t){r.monthContainer=null!==t&&void 0!==t?t:void 0},className:"react-datepicker__month-container"},r.renderHeader({monthDate:d,i:u}),i.createElement(VY,CW({},e.defaultProps,r.props,{containerRef:r.containerRef,ariaLabelPrefix:r.props.monthAriaLabelPrefix,day:d,onDayClick:r.handleDayClick,handleOnKeyDown:r.props.handleOnDayKeyDown,handleOnMonthKeyDown:r.props.handleOnKeyDown,onDayMouseEnter:r.handleDayMouseEnter,onMouseLeave:r.handleMonthMouseLeave,orderInDisplay:u,selectingDate:r.state.selectingDate,monthShowsDuplicateDaysEnd:p,monthShowsDuplicateDaysStart:m,dayNamesHeader:r.renderDayNamesHeader(d)}))))}return s}},r.renderYears=function(){if(!r.props.showTimeSelectOnly)return r.props.showYearPicker?i.createElement("div",{className:"react-datepicker__year--container"},r.renderHeader({monthDate:r.state.date}),i.createElement(qY,CW({},e.defaultProps,r.props,{selectingDate:r.state.selectingDate,date:r.state.date,onDayClick:r.handleDayClick,clearSelectingDate:r.clearSelectingDate,onYearMouseEnter:r.handleYearMouseEnter,onYearMouseLeave:r.handleYearMouseLeave}))):void 0},r.renderTimeSection=function(){if(r.props.showTimeSelect&&(r.state.monthContainer||r.props.showTimeSelectOnly))return i.createElement(KY,CW({},e.defaultProps,r.props,{onChange:r.props.onTimeChange,format:r.props.timeFormat,intervals:r.props.timeIntervals,monthRef:r.state.monthContainer}))},r.renderInputTimeSection=function(){var t=r.props.selected?new Date(r.props.selected):void 0,n=t&&NW(t)&&Boolean(r.props.selected)?"".concat(MY(t.getHours()),":").concat(MY(t.getMinutes())):"";if(r.props.showTimeInput)return i.createElement(PY,CW({},e.defaultProps,r.props,{date:t,timeString:n,onChange:r.props.onTimeChange}))},r.renderAriaLiveRegion=function(){var t;if(!NW(r.state.date))return i.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"});var n,s=AY(r.state.date,null!==(t=r.props.yearItemNumber)&&void 0!==t?t:e.defaultProps.yearItemNumber),a=s.startPeriod,o=s.endPeriod;return n=r.props.showYearPicker?"".concat(a," - ").concat(o):r.props.showMonthYearPicker||r.props.showQuarterYearPicker?qV(r.state.date):"".concat(nY(QV(r.state.date),r.props.locale)," ").concat(qV(r.state.date)),i.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},r.state.isRenderAriaLiveMessage&&n)},r.renderChildren=function(){if(r.props.children)return i.createElement("div",{className:"react-datepicker__children-container"},r.props.children)},r.containerRef=(0,i.createRef)(),r.state={date:r.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},r}return AW(e,t),Object.defineProperty(e,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,outsideClickIgnoreClass:tX,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:12}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){var t=this;this.props.showTimeSelect&&(this.assignMonthContainer=void t.setState({monthContainer:t.monthContainer}))},e.prototype.componentDidUpdate=function(t){var e=this;if(!this.props.preSelection||!NW(this.props.preSelection)||ZW(this.props.preSelection,t.preSelection)&&this.props.monthSelectedIn===t.monthSelectedIn)this.props.openToDate&&!ZW(this.props.openToDate,t.openToDate)&&this.setState({date:this.props.openToDate});else{var n=!qW(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return n&&e.handleCustomMonthChange(e.state.date)})}},e.prototype.render=function(){var t=this.props.container||LW;return i.createElement(DW,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},i.createElement("div",{style:{display:"contents"},ref:this.containerRef},i.createElement(t,{className:hz("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly,inline:this.props.inline},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},e}(i.Component),nX=function(t){var e=t.icon,n=t.className,r=void 0===n?"":n,s=t.onClick,a="react-datepicker__calendar-icon";if("string"===typeof e)return i.createElement("i",{className:"".concat(a," ").concat(e," ").concat(r),"aria-hidden":"true",onClick:s});if(i.isValidElement(e)){var o=e;return i.cloneElement(o,{className:"".concat(o.props.className||""," ").concat(a," ").concat(r),onClick:function(t){"function"===typeof o.props.onClick&&o.props.onClick(t),"function"===typeof s&&s(t)}})}return i.createElement("svg",{className:"".concat(a," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:s},i.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},iX=function(t){function e(e){var n=t.call(this,e)||this;return n.portalRoot=null,n.el=document.createElement("div"),n}return AW(e,t),e.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},e.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},e.prototype.render=function(){return nj.createPortal(this.props.children,this.el)},e}(i.Component),rX=function(t){return(t instanceof HTMLAnchorElement||!t.disabled)&&-1!==t.tabIndex},sX=function(t){function e(e){var n=t.call(this,e)||this;return n.getTabChildren=function(){var t;return Array.prototype.slice.call(null===(t=n.tabLoopRef.current)||void 0===t?void 0:t.querySelectorAll("[tabindex], a, button, input, select, textarea"),1,-1).filter(rX)},n.handleFocusStart=function(){var t=n.getTabChildren();t&&t.length>1&&t[t.length-1].focus()},n.handleFocusEnd=function(){var t=n.getTabChildren();t&&t.length>1&&t[0].focus()},n.tabLoopRef=(0,i.createRef)(),n}return AW(e,t),e.prototype.render=function(){var t;return(null!==(t=this.props.enableTabLoop)&&void 0!==t?t:e.defaultProps.enableTabLoop)?i.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},i.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,i.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},e.defaultProps={enableTabLoop:!0},e}(i.Component);var aX=function(t){function e(e){var n,r,s,a="boolean"!==typeof e.hidePopper||e.hidePopper,o=(0,i.useRef)(null),l=TW(CW({open:!a,whileElementsMounted:Xj,placement:e.popperPlacement,middleware:RW([(r={padding:15},Rr(Rr({},qj(r)),{},{options:[r,s]})),iW(10),rW({element:o})],null!==(n=e.popperModifiers)&&void 0!==n?n:[],!0)},e.popperProps)),c=CW(CW({},e),{hidePopper:a,popperProps:CW(CW({},l),{arrowRef:o})});return i.createElement(t,CW({},c))}return e.displayName="withFloating(".concat(t.displayName||t.name||"Component",")"),e}(function(t){var e=t.className,n=t.wrapperClassName,r=t.hidePopper,s=void 0===r||r,a=t.popperComponent,o=t.targetComponent,l=t.enableTabLoop,c=t.popperOnKeyDown,u=t.portalId,h=t.portalHost,d=t.popperProps,f=t.showArrow,p=void 0;if(!s){var m=hz("react-datepicker-popper",e);p=i.createElement(sX,{enableTabLoop:l},i.createElement("div",{ref:d.refs.setFloating,style:d.floatingStyles,className:m,"data-placement":d.placement,onKeyDown:c},a,f&&i.createElement(yW,{ref:d.arrowRef,context:d.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}t.popperContainer&&(p=(0,i.createElement)(t.popperContainer,{},p)),u&&!s&&(p=i.createElement(iX,{portalId:u,portalHost:h},p));var g=hz("react-datepicker-wrapper",n);return i.createElement(i.Fragment,null,i.createElement("div",{ref:d.refs.setReference,className:g},o),p)});var oX="Date input not valid.",lX=function(t){function e(n){var r=t.call(this,n)||this;return r.calendar=null,r.input=null,r.getPreSelection=function(){return r.props.openToDate?r.props.openToDate:r.props.selectsEnd&&r.props.startDate?r.props.startDate:r.props.selectsStart&&r.props.endDate?r.props.endDate:IW()},r.modifyHolidays=function(){var t;return null===(t=r.props.holidays)||void 0===t?void 0:t.reduce(function(t,e){var n=new Date(e.date);return NW(n)?RW(RW([],t,!0),[CW(CW({},e),{date:n})],!1):t},[])},r.calcInitialState=function(){var t,e=r.getPreSelection(),n=xY(r.props),i=EY(r.props),s=n&&oV(e,zW(n))?n:i&&vG(e,YW(i))?i:e;return{open:r.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:null!==(t=r.props.selectsRange?r.props.startDate:r.props.selected)&&void 0!==t?t:s,highlightDates:wY(r.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},r.getInputValue=function(){var t,n=r.props,i=n.locale,s=n.startDate,a=n.endDate,o=n.rangeSeparator,l=n.selected,c=n.selectedDates,u=n.selectsMultiple,h=n.selectsRange,d=n.value,f=null!==(t=r.props.dateFormat)&&void 0!==t?t:e.defaultProps.dateFormat,p=r.state.inputValue;return"string"===typeof d?d:"string"===typeof p?p:h?function(t,e,n){if(!t&&!e)return"";var i=t?UW(t,n):"",r=e?UW(e,n):"",s=n.rangeSeparator||" - ";return"".concat(i).concat(s).concat(r)}(s,a,{dateFormat:f,locale:i,rangeSeparator:o}):u?function(t,e){if(!(null===t||void 0===t?void 0:t.length))return"";var n=t[0]?UW(t[0],e):"";if(1===t.length)return n;if(2===t.length&&t[1]){var i=UW(t[1],e);return"".concat(n,", ").concat(i)}var r=t.length-1;return"".concat(n," (+").concat(r,")")}(null!==c&&void 0!==c?c:[],{dateFormat:f,locale:i}):UW(l,{dateFormat:f,locale:i})},r.resetHiddenStatus=function(){r.setState(CW(CW({},r.state),{wasHidden:!1}))},r.setHiddenStatus=function(){r.setState(CW(CW({},r.state),{wasHidden:!0}))},r.setHiddenStateOnVisibilityHidden=function(){"hidden"===document.visibilityState&&r.setHiddenStatus()},r.clearPreventFocusTimeout=function(){r.preventFocusTimeout&&clearTimeout(r.preventFocusTimeout)},r.setFocus=function(){var t,e;null===(e=null===(t=r.input)||void 0===t?void 0:t.focus)||void 0===e||e.call(t,{preventScroll:!0})},r.setBlur=function(){var t,e;null===(e=null===(t=r.input)||void 0===t?void 0:t.blur)||void 0===e||e.call(t),r.cancelFocusInput()},r.deferBlur=function(){requestAnimationFrame(function(){r.setBlur()})},r.setOpen=function(t,e){void 0===e&&(e=!1),r.setState({open:t,preSelection:t&&r.state.open?r.state.preSelection:r.calcInitialState().preSelection,lastPreSelectChange:uX},function(){t||r.setState(function(t){return{focused:!!e&&t.focused}},function(){!e&&r.deferBlur(),r.setState({inputValue:null})})})},r.inputOk=function(){return sV(r.state.preSelection)},r.isCalendarOpen=function(){return void 0===r.props.open?r.state.open&&!r.props.disabled&&!r.props.readOnly:r.props.open},r.handleFocus=function(t){var e,n,i=r.state.wasHidden,s=!i||r.state.open;i&&r.resetHiddenStatus(),r.state.preventFocus||(null===(n=(e=r.props).onFocus)||void 0===n||n.call(e,t),!s||r.props.preventOpenOnFocus||r.props.readOnly||r.setOpen(!0)),r.setState({focused:!0})},r.sendFocusBackToInput=function(){r.preventFocusTimeout&&r.clearPreventFocusTimeout(),r.setState({preventFocus:!0},function(){r.preventFocusTimeout=setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})})},r.cancelFocusInput=function(){clearTimeout(r.inputFocusTimeout),r.inputFocusTimeout=void 0},r.deferFocusInput=function(){r.cancelFocusInput(),r.inputFocusTimeout=setTimeout(function(){return r.setFocus()},1)},r.handleDropdownFocus=function(){r.cancelFocusInput()},r.resetInputValue=function(){r.setState(CW(CW({},r.state),{inputValue:null}))},r.handleBlur=function(t){var e,n;(!r.state.open||r.props.withPortal||r.props.showTimeInput)&&(null===(n=(e=r.props).onBlur)||void 0===n||n.call(e,t)),r.resetInputValue(),r.state.open&&!1===r.props.open&&r.setOpen(!1),r.setState({focused:!1})},r.handleCalendarClickOutside=function(t){var e,n;r.props.inline||r.setOpen(!1),null===(n=(e=r.props).onClickOutside)||void 0===n||n.call(e,t),r.props.withPortal&&t.preventDefault()},r.handleChange=function(){for(var t,n,i,s,a,o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];var c=o[0];if(!r.props.onChangeRaw||(r.props.onChangeRaw.apply(r,o),c&&"function"===typeof c.isDefaultPrevented&&!c.isDefaultPrevented())){r.setState({inputValue:(null===c||void 0===c?void 0:c.target)instanceof HTMLInputElement?c.target.value:null,lastPreSelectChange:cX});var u=r.props,h=u.selectsRange,d=u.startDate,f=u.endDate,p=null!==(t=r.props.dateFormat)&&void 0!==t?t:e.defaultProps.dateFormat,m=null!==(n=r.props.strictParsing)&&void 0!==n?n:e.defaultProps.strictParsing,g=(null===c||void 0===c?void 0:c.target)instanceof HTMLInputElement?c.target.value:"";if(h){var v=r.props.rangeSeparator,y=v.trim(),_=g.split(p.includes(y)?v:y,2).map(function(t){return t.trim()}),b=_[0],x=_[1],E=OW(null!==b&&void 0!==b?b:"",p,r.props.locale,m),w=E?OW(null!==x&&void 0!==x?x:"",p,r.props.locale,m):null,S=(null===d||void 0===d?void 0:d.getTime())!==(null===E||void 0===E?void 0:E.getTime()),T=(null===f||void 0===f?void 0:f.getTime())!==(null===w||void 0===w?void 0:w.getTime());if(!S&&!T)return;if(E&&rY(E,r.props))return;if(w&&rY(w,r.props))return;null===(s=(i=r.props).onChange)||void 0===s||s.call(i,[E,w],c)}else{var M=OW(g,p,r.props.locale,m,null!==(a=r.props.selected)&&void 0!==a?a:void 0);!M&&g||r.setSelected(M,c,!0)}}},r.handleSelect=function(t,n,i){var s;if(!r.props.readOnly){var a=r.props,o=a.selectsRange,l=a.startDate,c=a.endDate,u=a.locale,h=a.swapRange,d=null!==(s=r.props.dateFormat)&&void 0!==s?s:e.defaultProps.dateFormat,f=!o||l&&!c&&(h||!kY(t,l));if(r.props.shouldCloseOnSelect&&!r.props.showTimeSelect&&f&&r.sendFocusBackToInput(),r.props.onChangeRaw){var p=UW(t,{dateFormat:d,locale:u});r.props.onChangeRaw(n,{date:t,formattedDate:p})}r.setSelected(t,n,!1,i),r.props.showDateSelect&&r.setState({isRenderAriaLiveMessage:!0}),!r.props.shouldCloseOnSelect||r.props.showTimeSelect?r.setPreSelection(t):f&&r.setOpen(!1)}},r.setSelected=function(t,e,n,i){var s,a,o=t;if(r.props.showYearPicker){if(null!==o&&hY(qV(o),r.props))return}else if(r.props.showMonthYearPicker){if(null!==o&&aY(o,r.props))return}else if(null!==o&&rY(o,r.props))return;var l=r.props,c=l.onChange,u=l.selectsRange,h=l.startDate,d=l.endDate,f=l.selectsMultiple,p=l.selectedDates,m=l.minTime,g=l.swapRange;if(!JW(r.props.selected,o)||r.props.allowSameDay||u||f)if(null!==o&&(!r.props.selected||n&&(r.props.showTimeSelect||r.props.showTimeSelectOnly||r.props.showTimeInput)||(o=BW(o,{hour:$V(r.props.selected),minute:tG(r.props.selected),second:eG(r.props.selected)})),n||!r.props.showTimeSelect&&!r.props.showTimeSelectOnly||m&&(o=BW(o,{hour:m.getHours(),minute:m.getMinutes(),second:m.getSeconds()})),r.props.inline||r.setState({preSelection:o}),r.props.focusSelectedMonth||r.setState({monthSelectedIn:i})),u){var v=h&&!d,y=!h&&!!d,_=h&&d;!h&&!d?null===c||void 0===c||c([o,null],e):v?null===o?null===c||void 0===c||c([null,null],e):kY(o,h)?g?null===c||void 0===c||c([o,h],e):null===c||void 0===c||c([o,null],e):null===c||void 0===c||c([h,o],e):y&&(o&&kY(o,d)?null===c||void 0===c||c([o,d],e):null===c||void 0===c||c([o,null],e)),_&&(null===c||void 0===c||c([o,null],e))}else if(f){if(null!==o)if(null===p||void 0===p?void 0:p.length)if(p.some(function(t){return ZW(t,o)})){var b=p.filter(function(t){return!ZW(t,o)});null===c||void 0===c||c(b,e)}else null===c||void 0===c||c(RW(RW([],p,!0),[o],!1),e);else null===c||void 0===c||c([o],e)}else null===c||void 0===c||c(o,e);n||(null===(a=(s=r.props).onSelect)||void 0===a||a.call(s,o,e),r.setState({inputValue:null}))},r.setPreSelection=function(t){if(!r.props.readOnly){var e=sV(r.props.minDate),n=sV(r.props.maxDate),i=!0;if(t){var s=zW(t);if(e&&n)i=$W(t,r.props.minDate,r.props.maxDate);else if(e){var a=zW(r.props.minDate);i=vG(t,a)||JW(s,a)}else if(n){var o=YW(r.props.maxDate);i=oV(t,o)||JW(s,o)}}i&&r.setState({preSelection:t})}},r.toggleCalendar=function(){r.setOpen(!r.state.open)},r.handleTimeChange=function(t){var e,n;if(!r.props.selectsRange&&!r.props.selectsMultiple){var i=r.props.selected?r.props.selected:r.getPreSelection(),s=r.props.selected?t:BW(i,{hour:$V(t),minute:tG(t)});r.setState({preSelection:s}),null===(n=(e=r.props).onChange)||void 0===n||n.call(e,s),r.props.shouldCloseOnSelect&&!r.props.showTimeInput&&(r.sendFocusBackToInput(),r.setOpen(!1)),r.props.showTimeInput&&r.setOpen(!0),(r.props.showTimeSelectOnly||r.props.showTimeSelect)&&r.setState({isRenderAriaLiveMessage:!0}),r.setState({inputValue:null})}},r.onInputClick=function(){var t,e;r.props.disabled||r.props.readOnly||r.setOpen(!0),null===(e=(t=r.props).onInputClick)||void 0===e||e.call(t)},r.onInputKeyDown=function(t){var e,n,i,s,a,o;null===(n=(e=r.props).onKeyDown)||void 0===n||n.call(e,t);var l=t.key;if(r.state.open||r.props.inline||r.props.preventOpenOnFocus){if(r.state.open){if(l===kW.ArrowDown||l===kW.ArrowUp){t.preventDefault();var c=r.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":r.props.showWeekPicker&&r.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':r.props.showFullMonthYearPicker||r.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',u=(null===(s=r.calendar)||void 0===s?void 0:s.containerRef.current)instanceof Element&&r.calendar.containerRef.current.querySelector(c);return void(u instanceof HTMLElement&&u.focus({preventScroll:!0}))}var h=IW(r.state.preSelection);l===kW.Enter?(t.preventDefault(),t.target.blur(),r.inputOk()&&r.state.lastPreSelectChange===uX?(r.handleSelect(h,t),!r.props.shouldCloseOnSelect&&r.setPreSelection(h)):r.setOpen(!1)):l===kW.Escape?(t.preventDefault(),t.target.blur(),r.sendFocusBackToInput(),r.setOpen(!1)):l===kW.Tab&&r.setOpen(!1),r.inputOk()||null===(o=(a=r.props).onInputError)||void 0===o||o.call(a,{code:1,msg:oX})}}else l!==kW.ArrowDown&&l!==kW.ArrowUp&&l!==kW.Enter||null===(i=r.onInputClick)||void 0===i||i.call(r)},r.onPortalKeyDown=function(t){t.key===kW.Escape&&(t.preventDefault(),r.setState({preventFocus:!0},function(){r.setOpen(!1),setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})}))},r.onDayKeyDown=function(t){var e,n,i,s,a,o,l=r.props,c=l.minDate,u=l.maxDate,h=l.disabledKeyboardNavigation,d=l.showWeekPicker,f=l.shouldCloseOnSelect,p=l.locale,m=l.calendarStartDay,g=l.adjustDateOnChange,v=l.inline;if(null===(n=(e=r.props).onKeyDown)||void 0===n||n.call(e,t),!h){var y=t.key,_=t.shiftKey,b=IW(r.state.preSelection),x=function(t,e){var n=e;switch(t){case kW.ArrowRight:n=d?bG(e,1):WH(e,1);break;case kW.ArrowLeft:n=d?TG(e,1):MG(e,1);break;case kW.ArrowUp:n=TG(e,1);break;case kW.ArrowDown:n=bG(e,1);break;case kW.PageUp:n=_?cG(e,1):iG(e,1);break;case kW.PageDown:n=_?lG(e,1):nG(e,1);break;case kW.Home:n=HW(e,p,m);break;case kW.End:n=function(t){return UV(t)}(e)}return n};if(y===kW.Enter)return t.preventDefault(),r.handleSelect(b,t),void(!f&&r.setPreSelection(b));if(y===kW.Escape)return t.preventDefault(),r.setOpen(!1),void(r.inputOk()||null===(s=(i=r.props).onInputError)||void 0===s||s.call(i,{code:1,msg:oX}));var E=null;switch(y){case kW.ArrowLeft:case kW.ArrowRight:case kW.ArrowUp:case kW.ArrowDown:case kW.PageUp:case kW.PageDown:case kW.Home:case kW.End:E=function(t,e){for(var n=t,i=!1,s=0,a=x(t,e);!i;){if(s>=40){a=e;break}c&&a<c&&(n=kW.ArrowRight,a=rY(c,r.props)?x(n,a):c),u&&a>u&&(n=kW.ArrowLeft,a=rY(u,r.props)?x(n,a):u),rY(a,r.props)?(n!==kW.PageUp&&n!==kW.Home||(n=kW.ArrowRight),n!==kW.PageDown&&n!==kW.End||(n=kW.ArrowLeft),a=x(n,a)):i=!0,s++}return a}(y,b)}if(E){if(t.preventDefault(),r.setState({lastPreSelectChange:uX}),g&&r.setSelected(E),r.setPreSelection(E),v){var w=QV(b),S=QV(E),T=qV(b),M=qV(E);w!==S||T!==M?r.setState({shouldFocusDayInline:!0}):r.setState({shouldFocusDayInline:!1})}}else null===(o=(a=r.props).onInputError)||void 0===o||o.call(a,{code:1,msg:oX})}},r.onPopperKeyDown=function(t){t.key===kW.Escape&&(t.preventDefault(),r.sendFocusBackToInput(),r.setOpen(!1))},r.onClearClick=function(t){t&&t.preventDefault&&t.preventDefault(),r.sendFocusBackToInput();var e=r.props,n=e.selectsRange,i=e.onChange;n?null===i||void 0===i||i([null,null],t):null===i||void 0===i||i(null,t),r.setState({inputValue:null})},r.clear=function(){r.onClearClick()},r.onScroll=function(t){"boolean"===typeof r.props.closeOnScroll&&r.props.closeOnScroll?t.target!==document&&t.target!==document.documentElement&&t.target!==document.body||r.setOpen(!1):"function"===typeof r.props.closeOnScroll&&r.props.closeOnScroll(t)&&r.setOpen(!1)},r.renderCalendar=function(){var t,n;return r.props.inline||r.isCalendarOpen()?i.createElement(eX,CW({showMonthYearDropdown:void 0,ref:function(t){r.calendar=t}},r.props,r.state,{setOpen:r.setOpen,dateFormat:null!==(t=r.props.dateFormatCalendar)&&void 0!==t?t:e.defaultProps.dateFormatCalendar,onSelect:r.handleSelect,onClickOutside:r.handleCalendarClickOutside,holidays:SY(r.modifyHolidays()),outsideClickIgnoreClass:r.props.outsideClickIgnoreClass,onDropdownFocus:r.handleDropdownFocus,onTimeChange:r.handleTimeChange,className:r.props.calendarClassName,container:r.props.calendarContainer,handleOnKeyDown:r.props.onKeyDown,handleOnDayKeyDown:r.onDayKeyDown,setPreSelection:r.setPreSelection,dropdownMode:null!==(n=r.props.dropdownMode)&&void 0!==n?n:e.defaultProps.dropdownMode}),r.props.children):null},r.renderAriaLiveRegion=function(){var t,n,s=r.props.locale,a=null!==(t=r.props.dateFormat)&&void 0!==t?t:e.defaultProps.dateFormat,o=r.props.showTimeInput||r.props.showTimeSelect?"PPPPp":"PPPP";return n=r.props.selectsRange?"Selected start date: ".concat(UW(r.props.startDate,{dateFormat:o,locale:s}),". ").concat(r.props.endDate?"End date: "+UW(r.props.endDate,{dateFormat:o,locale:s}):""):r.props.showTimeSelectOnly?"Selected time: ".concat(UW(r.props.selected,{dateFormat:a,locale:s})):r.props.showYearPicker?"Selected year: ".concat(UW(r.props.selected,{dateFormat:"yyyy",locale:s})):r.props.showMonthYearPicker?"Selected month: ".concat(UW(r.props.selected,{dateFormat:"MMMM yyyy",locale:s})):r.props.showQuarterYearPicker?"Selected quarter: ".concat(UW(r.props.selected,{dateFormat:"yyyy, QQQ",locale:s})):"Selected date: ".concat(UW(r.props.selected,{dateFormat:o,locale:s})),i.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},n)},r.renderDateInput=function(){var t,n,s=hz(r.props.className,((t={})[r.props.outsideClickIgnoreClass||e.defaultProps.outsideClickIgnoreClass]=r.state.open,t)),a=r.props.customInput||i.createElement("input",{type:"text"}),o=r.props.customInputRef||"ref";return(0,i.cloneElement)(a,((n={})[o]=function(t){r.input=t},n.value=r.getInputValue(),n.onBlur=r.handleBlur,n.onChange=r.handleChange,n.onClick=r.onInputClick,n.onFocus=r.handleFocus,n.onKeyDown=r.onInputKeyDown,n.id=r.props.id,n.name=r.props.name,n.form=r.props.form,n.autoFocus=r.props.autoFocus,n.placeholder=r.props.placeholderText,n.disabled=r.props.disabled,n.autoComplete=r.props.autoComplete,n.className=hz(a.props.className,s),n.title=r.props.title,n.readOnly=r.props.readOnly,n.required=r.props.required,n.tabIndex=r.props.tabIndex,n["aria-describedby"]=r.props.ariaDescribedBy,n["aria-invalid"]=r.props.ariaInvalid,n["aria-labelledby"]=r.props.ariaLabelledBy,n["aria-required"]=r.props.ariaRequired,n))},r.renderClearButton=function(){var t=r.props,e=t.isClearable,n=t.disabled,s=t.selected,a=t.startDate,o=t.endDate,l=t.clearButtonTitle,c=t.clearButtonClassName,u=void 0===c?"":c,h=t.ariaLabelClose,d=void 0===h?"Close":h,f=t.selectedDates,p=t.readOnly;return!e||p||null==s&&null==a&&null==o&&!(null===f||void 0===f?void 0:f.length)?null:i.createElement("button",{type:"button",className:hz("react-datepicker__close-icon",u,{"react-datepicker__close-icon--disabled":n}),disabled:n,"aria-label":d,onClick:r.onClearClick,title:l,tabIndex:-1})},r.state=r.calcInitialState(),r.preventFocusTimeout=void 0,r}return AW(e,t),Object.defineProperty(e,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,outsideClickIgnoreClass:tX,readOnly:!1,rangeSeparator:" - ",withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:12,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},e.prototype.componentDidUpdate=function(t,e){var n,i,r,s,a,o;t.inline&&(a=t.selected,o=this.props.selected,a&&o?QV(a)!==QV(o)||qV(a)!==qV(o):a!==o)&&this.setPreSelection(this.props.selected),void 0!==this.state.monthSelectedIn&&t.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),t.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:wY(this.props.highlightDates)}),e.focused||JW(t.selected,this.props.selected)||this.setState({inputValue:null}),e.open!==this.state.open&&(!1===e.open&&!0===this.state.open&&(null===(i=(n=this.props).onCalendarOpen)||void 0===i||i.call(n)),!0===e.open&&!1===this.state.open&&(null===(s=(r=this.props).onCalendarClose)||void 0===s||s.call(r)))},e.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},e.prototype.renderInputContainer=function(){var t=this.props,e=t.showIcon,n=t.icon,r=t.calendarIconClassname,s=t.calendarIconClassName,a=t.toggleCalendarOnIconClick,o=this.state.open;return r&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),i.createElement("div",{className:"react-datepicker__input-container".concat(e?" react-datepicker__view-calendar-icon":"")},e&&i.createElement(nX,CW({icon:n,className:hz(s,!s&&r,o&&"react-datepicker-ignore-onclickoutside")},a?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},e.prototype.render=function(){var t=this.renderCalendar();if(this.props.inline)return t;if(this.props.withPortal){var e=this.state.open?i.createElement(sX,{enableTabLoop:this.props.enableTabLoop},i.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},t)):null;return this.state.open&&this.props.portalId&&(e=i.createElement(iX,CW({portalId:this.props.portalId},this.props),e)),i.createElement("div",null,this.renderInputContainer(),e)}return i.createElement(aX,CW({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:t,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},e}(i.Component),cX="input",uX="navigate";function hX(t,e){if(void 0!==t.one&&1===e)return t.one;var n=e%10,i=e%100;return 1===n&&11!==i?t.singularNominative.replace("{{count}}",String(e)):n>=2&&n<=4&&(i<10||i>20)?t.singularGenitive.replace("{{count}}",String(e)):t.pluralGenitive.replace("{{count}}",String(e))}function dX(t){return function(e,n){return null!==n&&void 0!==n&&n.addSuffix?n.comparison&&n.comparison>0?t.future?hX(t.future,e):"\u0447\u0435\u0440\u0435\u0437 "+hX(t.regular,e):t.past?hX(t.past,e):hX(t.regular,e)+" \u043d\u0430\u0437\u0430\u0434":hX(t.regular,e)}}var fX={lessThanXSeconds:dX({regular:{one:"\u043c\u0435\u043d\u044c\u0448\u0435 \u0441\u0435\u043a\u0443\u043d\u0434\u044b",singularNominative:"\u043c\u0435\u043d\u044c\u0448\u0435 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u044b",singularGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434",pluralGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434"},future:{one:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 \u0441\u0435\u043a\u0443\u043d\u0434\u0443",singularNominative:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u0443",singularGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u044b",pluralGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434"}}),xSeconds:dX({regular:{singularNominative:"{{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u0430",singularGenitive:"{{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u044b",pluralGenitive:"{{count}} \u0441\u0435\u043a\u0443\u043d\u0434"},past:{singularNominative:"{{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u0443 \u043d\u0430\u0437\u0430\u0434",singularGenitive:"{{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u044b \u043d\u0430\u0437\u0430\u0434",pluralGenitive:"{{count}} \u0441\u0435\u043a\u0443\u043d\u0434 \u043d\u0430\u0437\u0430\u0434"},future:{singularNominative:"\u0447\u0435\u0440\u0435\u0437 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u0443",singularGenitive:"\u0447\u0435\u0440\u0435\u0437 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434\u044b",pluralGenitive:"\u0447\u0435\u0440\u0435\u0437 {{count}} \u0441\u0435\u043a\u0443\u043d\u0434"}}),halfAMinute:function(t,e){return null!==e&&void 0!==e&&e.addSuffix?e.comparison&&e.comparison>0?"\u0447\u0435\u0440\u0435\u0437 \u043f\u043e\u043b\u043c\u0438\u043d\u0443\u0442\u044b":"\u043f\u043e\u043b\u043c\u0438\u043d\u0443\u0442\u044b \u043d\u0430\u0437\u0430\u0434":"\u043f\u043e\u043b\u043c\u0438\u043d\u0443\u0442\u044b"},lessThanXMinutes:dX({regular:{one:"\u043c\u0435\u043d\u044c\u0448\u0435 \u043c\u0438\u043d\u0443\u0442\u044b",singularNominative:"\u043c\u0435\u043d\u044c\u0448\u0435 {{count}} \u043c\u0438\u043d\u0443\u0442\u044b",singularGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435 {{count}} \u043c\u0438\u043d\u0443\u0442",pluralGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435 {{count}} \u043c\u0438\u043d\u0443\u0442"},future:{one:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 \u043c\u0438\u043d\u0443\u0442\u0443",singularNominative:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0438\u043d\u0443\u0442\u0443",singularGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0438\u043d\u0443\u0442\u044b",pluralGenitive:"\u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0438\u043d\u0443\u0442"}}),xMinutes:dX({regular:{singularNominative:"{{count}} \u043c\u0438\u043d\u0443\u0442\u0430",singularGenitive:"{{count}} \u043c\u0438\u043d\u0443\u0442\u044b",pluralGenitive:"{{count}} \u043c\u0438\u043d\u0443\u0442"},past:{singularNominative:"{{count}} \u043c\u0438\u043d\u0443\u0442\u0443 \u043d\u0430\u0437\u0430\u0434",singularGenitive:"{{count}} \u043c\u0438\u043d\u0443\u0442\u044b \u043d\u0430\u0437\u0430\u0434",pluralGenitive:"{{count}} \u043c\u0438\u043d\u0443\u0442 \u043d\u0430\u0437\u0430\u0434"},future:{singularNominative:"\u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0438\u043d\u0443\u0442\u0443",singularGenitive:"\u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0438\u043d\u0443\u0442\u044b",pluralGenitive:"\u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0438\u043d\u0443\u0442"}}),aboutXHours:dX({regular:{singularNominative:"\u043e\u043a\u043e\u043b\u043e {{count}} \u0447\u0430\u0441\u0430",singularGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u0447\u0430\u0441\u043e\u0432",pluralGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u0447\u0430\u0441\u043e\u0432"},future:{singularNominative:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u0447\u0430\u0441",singularGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u0447\u0430\u0441\u0430",pluralGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u0447\u0430\u0441\u043e\u0432"}}),xHours:dX({regular:{singularNominative:"{{count}} \u0447\u0430\u0441",singularGenitive:"{{count}} \u0447\u0430\u0441\u0430",pluralGenitive:"{{count}} \u0447\u0430\u0441\u043e\u0432"}}),xDays:dX({regular:{singularNominative:"{{count}} \u0434\u0435\u043d\u044c",singularGenitive:"{{count}} \u0434\u043d\u044f",pluralGenitive:"{{count}} \u0434\u043d\u0435\u0439"}}),aboutXWeeks:dX({regular:{singularNominative:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043d\u0435\u0434\u0435\u043b\u0438",singularGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043d\u0435\u0434\u0435\u043b\u044c",pluralGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043d\u0435\u0434\u0435\u043b\u044c"},future:{singularNominative:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u043d\u0435\u0434\u0435\u043b\u044e",singularGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u043d\u0435\u0434\u0435\u043b\u0438",pluralGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u043d\u0435\u0434\u0435\u043b\u044c"}}),xWeeks:dX({regular:{singularNominative:"{{count}} \u043d\u0435\u0434\u0435\u043b\u044f",singularGenitive:"{{count}} \u043d\u0435\u0434\u0435\u043b\u0438",pluralGenitive:"{{count}} \u043d\u0435\u0434\u0435\u043b\u044c"}}),aboutXMonths:dX({regular:{singularNominative:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043c\u0435\u0441\u044f\u0446\u0430",singularGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043c\u0435\u0441\u044f\u0446\u0435\u0432",pluralGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043c\u0435\u0441\u044f\u0446\u0435\u0432"},future:{singularNominative:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0435\u0441\u044f\u0446",singularGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0435\u0441\u044f\u0446\u0430",pluralGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u043c\u0435\u0441\u044f\u0446\u0435\u0432"}}),xMonths:dX({regular:{singularNominative:"{{count}} \u043c\u0435\u0441\u044f\u0446",singularGenitive:"{{count}} \u043c\u0435\u0441\u044f\u0446\u0430",pluralGenitive:"{{count}} \u043c\u0435\u0441\u044f\u0446\u0435\u0432"}}),aboutXYears:dX({regular:{singularNominative:"\u043e\u043a\u043e\u043b\u043e {{count}} \u0433\u043e\u0434\u0430",singularGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043b\u0435\u0442",pluralGenitive:"\u043e\u043a\u043e\u043b\u043e {{count}} \u043b\u0435\u0442"},future:{singularNominative:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u0433\u043e\u0434",singularGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u0433\u043e\u0434\u0430",pluralGenitive:"\u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0447\u0435\u0440\u0435\u0437 {{count}} \u043b\u0435\u0442"}}),xYears:dX({regular:{singularNominative:"{{count}} \u0433\u043e\u0434",singularGenitive:"{{count}} \u0433\u043e\u0434\u0430",pluralGenitive:"{{count}} \u043b\u0435\u0442"}}),overXYears:dX({regular:{singularNominative:"\u0431\u043e\u043b\u044c\u0448\u0435 {{count}} \u0433\u043e\u0434\u0430",singularGenitive:"\u0431\u043e\u043b\u044c\u0448\u0435 {{count}} \u043b\u0435\u0442",pluralGenitive:"\u0431\u043e\u043b\u044c\u0448\u0435 {{count}} \u043b\u0435\u0442"},future:{singularNominative:"\u0431\u043e\u043b\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u0433\u043e\u0434",singularGenitive:"\u0431\u043e\u043b\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u0433\u043e\u0434\u0430",pluralGenitive:"\u0431\u043e\u043b\u044c\u0448\u0435, \u0447\u0435\u043c \u0447\u0435\u0440\u0435\u0437 {{count}} \u043b\u0435\u0442"}}),almostXYears:dX({regular:{singularNominative:"\u043f\u043e\u0447\u0442\u0438 {{count}} \u0433\u043e\u0434",singularGenitive:"\u043f\u043e\u0447\u0442\u0438 {{count}} \u0433\u043e\u0434\u0430",pluralGenitive:"\u043f\u043e\u0447\u0442\u0438 {{count}} \u043b\u0435\u0442"},future:{singularNominative:"\u043f\u043e\u0447\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 {{count}} \u0433\u043e\u0434",singularGenitive:"\u043f\u043e\u0447\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 {{count}} \u0433\u043e\u0434\u0430",pluralGenitive:"\u043f\u043e\u0447\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 {{count}} \u043b\u0435\u0442"}})};const pX=function(t,e,n){return fX[t](e,n)};function mX(t){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const gX={date:mX({formats:{full:"EEEE, d MMMM y '\u0433.'",long:"d MMMM y '\u0433.'",medium:"d MMM y '\u0433.'",short:"dd.MM.y"},defaultWidth:"full"}),time:mX({formats:{full:"H:mm:ss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},defaultWidth:"full"}),dateTime:mX({formats:{any:"{{date}}, {{time}}"},defaultWidth:"any"})};function vX(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}var yX={};function _X(t,e){var n,i,r,s,a,o,l,c;vX(1,arguments);var u=yX,h=function(t){if(null===t||!0===t||!1===t)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}(null!==(n=null!==(i=null!==(r=null!==(s=null===e||void 0===e?void 0:e.weekStartsOn)&&void 0!==s?s:null===e||void 0===e||null===(a=e.locale)||void 0===a||null===(o=a.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==r?r:u.weekStartsOn)&&void 0!==i?i:null===(l=u.locale)||void 0===l||null===(c=l.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==n?n:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=function(t){vX(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||"object"===Tr(t)&&"[object Date]"===e?new Date(t.getTime()):"number"===typeof t||"[object Number]"===e?new Date(t):("string"!==typeof t&&"[object String]"!==e||"undefined"===typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}(t),f=d.getUTCDay(),p=(f<h?7:0)+f-h;return d.setUTCDate(d.getUTCDate()-p),d.setUTCHours(0,0,0,0),d}function bX(t,e,n){vX(2,arguments);var i=_X(t,n),r=_X(e,n);return i.getTime()===r.getTime()}var xX=["\u0432\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435","\u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0432\u0442\u043e\u0440\u043d\u0438\u043a","\u0441\u0440\u0435\u0434\u0443","\u0447\u0435\u0442\u0432\u0435\u0440\u0433","\u043f\u044f\u0442\u043d\u0438\u0446\u0443","\u0441\u0443\u0431\u0431\u043e\u0442\u0443"];function EX(t){var e=xX[t];return 2===t?"'\u0432\u043e "+e+" \u0432' p":"'\u0432 "+e+" \u0432' p"}var wX={lastWeek:function(t,e,n){var i=t.getUTCDay();return bX(t,e,n)?EX(i):function(t){var e=xX[t];switch(t){case 0:return"'\u0432 \u043f\u0440\u043e\u0448\u043b\u043e\u0435 "+e+" \u0432' p";case 1:case 2:case 4:return"'\u0432 \u043f\u0440\u043e\u0448\u043b\u044b\u0439 "+e+" \u0432' p";case 3:case 5:case 6:return"'\u0432 \u043f\u0440\u043e\u0448\u043b\u0443\u044e "+e+" \u0432' p"}}(i)},yesterday:"'\u0432\u0447\u0435\u0440\u0430 \u0432' p",today:"'\u0441\u0435\u0433\u043e\u0434\u043d\u044f \u0432' p",tomorrow:"'\u0437\u0430\u0432\u0442\u0440\u0430 \u0432' p",nextWeek:function(t,e,n){var i=t.getUTCDay();return bX(t,e,n)?EX(i):function(t){var e=xX[t];switch(t){case 0:return"'\u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0435 "+e+" \u0432' p";case 1:case 2:case 4:return"'\u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 "+e+" \u0432' p";case 3:case 5:case 6:return"'\u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0443\u044e "+e+" \u0432' p"}}(i)},other:"P"};const SX=function(t,e,n,i){var r=wX[t];return"function"===typeof r?r(e,n,i):r};function TX(t){return function(e,n){var i;if("formatting"===(null!==n&&void 0!==n&&n.context?String(n.context):"standalone")&&t.formattingValues){var r=t.defaultFormattingWidth||t.defaultWidth,s=null!==n&&void 0!==n&&n.width?String(n.width):r;i=t.formattingValues[s]||t.formattingValues[r]}else{var a=t.defaultWidth,o=null!==n&&void 0!==n&&n.width?String(n.width):t.defaultWidth;i=t.values[o]||t.values[a]}return i[t.argumentCallback?t.argumentCallback(e):e]}}const MX={ordinalNumber:function(t,e){var n=Number(t),i=null===e||void 0===e?void 0:e.unit;return n+("date"===i?"-\u0435":"week"===i||"minute"===i||"second"===i?"-\u044f":"-\u0439")},era:TX({values:{narrow:["\u0434\u043e \u043d.\u044d.","\u043d.\u044d."],abbreviated:["\u0434\u043e \u043d. \u044d.","\u043d. \u044d."],wide:["\u0434\u043e \u043d\u0430\u0448\u0435\u0439 \u044d\u0440\u044b","\u043d\u0430\u0448\u0435\u0439 \u044d\u0440\u044b"]},defaultWidth:"wide"}),quarter:TX({values:{narrow:["1","2","3","4"],abbreviated:["1-\u0439 \u043a\u0432.","2-\u0439 \u043a\u0432.","3-\u0439 \u043a\u0432.","4-\u0439 \u043a\u0432."],wide:["1-\u0439 \u043a\u0432\u0430\u0440\u0442\u0430\u043b","2-\u0439 \u043a\u0432\u0430\u0440\u0442\u0430\u043b","3-\u0439 \u043a\u0432\u0430\u0440\u0442\u0430\u043b","4-\u0439 \u043a\u0432\u0430\u0440\u0442\u0430\u043b"]},defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:TX({values:{narrow:["\u042f","\u0424","\u041c","\u0410","\u041c","\u0418","\u0418","\u0410","\u0421","\u041e","\u041d","\u0414"],abbreviated:["\u044f\u043d\u0432.","\u0444\u0435\u0432.","\u043c\u0430\u0440\u0442","\u0430\u043f\u0440.","\u043c\u0430\u0439","\u0438\u044e\u043d\u044c","\u0438\u044e\u043b\u044c","\u0430\u0432\u0433.","\u0441\u0435\u043d\u0442.","\u043e\u043a\u0442.","\u043d\u043e\u044f\u0431.","\u0434\u0435\u043a."],wide:["\u044f\u043d\u0432\u0430\u0440\u044c","\u0444\u0435\u0432\u0440\u0430\u043b\u044c","\u043c\u0430\u0440\u0442","\u0430\u043f\u0440\u0435\u043b\u044c","\u043c\u0430\u0439","\u0438\u044e\u043d\u044c","\u0438\u044e\u043b\u044c","\u0430\u0432\u0433\u0443\u0441\u0442","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044c","\u043e\u043a\u0442\u044f\u0431\u0440\u044c","\u043d\u043e\u044f\u0431\u0440\u044c","\u0434\u0435\u043a\u0430\u0431\u0440\u044c"]},defaultWidth:"wide",formattingValues:{narrow:["\u042f","\u0424","\u041c","\u0410","\u041c","\u0418","\u0418","\u0410","\u0421","\u041e","\u041d","\u0414"],abbreviated:["\u044f\u043d\u0432.","\u0444\u0435\u0432.","\u043c\u0430\u0440.","\u0430\u043f\u0440.","\u043c\u0430\u044f","\u0438\u044e\u043d.","\u0438\u044e\u043b.","\u0430\u0432\u0433.","\u0441\u0435\u043d\u0442.","\u043e\u043a\u0442.","\u043d\u043e\u044f\u0431.","\u0434\u0435\u043a."],wide:["\u044f\u043d\u0432\u0430\u0440\u044f","\u0444\u0435\u0432\u0440\u0430\u043b\u044f","\u043c\u0430\u0440\u0442\u0430","\u0430\u043f\u0440\u0435\u043b\u044f","\u043c\u0430\u044f","\u0438\u044e\u043d\u044f","\u0438\u044e\u043b\u044f","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f","\u043e\u043a\u0442\u044f\u0431\u0440\u044f","\u043d\u043e\u044f\u0431\u0440\u044f","\u0434\u0435\u043a\u0430\u0431\u0440\u044f"]},defaultFormattingWidth:"wide"}),day:TX({values:{narrow:["\u0412","\u041f","\u0412","\u0421","\u0427","\u041f","\u0421"],short:["\u0432\u0441","\u043f\u043d","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043f\u0442","\u0441\u0431"],abbreviated:["\u0432\u0441\u043a","\u043f\u043d\u0434","\u0432\u0442\u0440","\u0441\u0440\u0434","\u0447\u0442\u0432","\u043f\u0442\u043d","\u0441\u0443\u0431"],wide:["\u0432\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435","\u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0432\u0442\u043e\u0440\u043d\u0438\u043a","\u0441\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0435\u0440\u0433","\u043f\u044f\u0442\u043d\u0438\u0446\u0430","\u0441\u0443\u0431\u0431\u043e\u0442\u0430"]},defaultWidth:"wide"}),dayPeriod:TX({values:{narrow:{am:"\u0414\u041f",pm:"\u041f\u041f",midnight:"\u043f\u043e\u043b\u043d.",noon:"\u043f\u043e\u043b\u0434.",morning:"\u0443\u0442\u0440\u043e",afternoon:"\u0434\u0435\u043d\u044c",evening:"\u0432\u0435\u0447.",night:"\u043d\u043e\u0447\u044c"},abbreviated:{am:"\u0414\u041f",pm:"\u041f\u041f",midnight:"\u043f\u043e\u043b\u043d.",noon:"\u043f\u043e\u043b\u0434.",morning:"\u0443\u0442\u0440\u043e",afternoon:"\u0434\u0435\u043d\u044c",evening:"\u0432\u0435\u0447.",night:"\u043d\u043e\u0447\u044c"},wide:{am:"\u0414\u041f",pm:"\u041f\u041f",midnight:"\u043f\u043e\u043b\u043d\u043e\u0447\u044c",noon:"\u043f\u043e\u043b\u0434\u0435\u043d\u044c",morning:"\u0443\u0442\u0440\u043e",afternoon:"\u0434\u0435\u043d\u044c",evening:"\u0432\u0435\u0447\u0435\u0440",night:"\u043d\u043e\u0447\u044c"}},defaultWidth:"any",formattingValues:{narrow:{am:"\u0414\u041f",pm:"\u041f\u041f",midnight:"\u043f\u043e\u043b\u043d.",noon:"\u043f\u043e\u043b\u0434.",morning:"\u0443\u0442\u0440\u0430",afternoon:"\u0434\u043d\u044f",evening:"\u0432\u0435\u0447.",night:"\u043d\u043e\u0447\u0438"},abbreviated:{am:"\u0414\u041f",pm:"\u041f\u041f",midnight:"\u043f\u043e\u043b\u043d.",noon:"\u043f\u043e\u043b\u0434.",morning:"\u0443\u0442\u0440\u0430",afternoon:"\u0434\u043d\u044f",evening:"\u0432\u0435\u0447.",night:"\u043d\u043e\u0447\u0438"},wide:{am:"\u0414\u041f",pm:"\u041f\u041f",midnight:"\u043f\u043e\u043b\u043d\u043e\u0447\u044c",noon:"\u043f\u043e\u043b\u0434\u0435\u043d\u044c",morning:"\u0443\u0442\u0440\u0430",afternoon:"\u0434\u043d\u044f",evening:"\u0432\u0435\u0447\u0435\u0440\u0430",night:"\u043d\u043e\u0447\u0438"}},defaultFormattingWidth:"wide"})};function AX(t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.width,r=i&&t.matchPatterns[i]||t.matchPatterns[t.defaultMatchWidth],s=e.match(r);if(!s)return null;var a,o=s[0],l=i&&t.parsePatterns[i]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return n;return}(l,function(t){return t.test(o)}):function(t,e){for(var n in t)if(t.hasOwnProperty(n)&&e(t[n]))return n;return}(l,function(t){return t.test(o)});return a=t.valueCallback?t.valueCallback(c):c,{value:a=n.valueCallback?n.valueCallback(a):a,rest:e.slice(o.length)}}}var CX={ordinalNumber:function(t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.match(t.matchPattern);if(!i)return null;var r=i[0],s=e.match(t.parsePattern);if(!s)return null;var a=t.valueCallback?t.valueCallback(s[0]):s[0];return{value:a=n.valueCallback?n.valueCallback(a):a,rest:e.slice(r.length)}}}({matchPattern:/^(\d+)(-?(\u0435|\u044f|\u0439|\u043e\u0435|\u044c\u0435|\u0430\u044f|\u044c\u044f|\u044b\u0439|\u043e\u0439|\u0438\u0439|\u044b\u0439))?/i,parsePattern:/\d+/i,valueCallback:function(t){return parseInt(t,10)}}),era:AX({matchPatterns:{narrow:/^((\u0434\u043e )?\u043d\.?\s?\u044d\.?)/i,abbreviated:/^((\u0434\u043e )?\u043d\.?\s?\u044d\.?)/i,wide:/^(\u0434\u043e \u043d\u0430\u0448\u0435\u0439 \u044d\u0440\u044b|\u043d\u0430\u0448\u0435\u0439 \u044d\u0440\u044b|\u043d\u0430\u0448\u0430 \u044d\u0440\u0430)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^\u0434/i,/^\u043d/i]},defaultParseWidth:"any"}),quarter:AX({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^[1234](-?[\u044b\u043e\u0438]?\u0439?)? \u043a\u0432.?/i,wide:/^[1234](-?[\u044b\u043e\u0438]?\u0439?)? \u043a\u0432\u0430\u0440\u0442\u0430\u043b/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:AX({matchPatterns:{narrow:/^[\u044f\u0444\u043c\u0430\u0438\u0441\u043e\u043d\u0434]/i,abbreviated:/^(\u044f\u043d\u0432|\u0444\u0435\u0432|\u043c\u0430\u0440\u0442?|\u0430\u043f\u0440|\u043c\u0430[\u0439\u044f]|\u0438\u044e\u043d[\u044c\u044f]?|\u0438\u044e\u043b[\u044c\u044f]?|\u0430\u0432\u0433|\u0441\u0435\u043d\u0442?|\u043e\u043a\u0442|\u043d\u043e\u044f\u0431?|\u0434\u0435\u043a)\.?/i,wide:/^(\u044f\u043d\u0432\u0430\u0440[\u044c\u044f]|\u0444\u0435\u0432\u0440\u0430\u043b[\u044c\u044f]|\u043c\u0430\u0440\u0442\u0430?|\u0430\u043f\u0440\u0435\u043b[\u044c\u044f]|\u043c\u0430[\u0439\u044f]|\u0438\u044e\u043d[\u044c\u044f]|\u0438\u044e\u043b[\u044c\u044f]|\u0430\u0432\u0433\u0443\u0441\u0442\u0430?|\u0441\u0435\u043d\u0442\u044f\u0431\u0440[\u044c\u044f]|\u043e\u043a\u0442\u044f\u0431\u0440[\u044c\u044f]|\u043e\u043a\u0442\u044f\u0431\u0440[\u044c\u044f]|\u043d\u043e\u044f\u0431\u0440[\u044c\u044f]|\u0434\u0435\u043a\u0430\u0431\u0440[\u044c\u044f])/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^\u044f/i,/^\u0444/i,/^\u043c/i,/^\u0430/i,/^\u043c/i,/^\u0438/i,/^\u0438/i,/^\u0430/i,/^\u0441/i,/^\u043e/i,/^\u043d/i,/^\u044f/i],any:[/^\u044f/i,/^\u0444/i,/^\u043c\u0430\u0440/i,/^\u0430\u043f/i,/^\u043c\u0430[\u0439\u044f]/i,/^\u0438\u044e\u043d/i,/^\u0438\u044e\u043b/i,/^\u0430\u0432/i,/^\u0441/i,/^\u043e/i,/^\u043d/i,/^\u0434/i]},defaultParseWidth:"any"}),day:AX({matchPatterns:{narrow:/^[\u0432\u043f\u0441\u0447]/i,short:/^(\u0432\u0441|\u0432\u043e|\u043f\u043d|\u043f\u043e|\u0432\u0442|\u0441\u0440|\u0447\u0442|\u0447\u0435|\u043f\u0442|\u043f\u044f|\u0441\u0431|\u0441\u0443)\.?/i,abbreviated:/^(\u0432\u0441\u043a|\u0432\u043e\u0441|\u043f\u043d\u0434|\u043f\u043e\u043d|\u0432\u0442\u0440|\u0432\u0442\u043e|\u0441\u0440\u0434|\u0441\u0440\u0435|\u0447\u0442\u0432|\u0447\u0435\u0442|\u043f\u0442\u043d|\u043f\u044f\u0442|\u0441\u0443\u0431).?/i,wide:/^(\u0432\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c[\u0435\u044f]|\u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a\u0430?|\u0432\u0442\u043e\u0440\u043d\u0438\u043a\u0430?|\u0441\u0440\u0435\u0434[\u0430\u044b]|\u0447\u0435\u0442\u0432\u0435\u0440\u0433\u0430?|\u043f\u044f\u0442\u043d\u0438\u0446[\u0430\u044b]|\u0441\u0443\u0431\u0431\u043e\u0442[\u0430\u044b])/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^\u0432/i,/^\u043f/i,/^\u0432/i,/^\u0441/i,/^\u0447/i,/^\u043f/i,/^\u0441/i],any:[/^\u0432[\u043e\u0441]/i,/^\u043f[\u043e\u043d]/i,/^\u0432/i,/^\u0441\u0440/i,/^\u0447/i,/^\u043f[\u044f\u0442]/i,/^\u0441[\u0443\u0431]/i]},defaultParseWidth:"any"}),dayPeriod:AX({matchPatterns:{narrow:/^([\u0434\u043f]\u043f|\u043f\u043e\u043b\u043d\.?|\u043f\u043e\u043b\u0434\.?|\u0443\u0442\u0440[\u043e\u0430]|\u0434\u0435\u043d\u044c|\u0434\u043d\u044f|\u0432\u0435\u0447\.?|\u043d\u043e\u0447[\u044c\u0438])/i,abbreviated:/^([\u0434\u043f]\u043f|\u043f\u043e\u043b\u043d\.?|\u043f\u043e\u043b\u0434\.?|\u0443\u0442\u0440[\u043e\u0430]|\u0434\u0435\u043d\u044c|\u0434\u043d\u044f|\u0432\u0435\u0447\.?|\u043d\u043e\u0447[\u044c\u0438])/i,wide:/^([\u0434\u043f]\u043f|\u043f\u043e\u043b\u043d\u043e\u0447\u044c|\u043f\u043e\u043b\u0434\u0435\u043d\u044c|\u0443\u0442\u0440[\u043e\u0430]|\u0434\u0435\u043d\u044c|\u0434\u043d\u044f|\u0432\u0435\u0447\u0435\u0440\u0430?|\u043d\u043e\u0447[\u044c\u0438])/i},defaultMatchWidth:"wide",parsePatterns:{any:{am:/^\u0434\u043f/i,pm:/^\u043f\u043f/i,midnight:/^\u043f\u043e\u043b\u043d/i,noon:/^\u043f\u043e\u043b\u0434/i,morning:/^\u0443/i,afternoon:/^\u0434[\u0435\u043d]/i,evening:/^\u0432/i,night:/^\u043d/i}},defaultParseWidth:"any"})};const RX={code:"ru",formatDistance:pX,formatLong:gX,formatRelative:SX,localize:MX,match:CX,options:{weekStartsOn:1,firstWeekContainsDate:1}};var kX=n(51);function LX(t){t()}var DX={notify(){},get:()=>[]};function PX(t,e){let n,i=DX,r=0,s=!1;function a(){c.onStateChange&&c.onStateChange()}function o(){r++,n||(n=e?e.addNestedSub(a):t.subscribe(a),i=function(){let t=null,e=null;return{clear(){t=null,e=null},notify(){LX(()=>{let e=t;for(;e;)e.callback(),e=e.next})},get(){const e=[];let n=t;for(;n;)e.push(n),n=n.next;return e},subscribe(n){let i=!0;const r=e={callback:n,next:null,prev:e};return r.prev?r.prev.next=r:t=r,function(){i&&null!==t&&(i=!1,r.next?r.next.prev=r.prev:e=r.prev,r.prev?r.prev.next=r.next:t=r.next)}}}}())}function l(){r--,n&&0===r&&(n(),n=void 0,i.clear(),i=DX)}const c={addNestedSub:function(t){o();const e=i.subscribe(t);let n=!1;return()=>{n||(n=!0,e(),l())}},notifyNestedSubs:function(){i.notify()},handleChangeWrapper:a,isSubscribed:function(){return s},trySubscribe:function(){s||(s=!0,o())},tryUnsubscribe:function(){s&&(s=!1,l())},getListeners:()=>i};return c}var IX=(()=>!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement))(),OX=(()=>"undefined"!==typeof navigator&&"ReactNative"===navigator.product)(),NX=(()=>IX||OX?i.useLayoutEffect:i.useEffect)();Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.prototype;var FX=Symbol.for("react-redux-context"),UX="undefined"!==typeof globalThis?globalThis:{};function BX(){var t;if(!i.createContext)return{};const e=null!==(t=UX[FX])&&void 0!==t?t:UX[FX]=new Map;let n=e.get(i.createContext);return n||(n=i.createContext(null),e.set(i.createContext,n)),n}var zX=BX();var HX=function(t){const{children:e,context:n,serverState:r,store:s}=t,a=i.useMemo(()=>{const t=PX(s);return{store:s,subscription:t,getServerState:r?()=>r:void 0}},[s,r]),o=i.useMemo(()=>s.getState(),[s]);NX(()=>{const{subscription:t}=a;return t.onStateChange=t.notifyNestedSubs,t.trySubscribe(),o!==s.getState()&&t.notifyNestedSubs(),()=>{t.tryUnsubscribe(),t.onStateChange=void 0}},[a,o]);const l=n||zX;return i.createElement(l.Provider,{value:a},e)};function VX(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zX;return function(){return i.useContext(t)}}var GX=VX();function jX(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zX;const e=t===zX?GX:VX(t),n=()=>{const{store:t}=e();return t};return Object.assign(n,{withTypes:()=>n}),n}var WX=jX();function YX(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zX;const e=t===zX?WX:jX(t),n=()=>e().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var XX=YX(),KX=(t,e)=>t===e;function qX(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zX;const e=t===zX?GX:VX(t),n=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{equalityFn:r=KX}="function"===typeof n?{equalityFn:n}:n;const s=e(),{store:a,subscription:o,getServerState:l}=s,c=(i.useRef(!0),i.useCallback({[t.name]:e=>t(e)}[t.name],[t])),u=(0,kX.useSyncExternalStoreWithSelector)(o.addNestedSub,a.getState,l||a.getState,c,r);return i.useDebugValue(u),u};return Object.assign(n,{withTypes:()=>n}),n}const QX=qX();var ZX=Symbol.for("immer-nothing"),JX=Symbol.for("immer-draftable"),$X=Symbol.for("immer-state");function tK(t){throw new Error("[Immer] minified error nr: ".concat(t,". Full error at: https://bit.ly/3cXEKWf"))}var eK=Object.getPrototypeOf;function nK(t){return!!t&&!!t[$X]}function iK(t){var e;return!!t&&(aK(t)||Array.isArray(t)||!!t[JX]||!(null===(e=t.constructor)||void 0===e||!e[JX])||hK(t)||dK(t))}var rK=Object.prototype.constructor.toString(),sK=new WeakMap;function aK(t){if(!t||"object"!==typeof t)return!1;const e=Object.getPrototypeOf(t);if(null===e||e===Object.prototype)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(n===Object)return!0;if("function"!==typeof n)return!1;let i=sK.get(n);return void 0===i&&(i=Function.toString.call(n),sK.set(n,i)),i===rK}function oK(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===lK(t)){(n?Reflect.ownKeys(t):Object.keys(t)).forEach(n=>{e(n,t[n],t)})}else t.forEach((n,i)=>e(i,n,t))}function lK(t){const e=t[$X];return e?e.type_:Array.isArray(t)?1:hK(t)?2:dK(t)?3:0}function cK(t,e){return 2===lK(t)?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function uK(t,e,n){const i=lK(t);2===i?t.set(e,n):3===i?t.add(n):t[e]=n}function hK(t){return t instanceof Map}function dK(t){return t instanceof Set}function fK(t){return t.copy_||t.base_}function pK(t,e){if(hK(t))return new Map(t);if(dK(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=aK(t);if(!0===e||"class_only"===e&&!n){const e=Object.getOwnPropertyDescriptors(t);delete e[$X];let n=Reflect.ownKeys(e);for(let i=0;i<n.length;i++){const r=n[i],s=e[r];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(e[r]={configurable:!0,writable:!0,enumerable:s.enumerable,value:t[r]})}return Object.create(eK(t),e)}{const e=eK(t);if(null!==e&&n)return Rr({},t);const i=Object.create(e);return Object.assign(i,t)}}function mK(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return vK(t)||nK(t)||!iK(t)||(lK(t)>1&&Object.defineProperties(t,{set:gK,add:gK,clear:gK,delete:gK}),Object.freeze(t),e&&Object.values(t).forEach(t=>mK(t,!0))),t}var gK={value:function(){tK(2)}};function vK(t){return null===t||"object"!==typeof t||Object.isFrozen(t)}var yK,_K={};function bK(t){const e=_K[t];return e||tK(0),e}function xK(){return yK}function EK(t,e){e&&(bK("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function wK(t){SK(t),t.drafts_.forEach(MK),t.drafts_=null}function SK(t){t===yK&&(yK=t.parent_)}function TK(t){return yK={drafts_:[],parent_:yK,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function MK(t){const e=t[$X];0===e.type_||1===e.type_?e.revoke_():e.revoked_=!0}function AK(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return void 0!==t&&t!==n?(n[$X].modified_&&(wK(e),tK(4)),iK(t)&&(t=CK(e,t),e.parent_||kK(e,t)),e.patches_&&bK("Patches").generateReplacementPatches_(n[$X].base_,t,e.patches_,e.inversePatches_)):t=CK(e,n,[]),wK(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==ZX?t:void 0}function CK(t,e,n){if(vK(e))return e;const i=t.immer_.shouldUseStrictIteration(),r=e[$X];if(!r)return oK(e,(i,s)=>RK(t,r,e,i,s,n),i),e;if(r.scope_!==t)return e;if(!r.modified_)return kK(t,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const e=r.copy_;let s=e,a=!1;3===r.type_&&(s=new Set(e),e.clear(),a=!0),oK(s,(i,s)=>RK(t,r,e,i,s,n,a),i),kK(t,e,!1),n&&t.patches_&&bK("Patches").generatePatches_(r,n,t.patches_,t.inversePatches_)}return r.copy_}function RK(t,e,n,i,r,s,a){if(null==r)return;if("object"!==typeof r&&!a)return;const o=vK(r);if(!o||a){if(nK(r)){const a=CK(t,r,s&&e&&3!==e.type_&&!cK(e.assigned_,i)?s.concat(i):void 0);if(uK(n,i,a),!nK(a))return;t.canAutoFreeze_=!1}else a&&n.add(r);if(iK(r)&&!o){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;if(e&&e.base_&&e.base_[i]===r&&o)return;CK(t,r),e&&e.scope_.parent_||"symbol"===typeof i||!(hK(n)?n.has(i):Object.prototype.propertyIsEnumerable.call(n,i))||kK(t,r)}}}function kK(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&mK(e,n)}var LK={get(t,e){if(e===$X)return t;const n=fK(t);if(!cK(n,e))return function(t,e,n){var i;const r=IK(e,n);return r?"value"in r?r.value:null===(i=r.get)||void 0===i?void 0:i.call(t.draft_):void 0}(t,n,e);const i=n[e];return t.finalized_||!iK(i)?i:i===PK(t.base_,e)?(NK(t),t.copy_[e]=FK(i,t)):i},has:(t,e)=>e in fK(t),ownKeys:t=>Reflect.ownKeys(fK(t)),set(t,e,n){const i=IK(fK(t),e);if(null!==i&&void 0!==i&&i.set)return i.set.call(t.draft_,n),!0;if(!t.modified_){const i=PK(fK(t),e),a=null===i||void 0===i?void 0:i[$X];if(a&&a.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(((r=n)===(s=i)?0!==r||1/r===1/s:r!==r&&s!==s)&&(void 0!==n||cK(t.base_,e)))return!0;NK(t),OK(t)}var r,s;return t.copy_[e]===n&&(void 0!==n||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty:(t,e)=>(void 0!==PK(t.base_,e)||e in t.base_?(t.assigned_[e]=!1,NK(t),OK(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0),getOwnPropertyDescriptor(t,e){const n=fK(t),i=Reflect.getOwnPropertyDescriptor(n,e);return i?{writable:!0,configurable:1!==t.type_||"length"!==e,enumerable:i.enumerable,value:n[e]}:i},defineProperty(){tK(11)},getPrototypeOf:t=>eK(t.base_),setPrototypeOf(){tK(12)}},DK={};function PK(t,e){const n=t[$X];return(n?fK(n):t)[e]}function IK(t,e){if(!(e in t))return;let n=eK(t);for(;n;){const t=Object.getOwnPropertyDescriptor(n,e);if(t)return t;n=eK(n)}}function OK(t){t.modified_||(t.modified_=!0,t.parent_&&OK(t.parent_))}function NK(t){t.copy_||(t.copy_=pK(t.base_,t.scope_.immer_.useStrictShallowCopy_))}oK(LK,(t,e)=>{DK[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),DK.deleteProperty=function(t,e){return DK.set.call(this,t,e,void 0)},DK.set=function(t,e,n){return LK.set.call(this,t[0],e,n,t[0])};function FK(t,e){const n=hK(t)?bK("MapSet").proxyMap_(t,e):dK(t)?bK("MapSet").proxySet_(t,e):function(t,e){const n=Array.isArray(t),i={type_:n?1:0,scope_:e?e.scope_:xK(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=i,s=LK;n&&(r=[i],s=DK);const{revoke:a,proxy:o}=Proxy.revocable(r,s);return i.draft_=o,i.revoke_=a,o}(t,e);return(e?e.scope_:xK()).drafts_.push(n),n}function UK(t){if(!iK(t)||vK(t))return t;const e=t[$X];let n,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=pK(t,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else n=pK(t,!0);return oK(n,(t,e)=>{uK(n,t,UK(e))},i),e&&(e.finalized_=!1),n}var BK=new class{constructor(t){var e=this;this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,e,n)=>{if("function"===typeof t&&"function"!==typeof e){const n=e;e=t;const i=this;return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return i.produce(t,t=>e.call(this,t,...s))}}let i;if("function"!==typeof e&&tK(6),void 0!==n&&"function"!==typeof n&&tK(7),iK(t)){const r=TK(this),s=FK(t,void 0);let a=!0;try{i=e(s),a=!1}finally{a?wK(r):SK(r)}return EK(r,n),AK(i,r)}if(!t||"object"!==typeof t){if(i=e(t),void 0===i&&(i=t),i===ZX&&(i=void 0),this.autoFreeze_&&mK(i,!0),n){const e=[],r=[];bK("Patches").generateReplacementPatches_(t,i,e,r),n(e,r)}return i}tK(1)},this.produceWithPatches=(t,n)=>{if("function"===typeof t)return function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];return e.produceWithPatches(n,e=>t(e,...r))};let i,r;return[this.produce(t,n,(t,e)=>{i=t,r=e}),i,r]},"boolean"===typeof(null===t||void 0===t?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),"boolean"===typeof(null===t||void 0===t?void 0:t.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),"boolean"===typeof(null===t||void 0===t?void 0:t.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){iK(t)||tK(8),nK(t)&&(t=function(t){nK(t)||tK(10);return UK(t)}(t));const e=TK(this),n=FK(t,void 0);return n[$X].isManual_=!0,SK(e),n}finishDraft(t,e){const n=t&&t[$X];n&&n.isManual_||tK(9);const{scope_:i}=n;return EK(i,e),AK(void 0,i)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const i=e[n];if(0===i.path.length&&"replace"===i.op){t=i.value;break}}n>-1&&(e=e.slice(n+1));const i=bK("Patches").applyPatches_;return nK(t)?i(t,e):this.produce(t,t=>i(t,e))}},zK=BK.produce,HK=BK.setUseStrictIteration.bind(BK);function VK(t){return"Minified Redux error #".concat(t,"; visit https://redux.js.org/Errors?code=").concat(t," for the full message or use the non-minified dev environment for full errors. ")}var GK=(()=>"function"===typeof Symbol&&Symbol.observable||"@@observable")(),jK=()=>Math.random().toString(36).substring(7).split("").join("."),WK={INIT:"@@redux/INIT".concat(jK()),REPLACE:"@@redux/REPLACE".concat(jK()),PROBE_UNKNOWN_ACTION:()=>"@@redux/PROBE_UNKNOWN_ACTION".concat(jK())};function YK(t){if("object"!==typeof t||null===t)return!1;let e=t;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||null===Object.getPrototypeOf(t)}function XK(t,e,n){if("function"!==typeof t)throw new Error(VK(2));if("function"===typeof e&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(VK(0));if("function"===typeof e&&"undefined"===typeof n&&(n=e,e=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(VK(1));return n(XK)(t,e)}let i=t,r=e,s=new Map,a=s,o=0,l=!1;function c(){a===s&&(a=new Map,s.forEach((t,e)=>{a.set(e,t)}))}function u(){if(l)throw new Error(VK(3));return r}function h(t){if("function"!==typeof t)throw new Error(VK(4));if(l)throw new Error(VK(5));let e=!0;c();const n=o++;return a.set(n,t),function(){if(e){if(l)throw new Error(VK(6));e=!1,c(),a.delete(n),s=null}}}function d(t){if(!YK(t))throw new Error(VK(7));if("undefined"===typeof t.type)throw new Error(VK(8));if("string"!==typeof t.type)throw new Error(VK(17));if(l)throw new Error(VK(9));try{l=!0,r=i(r,t)}finally{l=!1}return(s=a).forEach(t=>{t()}),t}d({type:WK.INIT});return{dispatch:d,subscribe:h,getState:u,replaceReducer:function(t){if("function"!==typeof t)throw new Error(VK(10));i=t,d({type:WK.REPLACE})},[GK]:function(){const t=h;return{subscribe(e){if("object"!==typeof e||null===e)throw new Error(VK(11));function n(){const t=e;t.next&&t.next(u())}n();return{unsubscribe:t(n)}},[GK](){return this}}}}}function KK(t){const e=Object.keys(t),n={};for(let s=0;s<e.length;s++){const i=e[s];0,"function"===typeof t[i]&&(n[i]=t[i])}const i=Object.keys(n);let r;try{!function(t){Object.keys(t).forEach(e=>{const n=t[e];if("undefined"===typeof n(void 0,{type:WK.INIT}))throw new Error(VK(12));if("undefined"===typeof n(void 0,{type:WK.PROBE_UNKNOWN_ACTION()}))throw new Error(VK(13))})}(n)}catch(Wq){r=Wq}return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;if(r)throw r;let s=!1;const a={};for(let r=0;r<i.length;r++){const o=i[r],l=n[o],c=t[o],u=l(c,e);if("undefined"===typeof u){e&&e.type;throw new Error(VK(14))}a[o]=u,s=s||u!==c}return s=s||i.length!==Object.keys(t).length,s?a:t}}function qK(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return 0===e.length?t=>t:1===e.length?e[0]:e.reduce((t,e)=>function(){return t(e(...arguments))})}function QK(t){return e=>{let{dispatch:n,getState:i}=e;return e=>r=>"function"===typeof r?r(n,i,t):e(r)}}var ZK=QK(),JK=QK;const $K=["reducerPath"];var tq="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?qK:qK.apply(null,arguments)};"undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;function eq(t,e){function n(){if(e){let n=e(...arguments);if(!n)throw new Error(Eq(0));return Rr(Rr({type:t,payload:n.payload},"meta"in n&&{meta:n.meta}),"error"in n&&{error:n.error})}return{type:t,payload:arguments.length<=0?void 0:arguments[0]}}return n.toString=()=>"".concat(t),n.type=t,n.match=e=>function(t){return YK(t)&&"type"in t&&"string"===typeof t.type}(e)&&e.type===t,n}var nq=class t extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,t.prototype)}static get[Symbol.species](){return t}concat(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return super.concat.apply(this,e)}prepend(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return 1===n.length&&Array.isArray(n[0])?new t(...n[0].concat(this)):new t(...n.concat(this))}};function iq(t){return iK(t)?zK(t,()=>{}):t}function rq(t,e,n){return t.has(e)?t.get(e):t.set(e,n(e)).get(e)}var sq="RTK_autoBatch",aq=t=>e=>{setTimeout(e,t)},oq=t=>function(e){const{autoBatch:n=!0}=null!==e&&void 0!==e?e:{};let i=new nq(t);return n&&i.push(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"raf"};return e=>function(){const n=e(...arguments);let i=!0,r=!1,s=!1;const a=new Set,o="tick"===t.type?queueMicrotask:"raf"===t.type?"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:aq(10):"callback"===t.type?t.queueNotification:aq(t.timeout),l=()=>{s=!1,r&&(r=!1,a.forEach(t=>t()))};return Object.assign({},n,{subscribe(t){const e=n.subscribe(()=>i&&t());return a.add(t),()=>{e(),a.delete(t)}},dispatch(t){try{var e;return i=!(null!==t&&void 0!==t&&null!==(e=t.meta)&&void 0!==e&&e[sq]),r=!i,r&&(s||(s=!0,o(l))),n.dispatch(t)}finally{i=!0}}})}}("object"===typeof n?n:void 0)),i};function lq(t){const e={},n=[];let i;const r={addCase(t,n){const i="string"===typeof t?t:t.type;if(!i)throw new Error(Eq(28));if(i in e)throw new Error(Eq(29));return e[i]=n,r},addAsyncThunk:(t,i)=>(i.pending&&(e[t.pending.type]=i.pending),i.rejected&&(e[t.rejected.type]=i.rejected),i.fulfilled&&(e[t.fulfilled.type]=i.fulfilled),i.settled&&n.push({matcher:t.settled,reducer:i.settled}),r),addMatcher:(t,e)=>(n.push({matcher:t,reducer:e}),r),addDefaultCase:t=>(i=t,r)};return t(r),[e,n,i]}HK(!1);var cq=Symbol.for("rtk-slice-createasyncthunk");function uq(t,e){return"".concat(t,"/").concat(e)}function hq(){var t;let{creators:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=null===e||void 0===e||null===(t=e.asyncThunk)||void 0===t?void 0:t[cq];return function(t){const{name:e,reducerPath:i=e}=t;if(!e)throw new Error(Eq(11));const r=("function"===typeof t.reducers?t.reducers(function(){function t(t,e){return Rr({_reducerDefinitionType:"asyncThunk",payloadCreator:t},e)}return t.withTypes=()=>t,{reducer:t=>Object.assign({[t.name](){return t(...arguments)}}[t.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(t,e)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:e}),asyncThunk:t}}()):t.reducers)||{},s=Object.keys(r),a={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},o={addCase(t,e){const n="string"===typeof t?t:t.type;if(!n)throw new Error(Eq(12));if(n in a.sliceCaseReducersByType)throw new Error(Eq(13));return a.sliceCaseReducersByType[n]=e,o},addMatcher:(t,e)=>(a.sliceMatchers.push({matcher:t,reducer:e}),o),exposeAction:(t,e)=>(a.actionCreators[t]=e,o),exposeCaseReducer:(t,e)=>(a.sliceCaseReducersByName[t]=e,o)};function l(){const[e={},n=[],i]="function"===typeof t.extraReducers?lq(t.extraReducers):[t.extraReducers],r=Rr(Rr({},e),a.sliceCaseReducersByType);return function(t,e){let n,[i,r,s]=lq(e);if("function"===typeof t)n=()=>iq(t());else{const e=iq(t);n=()=>e}function a(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n(),e=arguments.length>1?arguments[1]:void 0,a=[i[e.type],...r.filter(t=>{let{matcher:n}=t;return n(e)}).map(t=>{let{reducer:e}=t;return e})];return 0===a.filter(t=>!!t).length&&(a=[s]),a.reduce((t,n)=>{if(n){if(nK(t)){const i=n(t,e);return void 0===i?t:i}if(iK(t))return zK(t,t=>n(t,e));{const i=n(t,e);if(void 0===i){if(null===t)return t;throw Error("A case reducer on a non-draftable value must not return undefined")}return i}}return t},t)}return a.getInitialState=n,a}(t.initialState,t=>{for(let e in r)t.addCase(e,r[e]);for(let e of a.sliceMatchers)t.addMatcher(e.matcher,e.reducer);for(let e of n)t.addMatcher(e.matcher,e.reducer);i&&t.addDefaultCase(i)})}s.forEach(i=>{const s=r[i],a={reducerName:i,type:uq(e,i),createNotation:"function"===typeof t.reducers};!function(t){return"asyncThunk"===t._reducerDefinitionType}(s)?function(t,e,n){let i,r,{type:s,reducerName:a,createNotation:o}=t;if("reducer"in e){if(o&&!function(t){return"reducerWithPrepare"===t._reducerDefinitionType}(e))throw new Error(Eq(17));i=e.reducer,r=e.prepare}else i=e;n.addCase(s,i).exposeCaseReducer(a,i).exposeAction(a,r?eq(s,r):eq(s))}(a,s,o):function(t,e,n,i){let{type:r,reducerName:s}=t;if(!i)throw new Error(Eq(18));const{payloadCreator:a,fulfilled:o,pending:l,rejected:c,settled:u,options:h}=e,d=i(r,a,h);n.exposeAction(s,d),o&&n.addCase(d.fulfilled,o);l&&n.addCase(d.pending,l);c&&n.addCase(d.rejected,c);u&&n.addMatcher(d.settled,u);n.exposeCaseReducer(s,{fulfilled:o||pq,pending:l||pq,rejected:c||pq,settled:u||pq})}(a,s,o,n)});const c=t=>t,u=new Map,h=new WeakMap;let f;function p(t,e){return f||(f=l()),f(t,e)}function m(){return f||(f=l()),f.getInitialState()}function g(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function i(t){let r=t[e];return"undefined"===typeof r&&n&&(r=rq(h,i,m)),r}function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c;const i=rq(u,n,()=>new WeakMap);return rq(i,e,()=>{const i={};for(const[s,a]of Object.entries(null!==(r=t.selectors)&&void 0!==r?r:{})){var r;i[s]=dq(a,e,()=>rq(h,e,m),n)}return i})}return{reducerPath:e,getSelectors:r,get selectors(){return r(i)},selectSlice:i}}const v=Rr(Rr({name:e,reducer:p,actions:a.actionCreators,caseReducers:a.sliceCaseReducersByName,getInitialState:m},g(i)),{},{injectInto(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{reducerPath:n}=e,r=d(e,$K);const s=null!==n&&void 0!==n?n:i;return t.inject({reducerPath:s,reducer:p},r),Rr(Rr({},v),g(s,!0))}});return v}}function dq(t,e,n,i){function r(r){let s=e(r);"undefined"===typeof s&&i&&(s=n());for(var a=arguments.length,o=new Array(a>1?a-1:0),l=1;l<a;l++)o[l-1]=arguments[l];return t(s,...o)}return r.unwrapped=t,r}var fq=hq();function pq(){}var mq="listener",gq="completed",vq="cancelled";"task-".concat(vq),"task-".concat(gq),"".concat(mq,"-").concat(vq),"".concat(mq,"-").concat(gq);var{assign:yq}=Object,_q="listenerMiddleware",bq=yq(eq("".concat(_q,"/add")),{withTypes:()=>bq}),xq=("".concat(_q,"/removeAll"),yq(eq("".concat(_q,"/remove")),{withTypes:()=>xq}));Symbol.for("rtk-state-proxy-original");function Eq(t){return"Minified Redux Toolkit error #".concat(t,"; visit https://redux-toolkit.js.org/Errors?code=").concat(t," for the full message or use the non-minified dev environment for full errors. ")}const wq=fq({name:"search",initialState:{results:[],filters:{dateStart:null,dateEnd:null}},selectors:{filters:t=>t.filters,isFiltersValid:t=>!!t.filters.dateStart&&!!t.filters.dateEnd,results:t=>t.results},reducers:{setDateStart:(t,e)=>{t.filters&&(t.filters.dateStart=e.payload)},setDateEnd:(t,e)=>{t.filters&&(t.filters.dateEnd=e.payload)}}}),{reducer:Sq,actions:Tq,selectors:Mq}=wq,Aq="SearchComponent_custom_date_input__8pmye",Cq="SearchComponent_arrow_icon__Zbv47",Rq=(0,i.forwardRef)((t,e)=>{let{value:n,onClick:i,title:r}=t;return(0,m.jsxs)("button",{className:Aq,onClick:i,ref:e,children:[n||"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0430\u0442\u0443 \u0437\u0430\u0435\u0437\u0434\u0430",(0,m.jsx)("span",{className:Cq,children:"\u25bc"})]})}),kq=(0,i.forwardRef)((t,e)=>{let{value:n,onClick:i,title:r}=t;return(0,m.jsxs)("button",{className:Aq,onClick:i,ref:e,children:[n||"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0430\u0442\u0443 \u0432\u044b\u0435\u0437\u0434a",(0,m.jsx)("span",{className:Cq,children:"\u25bc"})]})}),Lq="RoomCardComponent_main__OW+Km",Dq="RoomCardComponent_description__kueot",Pq="RoomCardComponent_item_level_two__FGXkH",Iq="RoomCardComponent_item_level_three__OTJXm",Oq="RoomCardComponent_image__HfSkH",Nq="RoomCardComponent_item__-79qU",Fq="RoomCardComponent_item_bottom__dfqog",Uq="RoomCardComponent_buttons__uI8AU",Bq="RoomCardComponent_button__NZ-JK",zq=t=>{Object.assign({},(Ya(t),t));(0,i.useContext)(E),(0,i.useContext)(w),(0,i.useContext)(S),Is(),(0,i.useRef)(null);const e=Fs();return(0,m.jsxs)("div",{className:Lq,children:[(0,m.jsx)("img",{className:Oq,src:Yx}),(0,m.jsxs)("div",{className:Dq,children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:Nq,children:"\u041d\u043e\u043c\u0435\u0440 \u0410\u043b\u044c\u0444\u0430"}),(0,m.jsx)("div",{className:Pq,children:"2 \u043a\u043e\u043c\u043d\u0430\u0442\u044b, 4 \u0441\u043f\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0435\u0441\u0442\u0430"}),(0,m.jsx)("div",{className:Iq,children:"\u0411\u0435\u0437 \u0431\u0430\u043b\u043a\u043e\u043d\u0430"}),(0,m.jsx)("div",{className:Iq,children:'3 \u044d\u0442\u0430\u0436 \u043a\u043e\u0440\u043f\u0443\u0441\u0430 "\u0411\u0430\u0439\u043a\u0430\u043d\u0443\u0440"'})]}),(0,m.jsxs)("div",{className:Fq,children:[(0,m.jsx)("div",{className:Nq,children:"12000 \u20bd/\u043c\u0435\u0441."}),(0,m.jsxs)("div",{className:Uq,children:[(0,m.jsx)(Wx,{className:Bq,title:"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043d\u043e\u043c\u0435\u0440",onClick:()=>e("/room")}),(0,m.jsx)(Wx,{className:Bq,title:"\u041f\u043e\u0434\u0430\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443",onClick:()=>{}})]})]})]})]})},Hq=t=>{Object.assign({},(Ya(t),t));const e=(0,i.useContext)(E),n=(0,i.useContext)(w),r=(0,i.useContext)(S),s=QX(Mq.filters),a=QX(Mq.isFiltersValid),o=XX(),l=Is();(0,i.useEffect)(()=>{e[1]("search"),n[1]("home"),l.state||r[1]("home")},[]);return(0,m.jsxs)("main",{className:ez,children:[(0,m.jsxs)("div",{className:nz,children:[(0,m.jsxs)("div",{className:sz,children:[(0,m.jsx)("p",{className:iz,children:"\u0414\u0430\u0442\u0430 \u0437\u0430\u0435\u0437\u0434\u0430:"}),(0,m.jsx)(lX,{locale:RX,selected:s.dateStart?new Date(s.dateStart):null,onChange:t=>{var e;o(Tq.setDateStart(null!==(e=null===t||void 0===t?void 0:t.toISOString())&&void 0!==e?e:null)),t&&s.dateEnd&&t>new Date(s.dateEnd)&&o(Tq.setDateEnd(null))},selectsStart:!0,isClearable:!1,monthsShown:1,minDate:new Date,startDate:s.dateStart?new Date(s.dateStart):null,endDate:s.dateEnd?new Date(s.dateEnd):null,dateFormat:"dd.MM.yyyy",popperPlacement:"bottom-start",showPopperArrow:!1,previousMonthButtonLabel:"< \u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439",nextMonthButtonLabel:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 >",customInput:(0,m.jsx)(Rq,{})})]}),(0,m.jsxs)("div",{className:az,children:[(0,m.jsx)("p",{className:iz,children:"\u0414\u0430\u0442\u0430 \u0432\u044b\u0435\u0437\u0434\u0430:"}),(0,m.jsx)(lX,{locale:RX,selected:s.dateEnd?new Date(s.dateEnd):null,selectsEnd:!0,onChange:t=>{var e;t&&s.dateStart&&t<new Date(s.dateStart)||o(Tq.setDateEnd(null!==(e=null===t||void 0===t?void 0:t.toISOString())&&void 0!==e?e:null))},isClearable:!1,monthsShown:1,startDate:s.dateStart?new Date(s.dateStart):null,endDate:s.dateEnd?new Date(s.dateEnd):null,minDate:new Date,dateFormat:"dd.MM.yyyy",popperPlacement:"bottom-start",showPopperArrow:!1,previousMonthButtonLabel:"< \u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439",nextMonthButtonLabel:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 >",customInput:(0,m.jsx)(kq,{})})]}),(0,m.jsxs)("div",{className:rz,children:[(0,m.jsx)("div",{}),(0,m.jsx)(Wx,{className:lz,title:"\u041d\u0430\u0439\u0442\u0438 \u043d\u043e\u043c\u0435\u0440\u0430",disabled:!a,onClick:()=>{}})]})]}),(0,m.jsx)("div",{className:oz,children:(0,m.jsxs)("div",{className:cz,children:[(0,m.jsx)(zq,{}),(0,m.jsx)(zq,{}),(0,m.jsx)(zq,{}),(0,m.jsx)(zq,{}),(0,m.jsx)(zq,{}),(0,m.jsx)(zq,{}),(0,m.jsx)(zq,{}),(0,m.jsx)(zq,{}),(0,m.jsx)(zq,{}),(0,m.jsx)(zq,{}),(0,m.jsx)(zq,{}),(0,m.jsx)(zq,{}),(0,m.jsx)(zq,{}),(0,m.jsx)(zq,{}),(0,m.jsx)(zq,{})]})})]})};const Vq=function(){return(0,m.jsx)("div",{className:"App",children:(0,m.jsx)(Oa,{children:(0,m.jsx)(Sx,{children:(0,m.jsx)(Tx,{children:(0,m.jsxs)(wx,{children:[(0,m.jsx)(Wa,{}),(0,m.jsxs)(na,{children:[(0,m.jsx)(ta,{path:"/",element:(0,m.jsx)(Ex,{})}),(0,m.jsx)(ta,{path:"/room",element:(0,m.jsx)(tz,{})}),(0,m.jsx)(ta,{path:"/search",element:(0,m.jsx)(Hq,{})})]})]})})})})})},Gq=t=>{t&&t instanceof Function&&n.e(511).then(n.bind(n,511)).then(e=>{let{getCLS:n,getFID:i,getFCP:r,getLCP:s,getTTFB:a}=e;n(t),i(t),r(t),s(t),a(t)})},jq=function(t){const e=function(t){const{thunk:e=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:r=!0}=null!==t&&void 0!==t?t:{};let s=new nq;return e&&("boolean"===typeof e?s.push(ZK):s.push(JK(e.extraArgument))),s},{reducer:n,middleware:i,devTools:r=!0,duplicateMiddlewareCheck:s=!0,preloadedState:a,enhancers:o}=t||{};let l,c;if("function"===typeof n)l=n;else{if(!YK(n))throw new Error(Eq(1));l=KK(n)}c="function"===typeof i?i(e):e();let u=qK;r&&(u=tq(Rr({trace:!1},"object"===typeof r&&r)));const h=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return t=>(n,i)=>{const r=t(n,i);let s=()=>{throw new Error(VK(15))};const a={getState:r.getState,dispatch:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return s(t,...n)}},o=e.map(t=>t(a));return s=qK(...o)(r.dispatch),Rr(Rr({},r),{},{dispatch:s})}}(...c),d=oq(h);return XK(l,a,u(..."function"===typeof o?o(d):d()))}({reducer:KK({search:Sq}),middleware:t=>t()});s.createRoot(document.getElementById("root")).render((0,m.jsx)(i.StrictMode,{children:(0,m.jsx)(HX,{store:jq,children:(0,m.jsx)(Vq,{})})})),Gq()})();
//# sourceMappingURL=main.456e7276.js.map